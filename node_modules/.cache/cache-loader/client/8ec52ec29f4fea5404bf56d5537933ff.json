{"remainingRequest":"/home/diane/Documents/MDT/portfolio/node_modules/esbuild-loader/dist/index.js??ref--2-1!/home/diane/Documents/MDT/portfolio/node_modules/three/build/three.module.js","dependencies":[{"path":"/home/diane/Documents/MDT/portfolio/node_modules/three/build/three.module.js","mtime":1696601676503},{"path":"/home/diane/Documents/MDT/portfolio/node_modules/cache-loader/dist/cjs.js","mtime":1696602851329},{"path":"/home/diane/Documents/MDT/portfolio/node_modules/esbuild-loader/dist/index.js","mtime":1696601673236}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fcG93ID0gTWF0aC5wb3c7CnZhciBfX2FzeW5jID0gKF9fdGhpcywgX19hcmd1bWVudHMsIGdlbmVyYXRvcikgPT4gewogIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICB2YXIgZnVsZmlsbGVkID0gKHZhbHVlKSA9PiB7CiAgICAgIHRyeSB7CiAgICAgICAgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmVqZWN0KGUpOwogICAgICB9CiAgICB9OwogICAgdmFyIHJlamVjdGVkID0gKHZhbHVlKSA9PiB7CiAgICAgIHRyeSB7CiAgICAgICAgc3RlcChnZW5lcmF0b3IudGhyb3codmFsdWUpKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHJlamVjdChlKTsKICAgICAgfQogICAgfTsKICAgIHZhciBzdGVwID0gKHgpID0+IHguZG9uZSA/IHJlc29sdmUoeC52YWx1ZSkgOiBQcm9taXNlLnJlc29sdmUoeC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsKICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseShfX3RoaXMsIF9fYXJndW1lbnRzKSkubmV4dCgpKTsKICB9KTsKfTsKLyoqCiAqIEBsaWNlbnNlCiAqIENvcHlyaWdodCAyMDEwLTIwMjIgVGhyZWUuanMgQXV0aG9ycwogKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCiAqLwpjb25zdCBSRVZJU0lPTiA9ICIxMzciOwpjb25zdCBNT1VTRSA9IHsgTEVGVDogMCwgTUlERExFOiAxLCBSSUdIVDogMiwgUk9UQVRFOiAwLCBET0xMWTogMSwgUEFOOiAyIH07CmNvbnN0IFRPVUNIID0geyBST1RBVEU6IDAsIFBBTjogMSwgRE9MTFlfUEFOOiAyLCBET0xMWV9ST1RBVEU6IDMgfTsKY29uc3QgQ3VsbEZhY2VOb25lID0gMDsKY29uc3QgQ3VsbEZhY2VCYWNrID0gMTsKY29uc3QgQ3VsbEZhY2VGcm9udCA9IDI7CmNvbnN0IEN1bGxGYWNlRnJvbnRCYWNrID0gMzsKY29uc3QgQmFzaWNTaGFkb3dNYXAgPSAwOwpjb25zdCBQQ0ZTaGFkb3dNYXAgPSAxOwpjb25zdCBQQ0ZTb2Z0U2hhZG93TWFwID0gMjsKY29uc3QgVlNNU2hhZG93TWFwID0gMzsKY29uc3QgRnJvbnRTaWRlID0gMDsKY29uc3QgQmFja1NpZGUgPSAxOwpjb25zdCBEb3VibGVTaWRlID0gMjsKY29uc3QgRmxhdFNoYWRpbmcgPSAxOwpjb25zdCBTbW9vdGhTaGFkaW5nID0gMjsKY29uc3QgTm9CbGVuZGluZyA9IDA7CmNvbnN0IE5vcm1hbEJsZW5kaW5nID0gMTsKY29uc3QgQWRkaXRpdmVCbGVuZGluZyA9IDI7CmNvbnN0IFN1YnRyYWN0aXZlQmxlbmRpbmcgPSAzOwpjb25zdCBNdWx0aXBseUJsZW5kaW5nID0gNDsKY29uc3QgQ3VzdG9tQmxlbmRpbmcgPSA1Owpjb25zdCBBZGRFcXVhdGlvbiA9IDEwMDsKY29uc3QgU3VidHJhY3RFcXVhdGlvbiA9IDEwMTsKY29uc3QgUmV2ZXJzZVN1YnRyYWN0RXF1YXRpb24gPSAxMDI7CmNvbnN0IE1pbkVxdWF0aW9uID0gMTAzOwpjb25zdCBNYXhFcXVhdGlvbiA9IDEwNDsKY29uc3QgWmVyb0ZhY3RvciA9IDIwMDsKY29uc3QgT25lRmFjdG9yID0gMjAxOwpjb25zdCBTcmNDb2xvckZhY3RvciA9IDIwMjsKY29uc3QgT25lTWludXNTcmNDb2xvckZhY3RvciA9IDIwMzsKY29uc3QgU3JjQWxwaGFGYWN0b3IgPSAyMDQ7CmNvbnN0IE9uZU1pbnVzU3JjQWxwaGFGYWN0b3IgPSAyMDU7CmNvbnN0IERzdEFscGhhRmFjdG9yID0gMjA2Owpjb25zdCBPbmVNaW51c0RzdEFscGhhRmFjdG9yID0gMjA3Owpjb25zdCBEc3RDb2xvckZhY3RvciA9IDIwODsKY29uc3QgT25lTWludXNEc3RDb2xvckZhY3RvciA9IDIwOTsKY29uc3QgU3JjQWxwaGFTYXR1cmF0ZUZhY3RvciA9IDIxMDsKY29uc3QgTmV2ZXJEZXB0aCA9IDA7CmNvbnN0IEFsd2F5c0RlcHRoID0gMTsKY29uc3QgTGVzc0RlcHRoID0gMjsKY29uc3QgTGVzc0VxdWFsRGVwdGggPSAzOwpjb25zdCBFcXVhbERlcHRoID0gNDsKY29uc3QgR3JlYXRlckVxdWFsRGVwdGggPSA1Owpjb25zdCBHcmVhdGVyRGVwdGggPSA2Owpjb25zdCBOb3RFcXVhbERlcHRoID0gNzsKY29uc3QgTXVsdGlwbHlPcGVyYXRpb24gPSAwOwpjb25zdCBNaXhPcGVyYXRpb24gPSAxOwpjb25zdCBBZGRPcGVyYXRpb24gPSAyOwpjb25zdCBOb1RvbmVNYXBwaW5nID0gMDsKY29uc3QgTGluZWFyVG9uZU1hcHBpbmcgPSAxOwpjb25zdCBSZWluaGFyZFRvbmVNYXBwaW5nID0gMjsKY29uc3QgQ2luZW9uVG9uZU1hcHBpbmcgPSAzOwpjb25zdCBBQ0VTRmlsbWljVG9uZU1hcHBpbmcgPSA0Owpjb25zdCBDdXN0b21Ub25lTWFwcGluZyA9IDU7CmNvbnN0IFVWTWFwcGluZyA9IDMwMDsKY29uc3QgQ3ViZVJlZmxlY3Rpb25NYXBwaW5nID0gMzAxOwpjb25zdCBDdWJlUmVmcmFjdGlvbk1hcHBpbmcgPSAzMDI7CmNvbnN0IEVxdWlyZWN0YW5ndWxhclJlZmxlY3Rpb25NYXBwaW5nID0gMzAzOwpjb25zdCBFcXVpcmVjdGFuZ3VsYXJSZWZyYWN0aW9uTWFwcGluZyA9IDMwNDsKY29uc3QgQ3ViZVVWUmVmbGVjdGlvbk1hcHBpbmcgPSAzMDY7CmNvbnN0IEN1YmVVVlJlZnJhY3Rpb25NYXBwaW5nID0gMzA3Owpjb25zdCBSZXBlYXRXcmFwcGluZyA9IDFlMzsKY29uc3QgQ2xhbXBUb0VkZ2VXcmFwcGluZyA9IDEwMDE7CmNvbnN0IE1pcnJvcmVkUmVwZWF0V3JhcHBpbmcgPSAxMDAyOwpjb25zdCBOZWFyZXN0RmlsdGVyID0gMTAwMzsKY29uc3QgTmVhcmVzdE1pcG1hcE5lYXJlc3RGaWx0ZXIgPSAxMDA0Owpjb25zdCBOZWFyZXN0TWlwTWFwTmVhcmVzdEZpbHRlciA9IDEwMDQ7CmNvbnN0IE5lYXJlc3RNaXBtYXBMaW5lYXJGaWx0ZXIgPSAxMDA1Owpjb25zdCBOZWFyZXN0TWlwTWFwTGluZWFyRmlsdGVyID0gMTAwNTsKY29uc3QgTGluZWFyRmlsdGVyID0gMTAwNjsKY29uc3QgTGluZWFyTWlwbWFwTmVhcmVzdEZpbHRlciA9IDEwMDc7CmNvbnN0IExpbmVhck1pcE1hcE5lYXJlc3RGaWx0ZXIgPSAxMDA3Owpjb25zdCBMaW5lYXJNaXBtYXBMaW5lYXJGaWx0ZXIgPSAxMDA4Owpjb25zdCBMaW5lYXJNaXBNYXBMaW5lYXJGaWx0ZXIgPSAxMDA4Owpjb25zdCBVbnNpZ25lZEJ5dGVUeXBlID0gMTAwOTsKY29uc3QgQnl0ZVR5cGUgPSAxMDEwOwpjb25zdCBTaG9ydFR5cGUgPSAxMDExOwpjb25zdCBVbnNpZ25lZFNob3J0VHlwZSA9IDEwMTI7CmNvbnN0IEludFR5cGUgPSAxMDEzOwpjb25zdCBVbnNpZ25lZEludFR5cGUgPSAxMDE0Owpjb25zdCBGbG9hdFR5cGUgPSAxMDE1Owpjb25zdCBIYWxmRmxvYXRUeXBlID0gMTAxNjsKY29uc3QgVW5zaWduZWRTaG9ydDQ0NDRUeXBlID0gMTAxNzsKY29uc3QgVW5zaWduZWRTaG9ydDU1NTFUeXBlID0gMTAxODsKY29uc3QgVW5zaWduZWRJbnQyNDhUeXBlID0gMTAyMDsKY29uc3QgQWxwaGFGb3JtYXQgPSAxMDIxOwpjb25zdCBSR0JGb3JtYXQgPSAxMDIyOwpjb25zdCBSR0JBRm9ybWF0ID0gMTAyMzsKY29uc3QgTHVtaW5hbmNlRm9ybWF0ID0gMTAyNDsKY29uc3QgTHVtaW5hbmNlQWxwaGFGb3JtYXQgPSAxMDI1Owpjb25zdCBEZXB0aEZvcm1hdCA9IDEwMjY7CmNvbnN0IERlcHRoU3RlbmNpbEZvcm1hdCA9IDEwMjc7CmNvbnN0IFJlZEZvcm1hdCA9IDEwMjg7CmNvbnN0IFJlZEludGVnZXJGb3JtYXQgPSAxMDI5Owpjb25zdCBSR0Zvcm1hdCA9IDEwMzA7CmNvbnN0IFJHSW50ZWdlckZvcm1hdCA9IDEwMzE7CmNvbnN0IFJHQkFJbnRlZ2VyRm9ybWF0ID0gMTAzMzsKY29uc3QgUkdCX1MzVENfRFhUMV9Gb3JtYXQgPSAzMzc3NjsKY29uc3QgUkdCQV9TM1RDX0RYVDFfRm9ybWF0ID0gMzM3Nzc7CmNvbnN0IFJHQkFfUzNUQ19EWFQzX0Zvcm1hdCA9IDMzNzc4Owpjb25zdCBSR0JBX1MzVENfRFhUNV9Gb3JtYXQgPSAzMzc3OTsKY29uc3QgUkdCX1BWUlRDXzRCUFBWMV9Gb3JtYXQgPSAzNTg0MDsKY29uc3QgUkdCX1BWUlRDXzJCUFBWMV9Gb3JtYXQgPSAzNTg0MTsKY29uc3QgUkdCQV9QVlJUQ180QlBQVjFfRm9ybWF0ID0gMzU4NDI7CmNvbnN0IFJHQkFfUFZSVENfMkJQUFYxX0Zvcm1hdCA9IDM1ODQzOwpjb25zdCBSR0JfRVRDMV9Gb3JtYXQgPSAzNjE5NjsKY29uc3QgUkdCX0VUQzJfRm9ybWF0ID0gMzc0OTI7CmNvbnN0IFJHQkFfRVRDMl9FQUNfRm9ybWF0ID0gMzc0OTY7CmNvbnN0IFJHQkFfQVNUQ180eDRfRm9ybWF0ID0gMzc4MDg7CmNvbnN0IFJHQkFfQVNUQ181eDRfRm9ybWF0ID0gMzc4MDk7CmNvbnN0IFJHQkFfQVNUQ181eDVfRm9ybWF0ID0gMzc4MTA7CmNvbnN0IFJHQkFfQVNUQ182eDVfRm9ybWF0ID0gMzc4MTE7CmNvbnN0IFJHQkFfQVNUQ182eDZfRm9ybWF0ID0gMzc4MTI7CmNvbnN0IFJHQkFfQVNUQ184eDVfRm9ybWF0ID0gMzc4MTM7CmNvbnN0IFJHQkFfQVNUQ184eDZfRm9ybWF0ID0gMzc4MTQ7CmNvbnN0IFJHQkFfQVNUQ184eDhfRm9ybWF0ID0gMzc4MTU7CmNvbnN0IFJHQkFfQVNUQ18xMHg1X0Zvcm1hdCA9IDM3ODE2Owpjb25zdCBSR0JBX0FTVENfMTB4Nl9Gb3JtYXQgPSAzNzgxNzsKY29uc3QgUkdCQV9BU1RDXzEweDhfRm9ybWF0ID0gMzc4MTg7CmNvbnN0IFJHQkFfQVNUQ18xMHgxMF9Gb3JtYXQgPSAzNzgxOTsKY29uc3QgUkdCQV9BU1RDXzEyeDEwX0Zvcm1hdCA9IDM3ODIwOwpjb25zdCBSR0JBX0FTVENfMTJ4MTJfRm9ybWF0ID0gMzc4MjE7CmNvbnN0IFJHQkFfQlBUQ19Gb3JtYXQgPSAzNjQ5MjsKY29uc3QgTG9vcE9uY2UgPSAyMjAwOwpjb25zdCBMb29wUmVwZWF0ID0gMjIwMTsKY29uc3QgTG9vcFBpbmdQb25nID0gMjIwMjsKY29uc3QgSW50ZXJwb2xhdGVEaXNjcmV0ZSA9IDIzMDA7CmNvbnN0IEludGVycG9sYXRlTGluZWFyID0gMjMwMTsKY29uc3QgSW50ZXJwb2xhdGVTbW9vdGggPSAyMzAyOwpjb25zdCBaZXJvQ3VydmF0dXJlRW5kaW5nID0gMjQwMDsKY29uc3QgWmVyb1Nsb3BlRW5kaW5nID0gMjQwMTsKY29uc3QgV3JhcEFyb3VuZEVuZGluZyA9IDI0MDI7CmNvbnN0IE5vcm1hbEFuaW1hdGlvbkJsZW5kTW9kZSA9IDI1MDA7CmNvbnN0IEFkZGl0aXZlQW5pbWF0aW9uQmxlbmRNb2RlID0gMjUwMTsKY29uc3QgVHJpYW5nbGVzRHJhd01vZGUgPSAwOwpjb25zdCBUcmlhbmdsZVN0cmlwRHJhd01vZGUgPSAxOwpjb25zdCBUcmlhbmdsZUZhbkRyYXdNb2RlID0gMjsKY29uc3QgTGluZWFyRW5jb2RpbmcgPSAzZTM7CmNvbnN0IHNSR0JFbmNvZGluZyA9IDMwMDE7CmNvbnN0IEJhc2ljRGVwdGhQYWNraW5nID0gMzIwMDsKY29uc3QgUkdCQURlcHRoUGFja2luZyA9IDMyMDE7CmNvbnN0IFRhbmdlbnRTcGFjZU5vcm1hbE1hcCA9IDA7CmNvbnN0IE9iamVjdFNwYWNlTm9ybWFsTWFwID0gMTsKY29uc3QgWmVyb1N0ZW5jaWxPcCA9IDA7CmNvbnN0IEtlZXBTdGVuY2lsT3AgPSA3NjgwOwpjb25zdCBSZXBsYWNlU3RlbmNpbE9wID0gNzY4MTsKY29uc3QgSW5jcmVtZW50U3RlbmNpbE9wID0gNzY4MjsKY29uc3QgRGVjcmVtZW50U3RlbmNpbE9wID0gNzY4MzsKY29uc3QgSW5jcmVtZW50V3JhcFN0ZW5jaWxPcCA9IDM0MDU1Owpjb25zdCBEZWNyZW1lbnRXcmFwU3RlbmNpbE9wID0gMzQwNTY7CmNvbnN0IEludmVydFN0ZW5jaWxPcCA9IDUzODY7CmNvbnN0IE5ldmVyU3RlbmNpbEZ1bmMgPSA1MTI7CmNvbnN0IExlc3NTdGVuY2lsRnVuYyA9IDUxMzsKY29uc3QgRXF1YWxTdGVuY2lsRnVuYyA9IDUxNDsKY29uc3QgTGVzc0VxdWFsU3RlbmNpbEZ1bmMgPSA1MTU7CmNvbnN0IEdyZWF0ZXJTdGVuY2lsRnVuYyA9IDUxNjsKY29uc3QgTm90RXF1YWxTdGVuY2lsRnVuYyA9IDUxNzsKY29uc3QgR3JlYXRlckVxdWFsU3RlbmNpbEZ1bmMgPSA1MTg7CmNvbnN0IEFsd2F5c1N0ZW5jaWxGdW5jID0gNTE5Owpjb25zdCBTdGF0aWNEcmF3VXNhZ2UgPSAzNTA0NDsKY29uc3QgRHluYW1pY0RyYXdVc2FnZSA9IDM1MDQ4Owpjb25zdCBTdHJlYW1EcmF3VXNhZ2UgPSAzNTA0MDsKY29uc3QgU3RhdGljUmVhZFVzYWdlID0gMzUwNDU7CmNvbnN0IER5bmFtaWNSZWFkVXNhZ2UgPSAzNTA0OTsKY29uc3QgU3RyZWFtUmVhZFVzYWdlID0gMzUwNDE7CmNvbnN0IFN0YXRpY0NvcHlVc2FnZSA9IDM1MDQ2Owpjb25zdCBEeW5hbWljQ29weVVzYWdlID0gMzUwNTA7CmNvbnN0IFN0cmVhbUNvcHlVc2FnZSA9IDM1MDQyOwpjb25zdCBHTFNMMSA9ICIxMDAiOwpjb25zdCBHTFNMMyA9ICIzMDAgZXMiOwpjb25zdCBfU1JHQkFGb3JtYXQgPSAxMDM1OwpjbGFzcyBFdmVudERpc3BhdGNoZXIgewogIGFkZEV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHsKICAgIGlmICh0aGlzLl9saXN0ZW5lcnMgPT09IHZvaWQgMCkKICAgICAgdGhpcy5fbGlzdGVuZXJzID0ge307CiAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLl9saXN0ZW5lcnM7CiAgICBpZiAobGlzdGVuZXJzW3R5cGVdID09PSB2b2lkIDApIHsKICAgICAgbGlzdGVuZXJzW3R5cGVdID0gW107CiAgICB9CiAgICBpZiAobGlzdGVuZXJzW3R5cGVdLmluZGV4T2YobGlzdGVuZXIpID09PSAtMSkgewogICAgICBsaXN0ZW5lcnNbdHlwZV0ucHVzaChsaXN0ZW5lcik7CiAgICB9CiAgfQogIGhhc0V2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHsKICAgIGlmICh0aGlzLl9saXN0ZW5lcnMgPT09IHZvaWQgMCkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwogICAgcmV0dXJuIGxpc3RlbmVyc1t0eXBlXSAhPT0gdm9pZCAwICYmIGxpc3RlbmVyc1t0eXBlXS5pbmRleE9mKGxpc3RlbmVyKSAhPT0gLTE7CiAgfQogIHJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHsKICAgIGlmICh0aGlzLl9saXN0ZW5lcnMgPT09IHZvaWQgMCkKICAgICAgcmV0dXJuOwogICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwogICAgY29uc3QgbGlzdGVuZXJBcnJheSA9IGxpc3RlbmVyc1t0eXBlXTsKICAgIGlmIChsaXN0ZW5lckFycmF5ICE9PSB2b2lkIDApIHsKICAgICAgY29uc3QgaW5kZXggPSBsaXN0ZW5lckFycmF5LmluZGV4T2YobGlzdGVuZXIpOwogICAgICBpZiAoaW5kZXggIT09IC0xKSB7CiAgICAgICAgbGlzdGVuZXJBcnJheS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CiAgICB9CiAgfQogIGRpc3BhdGNoRXZlbnQoZXZlbnQpIHsKICAgIGlmICh0aGlzLl9saXN0ZW5lcnMgPT09IHZvaWQgMCkKICAgICAgcmV0dXJuOwogICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwogICAgY29uc3QgbGlzdGVuZXJBcnJheSA9IGxpc3RlbmVyc1tldmVudC50eXBlXTsKICAgIGlmIChsaXN0ZW5lckFycmF5ICE9PSB2b2lkIDApIHsKICAgICAgZXZlbnQudGFyZ2V0ID0gdGhpczsKICAgICAgY29uc3QgYXJyYXkgPSBsaXN0ZW5lckFycmF5LnNsaWNlKDApOwogICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGFycmF5Lmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGFycmF5W2ldLmNhbGwodGhpcywgZXZlbnQpOwogICAgICB9CiAgICAgIGV2ZW50LnRhcmdldCA9IG51bGw7CiAgICB9CiAgfQp9CmNvbnN0IF9sdXQgPSBbXTsKZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7IGkrKykgewogIF9sdXRbaV0gPSAoaSA8IDE2ID8gIjAiIDogIiIpICsgaS50b1N0cmluZygxNik7Cn0KbGV0IF9zZWVkID0gMTIzNDU2NzsKY29uc3QgREVHMlJBRCA9IE1hdGguUEkgLyAxODA7CmNvbnN0IFJBRDJERUcgPSAxODAgLyBNYXRoLlBJOwpmdW5jdGlvbiBnZW5lcmF0ZVVVSUQoKSB7CiAgY29uc3QgZDAgPSBNYXRoLnJhbmRvbSgpICogNDI5NDk2NzI5NSB8IDA7CiAgY29uc3QgZDEgPSBNYXRoLnJhbmRvbSgpICogNDI5NDk2NzI5NSB8IDA7CiAgY29uc3QgZDIgPSBNYXRoLnJhbmRvbSgpICogNDI5NDk2NzI5NSB8IDA7CiAgY29uc3QgZDMgPSBNYXRoLnJhbmRvbSgpICogNDI5NDk2NzI5NSB8IDA7CiAgY29uc3QgdXVpZCA9IF9sdXRbZDAgJiAyNTVdICsgX2x1dFtkMCA+PiA4ICYgMjU1XSArIF9sdXRbZDAgPj4gMTYgJiAyNTVdICsgX2x1dFtkMCA+PiAyNCAmIDI1NV0gKyAiLSIgKyBfbHV0W2QxICYgMjU1XSArIF9sdXRbZDEgPj4gOCAmIDI1NV0gKyAiLSIgKyBfbHV0W2QxID4+IDE2ICYgMTUgfCA2NF0gKyBfbHV0W2QxID4+IDI0ICYgMjU1XSArICItIiArIF9sdXRbZDIgJiA2MyB8IDEyOF0gKyBfbHV0W2QyID4+IDggJiAyNTVdICsgIi0iICsgX2x1dFtkMiA+PiAxNiAmIDI1NV0gKyBfbHV0W2QyID4+IDI0ICYgMjU1XSArIF9sdXRbZDMgJiAyNTVdICsgX2x1dFtkMyA+PiA4ICYgMjU1XSArIF9sdXRbZDMgPj4gMTYgJiAyNTVdICsgX2x1dFtkMyA+PiAyNCAmIDI1NV07CiAgcmV0dXJuIHV1aWQudG9VcHBlckNhc2UoKTsKfQpmdW5jdGlvbiBjbGFtcCh2YWx1ZSwgbWluLCBtYXgpIHsKICByZXR1cm4gTWF0aC5tYXgobWluLCBNYXRoLm1pbihtYXgsIHZhbHVlKSk7Cn0KZnVuY3Rpb24gZXVjbGlkZWFuTW9kdWxvKG4sIG0pIHsKICByZXR1cm4gKG4gJSBtICsgbSkgJSBtOwp9CmZ1bmN0aW9uIG1hcExpbmVhcih4LCBhMSwgYTIsIGIxLCBiMikgewogIHJldHVybiBiMSArICh4IC0gYTEpICogKGIyIC0gYjEpIC8gKGEyIC0gYTEpOwp9CmZ1bmN0aW9uIGludmVyc2VMZXJwKHgsIHksIHZhbHVlKSB7CiAgaWYgKHggIT09IHkpIHsKICAgIHJldHVybiAodmFsdWUgLSB4KSAvICh5IC0geCk7CiAgfSBlbHNlIHsKICAgIHJldHVybiAwOwogIH0KfQpmdW5jdGlvbiBsZXJwKHgsIHksIHQpIHsKICByZXR1cm4gKDEgLSB0KSAqIHggKyB0ICogeTsKfQpmdW5jdGlvbiBkYW1wKHgsIHksIGxhbWJkYSwgZHQpIHsKICByZXR1cm4gbGVycCh4LCB5LCAxIC0gTWF0aC5leHAoLWxhbWJkYSAqIGR0KSk7Cn0KZnVuY3Rpb24gcGluZ3BvbmcoeCwgbGVuZ3RoID0gMSkgewogIHJldHVybiBsZW5ndGggLSBNYXRoLmFicyhldWNsaWRlYW5Nb2R1bG8oeCwgbGVuZ3RoICogMikgLSBsZW5ndGgpOwp9CmZ1bmN0aW9uIHNtb290aHN0ZXAoeCwgbWluLCBtYXgpIHsKICBpZiAoeCA8PSBtaW4pCiAgICByZXR1cm4gMDsKICBpZiAoeCA+PSBtYXgpCiAgICByZXR1cm4gMTsKICB4ID0gKHggLSBtaW4pIC8gKG1heCAtIG1pbik7CiAgcmV0dXJuIHggKiB4ICogKDMgLSAyICogeCk7Cn0KZnVuY3Rpb24gc21vb3RoZXJzdGVwKHgsIG1pbiwgbWF4KSB7CiAgaWYgKHggPD0gbWluKQogICAgcmV0dXJuIDA7CiAgaWYgKHggPj0gbWF4KQogICAgcmV0dXJuIDE7CiAgeCA9ICh4IC0gbWluKSAvIChtYXggLSBtaW4pOwogIHJldHVybiB4ICogeCAqIHggKiAoeCAqICh4ICogNiAtIDE1KSArIDEwKTsKfQpmdW5jdGlvbiByYW5kSW50KGxvdywgaGlnaCkgewogIHJldHVybiBsb3cgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoaGlnaCAtIGxvdyArIDEpKTsKfQpmdW5jdGlvbiByYW5kRmxvYXQobG93LCBoaWdoKSB7CiAgcmV0dXJuIGxvdyArIE1hdGgucmFuZG9tKCkgKiAoaGlnaCAtIGxvdyk7Cn0KZnVuY3Rpb24gcmFuZEZsb2F0U3ByZWFkKHJhbmdlKSB7CiAgcmV0dXJuIHJhbmdlICogKDAuNSAtIE1hdGgucmFuZG9tKCkpOwp9CmZ1bmN0aW9uIHNlZWRlZFJhbmRvbShzKSB7CiAgaWYgKHMgIT09IHZvaWQgMCkKICAgIF9zZWVkID0gcyAlIDIxNDc0ODM2NDc7CiAgX3NlZWQgPSBfc2VlZCAqIDE2ODA3ICUgMjE0NzQ4MzY0NzsKICByZXR1cm4gKF9zZWVkIC0gMSkgLyAyMTQ3NDgzNjQ2Owp9CmZ1bmN0aW9uIGRlZ1RvUmFkKGRlZ3JlZXMpIHsKICByZXR1cm4gZGVncmVlcyAqIERFRzJSQUQ7Cn0KZnVuY3Rpb24gcmFkVG9EZWcocmFkaWFucykgewogIHJldHVybiByYWRpYW5zICogUkFEMkRFRzsKfQpmdW5jdGlvbiBpc1Bvd2VyT2ZUd28odmFsdWUpIHsKICByZXR1cm4gKHZhbHVlICYgdmFsdWUgLSAxKSA9PT0gMCAmJiB2YWx1ZSAhPT0gMDsKfQpmdW5jdGlvbiBjZWlsUG93ZXJPZlR3byh2YWx1ZSkgewogIHJldHVybiBNYXRoLnBvdygyLCBNYXRoLmNlaWwoTWF0aC5sb2codmFsdWUpIC8gTWF0aC5MTjIpKTsKfQpmdW5jdGlvbiBmbG9vclBvd2VyT2ZUd28odmFsdWUpIHsKICByZXR1cm4gTWF0aC5wb3coMiwgTWF0aC5mbG9vcihNYXRoLmxvZyh2YWx1ZSkgLyBNYXRoLkxOMikpOwp9CmZ1bmN0aW9uIHNldFF1YXRlcm5pb25Gcm9tUHJvcGVyRXVsZXIocSwgYSwgYiwgYywgb3JkZXIpIHsKICBjb25zdCBjb3MgPSBNYXRoLmNvczsKICBjb25zdCBzaW4gPSBNYXRoLnNpbjsKICBjb25zdCBjMiA9IGNvcyhiIC8gMik7CiAgY29uc3QgczIgPSBzaW4oYiAvIDIpOwogIGNvbnN0IGMxMyA9IGNvcygoYSArIGMpIC8gMik7CiAgY29uc3QgczEzID0gc2luKChhICsgYykgLyAyKTsKICBjb25zdCBjMV8zID0gY29zKChhIC0gYykgLyAyKTsKICBjb25zdCBzMV8zID0gc2luKChhIC0gYykgLyAyKTsKICBjb25zdCBjM18xID0gY29zKChjIC0gYSkgLyAyKTsKICBjb25zdCBzM18xID0gc2luKChjIC0gYSkgLyAyKTsKICBzd2l0Y2ggKG9yZGVyKSB7CiAgICBjYXNlICJYWVgiOgogICAgICBxLnNldChjMiAqIHMxMywgczIgKiBjMV8zLCBzMiAqIHMxXzMsIGMyICogYzEzKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICJZWlkiOgogICAgICBxLnNldChzMiAqIHMxXzMsIGMyICogczEzLCBzMiAqIGMxXzMsIGMyICogYzEzKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICJaWFoiOgogICAgICBxLnNldChzMiAqIGMxXzMsIHMyICogczFfMywgYzIgKiBzMTMsIGMyICogYzEzKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICJYWlgiOgogICAgICBxLnNldChjMiAqIHMxMywgczIgKiBzM18xLCBzMiAqIGMzXzEsIGMyICogYzEzKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICJZWFkiOgogICAgICBxLnNldChzMiAqIGMzXzEsIGMyICogczEzLCBzMiAqIHMzXzEsIGMyICogYzEzKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICJaWVoiOgogICAgICBxLnNldChzMiAqIHMzXzEsIHMyICogYzNfMSwgYzIgKiBzMTMsIGMyICogYzEzKTsKICAgICAgYnJlYWs7CiAgICBkZWZhdWx0OgogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLk1hdGhVdGlsczogLnNldFF1YXRlcm5pb25Gcm9tUHJvcGVyRXVsZXIoKSBlbmNvdW50ZXJlZCBhbiB1bmtub3duIG9yZGVyOiAiICsgb3JkZXIpOwogIH0KfQp2YXIgTWF0aFV0aWxzID0gLyogQF9fUFVSRV9fICovIE9iamVjdC5mcmVlemUoewogIF9fcHJvdG9fXzogbnVsbCwKICBERUcyUkFELAogIFJBRDJERUcsCiAgZ2VuZXJhdGVVVUlELAogIGNsYW1wLAogIGV1Y2xpZGVhbk1vZHVsbywKICBtYXBMaW5lYXIsCiAgaW52ZXJzZUxlcnAsCiAgbGVycCwKICBkYW1wLAogIHBpbmdwb25nLAogIHNtb290aHN0ZXAsCiAgc21vb3RoZXJzdGVwLAogIHJhbmRJbnQsCiAgcmFuZEZsb2F0LAogIHJhbmRGbG9hdFNwcmVhZCwKICBzZWVkZWRSYW5kb20sCiAgZGVnVG9SYWQsCiAgcmFkVG9EZWcsCiAgaXNQb3dlck9mVHdvLAogIGNlaWxQb3dlck9mVHdvLAogIGZsb29yUG93ZXJPZlR3bywKICBzZXRRdWF0ZXJuaW9uRnJvbVByb3BlckV1bGVyCn0pOwpjbGFzcyBWZWN0b3IyIHsKICBjb25zdHJ1Y3Rvcih4ID0gMCwgeSA9IDApIHsKICAgIHRoaXMueCA9IHg7CiAgICB0aGlzLnkgPSB5OwogIH0KICBnZXQgd2lkdGgoKSB7CiAgICByZXR1cm4gdGhpcy54OwogIH0KICBzZXQgd2lkdGgodmFsdWUpIHsKICAgIHRoaXMueCA9IHZhbHVlOwogIH0KICBnZXQgaGVpZ2h0KCkgewogICAgcmV0dXJuIHRoaXMueTsKICB9CiAgc2V0IGhlaWdodCh2YWx1ZSkgewogICAgdGhpcy55ID0gdmFsdWU7CiAgfQogIHNldCh4LCB5KSB7CiAgICB0aGlzLnggPSB4OwogICAgdGhpcy55ID0geTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRTY2FsYXIoc2NhbGFyKSB7CiAgICB0aGlzLnggPSBzY2FsYXI7CiAgICB0aGlzLnkgPSBzY2FsYXI7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0WCh4KSB7CiAgICB0aGlzLnggPSB4OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldFkoeSkgewogICAgdGhpcy55ID0geTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRDb21wb25lbnQoaW5kZXgsIHZhbHVlKSB7CiAgICBzd2l0Y2ggKGluZGV4KSB7CiAgICAgIGNhc2UgMDoKICAgICAgICB0aGlzLnggPSB2YWx1ZTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAxOgogICAgICAgIHRoaXMueSA9IHZhbHVlOwogICAgICAgIGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBFcnJvcigiaW5kZXggaXMgb3V0IG9mIHJhbmdlOiAiICsgaW5kZXgpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGdldENvbXBvbmVudChpbmRleCkgewogICAgc3dpdGNoIChpbmRleCkgewogICAgICBjYXNlIDA6CiAgICAgICAgcmV0dXJuIHRoaXMueDsKICAgICAgY2FzZSAxOgogICAgICAgIHJldHVybiB0aGlzLnk7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJpbmRleCBpcyBvdXQgb2YgcmFuZ2U6ICIgKyBpbmRleCk7CiAgICB9CiAgfQogIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueCwgdGhpcy55KTsKICB9CiAgY29weSh2KSB7CiAgICB0aGlzLnggPSB2Lng7CiAgICB0aGlzLnkgPSB2Lnk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgYWRkKHYsIHcpIHsKICAgIGlmICh3ICE9PSB2b2lkIDApIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5WZWN0b3IyOiAuYWRkKCkgbm93IG9ubHkgYWNjZXB0cyBvbmUgYXJndW1lbnQuIFVzZSAuYWRkVmVjdG9ycyggYSwgYiApIGluc3RlYWQuIik7CiAgICAgIHJldHVybiB0aGlzLmFkZFZlY3RvcnModiwgdyk7CiAgICB9CiAgICB0aGlzLnggKz0gdi54OwogICAgdGhpcy55ICs9IHYueTsKICAgIHJldHVybiB0aGlzOwogIH0KICBhZGRTY2FsYXIocykgewogICAgdGhpcy54ICs9IHM7CiAgICB0aGlzLnkgKz0gczsKICAgIHJldHVybiB0aGlzOwogIH0KICBhZGRWZWN0b3JzKGEsIGIpIHsKICAgIHRoaXMueCA9IGEueCArIGIueDsKICAgIHRoaXMueSA9IGEueSArIGIueTsKICAgIHJldHVybiB0aGlzOwogIH0KICBhZGRTY2FsZWRWZWN0b3IodiwgcykgewogICAgdGhpcy54ICs9IHYueCAqIHM7CiAgICB0aGlzLnkgKz0gdi55ICogczsKICAgIHJldHVybiB0aGlzOwogIH0KICBzdWIodiwgdykgewogICAgaWYgKHcgIT09IHZvaWQgMCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLlZlY3RvcjI6IC5zdWIoKSBub3cgb25seSBhY2NlcHRzIG9uZSBhcmd1bWVudC4gVXNlIC5zdWJWZWN0b3JzKCBhLCBiICkgaW5zdGVhZC4iKTsKICAgICAgcmV0dXJuIHRoaXMuc3ViVmVjdG9ycyh2LCB3KTsKICAgIH0KICAgIHRoaXMueCAtPSB2Lng7CiAgICB0aGlzLnkgLT0gdi55OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHN1YlNjYWxhcihzKSB7CiAgICB0aGlzLnggLT0gczsKICAgIHRoaXMueSAtPSBzOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHN1YlZlY3RvcnMoYSwgYikgewogICAgdGhpcy54ID0gYS54IC0gYi54OwogICAgdGhpcy55ID0gYS55IC0gYi55OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG11bHRpcGx5KHYpIHsKICAgIHRoaXMueCAqPSB2Lng7CiAgICB0aGlzLnkgKj0gdi55OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG11bHRpcGx5U2NhbGFyKHNjYWxhcikgewogICAgdGhpcy54ICo9IHNjYWxhcjsKICAgIHRoaXMueSAqPSBzY2FsYXI7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZGl2aWRlKHYpIHsKICAgIHRoaXMueCAvPSB2Lng7CiAgICB0aGlzLnkgLz0gdi55OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGRpdmlkZVNjYWxhcihzY2FsYXIpIHsKICAgIHJldHVybiB0aGlzLm11bHRpcGx5U2NhbGFyKDEgLyBzY2FsYXIpOwogIH0KICBhcHBseU1hdHJpeDMobSkgewogICAgY29uc3QgeCA9IHRoaXMueCwgeSA9IHRoaXMueTsKICAgIGNvbnN0IGUgPSBtLmVsZW1lbnRzOwogICAgdGhpcy54ID0gZVswXSAqIHggKyBlWzNdICogeSArIGVbNl07CiAgICB0aGlzLnkgPSBlWzFdICogeCArIGVbNF0gKiB5ICsgZVs3XTsKICAgIHJldHVybiB0aGlzOwogIH0KICBtaW4odikgewogICAgdGhpcy54ID0gTWF0aC5taW4odGhpcy54LCB2LngpOwogICAgdGhpcy55ID0gTWF0aC5taW4odGhpcy55LCB2LnkpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG1heCh2KSB7CiAgICB0aGlzLnggPSBNYXRoLm1heCh0aGlzLngsIHYueCk7CiAgICB0aGlzLnkgPSBNYXRoLm1heCh0aGlzLnksIHYueSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xhbXAobWluLCBtYXgpIHsKICAgIHRoaXMueCA9IE1hdGgubWF4KG1pbi54LCBNYXRoLm1pbihtYXgueCwgdGhpcy54KSk7CiAgICB0aGlzLnkgPSBNYXRoLm1heChtaW4ueSwgTWF0aC5taW4obWF4LnksIHRoaXMueSkpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNsYW1wU2NhbGFyKG1pblZhbCwgbWF4VmFsKSB7CiAgICB0aGlzLnggPSBNYXRoLm1heChtaW5WYWwsIE1hdGgubWluKG1heFZhbCwgdGhpcy54KSk7CiAgICB0aGlzLnkgPSBNYXRoLm1heChtaW5WYWwsIE1hdGgubWluKG1heFZhbCwgdGhpcy55KSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xhbXBMZW5ndGgobWluLCBtYXgpIHsKICAgIGNvbnN0IGxlbmd0aCA9IHRoaXMubGVuZ3RoKCk7CiAgICByZXR1cm4gdGhpcy5kaXZpZGVTY2FsYXIobGVuZ3RoIHx8IDEpLm11bHRpcGx5U2NhbGFyKE1hdGgubWF4KG1pbiwgTWF0aC5taW4obWF4LCBsZW5ndGgpKSk7CiAgfQogIGZsb29yKCkgewogICAgdGhpcy54ID0gTWF0aC5mbG9vcih0aGlzLngpOwogICAgdGhpcy55ID0gTWF0aC5mbG9vcih0aGlzLnkpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNlaWwoKSB7CiAgICB0aGlzLnggPSBNYXRoLmNlaWwodGhpcy54KTsKICAgIHRoaXMueSA9IE1hdGguY2VpbCh0aGlzLnkpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHJvdW5kKCkgewogICAgdGhpcy54ID0gTWF0aC5yb3VuZCh0aGlzLngpOwogICAgdGhpcy55ID0gTWF0aC5yb3VuZCh0aGlzLnkpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHJvdW5kVG9aZXJvKCkgewogICAgdGhpcy54ID0gdGhpcy54IDwgMCA/IE1hdGguY2VpbCh0aGlzLngpIDogTWF0aC5mbG9vcih0aGlzLngpOwogICAgdGhpcy55ID0gdGhpcy55IDwgMCA/IE1hdGguY2VpbCh0aGlzLnkpIDogTWF0aC5mbG9vcih0aGlzLnkpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG5lZ2F0ZSgpIHsKICAgIHRoaXMueCA9IC10aGlzLng7CiAgICB0aGlzLnkgPSAtdGhpcy55OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGRvdCh2KSB7CiAgICByZXR1cm4gdGhpcy54ICogdi54ICsgdGhpcy55ICogdi55OwogIH0KICBjcm9zcyh2KSB7CiAgICByZXR1cm4gdGhpcy54ICogdi55IC0gdGhpcy55ICogdi54OwogIH0KICBsZW5ndGhTcSgpIHsKICAgIHJldHVybiB0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnk7CiAgfQogIGxlbmd0aCgpIHsKICAgIHJldHVybiBNYXRoLnNxcnQodGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55KTsKICB9CiAgbWFuaGF0dGFuTGVuZ3RoKCkgewogICAgcmV0dXJuIE1hdGguYWJzKHRoaXMueCkgKyBNYXRoLmFicyh0aGlzLnkpOwogIH0KICBub3JtYWxpemUoKSB7CiAgICByZXR1cm4gdGhpcy5kaXZpZGVTY2FsYXIodGhpcy5sZW5ndGgoKSB8fCAxKTsKICB9CiAgYW5nbGUoKSB7CiAgICBjb25zdCBhbmdsZSA9IE1hdGguYXRhbjIoLXRoaXMueSwgLXRoaXMueCkgKyBNYXRoLlBJOwogICAgcmV0dXJuIGFuZ2xlOwogIH0KICBkaXN0YW5jZVRvKHYpIHsKICAgIHJldHVybiBNYXRoLnNxcnQodGhpcy5kaXN0YW5jZVRvU3F1YXJlZCh2KSk7CiAgfQogIGRpc3RhbmNlVG9TcXVhcmVkKHYpIHsKICAgIGNvbnN0IGR4ID0gdGhpcy54IC0gdi54LCBkeSA9IHRoaXMueSAtIHYueTsKICAgIHJldHVybiBkeCAqIGR4ICsgZHkgKiBkeTsKICB9CiAgbWFuaGF0dGFuRGlzdGFuY2VUbyh2KSB7CiAgICByZXR1cm4gTWF0aC5hYnModGhpcy54IC0gdi54KSArIE1hdGguYWJzKHRoaXMueSAtIHYueSk7CiAgfQogIHNldExlbmd0aChsZW5ndGgpIHsKICAgIHJldHVybiB0aGlzLm5vcm1hbGl6ZSgpLm11bHRpcGx5U2NhbGFyKGxlbmd0aCk7CiAgfQogIGxlcnAodiwgYWxwaGEpIHsKICAgIHRoaXMueCArPSAodi54IC0gdGhpcy54KSAqIGFscGhhOwogICAgdGhpcy55ICs9ICh2LnkgLSB0aGlzLnkpICogYWxwaGE7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbGVycFZlY3RvcnModjEsIHYyLCBhbHBoYSkgewogICAgdGhpcy54ID0gdjEueCArICh2Mi54IC0gdjEueCkgKiBhbHBoYTsKICAgIHRoaXMueSA9IHYxLnkgKyAodjIueSAtIHYxLnkpICogYWxwaGE7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZXF1YWxzKHYpIHsKICAgIHJldHVybiB2LnggPT09IHRoaXMueCAmJiB2LnkgPT09IHRoaXMueTsKICB9CiAgZnJvbUFycmF5KGFycmF5LCBvZmZzZXQgPSAwKSB7CiAgICB0aGlzLnggPSBhcnJheVtvZmZzZXRdOwogICAgdGhpcy55ID0gYXJyYXlbb2Zmc2V0ICsgMV07CiAgICByZXR1cm4gdGhpczsKICB9CiAgdG9BcnJheShhcnJheSA9IFtdLCBvZmZzZXQgPSAwKSB7CiAgICBhcnJheVtvZmZzZXRdID0gdGhpcy54OwogICAgYXJyYXlbb2Zmc2V0ICsgMV0gPSB0aGlzLnk7CiAgICByZXR1cm4gYXJyYXk7CiAgfQogIGZyb21CdWZmZXJBdHRyaWJ1dGUoYXR0cmlidXRlLCBpbmRleCwgb2Zmc2V0KSB7CiAgICBpZiAob2Zmc2V0ICE9PSB2b2lkIDApIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5WZWN0b3IyOiBvZmZzZXQgaGFzIGJlZW4gcmVtb3ZlZCBmcm9tIC5mcm9tQnVmZmVyQXR0cmlidXRlKCkuIik7CiAgICB9CiAgICB0aGlzLnggPSBhdHRyaWJ1dGUuZ2V0WChpbmRleCk7CiAgICB0aGlzLnkgPSBhdHRyaWJ1dGUuZ2V0WShpbmRleCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgcm90YXRlQXJvdW5kKGNlbnRlciwgYW5nbGUpIHsKICAgIGNvbnN0IGMgPSBNYXRoLmNvcyhhbmdsZSksIHMgPSBNYXRoLnNpbihhbmdsZSk7CiAgICBjb25zdCB4ID0gdGhpcy54IC0gY2VudGVyLng7CiAgICBjb25zdCB5ID0gdGhpcy55IC0gY2VudGVyLnk7CiAgICB0aGlzLnggPSB4ICogYyAtIHkgKiBzICsgY2VudGVyLng7CiAgICB0aGlzLnkgPSB4ICogcyArIHkgKiBjICsgY2VudGVyLnk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgcmFuZG9tKCkgewogICAgdGhpcy54ID0gTWF0aC5yYW5kb20oKTsKICAgIHRoaXMueSA9IE1hdGgucmFuZG9tKCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgKltTeW1ib2wuaXRlcmF0b3JdKCkgewogICAgeWllbGQgdGhpcy54OwogICAgeWllbGQgdGhpcy55OwogIH0KfQpWZWN0b3IyLnByb3RvdHlwZS5pc1ZlY3RvcjIgPSB0cnVlOwpjbGFzcyBNYXRyaXgzIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHRoaXMuZWxlbWVudHMgPSBbCiAgICAgIDEsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIDEsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIDEKICAgIF07CiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDApIHsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuTWF0cml4MzogdGhlIGNvbnN0cnVjdG9yIG5vIGxvbmdlciByZWFkcyBhcmd1bWVudHMuIHVzZSAuc2V0KCkgaW5zdGVhZC4iKTsKICAgIH0KICB9CiAgc2V0KG4xMSwgbjEyLCBuMTMsIG4yMSwgbjIyLCBuMjMsIG4zMSwgbjMyLCBuMzMpIHsKICAgIGNvbnN0IHRlID0gdGhpcy5lbGVtZW50czsKICAgIHRlWzBdID0gbjExOwogICAgdGVbMV0gPSBuMjE7CiAgICB0ZVsyXSA9IG4zMTsKICAgIHRlWzNdID0gbjEyOwogICAgdGVbNF0gPSBuMjI7CiAgICB0ZVs1XSA9IG4zMjsKICAgIHRlWzZdID0gbjEzOwogICAgdGVbN10gPSBuMjM7CiAgICB0ZVs4XSA9IG4zMzsKICAgIHJldHVybiB0aGlzOwogIH0KICBpZGVudGl0eSgpIHsKICAgIHRoaXMuc2V0KDEsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDEpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNvcHkobSkgewogICAgY29uc3QgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgY29uc3QgbWUgPSBtLmVsZW1lbnRzOwogICAgdGVbMF0gPSBtZVswXTsKICAgIHRlWzFdID0gbWVbMV07CiAgICB0ZVsyXSA9IG1lWzJdOwogICAgdGVbM10gPSBtZVszXTsKICAgIHRlWzRdID0gbWVbNF07CiAgICB0ZVs1XSA9IG1lWzVdOwogICAgdGVbNl0gPSBtZVs2XTsKICAgIHRlWzddID0gbWVbN107CiAgICB0ZVs4XSA9IG1lWzhdOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGV4dHJhY3RCYXNpcyh4QXhpcywgeUF4aXMsIHpBeGlzKSB7CiAgICB4QXhpcy5zZXRGcm9tTWF0cml4M0NvbHVtbih0aGlzLCAwKTsKICAgIHlBeGlzLnNldEZyb21NYXRyaXgzQ29sdW1uKHRoaXMsIDEpOwogICAgekF4aXMuc2V0RnJvbU1hdHJpeDNDb2x1bW4odGhpcywgMik7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0RnJvbU1hdHJpeDQobSkgewogICAgY29uc3QgbWUgPSBtLmVsZW1lbnRzOwogICAgdGhpcy5zZXQobWVbMF0sIG1lWzRdLCBtZVs4XSwgbWVbMV0sIG1lWzVdLCBtZVs5XSwgbWVbMl0sIG1lWzZdLCBtZVsxMF0pOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG11bHRpcGx5KG0pIHsKICAgIHJldHVybiB0aGlzLm11bHRpcGx5TWF0cmljZXModGhpcywgbSk7CiAgfQogIHByZW11bHRpcGx5KG0pIHsKICAgIHJldHVybiB0aGlzLm11bHRpcGx5TWF0cmljZXMobSwgdGhpcyk7CiAgfQogIG11bHRpcGx5TWF0cmljZXMoYSwgYikgewogICAgY29uc3QgYWUgPSBhLmVsZW1lbnRzOwogICAgY29uc3QgYmUgPSBiLmVsZW1lbnRzOwogICAgY29uc3QgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgY29uc3QgYTExID0gYWVbMF0sIGExMiA9IGFlWzNdLCBhMTMgPSBhZVs2XTsKICAgIGNvbnN0IGEyMSA9IGFlWzFdLCBhMjIgPSBhZVs0XSwgYTIzID0gYWVbN107CiAgICBjb25zdCBhMzEgPSBhZVsyXSwgYTMyID0gYWVbNV0sIGEzMyA9IGFlWzhdOwogICAgY29uc3QgYjExID0gYmVbMF0sIGIxMiA9IGJlWzNdLCBiMTMgPSBiZVs2XTsKICAgIGNvbnN0IGIyMSA9IGJlWzFdLCBiMjIgPSBiZVs0XSwgYjIzID0gYmVbN107CiAgICBjb25zdCBiMzEgPSBiZVsyXSwgYjMyID0gYmVbNV0sIGIzMyA9IGJlWzhdOwogICAgdGVbMF0gPSBhMTEgKiBiMTEgKyBhMTIgKiBiMjEgKyBhMTMgKiBiMzE7CiAgICB0ZVszXSA9IGExMSAqIGIxMiArIGExMiAqIGIyMiArIGExMyAqIGIzMjsKICAgIHRlWzZdID0gYTExICogYjEzICsgYTEyICogYjIzICsgYTEzICogYjMzOwogICAgdGVbMV0gPSBhMjEgKiBiMTEgKyBhMjIgKiBiMjEgKyBhMjMgKiBiMzE7CiAgICB0ZVs0XSA9IGEyMSAqIGIxMiArIGEyMiAqIGIyMiArIGEyMyAqIGIzMjsKICAgIHRlWzddID0gYTIxICogYjEzICsgYTIyICogYjIzICsgYTIzICogYjMzOwogICAgdGVbMl0gPSBhMzEgKiBiMTEgKyBhMzIgKiBiMjEgKyBhMzMgKiBiMzE7CiAgICB0ZVs1XSA9IGEzMSAqIGIxMiArIGEzMiAqIGIyMiArIGEzMyAqIGIzMjsKICAgIHRlWzhdID0gYTMxICogYjEzICsgYTMyICogYjIzICsgYTMzICogYjMzOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG11bHRpcGx5U2NhbGFyKHMpIHsKICAgIGNvbnN0IHRlID0gdGhpcy5lbGVtZW50czsKICAgIHRlWzBdICo9IHM7CiAgICB0ZVszXSAqPSBzOwogICAgdGVbNl0gKj0gczsKICAgIHRlWzFdICo9IHM7CiAgICB0ZVs0XSAqPSBzOwogICAgdGVbN10gKj0gczsKICAgIHRlWzJdICo9IHM7CiAgICB0ZVs1XSAqPSBzOwogICAgdGVbOF0gKj0gczsKICAgIHJldHVybiB0aGlzOwogIH0KICBkZXRlcm1pbmFudCgpIHsKICAgIGNvbnN0IHRlID0gdGhpcy5lbGVtZW50czsKICAgIGNvbnN0IGEgPSB0ZVswXSwgYiA9IHRlWzFdLCBjID0gdGVbMl0sIGQgPSB0ZVszXSwgZSA9IHRlWzRdLCBmID0gdGVbNV0sIGcgPSB0ZVs2XSwgaCA9IHRlWzddLCBpID0gdGVbOF07CiAgICByZXR1cm4gYSAqIGUgKiBpIC0gYSAqIGYgKiBoIC0gYiAqIGQgKiBpICsgYiAqIGYgKiBnICsgYyAqIGQgKiBoIC0gYyAqIGUgKiBnOwogIH0KICBpbnZlcnQoKSB7CiAgICBjb25zdCB0ZSA9IHRoaXMuZWxlbWVudHMsIG4xMSA9IHRlWzBdLCBuMjEgPSB0ZVsxXSwgbjMxID0gdGVbMl0sIG4xMiA9IHRlWzNdLCBuMjIgPSB0ZVs0XSwgbjMyID0gdGVbNV0sIG4xMyA9IHRlWzZdLCBuMjMgPSB0ZVs3XSwgbjMzID0gdGVbOF0sIHQxMSA9IG4zMyAqIG4yMiAtIG4zMiAqIG4yMywgdDEyID0gbjMyICogbjEzIC0gbjMzICogbjEyLCB0MTMgPSBuMjMgKiBuMTIgLSBuMjIgKiBuMTMsIGRldCA9IG4xMSAqIHQxMSArIG4yMSAqIHQxMiArIG4zMSAqIHQxMzsKICAgIGlmIChkZXQgPT09IDApCiAgICAgIHJldHVybiB0aGlzLnNldCgwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwKTsKICAgIGNvbnN0IGRldEludiA9IDEgLyBkZXQ7CiAgICB0ZVswXSA9IHQxMSAqIGRldEludjsKICAgIHRlWzFdID0gKG4zMSAqIG4yMyAtIG4zMyAqIG4yMSkgKiBkZXRJbnY7CiAgICB0ZVsyXSA9IChuMzIgKiBuMjEgLSBuMzEgKiBuMjIpICogZGV0SW52OwogICAgdGVbM10gPSB0MTIgKiBkZXRJbnY7CiAgICB0ZVs0XSA9IChuMzMgKiBuMTEgLSBuMzEgKiBuMTMpICogZGV0SW52OwogICAgdGVbNV0gPSAobjMxICogbjEyIC0gbjMyICogbjExKSAqIGRldEludjsKICAgIHRlWzZdID0gdDEzICogZGV0SW52OwogICAgdGVbN10gPSAobjIxICogbjEzIC0gbjIzICogbjExKSAqIGRldEludjsKICAgIHRlWzhdID0gKG4yMiAqIG4xMSAtIG4yMSAqIG4xMikgKiBkZXRJbnY7CiAgICByZXR1cm4gdGhpczsKICB9CiAgdHJhbnNwb3NlKCkgewogICAgbGV0IHRtcDI7CiAgICBjb25zdCBtID0gdGhpcy5lbGVtZW50czsKICAgIHRtcDIgPSBtWzFdOwogICAgbVsxXSA9IG1bM107CiAgICBtWzNdID0gdG1wMjsKICAgIHRtcDIgPSBtWzJdOwogICAgbVsyXSA9IG1bNl07CiAgICBtWzZdID0gdG1wMjsKICAgIHRtcDIgPSBtWzVdOwogICAgbVs1XSA9IG1bN107CiAgICBtWzddID0gdG1wMjsKICAgIHJldHVybiB0aGlzOwogIH0KICBnZXROb3JtYWxNYXRyaXgobWF0cml4NCkgewogICAgcmV0dXJuIHRoaXMuc2V0RnJvbU1hdHJpeDQobWF0cml4NCkuaW52ZXJ0KCkudHJhbnNwb3NlKCk7CiAgfQogIHRyYW5zcG9zZUludG9BcnJheShyKSB7CiAgICBjb25zdCBtID0gdGhpcy5lbGVtZW50czsKICAgIHJbMF0gPSBtWzBdOwogICAgclsxXSA9IG1bM107CiAgICByWzJdID0gbVs2XTsKICAgIHJbM10gPSBtWzFdOwogICAgcls0XSA9IG1bNF07CiAgICByWzVdID0gbVs3XTsKICAgIHJbNl0gPSBtWzJdOwogICAgcls3XSA9IG1bNV07CiAgICByWzhdID0gbVs4XTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRVdlRyYW5zZm9ybSh0eCwgdHksIHN4LCBzeSwgcm90YXRpb24sIGN4LCBjeSkgewogICAgY29uc3QgYyA9IE1hdGguY29zKHJvdGF0aW9uKTsKICAgIGNvbnN0IHMgPSBNYXRoLnNpbihyb3RhdGlvbik7CiAgICB0aGlzLnNldChzeCAqIGMsIHN4ICogcywgLXN4ICogKGMgKiBjeCArIHMgKiBjeSkgKyBjeCArIHR4LCAtc3kgKiBzLCBzeSAqIGMsIC1zeSAqICgtcyAqIGN4ICsgYyAqIGN5KSArIGN5ICsgdHksIDAsIDAsIDEpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNjYWxlKHN4LCBzeSkgewogICAgY29uc3QgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgdGVbMF0gKj0gc3g7CiAgICB0ZVszXSAqPSBzeDsKICAgIHRlWzZdICo9IHN4OwogICAgdGVbMV0gKj0gc3k7CiAgICB0ZVs0XSAqPSBzeTsKICAgIHRlWzddICo9IHN5OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHJvdGF0ZSh0aGV0YSkgewogICAgY29uc3QgYyA9IE1hdGguY29zKHRoZXRhKTsKICAgIGNvbnN0IHMgPSBNYXRoLnNpbih0aGV0YSk7CiAgICBjb25zdCB0ZSA9IHRoaXMuZWxlbWVudHM7CiAgICBjb25zdCBhMTEgPSB0ZVswXSwgYTEyID0gdGVbM10sIGExMyA9IHRlWzZdOwogICAgY29uc3QgYTIxID0gdGVbMV0sIGEyMiA9IHRlWzRdLCBhMjMgPSB0ZVs3XTsKICAgIHRlWzBdID0gYyAqIGExMSArIHMgKiBhMjE7CiAgICB0ZVszXSA9IGMgKiBhMTIgKyBzICogYTIyOwogICAgdGVbNl0gPSBjICogYTEzICsgcyAqIGEyMzsKICAgIHRlWzFdID0gLXMgKiBhMTEgKyBjICogYTIxOwogICAgdGVbNF0gPSAtcyAqIGExMiArIGMgKiBhMjI7CiAgICB0ZVs3XSA9IC1zICogYTEzICsgYyAqIGEyMzsKICAgIHJldHVybiB0aGlzOwogIH0KICB0cmFuc2xhdGUodHgsIHR5KSB7CiAgICBjb25zdCB0ZSA9IHRoaXMuZWxlbWVudHM7CiAgICB0ZVswXSArPSB0eCAqIHRlWzJdOwogICAgdGVbM10gKz0gdHggKiB0ZVs1XTsKICAgIHRlWzZdICs9IHR4ICogdGVbOF07CiAgICB0ZVsxXSArPSB0eSAqIHRlWzJdOwogICAgdGVbNF0gKz0gdHkgKiB0ZVs1XTsKICAgIHRlWzddICs9IHR5ICogdGVbOF07CiAgICByZXR1cm4gdGhpczsKICB9CiAgZXF1YWxzKG1hdHJpeCkgewogICAgY29uc3QgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgY29uc3QgbWUgPSBtYXRyaXguZWxlbWVudHM7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDk7IGkrKykgewogICAgICBpZiAodGVbaV0gIT09IG1lW2ldKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHJldHVybiB0cnVlOwogIH0KICBmcm9tQXJyYXkoYXJyYXksIG9mZnNldCA9IDApIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgOTsgaSsrKSB7CiAgICAgIHRoaXMuZWxlbWVudHNbaV0gPSBhcnJheVtpICsgb2Zmc2V0XTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICB0b0FycmF5KGFycmF5ID0gW10sIG9mZnNldCA9IDApIHsKICAgIGNvbnN0IHRlID0gdGhpcy5lbGVtZW50czsKICAgIGFycmF5W29mZnNldF0gPSB0ZVswXTsKICAgIGFycmF5W29mZnNldCArIDFdID0gdGVbMV07CiAgICBhcnJheVtvZmZzZXQgKyAyXSA9IHRlWzJdOwogICAgYXJyYXlbb2Zmc2V0ICsgM10gPSB0ZVszXTsKICAgIGFycmF5W29mZnNldCArIDRdID0gdGVbNF07CiAgICBhcnJheVtvZmZzZXQgKyA1XSA9IHRlWzVdOwogICAgYXJyYXlbb2Zmc2V0ICsgNl0gPSB0ZVs2XTsKICAgIGFycmF5W29mZnNldCArIDddID0gdGVbN107CiAgICBhcnJheVtvZmZzZXQgKyA4XSA9IHRlWzhdOwogICAgcmV0dXJuIGFycmF5OwogIH0KICBjbG9uZSgpIHsKICAgIHJldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3RvcigpLmZyb21BcnJheSh0aGlzLmVsZW1lbnRzKTsKICB9Cn0KTWF0cml4My5wcm90b3R5cGUuaXNNYXRyaXgzID0gdHJ1ZTsKZnVuY3Rpb24gYXJyYXlOZWVkc1VpbnQzMihhcnJheSkgewogIGZvciAobGV0IGkgPSBhcnJheS5sZW5ndGggLSAxOyBpID49IDA7IC0taSkgewogICAgaWYgKGFycmF5W2ldID4gNjU1MzUpCiAgICAgIHJldHVybiB0cnVlOwogIH0KICByZXR1cm4gZmFsc2U7Cn0KY29uc3QgVFlQRURfQVJSQVlTID0gewogIEludDhBcnJheSwKICBVaW50OEFycmF5LAogIFVpbnQ4Q2xhbXBlZEFycmF5LAogIEludDE2QXJyYXksCiAgVWludDE2QXJyYXksCiAgSW50MzJBcnJheSwKICBVaW50MzJBcnJheSwKICBGbG9hdDMyQXJyYXksCiAgRmxvYXQ2NEFycmF5Cn07CmZ1bmN0aW9uIGdldFR5cGVkQXJyYXkodHlwZSwgYnVmZmVyKSB7CiAgcmV0dXJuIG5ldyBUWVBFRF9BUlJBWVNbdHlwZV0oYnVmZmVyKTsKfQpmdW5jdGlvbiBjcmVhdGVFbGVtZW50TlMobmFtZSkgewogIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiLCBuYW1lKTsKfQpjb25zdCBfY29sb3JLZXl3b3JkcyA9IHsKICAiYWxpY2VibHVlIjogMTU3OTIzODMsCiAgImFudGlxdWV3aGl0ZSI6IDE2NDQ0Mzc1LAogICJhcXVhIjogNjU1MzUsCiAgImFxdWFtYXJpbmUiOiA4Mzg4NTY0LAogICJhenVyZSI6IDE1Nzk0MTc1LAogICJiZWlnZSI6IDE2MTE5MjYwLAogICJiaXNxdWUiOiAxNjc3MDI0NCwKICAiYmxhY2siOiAwLAogICJibGFuY2hlZGFsbW9uZCI6IDE2NzcyMDQ1LAogICJibHVlIjogMjU1LAogICJibHVldmlvbGV0IjogOTA1NTIwMiwKICAiYnJvd24iOiAxMDgyNDIzNCwKICAiYnVybHl3b29kIjogMTQ1OTYyMzEsCiAgImNhZGV0Ymx1ZSI6IDYyNjY1MjgsCiAgImNoYXJ0cmV1c2UiOiA4Mzg4MzUyLAogICJjaG9jb2xhdGUiOiAxMzc4OTQ3MCwKICAiY29yYWwiOiAxNjc0NDI3MiwKICAiY29ybmZsb3dlcmJsdWUiOiA2NTkxOTgxLAogICJjb3Juc2lsayI6IDE2Nzc1Mzg4LAogICJjcmltc29uIjogMTQ0MjMxMDAsCiAgImN5YW4iOiA2NTUzNSwKICAiZGFya2JsdWUiOiAxMzksCiAgImRhcmtjeWFuIjogMzU3MjMsCiAgImRhcmtnb2xkZW5yb2QiOiAxMjA5MjkzOSwKICAiZGFya2dyYXkiOiAxMTExOTAxNywKICAiZGFya2dyZWVuIjogMjU2MDAsCiAgImRhcmtncmV5IjogMTExMTkwMTcsCiAgImRhcmtraGFraSI6IDEyNDMzMjU5LAogICJkYXJrbWFnZW50YSI6IDkxMDk2NDMsCiAgImRhcmtvbGl2ZWdyZWVuIjogNTU5Nzk5OSwKICAiZGFya29yYW5nZSI6IDE2NzQ3NTIwLAogICJkYXJrb3JjaGlkIjogMTAwNDAwMTIsCiAgImRhcmtyZWQiOiA5MTA5NTA0LAogICJkYXJrc2FsbW9uIjogMTUzMDg0MTAsCiAgImRhcmtzZWFncmVlbiI6IDk0MTk5MTksCiAgImRhcmtzbGF0ZWJsdWUiOiA0NzM0MzQ3LAogICJkYXJrc2xhdGVncmF5IjogMzEwMDQ5NSwKICAiZGFya3NsYXRlZ3JleSI6IDMxMDA0OTUsCiAgImRhcmt0dXJxdW9pc2UiOiA1Mjk0NSwKICAiZGFya3Zpb2xldCI6IDk2OTk1MzksCiAgImRlZXBwaW5rIjogMTY3MTY5NDcsCiAgImRlZXBza3libHVlIjogNDkxNTEsCiAgImRpbWdyYXkiOiA2OTA4MjY1LAogICJkaW1ncmV5IjogNjkwODI2NSwKICAiZG9kZ2VyYmx1ZSI6IDIwMDMxOTksCiAgImZpcmVicmljayI6IDExNjc0MTQ2LAogICJmbG9yYWx3aGl0ZSI6IDE2Nzc1OTIwLAogICJmb3Jlc3RncmVlbiI6IDIyNjM4NDIsCiAgImZ1Y2hzaWEiOiAxNjcxMTkzNSwKICAiZ2FpbnNib3JvIjogMTQ0NzQ0NjAsCiAgImdob3N0d2hpdGUiOiAxNjMxNjY3MSwKICAiZ29sZCI6IDE2NzY2NzIwLAogICJnb2xkZW5yb2QiOiAxNDMyOTEyMCwKICAiZ3JheSI6IDg0MjE1MDQsCiAgImdyZWVuIjogMzI3NjgsCiAgImdyZWVueWVsbG93IjogMTE0MDMwNTUsCiAgImdyZXkiOiA4NDIxNTA0LAogICJob25leWRldyI6IDE1Nzk0MTYwLAogICJob3RwaW5rIjogMTY3Mzg3NDAsCiAgImluZGlhbnJlZCI6IDEzNDU4NTI0LAogICJpbmRpZ28iOiA0OTE1MzMwLAogICJpdm9yeSI6IDE2Nzc3MjAwLAogICJraGFraSI6IDE1Nzg3NjYwLAogICJsYXZlbmRlciI6IDE1MTMyNDEwLAogICJsYXZlbmRlcmJsdXNoIjogMTY3NzMzNjUsCiAgImxhd25ncmVlbiI6IDgxOTA5NzYsCiAgImxlbW9uY2hpZmZvbiI6IDE2Nzc1ODg1LAogICJsaWdodGJsdWUiOiAxMTM5MzI1NCwKICAibGlnaHRjb3JhbCI6IDE1NzYxNTM2LAogICJsaWdodGN5YW4iOiAxNDc0NTU5OSwKICAibGlnaHRnb2xkZW5yb2R5ZWxsb3ciOiAxNjQ0ODIxMCwKICAibGlnaHRncmF5IjogMTM4ODIzMjMsCiAgImxpZ2h0Z3JlZW4iOiA5NDk4MjU2LAogICJsaWdodGdyZXkiOiAxMzg4MjMyMywKICAibGlnaHRwaW5rIjogMTY3NTg0NjUsCiAgImxpZ2h0c2FsbW9uIjogMTY3NTI3NjIsCiAgImxpZ2h0c2VhZ3JlZW4iOiAyMTQyODkwLAogICJsaWdodHNreWJsdWUiOiA4OTAwMzQ2LAogICJsaWdodHNsYXRlZ3JheSI6IDc4MzM3NTMsCiAgImxpZ2h0c2xhdGVncmV5IjogNzgzMzc1MywKICAibGlnaHRzdGVlbGJsdWUiOiAxMTU4NDczNCwKICAibGlnaHR5ZWxsb3ciOiAxNjc3NzE4NCwKICAibGltZSI6IDY1MjgwLAogICJsaW1lZ3JlZW4iOiAzMzI5MzMwLAogICJsaW5lbiI6IDE2NDQ1NjcwLAogICJtYWdlbnRhIjogMTY3MTE5MzUsCiAgIm1hcm9vbiI6IDgzODg2MDgsCiAgIm1lZGl1bWFxdWFtYXJpbmUiOiA2NzM3MzIyLAogICJtZWRpdW1ibHVlIjogMjA1LAogICJtZWRpdW1vcmNoaWQiOiAxMjIxMTY2NywKICAibWVkaXVtcHVycGxlIjogOTY2MjY4MywKICAibWVkaXVtc2VhZ3JlZW4iOiAzOTc4MDk3LAogICJtZWRpdW1zbGF0ZWJsdWUiOiA4MDg3NzkwLAogICJtZWRpdW1zcHJpbmdncmVlbiI6IDY0MTU0LAogICJtZWRpdW10dXJxdW9pc2UiOiA0NzcyMzAwLAogICJtZWRpdW12aW9sZXRyZWQiOiAxMzA0NzE3MywKICAibWlkbmlnaHRibHVlIjogMTY0NDkxMiwKICAibWludGNyZWFtIjogMTYxMjE4NTAsCiAgIm1pc3R5cm9zZSI6IDE2NzcwMjczLAogICJtb2NjYXNpbiI6IDE2NzcwMjI5LAogICJuYXZham93aGl0ZSI6IDE2NzY4Njg1LAogICJuYXZ5IjogMTI4LAogICJvbGRsYWNlIjogMTY2NDM1NTgsCiAgIm9saXZlIjogODQyMTM3NiwKICAib2xpdmVkcmFiIjogNzA0ODczOSwKICAib3JhbmdlIjogMTY3NTM5MjAsCiAgIm9yYW5nZXJlZCI6IDE2NzI5MzQ0LAogICJvcmNoaWQiOiAxNDMxNTczNCwKICAicGFsZWdvbGRlbnJvZCI6IDE1NjU3MTMwLAogICJwYWxlZ3JlZW4iOiAxMDAyNTg4MCwKICAicGFsZXR1cnF1b2lzZSI6IDExNTI5OTY2LAogICJwYWxldmlvbGV0cmVkIjogMTQzODEyMDMsCiAgInBhcGF5YXdoaXAiOiAxNjc3MzA3NywKICAicGVhY2hwdWZmIjogMTY3Njc2NzMsCiAgInBlcnUiOiAxMzQ2ODk5MSwKICAicGluayI6IDE2NzYxMDM1LAogICJwbHVtIjogMTQ1MjQ2MzcsCiAgInBvd2RlcmJsdWUiOiAxMTU5MTkxMCwKICAicHVycGxlIjogODM4ODczNiwKICAicmViZWNjYXB1cnBsZSI6IDY2OTc4ODEsCiAgInJlZCI6IDE2NzExNjgwLAogICJyb3N5YnJvd24iOiAxMjM1NzUxOSwKICAicm95YWxibHVlIjogNDI4Njk0NSwKICAic2FkZGxlYnJvd24iOiA5MTI3MTg3LAogICJzYWxtb24iOiAxNjQxNjg4MiwKICAic2FuZHlicm93biI6IDE2MDMyODY0LAogICJzZWFncmVlbiI6IDMwNTAzMjcsCiAgInNlYXNoZWxsIjogMTY3NzQ2MzgsCiAgInNpZW5uYSI6IDEwNTA2Nzk3LAogICJzaWx2ZXIiOiAxMjYzMjI1NiwKICAic2t5Ymx1ZSI6IDg5MDAzMzEsCiAgInNsYXRlYmx1ZSI6IDY5NzAwNjEsCiAgInNsYXRlZ3JheSI6IDczNzI5NDQsCiAgInNsYXRlZ3JleSI6IDczNzI5NDQsCiAgInNub3ciOiAxNjc3NTkzMCwKICAic3ByaW5nZ3JlZW4iOiA2NTQwNywKICAic3RlZWxibHVlIjogNDYyMDk4MCwKICAidGFuIjogMTM4MDg3ODAsCiAgInRlYWwiOiAzMjg5NiwKICAidGhpc3RsZSI6IDE0MjA0ODg4LAogICJ0b21hdG8iOiAxNjczNzA5NSwKICAidHVycXVvaXNlIjogNDI1MTg1NiwKICAidmlvbGV0IjogMTU2MzEwODYsCiAgIndoZWF0IjogMTYxMTMzMzEsCiAgIndoaXRlIjogMTY3NzcyMTUsCiAgIndoaXRlc21va2UiOiAxNjExOTI4NSwKICAieWVsbG93IjogMTY3NzY5NjAsCiAgInllbGxvd2dyZWVuIjogMTAxNDUwNzQKfTsKY29uc3QgX2hzbEEgPSB7IGg6IDAsIHM6IDAsIGw6IDAgfTsKY29uc3QgX2hzbEIgPSB7IGg6IDAsIHM6IDAsIGw6IDAgfTsKZnVuY3Rpb24gaHVlMnJnYihwLCBxLCB0KSB7CiAgaWYgKHQgPCAwKQogICAgdCArPSAxOwogIGlmICh0ID4gMSkKICAgIHQgLT0gMTsKICBpZiAodCA8IDEgLyA2KQogICAgcmV0dXJuIHAgKyAocSAtIHApICogNiAqIHQ7CiAgaWYgKHQgPCAxIC8gMikKICAgIHJldHVybiBxOwogIGlmICh0IDwgMiAvIDMpCiAgICByZXR1cm4gcCArIChxIC0gcCkgKiA2ICogKDIgLyAzIC0gdCk7CiAgcmV0dXJuIHA7Cn0KZnVuY3Rpb24gU1JHQlRvTGluZWFyKGMpIHsKICByZXR1cm4gYyA8IDAuMDQwNDUgPyBjICogMC4wNzczOTkzODA4IDogTWF0aC5wb3coYyAqIDAuOTQ3ODY3Mjk4NiArIDAuMDUyMTMyNzAxNCwgMi40KTsKfQpmdW5jdGlvbiBMaW5lYXJUb1NSR0IoYykgewogIHJldHVybiBjIDwgMzEzMDhlLTcgPyBjICogMTIuOTIgOiAxLjA1NSAqIE1hdGgucG93KGMsIDAuNDE2NjYpIC0gMC4wNTU7Cn0KY2xhc3MgQ29sb3IgewogIGNvbnN0cnVjdG9yKHIsIGcsIGIpIHsKICAgIGlmIChnID09PSB2b2lkIDAgJiYgYiA9PT0gdm9pZCAwKSB7CiAgICAgIHJldHVybiB0aGlzLnNldChyKTsKICAgIH0KICAgIHJldHVybiB0aGlzLnNldFJHQihyLCBnLCBiKTsKICB9CiAgc2V0KHZhbHVlKSB7CiAgICBpZiAodmFsdWUgJiYgdmFsdWUuaXNDb2xvcikgewogICAgICB0aGlzLmNvcHkodmFsdWUpOwogICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICJudW1iZXIiKSB7CiAgICAgIHRoaXMuc2V0SGV4KHZhbHVlKTsKICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAic3RyaW5nIikgewogICAgICB0aGlzLnNldFN0eWxlKHZhbHVlKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRTY2FsYXIoc2NhbGFyKSB7CiAgICB0aGlzLnIgPSBzY2FsYXI7CiAgICB0aGlzLmcgPSBzY2FsYXI7CiAgICB0aGlzLmIgPSBzY2FsYXI7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0SGV4KGhleCkgewogICAgaGV4ID0gTWF0aC5mbG9vcihoZXgpOwogICAgdGhpcy5yID0gKGhleCA+PiAxNiAmIDI1NSkgLyAyNTU7CiAgICB0aGlzLmcgPSAoaGV4ID4+IDggJiAyNTUpIC8gMjU1OwogICAgdGhpcy5iID0gKGhleCAmIDI1NSkgLyAyNTU7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0UkdCKHIsIGcsIGIpIHsKICAgIHRoaXMuciA9IHI7CiAgICB0aGlzLmcgPSBnOwogICAgdGhpcy5iID0gYjsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRIU0woaCwgcywgbCkgewogICAgaCA9IGV1Y2xpZGVhbk1vZHVsbyhoLCAxKTsKICAgIHMgPSBjbGFtcChzLCAwLCAxKTsKICAgIGwgPSBjbGFtcChsLCAwLCAxKTsKICAgIGlmIChzID09PSAwKSB7CiAgICAgIHRoaXMuciA9IHRoaXMuZyA9IHRoaXMuYiA9IGw7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBwID0gbCA8PSAwLjUgPyBsICogKDEgKyBzKSA6IGwgKyBzIC0gbCAqIHM7CiAgICAgIGNvbnN0IHEgPSAyICogbCAtIHA7CiAgICAgIHRoaXMuciA9IGh1ZTJyZ2IocSwgcCwgaCArIDEgLyAzKTsKICAgICAgdGhpcy5nID0gaHVlMnJnYihxLCBwLCBoKTsKICAgICAgdGhpcy5iID0gaHVlMnJnYihxLCBwLCBoIC0gMSAvIDMpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldFN0eWxlKHN0eWxlKSB7CiAgICBmdW5jdGlvbiBoYW5kbGVBbHBoYShzdHJpbmcpIHsKICAgICAgaWYgKHN0cmluZyA9PT0gdm9pZCAwKQogICAgICAgIHJldHVybjsKICAgICAgaWYgKHBhcnNlRmxvYXQoc3RyaW5nKSA8IDEpIHsKICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkNvbG9yOiBBbHBoYSBjb21wb25lbnQgb2YgIiArIHN0eWxlICsgIiB3aWxsIGJlIGlnbm9yZWQuIik7CiAgICAgIH0KICAgIH0KICAgIGxldCBtOwogICAgaWYgKG0gPSAvXigoPzpyZ2J8aHNsKWE/KVwoKFteXCldKilcKS8uZXhlYyhzdHlsZSkpIHsKICAgICAgbGV0IGNvbG9yOwogICAgICBjb25zdCBuYW1lID0gbVsxXTsKICAgICAgY29uc3QgY29tcG9uZW50cyA9IG1bMl07CiAgICAgIHN3aXRjaCAobmFtZSkgewogICAgICAgIGNhc2UgInJnYiI6CiAgICAgICAgY2FzZSAicmdiYSI6CiAgICAgICAgICBpZiAoY29sb3IgPSAvXlxzKihcZCspXHMqLFxzKihcZCspXHMqLFxzKihcZCspXHMqKD86LFxzKihcZCpcLj9cZCspXHMqKT8kLy5leGVjKGNvbXBvbmVudHMpKSB7CiAgICAgICAgICAgIHRoaXMuciA9IE1hdGgubWluKDI1NSwgcGFyc2VJbnQoY29sb3JbMV0sIDEwKSkgLyAyNTU7CiAgICAgICAgICAgIHRoaXMuZyA9IE1hdGgubWluKDI1NSwgcGFyc2VJbnQoY29sb3JbMl0sIDEwKSkgLyAyNTU7CiAgICAgICAgICAgIHRoaXMuYiA9IE1hdGgubWluKDI1NSwgcGFyc2VJbnQoY29sb3JbM10sIDEwKSkgLyAyNTU7CiAgICAgICAgICAgIGhhbmRsZUFscGhhKGNvbG9yWzRdKTsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoY29sb3IgPSAvXlxzKihcZCspXCVccyosXHMqKFxkKylcJVxzKixccyooXGQrKVwlXHMqKD86LFxzKihcZCpcLj9cZCspXHMqKT8kLy5leGVjKGNvbXBvbmVudHMpKSB7CiAgICAgICAgICAgIHRoaXMuciA9IE1hdGgubWluKDEwMCwgcGFyc2VJbnQoY29sb3JbMV0sIDEwKSkgLyAxMDA7CiAgICAgICAgICAgIHRoaXMuZyA9IE1hdGgubWluKDEwMCwgcGFyc2VJbnQoY29sb3JbMl0sIDEwKSkgLyAxMDA7CiAgICAgICAgICAgIHRoaXMuYiA9IE1hdGgubWluKDEwMCwgcGFyc2VJbnQoY29sb3JbM10sIDEwKSkgLyAxMDA7CiAgICAgICAgICAgIGhhbmRsZUFscGhhKGNvbG9yWzRdKTsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJoc2wiOgogICAgICAgIGNhc2UgImhzbGEiOgogICAgICAgICAgaWYgKGNvbG9yID0gL15ccyooXGQqXC4/XGQrKVxzKixccyooXGQrKVwlXHMqLFxzKihcZCspXCVccyooPzosXHMqKFxkKlwuP1xkKylccyopPyQvLmV4ZWMoY29tcG9uZW50cykpIHsKICAgICAgICAgICAgY29uc3QgaCA9IHBhcnNlRmxvYXQoY29sb3JbMV0pIC8gMzYwOwogICAgICAgICAgICBjb25zdCBzID0gcGFyc2VJbnQoY29sb3JbMl0sIDEwKSAvIDEwMDsKICAgICAgICAgICAgY29uc3QgbCA9IHBhcnNlSW50KGNvbG9yWzNdLCAxMCkgLyAxMDA7CiAgICAgICAgICAgIGhhbmRsZUFscGhhKGNvbG9yWzRdKTsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0SFNMKGgsIHMsIGwpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAobSA9IC9eXCMoW0EtRmEtZlxkXSspJC8uZXhlYyhzdHlsZSkpIHsKICAgICAgY29uc3QgaGV4ID0gbVsxXTsKICAgICAgY29uc3Qgc2l6ZSA9IGhleC5sZW5ndGg7CiAgICAgIGlmIChzaXplID09PSAzKSB7CiAgICAgICAgdGhpcy5yID0gcGFyc2VJbnQoaGV4LmNoYXJBdCgwKSArIGhleC5jaGFyQXQoMCksIDE2KSAvIDI1NTsKICAgICAgICB0aGlzLmcgPSBwYXJzZUludChoZXguY2hhckF0KDEpICsgaGV4LmNoYXJBdCgxKSwgMTYpIC8gMjU1OwogICAgICAgIHRoaXMuYiA9IHBhcnNlSW50KGhleC5jaGFyQXQoMikgKyBoZXguY2hhckF0KDIpLCAxNikgLyAyNTU7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0gZWxzZSBpZiAoc2l6ZSA9PT0gNikgewogICAgICAgIHRoaXMuciA9IHBhcnNlSW50KGhleC5jaGFyQXQoMCkgKyBoZXguY2hhckF0KDEpLCAxNikgLyAyNTU7CiAgICAgICAgdGhpcy5nID0gcGFyc2VJbnQoaGV4LmNoYXJBdCgyKSArIGhleC5jaGFyQXQoMyksIDE2KSAvIDI1NTsKICAgICAgICB0aGlzLmIgPSBwYXJzZUludChoZXguY2hhckF0KDQpICsgaGV4LmNoYXJBdCg1KSwgMTYpIC8gMjU1OwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICB9CiAgICBpZiAoc3R5bGUgJiYgc3R5bGUubGVuZ3RoID4gMCkgewogICAgICByZXR1cm4gdGhpcy5zZXRDb2xvck5hbWUoc3R5bGUpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldENvbG9yTmFtZShzdHlsZSkgewogICAgY29uc3QgaGV4ID0gX2NvbG9yS2V5d29yZHNbc3R5bGUudG9Mb3dlckNhc2UoKV07CiAgICBpZiAoaGV4ICE9PSB2b2lkIDApIHsKICAgICAgdGhpcy5zZXRIZXgoaGV4KTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuQ29sb3I6IFVua25vd24gY29sb3IgIiArIHN0eWxlKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBjbG9uZSgpIHsKICAgIHJldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLnIsIHRoaXMuZywgdGhpcy5iKTsKICB9CiAgY29weShjb2xvcikgewogICAgdGhpcy5yID0gY29sb3IucjsKICAgIHRoaXMuZyA9IGNvbG9yLmc7CiAgICB0aGlzLmIgPSBjb2xvci5iOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNvcHlTUkdCVG9MaW5lYXIoY29sb3IpIHsKICAgIHRoaXMuciA9IFNSR0JUb0xpbmVhcihjb2xvci5yKTsKICAgIHRoaXMuZyA9IFNSR0JUb0xpbmVhcihjb2xvci5nKTsKICAgIHRoaXMuYiA9IFNSR0JUb0xpbmVhcihjb2xvci5iKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBjb3B5TGluZWFyVG9TUkdCKGNvbG9yKSB7CiAgICB0aGlzLnIgPSBMaW5lYXJUb1NSR0IoY29sb3Iucik7CiAgICB0aGlzLmcgPSBMaW5lYXJUb1NSR0IoY29sb3IuZyk7CiAgICB0aGlzLmIgPSBMaW5lYXJUb1NSR0IoY29sb3IuYik7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY29udmVydFNSR0JUb0xpbmVhcigpIHsKICAgIHRoaXMuY29weVNSR0JUb0xpbmVhcih0aGlzKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBjb252ZXJ0TGluZWFyVG9TUkdCKCkgewogICAgdGhpcy5jb3B5TGluZWFyVG9TUkdCKHRoaXMpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGdldEhleCgpIHsKICAgIHJldHVybiB0aGlzLnIgKiAyNTUgPDwgMTYgXiB0aGlzLmcgKiAyNTUgPDwgOCBeIHRoaXMuYiAqIDI1NSA8PCAwOwogIH0KICBnZXRIZXhTdHJpbmcoKSB7CiAgICByZXR1cm4gKCIwMDAwMDAiICsgdGhpcy5nZXRIZXgoKS50b1N0cmluZygxNikpLnNsaWNlKC02KTsKICB9CiAgZ2V0SFNMKHRhcmdldCkgewogICAgY29uc3QgciA9IHRoaXMuciwgZyA9IHRoaXMuZywgYiA9IHRoaXMuYjsKICAgIGNvbnN0IG1heCA9IE1hdGgubWF4KHIsIGcsIGIpOwogICAgY29uc3QgbWluID0gTWF0aC5taW4ociwgZywgYik7CiAgICBsZXQgaHVlLCBzYXR1cmF0aW9uOwogICAgY29uc3QgbGlnaHRuZXNzID0gKG1pbiArIG1heCkgLyAyOwogICAgaWYgKG1pbiA9PT0gbWF4KSB7CiAgICAgIGh1ZSA9IDA7CiAgICAgIHNhdHVyYXRpb24gPSAwOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgZGVsdGEgPSBtYXggLSBtaW47CiAgICAgIHNhdHVyYXRpb24gPSBsaWdodG5lc3MgPD0gMC41ID8gZGVsdGEgLyAobWF4ICsgbWluKSA6IGRlbHRhIC8gKDIgLSBtYXggLSBtaW4pOwogICAgICBzd2l0Y2ggKG1heCkgewogICAgICAgIGNhc2UgcjoKICAgICAgICAgIGh1ZSA9IChnIC0gYikgLyBkZWx0YSArIChnIDwgYiA/IDYgOiAwKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgZzoKICAgICAgICAgIGh1ZSA9IChiIC0gcikgLyBkZWx0YSArIDI7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIGI6CiAgICAgICAgICBodWUgPSAociAtIGcpIC8gZGVsdGEgKyA0OwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgaHVlIC89IDY7CiAgICB9CiAgICB0YXJnZXQuaCA9IGh1ZTsKICAgIHRhcmdldC5zID0gc2F0dXJhdGlvbjsKICAgIHRhcmdldC5sID0gbGlnaHRuZXNzOwogICAgcmV0dXJuIHRhcmdldDsKICB9CiAgZ2V0U3R5bGUoKSB7CiAgICByZXR1cm4gInJnYigiICsgKHRoaXMuciAqIDI1NSB8IDApICsgIiwiICsgKHRoaXMuZyAqIDI1NSB8IDApICsgIiwiICsgKHRoaXMuYiAqIDI1NSB8IDApICsgIikiOwogIH0KICBvZmZzZXRIU0woaCwgcywgbCkgewogICAgdGhpcy5nZXRIU0woX2hzbEEpOwogICAgX2hzbEEuaCArPSBoOwogICAgX2hzbEEucyArPSBzOwogICAgX2hzbEEubCArPSBsOwogICAgdGhpcy5zZXRIU0woX2hzbEEuaCwgX2hzbEEucywgX2hzbEEubCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgYWRkKGNvbG9yKSB7CiAgICB0aGlzLnIgKz0gY29sb3IucjsKICAgIHRoaXMuZyArPSBjb2xvci5nOwogICAgdGhpcy5iICs9IGNvbG9yLmI7CiAgICByZXR1cm4gdGhpczsKICB9CiAgYWRkQ29sb3JzKGNvbG9yMSwgY29sb3IyKSB7CiAgICB0aGlzLnIgPSBjb2xvcjEuciArIGNvbG9yMi5yOwogICAgdGhpcy5nID0gY29sb3IxLmcgKyBjb2xvcjIuZzsKICAgIHRoaXMuYiA9IGNvbG9yMS5iICsgY29sb3IyLmI7CiAgICByZXR1cm4gdGhpczsKICB9CiAgYWRkU2NhbGFyKHMpIHsKICAgIHRoaXMuciArPSBzOwogICAgdGhpcy5nICs9IHM7CiAgICB0aGlzLmIgKz0gczsKICAgIHJldHVybiB0aGlzOwogIH0KICBzdWIoY29sb3IpIHsKICAgIHRoaXMuciA9IE1hdGgubWF4KDAsIHRoaXMuciAtIGNvbG9yLnIpOwogICAgdGhpcy5nID0gTWF0aC5tYXgoMCwgdGhpcy5nIC0gY29sb3IuZyk7CiAgICB0aGlzLmIgPSBNYXRoLm1heCgwLCB0aGlzLmIgLSBjb2xvci5iKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBtdWx0aXBseShjb2xvcikgewogICAgdGhpcy5yICo9IGNvbG9yLnI7CiAgICB0aGlzLmcgKj0gY29sb3IuZzsKICAgIHRoaXMuYiAqPSBjb2xvci5iOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG11bHRpcGx5U2NhbGFyKHMpIHsKICAgIHRoaXMuciAqPSBzOwogICAgdGhpcy5nICo9IHM7CiAgICB0aGlzLmIgKj0gczsKICAgIHJldHVybiB0aGlzOwogIH0KICBsZXJwKGNvbG9yLCBhbHBoYSkgewogICAgdGhpcy5yICs9IChjb2xvci5yIC0gdGhpcy5yKSAqIGFscGhhOwogICAgdGhpcy5nICs9IChjb2xvci5nIC0gdGhpcy5nKSAqIGFscGhhOwogICAgdGhpcy5iICs9IChjb2xvci5iIC0gdGhpcy5iKSAqIGFscGhhOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGxlcnBDb2xvcnMoY29sb3IxLCBjb2xvcjIsIGFscGhhKSB7CiAgICB0aGlzLnIgPSBjb2xvcjEuciArIChjb2xvcjIuciAtIGNvbG9yMS5yKSAqIGFscGhhOwogICAgdGhpcy5nID0gY29sb3IxLmcgKyAoY29sb3IyLmcgLSBjb2xvcjEuZykgKiBhbHBoYTsKICAgIHRoaXMuYiA9IGNvbG9yMS5iICsgKGNvbG9yMi5iIC0gY29sb3IxLmIpICogYWxwaGE7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbGVycEhTTChjb2xvciwgYWxwaGEpIHsKICAgIHRoaXMuZ2V0SFNMKF9oc2xBKTsKICAgIGNvbG9yLmdldEhTTChfaHNsQik7CiAgICBjb25zdCBoID0gbGVycChfaHNsQS5oLCBfaHNsQi5oLCBhbHBoYSk7CiAgICBjb25zdCBzID0gbGVycChfaHNsQS5zLCBfaHNsQi5zLCBhbHBoYSk7CiAgICBjb25zdCBsID0gbGVycChfaHNsQS5sLCBfaHNsQi5sLCBhbHBoYSk7CiAgICB0aGlzLnNldEhTTChoLCBzLCBsKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBlcXVhbHMoYykgewogICAgcmV0dXJuIGMuciA9PT0gdGhpcy5yICYmIGMuZyA9PT0gdGhpcy5nICYmIGMuYiA9PT0gdGhpcy5iOwogIH0KICBmcm9tQXJyYXkoYXJyYXksIG9mZnNldCA9IDApIHsKICAgIHRoaXMuciA9IGFycmF5W29mZnNldF07CiAgICB0aGlzLmcgPSBhcnJheVtvZmZzZXQgKyAxXTsKICAgIHRoaXMuYiA9IGFycmF5W29mZnNldCArIDJdOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRvQXJyYXkoYXJyYXkgPSBbXSwgb2Zmc2V0ID0gMCkgewogICAgYXJyYXlbb2Zmc2V0XSA9IHRoaXMucjsKICAgIGFycmF5W29mZnNldCArIDFdID0gdGhpcy5nOwogICAgYXJyYXlbb2Zmc2V0ICsgMl0gPSB0aGlzLmI7CiAgICByZXR1cm4gYXJyYXk7CiAgfQogIGZyb21CdWZmZXJBdHRyaWJ1dGUoYXR0cmlidXRlLCBpbmRleCkgewogICAgdGhpcy5yID0gYXR0cmlidXRlLmdldFgoaW5kZXgpOwogICAgdGhpcy5nID0gYXR0cmlidXRlLmdldFkoaW5kZXgpOwogICAgdGhpcy5iID0gYXR0cmlidXRlLmdldFooaW5kZXgpOwogICAgaWYgKGF0dHJpYnV0ZS5ub3JtYWxpemVkID09PSB0cnVlKSB7CiAgICAgIHRoaXMuciAvPSAyNTU7CiAgICAgIHRoaXMuZyAvPSAyNTU7CiAgICAgIHRoaXMuYiAvPSAyNTU7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9CiAgdG9KU09OKCkgewogICAgcmV0dXJuIHRoaXMuZ2V0SGV4KCk7CiAgfQp9CkNvbG9yLk5BTUVTID0gX2NvbG9yS2V5d29yZHM7CkNvbG9yLnByb3RvdHlwZS5pc0NvbG9yID0gdHJ1ZTsKQ29sb3IucHJvdG90eXBlLnIgPSAxOwpDb2xvci5wcm90b3R5cGUuZyA9IDE7CkNvbG9yLnByb3RvdHlwZS5iID0gMTsKbGV0IF9jYW52YXM7CmNsYXNzIEltYWdlVXRpbHMgewogIHN0YXRpYyBnZXREYXRhVVJMKGltYWdlKSB7CiAgICBpZiAoL15kYXRhOi9pLnRlc3QoaW1hZ2Uuc3JjKSkgewogICAgICByZXR1cm4gaW1hZ2Uuc3JjOwogICAgfQogICAgaWYgKHR5cGVvZiBIVE1MQ2FudmFzRWxlbWVudCA9PSAidW5kZWZpbmVkIikgewogICAgICByZXR1cm4gaW1hZ2Uuc3JjOwogICAgfQogICAgbGV0IGNhbnZhczsKICAgIGlmIChpbWFnZSBpbnN0YW5jZW9mIEhUTUxDYW52YXNFbGVtZW50KSB7CiAgICAgIGNhbnZhcyA9IGltYWdlOwogICAgfSBlbHNlIHsKICAgICAgaWYgKF9jYW52YXMgPT09IHZvaWQgMCkKICAgICAgICBfY2FudmFzID0gY3JlYXRlRWxlbWVudE5TKCJjYW52YXMiKTsKICAgICAgX2NhbnZhcy53aWR0aCA9IGltYWdlLndpZHRoOwogICAgICBfY2FudmFzLmhlaWdodCA9IGltYWdlLmhlaWdodDsKICAgICAgY29uc3QgY29udGV4dCA9IF9jYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgaWYgKGltYWdlIGluc3RhbmNlb2YgSW1hZ2VEYXRhKSB7CiAgICAgICAgY29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2UsIDAsIDApOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKGltYWdlLCAwLCAwLCBpbWFnZS53aWR0aCwgaW1hZ2UuaGVpZ2h0KTsKICAgICAgfQogICAgICBjYW52YXMgPSBfY2FudmFzOwogICAgfQogICAgaWYgKGNhbnZhcy53aWR0aCA+IDIwNDggfHwgY2FudmFzLmhlaWdodCA+IDIwNDgpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5JbWFnZVV0aWxzLmdldERhdGFVUkw6IEltYWdlIGNvbnZlcnRlZCB0byBqcGcgZm9yIHBlcmZvcm1hbmNlIHJlYXNvbnMiLCBpbWFnZSk7CiAgICAgIHJldHVybiBjYW52YXMudG9EYXRhVVJMKCJpbWFnZS9qcGVnIiwgMC42KTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBjYW52YXMudG9EYXRhVVJMKCJpbWFnZS9wbmciKTsKICAgIH0KICB9CiAgc3RhdGljIHNSR0JUb0xpbmVhcihpbWFnZSkgewogICAgaWYgKHR5cGVvZiBIVE1MSW1hZ2VFbGVtZW50ICE9PSAidW5kZWZpbmVkIiAmJiBpbWFnZSBpbnN0YW5jZW9mIEhUTUxJbWFnZUVsZW1lbnQgfHwgdHlwZW9mIEhUTUxDYW52YXNFbGVtZW50ICE9PSAidW5kZWZpbmVkIiAmJiBpbWFnZSBpbnN0YW5jZW9mIEhUTUxDYW52YXNFbGVtZW50IHx8IHR5cGVvZiBJbWFnZUJpdG1hcCAhPT0gInVuZGVmaW5lZCIgJiYgaW1hZ2UgaW5zdGFuY2VvZiBJbWFnZUJpdG1hcCkgewogICAgICBjb25zdCBjYW52YXMgPSBjcmVhdGVFbGVtZW50TlMoImNhbnZhcyIpOwogICAgICBjYW52YXMud2lkdGggPSBpbWFnZS53aWR0aDsKICAgICAgY2FudmFzLmhlaWdodCA9IGltYWdlLmhlaWdodDsKICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwogICAgICBjb250ZXh0LmRyYXdJbWFnZShpbWFnZSwgMCwgMCwgaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCk7CiAgICAgIGNvbnN0IGltYWdlRGF0YSA9IGNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQpOwogICAgICBjb25zdCBkYXRhID0gaW1hZ2VEYXRhLmRhdGE7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIGRhdGFbaV0gPSBTUkdCVG9MaW5lYXIoZGF0YVtpXSAvIDI1NSkgKiAyNTU7CiAgICAgIH0KICAgICAgY29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTsKICAgICAgcmV0dXJuIGNhbnZhczsKICAgIH0gZWxzZSBpZiAoaW1hZ2UuZGF0YSkgewogICAgICBjb25zdCBkYXRhID0gaW1hZ2UuZGF0YS5zbGljZSgwKTsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5IHx8IGRhdGEgaW5zdGFuY2VvZiBVaW50OENsYW1wZWRBcnJheSkgewogICAgICAgICAgZGF0YVtpXSA9IE1hdGguZmxvb3IoU1JHQlRvTGluZWFyKGRhdGFbaV0gLyAyNTUpICogMjU1KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZGF0YVtpXSA9IFNSR0JUb0xpbmVhcihkYXRhW2ldKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHsKICAgICAgICBkYXRhLAogICAgICAgIHdpZHRoOiBpbWFnZS53aWR0aCwKICAgICAgICBoZWlnaHQ6IGltYWdlLmhlaWdodAogICAgICB9OwogICAgfSBlbHNlIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5JbWFnZVV0aWxzLnNSR0JUb0xpbmVhcigpOiBVbnN1cHBvcnRlZCBpbWFnZSB0eXBlLiBObyBjb2xvciBzcGFjZSBjb252ZXJzaW9uIGFwcGxpZWQuIik7CiAgICAgIHJldHVybiBpbWFnZTsKICAgIH0KICB9Cn0KbGV0IHRleHR1cmVJZCA9IDA7CmNsYXNzIFRleHR1cmUgZXh0ZW5kcyBFdmVudERpc3BhdGNoZXIgewogIGNvbnN0cnVjdG9yKGltYWdlID0gVGV4dHVyZS5ERUZBVUxUX0lNQUdFLCBtYXBwaW5nID0gVGV4dHVyZS5ERUZBVUxUX01BUFBJTkcsIHdyYXBTID0gQ2xhbXBUb0VkZ2VXcmFwcGluZywgd3JhcFQgPSBDbGFtcFRvRWRnZVdyYXBwaW5nLCBtYWdGaWx0ZXIgPSBMaW5lYXJGaWx0ZXIsIG1pbkZpbHRlciA9IExpbmVhck1pcG1hcExpbmVhckZpbHRlciwgZm9ybWF0ID0gUkdCQUZvcm1hdCwgdHlwZSA9IFVuc2lnbmVkQnl0ZVR5cGUsIGFuaXNvdHJvcHkgPSAxLCBlbmNvZGluZyA9IExpbmVhckVuY29kaW5nKSB7CiAgICBzdXBlcigpOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJpZCIsIHsgdmFsdWU6IHRleHR1cmVJZCsrIH0pOwogICAgdGhpcy51dWlkID0gZ2VuZXJhdGVVVUlEKCk7CiAgICB0aGlzLm5hbWUgPSAiIjsKICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKICAgIHRoaXMubWlwbWFwcyA9IFtdOwogICAgdGhpcy5tYXBwaW5nID0gbWFwcGluZzsKICAgIHRoaXMud3JhcFMgPSB3cmFwUzsKICAgIHRoaXMud3JhcFQgPSB3cmFwVDsKICAgIHRoaXMubWFnRmlsdGVyID0gbWFnRmlsdGVyOwogICAgdGhpcy5taW5GaWx0ZXIgPSBtaW5GaWx0ZXI7CiAgICB0aGlzLmFuaXNvdHJvcHkgPSBhbmlzb3Ryb3B5OwogICAgdGhpcy5mb3JtYXQgPSBmb3JtYXQ7CiAgICB0aGlzLmludGVybmFsRm9ybWF0ID0gbnVsbDsKICAgIHRoaXMudHlwZSA9IHR5cGU7CiAgICB0aGlzLm9mZnNldCA9IG5ldyBWZWN0b3IyKDAsIDApOwogICAgdGhpcy5yZXBlYXQgPSBuZXcgVmVjdG9yMigxLCAxKTsKICAgIHRoaXMuY2VudGVyID0gbmV3IFZlY3RvcjIoMCwgMCk7CiAgICB0aGlzLnJvdGF0aW9uID0gMDsKICAgIHRoaXMubWF0cml4QXV0b1VwZGF0ZSA9IHRydWU7CiAgICB0aGlzLm1hdHJpeCA9IG5ldyBNYXRyaXgzKCk7CiAgICB0aGlzLmdlbmVyYXRlTWlwbWFwcyA9IHRydWU7CiAgICB0aGlzLnByZW11bHRpcGx5QWxwaGEgPSBmYWxzZTsKICAgIHRoaXMuZmxpcFkgPSB0cnVlOwogICAgdGhpcy51bnBhY2tBbGlnbm1lbnQgPSA0OwogICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwogICAgdGhpcy51c2VyRGF0YSA9IHt9OwogICAgdGhpcy52ZXJzaW9uID0gMDsKICAgIHRoaXMub25VcGRhdGUgPSBudWxsOwogICAgdGhpcy5pc1JlbmRlclRhcmdldFRleHR1cmUgPSBmYWxzZTsKICAgIHRoaXMubmVlZHNQTVJFTVVwZGF0ZSA9IGZhbHNlOwogIH0KICB1cGRhdGVNYXRyaXgoKSB7CiAgICB0aGlzLm1hdHJpeC5zZXRVdlRyYW5zZm9ybSh0aGlzLm9mZnNldC54LCB0aGlzLm9mZnNldC55LCB0aGlzLnJlcGVhdC54LCB0aGlzLnJlcGVhdC55LCB0aGlzLnJvdGF0aW9uLCB0aGlzLmNlbnRlci54LCB0aGlzLmNlbnRlci55KTsKICB9CiAgY2xvbmUoKSB7CiAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoKS5jb3B5KHRoaXMpOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgdGhpcy5uYW1lID0gc291cmNlLm5hbWU7CiAgICB0aGlzLmltYWdlID0gc291cmNlLmltYWdlOwogICAgdGhpcy5taXBtYXBzID0gc291cmNlLm1pcG1hcHMuc2xpY2UoMCk7CiAgICB0aGlzLm1hcHBpbmcgPSBzb3VyY2UubWFwcGluZzsKICAgIHRoaXMud3JhcFMgPSBzb3VyY2Uud3JhcFM7CiAgICB0aGlzLndyYXBUID0gc291cmNlLndyYXBUOwogICAgdGhpcy5tYWdGaWx0ZXIgPSBzb3VyY2UubWFnRmlsdGVyOwogICAgdGhpcy5taW5GaWx0ZXIgPSBzb3VyY2UubWluRmlsdGVyOwogICAgdGhpcy5hbmlzb3Ryb3B5ID0gc291cmNlLmFuaXNvdHJvcHk7CiAgICB0aGlzLmZvcm1hdCA9IHNvdXJjZS5mb3JtYXQ7CiAgICB0aGlzLmludGVybmFsRm9ybWF0ID0gc291cmNlLmludGVybmFsRm9ybWF0OwogICAgdGhpcy50eXBlID0gc291cmNlLnR5cGU7CiAgICB0aGlzLm9mZnNldC5jb3B5KHNvdXJjZS5vZmZzZXQpOwogICAgdGhpcy5yZXBlYXQuY29weShzb3VyY2UucmVwZWF0KTsKICAgIHRoaXMuY2VudGVyLmNvcHkoc291cmNlLmNlbnRlcik7CiAgICB0aGlzLnJvdGF0aW9uID0gc291cmNlLnJvdGF0aW9uOwogICAgdGhpcy5tYXRyaXhBdXRvVXBkYXRlID0gc291cmNlLm1hdHJpeEF1dG9VcGRhdGU7CiAgICB0aGlzLm1hdHJpeC5jb3B5KHNvdXJjZS5tYXRyaXgpOwogICAgdGhpcy5nZW5lcmF0ZU1pcG1hcHMgPSBzb3VyY2UuZ2VuZXJhdGVNaXBtYXBzOwogICAgdGhpcy5wcmVtdWx0aXBseUFscGhhID0gc291cmNlLnByZW11bHRpcGx5QWxwaGE7CiAgICB0aGlzLmZsaXBZID0gc291cmNlLmZsaXBZOwogICAgdGhpcy51bnBhY2tBbGlnbm1lbnQgPSBzb3VyY2UudW5wYWNrQWxpZ25tZW50OwogICAgdGhpcy5lbmNvZGluZyA9IHNvdXJjZS5lbmNvZGluZzsKICAgIHRoaXMudXNlckRhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNvdXJjZS51c2VyRGF0YSkpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRvSlNPTihtZXRhKSB7CiAgICBjb25zdCBpc1Jvb3RPYmplY3QgPSBtZXRhID09PSB2b2lkIDAgfHwgdHlwZW9mIG1ldGEgPT09ICJzdHJpbmciOwogICAgaWYgKCFpc1Jvb3RPYmplY3QgJiYgbWV0YS50ZXh0dXJlc1t0aGlzLnV1aWRdICE9PSB2b2lkIDApIHsKICAgICAgcmV0dXJuIG1ldGEudGV4dHVyZXNbdGhpcy51dWlkXTsKICAgIH0KICAgIGNvbnN0IG91dHB1dCA9IHsKICAgICAgbWV0YWRhdGE6IHsKICAgICAgICB2ZXJzaW9uOiA0LjUsCiAgICAgICAgdHlwZTogIlRleHR1cmUiLAogICAgICAgIGdlbmVyYXRvcjogIlRleHR1cmUudG9KU09OIgogICAgICB9LAogICAgICB1dWlkOiB0aGlzLnV1aWQsCiAgICAgIG5hbWU6IHRoaXMubmFtZSwKICAgICAgbWFwcGluZzogdGhpcy5tYXBwaW5nLAogICAgICByZXBlYXQ6IFt0aGlzLnJlcGVhdC54LCB0aGlzLnJlcGVhdC55XSwKICAgICAgb2Zmc2V0OiBbdGhpcy5vZmZzZXQueCwgdGhpcy5vZmZzZXQueV0sCiAgICAgIGNlbnRlcjogW3RoaXMuY2VudGVyLngsIHRoaXMuY2VudGVyLnldLAogICAgICByb3RhdGlvbjogdGhpcy5yb3RhdGlvbiwKICAgICAgd3JhcDogW3RoaXMud3JhcFMsIHRoaXMud3JhcFRdLAogICAgICBmb3JtYXQ6IHRoaXMuZm9ybWF0LAogICAgICB0eXBlOiB0aGlzLnR5cGUsCiAgICAgIGVuY29kaW5nOiB0aGlzLmVuY29kaW5nLAogICAgICBtaW5GaWx0ZXI6IHRoaXMubWluRmlsdGVyLAogICAgICBtYWdGaWx0ZXI6IHRoaXMubWFnRmlsdGVyLAogICAgICBhbmlzb3Ryb3B5OiB0aGlzLmFuaXNvdHJvcHksCiAgICAgIGZsaXBZOiB0aGlzLmZsaXBZLAogICAgICBwcmVtdWx0aXBseUFscGhhOiB0aGlzLnByZW11bHRpcGx5QWxwaGEsCiAgICAgIHVucGFja0FsaWdubWVudDogdGhpcy51bnBhY2tBbGlnbm1lbnQKICAgIH07CiAgICBpZiAodGhpcy5pbWFnZSAhPT0gdm9pZCAwKSB7CiAgICAgIGNvbnN0IGltYWdlID0gdGhpcy5pbWFnZTsKICAgICAgaWYgKGltYWdlLnV1aWQgPT09IHZvaWQgMCkgewogICAgICAgIGltYWdlLnV1aWQgPSBnZW5lcmF0ZVVVSUQoKTsKICAgICAgfQogICAgICBpZiAoIWlzUm9vdE9iamVjdCAmJiBtZXRhLmltYWdlc1tpbWFnZS51dWlkXSA9PT0gdm9pZCAwKSB7CiAgICAgICAgbGV0IHVybDsKICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpbWFnZSkpIHsKICAgICAgICAgIHVybCA9IFtdOwogICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBpbWFnZS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICAgICAgaWYgKGltYWdlW2ldLmlzRGF0YVRleHR1cmUpIHsKICAgICAgICAgICAgICB1cmwucHVzaChzZXJpYWxpemVJbWFnZShpbWFnZVtpXS5pbWFnZSkpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHVybC5wdXNoKHNlcmlhbGl6ZUltYWdlKGltYWdlW2ldKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdXJsID0gc2VyaWFsaXplSW1hZ2UoaW1hZ2UpOwogICAgICAgIH0KICAgICAgICBtZXRhLmltYWdlc1tpbWFnZS51dWlkXSA9IHsKICAgICAgICAgIHV1aWQ6IGltYWdlLnV1aWQsCiAgICAgICAgICB1cmwKICAgICAgICB9OwogICAgICB9CiAgICAgIG91dHB1dC5pbWFnZSA9IGltYWdlLnV1aWQ7CiAgICB9CiAgICBpZiAoSlNPTi5zdHJpbmdpZnkodGhpcy51c2VyRGF0YSkgIT09ICJ7fSIpCiAgICAgIG91dHB1dC51c2VyRGF0YSA9IHRoaXMudXNlckRhdGE7CiAgICBpZiAoIWlzUm9vdE9iamVjdCkgewogICAgICBtZXRhLnRleHR1cmVzW3RoaXMudXVpZF0gPSBvdXRwdXQ7CiAgICB9CiAgICByZXR1cm4gb3V0cHV0OwogIH0KICBkaXNwb3NlKCkgewogICAgdGhpcy5kaXNwYXRjaEV2ZW50KHsgdHlwZTogImRpc3Bvc2UiIH0pOwogIH0KICB0cmFuc2Zvcm1Vdih1dikgewogICAgaWYgKHRoaXMubWFwcGluZyAhPT0gVVZNYXBwaW5nKQogICAgICByZXR1cm4gdXY7CiAgICB1di5hcHBseU1hdHJpeDModGhpcy5tYXRyaXgpOwogICAgaWYgKHV2LnggPCAwIHx8IHV2LnggPiAxKSB7CiAgICAgIHN3aXRjaCAodGhpcy53cmFwUykgewogICAgICAgIGNhc2UgUmVwZWF0V3JhcHBpbmc6CiAgICAgICAgICB1di54ID0gdXYueCAtIE1hdGguZmxvb3IodXYueCk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIENsYW1wVG9FZGdlV3JhcHBpbmc6CiAgICAgICAgICB1di54ID0gdXYueCA8IDAgPyAwIDogMTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgTWlycm9yZWRSZXBlYXRXcmFwcGluZzoKICAgICAgICAgIGlmIChNYXRoLmFicyhNYXRoLmZsb29yKHV2LngpICUgMikgPT09IDEpIHsKICAgICAgICAgICAgdXYueCA9IE1hdGguY2VpbCh1di54KSAtIHV2Lng7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB1di54ID0gdXYueCAtIE1hdGguZmxvb3IodXYueCk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgaWYgKHV2LnkgPCAwIHx8IHV2LnkgPiAxKSB7CiAgICAgIHN3aXRjaCAodGhpcy53cmFwVCkgewogICAgICAgIGNhc2UgUmVwZWF0V3JhcHBpbmc6CiAgICAgICAgICB1di55ID0gdXYueSAtIE1hdGguZmxvb3IodXYueSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIENsYW1wVG9FZGdlV3JhcHBpbmc6CiAgICAgICAgICB1di55ID0gdXYueSA8IDAgPyAwIDogMTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgTWlycm9yZWRSZXBlYXRXcmFwcGluZzoKICAgICAgICAgIGlmIChNYXRoLmFicyhNYXRoLmZsb29yKHV2LnkpICUgMikgPT09IDEpIHsKICAgICAgICAgICAgdXYueSA9IE1hdGguY2VpbCh1di55KSAtIHV2Lnk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB1di55ID0gdXYueSAtIE1hdGguZmxvb3IodXYueSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgaWYgKHRoaXMuZmxpcFkpIHsKICAgICAgdXYueSA9IDEgLSB1di55OwogICAgfQogICAgcmV0dXJuIHV2OwogIH0KICBzZXQgbmVlZHNVcGRhdGUodmFsdWUpIHsKICAgIGlmICh2YWx1ZSA9PT0gdHJ1ZSkKICAgICAgdGhpcy52ZXJzaW9uKys7CiAgfQp9ClRleHR1cmUuREVGQVVMVF9JTUFHRSA9IHZvaWQgMDsKVGV4dHVyZS5ERUZBVUxUX01BUFBJTkcgPSBVVk1hcHBpbmc7ClRleHR1cmUucHJvdG90eXBlLmlzVGV4dHVyZSA9IHRydWU7CmZ1bmN0aW9uIHNlcmlhbGl6ZUltYWdlKGltYWdlKSB7CiAgaWYgKHR5cGVvZiBIVE1MSW1hZ2VFbGVtZW50ICE9PSAidW5kZWZpbmVkIiAmJiBpbWFnZSBpbnN0YW5jZW9mIEhUTUxJbWFnZUVsZW1lbnQgfHwgdHlwZW9mIEhUTUxDYW52YXNFbGVtZW50ICE9PSAidW5kZWZpbmVkIiAmJiBpbWFnZSBpbnN0YW5jZW9mIEhUTUxDYW52YXNFbGVtZW50IHx8IHR5cGVvZiBJbWFnZUJpdG1hcCAhPT0gInVuZGVmaW5lZCIgJiYgaW1hZ2UgaW5zdGFuY2VvZiBJbWFnZUJpdG1hcCkgewogICAgcmV0dXJuIEltYWdlVXRpbHMuZ2V0RGF0YVVSTChpbWFnZSk7CiAgfSBlbHNlIHsKICAgIGlmIChpbWFnZS5kYXRhKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgZGF0YTogQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoaW1hZ2UuZGF0YSksCiAgICAgICAgd2lkdGg6IGltYWdlLndpZHRoLAogICAgICAgIGhlaWdodDogaW1hZ2UuaGVpZ2h0LAogICAgICAgIHR5cGU6IGltYWdlLmRhdGEuY29uc3RydWN0b3IubmFtZQogICAgICB9OwogICAgfSBlbHNlIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5UZXh0dXJlOiBVbmFibGUgdG8gc2VyaWFsaXplIFRleHR1cmUuIik7CiAgICAgIHJldHVybiB7fTsKICAgIH0KICB9Cn0KY2xhc3MgVmVjdG9yNCB7CiAgY29uc3RydWN0b3IoeCA9IDAsIHkgPSAwLCB6ID0gMCwgdyA9IDEpIHsKICAgIHRoaXMueCA9IHg7CiAgICB0aGlzLnkgPSB5OwogICAgdGhpcy56ID0gejsKICAgIHRoaXMudyA9IHc7CiAgfQogIGdldCB3aWR0aCgpIHsKICAgIHJldHVybiB0aGlzLno7CiAgfQogIHNldCB3aWR0aCh2YWx1ZSkgewogICAgdGhpcy56ID0gdmFsdWU7CiAgfQogIGdldCBoZWlnaHQoKSB7CiAgICByZXR1cm4gdGhpcy53OwogIH0KICBzZXQgaGVpZ2h0KHZhbHVlKSB7CiAgICB0aGlzLncgPSB2YWx1ZTsKICB9CiAgc2V0KHgsIHksIHosIHcpIHsKICAgIHRoaXMueCA9IHg7CiAgICB0aGlzLnkgPSB5OwogICAgdGhpcy56ID0gejsKICAgIHRoaXMudyA9IHc7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0U2NhbGFyKHNjYWxhcikgewogICAgdGhpcy54ID0gc2NhbGFyOwogICAgdGhpcy55ID0gc2NhbGFyOwogICAgdGhpcy56ID0gc2NhbGFyOwogICAgdGhpcy53ID0gc2NhbGFyOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldFgoeCkgewogICAgdGhpcy54ID0geDsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRZKHkpIHsKICAgIHRoaXMueSA9IHk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0Wih6KSB7CiAgICB0aGlzLnogPSB6OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldFcodykgewogICAgdGhpcy53ID0gdzsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRDb21wb25lbnQoaW5kZXgsIHZhbHVlKSB7CiAgICBzd2l0Y2ggKGluZGV4KSB7CiAgICAgIGNhc2UgMDoKICAgICAgICB0aGlzLnggPSB2YWx1ZTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAxOgogICAgICAgIHRoaXMueSA9IHZhbHVlOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIDI6CiAgICAgICAgdGhpcy56ID0gdmFsdWU7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgMzoKICAgICAgICB0aGlzLncgPSB2YWx1ZTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImluZGV4IGlzIG91dCBvZiByYW5nZTogIiArIGluZGV4KTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBnZXRDb21wb25lbnQoaW5kZXgpIHsKICAgIHN3aXRjaCAoaW5kZXgpIHsKICAgICAgY2FzZSAwOgogICAgICAgIHJldHVybiB0aGlzLng7CiAgICAgIGNhc2UgMToKICAgICAgICByZXR1cm4gdGhpcy55OwogICAgICBjYXNlIDI6CiAgICAgICAgcmV0dXJuIHRoaXMuejsKICAgICAgY2FzZSAzOgogICAgICAgIHJldHVybiB0aGlzLnc7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJpbmRleCBpcyBvdXQgb2YgcmFuZ2U6ICIgKyBpbmRleCk7CiAgICB9CiAgfQogIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueCwgdGhpcy55LCB0aGlzLnosIHRoaXMudyk7CiAgfQogIGNvcHkodikgewogICAgdGhpcy54ID0gdi54OwogICAgdGhpcy55ID0gdi55OwogICAgdGhpcy56ID0gdi56OwogICAgdGhpcy53ID0gdi53ICE9PSB2b2lkIDAgPyB2LncgOiAxOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGFkZCh2LCB3KSB7CiAgICBpZiAodyAhPT0gdm9pZCAwKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuVmVjdG9yNDogLmFkZCgpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLmFkZFZlY3RvcnMoIGEsIGIgKSBpbnN0ZWFkLiIpOwogICAgICByZXR1cm4gdGhpcy5hZGRWZWN0b3JzKHYsIHcpOwogICAgfQogICAgdGhpcy54ICs9IHYueDsKICAgIHRoaXMueSArPSB2Lnk7CiAgICB0aGlzLnogKz0gdi56OwogICAgdGhpcy53ICs9IHYudzsKICAgIHJldHVybiB0aGlzOwogIH0KICBhZGRTY2FsYXIocykgewogICAgdGhpcy54ICs9IHM7CiAgICB0aGlzLnkgKz0gczsKICAgIHRoaXMueiArPSBzOwogICAgdGhpcy53ICs9IHM7CiAgICByZXR1cm4gdGhpczsKICB9CiAgYWRkVmVjdG9ycyhhLCBiKSB7CiAgICB0aGlzLnggPSBhLnggKyBiLng7CiAgICB0aGlzLnkgPSBhLnkgKyBiLnk7CiAgICB0aGlzLnogPSBhLnogKyBiLno7CiAgICB0aGlzLncgPSBhLncgKyBiLnc7CiAgICByZXR1cm4gdGhpczsKICB9CiAgYWRkU2NhbGVkVmVjdG9yKHYsIHMpIHsKICAgIHRoaXMueCArPSB2LnggKiBzOwogICAgdGhpcy55ICs9IHYueSAqIHM7CiAgICB0aGlzLnogKz0gdi56ICogczsKICAgIHRoaXMudyArPSB2LncgKiBzOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHN1Yih2LCB3KSB7CiAgICBpZiAodyAhPT0gdm9pZCAwKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuVmVjdG9yNDogLnN1YigpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLnN1YlZlY3RvcnMoIGEsIGIgKSBpbnN0ZWFkLiIpOwogICAgICByZXR1cm4gdGhpcy5zdWJWZWN0b3JzKHYsIHcpOwogICAgfQogICAgdGhpcy54IC09IHYueDsKICAgIHRoaXMueSAtPSB2Lnk7CiAgICB0aGlzLnogLT0gdi56OwogICAgdGhpcy53IC09IHYudzsKICAgIHJldHVybiB0aGlzOwogIH0KICBzdWJTY2FsYXIocykgewogICAgdGhpcy54IC09IHM7CiAgICB0aGlzLnkgLT0gczsKICAgIHRoaXMueiAtPSBzOwogICAgdGhpcy53IC09IHM7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc3ViVmVjdG9ycyhhLCBiKSB7CiAgICB0aGlzLnggPSBhLnggLSBiLng7CiAgICB0aGlzLnkgPSBhLnkgLSBiLnk7CiAgICB0aGlzLnogPSBhLnogLSBiLno7CiAgICB0aGlzLncgPSBhLncgLSBiLnc7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbXVsdGlwbHkodikgewogICAgdGhpcy54ICo9IHYueDsKICAgIHRoaXMueSAqPSB2Lnk7CiAgICB0aGlzLnogKj0gdi56OwogICAgdGhpcy53ICo9IHYudzsKICAgIHJldHVybiB0aGlzOwogIH0KICBtdWx0aXBseVNjYWxhcihzY2FsYXIpIHsKICAgIHRoaXMueCAqPSBzY2FsYXI7CiAgICB0aGlzLnkgKj0gc2NhbGFyOwogICAgdGhpcy56ICo9IHNjYWxhcjsKICAgIHRoaXMudyAqPSBzY2FsYXI7CiAgICByZXR1cm4gdGhpczsKICB9CiAgYXBwbHlNYXRyaXg0KG0pIHsKICAgIGNvbnN0IHggPSB0aGlzLngsIHkgPSB0aGlzLnksIHogPSB0aGlzLnosIHcgPSB0aGlzLnc7CiAgICBjb25zdCBlID0gbS5lbGVtZW50czsKICAgIHRoaXMueCA9IGVbMF0gKiB4ICsgZVs0XSAqIHkgKyBlWzhdICogeiArIGVbMTJdICogdzsKICAgIHRoaXMueSA9IGVbMV0gKiB4ICsgZVs1XSAqIHkgKyBlWzldICogeiArIGVbMTNdICogdzsKICAgIHRoaXMueiA9IGVbMl0gKiB4ICsgZVs2XSAqIHkgKyBlWzEwXSAqIHogKyBlWzE0XSAqIHc7CiAgICB0aGlzLncgPSBlWzNdICogeCArIGVbN10gKiB5ICsgZVsxMV0gKiB6ICsgZVsxNV0gKiB3OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGRpdmlkZVNjYWxhcihzY2FsYXIpIHsKICAgIHJldHVybiB0aGlzLm11bHRpcGx5U2NhbGFyKDEgLyBzY2FsYXIpOwogIH0KICBzZXRBeGlzQW5nbGVGcm9tUXVhdGVybmlvbihxKSB7CiAgICB0aGlzLncgPSAyICogTWF0aC5hY29zKHEudyk7CiAgICBjb25zdCBzID0gTWF0aC5zcXJ0KDEgLSBxLncgKiBxLncpOwogICAgaWYgKHMgPCAxZS00KSB7CiAgICAgIHRoaXMueCA9IDE7CiAgICAgIHRoaXMueSA9IDA7CiAgICAgIHRoaXMueiA9IDA7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnggPSBxLnggLyBzOwogICAgICB0aGlzLnkgPSBxLnkgLyBzOwogICAgICB0aGlzLnogPSBxLnogLyBzOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldEF4aXNBbmdsZUZyb21Sb3RhdGlvbk1hdHJpeChtKSB7CiAgICBsZXQgYW5nbGUsIHgsIHksIHo7CiAgICBjb25zdCBlcHNpbG9uID0gMC4wMSwgZXBzaWxvbjIgPSAwLjEsIHRlID0gbS5lbGVtZW50cywgbTExID0gdGVbMF0sIG0xMiA9IHRlWzRdLCBtMTMgPSB0ZVs4XSwgbTIxID0gdGVbMV0sIG0yMiA9IHRlWzVdLCBtMjMgPSB0ZVs5XSwgbTMxID0gdGVbMl0sIG0zMiA9IHRlWzZdLCBtMzMgPSB0ZVsxMF07CiAgICBpZiAoTWF0aC5hYnMobTEyIC0gbTIxKSA8IGVwc2lsb24gJiYgTWF0aC5hYnMobTEzIC0gbTMxKSA8IGVwc2lsb24gJiYgTWF0aC5hYnMobTIzIC0gbTMyKSA8IGVwc2lsb24pIHsKICAgICAgaWYgKE1hdGguYWJzKG0xMiArIG0yMSkgPCBlcHNpbG9uMiAmJiBNYXRoLmFicyhtMTMgKyBtMzEpIDwgZXBzaWxvbjIgJiYgTWF0aC5hYnMobTIzICsgbTMyKSA8IGVwc2lsb24yICYmIE1hdGguYWJzKG0xMSArIG0yMiArIG0zMyAtIDMpIDwgZXBzaWxvbjIpIHsKICAgICAgICB0aGlzLnNldCgxLCAwLCAwLCAwKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgICBhbmdsZSA9IE1hdGguUEk7CiAgICAgIGNvbnN0IHh4ID0gKG0xMSArIDEpIC8gMjsKICAgICAgY29uc3QgeXkgPSAobTIyICsgMSkgLyAyOwogICAgICBjb25zdCB6eiA9IChtMzMgKyAxKSAvIDI7CiAgICAgIGNvbnN0IHh5ID0gKG0xMiArIG0yMSkgLyA0OwogICAgICBjb25zdCB4eiA9IChtMTMgKyBtMzEpIC8gNDsKICAgICAgY29uc3QgeXogPSAobTIzICsgbTMyKSAvIDQ7CiAgICAgIGlmICh4eCA+IHl5ICYmIHh4ID4genopIHsKICAgICAgICBpZiAoeHggPCBlcHNpbG9uKSB7CiAgICAgICAgICB4ID0gMDsKICAgICAgICAgIHkgPSAwLjcwNzEwNjc4MTsKICAgICAgICAgIHogPSAwLjcwNzEwNjc4MTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgeCA9IE1hdGguc3FydCh4eCk7CiAgICAgICAgICB5ID0geHkgLyB4OwogICAgICAgICAgeiA9IHh6IC8geDsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoeXkgPiB6eikgewogICAgICAgIGlmICh5eSA8IGVwc2lsb24pIHsKICAgICAgICAgIHggPSAwLjcwNzEwNjc4MTsKICAgICAgICAgIHkgPSAwOwogICAgICAgICAgeiA9IDAuNzA3MTA2NzgxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB5ID0gTWF0aC5zcXJ0KHl5KTsKICAgICAgICAgIHggPSB4eSAvIHk7CiAgICAgICAgICB6ID0geXogLyB5OwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoenogPCBlcHNpbG9uKSB7CiAgICAgICAgICB4ID0gMC43MDcxMDY3ODE7CiAgICAgICAgICB5ID0gMC43MDcxMDY3ODE7CiAgICAgICAgICB6ID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgeiA9IE1hdGguc3FydCh6eik7CiAgICAgICAgICB4ID0geHogLyB6OwogICAgICAgICAgeSA9IHl6IC8gejsKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5zZXQoeCwgeSwgeiwgYW5nbGUpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIGxldCBzID0gTWF0aC5zcXJ0KChtMzIgLSBtMjMpICogKG0zMiAtIG0yMykgKyAobTEzIC0gbTMxKSAqIChtMTMgLSBtMzEpICsgKG0yMSAtIG0xMikgKiAobTIxIC0gbTEyKSk7CiAgICBpZiAoTWF0aC5hYnMocykgPCAxZS0zKQogICAgICBzID0gMTsKICAgIHRoaXMueCA9IChtMzIgLSBtMjMpIC8gczsKICAgIHRoaXMueSA9IChtMTMgLSBtMzEpIC8gczsKICAgIHRoaXMueiA9IChtMjEgLSBtMTIpIC8gczsKICAgIHRoaXMudyA9IE1hdGguYWNvcygobTExICsgbTIyICsgbTMzIC0gMSkgLyAyKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBtaW4odikgewogICAgdGhpcy54ID0gTWF0aC5taW4odGhpcy54LCB2LngpOwogICAgdGhpcy55ID0gTWF0aC5taW4odGhpcy55LCB2LnkpOwogICAgdGhpcy56ID0gTWF0aC5taW4odGhpcy56LCB2LnopOwogICAgdGhpcy53ID0gTWF0aC5taW4odGhpcy53LCB2LncpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG1heCh2KSB7CiAgICB0aGlzLnggPSBNYXRoLm1heCh0aGlzLngsIHYueCk7CiAgICB0aGlzLnkgPSBNYXRoLm1heCh0aGlzLnksIHYueSk7CiAgICB0aGlzLnogPSBNYXRoLm1heCh0aGlzLnosIHYueik7CiAgICB0aGlzLncgPSBNYXRoLm1heCh0aGlzLncsIHYudyk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xhbXAobWluLCBtYXgpIHsKICAgIHRoaXMueCA9IE1hdGgubWF4KG1pbi54LCBNYXRoLm1pbihtYXgueCwgdGhpcy54KSk7CiAgICB0aGlzLnkgPSBNYXRoLm1heChtaW4ueSwgTWF0aC5taW4obWF4LnksIHRoaXMueSkpOwogICAgdGhpcy56ID0gTWF0aC5tYXgobWluLnosIE1hdGgubWluKG1heC56LCB0aGlzLnopKTsKICAgIHRoaXMudyA9IE1hdGgubWF4KG1pbi53LCBNYXRoLm1pbihtYXgudywgdGhpcy53KSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xhbXBTY2FsYXIobWluVmFsLCBtYXhWYWwpIHsKICAgIHRoaXMueCA9IE1hdGgubWF4KG1pblZhbCwgTWF0aC5taW4obWF4VmFsLCB0aGlzLngpKTsKICAgIHRoaXMueSA9IE1hdGgubWF4KG1pblZhbCwgTWF0aC5taW4obWF4VmFsLCB0aGlzLnkpKTsKICAgIHRoaXMueiA9IE1hdGgubWF4KG1pblZhbCwgTWF0aC5taW4obWF4VmFsLCB0aGlzLnopKTsKICAgIHRoaXMudyA9IE1hdGgubWF4KG1pblZhbCwgTWF0aC5taW4obWF4VmFsLCB0aGlzLncpKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBjbGFtcExlbmd0aChtaW4sIG1heCkgewogICAgY29uc3QgbGVuZ3RoID0gdGhpcy5sZW5ndGgoKTsKICAgIHJldHVybiB0aGlzLmRpdmlkZVNjYWxhcihsZW5ndGggfHwgMSkubXVsdGlwbHlTY2FsYXIoTWF0aC5tYXgobWluLCBNYXRoLm1pbihtYXgsIGxlbmd0aCkpKTsKICB9CiAgZmxvb3IoKSB7CiAgICB0aGlzLnggPSBNYXRoLmZsb29yKHRoaXMueCk7CiAgICB0aGlzLnkgPSBNYXRoLmZsb29yKHRoaXMueSk7CiAgICB0aGlzLnogPSBNYXRoLmZsb29yKHRoaXMueik7CiAgICB0aGlzLncgPSBNYXRoLmZsb29yKHRoaXMudyk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2VpbCgpIHsKICAgIHRoaXMueCA9IE1hdGguY2VpbCh0aGlzLngpOwogICAgdGhpcy55ID0gTWF0aC5jZWlsKHRoaXMueSk7CiAgICB0aGlzLnogPSBNYXRoLmNlaWwodGhpcy56KTsKICAgIHRoaXMudyA9IE1hdGguY2VpbCh0aGlzLncpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHJvdW5kKCkgewogICAgdGhpcy54ID0gTWF0aC5yb3VuZCh0aGlzLngpOwogICAgdGhpcy55ID0gTWF0aC5yb3VuZCh0aGlzLnkpOwogICAgdGhpcy56ID0gTWF0aC5yb3VuZCh0aGlzLnopOwogICAgdGhpcy53ID0gTWF0aC5yb3VuZCh0aGlzLncpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHJvdW5kVG9aZXJvKCkgewogICAgdGhpcy54ID0gdGhpcy54IDwgMCA/IE1hdGguY2VpbCh0aGlzLngpIDogTWF0aC5mbG9vcih0aGlzLngpOwogICAgdGhpcy55ID0gdGhpcy55IDwgMCA/IE1hdGguY2VpbCh0aGlzLnkpIDogTWF0aC5mbG9vcih0aGlzLnkpOwogICAgdGhpcy56ID0gdGhpcy56IDwgMCA/IE1hdGguY2VpbCh0aGlzLnopIDogTWF0aC5mbG9vcih0aGlzLnopOwogICAgdGhpcy53ID0gdGhpcy53IDwgMCA/IE1hdGguY2VpbCh0aGlzLncpIDogTWF0aC5mbG9vcih0aGlzLncpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG5lZ2F0ZSgpIHsKICAgIHRoaXMueCA9IC10aGlzLng7CiAgICB0aGlzLnkgPSAtdGhpcy55OwogICAgdGhpcy56ID0gLXRoaXMuejsKICAgIHRoaXMudyA9IC10aGlzLnc7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZG90KHYpIHsKICAgIHJldHVybiB0aGlzLnggKiB2LnggKyB0aGlzLnkgKiB2LnkgKyB0aGlzLnogKiB2LnogKyB0aGlzLncgKiB2Lnc7CiAgfQogIGxlbmd0aFNxKCkgewogICAgcmV0dXJuIHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSArIHRoaXMueiAqIHRoaXMueiArIHRoaXMudyAqIHRoaXMudzsKICB9CiAgbGVuZ3RoKCkgewogICAgcmV0dXJuIE1hdGguc3FydCh0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkgKyB0aGlzLnogKiB0aGlzLnogKyB0aGlzLncgKiB0aGlzLncpOwogIH0KICBtYW5oYXR0YW5MZW5ndGgoKSB7CiAgICByZXR1cm4gTWF0aC5hYnModGhpcy54KSArIE1hdGguYWJzKHRoaXMueSkgKyBNYXRoLmFicyh0aGlzLnopICsgTWF0aC5hYnModGhpcy53KTsKICB9CiAgbm9ybWFsaXplKCkgewogICAgcmV0dXJuIHRoaXMuZGl2aWRlU2NhbGFyKHRoaXMubGVuZ3RoKCkgfHwgMSk7CiAgfQogIHNldExlbmd0aChsZW5ndGgpIHsKICAgIHJldHVybiB0aGlzLm5vcm1hbGl6ZSgpLm11bHRpcGx5U2NhbGFyKGxlbmd0aCk7CiAgfQogIGxlcnAodiwgYWxwaGEpIHsKICAgIHRoaXMueCArPSAodi54IC0gdGhpcy54KSAqIGFscGhhOwogICAgdGhpcy55ICs9ICh2LnkgLSB0aGlzLnkpICogYWxwaGE7CiAgICB0aGlzLnogKz0gKHYueiAtIHRoaXMueikgKiBhbHBoYTsKICAgIHRoaXMudyArPSAodi53IC0gdGhpcy53KSAqIGFscGhhOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGxlcnBWZWN0b3JzKHYxLCB2MiwgYWxwaGEpIHsKICAgIHRoaXMueCA9IHYxLnggKyAodjIueCAtIHYxLngpICogYWxwaGE7CiAgICB0aGlzLnkgPSB2MS55ICsgKHYyLnkgLSB2MS55KSAqIGFscGhhOwogICAgdGhpcy56ID0gdjEueiArICh2Mi56IC0gdjEueikgKiBhbHBoYTsKICAgIHRoaXMudyA9IHYxLncgKyAodjIudyAtIHYxLncpICogYWxwaGE7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZXF1YWxzKHYpIHsKICAgIHJldHVybiB2LnggPT09IHRoaXMueCAmJiB2LnkgPT09IHRoaXMueSAmJiB2LnogPT09IHRoaXMueiAmJiB2LncgPT09IHRoaXMudzsKICB9CiAgZnJvbUFycmF5KGFycmF5LCBvZmZzZXQgPSAwKSB7CiAgICB0aGlzLnggPSBhcnJheVtvZmZzZXRdOwogICAgdGhpcy55ID0gYXJyYXlbb2Zmc2V0ICsgMV07CiAgICB0aGlzLnogPSBhcnJheVtvZmZzZXQgKyAyXTsKICAgIHRoaXMudyA9IGFycmF5W29mZnNldCArIDNdOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRvQXJyYXkoYXJyYXkgPSBbXSwgb2Zmc2V0ID0gMCkgewogICAgYXJyYXlbb2Zmc2V0XSA9IHRoaXMueDsKICAgIGFycmF5W29mZnNldCArIDFdID0gdGhpcy55OwogICAgYXJyYXlbb2Zmc2V0ICsgMl0gPSB0aGlzLno7CiAgICBhcnJheVtvZmZzZXQgKyAzXSA9IHRoaXMudzsKICAgIHJldHVybiBhcnJheTsKICB9CiAgZnJvbUJ1ZmZlckF0dHJpYnV0ZShhdHRyaWJ1dGUsIGluZGV4LCBvZmZzZXQpIHsKICAgIGlmIChvZmZzZXQgIT09IHZvaWQgMCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLlZlY3RvcjQ6IG9mZnNldCBoYXMgYmVlbiByZW1vdmVkIGZyb20gLmZyb21CdWZmZXJBdHRyaWJ1dGUoKS4iKTsKICAgIH0KICAgIHRoaXMueCA9IGF0dHJpYnV0ZS5nZXRYKGluZGV4KTsKICAgIHRoaXMueSA9IGF0dHJpYnV0ZS5nZXRZKGluZGV4KTsKICAgIHRoaXMueiA9IGF0dHJpYnV0ZS5nZXRaKGluZGV4KTsKICAgIHRoaXMudyA9IGF0dHJpYnV0ZS5nZXRXKGluZGV4KTsKICAgIHJldHVybiB0aGlzOwogIH0KICByYW5kb20oKSB7CiAgICB0aGlzLnggPSBNYXRoLnJhbmRvbSgpOwogICAgdGhpcy55ID0gTWF0aC5yYW5kb20oKTsKICAgIHRoaXMueiA9IE1hdGgucmFuZG9tKCk7CiAgICB0aGlzLncgPSBNYXRoLnJhbmRvbSgpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogICpbU3ltYm9sLml0ZXJhdG9yXSgpIHsKICAgIHlpZWxkIHRoaXMueDsKICAgIHlpZWxkIHRoaXMueTsKICAgIHlpZWxkIHRoaXMuejsKICAgIHlpZWxkIHRoaXMudzsKICB9Cn0KVmVjdG9yNC5wcm90b3R5cGUuaXNWZWN0b3I0ID0gdHJ1ZTsKY2xhc3MgV2ViR0xSZW5kZXJUYXJnZXQgZXh0ZW5kcyBFdmVudERpc3BhdGNoZXIgewogIGNvbnN0cnVjdG9yKHdpZHRoLCBoZWlnaHQsIG9wdGlvbnMgPSB7fSkgewogICAgc3VwZXIoKTsKICAgIHRoaXMud2lkdGggPSB3aWR0aDsKICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwogICAgdGhpcy5kZXB0aCA9IDE7CiAgICB0aGlzLnNjaXNzb3IgPSBuZXcgVmVjdG9yNCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICAgIHRoaXMuc2Npc3NvclRlc3QgPSBmYWxzZTsKICAgIHRoaXMudmlld3BvcnQgPSBuZXcgVmVjdG9yNCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICAgIHRoaXMudGV4dHVyZSA9IG5ldyBUZXh0dXJlKHZvaWQgMCwgb3B0aW9ucy5tYXBwaW5nLCBvcHRpb25zLndyYXBTLCBvcHRpb25zLndyYXBULCBvcHRpb25zLm1hZ0ZpbHRlciwgb3B0aW9ucy5taW5GaWx0ZXIsIG9wdGlvbnMuZm9ybWF0LCBvcHRpb25zLnR5cGUsIG9wdGlvbnMuYW5pc290cm9weSwgb3B0aW9ucy5lbmNvZGluZyk7CiAgICB0aGlzLnRleHR1cmUuaXNSZW5kZXJUYXJnZXRUZXh0dXJlID0gdHJ1ZTsKICAgIHRoaXMudGV4dHVyZS5pbWFnZSA9IHsgd2lkdGgsIGhlaWdodCwgZGVwdGg6IDEgfTsKICAgIHRoaXMudGV4dHVyZS5nZW5lcmF0ZU1pcG1hcHMgPSBvcHRpb25zLmdlbmVyYXRlTWlwbWFwcyAhPT0gdm9pZCAwID8gb3B0aW9ucy5nZW5lcmF0ZU1pcG1hcHMgOiBmYWxzZTsKICAgIHRoaXMudGV4dHVyZS5pbnRlcm5hbEZvcm1hdCA9IG9wdGlvbnMuaW50ZXJuYWxGb3JtYXQgIT09IHZvaWQgMCA/IG9wdGlvbnMuaW50ZXJuYWxGb3JtYXQgOiBudWxsOwogICAgdGhpcy50ZXh0dXJlLm1pbkZpbHRlciA9IG9wdGlvbnMubWluRmlsdGVyICE9PSB2b2lkIDAgPyBvcHRpb25zLm1pbkZpbHRlciA6IExpbmVhckZpbHRlcjsKICAgIHRoaXMuZGVwdGhCdWZmZXIgPSBvcHRpb25zLmRlcHRoQnVmZmVyICE9PSB2b2lkIDAgPyBvcHRpb25zLmRlcHRoQnVmZmVyIDogdHJ1ZTsKICAgIHRoaXMuc3RlbmNpbEJ1ZmZlciA9IG9wdGlvbnMuc3RlbmNpbEJ1ZmZlciAhPT0gdm9pZCAwID8gb3B0aW9ucy5zdGVuY2lsQnVmZmVyIDogZmFsc2U7CiAgICB0aGlzLmRlcHRoVGV4dHVyZSA9IG9wdGlvbnMuZGVwdGhUZXh0dXJlICE9PSB2b2lkIDAgPyBvcHRpb25zLmRlcHRoVGV4dHVyZSA6IG51bGw7CiAgfQogIHNldFRleHR1cmUodGV4dHVyZSkgewogICAgdGV4dHVyZS5pbWFnZSA9IHsKICAgICAgd2lkdGg6IHRoaXMud2lkdGgsCiAgICAgIGhlaWdodDogdGhpcy5oZWlnaHQsCiAgICAgIGRlcHRoOiB0aGlzLmRlcHRoCiAgICB9OwogICAgdGhpcy50ZXh0dXJlID0gdGV4dHVyZTsKICB9CiAgc2V0U2l6ZSh3aWR0aCwgaGVpZ2h0LCBkZXB0aCA9IDEpIHsKICAgIGlmICh0aGlzLndpZHRoICE9PSB3aWR0aCB8fCB0aGlzLmhlaWdodCAhPT0gaGVpZ2h0IHx8IHRoaXMuZGVwdGggIT09IGRlcHRoKSB7CiAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgIHRoaXMuZGVwdGggPSBkZXB0aDsKICAgICAgdGhpcy50ZXh0dXJlLmltYWdlLndpZHRoID0gd2lkdGg7CiAgICAgIHRoaXMudGV4dHVyZS5pbWFnZS5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgIHRoaXMudGV4dHVyZS5pbWFnZS5kZXB0aCA9IGRlcHRoOwogICAgICB0aGlzLmRpc3Bvc2UoKTsKICAgIH0KICAgIHRoaXMudmlld3BvcnQuc2V0KDAsIDAsIHdpZHRoLCBoZWlnaHQpOwogICAgdGhpcy5zY2lzc29yLnNldCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICB9CiAgY2xvbmUoKSB7CiAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoKS5jb3B5KHRoaXMpOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgdGhpcy53aWR0aCA9IHNvdXJjZS53aWR0aDsKICAgIHRoaXMuaGVpZ2h0ID0gc291cmNlLmhlaWdodDsKICAgIHRoaXMuZGVwdGggPSBzb3VyY2UuZGVwdGg7CiAgICB0aGlzLnZpZXdwb3J0LmNvcHkoc291cmNlLnZpZXdwb3J0KTsKICAgIHRoaXMudGV4dHVyZSA9IHNvdXJjZS50ZXh0dXJlLmNsb25lKCk7CiAgICB0aGlzLnRleHR1cmUuaW1hZ2UgPSBPYmplY3QuYXNzaWduKHt9LCBzb3VyY2UudGV4dHVyZS5pbWFnZSk7CiAgICB0aGlzLmRlcHRoQnVmZmVyID0gc291cmNlLmRlcHRoQnVmZmVyOwogICAgdGhpcy5zdGVuY2lsQnVmZmVyID0gc291cmNlLnN0ZW5jaWxCdWZmZXI7CiAgICB0aGlzLmRlcHRoVGV4dHVyZSA9IHNvdXJjZS5kZXB0aFRleHR1cmU7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZGlzcG9zZSgpIHsKICAgIHRoaXMuZGlzcGF0Y2hFdmVudCh7IHR5cGU6ICJkaXNwb3NlIiB9KTsKICB9Cn0KV2ViR0xSZW5kZXJUYXJnZXQucHJvdG90eXBlLmlzV2ViR0xSZW5kZXJUYXJnZXQgPSB0cnVlOwpjbGFzcyBXZWJHTE11bHRpcGxlUmVuZGVyVGFyZ2V0cyBleHRlbmRzIFdlYkdMUmVuZGVyVGFyZ2V0IHsKICBjb25zdHJ1Y3Rvcih3aWR0aCwgaGVpZ2h0LCBjb3VudCkgewogICAgc3VwZXIod2lkdGgsIGhlaWdodCk7CiAgICBjb25zdCB0ZXh0dXJlID0gdGhpcy50ZXh0dXJlOwogICAgdGhpcy50ZXh0dXJlID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgdGhpcy50ZXh0dXJlW2ldID0gdGV4dHVyZS5jbG9uZSgpOwogICAgfQogIH0KICBzZXRTaXplKHdpZHRoLCBoZWlnaHQsIGRlcHRoID0gMSkgewogICAgaWYgKHRoaXMud2lkdGggIT09IHdpZHRoIHx8IHRoaXMuaGVpZ2h0ICE9PSBoZWlnaHQgfHwgdGhpcy5kZXB0aCAhPT0gZGVwdGgpIHsKICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwogICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKICAgICAgdGhpcy5kZXB0aCA9IGRlcHRoOwogICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSB0aGlzLnRleHR1cmUubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICAgIHRoaXMudGV4dHVyZVtpXS5pbWFnZS53aWR0aCA9IHdpZHRoOwogICAgICAgIHRoaXMudGV4dHVyZVtpXS5pbWFnZS5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgICAgdGhpcy50ZXh0dXJlW2ldLmltYWdlLmRlcHRoID0gZGVwdGg7CiAgICAgIH0KICAgICAgdGhpcy5kaXNwb3NlKCk7CiAgICB9CiAgICB0aGlzLnZpZXdwb3J0LnNldCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICAgIHRoaXMuc2Npc3Nvci5zZXQoMCwgMCwgd2lkdGgsIGhlaWdodCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHRoaXMuZGlzcG9zZSgpOwogICAgdGhpcy53aWR0aCA9IHNvdXJjZS53aWR0aDsKICAgIHRoaXMuaGVpZ2h0ID0gc291cmNlLmhlaWdodDsKICAgIHRoaXMuZGVwdGggPSBzb3VyY2UuZGVwdGg7CiAgICB0aGlzLnZpZXdwb3J0LnNldCgwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7CiAgICB0aGlzLnNjaXNzb3Iuc2V0KDAsIDAsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTsKICAgIHRoaXMuZGVwdGhCdWZmZXIgPSBzb3VyY2UuZGVwdGhCdWZmZXI7CiAgICB0aGlzLnN0ZW5jaWxCdWZmZXIgPSBzb3VyY2Uuc3RlbmNpbEJ1ZmZlcjsKICAgIHRoaXMuZGVwdGhUZXh0dXJlID0gc291cmNlLmRlcHRoVGV4dHVyZTsKICAgIHRoaXMudGV4dHVyZS5sZW5ndGggPSAwOwogICAgZm9yIChsZXQgaSA9IDAsIGlsID0gc291cmNlLnRleHR1cmUubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICB0aGlzLnRleHR1cmVbaV0gPSBzb3VyY2UudGV4dHVyZVtpXS5jbG9uZSgpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQp9CldlYkdMTXVsdGlwbGVSZW5kZXJUYXJnZXRzLnByb3RvdHlwZS5pc1dlYkdMTXVsdGlwbGVSZW5kZXJUYXJnZXRzID0gdHJ1ZTsKY2xhc3MgV2ViR0xNdWx0aXNhbXBsZVJlbmRlclRhcmdldCBleHRlbmRzIFdlYkdMUmVuZGVyVGFyZ2V0IHsKICBjb25zdHJ1Y3Rvcih3aWR0aCwgaGVpZ2h0LCBvcHRpb25zID0ge30pIHsKICAgIHN1cGVyKHdpZHRoLCBoZWlnaHQsIG9wdGlvbnMpOwogICAgdGhpcy5zYW1wbGVzID0gNDsKICAgIHRoaXMuaWdub3JlRGVwdGhGb3JNdWx0aXNhbXBsZUNvcHkgPSBvcHRpb25zLmlnbm9yZURlcHRoICE9PSB2b2lkIDAgPyBvcHRpb25zLmlnbm9yZURlcHRoIDogdHJ1ZTsKICAgIHRoaXMudXNlUmVuZGVyVG9UZXh0dXJlID0gb3B0aW9ucy51c2VSZW5kZXJUb1RleHR1cmUgIT09IHZvaWQgMCA/IG9wdGlvbnMudXNlUmVuZGVyVG9UZXh0dXJlIDogZmFsc2U7CiAgICB0aGlzLnVzZVJlbmRlcmJ1ZmZlciA9IHRoaXMudXNlUmVuZGVyVG9UZXh0dXJlID09PSBmYWxzZTsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHN1cGVyLmNvcHkuY2FsbCh0aGlzLCBzb3VyY2UpOwogICAgdGhpcy5zYW1wbGVzID0gc291cmNlLnNhbXBsZXM7CiAgICB0aGlzLnVzZVJlbmRlclRvVGV4dHVyZSA9IHNvdXJjZS51c2VSZW5kZXJUb1RleHR1cmU7CiAgICB0aGlzLnVzZVJlbmRlcmJ1ZmZlciA9IHNvdXJjZS51c2VSZW5kZXJidWZmZXI7CiAgICByZXR1cm4gdGhpczsKICB9Cn0KV2ViR0xNdWx0aXNhbXBsZVJlbmRlclRhcmdldC5wcm90b3R5cGUuaXNXZWJHTE11bHRpc2FtcGxlUmVuZGVyVGFyZ2V0ID0gdHJ1ZTsKY2xhc3MgUXVhdGVybmlvbiB7CiAgY29uc3RydWN0b3IoeCA9IDAsIHkgPSAwLCB6ID0gMCwgdyA9IDEpIHsKICAgIHRoaXMuX3ggPSB4OwogICAgdGhpcy5feSA9IHk7CiAgICB0aGlzLl96ID0gejsKICAgIHRoaXMuX3cgPSB3OwogIH0KICBzdGF0aWMgc2xlcnAocWEsIHFiLCBxbSwgdCkgewogICAgY29uc29sZS53YXJuKCJUSFJFRS5RdWF0ZXJuaW9uOiBTdGF0aWMgLnNsZXJwKCkgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIHFtLnNsZXJwUXVhdGVybmlvbnMoIHFhLCBxYiwgdCApIGluc3RlYWQuIik7CiAgICByZXR1cm4gcW0uc2xlcnBRdWF0ZXJuaW9ucyhxYSwgcWIsIHQpOwogIH0KICBzdGF0aWMgc2xlcnBGbGF0KGRzdCwgZHN0T2Zmc2V0LCBzcmMwLCBzcmNPZmZzZXQwLCBzcmMxLCBzcmNPZmZzZXQxLCB0KSB7CiAgICBsZXQgeDAgPSBzcmMwW3NyY09mZnNldDAgKyAwXSwgeTAgPSBzcmMwW3NyY09mZnNldDAgKyAxXSwgejAgPSBzcmMwW3NyY09mZnNldDAgKyAyXSwgdzAgPSBzcmMwW3NyY09mZnNldDAgKyAzXTsKICAgIGNvbnN0IHgxID0gc3JjMVtzcmNPZmZzZXQxICsgMF0sIHkxID0gc3JjMVtzcmNPZmZzZXQxICsgMV0sIHoxID0gc3JjMVtzcmNPZmZzZXQxICsgMl0sIHcxID0gc3JjMVtzcmNPZmZzZXQxICsgM107CiAgICBpZiAodCA9PT0gMCkgewogICAgICBkc3RbZHN0T2Zmc2V0ICsgMF0gPSB4MDsKICAgICAgZHN0W2RzdE9mZnNldCArIDFdID0geTA7CiAgICAgIGRzdFtkc3RPZmZzZXQgKyAyXSA9IHowOwogICAgICBkc3RbZHN0T2Zmc2V0ICsgM10gPSB3MDsKICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKHQgPT09IDEpIHsKICAgICAgZHN0W2RzdE9mZnNldCArIDBdID0geDE7CiAgICAgIGRzdFtkc3RPZmZzZXQgKyAxXSA9IHkxOwogICAgICBkc3RbZHN0T2Zmc2V0ICsgMl0gPSB6MTsKICAgICAgZHN0W2RzdE9mZnNldCArIDNdID0gdzE7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICh3MCAhPT0gdzEgfHwgeDAgIT09IHgxIHx8IHkwICE9PSB5MSB8fCB6MCAhPT0gejEpIHsKICAgICAgbGV0IHMgPSAxIC0gdDsKICAgICAgY29uc3QgY29zID0geDAgKiB4MSArIHkwICogeTEgKyB6MCAqIHoxICsgdzAgKiB3MSwgZGlyID0gY29zID49IDAgPyAxIDogLTEsIHNxclNpbiA9IDEgLSBjb3MgKiBjb3M7CiAgICAgIGlmIChzcXJTaW4gPiBOdW1iZXIuRVBTSUxPTikgewogICAgICAgIGNvbnN0IHNpbiA9IE1hdGguc3FydChzcXJTaW4pLCBsZW4gPSBNYXRoLmF0YW4yKHNpbiwgY29zICogZGlyKTsKICAgICAgICBzID0gTWF0aC5zaW4ocyAqIGxlbikgLyBzaW47CiAgICAgICAgdCA9IE1hdGguc2luKHQgKiBsZW4pIC8gc2luOwogICAgICB9CiAgICAgIGNvbnN0IHREaXIgPSB0ICogZGlyOwogICAgICB4MCA9IHgwICogcyArIHgxICogdERpcjsKICAgICAgeTAgPSB5MCAqIHMgKyB5MSAqIHREaXI7CiAgICAgIHowID0gejAgKiBzICsgejEgKiB0RGlyOwogICAgICB3MCA9IHcwICogcyArIHcxICogdERpcjsKICAgICAgaWYgKHMgPT09IDEgLSB0KSB7CiAgICAgICAgY29uc3QgZiA9IDEgLyBNYXRoLnNxcnQoeDAgKiB4MCArIHkwICogeTAgKyB6MCAqIHowICsgdzAgKiB3MCk7CiAgICAgICAgeDAgKj0gZjsKICAgICAgICB5MCAqPSBmOwogICAgICAgIHowICo9IGY7CiAgICAgICAgdzAgKj0gZjsKICAgICAgfQogICAgfQogICAgZHN0W2RzdE9mZnNldF0gPSB4MDsKICAgIGRzdFtkc3RPZmZzZXQgKyAxXSA9IHkwOwogICAgZHN0W2RzdE9mZnNldCArIDJdID0gejA7CiAgICBkc3RbZHN0T2Zmc2V0ICsgM10gPSB3MDsKICB9CiAgc3RhdGljIG11bHRpcGx5UXVhdGVybmlvbnNGbGF0KGRzdCwgZHN0T2Zmc2V0LCBzcmMwLCBzcmNPZmZzZXQwLCBzcmMxLCBzcmNPZmZzZXQxKSB7CiAgICBjb25zdCB4MCA9IHNyYzBbc3JjT2Zmc2V0MF07CiAgICBjb25zdCB5MCA9IHNyYzBbc3JjT2Zmc2V0MCArIDFdOwogICAgY29uc3QgejAgPSBzcmMwW3NyY09mZnNldDAgKyAyXTsKICAgIGNvbnN0IHcwID0gc3JjMFtzcmNPZmZzZXQwICsgM107CiAgICBjb25zdCB4MSA9IHNyYzFbc3JjT2Zmc2V0MV07CiAgICBjb25zdCB5MSA9IHNyYzFbc3JjT2Zmc2V0MSArIDFdOwogICAgY29uc3QgejEgPSBzcmMxW3NyY09mZnNldDEgKyAyXTsKICAgIGNvbnN0IHcxID0gc3JjMVtzcmNPZmZzZXQxICsgM107CiAgICBkc3RbZHN0T2Zmc2V0XSA9IHgwICogdzEgKyB3MCAqIHgxICsgeTAgKiB6MSAtIHowICogeTE7CiAgICBkc3RbZHN0T2Zmc2V0ICsgMV0gPSB5MCAqIHcxICsgdzAgKiB5MSArIHowICogeDEgLSB4MCAqIHoxOwogICAgZHN0W2RzdE9mZnNldCArIDJdID0gejAgKiB3MSArIHcwICogejEgKyB4MCAqIHkxIC0geTAgKiB4MTsKICAgIGRzdFtkc3RPZmZzZXQgKyAzXSA9IHcwICogdzEgLSB4MCAqIHgxIC0geTAgKiB5MSAtIHowICogejE7CiAgICByZXR1cm4gZHN0OwogIH0KICBnZXQgeCgpIHsKICAgIHJldHVybiB0aGlzLl94OwogIH0KICBzZXQgeCh2YWx1ZSkgewogICAgdGhpcy5feCA9IHZhbHVlOwogICAgdGhpcy5fb25DaGFuZ2VDYWxsYmFjaygpOwogIH0KICBnZXQgeSgpIHsKICAgIHJldHVybiB0aGlzLl95OwogIH0KICBzZXQgeSh2YWx1ZSkgewogICAgdGhpcy5feSA9IHZhbHVlOwogICAgdGhpcy5fb25DaGFuZ2VDYWxsYmFjaygpOwogIH0KICBnZXQgeigpIHsKICAgIHJldHVybiB0aGlzLl96OwogIH0KICBzZXQgeih2YWx1ZSkgewogICAgdGhpcy5feiA9IHZhbHVlOwogICAgdGhpcy5fb25DaGFuZ2VDYWxsYmFjaygpOwogIH0KICBnZXQgdygpIHsKICAgIHJldHVybiB0aGlzLl93OwogIH0KICBzZXQgdyh2YWx1ZSkgewogICAgdGhpcy5fdyA9IHZhbHVlOwogICAgdGhpcy5fb25DaGFuZ2VDYWxsYmFjaygpOwogIH0KICBzZXQoeCwgeSwgeiwgdykgewogICAgdGhpcy5feCA9IHg7CiAgICB0aGlzLl95ID0geTsKICAgIHRoaXMuX3ogPSB6OwogICAgdGhpcy5fdyA9IHc7CiAgICB0aGlzLl9vbkNoYW5nZUNhbGxiYWNrKCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xvbmUoKSB7CiAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feCwgdGhpcy5feSwgdGhpcy5feiwgdGhpcy5fdyk7CiAgfQogIGNvcHkocXVhdGVybmlvbikgewogICAgdGhpcy5feCA9IHF1YXRlcm5pb24ueDsKICAgIHRoaXMuX3kgPSBxdWF0ZXJuaW9uLnk7CiAgICB0aGlzLl96ID0gcXVhdGVybmlvbi56OwogICAgdGhpcy5fdyA9IHF1YXRlcm5pb24udzsKICAgIHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRGcm9tRXVsZXIoZXVsZXIsIHVwZGF0ZSkgewogICAgaWYgKCEoZXVsZXIgJiYgZXVsZXIuaXNFdWxlcikpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJUSFJFRS5RdWF0ZXJuaW9uOiAuc2V0RnJvbUV1bGVyKCkgbm93IGV4cGVjdHMgYW4gRXVsZXIgcm90YXRpb24gcmF0aGVyIHRoYW4gYSBWZWN0b3IzIGFuZCBvcmRlci4iKTsKICAgIH0KICAgIGNvbnN0IHggPSBldWxlci5feCwgeSA9IGV1bGVyLl95LCB6ID0gZXVsZXIuX3osIG9yZGVyID0gZXVsZXIuX29yZGVyOwogICAgY29uc3QgY29zID0gTWF0aC5jb3M7CiAgICBjb25zdCBzaW4gPSBNYXRoLnNpbjsKICAgIGNvbnN0IGMxID0gY29zKHggLyAyKTsKICAgIGNvbnN0IGMyID0gY29zKHkgLyAyKTsKICAgIGNvbnN0IGMzID0gY29zKHogLyAyKTsKICAgIGNvbnN0IHMxID0gc2luKHggLyAyKTsKICAgIGNvbnN0IHMyID0gc2luKHkgLyAyKTsKICAgIGNvbnN0IHMzID0gc2luKHogLyAyKTsKICAgIHN3aXRjaCAob3JkZXIpIHsKICAgICAgY2FzZSAiWFlaIjoKICAgICAgICB0aGlzLl94ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMuX3kgPSBjMSAqIHMyICogYzMgLSBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy5feiA9IGMxICogYzIgKiBzMyArIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLl93ID0gYzEgKiBjMiAqIGMzIC0gczEgKiBzMiAqIHMzOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJZWFoiOgogICAgICAgIHRoaXMuX3ggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy5feSA9IGMxICogczIgKiBjMyAtIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLl96ID0gYzEgKiBjMiAqIHMzIC0gczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMuX3cgPSBjMSAqIGMyICogYzMgKyBzMSAqIHMyICogczM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIlpYWSI6CiAgICAgICAgdGhpcy5feCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLl95ID0gYzEgKiBzMiAqIGMzICsgczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMuX3ogPSBjMSAqIGMyICogczMgKyBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy5fdyA9IGMxICogYzIgKiBjMyAtIHMxICogczIgKiBzMzsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAiWllYIjoKICAgICAgICB0aGlzLl94ID0gczEgKiBjMiAqIGMzIC0gYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMuX3kgPSBjMSAqIHMyICogYzMgKyBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy5feiA9IGMxICogYzIgKiBzMyAtIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLl93ID0gYzEgKiBjMiAqIGMzICsgczEgKiBzMiAqIHMzOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJZWlgiOgogICAgICAgIHRoaXMuX3ggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy5feSA9IGMxICogczIgKiBjMyArIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLl96ID0gYzEgKiBjMiAqIHMzIC0gczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMuX3cgPSBjMSAqIGMyICogYzMgLSBzMSAqIHMyICogczM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIlhaWSI6CiAgICAgICAgdGhpcy5feCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLl95ID0gYzEgKiBzMiAqIGMzIC0gczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMuX3ogPSBjMSAqIGMyICogczMgKyBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy5fdyA9IGMxICogYzIgKiBjMyArIHMxICogczIgKiBzMzsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLlF1YXRlcm5pb246IC5zZXRGcm9tRXVsZXIoKSBlbmNvdW50ZXJlZCBhbiB1bmtub3duIG9yZGVyOiAiICsgb3JkZXIpOwogICAgfQogICAgaWYgKHVwZGF0ZSAhPT0gZmFsc2UpCiAgICAgIHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRGcm9tQXhpc0FuZ2xlKGF4aXMsIGFuZ2xlKSB7CiAgICBjb25zdCBoYWxmQW5nbGUgPSBhbmdsZSAvIDIsIHMgPSBNYXRoLnNpbihoYWxmQW5nbGUpOwogICAgdGhpcy5feCA9IGF4aXMueCAqIHM7CiAgICB0aGlzLl95ID0gYXhpcy55ICogczsKICAgIHRoaXMuX3ogPSBheGlzLnogKiBzOwogICAgdGhpcy5fdyA9IE1hdGguY29zKGhhbGZBbmdsZSk7CiAgICB0aGlzLl9vbkNoYW5nZUNhbGxiYWNrKCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0RnJvbVJvdGF0aW9uTWF0cml4KG0pIHsKICAgIGNvbnN0IHRlID0gbS5lbGVtZW50cywgbTExID0gdGVbMF0sIG0xMiA9IHRlWzRdLCBtMTMgPSB0ZVs4XSwgbTIxID0gdGVbMV0sIG0yMiA9IHRlWzVdLCBtMjMgPSB0ZVs5XSwgbTMxID0gdGVbMl0sIG0zMiA9IHRlWzZdLCBtMzMgPSB0ZVsxMF0sIHRyYWNlID0gbTExICsgbTIyICsgbTMzOwogICAgaWYgKHRyYWNlID4gMCkgewogICAgICBjb25zdCBzID0gMC41IC8gTWF0aC5zcXJ0KHRyYWNlICsgMSk7CiAgICAgIHRoaXMuX3cgPSAwLjI1IC8gczsKICAgICAgdGhpcy5feCA9IChtMzIgLSBtMjMpICogczsKICAgICAgdGhpcy5feSA9IChtMTMgLSBtMzEpICogczsKICAgICAgdGhpcy5feiA9IChtMjEgLSBtMTIpICogczsKICAgIH0gZWxzZSBpZiAobTExID4gbTIyICYmIG0xMSA+IG0zMykgewogICAgICBjb25zdCBzID0gMiAqIE1hdGguc3FydCgxICsgbTExIC0gbTIyIC0gbTMzKTsKICAgICAgdGhpcy5fdyA9IChtMzIgLSBtMjMpIC8gczsKICAgICAgdGhpcy5feCA9IDAuMjUgKiBzOwogICAgICB0aGlzLl95ID0gKG0xMiArIG0yMSkgLyBzOwogICAgICB0aGlzLl96ID0gKG0xMyArIG0zMSkgLyBzOwogICAgfSBlbHNlIGlmIChtMjIgPiBtMzMpIHsKICAgICAgY29uc3QgcyA9IDIgKiBNYXRoLnNxcnQoMSArIG0yMiAtIG0xMSAtIG0zMyk7CiAgICAgIHRoaXMuX3cgPSAobTEzIC0gbTMxKSAvIHM7CiAgICAgIHRoaXMuX3ggPSAobTEyICsgbTIxKSAvIHM7CiAgICAgIHRoaXMuX3kgPSAwLjI1ICogczsKICAgICAgdGhpcy5feiA9IChtMjMgKyBtMzIpIC8gczsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IHMgPSAyICogTWF0aC5zcXJ0KDEgKyBtMzMgLSBtMTEgLSBtMjIpOwogICAgICB0aGlzLl93ID0gKG0yMSAtIG0xMikgLyBzOwogICAgICB0aGlzLl94ID0gKG0xMyArIG0zMSkgLyBzOwogICAgICB0aGlzLl95ID0gKG0yMyArIG0zMikgLyBzOwogICAgICB0aGlzLl96ID0gMC4yNSAqIHM7CiAgICB9CiAgICB0aGlzLl9vbkNoYW5nZUNhbGxiYWNrKCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0RnJvbVVuaXRWZWN0b3JzKHZGcm9tLCB2VG8pIHsKICAgIGxldCByID0gdkZyb20uZG90KHZUbykgKyAxOwogICAgaWYgKHIgPCBOdW1iZXIuRVBTSUxPTikgewogICAgICByID0gMDsKICAgICAgaWYgKE1hdGguYWJzKHZGcm9tLngpID4gTWF0aC5hYnModkZyb20ueikpIHsKICAgICAgICB0aGlzLl94ID0gLXZGcm9tLnk7CiAgICAgICAgdGhpcy5feSA9IHZGcm9tLng7CiAgICAgICAgdGhpcy5feiA9IDA7CiAgICAgICAgdGhpcy5fdyA9IHI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5feCA9IDA7CiAgICAgICAgdGhpcy5feSA9IC12RnJvbS56OwogICAgICAgIHRoaXMuX3ogPSB2RnJvbS55OwogICAgICAgIHRoaXMuX3cgPSByOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzLl94ID0gdkZyb20ueSAqIHZUby56IC0gdkZyb20ueiAqIHZUby55OwogICAgICB0aGlzLl95ID0gdkZyb20ueiAqIHZUby54IC0gdkZyb20ueCAqIHZUby56OwogICAgICB0aGlzLl96ID0gdkZyb20ueCAqIHZUby55IC0gdkZyb20ueSAqIHZUby54OwogICAgICB0aGlzLl93ID0gcjsKICAgIH0KICAgIHJldHVybiB0aGlzLm5vcm1hbGl6ZSgpOwogIH0KICBhbmdsZVRvKHEpIHsKICAgIHJldHVybiAyICogTWF0aC5hY29zKE1hdGguYWJzKGNsYW1wKHRoaXMuZG90KHEpLCAtMSwgMSkpKTsKICB9CiAgcm90YXRlVG93YXJkcyhxLCBzdGVwKSB7CiAgICBjb25zdCBhbmdsZSA9IHRoaXMuYW5nbGVUbyhxKTsKICAgIGlmIChhbmdsZSA9PT0gMCkKICAgICAgcmV0dXJuIHRoaXM7CiAgICBjb25zdCB0ID0gTWF0aC5taW4oMSwgc3RlcCAvIGFuZ2xlKTsKICAgIHRoaXMuc2xlcnAocSwgdCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgaWRlbnRpdHkoKSB7CiAgICByZXR1cm4gdGhpcy5zZXQoMCwgMCwgMCwgMSk7CiAgfQogIGludmVydCgpIHsKICAgIHJldHVybiB0aGlzLmNvbmp1Z2F0ZSgpOwogIH0KICBjb25qdWdhdGUoKSB7CiAgICB0aGlzLl94ICo9IC0xOwogICAgdGhpcy5feSAqPSAtMTsKICAgIHRoaXMuX3ogKj0gLTE7CiAgICB0aGlzLl9vbkNoYW5nZUNhbGxiYWNrKCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZG90KHYpIHsKICAgIHJldHVybiB0aGlzLl94ICogdi5feCArIHRoaXMuX3kgKiB2Ll95ICsgdGhpcy5feiAqIHYuX3ogKyB0aGlzLl93ICogdi5fdzsKICB9CiAgbGVuZ3RoU3EoKSB7CiAgICByZXR1cm4gdGhpcy5feCAqIHRoaXMuX3ggKyB0aGlzLl95ICogdGhpcy5feSArIHRoaXMuX3ogKiB0aGlzLl96ICsgdGhpcy5fdyAqIHRoaXMuX3c7CiAgfQogIGxlbmd0aCgpIHsKICAgIHJldHVybiBNYXRoLnNxcnQodGhpcy5feCAqIHRoaXMuX3ggKyB0aGlzLl95ICogdGhpcy5feSArIHRoaXMuX3ogKiB0aGlzLl96ICsgdGhpcy5fdyAqIHRoaXMuX3cpOwogIH0KICBub3JtYWxpemUoKSB7CiAgICBsZXQgbCA9IHRoaXMubGVuZ3RoKCk7CiAgICBpZiAobCA9PT0gMCkgewogICAgICB0aGlzLl94ID0gMDsKICAgICAgdGhpcy5feSA9IDA7CiAgICAgIHRoaXMuX3ogPSAwOwogICAgICB0aGlzLl93ID0gMTsKICAgIH0gZWxzZSB7CiAgICAgIGwgPSAxIC8gbDsKICAgICAgdGhpcy5feCA9IHRoaXMuX3ggKiBsOwogICAgICB0aGlzLl95ID0gdGhpcy5feSAqIGw7CiAgICAgIHRoaXMuX3ogPSB0aGlzLl96ICogbDsKICAgICAgdGhpcy5fdyA9IHRoaXMuX3cgKiBsOwogICAgfQogICAgdGhpcy5fb25DaGFuZ2VDYWxsYmFjaygpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG11bHRpcGx5KHEsIHApIHsKICAgIGlmIChwICE9PSB2b2lkIDApIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5RdWF0ZXJuaW9uOiAubXVsdGlwbHkoKSBub3cgb25seSBhY2NlcHRzIG9uZSBhcmd1bWVudC4gVXNlIC5tdWx0aXBseVF1YXRlcm5pb25zKCBhLCBiICkgaW5zdGVhZC4iKTsKICAgICAgcmV0dXJuIHRoaXMubXVsdGlwbHlRdWF0ZXJuaW9ucyhxLCBwKTsKICAgIH0KICAgIHJldHVybiB0aGlzLm11bHRpcGx5UXVhdGVybmlvbnModGhpcywgcSk7CiAgfQogIHByZW11bHRpcGx5KHEpIHsKICAgIHJldHVybiB0aGlzLm11bHRpcGx5UXVhdGVybmlvbnMocSwgdGhpcyk7CiAgfQogIG11bHRpcGx5UXVhdGVybmlvbnMoYSwgYikgewogICAgY29uc3QgcWF4ID0gYS5feCwgcWF5ID0gYS5feSwgcWF6ID0gYS5feiwgcWF3ID0gYS5fdzsKICAgIGNvbnN0IHFieCA9IGIuX3gsIHFieSA9IGIuX3ksIHFieiA9IGIuX3osIHFidyA9IGIuX3c7CiAgICB0aGlzLl94ID0gcWF4ICogcWJ3ICsgcWF3ICogcWJ4ICsgcWF5ICogcWJ6IC0gcWF6ICogcWJ5OwogICAgdGhpcy5feSA9IHFheSAqIHFidyArIHFhdyAqIHFieSArIHFheiAqIHFieCAtIHFheCAqIHFiejsKICAgIHRoaXMuX3ogPSBxYXogKiBxYncgKyBxYXcgKiBxYnogKyBxYXggKiBxYnkgLSBxYXkgKiBxYng7CiAgICB0aGlzLl93ID0gcWF3ICogcWJ3IC0gcWF4ICogcWJ4IC0gcWF5ICogcWJ5IC0gcWF6ICogcWJ6OwogICAgdGhpcy5fb25DaGFuZ2VDYWxsYmFjaygpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNsZXJwKHFiLCB0KSB7CiAgICBpZiAodCA9PT0gMCkKICAgICAgcmV0dXJuIHRoaXM7CiAgICBpZiAodCA9PT0gMSkKICAgICAgcmV0dXJuIHRoaXMuY29weShxYik7CiAgICBjb25zdCB4ID0gdGhpcy5feCwgeSA9IHRoaXMuX3ksIHogPSB0aGlzLl96LCB3ID0gdGhpcy5fdzsKICAgIGxldCBjb3NIYWxmVGhldGEgPSB3ICogcWIuX3cgKyB4ICogcWIuX3ggKyB5ICogcWIuX3kgKyB6ICogcWIuX3o7CiAgICBpZiAoY29zSGFsZlRoZXRhIDwgMCkgewogICAgICB0aGlzLl93ID0gLXFiLl93OwogICAgICB0aGlzLl94ID0gLXFiLl94OwogICAgICB0aGlzLl95ID0gLXFiLl95OwogICAgICB0aGlzLl96ID0gLXFiLl96OwogICAgICBjb3NIYWxmVGhldGEgPSAtY29zSGFsZlRoZXRhOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5jb3B5KHFiKTsKICAgIH0KICAgIGlmIChjb3NIYWxmVGhldGEgPj0gMSkgewogICAgICB0aGlzLl93ID0gdzsKICAgICAgdGhpcy5feCA9IHg7CiAgICAgIHRoaXMuX3kgPSB5OwogICAgICB0aGlzLl96ID0gejsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICBjb25zdCBzcXJTaW5IYWxmVGhldGEgPSAxIC0gY29zSGFsZlRoZXRhICogY29zSGFsZlRoZXRhOwogICAgaWYgKHNxclNpbkhhbGZUaGV0YSA8PSBOdW1iZXIuRVBTSUxPTikgewogICAgICBjb25zdCBzID0gMSAtIHQ7CiAgICAgIHRoaXMuX3cgPSBzICogdyArIHQgKiB0aGlzLl93OwogICAgICB0aGlzLl94ID0gcyAqIHggKyB0ICogdGhpcy5feDsKICAgICAgdGhpcy5feSA9IHMgKiB5ICsgdCAqIHRoaXMuX3k7CiAgICAgIHRoaXMuX3ogPSBzICogeiArIHQgKiB0aGlzLl96OwogICAgICB0aGlzLm5vcm1hbGl6ZSgpOwogICAgICB0aGlzLl9vbkNoYW5nZUNhbGxiYWNrKCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgY29uc3Qgc2luSGFsZlRoZXRhID0gTWF0aC5zcXJ0KHNxclNpbkhhbGZUaGV0YSk7CiAgICBjb25zdCBoYWxmVGhldGEgPSBNYXRoLmF0YW4yKHNpbkhhbGZUaGV0YSwgY29zSGFsZlRoZXRhKTsKICAgIGNvbnN0IHJhdGlvQSA9IE1hdGguc2luKCgxIC0gdCkgKiBoYWxmVGhldGEpIC8gc2luSGFsZlRoZXRhLCByYXRpb0IgPSBNYXRoLnNpbih0ICogaGFsZlRoZXRhKSAvIHNpbkhhbGZUaGV0YTsKICAgIHRoaXMuX3cgPSB3ICogcmF0aW9BICsgdGhpcy5fdyAqIHJhdGlvQjsKICAgIHRoaXMuX3ggPSB4ICogcmF0aW9BICsgdGhpcy5feCAqIHJhdGlvQjsKICAgIHRoaXMuX3kgPSB5ICogcmF0aW9BICsgdGhpcy5feSAqIHJhdGlvQjsKICAgIHRoaXMuX3ogPSB6ICogcmF0aW9BICsgdGhpcy5feiAqIHJhdGlvQjsKICAgIHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzbGVycFF1YXRlcm5pb25zKHFhLCBxYiwgdCkgewogICAgcmV0dXJuIHRoaXMuY29weShxYSkuc2xlcnAocWIsIHQpOwogIH0KICByYW5kb20oKSB7CiAgICBjb25zdCB1MSA9IE1hdGgucmFuZG9tKCk7CiAgICBjb25zdCBzcXJ0MXUxID0gTWF0aC5zcXJ0KDEgLSB1MSk7CiAgICBjb25zdCBzcXJ0dTEgPSBNYXRoLnNxcnQodTEpOwogICAgY29uc3QgdTIgPSAyICogTWF0aC5QSSAqIE1hdGgucmFuZG9tKCk7CiAgICBjb25zdCB1MyA9IDIgKiBNYXRoLlBJICogTWF0aC5yYW5kb20oKTsKICAgIHJldHVybiB0aGlzLnNldChzcXJ0MXUxICogTWF0aC5jb3ModTIpLCBzcXJ0dTEgKiBNYXRoLnNpbih1MyksIHNxcnR1MSAqIE1hdGguY29zKHUzKSwgc3FydDF1MSAqIE1hdGguc2luKHUyKSk7CiAgfQogIGVxdWFscyhxdWF0ZXJuaW9uKSB7CiAgICByZXR1cm4gcXVhdGVybmlvbi5feCA9PT0gdGhpcy5feCAmJiBxdWF0ZXJuaW9uLl95ID09PSB0aGlzLl95ICYmIHF1YXRlcm5pb24uX3ogPT09IHRoaXMuX3ogJiYgcXVhdGVybmlvbi5fdyA9PT0gdGhpcy5fdzsKICB9CiAgZnJvbUFycmF5KGFycmF5LCBvZmZzZXQgPSAwKSB7CiAgICB0aGlzLl94ID0gYXJyYXlbb2Zmc2V0XTsKICAgIHRoaXMuX3kgPSBhcnJheVtvZmZzZXQgKyAxXTsKICAgIHRoaXMuX3ogPSBhcnJheVtvZmZzZXQgKyAyXTsKICAgIHRoaXMuX3cgPSBhcnJheVtvZmZzZXQgKyAzXTsKICAgIHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKTsKICAgIHJldHVybiB0aGlzOwogIH0KICB0b0FycmF5KGFycmF5ID0gW10sIG9mZnNldCA9IDApIHsKICAgIGFycmF5W29mZnNldF0gPSB0aGlzLl94OwogICAgYXJyYXlbb2Zmc2V0ICsgMV0gPSB0aGlzLl95OwogICAgYXJyYXlbb2Zmc2V0ICsgMl0gPSB0aGlzLl96OwogICAgYXJyYXlbb2Zmc2V0ICsgM10gPSB0aGlzLl93OwogICAgcmV0dXJuIGFycmF5OwogIH0KICBmcm9tQnVmZmVyQXR0cmlidXRlKGF0dHJpYnV0ZSwgaW5kZXgpIHsKICAgIHRoaXMuX3ggPSBhdHRyaWJ1dGUuZ2V0WChpbmRleCk7CiAgICB0aGlzLl95ID0gYXR0cmlidXRlLmdldFkoaW5kZXgpOwogICAgdGhpcy5feiA9IGF0dHJpYnV0ZS5nZXRaKGluZGV4KTsKICAgIHRoaXMuX3cgPSBhdHRyaWJ1dGUuZ2V0VyhpbmRleCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgX29uQ2hhbmdlKGNhbGxiYWNrKSB7CiAgICB0aGlzLl9vbkNoYW5nZUNhbGxiYWNrID0gY2FsbGJhY2s7CiAgICByZXR1cm4gdGhpczsKICB9CiAgX29uQ2hhbmdlQ2FsbGJhY2soKSB7CiAgfQp9ClF1YXRlcm5pb24ucHJvdG90eXBlLmlzUXVhdGVybmlvbiA9IHRydWU7CmNsYXNzIFZlY3RvcjMgewogIGNvbnN0cnVjdG9yKHggPSAwLCB5ID0gMCwgeiA9IDApIHsKICAgIHRoaXMueCA9IHg7CiAgICB0aGlzLnkgPSB5OwogICAgdGhpcy56ID0gejsKICB9CiAgc2V0KHgsIHksIHopIHsKICAgIGlmICh6ID09PSB2b2lkIDApCiAgICAgIHogPSB0aGlzLno7CiAgICB0aGlzLnggPSB4OwogICAgdGhpcy55ID0geTsKICAgIHRoaXMueiA9IHo7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0U2NhbGFyKHNjYWxhcikgewogICAgdGhpcy54ID0gc2NhbGFyOwogICAgdGhpcy55ID0gc2NhbGFyOwogICAgdGhpcy56ID0gc2NhbGFyOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldFgoeCkgewogICAgdGhpcy54ID0geDsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRZKHkpIHsKICAgIHRoaXMueSA9IHk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0Wih6KSB7CiAgICB0aGlzLnogPSB6OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldENvbXBvbmVudChpbmRleCwgdmFsdWUpIHsKICAgIHN3aXRjaCAoaW5kZXgpIHsKICAgICAgY2FzZSAwOgogICAgICAgIHRoaXMueCA9IHZhbHVlOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIDE6CiAgICAgICAgdGhpcy55ID0gdmFsdWU7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgMjoKICAgICAgICB0aGlzLnogPSB2YWx1ZTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImluZGV4IGlzIG91dCBvZiByYW5nZTogIiArIGluZGV4KTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBnZXRDb21wb25lbnQoaW5kZXgpIHsKICAgIHN3aXRjaCAoaW5kZXgpIHsKICAgICAgY2FzZSAwOgogICAgICAgIHJldHVybiB0aGlzLng7CiAgICAgIGNhc2UgMToKICAgICAgICByZXR1cm4gdGhpcy55OwogICAgICBjYXNlIDI6CiAgICAgICAgcmV0dXJuIHRoaXMuejsKICAgICAgZGVmYXVsdDoKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImluZGV4IGlzIG91dCBvZiByYW5nZTogIiArIGluZGV4KTsKICAgIH0KICB9CiAgY2xvbmUoKSB7CiAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54LCB0aGlzLnksIHRoaXMueik7CiAgfQogIGNvcHkodikgewogICAgdGhpcy54ID0gdi54OwogICAgdGhpcy55ID0gdi55OwogICAgdGhpcy56ID0gdi56OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGFkZCh2LCB3KSB7CiAgICBpZiAodyAhPT0gdm9pZCAwKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuVmVjdG9yMzogLmFkZCgpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLmFkZFZlY3RvcnMoIGEsIGIgKSBpbnN0ZWFkLiIpOwogICAgICByZXR1cm4gdGhpcy5hZGRWZWN0b3JzKHYsIHcpOwogICAgfQogICAgdGhpcy54ICs9IHYueDsKICAgIHRoaXMueSArPSB2Lnk7CiAgICB0aGlzLnogKz0gdi56OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGFkZFNjYWxhcihzKSB7CiAgICB0aGlzLnggKz0gczsKICAgIHRoaXMueSArPSBzOwogICAgdGhpcy56ICs9IHM7CiAgICByZXR1cm4gdGhpczsKICB9CiAgYWRkVmVjdG9ycyhhLCBiKSB7CiAgICB0aGlzLnggPSBhLnggKyBiLng7CiAgICB0aGlzLnkgPSBhLnkgKyBiLnk7CiAgICB0aGlzLnogPSBhLnogKyBiLno7CiAgICByZXR1cm4gdGhpczsKICB9CiAgYWRkU2NhbGVkVmVjdG9yKHYsIHMpIHsKICAgIHRoaXMueCArPSB2LnggKiBzOwogICAgdGhpcy55ICs9IHYueSAqIHM7CiAgICB0aGlzLnogKz0gdi56ICogczsKICAgIHJldHVybiB0aGlzOwogIH0KICBzdWIodiwgdykgewogICAgaWYgKHcgIT09IHZvaWQgMCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLlZlY3RvcjM6IC5zdWIoKSBub3cgb25seSBhY2NlcHRzIG9uZSBhcmd1bWVudC4gVXNlIC5zdWJWZWN0b3JzKCBhLCBiICkgaW5zdGVhZC4iKTsKICAgICAgcmV0dXJuIHRoaXMuc3ViVmVjdG9ycyh2LCB3KTsKICAgIH0KICAgIHRoaXMueCAtPSB2Lng7CiAgICB0aGlzLnkgLT0gdi55OwogICAgdGhpcy56IC09IHYuejsKICAgIHJldHVybiB0aGlzOwogIH0KICBzdWJTY2FsYXIocykgewogICAgdGhpcy54IC09IHM7CiAgICB0aGlzLnkgLT0gczsKICAgIHRoaXMueiAtPSBzOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHN1YlZlY3RvcnMoYSwgYikgewogICAgdGhpcy54ID0gYS54IC0gYi54OwogICAgdGhpcy55ID0gYS55IC0gYi55OwogICAgdGhpcy56ID0gYS56IC0gYi56OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG11bHRpcGx5KHYsIHcpIHsKICAgIGlmICh3ICE9PSB2b2lkIDApIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5WZWN0b3IzOiAubXVsdGlwbHkoKSBub3cgb25seSBhY2NlcHRzIG9uZSBhcmd1bWVudC4gVXNlIC5tdWx0aXBseVZlY3RvcnMoIGEsIGIgKSBpbnN0ZWFkLiIpOwogICAgICByZXR1cm4gdGhpcy5tdWx0aXBseVZlY3RvcnModiwgdyk7CiAgICB9CiAgICB0aGlzLnggKj0gdi54OwogICAgdGhpcy55ICo9IHYueTsKICAgIHRoaXMueiAqPSB2Lno7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbXVsdGlwbHlTY2FsYXIoc2NhbGFyKSB7CiAgICB0aGlzLnggKj0gc2NhbGFyOwogICAgdGhpcy55ICo9IHNjYWxhcjsKICAgIHRoaXMueiAqPSBzY2FsYXI7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbXVsdGlwbHlWZWN0b3JzKGEsIGIpIHsKICAgIHRoaXMueCA9IGEueCAqIGIueDsKICAgIHRoaXMueSA9IGEueSAqIGIueTsKICAgIHRoaXMueiA9IGEueiAqIGIuejsKICAgIHJldHVybiB0aGlzOwogIH0KICBhcHBseUV1bGVyKGV1bGVyKSB7CiAgICBpZiAoIShldWxlciAmJiBldWxlci5pc0V1bGVyKSkgewogICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5WZWN0b3IzOiAuYXBwbHlFdWxlcigpIG5vdyBleHBlY3RzIGFuIEV1bGVyIHJvdGF0aW9uIHJhdGhlciB0aGFuIGEgVmVjdG9yMyBhbmQgb3JkZXIuIik7CiAgICB9CiAgICByZXR1cm4gdGhpcy5hcHBseVF1YXRlcm5pb24oX3F1YXRlcm5pb24kNC5zZXRGcm9tRXVsZXIoZXVsZXIpKTsKICB9CiAgYXBwbHlBeGlzQW5nbGUoYXhpcywgYW5nbGUpIHsKICAgIHJldHVybiB0aGlzLmFwcGx5UXVhdGVybmlvbihfcXVhdGVybmlvbiQ0LnNldEZyb21BeGlzQW5nbGUoYXhpcywgYW5nbGUpKTsKICB9CiAgYXBwbHlNYXRyaXgzKG0pIHsKICAgIGNvbnN0IHggPSB0aGlzLngsIHkgPSB0aGlzLnksIHogPSB0aGlzLno7CiAgICBjb25zdCBlID0gbS5lbGVtZW50czsKICAgIHRoaXMueCA9IGVbMF0gKiB4ICsgZVszXSAqIHkgKyBlWzZdICogejsKICAgIHRoaXMueSA9IGVbMV0gKiB4ICsgZVs0XSAqIHkgKyBlWzddICogejsKICAgIHRoaXMueiA9IGVbMl0gKiB4ICsgZVs1XSAqIHkgKyBlWzhdICogejsKICAgIHJldHVybiB0aGlzOwogIH0KICBhcHBseU5vcm1hbE1hdHJpeChtKSB7CiAgICByZXR1cm4gdGhpcy5hcHBseU1hdHJpeDMobSkubm9ybWFsaXplKCk7CiAgfQogIGFwcGx5TWF0cml4NChtKSB7CiAgICBjb25zdCB4ID0gdGhpcy54LCB5ID0gdGhpcy55LCB6ID0gdGhpcy56OwogICAgY29uc3QgZSA9IG0uZWxlbWVudHM7CiAgICBjb25zdCB3ID0gMSAvIChlWzNdICogeCArIGVbN10gKiB5ICsgZVsxMV0gKiB6ICsgZVsxNV0pOwogICAgdGhpcy54ID0gKGVbMF0gKiB4ICsgZVs0XSAqIHkgKyBlWzhdICogeiArIGVbMTJdKSAqIHc7CiAgICB0aGlzLnkgPSAoZVsxXSAqIHggKyBlWzVdICogeSArIGVbOV0gKiB6ICsgZVsxM10pICogdzsKICAgIHRoaXMueiA9IChlWzJdICogeCArIGVbNl0gKiB5ICsgZVsxMF0gKiB6ICsgZVsxNF0pICogdzsKICAgIHJldHVybiB0aGlzOwogIH0KICBhcHBseVF1YXRlcm5pb24ocSkgewogICAgY29uc3QgeCA9IHRoaXMueCwgeSA9IHRoaXMueSwgeiA9IHRoaXMuejsKICAgIGNvbnN0IHF4ID0gcS54LCBxeSA9IHEueSwgcXogPSBxLnosIHF3ID0gcS53OwogICAgY29uc3QgaXggPSBxdyAqIHggKyBxeSAqIHogLSBxeiAqIHk7CiAgICBjb25zdCBpeSA9IHF3ICogeSArIHF6ICogeCAtIHF4ICogejsKICAgIGNvbnN0IGl6ID0gcXcgKiB6ICsgcXggKiB5IC0gcXkgKiB4OwogICAgY29uc3QgaXcgPSAtcXggKiB4IC0gcXkgKiB5IC0gcXogKiB6OwogICAgdGhpcy54ID0gaXggKiBxdyArIGl3ICogLXF4ICsgaXkgKiAtcXogLSBpeiAqIC1xeTsKICAgIHRoaXMueSA9IGl5ICogcXcgKyBpdyAqIC1xeSArIGl6ICogLXF4IC0gaXggKiAtcXo7CiAgICB0aGlzLnogPSBpeiAqIHF3ICsgaXcgKiAtcXogKyBpeCAqIC1xeSAtIGl5ICogLXF4OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHByb2plY3QoY2FtZXJhKSB7CiAgICByZXR1cm4gdGhpcy5hcHBseU1hdHJpeDQoY2FtZXJhLm1hdHJpeFdvcmxkSW52ZXJzZSkuYXBwbHlNYXRyaXg0KGNhbWVyYS5wcm9qZWN0aW9uTWF0cml4KTsKICB9CiAgdW5wcm9qZWN0KGNhbWVyYSkgewogICAgcmV0dXJuIHRoaXMuYXBwbHlNYXRyaXg0KGNhbWVyYS5wcm9qZWN0aW9uTWF0cml4SW52ZXJzZSkuYXBwbHlNYXRyaXg0KGNhbWVyYS5tYXRyaXhXb3JsZCk7CiAgfQogIHRyYW5zZm9ybURpcmVjdGlvbihtKSB7CiAgICBjb25zdCB4ID0gdGhpcy54LCB5ID0gdGhpcy55LCB6ID0gdGhpcy56OwogICAgY29uc3QgZSA9IG0uZWxlbWVudHM7CiAgICB0aGlzLnggPSBlWzBdICogeCArIGVbNF0gKiB5ICsgZVs4XSAqIHo7CiAgICB0aGlzLnkgPSBlWzFdICogeCArIGVbNV0gKiB5ICsgZVs5XSAqIHo7CiAgICB0aGlzLnogPSBlWzJdICogeCArIGVbNl0gKiB5ICsgZVsxMF0gKiB6OwogICAgcmV0dXJuIHRoaXMubm9ybWFsaXplKCk7CiAgfQogIGRpdmlkZSh2KSB7CiAgICB0aGlzLnggLz0gdi54OwogICAgdGhpcy55IC89IHYueTsKICAgIHRoaXMueiAvPSB2Lno7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZGl2aWRlU2NhbGFyKHNjYWxhcikgewogICAgcmV0dXJuIHRoaXMubXVsdGlwbHlTY2FsYXIoMSAvIHNjYWxhcik7CiAgfQogIG1pbih2KSB7CiAgICB0aGlzLnggPSBNYXRoLm1pbih0aGlzLngsIHYueCk7CiAgICB0aGlzLnkgPSBNYXRoLm1pbih0aGlzLnksIHYueSk7CiAgICB0aGlzLnogPSBNYXRoLm1pbih0aGlzLnosIHYueik7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbWF4KHYpIHsKICAgIHRoaXMueCA9IE1hdGgubWF4KHRoaXMueCwgdi54KTsKICAgIHRoaXMueSA9IE1hdGgubWF4KHRoaXMueSwgdi55KTsKICAgIHRoaXMueiA9IE1hdGgubWF4KHRoaXMueiwgdi56KTsKICAgIHJldHVybiB0aGlzOwogIH0KICBjbGFtcChtaW4sIG1heCkgewogICAgdGhpcy54ID0gTWF0aC5tYXgobWluLngsIE1hdGgubWluKG1heC54LCB0aGlzLngpKTsKICAgIHRoaXMueSA9IE1hdGgubWF4KG1pbi55LCBNYXRoLm1pbihtYXgueSwgdGhpcy55KSk7CiAgICB0aGlzLnogPSBNYXRoLm1heChtaW4ueiwgTWF0aC5taW4obWF4LnosIHRoaXMueikpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNsYW1wU2NhbGFyKG1pblZhbCwgbWF4VmFsKSB7CiAgICB0aGlzLnggPSBNYXRoLm1heChtaW5WYWwsIE1hdGgubWluKG1heFZhbCwgdGhpcy54KSk7CiAgICB0aGlzLnkgPSBNYXRoLm1heChtaW5WYWwsIE1hdGgubWluKG1heFZhbCwgdGhpcy55KSk7CiAgICB0aGlzLnogPSBNYXRoLm1heChtaW5WYWwsIE1hdGgubWluKG1heFZhbCwgdGhpcy56KSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xhbXBMZW5ndGgobWluLCBtYXgpIHsKICAgIGNvbnN0IGxlbmd0aCA9IHRoaXMubGVuZ3RoKCk7CiAgICByZXR1cm4gdGhpcy5kaXZpZGVTY2FsYXIobGVuZ3RoIHx8IDEpLm11bHRpcGx5U2NhbGFyKE1hdGgubWF4KG1pbiwgTWF0aC5taW4obWF4LCBsZW5ndGgpKSk7CiAgfQogIGZsb29yKCkgewogICAgdGhpcy54ID0gTWF0aC5mbG9vcih0aGlzLngpOwogICAgdGhpcy55ID0gTWF0aC5mbG9vcih0aGlzLnkpOwogICAgdGhpcy56ID0gTWF0aC5mbG9vcih0aGlzLnopOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNlaWwoKSB7CiAgICB0aGlzLnggPSBNYXRoLmNlaWwodGhpcy54KTsKICAgIHRoaXMueSA9IE1hdGguY2VpbCh0aGlzLnkpOwogICAgdGhpcy56ID0gTWF0aC5jZWlsKHRoaXMueik7CiAgICByZXR1cm4gdGhpczsKICB9CiAgcm91bmQoKSB7CiAgICB0aGlzLnggPSBNYXRoLnJvdW5kKHRoaXMueCk7CiAgICB0aGlzLnkgPSBNYXRoLnJvdW5kKHRoaXMueSk7CiAgICB0aGlzLnogPSBNYXRoLnJvdW5kKHRoaXMueik7CiAgICByZXR1cm4gdGhpczsKICB9CiAgcm91bmRUb1plcm8oKSB7CiAgICB0aGlzLnggPSB0aGlzLnggPCAwID8gTWF0aC5jZWlsKHRoaXMueCkgOiBNYXRoLmZsb29yKHRoaXMueCk7CiAgICB0aGlzLnkgPSB0aGlzLnkgPCAwID8gTWF0aC5jZWlsKHRoaXMueSkgOiBNYXRoLmZsb29yKHRoaXMueSk7CiAgICB0aGlzLnogPSB0aGlzLnogPCAwID8gTWF0aC5jZWlsKHRoaXMueikgOiBNYXRoLmZsb29yKHRoaXMueik7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbmVnYXRlKCkgewogICAgdGhpcy54ID0gLXRoaXMueDsKICAgIHRoaXMueSA9IC10aGlzLnk7CiAgICB0aGlzLnogPSAtdGhpcy56OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGRvdCh2KSB7CiAgICByZXR1cm4gdGhpcy54ICogdi54ICsgdGhpcy55ICogdi55ICsgdGhpcy56ICogdi56OwogIH0KICBsZW5ndGhTcSgpIHsKICAgIHJldHVybiB0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkgKyB0aGlzLnogKiB0aGlzLno7CiAgfQogIGxlbmd0aCgpIHsKICAgIHJldHVybiBNYXRoLnNxcnQodGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55ICsgdGhpcy56ICogdGhpcy56KTsKICB9CiAgbWFuaGF0dGFuTGVuZ3RoKCkgewogICAgcmV0dXJuIE1hdGguYWJzKHRoaXMueCkgKyBNYXRoLmFicyh0aGlzLnkpICsgTWF0aC5hYnModGhpcy56KTsKICB9CiAgbm9ybWFsaXplKCkgewogICAgcmV0dXJuIHRoaXMuZGl2aWRlU2NhbGFyKHRoaXMubGVuZ3RoKCkgfHwgMSk7CiAgfQogIHNldExlbmd0aChsZW5ndGgpIHsKICAgIHJldHVybiB0aGlzLm5vcm1hbGl6ZSgpLm11bHRpcGx5U2NhbGFyKGxlbmd0aCk7CiAgfQogIGxlcnAodiwgYWxwaGEpIHsKICAgIHRoaXMueCArPSAodi54IC0gdGhpcy54KSAqIGFscGhhOwogICAgdGhpcy55ICs9ICh2LnkgLSB0aGlzLnkpICogYWxwaGE7CiAgICB0aGlzLnogKz0gKHYueiAtIHRoaXMueikgKiBhbHBoYTsKICAgIHJldHVybiB0aGlzOwogIH0KICBsZXJwVmVjdG9ycyh2MSwgdjIsIGFscGhhKSB7CiAgICB0aGlzLnggPSB2MS54ICsgKHYyLnggLSB2MS54KSAqIGFscGhhOwogICAgdGhpcy55ID0gdjEueSArICh2Mi55IC0gdjEueSkgKiBhbHBoYTsKICAgIHRoaXMueiA9IHYxLnogKyAodjIueiAtIHYxLnopICogYWxwaGE7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY3Jvc3ModiwgdykgewogICAgaWYgKHcgIT09IHZvaWQgMCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLlZlY3RvcjM6IC5jcm9zcygpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLmNyb3NzVmVjdG9ycyggYSwgYiApIGluc3RlYWQuIik7CiAgICAgIHJldHVybiB0aGlzLmNyb3NzVmVjdG9ycyh2LCB3KTsKICAgIH0KICAgIHJldHVybiB0aGlzLmNyb3NzVmVjdG9ycyh0aGlzLCB2KTsKICB9CiAgY3Jvc3NWZWN0b3JzKGEsIGIpIHsKICAgIGNvbnN0IGF4ID0gYS54LCBheSA9IGEueSwgYXogPSBhLno7CiAgICBjb25zdCBieCA9IGIueCwgYnkgPSBiLnksIGJ6ID0gYi56OwogICAgdGhpcy54ID0gYXkgKiBieiAtIGF6ICogYnk7CiAgICB0aGlzLnkgPSBheiAqIGJ4IC0gYXggKiBiejsKICAgIHRoaXMueiA9IGF4ICogYnkgLSBheSAqIGJ4OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHByb2plY3RPblZlY3Rvcih2KSB7CiAgICBjb25zdCBkZW5vbWluYXRvciA9IHYubGVuZ3RoU3EoKTsKICAgIGlmIChkZW5vbWluYXRvciA9PT0gMCkKICAgICAgcmV0dXJuIHRoaXMuc2V0KDAsIDAsIDApOwogICAgY29uc3Qgc2NhbGFyID0gdi5kb3QodGhpcykgLyBkZW5vbWluYXRvcjsKICAgIHJldHVybiB0aGlzLmNvcHkodikubXVsdGlwbHlTY2FsYXIoc2NhbGFyKTsKICB9CiAgcHJvamVjdE9uUGxhbmUocGxhbmVOb3JtYWwpIHsKICAgIF92ZWN0b3IkYy5jb3B5KHRoaXMpLnByb2plY3RPblZlY3RvcihwbGFuZU5vcm1hbCk7CiAgICByZXR1cm4gdGhpcy5zdWIoX3ZlY3RvciRjKTsKICB9CiAgcmVmbGVjdChub3JtYWwpIHsKICAgIHJldHVybiB0aGlzLnN1YihfdmVjdG9yJGMuY29weShub3JtYWwpLm11bHRpcGx5U2NhbGFyKDIgKiB0aGlzLmRvdChub3JtYWwpKSk7CiAgfQogIGFuZ2xlVG8odikgewogICAgY29uc3QgZGVub21pbmF0b3IgPSBNYXRoLnNxcnQodGhpcy5sZW5ndGhTcSgpICogdi5sZW5ndGhTcSgpKTsKICAgIGlmIChkZW5vbWluYXRvciA9PT0gMCkKICAgICAgcmV0dXJuIE1hdGguUEkgLyAyOwogICAgY29uc3QgdGhldGEgPSB0aGlzLmRvdCh2KSAvIGRlbm9taW5hdG9yOwogICAgcmV0dXJuIE1hdGguYWNvcyhjbGFtcCh0aGV0YSwgLTEsIDEpKTsKICB9CiAgZGlzdGFuY2VUbyh2KSB7CiAgICByZXR1cm4gTWF0aC5zcXJ0KHRoaXMuZGlzdGFuY2VUb1NxdWFyZWQodikpOwogIH0KICBkaXN0YW5jZVRvU3F1YXJlZCh2KSB7CiAgICBjb25zdCBkeCA9IHRoaXMueCAtIHYueCwgZHkgPSB0aGlzLnkgLSB2LnksIGR6ID0gdGhpcy56IC0gdi56OwogICAgcmV0dXJuIGR4ICogZHggKyBkeSAqIGR5ICsgZHogKiBkejsKICB9CiAgbWFuaGF0dGFuRGlzdGFuY2VUbyh2KSB7CiAgICByZXR1cm4gTWF0aC5hYnModGhpcy54IC0gdi54KSArIE1hdGguYWJzKHRoaXMueSAtIHYueSkgKyBNYXRoLmFicyh0aGlzLnogLSB2LnopOwogIH0KICBzZXRGcm9tU3BoZXJpY2FsKHMpIHsKICAgIHJldHVybiB0aGlzLnNldEZyb21TcGhlcmljYWxDb29yZHMocy5yYWRpdXMsIHMucGhpLCBzLnRoZXRhKTsKICB9CiAgc2V0RnJvbVNwaGVyaWNhbENvb3JkcyhyYWRpdXMsIHBoaSwgdGhldGEpIHsKICAgIGNvbnN0IHNpblBoaVJhZGl1cyA9IE1hdGguc2luKHBoaSkgKiByYWRpdXM7CiAgICB0aGlzLnggPSBzaW5QaGlSYWRpdXMgKiBNYXRoLnNpbih0aGV0YSk7CiAgICB0aGlzLnkgPSBNYXRoLmNvcyhwaGkpICogcmFkaXVzOwogICAgdGhpcy56ID0gc2luUGhpUmFkaXVzICogTWF0aC5jb3ModGhldGEpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldEZyb21DeWxpbmRyaWNhbChjKSB7CiAgICByZXR1cm4gdGhpcy5zZXRGcm9tQ3lsaW5kcmljYWxDb29yZHMoYy5yYWRpdXMsIGMudGhldGEsIGMueSk7CiAgfQogIHNldEZyb21DeWxpbmRyaWNhbENvb3JkcyhyYWRpdXMsIHRoZXRhLCB5KSB7CiAgICB0aGlzLnggPSByYWRpdXMgKiBNYXRoLnNpbih0aGV0YSk7CiAgICB0aGlzLnkgPSB5OwogICAgdGhpcy56ID0gcmFkaXVzICogTWF0aC5jb3ModGhldGEpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldEZyb21NYXRyaXhQb3NpdGlvbihtKSB7CiAgICBjb25zdCBlID0gbS5lbGVtZW50czsKICAgIHRoaXMueCA9IGVbMTJdOwogICAgdGhpcy55ID0gZVsxM107CiAgICB0aGlzLnogPSBlWzE0XTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRGcm9tTWF0cml4U2NhbGUobSkgewogICAgY29uc3Qgc3ggPSB0aGlzLnNldEZyb21NYXRyaXhDb2x1bW4obSwgMCkubGVuZ3RoKCk7CiAgICBjb25zdCBzeSA9IHRoaXMuc2V0RnJvbU1hdHJpeENvbHVtbihtLCAxKS5sZW5ndGgoKTsKICAgIGNvbnN0IHN6ID0gdGhpcy5zZXRGcm9tTWF0cml4Q29sdW1uKG0sIDIpLmxlbmd0aCgpOwogICAgdGhpcy54ID0gc3g7CiAgICB0aGlzLnkgPSBzeTsKICAgIHRoaXMueiA9IHN6OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldEZyb21NYXRyaXhDb2x1bW4obSwgaW5kZXgpIHsKICAgIHJldHVybiB0aGlzLmZyb21BcnJheShtLmVsZW1lbnRzLCBpbmRleCAqIDQpOwogIH0KICBzZXRGcm9tTWF0cml4M0NvbHVtbihtLCBpbmRleCkgewogICAgcmV0dXJuIHRoaXMuZnJvbUFycmF5KG0uZWxlbWVudHMsIGluZGV4ICogMyk7CiAgfQogIGVxdWFscyh2KSB7CiAgICByZXR1cm4gdi54ID09PSB0aGlzLnggJiYgdi55ID09PSB0aGlzLnkgJiYgdi56ID09PSB0aGlzLno7CiAgfQogIGZyb21BcnJheShhcnJheSwgb2Zmc2V0ID0gMCkgewogICAgdGhpcy54ID0gYXJyYXlbb2Zmc2V0XTsKICAgIHRoaXMueSA9IGFycmF5W29mZnNldCArIDFdOwogICAgdGhpcy56ID0gYXJyYXlbb2Zmc2V0ICsgMl07CiAgICByZXR1cm4gdGhpczsKICB9CiAgdG9BcnJheShhcnJheSA9IFtdLCBvZmZzZXQgPSAwKSB7CiAgICBhcnJheVtvZmZzZXRdID0gdGhpcy54OwogICAgYXJyYXlbb2Zmc2V0ICsgMV0gPSB0aGlzLnk7CiAgICBhcnJheVtvZmZzZXQgKyAyXSA9IHRoaXMuejsKICAgIHJldHVybiBhcnJheTsKICB9CiAgZnJvbUJ1ZmZlckF0dHJpYnV0ZShhdHRyaWJ1dGUsIGluZGV4LCBvZmZzZXQpIHsKICAgIGlmIChvZmZzZXQgIT09IHZvaWQgMCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLlZlY3RvcjM6IG9mZnNldCBoYXMgYmVlbiByZW1vdmVkIGZyb20gLmZyb21CdWZmZXJBdHRyaWJ1dGUoKS4iKTsKICAgIH0KICAgIHRoaXMueCA9IGF0dHJpYnV0ZS5nZXRYKGluZGV4KTsKICAgIHRoaXMueSA9IGF0dHJpYnV0ZS5nZXRZKGluZGV4KTsKICAgIHRoaXMueiA9IGF0dHJpYnV0ZS5nZXRaKGluZGV4KTsKICAgIHJldHVybiB0aGlzOwogIH0KICByYW5kb20oKSB7CiAgICB0aGlzLnggPSBNYXRoLnJhbmRvbSgpOwogICAgdGhpcy55ID0gTWF0aC5yYW5kb20oKTsKICAgIHRoaXMueiA9IE1hdGgucmFuZG9tKCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgcmFuZG9tRGlyZWN0aW9uKCkgewogICAgY29uc3QgdSA9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDI7CiAgICBjb25zdCB0ID0gTWF0aC5yYW5kb20oKSAqIE1hdGguUEkgKiAyOwogICAgY29uc3QgZiA9IE1hdGguc3FydCgxIC0gX19wb3codSwgMikpOwogICAgdGhpcy54ID0gZiAqIE1hdGguY29zKHQpOwogICAgdGhpcy55ID0gZiAqIE1hdGguc2luKHQpOwogICAgdGhpcy56ID0gdTsKICAgIHJldHVybiB0aGlzOwogIH0KICAqW1N5bWJvbC5pdGVyYXRvcl0oKSB7CiAgICB5aWVsZCB0aGlzLng7CiAgICB5aWVsZCB0aGlzLnk7CiAgICB5aWVsZCB0aGlzLno7CiAgfQp9ClZlY3RvcjMucHJvdG90eXBlLmlzVmVjdG9yMyA9IHRydWU7CmNvbnN0IF92ZWN0b3IkYyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfcXVhdGVybmlvbiQ0ID0gLyogQF9fUFVSRV9fICovIG5ldyBRdWF0ZXJuaW9uKCk7CmNsYXNzIEJveDMgewogIGNvbnN0cnVjdG9yKG1pbiA9IG5ldyBWZWN0b3IzKEluZmluaXR5LCBJbmZpbml0eSwgSW5maW5pdHkpLCBtYXggPSBuZXcgVmVjdG9yMygtSW5maW5pdHksIC1JbmZpbml0eSwgLUluZmluaXR5KSkgewogICAgdGhpcy5taW4gPSBtaW47CiAgICB0aGlzLm1heCA9IG1heDsKICB9CiAgc2V0KG1pbiwgbWF4KSB7CiAgICB0aGlzLm1pbi5jb3B5KG1pbik7CiAgICB0aGlzLm1heC5jb3B5KG1heCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0RnJvbUFycmF5KGFycmF5KSB7CiAgICBsZXQgbWluWCA9IEluZmluaXR5OwogICAgbGV0IG1pblkgPSBJbmZpbml0eTsKICAgIGxldCBtaW5aID0gSW5maW5pdHk7CiAgICBsZXQgbWF4WCA9IC1JbmZpbml0eTsKICAgIGxldCBtYXhZID0gLUluZmluaXR5OwogICAgbGV0IG1heFogPSAtSW5maW5pdHk7CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IGFycmF5Lmxlbmd0aDsgaSA8IGw7IGkgKz0gMykgewogICAgICBjb25zdCB4ID0gYXJyYXlbaV07CiAgICAgIGNvbnN0IHkgPSBhcnJheVtpICsgMV07CiAgICAgIGNvbnN0IHogPSBhcnJheVtpICsgMl07CiAgICAgIGlmICh4IDwgbWluWCkKICAgICAgICBtaW5YID0geDsKICAgICAgaWYgKHkgPCBtaW5ZKQogICAgICAgIG1pblkgPSB5OwogICAgICBpZiAoeiA8IG1pblopCiAgICAgICAgbWluWiA9IHo7CiAgICAgIGlmICh4ID4gbWF4WCkKICAgICAgICBtYXhYID0geDsKICAgICAgaWYgKHkgPiBtYXhZKQogICAgICAgIG1heFkgPSB5OwogICAgICBpZiAoeiA+IG1heFopCiAgICAgICAgbWF4WiA9IHo7CiAgICB9CiAgICB0aGlzLm1pbi5zZXQobWluWCwgbWluWSwgbWluWik7CiAgICB0aGlzLm1heC5zZXQobWF4WCwgbWF4WSwgbWF4Wik7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0RnJvbUJ1ZmZlckF0dHJpYnV0ZShhdHRyaWJ1dGUpIHsKICAgIGxldCBtaW5YID0gSW5maW5pdHk7CiAgICBsZXQgbWluWSA9IEluZmluaXR5OwogICAgbGV0IG1pblogPSBJbmZpbml0eTsKICAgIGxldCBtYXhYID0gLUluZmluaXR5OwogICAgbGV0IG1heFkgPSAtSW5maW5pdHk7CiAgICBsZXQgbWF4WiA9IC1JbmZpbml0eTsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gYXR0cmlidXRlLmNvdW50OyBpIDwgbDsgaSsrKSB7CiAgICAgIGNvbnN0IHggPSBhdHRyaWJ1dGUuZ2V0WChpKTsKICAgICAgY29uc3QgeSA9IGF0dHJpYnV0ZS5nZXRZKGkpOwogICAgICBjb25zdCB6ID0gYXR0cmlidXRlLmdldFooaSk7CiAgICAgIGlmICh4IDwgbWluWCkKICAgICAgICBtaW5YID0geDsKICAgICAgaWYgKHkgPCBtaW5ZKQogICAgICAgIG1pblkgPSB5OwogICAgICBpZiAoeiA8IG1pblopCiAgICAgICAgbWluWiA9IHo7CiAgICAgIGlmICh4ID4gbWF4WCkKICAgICAgICBtYXhYID0geDsKICAgICAgaWYgKHkgPiBtYXhZKQogICAgICAgIG1heFkgPSB5OwogICAgICBpZiAoeiA+IG1heFopCiAgICAgICAgbWF4WiA9IHo7CiAgICB9CiAgICB0aGlzLm1pbi5zZXQobWluWCwgbWluWSwgbWluWik7CiAgICB0aGlzLm1heC5zZXQobWF4WCwgbWF4WSwgbWF4Wik7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0RnJvbVBvaW50cyhwb2ludHMpIHsKICAgIHRoaXMubWFrZUVtcHR5KCk7CiAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBwb2ludHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICB0aGlzLmV4cGFuZEJ5UG9pbnQocG9pbnRzW2ldKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRGcm9tQ2VudGVyQW5kU2l6ZShjZW50ZXIsIHNpemUpIHsKICAgIGNvbnN0IGhhbGZTaXplID0gX3ZlY3RvciRiLmNvcHkoc2l6ZSkubXVsdGlwbHlTY2FsYXIoMC41KTsKICAgIHRoaXMubWluLmNvcHkoY2VudGVyKS5zdWIoaGFsZlNpemUpOwogICAgdGhpcy5tYXguY29weShjZW50ZXIpLmFkZChoYWxmU2l6ZSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0RnJvbU9iamVjdChvYmplY3QsIHByZWNpc2UgPSBmYWxzZSkgewogICAgdGhpcy5tYWtlRW1wdHkoKTsKICAgIHJldHVybiB0aGlzLmV4cGFuZEJ5T2JqZWN0KG9iamVjdCwgcHJlY2lzZSk7CiAgfQogIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKCkuY29weSh0aGlzKTsKICB9CiAgY29weShib3gpIHsKICAgIHRoaXMubWluLmNvcHkoYm94Lm1pbik7CiAgICB0aGlzLm1heC5jb3B5KGJveC5tYXgpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG1ha2VFbXB0eSgpIHsKICAgIHRoaXMubWluLnggPSB0aGlzLm1pbi55ID0gdGhpcy5taW4ueiA9IEluZmluaXR5OwogICAgdGhpcy5tYXgueCA9IHRoaXMubWF4LnkgPSB0aGlzLm1heC56ID0gLUluZmluaXR5OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGlzRW1wdHkoKSB7CiAgICByZXR1cm4gdGhpcy5tYXgueCA8IHRoaXMubWluLnggfHwgdGhpcy5tYXgueSA8IHRoaXMubWluLnkgfHwgdGhpcy5tYXgueiA8IHRoaXMubWluLno7CiAgfQogIGdldENlbnRlcih0YXJnZXQpIHsKICAgIHJldHVybiB0aGlzLmlzRW1wdHkoKSA/IHRhcmdldC5zZXQoMCwgMCwgMCkgOiB0YXJnZXQuYWRkVmVjdG9ycyh0aGlzLm1pbiwgdGhpcy5tYXgpLm11bHRpcGx5U2NhbGFyKDAuNSk7CiAgfQogIGdldFNpemUodGFyZ2V0KSB7CiAgICByZXR1cm4gdGhpcy5pc0VtcHR5KCkgPyB0YXJnZXQuc2V0KDAsIDAsIDApIDogdGFyZ2V0LnN1YlZlY3RvcnModGhpcy5tYXgsIHRoaXMubWluKTsKICB9CiAgZXhwYW5kQnlQb2ludChwb2ludCkgewogICAgdGhpcy5taW4ubWluKHBvaW50KTsKICAgIHRoaXMubWF4Lm1heChwb2ludCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZXhwYW5kQnlWZWN0b3IodmVjdG9yKSB7CiAgICB0aGlzLm1pbi5zdWIodmVjdG9yKTsKICAgIHRoaXMubWF4LmFkZCh2ZWN0b3IpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGV4cGFuZEJ5U2NhbGFyKHNjYWxhcikgewogICAgdGhpcy5taW4uYWRkU2NhbGFyKC1zY2FsYXIpOwogICAgdGhpcy5tYXguYWRkU2NhbGFyKHNjYWxhcik7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZXhwYW5kQnlPYmplY3Qob2JqZWN0LCBwcmVjaXNlID0gZmFsc2UpIHsKICAgIG9iamVjdC51cGRhdGVXb3JsZE1hdHJpeChmYWxzZSwgZmFsc2UpOwogICAgY29uc3QgZ2VvbWV0cnkgPSBvYmplY3QuZ2VvbWV0cnk7CiAgICBpZiAoZ2VvbWV0cnkgIT09IHZvaWQgMCkgewogICAgICBpZiAocHJlY2lzZSAmJiBnZW9tZXRyeS5hdHRyaWJ1dGVzICE9IHZvaWQgMCAmJiBnZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uICE9PSB2b2lkIDApIHsKICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb247CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBwb3NpdGlvbi5jb3VudDsgaSA8IGw7IGkrKykgewogICAgICAgICAgX3ZlY3RvciRiLmZyb21CdWZmZXJBdHRyaWJ1dGUocG9zaXRpb24sIGkpLmFwcGx5TWF0cml4NChvYmplY3QubWF0cml4V29ybGQpOwogICAgICAgICAgdGhpcy5leHBhbmRCeVBvaW50KF92ZWN0b3IkYik7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChnZW9tZXRyeS5ib3VuZGluZ0JveCA9PT0gbnVsbCkgewogICAgICAgICAgZ2VvbWV0cnkuY29tcHV0ZUJvdW5kaW5nQm94KCk7CiAgICAgICAgfQogICAgICAgIF9ib3gkMy5jb3B5KGdlb21ldHJ5LmJvdW5kaW5nQm94KTsKICAgICAgICBfYm94JDMuYXBwbHlNYXRyaXg0KG9iamVjdC5tYXRyaXhXb3JsZCk7CiAgICAgICAgdGhpcy51bmlvbihfYm94JDMpOwogICAgICB9CiAgICB9CiAgICBjb25zdCBjaGlsZHJlbiA9IG9iamVjdC5jaGlsZHJlbjsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIHRoaXMuZXhwYW5kQnlPYmplY3QoY2hpbGRyZW5baV0sIHByZWNpc2UpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNvbnRhaW5zUG9pbnQocG9pbnQpIHsKICAgIHJldHVybiBwb2ludC54IDwgdGhpcy5taW4ueCB8fCBwb2ludC54ID4gdGhpcy5tYXgueCB8fCBwb2ludC55IDwgdGhpcy5taW4ueSB8fCBwb2ludC55ID4gdGhpcy5tYXgueSB8fCBwb2ludC56IDwgdGhpcy5taW4ueiB8fCBwb2ludC56ID4gdGhpcy5tYXgueiA/IGZhbHNlIDogdHJ1ZTsKICB9CiAgY29udGFpbnNCb3goYm94KSB7CiAgICByZXR1cm4gdGhpcy5taW4ueCA8PSBib3gubWluLnggJiYgYm94Lm1heC54IDw9IHRoaXMubWF4LnggJiYgdGhpcy5taW4ueSA8PSBib3gubWluLnkgJiYgYm94Lm1heC55IDw9IHRoaXMubWF4LnkgJiYgdGhpcy5taW4ueiA8PSBib3gubWluLnogJiYgYm94Lm1heC56IDw9IHRoaXMubWF4Lno7CiAgfQogIGdldFBhcmFtZXRlcihwb2ludCwgdGFyZ2V0KSB7CiAgICByZXR1cm4gdGFyZ2V0LnNldCgocG9pbnQueCAtIHRoaXMubWluLngpIC8gKHRoaXMubWF4LnggLSB0aGlzLm1pbi54KSwgKHBvaW50LnkgLSB0aGlzLm1pbi55KSAvICh0aGlzLm1heC55IC0gdGhpcy5taW4ueSksIChwb2ludC56IC0gdGhpcy5taW4ueikgLyAodGhpcy5tYXgueiAtIHRoaXMubWluLnopKTsKICB9CiAgaW50ZXJzZWN0c0JveChib3gpIHsKICAgIHJldHVybiBib3gubWF4LnggPCB0aGlzLm1pbi54IHx8IGJveC5taW4ueCA+IHRoaXMubWF4LnggfHwgYm94Lm1heC55IDwgdGhpcy5taW4ueSB8fCBib3gubWluLnkgPiB0aGlzLm1heC55IHx8IGJveC5tYXgueiA8IHRoaXMubWluLnogfHwgYm94Lm1pbi56ID4gdGhpcy5tYXgueiA/IGZhbHNlIDogdHJ1ZTsKICB9CiAgaW50ZXJzZWN0c1NwaGVyZShzcGhlcmUpIHsKICAgIHRoaXMuY2xhbXBQb2ludChzcGhlcmUuY2VudGVyLCBfdmVjdG9yJGIpOwogICAgcmV0dXJuIF92ZWN0b3IkYi5kaXN0YW5jZVRvU3F1YXJlZChzcGhlcmUuY2VudGVyKSA8PSBzcGhlcmUucmFkaXVzICogc3BoZXJlLnJhZGl1czsKICB9CiAgaW50ZXJzZWN0c1BsYW5lKHBsYW5lKSB7CiAgICBsZXQgbWluLCBtYXg7CiAgICBpZiAocGxhbmUubm9ybWFsLnggPiAwKSB7CiAgICAgIG1pbiA9IHBsYW5lLm5vcm1hbC54ICogdGhpcy5taW4ueDsKICAgICAgbWF4ID0gcGxhbmUubm9ybWFsLnggKiB0aGlzLm1heC54OwogICAgfSBlbHNlIHsKICAgICAgbWluID0gcGxhbmUubm9ybWFsLnggKiB0aGlzLm1heC54OwogICAgICBtYXggPSBwbGFuZS5ub3JtYWwueCAqIHRoaXMubWluLng7CiAgICB9CiAgICBpZiAocGxhbmUubm9ybWFsLnkgPiAwKSB7CiAgICAgIG1pbiArPSBwbGFuZS5ub3JtYWwueSAqIHRoaXMubWluLnk7CiAgICAgIG1heCArPSBwbGFuZS5ub3JtYWwueSAqIHRoaXMubWF4Lnk7CiAgICB9IGVsc2UgewogICAgICBtaW4gKz0gcGxhbmUubm9ybWFsLnkgKiB0aGlzLm1heC55OwogICAgICBtYXggKz0gcGxhbmUubm9ybWFsLnkgKiB0aGlzLm1pbi55OwogICAgfQogICAgaWYgKHBsYW5lLm5vcm1hbC56ID4gMCkgewogICAgICBtaW4gKz0gcGxhbmUubm9ybWFsLnogKiB0aGlzLm1pbi56OwogICAgICBtYXggKz0gcGxhbmUubm9ybWFsLnogKiB0aGlzLm1heC56OwogICAgfSBlbHNlIHsKICAgICAgbWluICs9IHBsYW5lLm5vcm1hbC56ICogdGhpcy5tYXguejsKICAgICAgbWF4ICs9IHBsYW5lLm5vcm1hbC56ICogdGhpcy5taW4uejsKICAgIH0KICAgIHJldHVybiBtaW4gPD0gLXBsYW5lLmNvbnN0YW50ICYmIG1heCA+PSAtcGxhbmUuY29uc3RhbnQ7CiAgfQogIGludGVyc2VjdHNUcmlhbmdsZSh0cmlhbmdsZSkgewogICAgaWYgKHRoaXMuaXNFbXB0eSgpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHRoaXMuZ2V0Q2VudGVyKF9jZW50ZXIpOwogICAgX2V4dGVudHMuc3ViVmVjdG9ycyh0aGlzLm1heCwgX2NlbnRlcik7CiAgICBfdjAkMi5zdWJWZWN0b3JzKHRyaWFuZ2xlLmEsIF9jZW50ZXIpOwogICAgX3YxJDcuc3ViVmVjdG9ycyh0cmlhbmdsZS5iLCBfY2VudGVyKTsKICAgIF92MiQzLnN1YlZlY3RvcnModHJpYW5nbGUuYywgX2NlbnRlcik7CiAgICBfZjAuc3ViVmVjdG9ycyhfdjEkNywgX3YwJDIpOwogICAgX2YxLnN1YlZlY3RvcnMoX3YyJDMsIF92MSQ3KTsKICAgIF9mMi5zdWJWZWN0b3JzKF92MCQyLCBfdjIkMyk7CiAgICBsZXQgYXhlcyA9IFsKICAgICAgMCwKICAgICAgLV9mMC56LAogICAgICBfZjAueSwKICAgICAgMCwKICAgICAgLV9mMS56LAogICAgICBfZjEueSwKICAgICAgMCwKICAgICAgLV9mMi56LAogICAgICBfZjIueSwKICAgICAgX2YwLnosCiAgICAgIDAsCiAgICAgIC1fZjAueCwKICAgICAgX2YxLnosCiAgICAgIDAsCiAgICAgIC1fZjEueCwKICAgICAgX2YyLnosCiAgICAgIDAsCiAgICAgIC1fZjIueCwKICAgICAgLV9mMC55LAogICAgICBfZjAueCwKICAgICAgMCwKICAgICAgLV9mMS55LAogICAgICBfZjEueCwKICAgICAgMCwKICAgICAgLV9mMi55LAogICAgICBfZjIueCwKICAgICAgMAogICAgXTsKICAgIGlmICghc2F0Rm9yQXhlcyhheGVzLCBfdjAkMiwgX3YxJDcsIF92MiQzLCBfZXh0ZW50cykpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgYXhlcyA9IFsxLCAwLCAwLCAwLCAxLCAwLCAwLCAwLCAxXTsKICAgIGlmICghc2F0Rm9yQXhlcyhheGVzLCBfdjAkMiwgX3YxJDcsIF92MiQzLCBfZXh0ZW50cykpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgX3RyaWFuZ2xlTm9ybWFsLmNyb3NzVmVjdG9ycyhfZjAsIF9mMSk7CiAgICBheGVzID0gW190cmlhbmdsZU5vcm1hbC54LCBfdHJpYW5nbGVOb3JtYWwueSwgX3RyaWFuZ2xlTm9ybWFsLnpdOwogICAgcmV0dXJuIHNhdEZvckF4ZXMoYXhlcywgX3YwJDIsIF92MSQ3LCBfdjIkMywgX2V4dGVudHMpOwogIH0KICBjbGFtcFBvaW50KHBvaW50LCB0YXJnZXQpIHsKICAgIHJldHVybiB0YXJnZXQuY29weShwb2ludCkuY2xhbXAodGhpcy5taW4sIHRoaXMubWF4KTsKICB9CiAgZGlzdGFuY2VUb1BvaW50KHBvaW50KSB7CiAgICBjb25zdCBjbGFtcGVkUG9pbnQgPSBfdmVjdG9yJGIuY29weShwb2ludCkuY2xhbXAodGhpcy5taW4sIHRoaXMubWF4KTsKICAgIHJldHVybiBjbGFtcGVkUG9pbnQuc3ViKHBvaW50KS5sZW5ndGgoKTsKICB9CiAgZ2V0Qm91bmRpbmdTcGhlcmUodGFyZ2V0KSB7CiAgICB0aGlzLmdldENlbnRlcih0YXJnZXQuY2VudGVyKTsKICAgIHRhcmdldC5yYWRpdXMgPSB0aGlzLmdldFNpemUoX3ZlY3RvciRiKS5sZW5ndGgoKSAqIDAuNTsKICAgIHJldHVybiB0YXJnZXQ7CiAgfQogIGludGVyc2VjdChib3gpIHsKICAgIHRoaXMubWluLm1heChib3gubWluKTsKICAgIHRoaXMubWF4Lm1pbihib3gubWF4KTsKICAgIGlmICh0aGlzLmlzRW1wdHkoKSkKICAgICAgdGhpcy5tYWtlRW1wdHkoKTsKICAgIHJldHVybiB0aGlzOwogIH0KICB1bmlvbihib3gpIHsKICAgIHRoaXMubWluLm1pbihib3gubWluKTsKICAgIHRoaXMubWF4Lm1heChib3gubWF4KTsKICAgIHJldHVybiB0aGlzOwogIH0KICBhcHBseU1hdHJpeDQobWF0cml4KSB7CiAgICBpZiAodGhpcy5pc0VtcHR5KCkpCiAgICAgIHJldHVybiB0aGlzOwogICAgX3BvaW50c1swXS5zZXQodGhpcy5taW4ueCwgdGhpcy5taW4ueSwgdGhpcy5taW4ueikuYXBwbHlNYXRyaXg0KG1hdHJpeCk7CiAgICBfcG9pbnRzWzFdLnNldCh0aGlzLm1pbi54LCB0aGlzLm1pbi55LCB0aGlzLm1heC56KS5hcHBseU1hdHJpeDQobWF0cml4KTsKICAgIF9wb2ludHNbMl0uc2V0KHRoaXMubWluLngsIHRoaXMubWF4LnksIHRoaXMubWluLnopLmFwcGx5TWF0cml4NChtYXRyaXgpOwogICAgX3BvaW50c1szXS5zZXQodGhpcy5taW4ueCwgdGhpcy5tYXgueSwgdGhpcy5tYXgueikuYXBwbHlNYXRyaXg0KG1hdHJpeCk7CiAgICBfcG9pbnRzWzRdLnNldCh0aGlzLm1heC54LCB0aGlzLm1pbi55LCB0aGlzLm1pbi56KS5hcHBseU1hdHJpeDQobWF0cml4KTsKICAgIF9wb2ludHNbNV0uc2V0KHRoaXMubWF4LngsIHRoaXMubWluLnksIHRoaXMubWF4LnopLmFwcGx5TWF0cml4NChtYXRyaXgpOwogICAgX3BvaW50c1s2XS5zZXQodGhpcy5tYXgueCwgdGhpcy5tYXgueSwgdGhpcy5taW4ueikuYXBwbHlNYXRyaXg0KG1hdHJpeCk7CiAgICBfcG9pbnRzWzddLnNldCh0aGlzLm1heC54LCB0aGlzLm1heC55LCB0aGlzLm1heC56KS5hcHBseU1hdHJpeDQobWF0cml4KTsKICAgIHRoaXMuc2V0RnJvbVBvaW50cyhfcG9pbnRzKTsKICAgIHJldHVybiB0aGlzOwogIH0KICB0cmFuc2xhdGUob2Zmc2V0KSB7CiAgICB0aGlzLm1pbi5hZGQob2Zmc2V0KTsKICAgIHRoaXMubWF4LmFkZChvZmZzZXQpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGVxdWFscyhib3gpIHsKICAgIHJldHVybiBib3gubWluLmVxdWFscyh0aGlzLm1pbikgJiYgYm94Lm1heC5lcXVhbHModGhpcy5tYXgpOwogIH0KfQpCb3gzLnByb3RvdHlwZS5pc0JveDMgPSB0cnVlOwpjb25zdCBfcG9pbnRzID0gWwogIC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpLAogIC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpLAogIC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpLAogIC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpLAogIC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpLAogIC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpLAogIC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpLAogIC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpCl07CmNvbnN0IF92ZWN0b3IkYiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfYm94JDMgPSAvKiBAX19QVVJFX18gKi8gbmV3IEJveDMoKTsKY29uc3QgX3YwJDIgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3YxJDcgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3YyJDMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX2YwID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF9mMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfZjIgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX2NlbnRlciA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfZXh0ZW50cyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfdHJpYW5nbGVOb3JtYWwgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3Rlc3RBeGlzID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmZ1bmN0aW9uIHNhdEZvckF4ZXMoYXhlcywgdjAsIHYxLCB2MiwgZXh0ZW50cykgewogIGZvciAobGV0IGkgPSAwLCBqID0gYXhlcy5sZW5ndGggLSAzOyBpIDw9IGo7IGkgKz0gMykgewogICAgX3Rlc3RBeGlzLmZyb21BcnJheShheGVzLCBpKTsKICAgIGNvbnN0IHIgPSBleHRlbnRzLnggKiBNYXRoLmFicyhfdGVzdEF4aXMueCkgKyBleHRlbnRzLnkgKiBNYXRoLmFicyhfdGVzdEF4aXMueSkgKyBleHRlbnRzLnogKiBNYXRoLmFicyhfdGVzdEF4aXMueik7CiAgICBjb25zdCBwMCA9IHYwLmRvdChfdGVzdEF4aXMpOwogICAgY29uc3QgcDEgPSB2MS5kb3QoX3Rlc3RBeGlzKTsKICAgIGNvbnN0IHAyID0gdjIuZG90KF90ZXN0QXhpcyk7CiAgICBpZiAoTWF0aC5tYXgoLU1hdGgubWF4KHAwLCBwMSwgcDIpLCBNYXRoLm1pbihwMCwgcDEsIHAyKSkgPiByKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9CiAgcmV0dXJuIHRydWU7Cn0KY29uc3QgX2JveCQyID0gLyogQF9fUFVSRV9fICovIG5ldyBCb3gzKCk7CmNvbnN0IF92MSQ2ID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF90b0ZhcnRoZXN0UG9pbnQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3RvUG9pbnQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY2xhc3MgU3BoZXJlIHsKICBjb25zdHJ1Y3RvcihjZW50ZXIgPSBuZXcgVmVjdG9yMygpLCByYWRpdXMgPSAtMSkgewogICAgdGhpcy5jZW50ZXIgPSBjZW50ZXI7CiAgICB0aGlzLnJhZGl1cyA9IHJhZGl1czsKICB9CiAgc2V0KGNlbnRlciwgcmFkaXVzKSB7CiAgICB0aGlzLmNlbnRlci5jb3B5KGNlbnRlcik7CiAgICB0aGlzLnJhZGl1cyA9IHJhZGl1czsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRGcm9tUG9pbnRzKHBvaW50cywgb3B0aW9uYWxDZW50ZXIpIHsKICAgIGNvbnN0IGNlbnRlciA9IHRoaXMuY2VudGVyOwogICAgaWYgKG9wdGlvbmFsQ2VudGVyICE9PSB2b2lkIDApIHsKICAgICAgY2VudGVyLmNvcHkob3B0aW9uYWxDZW50ZXIpOwogICAgfSBlbHNlIHsKICAgICAgX2JveCQyLnNldEZyb21Qb2ludHMocG9pbnRzKS5nZXRDZW50ZXIoY2VudGVyKTsKICAgIH0KICAgIGxldCBtYXhSYWRpdXNTcSA9IDA7CiAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBwb2ludHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICBtYXhSYWRpdXNTcSA9IE1hdGgubWF4KG1heFJhZGl1c1NxLCBjZW50ZXIuZGlzdGFuY2VUb1NxdWFyZWQocG9pbnRzW2ldKSk7CiAgICB9CiAgICB0aGlzLnJhZGl1cyA9IE1hdGguc3FydChtYXhSYWRpdXNTcSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY29weShzcGhlcmUpIHsKICAgIHRoaXMuY2VudGVyLmNvcHkoc3BoZXJlLmNlbnRlcik7CiAgICB0aGlzLnJhZGl1cyA9IHNwaGVyZS5yYWRpdXM7CiAgICByZXR1cm4gdGhpczsKICB9CiAgaXNFbXB0eSgpIHsKICAgIHJldHVybiB0aGlzLnJhZGl1cyA8IDA7CiAgfQogIG1ha2VFbXB0eSgpIHsKICAgIHRoaXMuY2VudGVyLnNldCgwLCAwLCAwKTsKICAgIHRoaXMucmFkaXVzID0gLTE7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY29udGFpbnNQb2ludChwb2ludCkgewogICAgcmV0dXJuIHBvaW50LmRpc3RhbmNlVG9TcXVhcmVkKHRoaXMuY2VudGVyKSA8PSB0aGlzLnJhZGl1cyAqIHRoaXMucmFkaXVzOwogIH0KICBkaXN0YW5jZVRvUG9pbnQocG9pbnQpIHsKICAgIHJldHVybiBwb2ludC5kaXN0YW5jZVRvKHRoaXMuY2VudGVyKSAtIHRoaXMucmFkaXVzOwogIH0KICBpbnRlcnNlY3RzU3BoZXJlKHNwaGVyZSkgewogICAgY29uc3QgcmFkaXVzU3VtID0gdGhpcy5yYWRpdXMgKyBzcGhlcmUucmFkaXVzOwogICAgcmV0dXJuIHNwaGVyZS5jZW50ZXIuZGlzdGFuY2VUb1NxdWFyZWQodGhpcy5jZW50ZXIpIDw9IHJhZGl1c1N1bSAqIHJhZGl1c1N1bTsKICB9CiAgaW50ZXJzZWN0c0JveChib3gpIHsKICAgIHJldHVybiBib3guaW50ZXJzZWN0c1NwaGVyZSh0aGlzKTsKICB9CiAgaW50ZXJzZWN0c1BsYW5lKHBsYW5lKSB7CiAgICByZXR1cm4gTWF0aC5hYnMocGxhbmUuZGlzdGFuY2VUb1BvaW50KHRoaXMuY2VudGVyKSkgPD0gdGhpcy5yYWRpdXM7CiAgfQogIGNsYW1wUG9pbnQocG9pbnQsIHRhcmdldCkgewogICAgY29uc3QgZGVsdGFMZW5ndGhTcSA9IHRoaXMuY2VudGVyLmRpc3RhbmNlVG9TcXVhcmVkKHBvaW50KTsKICAgIHRhcmdldC5jb3B5KHBvaW50KTsKICAgIGlmIChkZWx0YUxlbmd0aFNxID4gdGhpcy5yYWRpdXMgKiB0aGlzLnJhZGl1cykgewogICAgICB0YXJnZXQuc3ViKHRoaXMuY2VudGVyKS5ub3JtYWxpemUoKTsKICAgICAgdGFyZ2V0Lm11bHRpcGx5U2NhbGFyKHRoaXMucmFkaXVzKS5hZGQodGhpcy5jZW50ZXIpOwogICAgfQogICAgcmV0dXJuIHRhcmdldDsKICB9CiAgZ2V0Qm91bmRpbmdCb3godGFyZ2V0KSB7CiAgICBpZiAodGhpcy5pc0VtcHR5KCkpIHsKICAgICAgdGFyZ2V0Lm1ha2VFbXB0eSgpOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgdGFyZ2V0LnNldCh0aGlzLmNlbnRlciwgdGhpcy5jZW50ZXIpOwogICAgdGFyZ2V0LmV4cGFuZEJ5U2NhbGFyKHRoaXMucmFkaXVzKTsKICAgIHJldHVybiB0YXJnZXQ7CiAgfQogIGFwcGx5TWF0cml4NChtYXRyaXgpIHsKICAgIHRoaXMuY2VudGVyLmFwcGx5TWF0cml4NChtYXRyaXgpOwogICAgdGhpcy5yYWRpdXMgPSB0aGlzLnJhZGl1cyAqIG1hdHJpeC5nZXRNYXhTY2FsZU9uQXhpcygpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRyYW5zbGF0ZShvZmZzZXQpIHsKICAgIHRoaXMuY2VudGVyLmFkZChvZmZzZXQpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGV4cGFuZEJ5UG9pbnQocG9pbnQpIHsKICAgIF90b1BvaW50LnN1YlZlY3RvcnMocG9pbnQsIHRoaXMuY2VudGVyKTsKICAgIGNvbnN0IGxlbmd0aFNxID0gX3RvUG9pbnQubGVuZ3RoU3EoKTsKICAgIGlmIChsZW5ndGhTcSA+IHRoaXMucmFkaXVzICogdGhpcy5yYWRpdXMpIHsKICAgICAgY29uc3QgbGVuZ3RoID0gTWF0aC5zcXJ0KGxlbmd0aFNxKTsKICAgICAgY29uc3QgbWlzc2luZ1JhZGl1c0hhbGYgPSAobGVuZ3RoIC0gdGhpcy5yYWRpdXMpICogMC41OwogICAgICB0aGlzLmNlbnRlci5hZGQoX3RvUG9pbnQubXVsdGlwbHlTY2FsYXIobWlzc2luZ1JhZGl1c0hhbGYgLyBsZW5ndGgpKTsKICAgICAgdGhpcy5yYWRpdXMgKz0gbWlzc2luZ1JhZGl1c0hhbGY7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9CiAgdW5pb24oc3BoZXJlKSB7CiAgICBpZiAodGhpcy5jZW50ZXIuZXF1YWxzKHNwaGVyZS5jZW50ZXIpID09PSB0cnVlKSB7CiAgICAgIF90b0ZhcnRoZXN0UG9pbnQuc2V0KDAsIDAsIDEpLm11bHRpcGx5U2NhbGFyKHNwaGVyZS5yYWRpdXMpOwogICAgfSBlbHNlIHsKICAgICAgX3RvRmFydGhlc3RQb2ludC5zdWJWZWN0b3JzKHNwaGVyZS5jZW50ZXIsIHRoaXMuY2VudGVyKS5ub3JtYWxpemUoKS5tdWx0aXBseVNjYWxhcihzcGhlcmUucmFkaXVzKTsKICAgIH0KICAgIHRoaXMuZXhwYW5kQnlQb2ludChfdjEkNi5jb3B5KHNwaGVyZS5jZW50ZXIpLmFkZChfdG9GYXJ0aGVzdFBvaW50KSk7CiAgICB0aGlzLmV4cGFuZEJ5UG9pbnQoX3YxJDYuY29weShzcGhlcmUuY2VudGVyKS5zdWIoX3RvRmFydGhlc3RQb2ludCkpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGVxdWFscyhzcGhlcmUpIHsKICAgIHJldHVybiBzcGhlcmUuY2VudGVyLmVxdWFscyh0aGlzLmNlbnRlcikgJiYgc3BoZXJlLnJhZGl1cyA9PT0gdGhpcy5yYWRpdXM7CiAgfQogIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKCkuY29weSh0aGlzKTsKICB9Cn0KY29uc3QgX3ZlY3RvciRhID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF9zZWdDZW50ZXIgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3NlZ0RpciA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfZGlmZiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfZWRnZTEgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX2VkZ2UyID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF9ub3JtYWwkMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjbGFzcyBSYXkgewogIGNvbnN0cnVjdG9yKG9yaWdpbiA9IG5ldyBWZWN0b3IzKCksIGRpcmVjdGlvbiA9IG5ldyBWZWN0b3IzKDAsIDAsIC0xKSkgewogICAgdGhpcy5vcmlnaW4gPSBvcmlnaW47CiAgICB0aGlzLmRpcmVjdGlvbiA9IGRpcmVjdGlvbjsKICB9CiAgc2V0KG9yaWdpbiwgZGlyZWN0aW9uKSB7CiAgICB0aGlzLm9yaWdpbi5jb3B5KG9yaWdpbik7CiAgICB0aGlzLmRpcmVjdGlvbi5jb3B5KGRpcmVjdGlvbik7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY29weShyYXkpIHsKICAgIHRoaXMub3JpZ2luLmNvcHkocmF5Lm9yaWdpbik7CiAgICB0aGlzLmRpcmVjdGlvbi5jb3B5KHJheS5kaXJlY3Rpb24pOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGF0KHQsIHRhcmdldCkgewogICAgcmV0dXJuIHRhcmdldC5jb3B5KHRoaXMuZGlyZWN0aW9uKS5tdWx0aXBseVNjYWxhcih0KS5hZGQodGhpcy5vcmlnaW4pOwogIH0KICBsb29rQXQodikgewogICAgdGhpcy5kaXJlY3Rpb24uY29weSh2KS5zdWIodGhpcy5vcmlnaW4pLm5vcm1hbGl6ZSgpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHJlY2FzdCh0KSB7CiAgICB0aGlzLm9yaWdpbi5jb3B5KHRoaXMuYXQodCwgX3ZlY3RvciRhKSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xvc2VzdFBvaW50VG9Qb2ludChwb2ludCwgdGFyZ2V0KSB7CiAgICB0YXJnZXQuc3ViVmVjdG9ycyhwb2ludCwgdGhpcy5vcmlnaW4pOwogICAgY29uc3QgZGlyZWN0aW9uRGlzdGFuY2UgPSB0YXJnZXQuZG90KHRoaXMuZGlyZWN0aW9uKTsKICAgIGlmIChkaXJlY3Rpb25EaXN0YW5jZSA8IDApIHsKICAgICAgcmV0dXJuIHRhcmdldC5jb3B5KHRoaXMub3JpZ2luKTsKICAgIH0KICAgIHJldHVybiB0YXJnZXQuY29weSh0aGlzLmRpcmVjdGlvbikubXVsdGlwbHlTY2FsYXIoZGlyZWN0aW9uRGlzdGFuY2UpLmFkZCh0aGlzLm9yaWdpbik7CiAgfQogIGRpc3RhbmNlVG9Qb2ludChwb2ludCkgewogICAgcmV0dXJuIE1hdGguc3FydCh0aGlzLmRpc3RhbmNlU3FUb1BvaW50KHBvaW50KSk7CiAgfQogIGRpc3RhbmNlU3FUb1BvaW50KHBvaW50KSB7CiAgICBjb25zdCBkaXJlY3Rpb25EaXN0YW5jZSA9IF92ZWN0b3IkYS5zdWJWZWN0b3JzKHBvaW50LCB0aGlzLm9yaWdpbikuZG90KHRoaXMuZGlyZWN0aW9uKTsKICAgIGlmIChkaXJlY3Rpb25EaXN0YW5jZSA8IDApIHsKICAgICAgcmV0dXJuIHRoaXMub3JpZ2luLmRpc3RhbmNlVG9TcXVhcmVkKHBvaW50KTsKICAgIH0KICAgIF92ZWN0b3IkYS5jb3B5KHRoaXMuZGlyZWN0aW9uKS5tdWx0aXBseVNjYWxhcihkaXJlY3Rpb25EaXN0YW5jZSkuYWRkKHRoaXMub3JpZ2luKTsKICAgIHJldHVybiBfdmVjdG9yJGEuZGlzdGFuY2VUb1NxdWFyZWQocG9pbnQpOwogIH0KICBkaXN0YW5jZVNxVG9TZWdtZW50KHYwLCB2MSwgb3B0aW9uYWxQb2ludE9uUmF5LCBvcHRpb25hbFBvaW50T25TZWdtZW50KSB7CiAgICBfc2VnQ2VudGVyLmNvcHkodjApLmFkZCh2MSkubXVsdGlwbHlTY2FsYXIoMC41KTsKICAgIF9zZWdEaXIuY29weSh2MSkuc3ViKHYwKS5ub3JtYWxpemUoKTsKICAgIF9kaWZmLmNvcHkodGhpcy5vcmlnaW4pLnN1Yihfc2VnQ2VudGVyKTsKICAgIGNvbnN0IHNlZ0V4dGVudCA9IHYwLmRpc3RhbmNlVG8odjEpICogMC41OwogICAgY29uc3QgYTAxID0gLXRoaXMuZGlyZWN0aW9uLmRvdChfc2VnRGlyKTsKICAgIGNvbnN0IGIwID0gX2RpZmYuZG90KHRoaXMuZGlyZWN0aW9uKTsKICAgIGNvbnN0IGIxID0gLV9kaWZmLmRvdChfc2VnRGlyKTsKICAgIGNvbnN0IGMgPSBfZGlmZi5sZW5ndGhTcSgpOwogICAgY29uc3QgZGV0ID0gTWF0aC5hYnMoMSAtIGEwMSAqIGEwMSk7CiAgICBsZXQgczAsIHMxLCBzcXJEaXN0LCBleHREZXQ7CiAgICBpZiAoZGV0ID4gMCkgewogICAgICBzMCA9IGEwMSAqIGIxIC0gYjA7CiAgICAgIHMxID0gYTAxICogYjAgLSBiMTsKICAgICAgZXh0RGV0ID0gc2VnRXh0ZW50ICogZGV0OwogICAgICBpZiAoczAgPj0gMCkgewogICAgICAgIGlmIChzMSA+PSAtZXh0RGV0KSB7CiAgICAgICAgICBpZiAoczEgPD0gZXh0RGV0KSB7CiAgICAgICAgICAgIGNvbnN0IGludkRldCA9IDEgLyBkZXQ7CiAgICAgICAgICAgIHMwICo9IGludkRldDsKICAgICAgICAgICAgczEgKj0gaW52RGV0OwogICAgICAgICAgICBzcXJEaXN0ID0gczAgKiAoczAgKyBhMDEgKiBzMSArIDIgKiBiMCkgKyBzMSAqIChhMDEgKiBzMCArIHMxICsgMiAqIGIxKSArIGM7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzMSA9IHNlZ0V4dGVudDsKICAgICAgICAgICAgczAgPSBNYXRoLm1heCgwLCAtKGEwMSAqIHMxICsgYjApKTsKICAgICAgICAgICAgc3FyRGlzdCA9IC1zMCAqIHMwICsgczEgKiAoczEgKyAyICogYjEpICsgYzsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgczEgPSAtc2VnRXh0ZW50OwogICAgICAgICAgczAgPSBNYXRoLm1heCgwLCAtKGEwMSAqIHMxICsgYjApKTsKICAgICAgICAgIHNxckRpc3QgPSAtczAgKiBzMCArIHMxICogKHMxICsgMiAqIGIxKSArIGM7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChzMSA8PSAtZXh0RGV0KSB7CiAgICAgICAgICBzMCA9IE1hdGgubWF4KDAsIC0oLWEwMSAqIHNlZ0V4dGVudCArIGIwKSk7CiAgICAgICAgICBzMSA9IHMwID4gMCA/IC1zZWdFeHRlbnQgOiBNYXRoLm1pbihNYXRoLm1heCgtc2VnRXh0ZW50LCAtYjEpLCBzZWdFeHRlbnQpOwogICAgICAgICAgc3FyRGlzdCA9IC1zMCAqIHMwICsgczEgKiAoczEgKyAyICogYjEpICsgYzsKICAgICAgICB9IGVsc2UgaWYgKHMxIDw9IGV4dERldCkgewogICAgICAgICAgczAgPSAwOwogICAgICAgICAgczEgPSBNYXRoLm1pbihNYXRoLm1heCgtc2VnRXh0ZW50LCAtYjEpLCBzZWdFeHRlbnQpOwogICAgICAgICAgc3FyRGlzdCA9IHMxICogKHMxICsgMiAqIGIxKSArIGM7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHMwID0gTWF0aC5tYXgoMCwgLShhMDEgKiBzZWdFeHRlbnQgKyBiMCkpOwogICAgICAgICAgczEgPSBzMCA+IDAgPyBzZWdFeHRlbnQgOiBNYXRoLm1pbihNYXRoLm1heCgtc2VnRXh0ZW50LCAtYjEpLCBzZWdFeHRlbnQpOwogICAgICAgICAgc3FyRGlzdCA9IC1zMCAqIHMwICsgczEgKiAoczEgKyAyICogYjEpICsgYzsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHMxID0gYTAxID4gMCA/IC1zZWdFeHRlbnQgOiBzZWdFeHRlbnQ7CiAgICAgIHMwID0gTWF0aC5tYXgoMCwgLShhMDEgKiBzMSArIGIwKSk7CiAgICAgIHNxckRpc3QgPSAtczAgKiBzMCArIHMxICogKHMxICsgMiAqIGIxKSArIGM7CiAgICB9CiAgICBpZiAob3B0aW9uYWxQb2ludE9uUmF5KSB7CiAgICAgIG9wdGlvbmFsUG9pbnRPblJheS5jb3B5KHRoaXMuZGlyZWN0aW9uKS5tdWx0aXBseVNjYWxhcihzMCkuYWRkKHRoaXMub3JpZ2luKTsKICAgIH0KICAgIGlmIChvcHRpb25hbFBvaW50T25TZWdtZW50KSB7CiAgICAgIG9wdGlvbmFsUG9pbnRPblNlZ21lbnQuY29weShfc2VnRGlyKS5tdWx0aXBseVNjYWxhcihzMSkuYWRkKF9zZWdDZW50ZXIpOwogICAgfQogICAgcmV0dXJuIHNxckRpc3Q7CiAgfQogIGludGVyc2VjdFNwaGVyZShzcGhlcmUsIHRhcmdldCkgewogICAgX3ZlY3RvciRhLnN1YlZlY3RvcnMoc3BoZXJlLmNlbnRlciwgdGhpcy5vcmlnaW4pOwogICAgY29uc3QgdGNhID0gX3ZlY3RvciRhLmRvdCh0aGlzLmRpcmVjdGlvbik7CiAgICBjb25zdCBkMiA9IF92ZWN0b3IkYS5kb3QoX3ZlY3RvciRhKSAtIHRjYSAqIHRjYTsKICAgIGNvbnN0IHJhZGl1czIgPSBzcGhlcmUucmFkaXVzICogc3BoZXJlLnJhZGl1czsKICAgIGlmIChkMiA+IHJhZGl1czIpCiAgICAgIHJldHVybiBudWxsOwogICAgY29uc3QgdGhjID0gTWF0aC5zcXJ0KHJhZGl1czIgLSBkMik7CiAgICBjb25zdCB0MCA9IHRjYSAtIHRoYzsKICAgIGNvbnN0IHQxID0gdGNhICsgdGhjOwogICAgaWYgKHQwIDwgMCAmJiB0MSA8IDApCiAgICAgIHJldHVybiBudWxsOwogICAgaWYgKHQwIDwgMCkKICAgICAgcmV0dXJuIHRoaXMuYXQodDEsIHRhcmdldCk7CiAgICByZXR1cm4gdGhpcy5hdCh0MCwgdGFyZ2V0KTsKICB9CiAgaW50ZXJzZWN0c1NwaGVyZShzcGhlcmUpIHsKICAgIHJldHVybiB0aGlzLmRpc3RhbmNlU3FUb1BvaW50KHNwaGVyZS5jZW50ZXIpIDw9IHNwaGVyZS5yYWRpdXMgKiBzcGhlcmUucmFkaXVzOwogIH0KICBkaXN0YW5jZVRvUGxhbmUocGxhbmUpIHsKICAgIGNvbnN0IGRlbm9taW5hdG9yID0gcGxhbmUubm9ybWFsLmRvdCh0aGlzLmRpcmVjdGlvbik7CiAgICBpZiAoZGVub21pbmF0b3IgPT09IDApIHsKICAgICAgaWYgKHBsYW5lLmRpc3RhbmNlVG9Qb2ludCh0aGlzLm9yaWdpbikgPT09IDApIHsKICAgICAgICByZXR1cm4gMDsKICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIGNvbnN0IHQgPSAtKHRoaXMub3JpZ2luLmRvdChwbGFuZS5ub3JtYWwpICsgcGxhbmUuY29uc3RhbnQpIC8gZGVub21pbmF0b3I7CiAgICByZXR1cm4gdCA+PSAwID8gdCA6IG51bGw7CiAgfQogIGludGVyc2VjdFBsYW5lKHBsYW5lLCB0YXJnZXQpIHsKICAgIGNvbnN0IHQgPSB0aGlzLmRpc3RhbmNlVG9QbGFuZShwbGFuZSk7CiAgICBpZiAodCA9PT0gbnVsbCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIHJldHVybiB0aGlzLmF0KHQsIHRhcmdldCk7CiAgfQogIGludGVyc2VjdHNQbGFuZShwbGFuZSkgewogICAgY29uc3QgZGlzdFRvUG9pbnQgPSBwbGFuZS5kaXN0YW5jZVRvUG9pbnQodGhpcy5vcmlnaW4pOwogICAgaWYgKGRpc3RUb1BvaW50ID09PSAwKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgY29uc3QgZGVub21pbmF0b3IgPSBwbGFuZS5ub3JtYWwuZG90KHRoaXMuZGlyZWN0aW9uKTsKICAgIGlmIChkZW5vbWluYXRvciAqIGRpc3RUb1BvaW50IDwgMCkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIHJldHVybiBmYWxzZTsKICB9CiAgaW50ZXJzZWN0Qm94KGJveCwgdGFyZ2V0KSB7CiAgICBsZXQgdG1pbiwgdG1heCwgdHltaW4sIHR5bWF4LCB0em1pbiwgdHptYXg7CiAgICBjb25zdCBpbnZkaXJ4ID0gMSAvIHRoaXMuZGlyZWN0aW9uLngsIGludmRpcnkgPSAxIC8gdGhpcy5kaXJlY3Rpb24ueSwgaW52ZGlyeiA9IDEgLyB0aGlzLmRpcmVjdGlvbi56OwogICAgY29uc3Qgb3JpZ2luID0gdGhpcy5vcmlnaW47CiAgICBpZiAoaW52ZGlyeCA+PSAwKSB7CiAgICAgIHRtaW4gPSAoYm94Lm1pbi54IC0gb3JpZ2luLngpICogaW52ZGlyeDsKICAgICAgdG1heCA9IChib3gubWF4LnggLSBvcmlnaW4ueCkgKiBpbnZkaXJ4OwogICAgfSBlbHNlIHsKICAgICAgdG1pbiA9IChib3gubWF4LnggLSBvcmlnaW4ueCkgKiBpbnZkaXJ4OwogICAgICB0bWF4ID0gKGJveC5taW4ueCAtIG9yaWdpbi54KSAqIGludmRpcng7CiAgICB9CiAgICBpZiAoaW52ZGlyeSA+PSAwKSB7CiAgICAgIHR5bWluID0gKGJveC5taW4ueSAtIG9yaWdpbi55KSAqIGludmRpcnk7CiAgICAgIHR5bWF4ID0gKGJveC5tYXgueSAtIG9yaWdpbi55KSAqIGludmRpcnk7CiAgICB9IGVsc2UgewogICAgICB0eW1pbiA9IChib3gubWF4LnkgLSBvcmlnaW4ueSkgKiBpbnZkaXJ5OwogICAgICB0eW1heCA9IChib3gubWluLnkgLSBvcmlnaW4ueSkgKiBpbnZkaXJ5OwogICAgfQogICAgaWYgKHRtaW4gPiB0eW1heCB8fCB0eW1pbiA+IHRtYXgpCiAgICAgIHJldHVybiBudWxsOwogICAgaWYgKHR5bWluID4gdG1pbiB8fCB0bWluICE9PSB0bWluKQogICAgICB0bWluID0gdHltaW47CiAgICBpZiAodHltYXggPCB0bWF4IHx8IHRtYXggIT09IHRtYXgpCiAgICAgIHRtYXggPSB0eW1heDsKICAgIGlmIChpbnZkaXJ6ID49IDApIHsKICAgICAgdHptaW4gPSAoYm94Lm1pbi56IC0gb3JpZ2luLnopICogaW52ZGlyejsKICAgICAgdHptYXggPSAoYm94Lm1heC56IC0gb3JpZ2luLnopICogaW52ZGlyejsKICAgIH0gZWxzZSB7CiAgICAgIHR6bWluID0gKGJveC5tYXgueiAtIG9yaWdpbi56KSAqIGludmRpcno7CiAgICAgIHR6bWF4ID0gKGJveC5taW4ueiAtIG9yaWdpbi56KSAqIGludmRpcno7CiAgICB9CiAgICBpZiAodG1pbiA+IHR6bWF4IHx8IHR6bWluID4gdG1heCkKICAgICAgcmV0dXJuIG51bGw7CiAgICBpZiAodHptaW4gPiB0bWluIHx8IHRtaW4gIT09IHRtaW4pCiAgICAgIHRtaW4gPSB0em1pbjsKICAgIGlmICh0em1heCA8IHRtYXggfHwgdG1heCAhPT0gdG1heCkKICAgICAgdG1heCA9IHR6bWF4OwogICAgaWYgKHRtYXggPCAwKQogICAgICByZXR1cm4gbnVsbDsKICAgIHJldHVybiB0aGlzLmF0KHRtaW4gPj0gMCA/IHRtaW4gOiB0bWF4LCB0YXJnZXQpOwogIH0KICBpbnRlcnNlY3RzQm94KGJveCkgewogICAgcmV0dXJuIHRoaXMuaW50ZXJzZWN0Qm94KGJveCwgX3ZlY3RvciRhKSAhPT0gbnVsbDsKICB9CiAgaW50ZXJzZWN0VHJpYW5nbGUoYSwgYiwgYywgYmFja2ZhY2VDdWxsaW5nLCB0YXJnZXQpIHsKICAgIF9lZGdlMS5zdWJWZWN0b3JzKGIsIGEpOwogICAgX2VkZ2UyLnN1YlZlY3RvcnMoYywgYSk7CiAgICBfbm9ybWFsJDEuY3Jvc3NWZWN0b3JzKF9lZGdlMSwgX2VkZ2UyKTsKICAgIGxldCBEZE4gPSB0aGlzLmRpcmVjdGlvbi5kb3QoX25vcm1hbCQxKTsKICAgIGxldCBzaWduMjsKICAgIGlmIChEZE4gPiAwKSB7CiAgICAgIGlmIChiYWNrZmFjZUN1bGxpbmcpCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIHNpZ24yID0gMTsKICAgIH0gZWxzZSBpZiAoRGROIDwgMCkgewogICAgICBzaWduMiA9IC0xOwogICAgICBEZE4gPSAtRGROOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICBfZGlmZi5zdWJWZWN0b3JzKHRoaXMub3JpZ2luLCBhKTsKICAgIGNvbnN0IERkUXhFMiA9IHNpZ24yICogdGhpcy5kaXJlY3Rpb24uZG90KF9lZGdlMi5jcm9zc1ZlY3RvcnMoX2RpZmYsIF9lZGdlMikpOwogICAgaWYgKERkUXhFMiA8IDApIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICBjb25zdCBEZEUxeFEgPSBzaWduMiAqIHRoaXMuZGlyZWN0aW9uLmRvdChfZWRnZTEuY3Jvc3MoX2RpZmYpKTsKICAgIGlmIChEZEUxeFEgPCAwKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQogICAgaWYgKERkUXhFMiArIERkRTF4USA+IERkTikgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIGNvbnN0IFFkTiA9IC1zaWduMiAqIF9kaWZmLmRvdChfbm9ybWFsJDEpOwogICAgaWYgKFFkTiA8IDApIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICByZXR1cm4gdGhpcy5hdChRZE4gLyBEZE4sIHRhcmdldCk7CiAgfQogIGFwcGx5TWF0cml4NChtYXRyaXg0KSB7CiAgICB0aGlzLm9yaWdpbi5hcHBseU1hdHJpeDQobWF0cml4NCk7CiAgICB0aGlzLmRpcmVjdGlvbi50cmFuc2Zvcm1EaXJlY3Rpb24obWF0cml4NCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZXF1YWxzKHJheSkgewogICAgcmV0dXJuIHJheS5vcmlnaW4uZXF1YWxzKHRoaXMub3JpZ2luKSAmJiByYXkuZGlyZWN0aW9uLmVxdWFscyh0aGlzLmRpcmVjdGlvbik7CiAgfQogIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKCkuY29weSh0aGlzKTsKICB9Cn0KY2xhc3MgTWF0cml4NCB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLmVsZW1lbnRzID0gWwogICAgICAxLAogICAgICAwLAogICAgICAwLAogICAgICAwLAogICAgICAwLAogICAgICAxLAogICAgICAwLAogICAgICAwLAogICAgICAwLAogICAgICAwLAogICAgICAxLAogICAgICAwLAogICAgICAwLAogICAgICAwLAogICAgICAwLAogICAgICAxCiAgICBdOwogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLk1hdHJpeDQ6IHRoZSBjb25zdHJ1Y3RvciBubyBsb25nZXIgcmVhZHMgYXJndW1lbnRzLiB1c2UgLnNldCgpIGluc3RlYWQuIik7CiAgICB9CiAgfQogIHNldChuMTEsIG4xMiwgbjEzLCBuMTQsIG4yMSwgbjIyLCBuMjMsIG4yNCwgbjMxLCBuMzIsIG4zMywgbjM0LCBuNDEsIG40MiwgbjQzLCBuNDQpIHsKICAgIGNvbnN0IHRlID0gdGhpcy5lbGVtZW50czsKICAgIHRlWzBdID0gbjExOwogICAgdGVbNF0gPSBuMTI7CiAgICB0ZVs4XSA9IG4xMzsKICAgIHRlWzEyXSA9IG4xNDsKICAgIHRlWzFdID0gbjIxOwogICAgdGVbNV0gPSBuMjI7CiAgICB0ZVs5XSA9IG4yMzsKICAgIHRlWzEzXSA9IG4yNDsKICAgIHRlWzJdID0gbjMxOwogICAgdGVbNl0gPSBuMzI7CiAgICB0ZVsxMF0gPSBuMzM7CiAgICB0ZVsxNF0gPSBuMzQ7CiAgICB0ZVszXSA9IG40MTsKICAgIHRlWzddID0gbjQyOwogICAgdGVbMTFdID0gbjQzOwogICAgdGVbMTVdID0gbjQ0OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGlkZW50aXR5KCkgewogICAgdGhpcy5zZXQoMSwgMCwgMCwgMCwgMCwgMSwgMCwgMCwgMCwgMCwgMSwgMCwgMCwgMCwgMCwgMSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xvbmUoKSB7CiAgICByZXR1cm4gbmV3IE1hdHJpeDQoKS5mcm9tQXJyYXkodGhpcy5lbGVtZW50cyk7CiAgfQogIGNvcHkobSkgewogICAgY29uc3QgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgY29uc3QgbWUgPSBtLmVsZW1lbnRzOwogICAgdGVbMF0gPSBtZVswXTsKICAgIHRlWzFdID0gbWVbMV07CiAgICB0ZVsyXSA9IG1lWzJdOwogICAgdGVbM10gPSBtZVszXTsKICAgIHRlWzRdID0gbWVbNF07CiAgICB0ZVs1XSA9IG1lWzVdOwogICAgdGVbNl0gPSBtZVs2XTsKICAgIHRlWzddID0gbWVbN107CiAgICB0ZVs4XSA9IG1lWzhdOwogICAgdGVbOV0gPSBtZVs5XTsKICAgIHRlWzEwXSA9IG1lWzEwXTsKICAgIHRlWzExXSA9IG1lWzExXTsKICAgIHRlWzEyXSA9IG1lWzEyXTsKICAgIHRlWzEzXSA9IG1lWzEzXTsKICAgIHRlWzE0XSA9IG1lWzE0XTsKICAgIHRlWzE1XSA9IG1lWzE1XTsKICAgIHJldHVybiB0aGlzOwogIH0KICBjb3B5UG9zaXRpb24obSkgewogICAgY29uc3QgdGUgPSB0aGlzLmVsZW1lbnRzLCBtZSA9IG0uZWxlbWVudHM7CiAgICB0ZVsxMl0gPSBtZVsxMl07CiAgICB0ZVsxM10gPSBtZVsxM107CiAgICB0ZVsxNF0gPSBtZVsxNF07CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0RnJvbU1hdHJpeDMobSkgewogICAgY29uc3QgbWUgPSBtLmVsZW1lbnRzOwogICAgdGhpcy5zZXQobWVbMF0sIG1lWzNdLCBtZVs2XSwgMCwgbWVbMV0sIG1lWzRdLCBtZVs3XSwgMCwgbWVbMl0sIG1lWzVdLCBtZVs4XSwgMCwgMCwgMCwgMCwgMSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZXh0cmFjdEJhc2lzKHhBeGlzLCB5QXhpcywgekF4aXMpIHsKICAgIHhBeGlzLnNldEZyb21NYXRyaXhDb2x1bW4odGhpcywgMCk7CiAgICB5QXhpcy5zZXRGcm9tTWF0cml4Q29sdW1uKHRoaXMsIDEpOwogICAgekF4aXMuc2V0RnJvbU1hdHJpeENvbHVtbih0aGlzLCAyKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBtYWtlQmFzaXMoeEF4aXMsIHlBeGlzLCB6QXhpcykgewogICAgdGhpcy5zZXQoeEF4aXMueCwgeUF4aXMueCwgekF4aXMueCwgMCwgeEF4aXMueSwgeUF4aXMueSwgekF4aXMueSwgMCwgeEF4aXMueiwgeUF4aXMueiwgekF4aXMueiwgMCwgMCwgMCwgMCwgMSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZXh0cmFjdFJvdGF0aW9uKG0pIHsKICAgIGNvbnN0IHRlID0gdGhpcy5lbGVtZW50czsKICAgIGNvbnN0IG1lID0gbS5lbGVtZW50czsKICAgIGNvbnN0IHNjYWxlWCA9IDEgLyBfdjEkNS5zZXRGcm9tTWF0cml4Q29sdW1uKG0sIDApLmxlbmd0aCgpOwogICAgY29uc3Qgc2NhbGVZID0gMSAvIF92MSQ1LnNldEZyb21NYXRyaXhDb2x1bW4obSwgMSkubGVuZ3RoKCk7CiAgICBjb25zdCBzY2FsZVogPSAxIC8gX3YxJDUuc2V0RnJvbU1hdHJpeENvbHVtbihtLCAyKS5sZW5ndGgoKTsKICAgIHRlWzBdID0gbWVbMF0gKiBzY2FsZVg7CiAgICB0ZVsxXSA9IG1lWzFdICogc2NhbGVYOwogICAgdGVbMl0gPSBtZVsyXSAqIHNjYWxlWDsKICAgIHRlWzNdID0gMDsKICAgIHRlWzRdID0gbWVbNF0gKiBzY2FsZVk7CiAgICB0ZVs1XSA9IG1lWzVdICogc2NhbGVZOwogICAgdGVbNl0gPSBtZVs2XSAqIHNjYWxlWTsKICAgIHRlWzddID0gMDsKICAgIHRlWzhdID0gbWVbOF0gKiBzY2FsZVo7CiAgICB0ZVs5XSA9IG1lWzldICogc2NhbGVaOwogICAgdGVbMTBdID0gbWVbMTBdICogc2NhbGVaOwogICAgdGVbMTFdID0gMDsKICAgIHRlWzEyXSA9IDA7CiAgICB0ZVsxM10gPSAwOwogICAgdGVbMTRdID0gMDsKICAgIHRlWzE1XSA9IDE7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbWFrZVJvdGF0aW9uRnJvbUV1bGVyKGV1bGVyKSB7CiAgICBpZiAoIShldWxlciAmJiBldWxlci5pc0V1bGVyKSkgewogICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5NYXRyaXg0OiAubWFrZVJvdGF0aW9uRnJvbUV1bGVyKCkgbm93IGV4cGVjdHMgYSBFdWxlciByb3RhdGlvbiByYXRoZXIgdGhhbiBhIFZlY3RvcjMgYW5kIG9yZGVyLiIpOwogICAgfQogICAgY29uc3QgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgY29uc3QgeCA9IGV1bGVyLngsIHkgPSBldWxlci55LCB6ID0gZXVsZXIuejsKICAgIGNvbnN0IGEgPSBNYXRoLmNvcyh4KSwgYiA9IE1hdGguc2luKHgpOwogICAgY29uc3QgYyA9IE1hdGguY29zKHkpLCBkID0gTWF0aC5zaW4oeSk7CiAgICBjb25zdCBlID0gTWF0aC5jb3MoeiksIGYgPSBNYXRoLnNpbih6KTsKICAgIGlmIChldWxlci5vcmRlciA9PT0gIlhZWiIpIHsKICAgICAgY29uc3QgYWUgPSBhICogZSwgYWYgPSBhICogZiwgYmUgPSBiICogZSwgYmYgPSBiICogZjsKICAgICAgdGVbMF0gPSBjICogZTsKICAgICAgdGVbNF0gPSAtYyAqIGY7CiAgICAgIHRlWzhdID0gZDsKICAgICAgdGVbMV0gPSBhZiArIGJlICogZDsKICAgICAgdGVbNV0gPSBhZSAtIGJmICogZDsKICAgICAgdGVbOV0gPSAtYiAqIGM7CiAgICAgIHRlWzJdID0gYmYgLSBhZSAqIGQ7CiAgICAgIHRlWzZdID0gYmUgKyBhZiAqIGQ7CiAgICAgIHRlWzEwXSA9IGEgKiBjOwogICAgfSBlbHNlIGlmIChldWxlci5vcmRlciA9PT0gIllYWiIpIHsKICAgICAgY29uc3QgY2UgPSBjICogZSwgY2YgPSBjICogZiwgZGUgPSBkICogZSwgZGYgPSBkICogZjsKICAgICAgdGVbMF0gPSBjZSArIGRmICogYjsKICAgICAgdGVbNF0gPSBkZSAqIGIgLSBjZjsKICAgICAgdGVbOF0gPSBhICogZDsKICAgICAgdGVbMV0gPSBhICogZjsKICAgICAgdGVbNV0gPSBhICogZTsKICAgICAgdGVbOV0gPSAtYjsKICAgICAgdGVbMl0gPSBjZiAqIGIgLSBkZTsKICAgICAgdGVbNl0gPSBkZiArIGNlICogYjsKICAgICAgdGVbMTBdID0gYSAqIGM7CiAgICB9IGVsc2UgaWYgKGV1bGVyLm9yZGVyID09PSAiWlhZIikgewogICAgICBjb25zdCBjZSA9IGMgKiBlLCBjZiA9IGMgKiBmLCBkZSA9IGQgKiBlLCBkZiA9IGQgKiBmOwogICAgICB0ZVswXSA9IGNlIC0gZGYgKiBiOwogICAgICB0ZVs0XSA9IC1hICogZjsKICAgICAgdGVbOF0gPSBkZSArIGNmICogYjsKICAgICAgdGVbMV0gPSBjZiArIGRlICogYjsKICAgICAgdGVbNV0gPSBhICogZTsKICAgICAgdGVbOV0gPSBkZiAtIGNlICogYjsKICAgICAgdGVbMl0gPSAtYSAqIGQ7CiAgICAgIHRlWzZdID0gYjsKICAgICAgdGVbMTBdID0gYSAqIGM7CiAgICB9IGVsc2UgaWYgKGV1bGVyLm9yZGVyID09PSAiWllYIikgewogICAgICBjb25zdCBhZSA9IGEgKiBlLCBhZiA9IGEgKiBmLCBiZSA9IGIgKiBlLCBiZiA9IGIgKiBmOwogICAgICB0ZVswXSA9IGMgKiBlOwogICAgICB0ZVs0XSA9IGJlICogZCAtIGFmOwogICAgICB0ZVs4XSA9IGFlICogZCArIGJmOwogICAgICB0ZVsxXSA9IGMgKiBmOwogICAgICB0ZVs1XSA9IGJmICogZCArIGFlOwogICAgICB0ZVs5XSA9IGFmICogZCAtIGJlOwogICAgICB0ZVsyXSA9IC1kOwogICAgICB0ZVs2XSA9IGIgKiBjOwogICAgICB0ZVsxMF0gPSBhICogYzsKICAgIH0gZWxzZSBpZiAoZXVsZXIub3JkZXIgPT09ICJZWlgiKSB7CiAgICAgIGNvbnN0IGFjID0gYSAqIGMsIGFkID0gYSAqIGQsIGJjID0gYiAqIGMsIGJkID0gYiAqIGQ7CiAgICAgIHRlWzBdID0gYyAqIGU7CiAgICAgIHRlWzRdID0gYmQgLSBhYyAqIGY7CiAgICAgIHRlWzhdID0gYmMgKiBmICsgYWQ7CiAgICAgIHRlWzFdID0gZjsKICAgICAgdGVbNV0gPSBhICogZTsKICAgICAgdGVbOV0gPSAtYiAqIGU7CiAgICAgIHRlWzJdID0gLWQgKiBlOwogICAgICB0ZVs2XSA9IGFkICogZiArIGJjOwogICAgICB0ZVsxMF0gPSBhYyAtIGJkICogZjsKICAgIH0gZWxzZSBpZiAoZXVsZXIub3JkZXIgPT09ICJYWlkiKSB7CiAgICAgIGNvbnN0IGFjID0gYSAqIGMsIGFkID0gYSAqIGQsIGJjID0gYiAqIGMsIGJkID0gYiAqIGQ7CiAgICAgIHRlWzBdID0gYyAqIGU7CiAgICAgIHRlWzRdID0gLWY7CiAgICAgIHRlWzhdID0gZCAqIGU7CiAgICAgIHRlWzFdID0gYWMgKiBmICsgYmQ7CiAgICAgIHRlWzVdID0gYSAqIGU7CiAgICAgIHRlWzldID0gYWQgKiBmIC0gYmM7CiAgICAgIHRlWzJdID0gYmMgKiBmIC0gYWQ7CiAgICAgIHRlWzZdID0gYiAqIGU7CiAgICAgIHRlWzEwXSA9IGJkICogZiArIGFjOwogICAgfQogICAgdGVbM10gPSAwOwogICAgdGVbN10gPSAwOwogICAgdGVbMTFdID0gMDsKICAgIHRlWzEyXSA9IDA7CiAgICB0ZVsxM10gPSAwOwogICAgdGVbMTRdID0gMDsKICAgIHRlWzE1XSA9IDE7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbWFrZVJvdGF0aW9uRnJvbVF1YXRlcm5pb24ocSkgewogICAgcmV0dXJuIHRoaXMuY29tcG9zZShfemVybywgcSwgX29uZSk7CiAgfQogIGxvb2tBdChleWUsIHRhcmdldCwgdXApIHsKICAgIGNvbnN0IHRlID0gdGhpcy5lbGVtZW50czsKICAgIF96LnN1YlZlY3RvcnMoZXllLCB0YXJnZXQpOwogICAgaWYgKF96Lmxlbmd0aFNxKCkgPT09IDApIHsKICAgICAgX3oueiA9IDE7CiAgICB9CiAgICBfei5ub3JtYWxpemUoKTsKICAgIF94LmNyb3NzVmVjdG9ycyh1cCwgX3opOwogICAgaWYgKF94Lmxlbmd0aFNxKCkgPT09IDApIHsKICAgICAgaWYgKE1hdGguYWJzKHVwLnopID09PSAxKSB7CiAgICAgICAgX3oueCArPSAxZS00OwogICAgICB9IGVsc2UgewogICAgICAgIF96LnogKz0gMWUtNDsKICAgICAgfQogICAgICBfei5ub3JtYWxpemUoKTsKICAgICAgX3guY3Jvc3NWZWN0b3JzKHVwLCBfeik7CiAgICB9CiAgICBfeC5ub3JtYWxpemUoKTsKICAgIF95LmNyb3NzVmVjdG9ycyhfeiwgX3gpOwogICAgdGVbMF0gPSBfeC54OwogICAgdGVbNF0gPSBfeS54OwogICAgdGVbOF0gPSBfei54OwogICAgdGVbMV0gPSBfeC55OwogICAgdGVbNV0gPSBfeS55OwogICAgdGVbOV0gPSBfei55OwogICAgdGVbMl0gPSBfeC56OwogICAgdGVbNl0gPSBfeS56OwogICAgdGVbMTBdID0gX3ouejsKICAgIHJldHVybiB0aGlzOwogIH0KICBtdWx0aXBseShtLCBuKSB7CiAgICBpZiAobiAhPT0gdm9pZCAwKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuTWF0cml4NDogLm11bHRpcGx5KCkgbm93IG9ubHkgYWNjZXB0cyBvbmUgYXJndW1lbnQuIFVzZSAubXVsdGlwbHlNYXRyaWNlcyggYSwgYiApIGluc3RlYWQuIik7CiAgICAgIHJldHVybiB0aGlzLm11bHRpcGx5TWF0cmljZXMobSwgbik7CiAgICB9CiAgICByZXR1cm4gdGhpcy5tdWx0aXBseU1hdHJpY2VzKHRoaXMsIG0pOwogIH0KICBwcmVtdWx0aXBseShtKSB7CiAgICByZXR1cm4gdGhpcy5tdWx0aXBseU1hdHJpY2VzKG0sIHRoaXMpOwogIH0KICBtdWx0aXBseU1hdHJpY2VzKGEsIGIpIHsKICAgIGNvbnN0IGFlID0gYS5lbGVtZW50czsKICAgIGNvbnN0IGJlID0gYi5lbGVtZW50czsKICAgIGNvbnN0IHRlID0gdGhpcy5lbGVtZW50czsKICAgIGNvbnN0IGExMSA9IGFlWzBdLCBhMTIgPSBhZVs0XSwgYTEzID0gYWVbOF0sIGExNCA9IGFlWzEyXTsKICAgIGNvbnN0IGEyMSA9IGFlWzFdLCBhMjIgPSBhZVs1XSwgYTIzID0gYWVbOV0sIGEyNCA9IGFlWzEzXTsKICAgIGNvbnN0IGEzMSA9IGFlWzJdLCBhMzIgPSBhZVs2XSwgYTMzID0gYWVbMTBdLCBhMzQgPSBhZVsxNF07CiAgICBjb25zdCBhNDEgPSBhZVszXSwgYTQyID0gYWVbN10sIGE0MyA9IGFlWzExXSwgYTQ0ID0gYWVbMTVdOwogICAgY29uc3QgYjExID0gYmVbMF0sIGIxMiA9IGJlWzRdLCBiMTMgPSBiZVs4XSwgYjE0ID0gYmVbMTJdOwogICAgY29uc3QgYjIxID0gYmVbMV0sIGIyMiA9IGJlWzVdLCBiMjMgPSBiZVs5XSwgYjI0ID0gYmVbMTNdOwogICAgY29uc3QgYjMxID0gYmVbMl0sIGIzMiA9IGJlWzZdLCBiMzMgPSBiZVsxMF0sIGIzNCA9IGJlWzE0XTsKICAgIGNvbnN0IGI0MSA9IGJlWzNdLCBiNDIgPSBiZVs3XSwgYjQzID0gYmVbMTFdLCBiNDQgPSBiZVsxNV07CiAgICB0ZVswXSA9IGExMSAqIGIxMSArIGExMiAqIGIyMSArIGExMyAqIGIzMSArIGExNCAqIGI0MTsKICAgIHRlWzRdID0gYTExICogYjEyICsgYTEyICogYjIyICsgYTEzICogYjMyICsgYTE0ICogYjQyOwogICAgdGVbOF0gPSBhMTEgKiBiMTMgKyBhMTIgKiBiMjMgKyBhMTMgKiBiMzMgKyBhMTQgKiBiNDM7CiAgICB0ZVsxMl0gPSBhMTEgKiBiMTQgKyBhMTIgKiBiMjQgKyBhMTMgKiBiMzQgKyBhMTQgKiBiNDQ7CiAgICB0ZVsxXSA9IGEyMSAqIGIxMSArIGEyMiAqIGIyMSArIGEyMyAqIGIzMSArIGEyNCAqIGI0MTsKICAgIHRlWzVdID0gYTIxICogYjEyICsgYTIyICogYjIyICsgYTIzICogYjMyICsgYTI0ICogYjQyOwogICAgdGVbOV0gPSBhMjEgKiBiMTMgKyBhMjIgKiBiMjMgKyBhMjMgKiBiMzMgKyBhMjQgKiBiNDM7CiAgICB0ZVsxM10gPSBhMjEgKiBiMTQgKyBhMjIgKiBiMjQgKyBhMjMgKiBiMzQgKyBhMjQgKiBiNDQ7CiAgICB0ZVsyXSA9IGEzMSAqIGIxMSArIGEzMiAqIGIyMSArIGEzMyAqIGIzMSArIGEzNCAqIGI0MTsKICAgIHRlWzZdID0gYTMxICogYjEyICsgYTMyICogYjIyICsgYTMzICogYjMyICsgYTM0ICogYjQyOwogICAgdGVbMTBdID0gYTMxICogYjEzICsgYTMyICogYjIzICsgYTMzICogYjMzICsgYTM0ICogYjQzOwogICAgdGVbMTRdID0gYTMxICogYjE0ICsgYTMyICogYjI0ICsgYTMzICogYjM0ICsgYTM0ICogYjQ0OwogICAgdGVbM10gPSBhNDEgKiBiMTEgKyBhNDIgKiBiMjEgKyBhNDMgKiBiMzEgKyBhNDQgKiBiNDE7CiAgICB0ZVs3XSA9IGE0MSAqIGIxMiArIGE0MiAqIGIyMiArIGE0MyAqIGIzMiArIGE0NCAqIGI0MjsKICAgIHRlWzExXSA9IGE0MSAqIGIxMyArIGE0MiAqIGIyMyArIGE0MyAqIGIzMyArIGE0NCAqIGI0MzsKICAgIHRlWzE1XSA9IGE0MSAqIGIxNCArIGE0MiAqIGIyNCArIGE0MyAqIGIzNCArIGE0NCAqIGI0NDsKICAgIHJldHVybiB0aGlzOwogIH0KICBtdWx0aXBseVNjYWxhcihzKSB7CiAgICBjb25zdCB0ZSA9IHRoaXMuZWxlbWVudHM7CiAgICB0ZVswXSAqPSBzOwogICAgdGVbNF0gKj0gczsKICAgIHRlWzhdICo9IHM7CiAgICB0ZVsxMl0gKj0gczsKICAgIHRlWzFdICo9IHM7CiAgICB0ZVs1XSAqPSBzOwogICAgdGVbOV0gKj0gczsKICAgIHRlWzEzXSAqPSBzOwogICAgdGVbMl0gKj0gczsKICAgIHRlWzZdICo9IHM7CiAgICB0ZVsxMF0gKj0gczsKICAgIHRlWzE0XSAqPSBzOwogICAgdGVbM10gKj0gczsKICAgIHRlWzddICo9IHM7CiAgICB0ZVsxMV0gKj0gczsKICAgIHRlWzE1XSAqPSBzOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGRldGVybWluYW50KCkgewogICAgY29uc3QgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgY29uc3QgbjExID0gdGVbMF0sIG4xMiA9IHRlWzRdLCBuMTMgPSB0ZVs4XSwgbjE0ID0gdGVbMTJdOwogICAgY29uc3QgbjIxID0gdGVbMV0sIG4yMiA9IHRlWzVdLCBuMjMgPSB0ZVs5XSwgbjI0ID0gdGVbMTNdOwogICAgY29uc3QgbjMxID0gdGVbMl0sIG4zMiA9IHRlWzZdLCBuMzMgPSB0ZVsxMF0sIG4zNCA9IHRlWzE0XTsKICAgIGNvbnN0IG40MSA9IHRlWzNdLCBuNDIgPSB0ZVs3XSwgbjQzID0gdGVbMTFdLCBuNDQgPSB0ZVsxNV07CiAgICByZXR1cm4gbjQxICogKCtuMTQgKiBuMjMgKiBuMzIgLSBuMTMgKiBuMjQgKiBuMzIgLSBuMTQgKiBuMjIgKiBuMzMgKyBuMTIgKiBuMjQgKiBuMzMgKyBuMTMgKiBuMjIgKiBuMzQgLSBuMTIgKiBuMjMgKiBuMzQpICsgbjQyICogKCtuMTEgKiBuMjMgKiBuMzQgLSBuMTEgKiBuMjQgKiBuMzMgKyBuMTQgKiBuMjEgKiBuMzMgLSBuMTMgKiBuMjEgKiBuMzQgKyBuMTMgKiBuMjQgKiBuMzEgLSBuMTQgKiBuMjMgKiBuMzEpICsgbjQzICogKCtuMTEgKiBuMjQgKiBuMzIgLSBuMTEgKiBuMjIgKiBuMzQgLSBuMTQgKiBuMjEgKiBuMzIgKyBuMTIgKiBuMjEgKiBuMzQgKyBuMTQgKiBuMjIgKiBuMzEgLSBuMTIgKiBuMjQgKiBuMzEpICsgbjQ0ICogKC1uMTMgKiBuMjIgKiBuMzEgLSBuMTEgKiBuMjMgKiBuMzIgKyBuMTEgKiBuMjIgKiBuMzMgKyBuMTMgKiBuMjEgKiBuMzIgLSBuMTIgKiBuMjEgKiBuMzMgKyBuMTIgKiBuMjMgKiBuMzEpOwogIH0KICB0cmFuc3Bvc2UoKSB7CiAgICBjb25zdCB0ZSA9IHRoaXMuZWxlbWVudHM7CiAgICBsZXQgdG1wMjsKICAgIHRtcDIgPSB0ZVsxXTsKICAgIHRlWzFdID0gdGVbNF07CiAgICB0ZVs0XSA9IHRtcDI7CiAgICB0bXAyID0gdGVbMl07CiAgICB0ZVsyXSA9IHRlWzhdOwogICAgdGVbOF0gPSB0bXAyOwogICAgdG1wMiA9IHRlWzZdOwogICAgdGVbNl0gPSB0ZVs5XTsKICAgIHRlWzldID0gdG1wMjsKICAgIHRtcDIgPSB0ZVszXTsKICAgIHRlWzNdID0gdGVbMTJdOwogICAgdGVbMTJdID0gdG1wMjsKICAgIHRtcDIgPSB0ZVs3XTsKICAgIHRlWzddID0gdGVbMTNdOwogICAgdGVbMTNdID0gdG1wMjsKICAgIHRtcDIgPSB0ZVsxMV07CiAgICB0ZVsxMV0gPSB0ZVsxNF07CiAgICB0ZVsxNF0gPSB0bXAyOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldFBvc2l0aW9uKHgsIHksIHopIHsKICAgIGNvbnN0IHRlID0gdGhpcy5lbGVtZW50czsKICAgIGlmICh4LmlzVmVjdG9yMykgewogICAgICB0ZVsxMl0gPSB4Lng7CiAgICAgIHRlWzEzXSA9IHgueTsKICAgICAgdGVbMTRdID0geC56OwogICAgfSBlbHNlIHsKICAgICAgdGVbMTJdID0geDsKICAgICAgdGVbMTNdID0geTsKICAgICAgdGVbMTRdID0gejsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBpbnZlcnQoKSB7CiAgICBjb25zdCB0ZSA9IHRoaXMuZWxlbWVudHMsIG4xMSA9IHRlWzBdLCBuMjEgPSB0ZVsxXSwgbjMxID0gdGVbMl0sIG40MSA9IHRlWzNdLCBuMTIgPSB0ZVs0XSwgbjIyID0gdGVbNV0sIG4zMiA9IHRlWzZdLCBuNDIgPSB0ZVs3XSwgbjEzID0gdGVbOF0sIG4yMyA9IHRlWzldLCBuMzMgPSB0ZVsxMF0sIG40MyA9IHRlWzExXSwgbjE0ID0gdGVbMTJdLCBuMjQgPSB0ZVsxM10sIG4zNCA9IHRlWzE0XSwgbjQ0ID0gdGVbMTVdLCB0MTEgPSBuMjMgKiBuMzQgKiBuNDIgLSBuMjQgKiBuMzMgKiBuNDIgKyBuMjQgKiBuMzIgKiBuNDMgLSBuMjIgKiBuMzQgKiBuNDMgLSBuMjMgKiBuMzIgKiBuNDQgKyBuMjIgKiBuMzMgKiBuNDQsIHQxMiA9IG4xNCAqIG4zMyAqIG40MiAtIG4xMyAqIG4zNCAqIG40MiAtIG4xNCAqIG4zMiAqIG40MyArIG4xMiAqIG4zNCAqIG40MyArIG4xMyAqIG4zMiAqIG40NCAtIG4xMiAqIG4zMyAqIG40NCwgdDEzID0gbjEzICogbjI0ICogbjQyIC0gbjE0ICogbjIzICogbjQyICsgbjE0ICogbjIyICogbjQzIC0gbjEyICogbjI0ICogbjQzIC0gbjEzICogbjIyICogbjQ0ICsgbjEyICogbjIzICogbjQ0LCB0MTQgPSBuMTQgKiBuMjMgKiBuMzIgLSBuMTMgKiBuMjQgKiBuMzIgLSBuMTQgKiBuMjIgKiBuMzMgKyBuMTIgKiBuMjQgKiBuMzMgKyBuMTMgKiBuMjIgKiBuMzQgLSBuMTIgKiBuMjMgKiBuMzQ7CiAgICBjb25zdCBkZXQgPSBuMTEgKiB0MTEgKyBuMjEgKiB0MTIgKyBuMzEgKiB0MTMgKyBuNDEgKiB0MTQ7CiAgICBpZiAoZGV0ID09PSAwKQogICAgICByZXR1cm4gdGhpcy5zZXQoMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCk7CiAgICBjb25zdCBkZXRJbnYgPSAxIC8gZGV0OwogICAgdGVbMF0gPSB0MTEgKiBkZXRJbnY7CiAgICB0ZVsxXSA9IChuMjQgKiBuMzMgKiBuNDEgLSBuMjMgKiBuMzQgKiBuNDEgLSBuMjQgKiBuMzEgKiBuNDMgKyBuMjEgKiBuMzQgKiBuNDMgKyBuMjMgKiBuMzEgKiBuNDQgLSBuMjEgKiBuMzMgKiBuNDQpICogZGV0SW52OwogICAgdGVbMl0gPSAobjIyICogbjM0ICogbjQxIC0gbjI0ICogbjMyICogbjQxICsgbjI0ICogbjMxICogbjQyIC0gbjIxICogbjM0ICogbjQyIC0gbjIyICogbjMxICogbjQ0ICsgbjIxICogbjMyICogbjQ0KSAqIGRldEludjsKICAgIHRlWzNdID0gKG4yMyAqIG4zMiAqIG40MSAtIG4yMiAqIG4zMyAqIG40MSAtIG4yMyAqIG4zMSAqIG40MiArIG4yMSAqIG4zMyAqIG40MiArIG4yMiAqIG4zMSAqIG40MyAtIG4yMSAqIG4zMiAqIG40MykgKiBkZXRJbnY7CiAgICB0ZVs0XSA9IHQxMiAqIGRldEludjsKICAgIHRlWzVdID0gKG4xMyAqIG4zNCAqIG40MSAtIG4xNCAqIG4zMyAqIG40MSArIG4xNCAqIG4zMSAqIG40MyAtIG4xMSAqIG4zNCAqIG40MyAtIG4xMyAqIG4zMSAqIG40NCArIG4xMSAqIG4zMyAqIG40NCkgKiBkZXRJbnY7CiAgICB0ZVs2XSA9IChuMTQgKiBuMzIgKiBuNDEgLSBuMTIgKiBuMzQgKiBuNDEgLSBuMTQgKiBuMzEgKiBuNDIgKyBuMTEgKiBuMzQgKiBuNDIgKyBuMTIgKiBuMzEgKiBuNDQgLSBuMTEgKiBuMzIgKiBuNDQpICogZGV0SW52OwogICAgdGVbN10gPSAobjEyICogbjMzICogbjQxIC0gbjEzICogbjMyICogbjQxICsgbjEzICogbjMxICogbjQyIC0gbjExICogbjMzICogbjQyIC0gbjEyICogbjMxICogbjQzICsgbjExICogbjMyICogbjQzKSAqIGRldEludjsKICAgIHRlWzhdID0gdDEzICogZGV0SW52OwogICAgdGVbOV0gPSAobjE0ICogbjIzICogbjQxIC0gbjEzICogbjI0ICogbjQxIC0gbjE0ICogbjIxICogbjQzICsgbjExICogbjI0ICogbjQzICsgbjEzICogbjIxICogbjQ0IC0gbjExICogbjIzICogbjQ0KSAqIGRldEludjsKICAgIHRlWzEwXSA9IChuMTIgKiBuMjQgKiBuNDEgLSBuMTQgKiBuMjIgKiBuNDEgKyBuMTQgKiBuMjEgKiBuNDIgLSBuMTEgKiBuMjQgKiBuNDIgLSBuMTIgKiBuMjEgKiBuNDQgKyBuMTEgKiBuMjIgKiBuNDQpICogZGV0SW52OwogICAgdGVbMTFdID0gKG4xMyAqIG4yMiAqIG40MSAtIG4xMiAqIG4yMyAqIG40MSAtIG4xMyAqIG4yMSAqIG40MiArIG4xMSAqIG4yMyAqIG40MiArIG4xMiAqIG4yMSAqIG40MyAtIG4xMSAqIG4yMiAqIG40MykgKiBkZXRJbnY7CiAgICB0ZVsxMl0gPSB0MTQgKiBkZXRJbnY7CiAgICB0ZVsxM10gPSAobjEzICogbjI0ICogbjMxIC0gbjE0ICogbjIzICogbjMxICsgbjE0ICogbjIxICogbjMzIC0gbjExICogbjI0ICogbjMzIC0gbjEzICogbjIxICogbjM0ICsgbjExICogbjIzICogbjM0KSAqIGRldEludjsKICAgIHRlWzE0XSA9IChuMTQgKiBuMjIgKiBuMzEgLSBuMTIgKiBuMjQgKiBuMzEgLSBuMTQgKiBuMjEgKiBuMzIgKyBuMTEgKiBuMjQgKiBuMzIgKyBuMTIgKiBuMjEgKiBuMzQgLSBuMTEgKiBuMjIgKiBuMzQpICogZGV0SW52OwogICAgdGVbMTVdID0gKG4xMiAqIG4yMyAqIG4zMSAtIG4xMyAqIG4yMiAqIG4zMSArIG4xMyAqIG4yMSAqIG4zMiAtIG4xMSAqIG4yMyAqIG4zMiAtIG4xMiAqIG4yMSAqIG4zMyArIG4xMSAqIG4yMiAqIG4zMykgKiBkZXRJbnY7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2NhbGUodikgewogICAgY29uc3QgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgY29uc3QgeCA9IHYueCwgeSA9IHYueSwgeiA9IHYuejsKICAgIHRlWzBdICo9IHg7CiAgICB0ZVs0XSAqPSB5OwogICAgdGVbOF0gKj0gejsKICAgIHRlWzFdICo9IHg7CiAgICB0ZVs1XSAqPSB5OwogICAgdGVbOV0gKj0gejsKICAgIHRlWzJdICo9IHg7CiAgICB0ZVs2XSAqPSB5OwogICAgdGVbMTBdICo9IHo7CiAgICB0ZVszXSAqPSB4OwogICAgdGVbN10gKj0geTsKICAgIHRlWzExXSAqPSB6OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGdldE1heFNjYWxlT25BeGlzKCkgewogICAgY29uc3QgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgY29uc3Qgc2NhbGVYU3EgPSB0ZVswXSAqIHRlWzBdICsgdGVbMV0gKiB0ZVsxXSArIHRlWzJdICogdGVbMl07CiAgICBjb25zdCBzY2FsZVlTcSA9IHRlWzRdICogdGVbNF0gKyB0ZVs1XSAqIHRlWzVdICsgdGVbNl0gKiB0ZVs2XTsKICAgIGNvbnN0IHNjYWxlWlNxID0gdGVbOF0gKiB0ZVs4XSArIHRlWzldICogdGVbOV0gKyB0ZVsxMF0gKiB0ZVsxMF07CiAgICByZXR1cm4gTWF0aC5zcXJ0KE1hdGgubWF4KHNjYWxlWFNxLCBzY2FsZVlTcSwgc2NhbGVaU3EpKTsKICB9CiAgbWFrZVRyYW5zbGF0aW9uKHgsIHksIHopIHsKICAgIHRoaXMuc2V0KDEsIDAsIDAsIHgsIDAsIDEsIDAsIHksIDAsIDAsIDEsIHosIDAsIDAsIDAsIDEpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG1ha2VSb3RhdGlvblgodGhldGEpIHsKICAgIGNvbnN0IGMgPSBNYXRoLmNvcyh0aGV0YSksIHMgPSBNYXRoLnNpbih0aGV0YSk7CiAgICB0aGlzLnNldCgxLCAwLCAwLCAwLCAwLCBjLCAtcywgMCwgMCwgcywgYywgMCwgMCwgMCwgMCwgMSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbWFrZVJvdGF0aW9uWSh0aGV0YSkgewogICAgY29uc3QgYyA9IE1hdGguY29zKHRoZXRhKSwgcyA9IE1hdGguc2luKHRoZXRhKTsKICAgIHRoaXMuc2V0KGMsIDAsIHMsIDAsIDAsIDEsIDAsIDAsIC1zLCAwLCBjLCAwLCAwLCAwLCAwLCAxKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBtYWtlUm90YXRpb25aKHRoZXRhKSB7CiAgICBjb25zdCBjID0gTWF0aC5jb3ModGhldGEpLCBzID0gTWF0aC5zaW4odGhldGEpOwogICAgdGhpcy5zZXQoYywgLXMsIDAsIDAsIHMsIGMsIDAsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDAsIDEpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG1ha2VSb3RhdGlvbkF4aXMoYXhpcywgYW5nbGUpIHsKICAgIGNvbnN0IGMgPSBNYXRoLmNvcyhhbmdsZSk7CiAgICBjb25zdCBzID0gTWF0aC5zaW4oYW5nbGUpOwogICAgY29uc3QgdCA9IDEgLSBjOwogICAgY29uc3QgeCA9IGF4aXMueCwgeSA9IGF4aXMueSwgeiA9IGF4aXMuejsKICAgIGNvbnN0IHR4ID0gdCAqIHgsIHR5ID0gdCAqIHk7CiAgICB0aGlzLnNldCh0eCAqIHggKyBjLCB0eCAqIHkgLSBzICogeiwgdHggKiB6ICsgcyAqIHksIDAsIHR4ICogeSArIHMgKiB6LCB0eSAqIHkgKyBjLCB0eSAqIHogLSBzICogeCwgMCwgdHggKiB6IC0gcyAqIHksIHR5ICogeiArIHMgKiB4LCB0ICogeiAqIHogKyBjLCAwLCAwLCAwLCAwLCAxKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBtYWtlU2NhbGUoeCwgeSwgeikgewogICAgdGhpcy5zZXQoeCwgMCwgMCwgMCwgMCwgeSwgMCwgMCwgMCwgMCwgeiwgMCwgMCwgMCwgMCwgMSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbWFrZVNoZWFyKHh5LCB4eiwgeXgsIHl6LCB6eCwgenkpIHsKICAgIHRoaXMuc2V0KDEsIHl4LCB6eCwgMCwgeHksIDEsIHp5LCAwLCB4eiwgeXosIDEsIDAsIDAsIDAsIDAsIDEpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNvbXBvc2UocG9zaXRpb24sIHF1YXRlcm5pb24sIHNjYWxlKSB7CiAgICBjb25zdCB0ZSA9IHRoaXMuZWxlbWVudHM7CiAgICBjb25zdCB4ID0gcXVhdGVybmlvbi5feCwgeSA9IHF1YXRlcm5pb24uX3ksIHogPSBxdWF0ZXJuaW9uLl96LCB3ID0gcXVhdGVybmlvbi5fdzsKICAgIGNvbnN0IHgyID0geCArIHgsIHkyID0geSArIHksIHoyID0geiArIHo7CiAgICBjb25zdCB4eCA9IHggKiB4MiwgeHkgPSB4ICogeTIsIHh6ID0geCAqIHoyOwogICAgY29uc3QgeXkgPSB5ICogeTIsIHl6ID0geSAqIHoyLCB6eiA9IHogKiB6MjsKICAgIGNvbnN0IHd4ID0gdyAqIHgyLCB3eSA9IHcgKiB5Miwgd3ogPSB3ICogejI7CiAgICBjb25zdCBzeCA9IHNjYWxlLngsIHN5ID0gc2NhbGUueSwgc3ogPSBzY2FsZS56OwogICAgdGVbMF0gPSAoMSAtICh5eSArIHp6KSkgKiBzeDsKICAgIHRlWzFdID0gKHh5ICsgd3opICogc3g7CiAgICB0ZVsyXSA9ICh4eiAtIHd5KSAqIHN4OwogICAgdGVbM10gPSAwOwogICAgdGVbNF0gPSAoeHkgLSB3eikgKiBzeTsKICAgIHRlWzVdID0gKDEgLSAoeHggKyB6eikpICogc3k7CiAgICB0ZVs2XSA9ICh5eiArIHd4KSAqIHN5OwogICAgdGVbN10gPSAwOwogICAgdGVbOF0gPSAoeHogKyB3eSkgKiBzejsKICAgIHRlWzldID0gKHl6IC0gd3gpICogc3o7CiAgICB0ZVsxMF0gPSAoMSAtICh4eCArIHl5KSkgKiBzejsKICAgIHRlWzExXSA9IDA7CiAgICB0ZVsxMl0gPSBwb3NpdGlvbi54OwogICAgdGVbMTNdID0gcG9zaXRpb24ueTsKICAgIHRlWzE0XSA9IHBvc2l0aW9uLno7CiAgICB0ZVsxNV0gPSAxOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGRlY29tcG9zZShwb3NpdGlvbiwgcXVhdGVybmlvbiwgc2NhbGUpIHsKICAgIGNvbnN0IHRlID0gdGhpcy5lbGVtZW50czsKICAgIGxldCBzeCA9IF92MSQ1LnNldCh0ZVswXSwgdGVbMV0sIHRlWzJdKS5sZW5ndGgoKTsKICAgIGNvbnN0IHN5ID0gX3YxJDUuc2V0KHRlWzRdLCB0ZVs1XSwgdGVbNl0pLmxlbmd0aCgpOwogICAgY29uc3Qgc3ogPSBfdjEkNS5zZXQodGVbOF0sIHRlWzldLCB0ZVsxMF0pLmxlbmd0aCgpOwogICAgY29uc3QgZGV0ID0gdGhpcy5kZXRlcm1pbmFudCgpOwogICAgaWYgKGRldCA8IDApCiAgICAgIHN4ID0gLXN4OwogICAgcG9zaXRpb24ueCA9IHRlWzEyXTsKICAgIHBvc2l0aW9uLnkgPSB0ZVsxM107CiAgICBwb3NpdGlvbi56ID0gdGVbMTRdOwogICAgX20xJDIuY29weSh0aGlzKTsKICAgIGNvbnN0IGludlNYID0gMSAvIHN4OwogICAgY29uc3QgaW52U1kgPSAxIC8gc3k7CiAgICBjb25zdCBpbnZTWiA9IDEgLyBzejsKICAgIF9tMSQyLmVsZW1lbnRzWzBdICo9IGludlNYOwogICAgX20xJDIuZWxlbWVudHNbMV0gKj0gaW52U1g7CiAgICBfbTEkMi5lbGVtZW50c1syXSAqPSBpbnZTWDsKICAgIF9tMSQyLmVsZW1lbnRzWzRdICo9IGludlNZOwogICAgX20xJDIuZWxlbWVudHNbNV0gKj0gaW52U1k7CiAgICBfbTEkMi5lbGVtZW50c1s2XSAqPSBpbnZTWTsKICAgIF9tMSQyLmVsZW1lbnRzWzhdICo9IGludlNaOwogICAgX20xJDIuZWxlbWVudHNbOV0gKj0gaW52U1o7CiAgICBfbTEkMi5lbGVtZW50c1sxMF0gKj0gaW52U1o7CiAgICBxdWF0ZXJuaW9uLnNldEZyb21Sb3RhdGlvbk1hdHJpeChfbTEkMik7CiAgICBzY2FsZS54ID0gc3g7CiAgICBzY2FsZS55ID0gc3k7CiAgICBzY2FsZS56ID0gc3o7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbWFrZVBlcnNwZWN0aXZlKGxlZnQsIHJpZ2h0LCB0b3AsIGJvdHRvbSwgbmVhciwgZmFyKSB7CiAgICBpZiAoZmFyID09PSB2b2lkIDApIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5NYXRyaXg0OiAubWFrZVBlcnNwZWN0aXZlKCkgaGFzIGJlZW4gcmVkZWZpbmVkIGFuZCBoYXMgYSBuZXcgc2lnbmF0dXJlLiBQbGVhc2UgY2hlY2sgdGhlIGRvY3MuIik7CiAgICB9CiAgICBjb25zdCB0ZSA9IHRoaXMuZWxlbWVudHM7CiAgICBjb25zdCB4ID0gMiAqIG5lYXIgLyAocmlnaHQgLSBsZWZ0KTsKICAgIGNvbnN0IHkgPSAyICogbmVhciAvICh0b3AgLSBib3R0b20pOwogICAgY29uc3QgYSA9IChyaWdodCArIGxlZnQpIC8gKHJpZ2h0IC0gbGVmdCk7CiAgICBjb25zdCBiID0gKHRvcCArIGJvdHRvbSkgLyAodG9wIC0gYm90dG9tKTsKICAgIGNvbnN0IGMgPSAtKGZhciArIG5lYXIpIC8gKGZhciAtIG5lYXIpOwogICAgY29uc3QgZCA9IC0yICogZmFyICogbmVhciAvIChmYXIgLSBuZWFyKTsKICAgIHRlWzBdID0geDsKICAgIHRlWzRdID0gMDsKICAgIHRlWzhdID0gYTsKICAgIHRlWzEyXSA9IDA7CiAgICB0ZVsxXSA9IDA7CiAgICB0ZVs1XSA9IHk7CiAgICB0ZVs5XSA9IGI7CiAgICB0ZVsxM10gPSAwOwogICAgdGVbMl0gPSAwOwogICAgdGVbNl0gPSAwOwogICAgdGVbMTBdID0gYzsKICAgIHRlWzE0XSA9IGQ7CiAgICB0ZVszXSA9IDA7CiAgICB0ZVs3XSA9IDA7CiAgICB0ZVsxMV0gPSAtMTsKICAgIHRlWzE1XSA9IDA7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbWFrZU9ydGhvZ3JhcGhpYyhsZWZ0LCByaWdodCwgdG9wLCBib3R0b20sIG5lYXIsIGZhcikgewogICAgY29uc3QgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgY29uc3QgdyA9IDEgLyAocmlnaHQgLSBsZWZ0KTsKICAgIGNvbnN0IGggPSAxIC8gKHRvcCAtIGJvdHRvbSk7CiAgICBjb25zdCBwID0gMSAvIChmYXIgLSBuZWFyKTsKICAgIGNvbnN0IHggPSAocmlnaHQgKyBsZWZ0KSAqIHc7CiAgICBjb25zdCB5ID0gKHRvcCArIGJvdHRvbSkgKiBoOwogICAgY29uc3QgeiA9IChmYXIgKyBuZWFyKSAqIHA7CiAgICB0ZVswXSA9IDIgKiB3OwogICAgdGVbNF0gPSAwOwogICAgdGVbOF0gPSAwOwogICAgdGVbMTJdID0gLXg7CiAgICB0ZVsxXSA9IDA7CiAgICB0ZVs1XSA9IDIgKiBoOwogICAgdGVbOV0gPSAwOwogICAgdGVbMTNdID0gLXk7CiAgICB0ZVsyXSA9IDA7CiAgICB0ZVs2XSA9IDA7CiAgICB0ZVsxMF0gPSAtMiAqIHA7CiAgICB0ZVsxNF0gPSAtejsKICAgIHRlWzNdID0gMDsKICAgIHRlWzddID0gMDsKICAgIHRlWzExXSA9IDA7CiAgICB0ZVsxNV0gPSAxOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGVxdWFscyhtYXRyaXgpIHsKICAgIGNvbnN0IHRlID0gdGhpcy5lbGVtZW50czsKICAgIGNvbnN0IG1lID0gbWF0cml4LmVsZW1lbnRzOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrKSB7CiAgICAgIGlmICh0ZVtpXSAhPT0gbWVbaV0pCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgcmV0dXJuIHRydWU7CiAgfQogIGZyb21BcnJheShhcnJheSwgb2Zmc2V0ID0gMCkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrKSB7CiAgICAgIHRoaXMuZWxlbWVudHNbaV0gPSBhcnJheVtpICsgb2Zmc2V0XTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICB0b0FycmF5KGFycmF5ID0gW10sIG9mZnNldCA9IDApIHsKICAgIGNvbnN0IHRlID0gdGhpcy5lbGVtZW50czsKICAgIGFycmF5W29mZnNldF0gPSB0ZVswXTsKICAgIGFycmF5W29mZnNldCArIDFdID0gdGVbMV07CiAgICBhcnJheVtvZmZzZXQgKyAyXSA9IHRlWzJdOwogICAgYXJyYXlbb2Zmc2V0ICsgM10gPSB0ZVszXTsKICAgIGFycmF5W29mZnNldCArIDRdID0gdGVbNF07CiAgICBhcnJheVtvZmZzZXQgKyA1XSA9IHRlWzVdOwogICAgYXJyYXlbb2Zmc2V0ICsgNl0gPSB0ZVs2XTsKICAgIGFycmF5W29mZnNldCArIDddID0gdGVbN107CiAgICBhcnJheVtvZmZzZXQgKyA4XSA9IHRlWzhdOwogICAgYXJyYXlbb2Zmc2V0ICsgOV0gPSB0ZVs5XTsKICAgIGFycmF5W29mZnNldCArIDEwXSA9IHRlWzEwXTsKICAgIGFycmF5W29mZnNldCArIDExXSA9IHRlWzExXTsKICAgIGFycmF5W29mZnNldCArIDEyXSA9IHRlWzEyXTsKICAgIGFycmF5W29mZnNldCArIDEzXSA9IHRlWzEzXTsKICAgIGFycmF5W29mZnNldCArIDE0XSA9IHRlWzE0XTsKICAgIGFycmF5W29mZnNldCArIDE1XSA9IHRlWzE1XTsKICAgIHJldHVybiBhcnJheTsKICB9Cn0KTWF0cml4NC5wcm90b3R5cGUuaXNNYXRyaXg0ID0gdHJ1ZTsKY29uc3QgX3YxJDUgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX20xJDIgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hdHJpeDQoKTsKY29uc3QgX3plcm8gPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoMCwgMCwgMCk7CmNvbnN0IF9vbmUgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoMSwgMSwgMSk7CmNvbnN0IF94ID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF95ID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF96ID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF9tYXRyaXgkMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWF0cml4NCgpOwpjb25zdCBfcXVhdGVybmlvbiQzID0gLyogQF9fUFVSRV9fICovIG5ldyBRdWF0ZXJuaW9uKCk7CmNsYXNzIEV1bGVyIHsKICBjb25zdHJ1Y3Rvcih4ID0gMCwgeSA9IDAsIHogPSAwLCBvcmRlciA9IEV1bGVyLkRlZmF1bHRPcmRlcikgewogICAgdGhpcy5feCA9IHg7CiAgICB0aGlzLl95ID0geTsKICAgIHRoaXMuX3ogPSB6OwogICAgdGhpcy5fb3JkZXIgPSBvcmRlcjsKICB9CiAgZ2V0IHgoKSB7CiAgICByZXR1cm4gdGhpcy5feDsKICB9CiAgc2V0IHgodmFsdWUpIHsKICAgIHRoaXMuX3ggPSB2YWx1ZTsKICAgIHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKTsKICB9CiAgZ2V0IHkoKSB7CiAgICByZXR1cm4gdGhpcy5feTsKICB9CiAgc2V0IHkodmFsdWUpIHsKICAgIHRoaXMuX3kgPSB2YWx1ZTsKICAgIHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKTsKICB9CiAgZ2V0IHooKSB7CiAgICByZXR1cm4gdGhpcy5fejsKICB9CiAgc2V0IHoodmFsdWUpIHsKICAgIHRoaXMuX3ogPSB2YWx1ZTsKICAgIHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKTsKICB9CiAgZ2V0IG9yZGVyKCkgewogICAgcmV0dXJuIHRoaXMuX29yZGVyOwogIH0KICBzZXQgb3JkZXIodmFsdWUpIHsKICAgIHRoaXMuX29yZGVyID0gdmFsdWU7CiAgICB0aGlzLl9vbkNoYW5nZUNhbGxiYWNrKCk7CiAgfQogIHNldCh4LCB5LCB6LCBvcmRlciA9IHRoaXMuX29yZGVyKSB7CiAgICB0aGlzLl94ID0geDsKICAgIHRoaXMuX3kgPSB5OwogICAgdGhpcy5feiA9IHo7CiAgICB0aGlzLl9vcmRlciA9IG9yZGVyOwogICAgdGhpcy5fb25DaGFuZ2VDYWxsYmFjaygpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuX3gsIHRoaXMuX3ksIHRoaXMuX3osIHRoaXMuX29yZGVyKTsKICB9CiAgY29weShldWxlcikgewogICAgdGhpcy5feCA9IGV1bGVyLl94OwogICAgdGhpcy5feSA9IGV1bGVyLl95OwogICAgdGhpcy5feiA9IGV1bGVyLl96OwogICAgdGhpcy5fb3JkZXIgPSBldWxlci5fb3JkZXI7CiAgICB0aGlzLl9vbkNoYW5nZUNhbGxiYWNrKCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0RnJvbVJvdGF0aW9uTWF0cml4KG0sIG9yZGVyID0gdGhpcy5fb3JkZXIsIHVwZGF0ZSA9IHRydWUpIHsKICAgIGNvbnN0IHRlID0gbS5lbGVtZW50czsKICAgIGNvbnN0IG0xMSA9IHRlWzBdLCBtMTIgPSB0ZVs0XSwgbTEzID0gdGVbOF07CiAgICBjb25zdCBtMjEgPSB0ZVsxXSwgbTIyID0gdGVbNV0sIG0yMyA9IHRlWzldOwogICAgY29uc3QgbTMxID0gdGVbMl0sIG0zMiA9IHRlWzZdLCBtMzMgPSB0ZVsxMF07CiAgICBzd2l0Y2ggKG9yZGVyKSB7CiAgICAgIGNhc2UgIlhZWiI6CiAgICAgICAgdGhpcy5feSA9IE1hdGguYXNpbihjbGFtcChtMTMsIC0xLCAxKSk7CiAgICAgICAgaWYgKE1hdGguYWJzKG0xMykgPCAwLjk5OTk5OTkpIHsKICAgICAgICAgIHRoaXMuX3ggPSBNYXRoLmF0YW4yKC1tMjMsIG0zMyk7CiAgICAgICAgICB0aGlzLl96ID0gTWF0aC5hdGFuMigtbTEyLCBtMTEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLl94ID0gTWF0aC5hdGFuMihtMzIsIG0yMik7CiAgICAgICAgICB0aGlzLl96ID0gMDsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIllYWiI6CiAgICAgICAgdGhpcy5feCA9IE1hdGguYXNpbigtY2xhbXAobTIzLCAtMSwgMSkpOwogICAgICAgIGlmIChNYXRoLmFicyhtMjMpIDwgMC45OTk5OTk5KSB7CiAgICAgICAgICB0aGlzLl95ID0gTWF0aC5hdGFuMihtMTMsIG0zMyk7CiAgICAgICAgICB0aGlzLl96ID0gTWF0aC5hdGFuMihtMjEsIG0yMik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuX3kgPSBNYXRoLmF0YW4yKC1tMzEsIG0xMSk7CiAgICAgICAgICB0aGlzLl96ID0gMDsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIlpYWSI6CiAgICAgICAgdGhpcy5feCA9IE1hdGguYXNpbihjbGFtcChtMzIsIC0xLCAxKSk7CiAgICAgICAgaWYgKE1hdGguYWJzKG0zMikgPCAwLjk5OTk5OTkpIHsKICAgICAgICAgIHRoaXMuX3kgPSBNYXRoLmF0YW4yKC1tMzEsIG0zMyk7CiAgICAgICAgICB0aGlzLl96ID0gTWF0aC5hdGFuMigtbTEyLCBtMjIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLl95ID0gMDsKICAgICAgICAgIHRoaXMuX3ogPSBNYXRoLmF0YW4yKG0yMSwgbTExKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIlpZWCI6CiAgICAgICAgdGhpcy5feSA9IE1hdGguYXNpbigtY2xhbXAobTMxLCAtMSwgMSkpOwogICAgICAgIGlmIChNYXRoLmFicyhtMzEpIDwgMC45OTk5OTk5KSB7CiAgICAgICAgICB0aGlzLl94ID0gTWF0aC5hdGFuMihtMzIsIG0zMyk7CiAgICAgICAgICB0aGlzLl96ID0gTWF0aC5hdGFuMihtMjEsIG0xMSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuX3ggPSAwOwogICAgICAgICAgdGhpcy5feiA9IE1hdGguYXRhbjIoLW0xMiwgbTIyKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIllaWCI6CiAgICAgICAgdGhpcy5feiA9IE1hdGguYXNpbihjbGFtcChtMjEsIC0xLCAxKSk7CiAgICAgICAgaWYgKE1hdGguYWJzKG0yMSkgPCAwLjk5OTk5OTkpIHsKICAgICAgICAgIHRoaXMuX3ggPSBNYXRoLmF0YW4yKC1tMjMsIG0yMik7CiAgICAgICAgICB0aGlzLl95ID0gTWF0aC5hdGFuMigtbTMxLCBtMTEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLl94ID0gMDsKICAgICAgICAgIHRoaXMuX3kgPSBNYXRoLmF0YW4yKG0xMywgbTMzKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIlhaWSI6CiAgICAgICAgdGhpcy5feiA9IE1hdGguYXNpbigtY2xhbXAobTEyLCAtMSwgMSkpOwogICAgICAgIGlmIChNYXRoLmFicyhtMTIpIDwgMC45OTk5OTk5KSB7CiAgICAgICAgICB0aGlzLl94ID0gTWF0aC5hdGFuMihtMzIsIG0yMik7CiAgICAgICAgICB0aGlzLl95ID0gTWF0aC5hdGFuMihtMTMsIG0xMSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuX3ggPSBNYXRoLmF0YW4yKC1tMjMsIG0zMyk7CiAgICAgICAgICB0aGlzLl95ID0gMDsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5FdWxlcjogLnNldEZyb21Sb3RhdGlvbk1hdHJpeCgpIGVuY291bnRlcmVkIGFuIHVua25vd24gb3JkZXI6ICIgKyBvcmRlcik7CiAgICB9CiAgICB0aGlzLl9vcmRlciA9IG9yZGVyOwogICAgaWYgKHVwZGF0ZSA9PT0gdHJ1ZSkKICAgICAgdGhpcy5fb25DaGFuZ2VDYWxsYmFjaygpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldEZyb21RdWF0ZXJuaW9uKHEsIG9yZGVyLCB1cGRhdGUpIHsKICAgIF9tYXRyaXgkMS5tYWtlUm90YXRpb25Gcm9tUXVhdGVybmlvbihxKTsKICAgIHJldHVybiB0aGlzLnNldEZyb21Sb3RhdGlvbk1hdHJpeChfbWF0cml4JDEsIG9yZGVyLCB1cGRhdGUpOwogIH0KICBzZXRGcm9tVmVjdG9yMyh2LCBvcmRlciA9IHRoaXMuX29yZGVyKSB7CiAgICByZXR1cm4gdGhpcy5zZXQodi54LCB2LnksIHYueiwgb3JkZXIpOwogIH0KICByZW9yZGVyKG5ld09yZGVyKSB7CiAgICBfcXVhdGVybmlvbiQzLnNldEZyb21FdWxlcih0aGlzKTsKICAgIHJldHVybiB0aGlzLnNldEZyb21RdWF0ZXJuaW9uKF9xdWF0ZXJuaW9uJDMsIG5ld09yZGVyKTsKICB9CiAgZXF1YWxzKGV1bGVyKSB7CiAgICByZXR1cm4gZXVsZXIuX3ggPT09IHRoaXMuX3ggJiYgZXVsZXIuX3kgPT09IHRoaXMuX3kgJiYgZXVsZXIuX3ogPT09IHRoaXMuX3ogJiYgZXVsZXIuX29yZGVyID09PSB0aGlzLl9vcmRlcjsKICB9CiAgZnJvbUFycmF5KGFycmF5KSB7CiAgICB0aGlzLl94ID0gYXJyYXlbMF07CiAgICB0aGlzLl95ID0gYXJyYXlbMV07CiAgICB0aGlzLl96ID0gYXJyYXlbMl07CiAgICBpZiAoYXJyYXlbM10gIT09IHZvaWQgMCkKICAgICAgdGhpcy5fb3JkZXIgPSBhcnJheVszXTsKICAgIHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKTsKICAgIHJldHVybiB0aGlzOwogIH0KICB0b0FycmF5KGFycmF5ID0gW10sIG9mZnNldCA9IDApIHsKICAgIGFycmF5W29mZnNldF0gPSB0aGlzLl94OwogICAgYXJyYXlbb2Zmc2V0ICsgMV0gPSB0aGlzLl95OwogICAgYXJyYXlbb2Zmc2V0ICsgMl0gPSB0aGlzLl96OwogICAgYXJyYXlbb2Zmc2V0ICsgM10gPSB0aGlzLl9vcmRlcjsKICAgIHJldHVybiBhcnJheTsKICB9CiAgdG9WZWN0b3IzKG9wdGlvbmFsUmVzdWx0KSB7CiAgICBpZiAob3B0aW9uYWxSZXN1bHQpIHsKICAgICAgcmV0dXJuIG9wdGlvbmFsUmVzdWx0LnNldCh0aGlzLl94LCB0aGlzLl95LCB0aGlzLl96KTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBuZXcgVmVjdG9yMyh0aGlzLl94LCB0aGlzLl95LCB0aGlzLl96KTsKICAgIH0KICB9CiAgX29uQ2hhbmdlKGNhbGxiYWNrKSB7CiAgICB0aGlzLl9vbkNoYW5nZUNhbGxiYWNrID0gY2FsbGJhY2s7CiAgICByZXR1cm4gdGhpczsKICB9CiAgX29uQ2hhbmdlQ2FsbGJhY2soKSB7CiAgfQp9CkV1bGVyLnByb3RvdHlwZS5pc0V1bGVyID0gdHJ1ZTsKRXVsZXIuRGVmYXVsdE9yZGVyID0gIlhZWiI7CkV1bGVyLlJvdGF0aW9uT3JkZXJzID0gWyJYWVoiLCAiWVpYIiwgIlpYWSIsICJYWlkiLCAiWVhaIiwgIlpZWCJdOwpjbGFzcyBMYXllcnMgewogIGNvbnN0cnVjdG9yKCkgewogICAgdGhpcy5tYXNrID0gMSB8IDA7CiAgfQogIHNldChjaGFubmVsKSB7CiAgICB0aGlzLm1hc2sgPSAoMSA8PCBjaGFubmVsIHwgMCkgPj4+IDA7CiAgfQogIGVuYWJsZShjaGFubmVsKSB7CiAgICB0aGlzLm1hc2sgfD0gMSA8PCBjaGFubmVsIHwgMDsKICB9CiAgZW5hYmxlQWxsKCkgewogICAgdGhpcy5tYXNrID0gNDI5NDk2NzI5NSB8IDA7CiAgfQogIHRvZ2dsZShjaGFubmVsKSB7CiAgICB0aGlzLm1hc2sgXj0gMSA8PCBjaGFubmVsIHwgMDsKICB9CiAgZGlzYWJsZShjaGFubmVsKSB7CiAgICB0aGlzLm1hc2sgJj0gfigxIDw8IGNoYW5uZWwgfCAwKTsKICB9CiAgZGlzYWJsZUFsbCgpIHsKICAgIHRoaXMubWFzayA9IDA7CiAgfQogIHRlc3QobGF5ZXJzKSB7CiAgICByZXR1cm4gKHRoaXMubWFzayAmIGxheWVycy5tYXNrKSAhPT0gMDsKICB9CiAgaXNFbmFibGVkKGNoYW5uZWwpIHsKICAgIHJldHVybiAodGhpcy5tYXNrICYgKDEgPDwgY2hhbm5lbCB8IDApKSAhPT0gMDsKICB9Cn0KbGV0IF9vYmplY3QzRElkID0gMDsKY29uc3QgX3YxJDQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3ExID0gLyogQF9fUFVSRV9fICovIG5ldyBRdWF0ZXJuaW9uKCk7CmNvbnN0IF9tMSQxID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXRyaXg0KCk7CmNvbnN0IF90YXJnZXQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3Bvc2l0aW9uJDMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3NjYWxlJDIgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3F1YXRlcm5pb24kMiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgUXVhdGVybmlvbigpOwpjb25zdCBfeEF4aXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoMSwgMCwgMCk7CmNvbnN0IF95QXhpcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygwLCAxLCAwKTsKY29uc3QgX3pBeGlzID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKDAsIDAsIDEpOwpjb25zdCBfYWRkZWRFdmVudCA9IHsgdHlwZTogImFkZGVkIiB9Owpjb25zdCBfcmVtb3ZlZEV2ZW50ID0geyB0eXBlOiAicmVtb3ZlZCIgfTsKY2xhc3MgT2JqZWN0M0QgZXh0ZW5kcyBFdmVudERpc3BhdGNoZXIgewogIGNvbnN0cnVjdG9yKCkgewogICAgc3VwZXIoKTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiaWQiLCB7IHZhbHVlOiBfb2JqZWN0M0RJZCsrIH0pOwogICAgdGhpcy51dWlkID0gZ2VuZXJhdGVVVUlEKCk7CiAgICB0aGlzLm5hbWUgPSAiIjsKICAgIHRoaXMudHlwZSA9ICJPYmplY3QzRCI7CiAgICB0aGlzLnBhcmVudCA9IG51bGw7CiAgICB0aGlzLmNoaWxkcmVuID0gW107CiAgICB0aGlzLnVwID0gT2JqZWN0M0QuRGVmYXVsdFVwLmNsb25lKCk7CiAgICBjb25zdCBwb3NpdGlvbiA9IG5ldyBWZWN0b3IzKCk7CiAgICBjb25zdCByb3RhdGlvbiA9IG5ldyBFdWxlcigpOwogICAgY29uc3QgcXVhdGVybmlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICBjb25zdCBzY2FsZSA9IG5ldyBWZWN0b3IzKDEsIDEsIDEpOwogICAgZnVuY3Rpb24gb25Sb3RhdGlvbkNoYW5nZSgpIHsKICAgICAgcXVhdGVybmlvbi5zZXRGcm9tRXVsZXIocm90YXRpb24sIGZhbHNlKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9uUXVhdGVybmlvbkNoYW5nZSgpIHsKICAgICAgcm90YXRpb24uc2V0RnJvbVF1YXRlcm5pb24ocXVhdGVybmlvbiwgdm9pZCAwLCBmYWxzZSk7CiAgICB9CiAgICByb3RhdGlvbi5fb25DaGFuZ2Uob25Sb3RhdGlvbkNoYW5nZSk7CiAgICBxdWF0ZXJuaW9uLl9vbkNoYW5nZShvblF1YXRlcm5pb25DaGFuZ2UpOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywgewogICAgICBwb3NpdGlvbjogewogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiBwb3NpdGlvbgogICAgICB9LAogICAgICByb3RhdGlvbjogewogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiByb3RhdGlvbgogICAgICB9LAogICAgICBxdWF0ZXJuaW9uOiB7CiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IHF1YXRlcm5pb24KICAgICAgfSwKICAgICAgc2NhbGU6IHsKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogc2NhbGUKICAgICAgfSwKICAgICAgbW9kZWxWaWV3TWF0cml4OiB7CiAgICAgICAgdmFsdWU6IG5ldyBNYXRyaXg0KCkKICAgICAgfSwKICAgICAgbm9ybWFsTWF0cml4OiB7CiAgICAgICAgdmFsdWU6IG5ldyBNYXRyaXgzKCkKICAgICAgfQogICAgfSk7CiAgICB0aGlzLm1hdHJpeCA9IG5ldyBNYXRyaXg0KCk7CiAgICB0aGlzLm1hdHJpeFdvcmxkID0gbmV3IE1hdHJpeDQoKTsKICAgIHRoaXMubWF0cml4QXV0b1VwZGF0ZSA9IE9iamVjdDNELkRlZmF1bHRNYXRyaXhBdXRvVXBkYXRlOwogICAgdGhpcy5tYXRyaXhXb3JsZE5lZWRzVXBkYXRlID0gZmFsc2U7CiAgICB0aGlzLmxheWVycyA9IG5ldyBMYXllcnMoKTsKICAgIHRoaXMudmlzaWJsZSA9IHRydWU7CiAgICB0aGlzLmNhc3RTaGFkb3cgPSBmYWxzZTsKICAgIHRoaXMucmVjZWl2ZVNoYWRvdyA9IGZhbHNlOwogICAgdGhpcy5mcnVzdHVtQ3VsbGVkID0gdHJ1ZTsKICAgIHRoaXMucmVuZGVyT3JkZXIgPSAwOwogICAgdGhpcy5hbmltYXRpb25zID0gW107CiAgICB0aGlzLnVzZXJEYXRhID0ge307CiAgfQogIG9uQmVmb3JlUmVuZGVyKCkgewogIH0KICBvbkFmdGVyUmVuZGVyKCkgewogIH0KICBhcHBseU1hdHJpeDQobWF0cml4KSB7CiAgICBpZiAodGhpcy5tYXRyaXhBdXRvVXBkYXRlKQogICAgICB0aGlzLnVwZGF0ZU1hdHJpeCgpOwogICAgdGhpcy5tYXRyaXgucHJlbXVsdGlwbHkobWF0cml4KTsKICAgIHRoaXMubWF0cml4LmRlY29tcG9zZSh0aGlzLnBvc2l0aW9uLCB0aGlzLnF1YXRlcm5pb24sIHRoaXMuc2NhbGUpOwogIH0KICBhcHBseVF1YXRlcm5pb24ocSkgewogICAgdGhpcy5xdWF0ZXJuaW9uLnByZW11bHRpcGx5KHEpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldFJvdGF0aW9uRnJvbUF4aXNBbmdsZShheGlzLCBhbmdsZSkgewogICAgdGhpcy5xdWF0ZXJuaW9uLnNldEZyb21BeGlzQW5nbGUoYXhpcywgYW5nbGUpOwogIH0KICBzZXRSb3RhdGlvbkZyb21FdWxlcihldWxlcikgewogICAgdGhpcy5xdWF0ZXJuaW9uLnNldEZyb21FdWxlcihldWxlciwgdHJ1ZSk7CiAgfQogIHNldFJvdGF0aW9uRnJvbU1hdHJpeChtKSB7CiAgICB0aGlzLnF1YXRlcm5pb24uc2V0RnJvbVJvdGF0aW9uTWF0cml4KG0pOwogIH0KICBzZXRSb3RhdGlvbkZyb21RdWF0ZXJuaW9uKHEpIHsKICAgIHRoaXMucXVhdGVybmlvbi5jb3B5KHEpOwogIH0KICByb3RhdGVPbkF4aXMoYXhpcywgYW5nbGUpIHsKICAgIF9xMS5zZXRGcm9tQXhpc0FuZ2xlKGF4aXMsIGFuZ2xlKTsKICAgIHRoaXMucXVhdGVybmlvbi5tdWx0aXBseShfcTEpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHJvdGF0ZU9uV29ybGRBeGlzKGF4aXMsIGFuZ2xlKSB7CiAgICBfcTEuc2V0RnJvbUF4aXNBbmdsZShheGlzLCBhbmdsZSk7CiAgICB0aGlzLnF1YXRlcm5pb24ucHJlbXVsdGlwbHkoX3ExKTsKICAgIHJldHVybiB0aGlzOwogIH0KICByb3RhdGVYKGFuZ2xlKSB7CiAgICByZXR1cm4gdGhpcy5yb3RhdGVPbkF4aXMoX3hBeGlzLCBhbmdsZSk7CiAgfQogIHJvdGF0ZVkoYW5nbGUpIHsKICAgIHJldHVybiB0aGlzLnJvdGF0ZU9uQXhpcyhfeUF4aXMsIGFuZ2xlKTsKICB9CiAgcm90YXRlWihhbmdsZSkgewogICAgcmV0dXJuIHRoaXMucm90YXRlT25BeGlzKF96QXhpcywgYW5nbGUpOwogIH0KICB0cmFuc2xhdGVPbkF4aXMoYXhpcywgZGlzdGFuY2UpIHsKICAgIF92MSQ0LmNvcHkoYXhpcykuYXBwbHlRdWF0ZXJuaW9uKHRoaXMucXVhdGVybmlvbik7CiAgICB0aGlzLnBvc2l0aW9uLmFkZChfdjEkNC5tdWx0aXBseVNjYWxhcihkaXN0YW5jZSkpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRyYW5zbGF0ZVgoZGlzdGFuY2UpIHsKICAgIHJldHVybiB0aGlzLnRyYW5zbGF0ZU9uQXhpcyhfeEF4aXMsIGRpc3RhbmNlKTsKICB9CiAgdHJhbnNsYXRlWShkaXN0YW5jZSkgewogICAgcmV0dXJuIHRoaXMudHJhbnNsYXRlT25BeGlzKF95QXhpcywgZGlzdGFuY2UpOwogIH0KICB0cmFuc2xhdGVaKGRpc3RhbmNlKSB7CiAgICByZXR1cm4gdGhpcy50cmFuc2xhdGVPbkF4aXMoX3pBeGlzLCBkaXN0YW5jZSk7CiAgfQogIGxvY2FsVG9Xb3JsZCh2ZWN0b3IpIHsKICAgIHJldHVybiB2ZWN0b3IuYXBwbHlNYXRyaXg0KHRoaXMubWF0cml4V29ybGQpOwogIH0KICB3b3JsZFRvTG9jYWwodmVjdG9yKSB7CiAgICByZXR1cm4gdmVjdG9yLmFwcGx5TWF0cml4NChfbTEkMS5jb3B5KHRoaXMubWF0cml4V29ybGQpLmludmVydCgpKTsKICB9CiAgbG9va0F0KHgsIHksIHopIHsKICAgIGlmICh4LmlzVmVjdG9yMykgewogICAgICBfdGFyZ2V0LmNvcHkoeCk7CiAgICB9IGVsc2UgewogICAgICBfdGFyZ2V0LnNldCh4LCB5LCB6KTsKICAgIH0KICAgIGNvbnN0IHBhcmVudCA9IHRoaXMucGFyZW50OwogICAgdGhpcy51cGRhdGVXb3JsZE1hdHJpeCh0cnVlLCBmYWxzZSk7CiAgICBfcG9zaXRpb24kMy5zZXRGcm9tTWF0cml4UG9zaXRpb24odGhpcy5tYXRyaXhXb3JsZCk7CiAgICBpZiAodGhpcy5pc0NhbWVyYSB8fCB0aGlzLmlzTGlnaHQpIHsKICAgICAgX20xJDEubG9va0F0KF9wb3NpdGlvbiQzLCBfdGFyZ2V0LCB0aGlzLnVwKTsKICAgIH0gZWxzZSB7CiAgICAgIF9tMSQxLmxvb2tBdChfdGFyZ2V0LCBfcG9zaXRpb24kMywgdGhpcy51cCk7CiAgICB9CiAgICB0aGlzLnF1YXRlcm5pb24uc2V0RnJvbVJvdGF0aW9uTWF0cml4KF9tMSQxKTsKICAgIGlmIChwYXJlbnQpIHsKICAgICAgX20xJDEuZXh0cmFjdFJvdGF0aW9uKHBhcmVudC5tYXRyaXhXb3JsZCk7CiAgICAgIF9xMS5zZXRGcm9tUm90YXRpb25NYXRyaXgoX20xJDEpOwogICAgICB0aGlzLnF1YXRlcm5pb24ucHJlbXVsdGlwbHkoX3ExLmludmVydCgpKTsKICAgIH0KICB9CiAgYWRkKG9iamVjdCkgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5hZGQoYXJndW1lbnRzW2ldKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIGlmIChvYmplY3QgPT09IHRoaXMpIHsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuT2JqZWN0M0QuYWRkOiBvYmplY3QgY2FuJ3QgYmUgYWRkZWQgYXMgYSBjaGlsZCBvZiBpdHNlbGYuIiwgb2JqZWN0KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICBpZiAob2JqZWN0ICYmIG9iamVjdC5pc09iamVjdDNEKSB7CiAgICAgIGlmIChvYmplY3QucGFyZW50ICE9PSBudWxsKSB7CiAgICAgICAgb2JqZWN0LnBhcmVudC5yZW1vdmUob2JqZWN0KTsKICAgICAgfQogICAgICBvYmplY3QucGFyZW50ID0gdGhpczsKICAgICAgdGhpcy5jaGlsZHJlbi5wdXNoKG9iamVjdCk7CiAgICAgIG9iamVjdC5kaXNwYXRjaEV2ZW50KF9hZGRlZEV2ZW50KTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLk9iamVjdDNELmFkZDogb2JqZWN0IG5vdCBhbiBpbnN0YW5jZSBvZiBUSFJFRS5PYmplY3QzRC4iLCBvYmplY3QpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIHJlbW92ZShvYmplY3QpIHsKICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkgewogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMucmVtb3ZlKGFyZ3VtZW50c1tpXSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICBjb25zdCBpbmRleCA9IHRoaXMuY2hpbGRyZW4uaW5kZXhPZihvYmplY3QpOwogICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICBvYmplY3QucGFyZW50ID0gbnVsbDsKICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpOwogICAgICBvYmplY3QuZGlzcGF0Y2hFdmVudChfcmVtb3ZlZEV2ZW50KTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICByZW1vdmVGcm9tUGFyZW50KCkgewogICAgY29uc3QgcGFyZW50ID0gdGhpcy5wYXJlbnQ7CiAgICBpZiAocGFyZW50ICE9PSBudWxsKSB7CiAgICAgIHBhcmVudC5yZW1vdmUodGhpcyk7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xlYXIoKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3Qgb2JqZWN0ID0gdGhpcy5jaGlsZHJlbltpXTsKICAgICAgb2JqZWN0LnBhcmVudCA9IG51bGw7CiAgICAgIG9iamVjdC5kaXNwYXRjaEV2ZW50KF9yZW1vdmVkRXZlbnQpOwogICAgfQogICAgdGhpcy5jaGlsZHJlbi5sZW5ndGggPSAwOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGF0dGFjaChvYmplY3QpIHsKICAgIHRoaXMudXBkYXRlV29ybGRNYXRyaXgodHJ1ZSwgZmFsc2UpOwogICAgX20xJDEuY29weSh0aGlzLm1hdHJpeFdvcmxkKS5pbnZlcnQoKTsKICAgIGlmIChvYmplY3QucGFyZW50ICE9PSBudWxsKSB7CiAgICAgIG9iamVjdC5wYXJlbnQudXBkYXRlV29ybGRNYXRyaXgodHJ1ZSwgZmFsc2UpOwogICAgICBfbTEkMS5tdWx0aXBseShvYmplY3QucGFyZW50Lm1hdHJpeFdvcmxkKTsKICAgIH0KICAgIG9iamVjdC5hcHBseU1hdHJpeDQoX20xJDEpOwogICAgdGhpcy5hZGQob2JqZWN0KTsKICAgIG9iamVjdC51cGRhdGVXb3JsZE1hdHJpeChmYWxzZSwgdHJ1ZSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZ2V0T2JqZWN0QnlJZChpZCkgewogICAgcmV0dXJuIHRoaXMuZ2V0T2JqZWN0QnlQcm9wZXJ0eSgiaWQiLCBpZCk7CiAgfQogIGdldE9iamVjdEJ5TmFtZShuYW1lKSB7CiAgICByZXR1cm4gdGhpcy5nZXRPYmplY3RCeVByb3BlcnR5KCJuYW1lIiwgbmFtZSk7CiAgfQogIGdldE9iamVjdEJ5UHJvcGVydHkobmFtZSwgdmFsdWUpIHsKICAgIGlmICh0aGlzW25hbWVdID09PSB2YWx1ZSkKICAgICAgcmV0dXJuIHRoaXM7CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIGNvbnN0IGNoaWxkID0gdGhpcy5jaGlsZHJlbltpXTsKICAgICAgY29uc3Qgb2JqZWN0ID0gY2hpbGQuZ2V0T2JqZWN0QnlQcm9wZXJ0eShuYW1lLCB2YWx1ZSk7CiAgICAgIGlmIChvYmplY3QgIT09IHZvaWQgMCkgewogICAgICAgIHJldHVybiBvYmplY3Q7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB2b2lkIDA7CiAgfQogIGdldFdvcmxkUG9zaXRpb24odGFyZ2V0KSB7CiAgICB0aGlzLnVwZGF0ZVdvcmxkTWF0cml4KHRydWUsIGZhbHNlKTsKICAgIHJldHVybiB0YXJnZXQuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKHRoaXMubWF0cml4V29ybGQpOwogIH0KICBnZXRXb3JsZFF1YXRlcm5pb24odGFyZ2V0KSB7CiAgICB0aGlzLnVwZGF0ZVdvcmxkTWF0cml4KHRydWUsIGZhbHNlKTsKICAgIHRoaXMubWF0cml4V29ybGQuZGVjb21wb3NlKF9wb3NpdGlvbiQzLCB0YXJnZXQsIF9zY2FsZSQyKTsKICAgIHJldHVybiB0YXJnZXQ7CiAgfQogIGdldFdvcmxkU2NhbGUodGFyZ2V0KSB7CiAgICB0aGlzLnVwZGF0ZVdvcmxkTWF0cml4KHRydWUsIGZhbHNlKTsKICAgIHRoaXMubWF0cml4V29ybGQuZGVjb21wb3NlKF9wb3NpdGlvbiQzLCBfcXVhdGVybmlvbiQyLCB0YXJnZXQpOwogICAgcmV0dXJuIHRhcmdldDsKICB9CiAgZ2V0V29ybGREaXJlY3Rpb24odGFyZ2V0KSB7CiAgICB0aGlzLnVwZGF0ZVdvcmxkTWF0cml4KHRydWUsIGZhbHNlKTsKICAgIGNvbnN0IGUgPSB0aGlzLm1hdHJpeFdvcmxkLmVsZW1lbnRzOwogICAgcmV0dXJuIHRhcmdldC5zZXQoZVs4XSwgZVs5XSwgZVsxMF0pLm5vcm1hbGl6ZSgpOwogIH0KICByYXljYXN0KCkgewogIH0KICB0cmF2ZXJzZShjYWxsYmFjaykgewogICAgY2FsbGJhY2sodGhpcyk7CiAgICBjb25zdCBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBjaGlsZHJlbltpXS50cmF2ZXJzZShjYWxsYmFjayk7CiAgICB9CiAgfQogIHRyYXZlcnNlVmlzaWJsZShjYWxsYmFjaykgewogICAgaWYgKHRoaXMudmlzaWJsZSA9PT0gZmFsc2UpCiAgICAgIHJldHVybjsKICAgIGNhbGxiYWNrKHRoaXMpOwogICAgY29uc3QgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgY2hpbGRyZW5baV0udHJhdmVyc2VWaXNpYmxlKGNhbGxiYWNrKTsKICAgIH0KICB9CiAgdHJhdmVyc2VBbmNlc3RvcnMoY2FsbGJhY2spIHsKICAgIGNvbnN0IHBhcmVudCA9IHRoaXMucGFyZW50OwogICAgaWYgKHBhcmVudCAhPT0gbnVsbCkgewogICAgICBjYWxsYmFjayhwYXJlbnQpOwogICAgICBwYXJlbnQudHJhdmVyc2VBbmNlc3RvcnMoY2FsbGJhY2spOwogICAgfQogIH0KICB1cGRhdGVNYXRyaXgoKSB7CiAgICB0aGlzLm1hdHJpeC5jb21wb3NlKHRoaXMucG9zaXRpb24sIHRoaXMucXVhdGVybmlvbiwgdGhpcy5zY2FsZSk7CiAgICB0aGlzLm1hdHJpeFdvcmxkTmVlZHNVcGRhdGUgPSB0cnVlOwogIH0KICB1cGRhdGVNYXRyaXhXb3JsZChmb3JjZSkgewogICAgaWYgKHRoaXMubWF0cml4QXV0b1VwZGF0ZSkKICAgICAgdGhpcy51cGRhdGVNYXRyaXgoKTsKICAgIGlmICh0aGlzLm1hdHJpeFdvcmxkTmVlZHNVcGRhdGUgfHwgZm9yY2UpIHsKICAgICAgaWYgKHRoaXMucGFyZW50ID09PSBudWxsKSB7CiAgICAgICAgdGhpcy5tYXRyaXhXb3JsZC5jb3B5KHRoaXMubWF0cml4KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLm1hdHJpeFdvcmxkLm11bHRpcGx5TWF0cmljZXModGhpcy5wYXJlbnQubWF0cml4V29ybGQsIHRoaXMubWF0cml4KTsKICAgICAgfQogICAgICB0aGlzLm1hdHJpeFdvcmxkTmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgICAgZm9yY2UgPSB0cnVlOwogICAgfQogICAgY29uc3QgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgY2hpbGRyZW5baV0udXBkYXRlTWF0cml4V29ybGQoZm9yY2UpOwogICAgfQogIH0KICB1cGRhdGVXb3JsZE1hdHJpeCh1cGRhdGVQYXJlbnRzLCB1cGRhdGVDaGlsZHJlbikgewogICAgY29uc3QgcGFyZW50ID0gdGhpcy5wYXJlbnQ7CiAgICBpZiAodXBkYXRlUGFyZW50cyA9PT0gdHJ1ZSAmJiBwYXJlbnQgIT09IG51bGwpIHsKICAgICAgcGFyZW50LnVwZGF0ZVdvcmxkTWF0cml4KHRydWUsIGZhbHNlKTsKICAgIH0KICAgIGlmICh0aGlzLm1hdHJpeEF1dG9VcGRhdGUpCiAgICAgIHRoaXMudXBkYXRlTWF0cml4KCk7CiAgICBpZiAodGhpcy5wYXJlbnQgPT09IG51bGwpIHsKICAgICAgdGhpcy5tYXRyaXhXb3JsZC5jb3B5KHRoaXMubWF0cml4KTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMubWF0cml4V29ybGQubXVsdGlwbHlNYXRyaWNlcyh0aGlzLnBhcmVudC5tYXRyaXhXb3JsZCwgdGhpcy5tYXRyaXgpOwogICAgfQogICAgaWYgKHVwZGF0ZUNoaWxkcmVuID09PSB0cnVlKSB7CiAgICAgIGNvbnN0IGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjsKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBjaGlsZHJlbltpXS51cGRhdGVXb3JsZE1hdHJpeChmYWxzZSwgdHJ1ZSk7CiAgICAgIH0KICAgIH0KICB9CiAgdG9KU09OKG1ldGEpIHsKICAgIGNvbnN0IGlzUm9vdE9iamVjdCA9IG1ldGEgPT09IHZvaWQgMCB8fCB0eXBlb2YgbWV0YSA9PT0gInN0cmluZyI7CiAgICBjb25zdCBvdXRwdXQgPSB7fTsKICAgIGlmIChpc1Jvb3RPYmplY3QpIHsKICAgICAgbWV0YSA9IHsKICAgICAgICBnZW9tZXRyaWVzOiB7fSwKICAgICAgICBtYXRlcmlhbHM6IHt9LAogICAgICAgIHRleHR1cmVzOiB7fSwKICAgICAgICBpbWFnZXM6IHt9LAogICAgICAgIHNoYXBlczoge30sCiAgICAgICAgc2tlbGV0b25zOiB7fSwKICAgICAgICBhbmltYXRpb25zOiB7fQogICAgICB9OwogICAgICBvdXRwdXQubWV0YWRhdGEgPSB7CiAgICAgICAgdmVyc2lvbjogNC41LAogICAgICAgIHR5cGU6ICJPYmplY3QiLAogICAgICAgIGdlbmVyYXRvcjogIk9iamVjdDNELnRvSlNPTiIKICAgICAgfTsKICAgIH0KICAgIGNvbnN0IG9iamVjdCA9IHt9OwogICAgb2JqZWN0LnV1aWQgPSB0aGlzLnV1aWQ7CiAgICBvYmplY3QudHlwZSA9IHRoaXMudHlwZTsKICAgIGlmICh0aGlzLm5hbWUgIT09ICIiKQogICAgICBvYmplY3QubmFtZSA9IHRoaXMubmFtZTsKICAgIGlmICh0aGlzLmNhc3RTaGFkb3cgPT09IHRydWUpCiAgICAgIG9iamVjdC5jYXN0U2hhZG93ID0gdHJ1ZTsKICAgIGlmICh0aGlzLnJlY2VpdmVTaGFkb3cgPT09IHRydWUpCiAgICAgIG9iamVjdC5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsKICAgIGlmICh0aGlzLnZpc2libGUgPT09IGZhbHNlKQogICAgICBvYmplY3QudmlzaWJsZSA9IGZhbHNlOwogICAgaWYgKHRoaXMuZnJ1c3R1bUN1bGxlZCA9PT0gZmFsc2UpCiAgICAgIG9iamVjdC5mcnVzdHVtQ3VsbGVkID0gZmFsc2U7CiAgICBpZiAodGhpcy5yZW5kZXJPcmRlciAhPT0gMCkKICAgICAgb2JqZWN0LnJlbmRlck9yZGVyID0gdGhpcy5yZW5kZXJPcmRlcjsKICAgIGlmIChKU09OLnN0cmluZ2lmeSh0aGlzLnVzZXJEYXRhKSAhPT0gInt9IikKICAgICAgb2JqZWN0LnVzZXJEYXRhID0gdGhpcy51c2VyRGF0YTsKICAgIG9iamVjdC5sYXllcnMgPSB0aGlzLmxheWVycy5tYXNrOwogICAgb2JqZWN0Lm1hdHJpeCA9IHRoaXMubWF0cml4LnRvQXJyYXkoKTsKICAgIGlmICh0aGlzLm1hdHJpeEF1dG9VcGRhdGUgPT09IGZhbHNlKQogICAgICBvYmplY3QubWF0cml4QXV0b1VwZGF0ZSA9IGZhbHNlOwogICAgaWYgKHRoaXMuaXNJbnN0YW5jZWRNZXNoKSB7CiAgICAgIG9iamVjdC50eXBlID0gIkluc3RhbmNlZE1lc2giOwogICAgICBvYmplY3QuY291bnQgPSB0aGlzLmNvdW50OwogICAgICBvYmplY3QuaW5zdGFuY2VNYXRyaXggPSB0aGlzLmluc3RhbmNlTWF0cml4LnRvSlNPTigpOwogICAgICBpZiAodGhpcy5pbnN0YW5jZUNvbG9yICE9PSBudWxsKQogICAgICAgIG9iamVjdC5pbnN0YW5jZUNvbG9yID0gdGhpcy5pbnN0YW5jZUNvbG9yLnRvSlNPTigpOwogICAgfQogICAgZnVuY3Rpb24gc2VyaWFsaXplKGxpYnJhcnksIGVsZW1lbnQpIHsKICAgICAgaWYgKGxpYnJhcnlbZWxlbWVudC51dWlkXSA9PT0gdm9pZCAwKSB7CiAgICAgICAgbGlicmFyeVtlbGVtZW50LnV1aWRdID0gZWxlbWVudC50b0pTT04obWV0YSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGVsZW1lbnQudXVpZDsKICAgIH0KICAgIGlmICh0aGlzLmlzU2NlbmUpIHsKICAgICAgaWYgKHRoaXMuYmFja2dyb3VuZCkgewogICAgICAgIGlmICh0aGlzLmJhY2tncm91bmQuaXNDb2xvcikgewogICAgICAgICAgb2JqZWN0LmJhY2tncm91bmQgPSB0aGlzLmJhY2tncm91bmQudG9KU09OKCk7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmJhY2tncm91bmQuaXNUZXh0dXJlKSB7CiAgICAgICAgICBvYmplY3QuYmFja2dyb3VuZCA9IHRoaXMuYmFja2dyb3VuZC50b0pTT04obWV0YSkudXVpZDsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHRoaXMuZW52aXJvbm1lbnQgJiYgdGhpcy5lbnZpcm9ubWVudC5pc1RleHR1cmUpIHsKICAgICAgICBvYmplY3QuZW52aXJvbm1lbnQgPSB0aGlzLmVudmlyb25tZW50LnRvSlNPTihtZXRhKS51dWlkOwogICAgICB9CiAgICB9IGVsc2UgaWYgKHRoaXMuaXNNZXNoIHx8IHRoaXMuaXNMaW5lIHx8IHRoaXMuaXNQb2ludHMpIHsKICAgICAgb2JqZWN0Lmdlb21ldHJ5ID0gc2VyaWFsaXplKG1ldGEuZ2VvbWV0cmllcywgdGhpcy5nZW9tZXRyeSk7CiAgICAgIGNvbnN0IHBhcmFtZXRlcnMgPSB0aGlzLmdlb21ldHJ5LnBhcmFtZXRlcnM7CiAgICAgIGlmIChwYXJhbWV0ZXJzICE9PSB2b2lkIDAgJiYgcGFyYW1ldGVycy5zaGFwZXMgIT09IHZvaWQgMCkgewogICAgICAgIGNvbnN0IHNoYXBlcyA9IHBhcmFtZXRlcnMuc2hhcGVzOwogICAgICAgIGlmIChBcnJheS5pc0FycmF5KHNoYXBlcykpIHsKICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gc2hhcGVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgICBjb25zdCBzaGFwZSA9IHNoYXBlc1tpXTsKICAgICAgICAgICAgc2VyaWFsaXplKG1ldGEuc2hhcGVzLCBzaGFwZSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNlcmlhbGl6ZShtZXRhLnNoYXBlcywgc2hhcGVzKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGlmICh0aGlzLmlzU2tpbm5lZE1lc2gpIHsKICAgICAgb2JqZWN0LmJpbmRNb2RlID0gdGhpcy5iaW5kTW9kZTsKICAgICAgb2JqZWN0LmJpbmRNYXRyaXggPSB0aGlzLmJpbmRNYXRyaXgudG9BcnJheSgpOwogICAgICBpZiAodGhpcy5za2VsZXRvbiAhPT0gdm9pZCAwKSB7CiAgICAgICAgc2VyaWFsaXplKG1ldGEuc2tlbGV0b25zLCB0aGlzLnNrZWxldG9uKTsKICAgICAgICBvYmplY3Quc2tlbGV0b24gPSB0aGlzLnNrZWxldG9uLnV1aWQ7CiAgICAgIH0KICAgIH0KICAgIGlmICh0aGlzLm1hdGVyaWFsICE9PSB2b2lkIDApIHsKICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5tYXRlcmlhbCkpIHsKICAgICAgICBjb25zdCB1dWlkcyA9IFtdOwogICAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5tYXRlcmlhbC5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICAgIHV1aWRzLnB1c2goc2VyaWFsaXplKG1ldGEubWF0ZXJpYWxzLCB0aGlzLm1hdGVyaWFsW2ldKSk7CiAgICAgICAgfQogICAgICAgIG9iamVjdC5tYXRlcmlhbCA9IHV1aWRzOwogICAgICB9IGVsc2UgewogICAgICAgIG9iamVjdC5tYXRlcmlhbCA9IHNlcmlhbGl6ZShtZXRhLm1hdGVyaWFscywgdGhpcy5tYXRlcmlhbCk7CiAgICAgIH0KICAgIH0KICAgIGlmICh0aGlzLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgb2JqZWN0LmNoaWxkcmVuID0gW107CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jaGlsZHJlbi5sZW5ndGg7IGkrKykgewogICAgICAgIG9iamVjdC5jaGlsZHJlbi5wdXNoKHRoaXMuY2hpbGRyZW5baV0udG9KU09OKG1ldGEpLm9iamVjdCk7CiAgICAgIH0KICAgIH0KICAgIGlmICh0aGlzLmFuaW1hdGlvbnMubGVuZ3RoID4gMCkgewogICAgICBvYmplY3QuYW5pbWF0aW9ucyA9IFtdOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYW5pbWF0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGFuaW1hdGlvbiA9IHRoaXMuYW5pbWF0aW9uc1tpXTsKICAgICAgICBvYmplY3QuYW5pbWF0aW9ucy5wdXNoKHNlcmlhbGl6ZShtZXRhLmFuaW1hdGlvbnMsIGFuaW1hdGlvbikpOwogICAgICB9CiAgICB9CiAgICBpZiAoaXNSb290T2JqZWN0KSB7CiAgICAgIGNvbnN0IGdlb21ldHJpZXMgPSBleHRyYWN0RnJvbUNhY2hlKG1ldGEuZ2VvbWV0cmllcyk7CiAgICAgIGNvbnN0IG1hdGVyaWFscyA9IGV4dHJhY3RGcm9tQ2FjaGUobWV0YS5tYXRlcmlhbHMpOwogICAgICBjb25zdCB0ZXh0dXJlcyA9IGV4dHJhY3RGcm9tQ2FjaGUobWV0YS50ZXh0dXJlcyk7CiAgICAgIGNvbnN0IGltYWdlcyA9IGV4dHJhY3RGcm9tQ2FjaGUobWV0YS5pbWFnZXMpOwogICAgICBjb25zdCBzaGFwZXMgPSBleHRyYWN0RnJvbUNhY2hlKG1ldGEuc2hhcGVzKTsKICAgICAgY29uc3Qgc2tlbGV0b25zID0gZXh0cmFjdEZyb21DYWNoZShtZXRhLnNrZWxldG9ucyk7CiAgICAgIGNvbnN0IGFuaW1hdGlvbnMgPSBleHRyYWN0RnJvbUNhY2hlKG1ldGEuYW5pbWF0aW9ucyk7CiAgICAgIGlmIChnZW9tZXRyaWVzLmxlbmd0aCA+IDApCiAgICAgICAgb3V0cHV0Lmdlb21ldHJpZXMgPSBnZW9tZXRyaWVzOwogICAgICBpZiAobWF0ZXJpYWxzLmxlbmd0aCA+IDApCiAgICAgICAgb3V0cHV0Lm1hdGVyaWFscyA9IG1hdGVyaWFsczsKICAgICAgaWYgKHRleHR1cmVzLmxlbmd0aCA+IDApCiAgICAgICAgb3V0cHV0LnRleHR1cmVzID0gdGV4dHVyZXM7CiAgICAgIGlmIChpbWFnZXMubGVuZ3RoID4gMCkKICAgICAgICBvdXRwdXQuaW1hZ2VzID0gaW1hZ2VzOwogICAgICBpZiAoc2hhcGVzLmxlbmd0aCA+IDApCiAgICAgICAgb3V0cHV0LnNoYXBlcyA9IHNoYXBlczsKICAgICAgaWYgKHNrZWxldG9ucy5sZW5ndGggPiAwKQogICAgICAgIG91dHB1dC5za2VsZXRvbnMgPSBza2VsZXRvbnM7CiAgICAgIGlmIChhbmltYXRpb25zLmxlbmd0aCA+IDApCiAgICAgICAgb3V0cHV0LmFuaW1hdGlvbnMgPSBhbmltYXRpb25zOwogICAgfQogICAgb3V0cHV0Lm9iamVjdCA9IG9iamVjdDsKICAgIHJldHVybiBvdXRwdXQ7CiAgICBmdW5jdGlvbiBleHRyYWN0RnJvbUNhY2hlKGNhY2hlKSB7CiAgICAgIGNvbnN0IHZhbHVlcyA9IFtdOwogICAgICBmb3IgKGNvbnN0IGtleSBpbiBjYWNoZSkgewogICAgICAgIGNvbnN0IGRhdGEgPSBjYWNoZVtrZXldOwogICAgICAgIGRlbGV0ZSBkYXRhLm1ldGFkYXRhOwogICAgICAgIHZhbHVlcy5wdXNoKGRhdGEpOwogICAgICB9CiAgICAgIHJldHVybiB2YWx1ZXM7CiAgICB9CiAgfQogIGNsb25lKHJlY3Vyc2l2ZSkgewogICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKCkuY29weSh0aGlzLCByZWN1cnNpdmUpOwogIH0KICBjb3B5KHNvdXJjZSwgcmVjdXJzaXZlID0gdHJ1ZSkgewogICAgdGhpcy5uYW1lID0gc291cmNlLm5hbWU7CiAgICB0aGlzLnVwLmNvcHkoc291cmNlLnVwKTsKICAgIHRoaXMucG9zaXRpb24uY29weShzb3VyY2UucG9zaXRpb24pOwogICAgdGhpcy5yb3RhdGlvbi5vcmRlciA9IHNvdXJjZS5yb3RhdGlvbi5vcmRlcjsKICAgIHRoaXMucXVhdGVybmlvbi5jb3B5KHNvdXJjZS5xdWF0ZXJuaW9uKTsKICAgIHRoaXMuc2NhbGUuY29weShzb3VyY2Uuc2NhbGUpOwogICAgdGhpcy5tYXRyaXguY29weShzb3VyY2UubWF0cml4KTsKICAgIHRoaXMubWF0cml4V29ybGQuY29weShzb3VyY2UubWF0cml4V29ybGQpOwogICAgdGhpcy5tYXRyaXhBdXRvVXBkYXRlID0gc291cmNlLm1hdHJpeEF1dG9VcGRhdGU7CiAgICB0aGlzLm1hdHJpeFdvcmxkTmVlZHNVcGRhdGUgPSBzb3VyY2UubWF0cml4V29ybGROZWVkc1VwZGF0ZTsKICAgIHRoaXMubGF5ZXJzLm1hc2sgPSBzb3VyY2UubGF5ZXJzLm1hc2s7CiAgICB0aGlzLnZpc2libGUgPSBzb3VyY2UudmlzaWJsZTsKICAgIHRoaXMuY2FzdFNoYWRvdyA9IHNvdXJjZS5jYXN0U2hhZG93OwogICAgdGhpcy5yZWNlaXZlU2hhZG93ID0gc291cmNlLnJlY2VpdmVTaGFkb3c7CiAgICB0aGlzLmZydXN0dW1DdWxsZWQgPSBzb3VyY2UuZnJ1c3R1bUN1bGxlZDsKICAgIHRoaXMucmVuZGVyT3JkZXIgPSBzb3VyY2UucmVuZGVyT3JkZXI7CiAgICB0aGlzLnVzZXJEYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzb3VyY2UudXNlckRhdGEpKTsKICAgIGlmIChyZWN1cnNpdmUgPT09IHRydWUpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzb3VyY2UuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBjaGlsZCA9IHNvdXJjZS5jaGlsZHJlbltpXTsKICAgICAgICB0aGlzLmFkZChjaGlsZC5jbG9uZSgpKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQp9Ck9iamVjdDNELkRlZmF1bHRVcCA9IG5ldyBWZWN0b3IzKDAsIDEsIDApOwpPYmplY3QzRC5EZWZhdWx0TWF0cml4QXV0b1VwZGF0ZSA9IHRydWU7Ck9iamVjdDNELnByb3RvdHlwZS5pc09iamVjdDNEID0gdHJ1ZTsKY29uc3QgX3YwJDEgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3YxJDMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3YyJDIgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3YzJDEgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3ZhYiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfdmFjID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF92YmMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3ZhcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfdmJwID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF92Y3AgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY2xhc3MgVHJpYW5nbGUgewogIGNvbnN0cnVjdG9yKGEgPSBuZXcgVmVjdG9yMygpLCBiID0gbmV3IFZlY3RvcjMoKSwgYyA9IG5ldyBWZWN0b3IzKCkpIHsKICAgIHRoaXMuYSA9IGE7CiAgICB0aGlzLmIgPSBiOwogICAgdGhpcy5jID0gYzsKICB9CiAgc3RhdGljIGdldE5vcm1hbChhLCBiLCBjLCB0YXJnZXQpIHsKICAgIHRhcmdldC5zdWJWZWN0b3JzKGMsIGIpOwogICAgX3YwJDEuc3ViVmVjdG9ycyhhLCBiKTsKICAgIHRhcmdldC5jcm9zcyhfdjAkMSk7CiAgICBjb25zdCB0YXJnZXRMZW5ndGhTcSA9IHRhcmdldC5sZW5ndGhTcSgpOwogICAgaWYgKHRhcmdldExlbmd0aFNxID4gMCkgewogICAgICByZXR1cm4gdGFyZ2V0Lm11bHRpcGx5U2NhbGFyKDEgLyBNYXRoLnNxcnQodGFyZ2V0TGVuZ3RoU3EpKTsKICAgIH0KICAgIHJldHVybiB0YXJnZXQuc2V0KDAsIDAsIDApOwogIH0KICBzdGF0aWMgZ2V0QmFyeWNvb3JkKHBvaW50LCBhLCBiLCBjLCB0YXJnZXQpIHsKICAgIF92MCQxLnN1YlZlY3RvcnMoYywgYSk7CiAgICBfdjEkMy5zdWJWZWN0b3JzKGIsIGEpOwogICAgX3YyJDIuc3ViVmVjdG9ycyhwb2ludCwgYSk7CiAgICBjb25zdCBkb3QwMCA9IF92MCQxLmRvdChfdjAkMSk7CiAgICBjb25zdCBkb3QwMSA9IF92MCQxLmRvdChfdjEkMyk7CiAgICBjb25zdCBkb3QwMiA9IF92MCQxLmRvdChfdjIkMik7CiAgICBjb25zdCBkb3QxMSA9IF92MSQzLmRvdChfdjEkMyk7CiAgICBjb25zdCBkb3QxMiA9IF92MSQzLmRvdChfdjIkMik7CiAgICBjb25zdCBkZW5vbSA9IGRvdDAwICogZG90MTEgLSBkb3QwMSAqIGRvdDAxOwogICAgaWYgKGRlbm9tID09PSAwKSB7CiAgICAgIHJldHVybiB0YXJnZXQuc2V0KC0yLCAtMSwgLTEpOwogICAgfQogICAgY29uc3QgaW52RGVub20gPSAxIC8gZGVub207CiAgICBjb25zdCB1ID0gKGRvdDExICogZG90MDIgLSBkb3QwMSAqIGRvdDEyKSAqIGludkRlbm9tOwogICAgY29uc3QgdiA9IChkb3QwMCAqIGRvdDEyIC0gZG90MDEgKiBkb3QwMikgKiBpbnZEZW5vbTsKICAgIHJldHVybiB0YXJnZXQuc2V0KDEgLSB1IC0gdiwgdiwgdSk7CiAgfQogIHN0YXRpYyBjb250YWluc1BvaW50KHBvaW50LCBhLCBiLCBjKSB7CiAgICB0aGlzLmdldEJhcnljb29yZChwb2ludCwgYSwgYiwgYywgX3YzJDEpOwogICAgcmV0dXJuIF92MyQxLnggPj0gMCAmJiBfdjMkMS55ID49IDAgJiYgX3YzJDEueCArIF92MyQxLnkgPD0gMTsKICB9CiAgc3RhdGljIGdldFVWKHBvaW50LCBwMSwgcDIsIHAzLCB1djEsIHV2MiwgdXYzLCB0YXJnZXQpIHsKICAgIHRoaXMuZ2V0QmFyeWNvb3JkKHBvaW50LCBwMSwgcDIsIHAzLCBfdjMkMSk7CiAgICB0YXJnZXQuc2V0KDAsIDApOwogICAgdGFyZ2V0LmFkZFNjYWxlZFZlY3Rvcih1djEsIF92MyQxLngpOwogICAgdGFyZ2V0LmFkZFNjYWxlZFZlY3Rvcih1djIsIF92MyQxLnkpOwogICAgdGFyZ2V0LmFkZFNjYWxlZFZlY3Rvcih1djMsIF92MyQxLnopOwogICAgcmV0dXJuIHRhcmdldDsKICB9CiAgc3RhdGljIGlzRnJvbnRGYWNpbmcoYSwgYiwgYywgZGlyZWN0aW9uKSB7CiAgICBfdjAkMS5zdWJWZWN0b3JzKGMsIGIpOwogICAgX3YxJDMuc3ViVmVjdG9ycyhhLCBiKTsKICAgIHJldHVybiBfdjAkMS5jcm9zcyhfdjEkMykuZG90KGRpcmVjdGlvbikgPCAwID8gdHJ1ZSA6IGZhbHNlOwogIH0KICBzZXQoYSwgYiwgYykgewogICAgdGhpcy5hLmNvcHkoYSk7CiAgICB0aGlzLmIuY29weShiKTsKICAgIHRoaXMuYy5jb3B5KGMpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldEZyb21Qb2ludHNBbmRJbmRpY2VzKHBvaW50cywgaTAsIGkxLCBpMikgewogICAgdGhpcy5hLmNvcHkocG9pbnRzW2kwXSk7CiAgICB0aGlzLmIuY29weShwb2ludHNbaTFdKTsKICAgIHRoaXMuYy5jb3B5KHBvaW50c1tpMl0pOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldEZyb21BdHRyaWJ1dGVBbmRJbmRpY2VzKGF0dHJpYnV0ZSwgaTAsIGkxLCBpMikgewogICAgdGhpcy5hLmZyb21CdWZmZXJBdHRyaWJ1dGUoYXR0cmlidXRlLCBpMCk7CiAgICB0aGlzLmIuZnJvbUJ1ZmZlckF0dHJpYnV0ZShhdHRyaWJ1dGUsIGkxKTsKICAgIHRoaXMuYy5mcm9tQnVmZmVyQXR0cmlidXRlKGF0dHJpYnV0ZSwgaTIpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKCkuY29weSh0aGlzKTsKICB9CiAgY29weSh0cmlhbmdsZSkgewogICAgdGhpcy5hLmNvcHkodHJpYW5nbGUuYSk7CiAgICB0aGlzLmIuY29weSh0cmlhbmdsZS5iKTsKICAgIHRoaXMuYy5jb3B5KHRyaWFuZ2xlLmMpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGdldEFyZWEoKSB7CiAgICBfdjAkMS5zdWJWZWN0b3JzKHRoaXMuYywgdGhpcy5iKTsKICAgIF92MSQzLnN1YlZlY3RvcnModGhpcy5hLCB0aGlzLmIpOwogICAgcmV0dXJuIF92MCQxLmNyb3NzKF92MSQzKS5sZW5ndGgoKSAqIDAuNTsKICB9CiAgZ2V0TWlkcG9pbnQodGFyZ2V0KSB7CiAgICByZXR1cm4gdGFyZ2V0LmFkZFZlY3RvcnModGhpcy5hLCB0aGlzLmIpLmFkZCh0aGlzLmMpLm11bHRpcGx5U2NhbGFyKDEgLyAzKTsKICB9CiAgZ2V0Tm9ybWFsKHRhcmdldCkgewogICAgcmV0dXJuIFRyaWFuZ2xlLmdldE5vcm1hbCh0aGlzLmEsIHRoaXMuYiwgdGhpcy5jLCB0YXJnZXQpOwogIH0KICBnZXRQbGFuZSh0YXJnZXQpIHsKICAgIHJldHVybiB0YXJnZXQuc2V0RnJvbUNvcGxhbmFyUG9pbnRzKHRoaXMuYSwgdGhpcy5iLCB0aGlzLmMpOwogIH0KICBnZXRCYXJ5Y29vcmQocG9pbnQsIHRhcmdldCkgewogICAgcmV0dXJuIFRyaWFuZ2xlLmdldEJhcnljb29yZChwb2ludCwgdGhpcy5hLCB0aGlzLmIsIHRoaXMuYywgdGFyZ2V0KTsKICB9CiAgZ2V0VVYocG9pbnQsIHV2MSwgdXYyLCB1djMsIHRhcmdldCkgewogICAgcmV0dXJuIFRyaWFuZ2xlLmdldFVWKHBvaW50LCB0aGlzLmEsIHRoaXMuYiwgdGhpcy5jLCB1djEsIHV2MiwgdXYzLCB0YXJnZXQpOwogIH0KICBjb250YWluc1BvaW50KHBvaW50KSB7CiAgICByZXR1cm4gVHJpYW5nbGUuY29udGFpbnNQb2ludChwb2ludCwgdGhpcy5hLCB0aGlzLmIsIHRoaXMuYyk7CiAgfQogIGlzRnJvbnRGYWNpbmcoZGlyZWN0aW9uKSB7CiAgICByZXR1cm4gVHJpYW5nbGUuaXNGcm9udEZhY2luZyh0aGlzLmEsIHRoaXMuYiwgdGhpcy5jLCBkaXJlY3Rpb24pOwogIH0KICBpbnRlcnNlY3RzQm94KGJveCkgewogICAgcmV0dXJuIGJveC5pbnRlcnNlY3RzVHJpYW5nbGUodGhpcyk7CiAgfQogIGNsb3Nlc3RQb2ludFRvUG9pbnQocCwgdGFyZ2V0KSB7CiAgICBjb25zdCBhID0gdGhpcy5hLCBiID0gdGhpcy5iLCBjID0gdGhpcy5jOwogICAgbGV0IHYsIHc7CiAgICBfdmFiLnN1YlZlY3RvcnMoYiwgYSk7CiAgICBfdmFjLnN1YlZlY3RvcnMoYywgYSk7CiAgICBfdmFwLnN1YlZlY3RvcnMocCwgYSk7CiAgICBjb25zdCBkMSA9IF92YWIuZG90KF92YXApOwogICAgY29uc3QgZDIgPSBfdmFjLmRvdChfdmFwKTsKICAgIGlmIChkMSA8PSAwICYmIGQyIDw9IDApIHsKICAgICAgcmV0dXJuIHRhcmdldC5jb3B5KGEpOwogICAgfQogICAgX3ZicC5zdWJWZWN0b3JzKHAsIGIpOwogICAgY29uc3QgZDMgPSBfdmFiLmRvdChfdmJwKTsKICAgIGNvbnN0IGQ0ID0gX3ZhYy5kb3QoX3ZicCk7CiAgICBpZiAoZDMgPj0gMCAmJiBkNCA8PSBkMykgewogICAgICByZXR1cm4gdGFyZ2V0LmNvcHkoYik7CiAgICB9CiAgICBjb25zdCB2YyA9IGQxICogZDQgLSBkMyAqIGQyOwogICAgaWYgKHZjIDw9IDAgJiYgZDEgPj0gMCAmJiBkMyA8PSAwKSB7CiAgICAgIHYgPSBkMSAvIChkMSAtIGQzKTsKICAgICAgcmV0dXJuIHRhcmdldC5jb3B5KGEpLmFkZFNjYWxlZFZlY3RvcihfdmFiLCB2KTsKICAgIH0KICAgIF92Y3Auc3ViVmVjdG9ycyhwLCBjKTsKICAgIGNvbnN0IGQ1ID0gX3ZhYi5kb3QoX3ZjcCk7CiAgICBjb25zdCBkNiA9IF92YWMuZG90KF92Y3ApOwogICAgaWYgKGQ2ID49IDAgJiYgZDUgPD0gZDYpIHsKICAgICAgcmV0dXJuIHRhcmdldC5jb3B5KGMpOwogICAgfQogICAgY29uc3QgdmIgPSBkNSAqIGQyIC0gZDEgKiBkNjsKICAgIGlmICh2YiA8PSAwICYmIGQyID49IDAgJiYgZDYgPD0gMCkgewogICAgICB3ID0gZDIgLyAoZDIgLSBkNik7CiAgICAgIHJldHVybiB0YXJnZXQuY29weShhKS5hZGRTY2FsZWRWZWN0b3IoX3ZhYywgdyk7CiAgICB9CiAgICBjb25zdCB2YSA9IGQzICogZDYgLSBkNSAqIGQ0OwogICAgaWYgKHZhIDw9IDAgJiYgZDQgLSBkMyA+PSAwICYmIGQ1IC0gZDYgPj0gMCkgewogICAgICBfdmJjLnN1YlZlY3RvcnMoYywgYik7CiAgICAgIHcgPSAoZDQgLSBkMykgLyAoZDQgLSBkMyArIChkNSAtIGQ2KSk7CiAgICAgIHJldHVybiB0YXJnZXQuY29weShiKS5hZGRTY2FsZWRWZWN0b3IoX3ZiYywgdyk7CiAgICB9CiAgICBjb25zdCBkZW5vbSA9IDEgLyAodmEgKyB2YiArIHZjKTsKICAgIHYgPSB2YiAqIGRlbm9tOwogICAgdyA9IHZjICogZGVub207CiAgICByZXR1cm4gdGFyZ2V0LmNvcHkoYSkuYWRkU2NhbGVkVmVjdG9yKF92YWIsIHYpLmFkZFNjYWxlZFZlY3RvcihfdmFjLCB3KTsKICB9CiAgZXF1YWxzKHRyaWFuZ2xlKSB7CiAgICByZXR1cm4gdHJpYW5nbGUuYS5lcXVhbHModGhpcy5hKSAmJiB0cmlhbmdsZS5iLmVxdWFscyh0aGlzLmIpICYmIHRyaWFuZ2xlLmMuZXF1YWxzKHRoaXMuYyk7CiAgfQp9CmxldCBtYXRlcmlhbElkID0gMDsKY2xhc3MgTWF0ZXJpYWwgZXh0ZW5kcyBFdmVudERpc3BhdGNoZXIgewogIGNvbnN0cnVjdG9yKCkgewogICAgc3VwZXIoKTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiaWQiLCB7IHZhbHVlOiBtYXRlcmlhbElkKysgfSk7CiAgICB0aGlzLnV1aWQgPSBnZW5lcmF0ZVVVSUQoKTsKICAgIHRoaXMubmFtZSA9ICIiOwogICAgdGhpcy50eXBlID0gIk1hdGVyaWFsIjsKICAgIHRoaXMuZm9nID0gdHJ1ZTsKICAgIHRoaXMuYmxlbmRpbmcgPSBOb3JtYWxCbGVuZGluZzsKICAgIHRoaXMuc2lkZSA9IEZyb250U2lkZTsKICAgIHRoaXMudmVydGV4Q29sb3JzID0gZmFsc2U7CiAgICB0aGlzLm9wYWNpdHkgPSAxOwogICAgdGhpcy50cmFuc3BhcmVudCA9IGZhbHNlOwogICAgdGhpcy5ibGVuZFNyYyA9IFNyY0FscGhhRmFjdG9yOwogICAgdGhpcy5ibGVuZERzdCA9IE9uZU1pbnVzU3JjQWxwaGFGYWN0b3I7CiAgICB0aGlzLmJsZW5kRXF1YXRpb24gPSBBZGRFcXVhdGlvbjsKICAgIHRoaXMuYmxlbmRTcmNBbHBoYSA9IG51bGw7CiAgICB0aGlzLmJsZW5kRHN0QWxwaGEgPSBudWxsOwogICAgdGhpcy5ibGVuZEVxdWF0aW9uQWxwaGEgPSBudWxsOwogICAgdGhpcy5kZXB0aEZ1bmMgPSBMZXNzRXF1YWxEZXB0aDsKICAgIHRoaXMuZGVwdGhUZXN0ID0gdHJ1ZTsKICAgIHRoaXMuZGVwdGhXcml0ZSA9IHRydWU7CiAgICB0aGlzLnN0ZW5jaWxXcml0ZU1hc2sgPSAyNTU7CiAgICB0aGlzLnN0ZW5jaWxGdW5jID0gQWx3YXlzU3RlbmNpbEZ1bmM7CiAgICB0aGlzLnN0ZW5jaWxSZWYgPSAwOwogICAgdGhpcy5zdGVuY2lsRnVuY01hc2sgPSAyNTU7CiAgICB0aGlzLnN0ZW5jaWxGYWlsID0gS2VlcFN0ZW5jaWxPcDsKICAgIHRoaXMuc3RlbmNpbFpGYWlsID0gS2VlcFN0ZW5jaWxPcDsKICAgIHRoaXMuc3RlbmNpbFpQYXNzID0gS2VlcFN0ZW5jaWxPcDsKICAgIHRoaXMuc3RlbmNpbFdyaXRlID0gZmFsc2U7CiAgICB0aGlzLmNsaXBwaW5nUGxhbmVzID0gbnVsbDsKICAgIHRoaXMuY2xpcEludGVyc2VjdGlvbiA9IGZhbHNlOwogICAgdGhpcy5jbGlwU2hhZG93cyA9IGZhbHNlOwogICAgdGhpcy5zaGFkb3dTaWRlID0gbnVsbDsKICAgIHRoaXMuY29sb3JXcml0ZSA9IHRydWU7CiAgICB0aGlzLnByZWNpc2lvbiA9IG51bGw7CiAgICB0aGlzLnBvbHlnb25PZmZzZXQgPSBmYWxzZTsKICAgIHRoaXMucG9seWdvbk9mZnNldEZhY3RvciA9IDA7CiAgICB0aGlzLnBvbHlnb25PZmZzZXRVbml0cyA9IDA7CiAgICB0aGlzLmRpdGhlcmluZyA9IGZhbHNlOwogICAgdGhpcy5hbHBoYVRvQ292ZXJhZ2UgPSBmYWxzZTsKICAgIHRoaXMucHJlbXVsdGlwbGllZEFscGhhID0gZmFsc2U7CiAgICB0aGlzLnZpc2libGUgPSB0cnVlOwogICAgdGhpcy50b25lTWFwcGVkID0gdHJ1ZTsKICAgIHRoaXMudXNlckRhdGEgPSB7fTsKICAgIHRoaXMudmVyc2lvbiA9IDA7CiAgICB0aGlzLl9hbHBoYVRlc3QgPSAwOwogIH0KICBnZXQgYWxwaGFUZXN0KCkgewogICAgcmV0dXJuIHRoaXMuX2FscGhhVGVzdDsKICB9CiAgc2V0IGFscGhhVGVzdCh2YWx1ZSkgewogICAgaWYgKHRoaXMuX2FscGhhVGVzdCA+IDAgIT09IHZhbHVlID4gMCkgewogICAgICB0aGlzLnZlcnNpb24rKzsKICAgIH0KICAgIHRoaXMuX2FscGhhVGVzdCA9IHZhbHVlOwogIH0KICBvbkJ1aWxkKCkgewogIH0KICBvbkJlZm9yZVJlbmRlcigpIHsKICB9CiAgb25CZWZvcmVDb21waWxlKCkgewogIH0KICBjdXN0b21Qcm9ncmFtQ2FjaGVLZXkoKSB7CiAgICByZXR1cm4gdGhpcy5vbkJlZm9yZUNvbXBpbGUudG9TdHJpbmcoKTsKICB9CiAgc2V0VmFsdWVzKHZhbHVlcykgewogICAgaWYgKHZhbHVlcyA9PT0gdm9pZCAwKQogICAgICByZXR1cm47CiAgICBmb3IgKGNvbnN0IGtleSBpbiB2YWx1ZXMpIHsKICAgICAgY29uc3QgbmV3VmFsdWUgPSB2YWx1ZXNba2V5XTsKICAgICAgaWYgKG5ld1ZhbHVlID09PSB2b2lkIDApIHsKICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLk1hdGVyaWFsOiAnIiArIGtleSArICInIHBhcmFtZXRlciBpcyB1bmRlZmluZWQuIik7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgaWYgKGtleSA9PT0gInNoYWRpbmciKSB7CiAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS4iICsgdGhpcy50eXBlICsgIjogLnNoYWRpbmcgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIHRoZSBib29sZWFuIC5mbGF0U2hhZGluZyBpbnN0ZWFkLiIpOwogICAgICAgIHRoaXMuZmxhdFNoYWRpbmcgPSBuZXdWYWx1ZSA9PT0gRmxhdFNoYWRpbmcgPyB0cnVlIDogZmFsc2U7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgY29uc3QgY3VycmVudFZhbHVlID0gdGhpc1trZXldOwogICAgICBpZiAoY3VycmVudFZhbHVlID09PSB2b2lkIDApIHsKICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLiIgKyB0aGlzLnR5cGUgKyAiOiAnIiArIGtleSArICInIGlzIG5vdCBhIHByb3BlcnR5IG9mIHRoaXMgbWF0ZXJpYWwuIik7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgaWYgKGN1cnJlbnRWYWx1ZSAmJiBjdXJyZW50VmFsdWUuaXNDb2xvcikgewogICAgICAgIGN1cnJlbnRWYWx1ZS5zZXQobmV3VmFsdWUpOwogICAgICB9IGVsc2UgaWYgKGN1cnJlbnRWYWx1ZSAmJiBjdXJyZW50VmFsdWUuaXNWZWN0b3IzICYmIChuZXdWYWx1ZSAmJiBuZXdWYWx1ZS5pc1ZlY3RvcjMpKSB7CiAgICAgICAgY3VycmVudFZhbHVlLmNvcHkobmV3VmFsdWUpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXNba2V5XSA9IG5ld1ZhbHVlOwogICAgICB9CiAgICB9CiAgfQogIHRvSlNPTihtZXRhKSB7CiAgICBjb25zdCBpc1Jvb3QgPSBtZXRhID09PSB2b2lkIDAgfHwgdHlwZW9mIG1ldGEgPT09ICJzdHJpbmciOwogICAgaWYgKGlzUm9vdCkgewogICAgICBtZXRhID0gewogICAgICAgIHRleHR1cmVzOiB7fSwKICAgICAgICBpbWFnZXM6IHt9CiAgICAgIH07CiAgICB9CiAgICBjb25zdCBkYXRhID0gewogICAgICBtZXRhZGF0YTogewogICAgICAgIHZlcnNpb246IDQuNSwKICAgICAgICB0eXBlOiAiTWF0ZXJpYWwiLAogICAgICAgIGdlbmVyYXRvcjogIk1hdGVyaWFsLnRvSlNPTiIKICAgICAgfQogICAgfTsKICAgIGRhdGEudXVpZCA9IHRoaXMudXVpZDsKICAgIGRhdGEudHlwZSA9IHRoaXMudHlwZTsKICAgIGlmICh0aGlzLm5hbWUgIT09ICIiKQogICAgICBkYXRhLm5hbWUgPSB0aGlzLm5hbWU7CiAgICBpZiAodGhpcy5jb2xvciAmJiB0aGlzLmNvbG9yLmlzQ29sb3IpCiAgICAgIGRhdGEuY29sb3IgPSB0aGlzLmNvbG9yLmdldEhleCgpOwogICAgaWYgKHRoaXMucm91Z2huZXNzICE9PSB2b2lkIDApCiAgICAgIGRhdGEucm91Z2huZXNzID0gdGhpcy5yb3VnaG5lc3M7CiAgICBpZiAodGhpcy5tZXRhbG5lc3MgIT09IHZvaWQgMCkKICAgICAgZGF0YS5tZXRhbG5lc3MgPSB0aGlzLm1ldGFsbmVzczsKICAgIGlmICh0aGlzLnNoZWVuICE9PSB2b2lkIDApCiAgICAgIGRhdGEuc2hlZW4gPSB0aGlzLnNoZWVuOwogICAgaWYgKHRoaXMuc2hlZW5Db2xvciAmJiB0aGlzLnNoZWVuQ29sb3IuaXNDb2xvcikKICAgICAgZGF0YS5zaGVlbkNvbG9yID0gdGhpcy5zaGVlbkNvbG9yLmdldEhleCgpOwogICAgaWYgKHRoaXMuc2hlZW5Sb3VnaG5lc3MgIT09IHZvaWQgMCkKICAgICAgZGF0YS5zaGVlblJvdWdobmVzcyA9IHRoaXMuc2hlZW5Sb3VnaG5lc3M7CiAgICBpZiAodGhpcy5lbWlzc2l2ZSAmJiB0aGlzLmVtaXNzaXZlLmlzQ29sb3IpCiAgICAgIGRhdGEuZW1pc3NpdmUgPSB0aGlzLmVtaXNzaXZlLmdldEhleCgpOwogICAgaWYgKHRoaXMuZW1pc3NpdmVJbnRlbnNpdHkgJiYgdGhpcy5lbWlzc2l2ZUludGVuc2l0eSAhPT0gMSkKICAgICAgZGF0YS5lbWlzc2l2ZUludGVuc2l0eSA9IHRoaXMuZW1pc3NpdmVJbnRlbnNpdHk7CiAgICBpZiAodGhpcy5zcGVjdWxhciAmJiB0aGlzLnNwZWN1bGFyLmlzQ29sb3IpCiAgICAgIGRhdGEuc3BlY3VsYXIgPSB0aGlzLnNwZWN1bGFyLmdldEhleCgpOwogICAgaWYgKHRoaXMuc3BlY3VsYXJJbnRlbnNpdHkgIT09IHZvaWQgMCkKICAgICAgZGF0YS5zcGVjdWxhckludGVuc2l0eSA9IHRoaXMuc3BlY3VsYXJJbnRlbnNpdHk7CiAgICBpZiAodGhpcy5zcGVjdWxhckNvbG9yICYmIHRoaXMuc3BlY3VsYXJDb2xvci5pc0NvbG9yKQogICAgICBkYXRhLnNwZWN1bGFyQ29sb3IgPSB0aGlzLnNwZWN1bGFyQ29sb3IuZ2V0SGV4KCk7CiAgICBpZiAodGhpcy5zaGluaW5lc3MgIT09IHZvaWQgMCkKICAgICAgZGF0YS5zaGluaW5lc3MgPSB0aGlzLnNoaW5pbmVzczsKICAgIGlmICh0aGlzLmNsZWFyY29hdCAhPT0gdm9pZCAwKQogICAgICBkYXRhLmNsZWFyY29hdCA9IHRoaXMuY2xlYXJjb2F0OwogICAgaWYgKHRoaXMuY2xlYXJjb2F0Um91Z2huZXNzICE9PSB2b2lkIDApCiAgICAgIGRhdGEuY2xlYXJjb2F0Um91Z2huZXNzID0gdGhpcy5jbGVhcmNvYXRSb3VnaG5lc3M7CiAgICBpZiAodGhpcy5jbGVhcmNvYXRNYXAgJiYgdGhpcy5jbGVhcmNvYXRNYXAuaXNUZXh0dXJlKSB7CiAgICAgIGRhdGEuY2xlYXJjb2F0TWFwID0gdGhpcy5jbGVhcmNvYXRNYXAudG9KU09OKG1ldGEpLnV1aWQ7CiAgICB9CiAgICBpZiAodGhpcy5jbGVhcmNvYXRSb3VnaG5lc3NNYXAgJiYgdGhpcy5jbGVhcmNvYXRSb3VnaG5lc3NNYXAuaXNUZXh0dXJlKSB7CiAgICAgIGRhdGEuY2xlYXJjb2F0Um91Z2huZXNzTWFwID0gdGhpcy5jbGVhcmNvYXRSb3VnaG5lc3NNYXAudG9KU09OKG1ldGEpLnV1aWQ7CiAgICB9CiAgICBpZiAodGhpcy5jbGVhcmNvYXROb3JtYWxNYXAgJiYgdGhpcy5jbGVhcmNvYXROb3JtYWxNYXAuaXNUZXh0dXJlKSB7CiAgICAgIGRhdGEuY2xlYXJjb2F0Tm9ybWFsTWFwID0gdGhpcy5jbGVhcmNvYXROb3JtYWxNYXAudG9KU09OKG1ldGEpLnV1aWQ7CiAgICAgIGRhdGEuY2xlYXJjb2F0Tm9ybWFsU2NhbGUgPSB0aGlzLmNsZWFyY29hdE5vcm1hbFNjYWxlLnRvQXJyYXkoKTsKICAgIH0KICAgIGlmICh0aGlzLm1hcCAmJiB0aGlzLm1hcC5pc1RleHR1cmUpCiAgICAgIGRhdGEubWFwID0gdGhpcy5tYXAudG9KU09OKG1ldGEpLnV1aWQ7CiAgICBpZiAodGhpcy5tYXRjYXAgJiYgdGhpcy5tYXRjYXAuaXNUZXh0dXJlKQogICAgICBkYXRhLm1hdGNhcCA9IHRoaXMubWF0Y2FwLnRvSlNPTihtZXRhKS51dWlkOwogICAgaWYgKHRoaXMuYWxwaGFNYXAgJiYgdGhpcy5hbHBoYU1hcC5pc1RleHR1cmUpCiAgICAgIGRhdGEuYWxwaGFNYXAgPSB0aGlzLmFscGhhTWFwLnRvSlNPTihtZXRhKS51dWlkOwogICAgaWYgKHRoaXMubGlnaHRNYXAgJiYgdGhpcy5saWdodE1hcC5pc1RleHR1cmUpIHsKICAgICAgZGF0YS5saWdodE1hcCA9IHRoaXMubGlnaHRNYXAudG9KU09OKG1ldGEpLnV1aWQ7CiAgICAgIGRhdGEubGlnaHRNYXBJbnRlbnNpdHkgPSB0aGlzLmxpZ2h0TWFwSW50ZW5zaXR5OwogICAgfQogICAgaWYgKHRoaXMuYW9NYXAgJiYgdGhpcy5hb01hcC5pc1RleHR1cmUpIHsKICAgICAgZGF0YS5hb01hcCA9IHRoaXMuYW9NYXAudG9KU09OKG1ldGEpLnV1aWQ7CiAgICAgIGRhdGEuYW9NYXBJbnRlbnNpdHkgPSB0aGlzLmFvTWFwSW50ZW5zaXR5OwogICAgfQogICAgaWYgKHRoaXMuYnVtcE1hcCAmJiB0aGlzLmJ1bXBNYXAuaXNUZXh0dXJlKSB7CiAgICAgIGRhdGEuYnVtcE1hcCA9IHRoaXMuYnVtcE1hcC50b0pTT04obWV0YSkudXVpZDsKICAgICAgZGF0YS5idW1wU2NhbGUgPSB0aGlzLmJ1bXBTY2FsZTsKICAgIH0KICAgIGlmICh0aGlzLm5vcm1hbE1hcCAmJiB0aGlzLm5vcm1hbE1hcC5pc1RleHR1cmUpIHsKICAgICAgZGF0YS5ub3JtYWxNYXAgPSB0aGlzLm5vcm1hbE1hcC50b0pTT04obWV0YSkudXVpZDsKICAgICAgZGF0YS5ub3JtYWxNYXBUeXBlID0gdGhpcy5ub3JtYWxNYXBUeXBlOwogICAgICBkYXRhLm5vcm1hbFNjYWxlID0gdGhpcy5ub3JtYWxTY2FsZS50b0FycmF5KCk7CiAgICB9CiAgICBpZiAodGhpcy5kaXNwbGFjZW1lbnRNYXAgJiYgdGhpcy5kaXNwbGFjZW1lbnRNYXAuaXNUZXh0dXJlKSB7CiAgICAgIGRhdGEuZGlzcGxhY2VtZW50TWFwID0gdGhpcy5kaXNwbGFjZW1lbnRNYXAudG9KU09OKG1ldGEpLnV1aWQ7CiAgICAgIGRhdGEuZGlzcGxhY2VtZW50U2NhbGUgPSB0aGlzLmRpc3BsYWNlbWVudFNjYWxlOwogICAgICBkYXRhLmRpc3BsYWNlbWVudEJpYXMgPSB0aGlzLmRpc3BsYWNlbWVudEJpYXM7CiAgICB9CiAgICBpZiAodGhpcy5yb3VnaG5lc3NNYXAgJiYgdGhpcy5yb3VnaG5lc3NNYXAuaXNUZXh0dXJlKQogICAgICBkYXRhLnJvdWdobmVzc01hcCA9IHRoaXMucm91Z2huZXNzTWFwLnRvSlNPTihtZXRhKS51dWlkOwogICAgaWYgKHRoaXMubWV0YWxuZXNzTWFwICYmIHRoaXMubWV0YWxuZXNzTWFwLmlzVGV4dHVyZSkKICAgICAgZGF0YS5tZXRhbG5lc3NNYXAgPSB0aGlzLm1ldGFsbmVzc01hcC50b0pTT04obWV0YSkudXVpZDsKICAgIGlmICh0aGlzLmVtaXNzaXZlTWFwICYmIHRoaXMuZW1pc3NpdmVNYXAuaXNUZXh0dXJlKQogICAgICBkYXRhLmVtaXNzaXZlTWFwID0gdGhpcy5lbWlzc2l2ZU1hcC50b0pTT04obWV0YSkudXVpZDsKICAgIGlmICh0aGlzLnNwZWN1bGFyTWFwICYmIHRoaXMuc3BlY3VsYXJNYXAuaXNUZXh0dXJlKQogICAgICBkYXRhLnNwZWN1bGFyTWFwID0gdGhpcy5zcGVjdWxhck1hcC50b0pTT04obWV0YSkudXVpZDsKICAgIGlmICh0aGlzLnNwZWN1bGFySW50ZW5zaXR5TWFwICYmIHRoaXMuc3BlY3VsYXJJbnRlbnNpdHlNYXAuaXNUZXh0dXJlKQogICAgICBkYXRhLnNwZWN1bGFySW50ZW5zaXR5TWFwID0gdGhpcy5zcGVjdWxhckludGVuc2l0eU1hcC50b0pTT04obWV0YSkudXVpZDsKICAgIGlmICh0aGlzLnNwZWN1bGFyQ29sb3JNYXAgJiYgdGhpcy5zcGVjdWxhckNvbG9yTWFwLmlzVGV4dHVyZSkKICAgICAgZGF0YS5zcGVjdWxhckNvbG9yTWFwID0gdGhpcy5zcGVjdWxhckNvbG9yTWFwLnRvSlNPTihtZXRhKS51dWlkOwogICAgaWYgKHRoaXMuZW52TWFwICYmIHRoaXMuZW52TWFwLmlzVGV4dHVyZSkgewogICAgICBkYXRhLmVudk1hcCA9IHRoaXMuZW52TWFwLnRvSlNPTihtZXRhKS51dWlkOwogICAgICBpZiAodGhpcy5jb21iaW5lICE9PSB2b2lkIDApCiAgICAgICAgZGF0YS5jb21iaW5lID0gdGhpcy5jb21iaW5lOwogICAgfQogICAgaWYgKHRoaXMuZW52TWFwSW50ZW5zaXR5ICE9PSB2b2lkIDApCiAgICAgIGRhdGEuZW52TWFwSW50ZW5zaXR5ID0gdGhpcy5lbnZNYXBJbnRlbnNpdHk7CiAgICBpZiAodGhpcy5yZWZsZWN0aXZpdHkgIT09IHZvaWQgMCkKICAgICAgZGF0YS5yZWZsZWN0aXZpdHkgPSB0aGlzLnJlZmxlY3Rpdml0eTsKICAgIGlmICh0aGlzLnJlZnJhY3Rpb25SYXRpbyAhPT0gdm9pZCAwKQogICAgICBkYXRhLnJlZnJhY3Rpb25SYXRpbyA9IHRoaXMucmVmcmFjdGlvblJhdGlvOwogICAgaWYgKHRoaXMuZ3JhZGllbnRNYXAgJiYgdGhpcy5ncmFkaWVudE1hcC5pc1RleHR1cmUpIHsKICAgICAgZGF0YS5ncmFkaWVudE1hcCA9IHRoaXMuZ3JhZGllbnRNYXAudG9KU09OKG1ldGEpLnV1aWQ7CiAgICB9CiAgICBpZiAodGhpcy50cmFuc21pc3Npb24gIT09IHZvaWQgMCkKICAgICAgZGF0YS50cmFuc21pc3Npb24gPSB0aGlzLnRyYW5zbWlzc2lvbjsKICAgIGlmICh0aGlzLnRyYW5zbWlzc2lvbk1hcCAmJiB0aGlzLnRyYW5zbWlzc2lvbk1hcC5pc1RleHR1cmUpCiAgICAgIGRhdGEudHJhbnNtaXNzaW9uTWFwID0gdGhpcy50cmFuc21pc3Npb25NYXAudG9KU09OKG1ldGEpLnV1aWQ7CiAgICBpZiAodGhpcy50aGlja25lc3MgIT09IHZvaWQgMCkKICAgICAgZGF0YS50aGlja25lc3MgPSB0aGlzLnRoaWNrbmVzczsKICAgIGlmICh0aGlzLnRoaWNrbmVzc01hcCAmJiB0aGlzLnRoaWNrbmVzc01hcC5pc1RleHR1cmUpCiAgICAgIGRhdGEudGhpY2tuZXNzTWFwID0gdGhpcy50aGlja25lc3NNYXAudG9KU09OKG1ldGEpLnV1aWQ7CiAgICBpZiAodGhpcy5hdHRlbnVhdGlvbkRpc3RhbmNlICE9PSB2b2lkIDApCiAgICAgIGRhdGEuYXR0ZW51YXRpb25EaXN0YW5jZSA9IHRoaXMuYXR0ZW51YXRpb25EaXN0YW5jZTsKICAgIGlmICh0aGlzLmF0dGVudWF0aW9uQ29sb3IgIT09IHZvaWQgMCkKICAgICAgZGF0YS5hdHRlbnVhdGlvbkNvbG9yID0gdGhpcy5hdHRlbnVhdGlvbkNvbG9yLmdldEhleCgpOwogICAgaWYgKHRoaXMuc2l6ZSAhPT0gdm9pZCAwKQogICAgICBkYXRhLnNpemUgPSB0aGlzLnNpemU7CiAgICBpZiAodGhpcy5zaGFkb3dTaWRlICE9PSBudWxsKQogICAgICBkYXRhLnNoYWRvd1NpZGUgPSB0aGlzLnNoYWRvd1NpZGU7CiAgICBpZiAodGhpcy5zaXplQXR0ZW51YXRpb24gIT09IHZvaWQgMCkKICAgICAgZGF0YS5zaXplQXR0ZW51YXRpb24gPSB0aGlzLnNpemVBdHRlbnVhdGlvbjsKICAgIGlmICh0aGlzLmJsZW5kaW5nICE9PSBOb3JtYWxCbGVuZGluZykKICAgICAgZGF0YS5ibGVuZGluZyA9IHRoaXMuYmxlbmRpbmc7CiAgICBpZiAodGhpcy5zaWRlICE9PSBGcm9udFNpZGUpCiAgICAgIGRhdGEuc2lkZSA9IHRoaXMuc2lkZTsKICAgIGlmICh0aGlzLnZlcnRleENvbG9ycykKICAgICAgZGF0YS52ZXJ0ZXhDb2xvcnMgPSB0cnVlOwogICAgaWYgKHRoaXMub3BhY2l0eSA8IDEpCiAgICAgIGRhdGEub3BhY2l0eSA9IHRoaXMub3BhY2l0eTsKICAgIGlmICh0aGlzLnRyYW5zcGFyZW50ID09PSB0cnVlKQogICAgICBkYXRhLnRyYW5zcGFyZW50ID0gdGhpcy50cmFuc3BhcmVudDsKICAgIGRhdGEuZGVwdGhGdW5jID0gdGhpcy5kZXB0aEZ1bmM7CiAgICBkYXRhLmRlcHRoVGVzdCA9IHRoaXMuZGVwdGhUZXN0OwogICAgZGF0YS5kZXB0aFdyaXRlID0gdGhpcy5kZXB0aFdyaXRlOwogICAgZGF0YS5jb2xvcldyaXRlID0gdGhpcy5jb2xvcldyaXRlOwogICAgZGF0YS5zdGVuY2lsV3JpdGUgPSB0aGlzLnN0ZW5jaWxXcml0ZTsKICAgIGRhdGEuc3RlbmNpbFdyaXRlTWFzayA9IHRoaXMuc3RlbmNpbFdyaXRlTWFzazsKICAgIGRhdGEuc3RlbmNpbEZ1bmMgPSB0aGlzLnN0ZW5jaWxGdW5jOwogICAgZGF0YS5zdGVuY2lsUmVmID0gdGhpcy5zdGVuY2lsUmVmOwogICAgZGF0YS5zdGVuY2lsRnVuY01hc2sgPSB0aGlzLnN0ZW5jaWxGdW5jTWFzazsKICAgIGRhdGEuc3RlbmNpbEZhaWwgPSB0aGlzLnN0ZW5jaWxGYWlsOwogICAgZGF0YS5zdGVuY2lsWkZhaWwgPSB0aGlzLnN0ZW5jaWxaRmFpbDsKICAgIGRhdGEuc3RlbmNpbFpQYXNzID0gdGhpcy5zdGVuY2lsWlBhc3M7CiAgICBpZiAodGhpcy5yb3RhdGlvbiAmJiB0aGlzLnJvdGF0aW9uICE9PSAwKQogICAgICBkYXRhLnJvdGF0aW9uID0gdGhpcy5yb3RhdGlvbjsKICAgIGlmICh0aGlzLnBvbHlnb25PZmZzZXQgPT09IHRydWUpCiAgICAgIGRhdGEucG9seWdvbk9mZnNldCA9IHRydWU7CiAgICBpZiAodGhpcy5wb2x5Z29uT2Zmc2V0RmFjdG9yICE9PSAwKQogICAgICBkYXRhLnBvbHlnb25PZmZzZXRGYWN0b3IgPSB0aGlzLnBvbHlnb25PZmZzZXRGYWN0b3I7CiAgICBpZiAodGhpcy5wb2x5Z29uT2Zmc2V0VW5pdHMgIT09IDApCiAgICAgIGRhdGEucG9seWdvbk9mZnNldFVuaXRzID0gdGhpcy5wb2x5Z29uT2Zmc2V0VW5pdHM7CiAgICBpZiAodGhpcy5saW5ld2lkdGggJiYgdGhpcy5saW5ld2lkdGggIT09IDEpCiAgICAgIGRhdGEubGluZXdpZHRoID0gdGhpcy5saW5ld2lkdGg7CiAgICBpZiAodGhpcy5kYXNoU2l6ZSAhPT0gdm9pZCAwKQogICAgICBkYXRhLmRhc2hTaXplID0gdGhpcy5kYXNoU2l6ZTsKICAgIGlmICh0aGlzLmdhcFNpemUgIT09IHZvaWQgMCkKICAgICAgZGF0YS5nYXBTaXplID0gdGhpcy5nYXBTaXplOwogICAgaWYgKHRoaXMuc2NhbGUgIT09IHZvaWQgMCkKICAgICAgZGF0YS5zY2FsZSA9IHRoaXMuc2NhbGU7CiAgICBpZiAodGhpcy5kaXRoZXJpbmcgPT09IHRydWUpCiAgICAgIGRhdGEuZGl0aGVyaW5nID0gdHJ1ZTsKICAgIGlmICh0aGlzLmFscGhhVGVzdCA+IDApCiAgICAgIGRhdGEuYWxwaGFUZXN0ID0gdGhpcy5hbHBoYVRlc3Q7CiAgICBpZiAodGhpcy5hbHBoYVRvQ292ZXJhZ2UgPT09IHRydWUpCiAgICAgIGRhdGEuYWxwaGFUb0NvdmVyYWdlID0gdGhpcy5hbHBoYVRvQ292ZXJhZ2U7CiAgICBpZiAodGhpcy5wcmVtdWx0aXBsaWVkQWxwaGEgPT09IHRydWUpCiAgICAgIGRhdGEucHJlbXVsdGlwbGllZEFscGhhID0gdGhpcy5wcmVtdWx0aXBsaWVkQWxwaGE7CiAgICBpZiAodGhpcy53aXJlZnJhbWUgPT09IHRydWUpCiAgICAgIGRhdGEud2lyZWZyYW1lID0gdGhpcy53aXJlZnJhbWU7CiAgICBpZiAodGhpcy53aXJlZnJhbWVMaW5ld2lkdGggPiAxKQogICAgICBkYXRhLndpcmVmcmFtZUxpbmV3aWR0aCA9IHRoaXMud2lyZWZyYW1lTGluZXdpZHRoOwogICAgaWYgKHRoaXMud2lyZWZyYW1lTGluZWNhcCAhPT0gInJvdW5kIikKICAgICAgZGF0YS53aXJlZnJhbWVMaW5lY2FwID0gdGhpcy53aXJlZnJhbWVMaW5lY2FwOwogICAgaWYgKHRoaXMud2lyZWZyYW1lTGluZWpvaW4gIT09ICJyb3VuZCIpCiAgICAgIGRhdGEud2lyZWZyYW1lTGluZWpvaW4gPSB0aGlzLndpcmVmcmFtZUxpbmVqb2luOwogICAgaWYgKHRoaXMuZmxhdFNoYWRpbmcgPT09IHRydWUpCiAgICAgIGRhdGEuZmxhdFNoYWRpbmcgPSB0aGlzLmZsYXRTaGFkaW5nOwogICAgaWYgKHRoaXMudmlzaWJsZSA9PT0gZmFsc2UpCiAgICAgIGRhdGEudmlzaWJsZSA9IGZhbHNlOwogICAgaWYgKHRoaXMudG9uZU1hcHBlZCA9PT0gZmFsc2UpCiAgICAgIGRhdGEudG9uZU1hcHBlZCA9IGZhbHNlOwogICAgaWYgKEpTT04uc3RyaW5naWZ5KHRoaXMudXNlckRhdGEpICE9PSAie30iKQogICAgICBkYXRhLnVzZXJEYXRhID0gdGhpcy51c2VyRGF0YTsKICAgIGZ1bmN0aW9uIGV4dHJhY3RGcm9tQ2FjaGUoY2FjaGUpIHsKICAgICAgY29uc3QgdmFsdWVzID0gW107CiAgICAgIGZvciAoY29uc3Qga2V5IGluIGNhY2hlKSB7CiAgICAgICAgY29uc3QgZGF0YTIgPSBjYWNoZVtrZXldOwogICAgICAgIGRlbGV0ZSBkYXRhMi5tZXRhZGF0YTsKICAgICAgICB2YWx1ZXMucHVzaChkYXRhMik7CiAgICAgIH0KICAgICAgcmV0dXJuIHZhbHVlczsKICAgIH0KICAgIGlmIChpc1Jvb3QpIHsKICAgICAgY29uc3QgdGV4dHVyZXMgPSBleHRyYWN0RnJvbUNhY2hlKG1ldGEudGV4dHVyZXMpOwogICAgICBjb25zdCBpbWFnZXMgPSBleHRyYWN0RnJvbUNhY2hlKG1ldGEuaW1hZ2VzKTsKICAgICAgaWYgKHRleHR1cmVzLmxlbmd0aCA+IDApCiAgICAgICAgZGF0YS50ZXh0dXJlcyA9IHRleHR1cmVzOwogICAgICBpZiAoaW1hZ2VzLmxlbmd0aCA+IDApCiAgICAgICAgZGF0YS5pbWFnZXMgPSBpbWFnZXM7CiAgICB9CiAgICByZXR1cm4gZGF0YTsKICB9CiAgY2xvbmUoKSB7CiAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoKS5jb3B5KHRoaXMpOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgdGhpcy5uYW1lID0gc291cmNlLm5hbWU7CiAgICB0aGlzLmZvZyA9IHNvdXJjZS5mb2c7CiAgICB0aGlzLmJsZW5kaW5nID0gc291cmNlLmJsZW5kaW5nOwogICAgdGhpcy5zaWRlID0gc291cmNlLnNpZGU7CiAgICB0aGlzLnZlcnRleENvbG9ycyA9IHNvdXJjZS52ZXJ0ZXhDb2xvcnM7CiAgICB0aGlzLm9wYWNpdHkgPSBzb3VyY2Uub3BhY2l0eTsKICAgIHRoaXMudHJhbnNwYXJlbnQgPSBzb3VyY2UudHJhbnNwYXJlbnQ7CiAgICB0aGlzLmJsZW5kU3JjID0gc291cmNlLmJsZW5kU3JjOwogICAgdGhpcy5ibGVuZERzdCA9IHNvdXJjZS5ibGVuZERzdDsKICAgIHRoaXMuYmxlbmRFcXVhdGlvbiA9IHNvdXJjZS5ibGVuZEVxdWF0aW9uOwogICAgdGhpcy5ibGVuZFNyY0FscGhhID0gc291cmNlLmJsZW5kU3JjQWxwaGE7CiAgICB0aGlzLmJsZW5kRHN0QWxwaGEgPSBzb3VyY2UuYmxlbmREc3RBbHBoYTsKICAgIHRoaXMuYmxlbmRFcXVhdGlvbkFscGhhID0gc291cmNlLmJsZW5kRXF1YXRpb25BbHBoYTsKICAgIHRoaXMuZGVwdGhGdW5jID0gc291cmNlLmRlcHRoRnVuYzsKICAgIHRoaXMuZGVwdGhUZXN0ID0gc291cmNlLmRlcHRoVGVzdDsKICAgIHRoaXMuZGVwdGhXcml0ZSA9IHNvdXJjZS5kZXB0aFdyaXRlOwogICAgdGhpcy5zdGVuY2lsV3JpdGVNYXNrID0gc291cmNlLnN0ZW5jaWxXcml0ZU1hc2s7CiAgICB0aGlzLnN0ZW5jaWxGdW5jID0gc291cmNlLnN0ZW5jaWxGdW5jOwogICAgdGhpcy5zdGVuY2lsUmVmID0gc291cmNlLnN0ZW5jaWxSZWY7CiAgICB0aGlzLnN0ZW5jaWxGdW5jTWFzayA9IHNvdXJjZS5zdGVuY2lsRnVuY01hc2s7CiAgICB0aGlzLnN0ZW5jaWxGYWlsID0gc291cmNlLnN0ZW5jaWxGYWlsOwogICAgdGhpcy5zdGVuY2lsWkZhaWwgPSBzb3VyY2Uuc3RlbmNpbFpGYWlsOwogICAgdGhpcy5zdGVuY2lsWlBhc3MgPSBzb3VyY2Uuc3RlbmNpbFpQYXNzOwogICAgdGhpcy5zdGVuY2lsV3JpdGUgPSBzb3VyY2Uuc3RlbmNpbFdyaXRlOwogICAgY29uc3Qgc3JjUGxhbmVzID0gc291cmNlLmNsaXBwaW5nUGxhbmVzOwogICAgbGV0IGRzdFBsYW5lcyA9IG51bGw7CiAgICBpZiAoc3JjUGxhbmVzICE9PSBudWxsKSB7CiAgICAgIGNvbnN0IG4gPSBzcmNQbGFuZXMubGVuZ3RoOwogICAgICBkc3RQbGFuZXMgPSBuZXcgQXJyYXkobik7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBuOyArK2kpIHsKICAgICAgICBkc3RQbGFuZXNbaV0gPSBzcmNQbGFuZXNbaV0uY2xvbmUoKTsKICAgICAgfQogICAgfQogICAgdGhpcy5jbGlwcGluZ1BsYW5lcyA9IGRzdFBsYW5lczsKICAgIHRoaXMuY2xpcEludGVyc2VjdGlvbiA9IHNvdXJjZS5jbGlwSW50ZXJzZWN0aW9uOwogICAgdGhpcy5jbGlwU2hhZG93cyA9IHNvdXJjZS5jbGlwU2hhZG93czsKICAgIHRoaXMuc2hhZG93U2lkZSA9IHNvdXJjZS5zaGFkb3dTaWRlOwogICAgdGhpcy5jb2xvcldyaXRlID0gc291cmNlLmNvbG9yV3JpdGU7CiAgICB0aGlzLnByZWNpc2lvbiA9IHNvdXJjZS5wcmVjaXNpb247CiAgICB0aGlzLnBvbHlnb25PZmZzZXQgPSBzb3VyY2UucG9seWdvbk9mZnNldDsKICAgIHRoaXMucG9seWdvbk9mZnNldEZhY3RvciA9IHNvdXJjZS5wb2x5Z29uT2Zmc2V0RmFjdG9yOwogICAgdGhpcy5wb2x5Z29uT2Zmc2V0VW5pdHMgPSBzb3VyY2UucG9seWdvbk9mZnNldFVuaXRzOwogICAgdGhpcy5kaXRoZXJpbmcgPSBzb3VyY2UuZGl0aGVyaW5nOwogICAgdGhpcy5hbHBoYVRlc3QgPSBzb3VyY2UuYWxwaGFUZXN0OwogICAgdGhpcy5hbHBoYVRvQ292ZXJhZ2UgPSBzb3VyY2UuYWxwaGFUb0NvdmVyYWdlOwogICAgdGhpcy5wcmVtdWx0aXBsaWVkQWxwaGEgPSBzb3VyY2UucHJlbXVsdGlwbGllZEFscGhhOwogICAgdGhpcy52aXNpYmxlID0gc291cmNlLnZpc2libGU7CiAgICB0aGlzLnRvbmVNYXBwZWQgPSBzb3VyY2UudG9uZU1hcHBlZDsKICAgIHRoaXMudXNlckRhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNvdXJjZS51c2VyRGF0YSkpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGRpc3Bvc2UoKSB7CiAgICB0aGlzLmRpc3BhdGNoRXZlbnQoeyB0eXBlOiAiZGlzcG9zZSIgfSk7CiAgfQogIHNldCBuZWVkc1VwZGF0ZSh2YWx1ZSkgewogICAgaWYgKHZhbHVlID09PSB0cnVlKQogICAgICB0aGlzLnZlcnNpb24rKzsKICB9Cn0KTWF0ZXJpYWwucHJvdG90eXBlLmlzTWF0ZXJpYWwgPSB0cnVlOwpjbGFzcyBNZXNoQmFzaWNNYXRlcmlhbCBleHRlbmRzIE1hdGVyaWFsIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIk1lc2hCYXNpY01hdGVyaWFsIjsKICAgIHRoaXMuY29sb3IgPSBuZXcgQ29sb3IoMTY3NzcyMTUpOwogICAgdGhpcy5tYXAgPSBudWxsOwogICAgdGhpcy5saWdodE1hcCA9IG51bGw7CiAgICB0aGlzLmxpZ2h0TWFwSW50ZW5zaXR5ID0gMTsKICAgIHRoaXMuYW9NYXAgPSBudWxsOwogICAgdGhpcy5hb01hcEludGVuc2l0eSA9IDE7CiAgICB0aGlzLnNwZWN1bGFyTWFwID0gbnVsbDsKICAgIHRoaXMuYWxwaGFNYXAgPSBudWxsOwogICAgdGhpcy5lbnZNYXAgPSBudWxsOwogICAgdGhpcy5jb21iaW5lID0gTXVsdGlwbHlPcGVyYXRpb247CiAgICB0aGlzLnJlZmxlY3Rpdml0eSA9IDE7CiAgICB0aGlzLnJlZnJhY3Rpb25SYXRpbyA9IDAuOTg7CiAgICB0aGlzLndpcmVmcmFtZSA9IGZhbHNlOwogICAgdGhpcy53aXJlZnJhbWVMaW5ld2lkdGggPSAxOwogICAgdGhpcy53aXJlZnJhbWVMaW5lY2FwID0gInJvdW5kIjsKICAgIHRoaXMud2lyZWZyYW1lTGluZWpvaW4gPSAicm91bmQiOwogICAgdGhpcy5zZXRWYWx1ZXMocGFyYW1ldGVycyk7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLmNvbG9yLmNvcHkoc291cmNlLmNvbG9yKTsKICAgIHRoaXMubWFwID0gc291cmNlLm1hcDsKICAgIHRoaXMubGlnaHRNYXAgPSBzb3VyY2UubGlnaHRNYXA7CiAgICB0aGlzLmxpZ2h0TWFwSW50ZW5zaXR5ID0gc291cmNlLmxpZ2h0TWFwSW50ZW5zaXR5OwogICAgdGhpcy5hb01hcCA9IHNvdXJjZS5hb01hcDsKICAgIHRoaXMuYW9NYXBJbnRlbnNpdHkgPSBzb3VyY2UuYW9NYXBJbnRlbnNpdHk7CiAgICB0aGlzLnNwZWN1bGFyTWFwID0gc291cmNlLnNwZWN1bGFyTWFwOwogICAgdGhpcy5hbHBoYU1hcCA9IHNvdXJjZS5hbHBoYU1hcDsKICAgIHRoaXMuZW52TWFwID0gc291cmNlLmVudk1hcDsKICAgIHRoaXMuY29tYmluZSA9IHNvdXJjZS5jb21iaW5lOwogICAgdGhpcy5yZWZsZWN0aXZpdHkgPSBzb3VyY2UucmVmbGVjdGl2aXR5OwogICAgdGhpcy5yZWZyYWN0aW9uUmF0aW8gPSBzb3VyY2UucmVmcmFjdGlvblJhdGlvOwogICAgdGhpcy53aXJlZnJhbWUgPSBzb3VyY2Uud2lyZWZyYW1lOwogICAgdGhpcy53aXJlZnJhbWVMaW5ld2lkdGggPSBzb3VyY2Uud2lyZWZyYW1lTGluZXdpZHRoOwogICAgdGhpcy53aXJlZnJhbWVMaW5lY2FwID0gc291cmNlLndpcmVmcmFtZUxpbmVjYXA7CiAgICB0aGlzLndpcmVmcmFtZUxpbmVqb2luID0gc291cmNlLndpcmVmcmFtZUxpbmVqb2luOwogICAgcmV0dXJuIHRoaXM7CiAgfQp9Ck1lc2hCYXNpY01hdGVyaWFsLnByb3RvdHlwZS5pc01lc2hCYXNpY01hdGVyaWFsID0gdHJ1ZTsKY29uc3QgX3ZlY3RvciQ5ID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF92ZWN0b3IyJDEgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjIoKTsKY2xhc3MgQnVmZmVyQXR0cmlidXRlIHsKICBjb25zdHJ1Y3RvcihhcnJheSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KGFycmF5KSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJUSFJFRS5CdWZmZXJBdHRyaWJ1dGU6IGFycmF5IHNob3VsZCBiZSBhIFR5cGVkIEFycmF5LiIpOwogICAgfQogICAgdGhpcy5uYW1lID0gIiI7CiAgICB0aGlzLmFycmF5ID0gYXJyYXk7CiAgICB0aGlzLml0ZW1TaXplID0gaXRlbVNpemU7CiAgICB0aGlzLmNvdW50ID0gYXJyYXkgIT09IHZvaWQgMCA/IGFycmF5Lmxlbmd0aCAvIGl0ZW1TaXplIDogMDsKICAgIHRoaXMubm9ybWFsaXplZCA9IG5vcm1hbGl6ZWQgPT09IHRydWU7CiAgICB0aGlzLnVzYWdlID0gU3RhdGljRHJhd1VzYWdlOwogICAgdGhpcy51cGRhdGVSYW5nZSA9IHsgb2Zmc2V0OiAwLCBjb3VudDogLTEgfTsKICAgIHRoaXMudmVyc2lvbiA9IDA7CiAgfQogIG9uVXBsb2FkQ2FsbGJhY2soKSB7CiAgfQogIHNldCBuZWVkc1VwZGF0ZSh2YWx1ZSkgewogICAgaWYgKHZhbHVlID09PSB0cnVlKQogICAgICB0aGlzLnZlcnNpb24rKzsKICB9CiAgc2V0VXNhZ2UodmFsdWUpIHsKICAgIHRoaXMudXNhZ2UgPSB2YWx1ZTsKICAgIHJldHVybiB0aGlzOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgdGhpcy5uYW1lID0gc291cmNlLm5hbWU7CiAgICB0aGlzLmFycmF5ID0gbmV3IHNvdXJjZS5hcnJheS5jb25zdHJ1Y3Rvcihzb3VyY2UuYXJyYXkpOwogICAgdGhpcy5pdGVtU2l6ZSA9IHNvdXJjZS5pdGVtU2l6ZTsKICAgIHRoaXMuY291bnQgPSBzb3VyY2UuY291bnQ7CiAgICB0aGlzLm5vcm1hbGl6ZWQgPSBzb3VyY2Uubm9ybWFsaXplZDsKICAgIHRoaXMudXNhZ2UgPSBzb3VyY2UudXNhZ2U7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY29weUF0KGluZGV4MSwgYXR0cmlidXRlLCBpbmRleDIpIHsKICAgIGluZGV4MSAqPSB0aGlzLml0ZW1TaXplOwogICAgaW5kZXgyICo9IGF0dHJpYnV0ZS5pdGVtU2l6ZTsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5pdGVtU2l6ZTsgaSA8IGw7IGkrKykgewogICAgICB0aGlzLmFycmF5W2luZGV4MSArIGldID0gYXR0cmlidXRlLmFycmF5W2luZGV4MiArIGldOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNvcHlBcnJheShhcnJheSkgewogICAgdGhpcy5hcnJheS5zZXQoYXJyYXkpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNvcHlDb2xvcnNBcnJheShjb2xvcnMpIHsKICAgIGNvbnN0IGFycmF5ID0gdGhpcy5hcnJheTsKICAgIGxldCBvZmZzZXQgPSAwOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSBjb2xvcnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIGxldCBjb2xvciA9IGNvbG9yc1tpXTsKICAgICAgaWYgKGNvbG9yID09PSB2b2lkIDApIHsKICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkJ1ZmZlckF0dHJpYnV0ZS5jb3B5Q29sb3JzQXJyYXkoKTogY29sb3IgaXMgdW5kZWZpbmVkIiwgaSk7CiAgICAgICAgY29sb3IgPSBuZXcgQ29sb3IoKTsKICAgICAgfQogICAgICBhcnJheVtvZmZzZXQrK10gPSBjb2xvci5yOwogICAgICBhcnJheVtvZmZzZXQrK10gPSBjb2xvci5nOwogICAgICBhcnJheVtvZmZzZXQrK10gPSBjb2xvci5iOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNvcHlWZWN0b3Iyc0FycmF5KHZlY3RvcnMpIHsKICAgIGNvbnN0IGFycmF5ID0gdGhpcy5hcnJheTsKICAgIGxldCBvZmZzZXQgPSAwOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSB2ZWN0b3JzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBsZXQgdmVjdG9yID0gdmVjdG9yc1tpXTsKICAgICAgaWYgKHZlY3RvciA9PT0gdm9pZCAwKSB7CiAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5CdWZmZXJBdHRyaWJ1dGUuY29weVZlY3RvcjJzQXJyYXkoKTogdmVjdG9yIGlzIHVuZGVmaW5lZCIsIGkpOwogICAgICAgIHZlY3RvciA9IG5ldyBWZWN0b3IyKCk7CiAgICAgIH0KICAgICAgYXJyYXlbb2Zmc2V0KytdID0gdmVjdG9yLng7CiAgICAgIGFycmF5W29mZnNldCsrXSA9IHZlY3Rvci55OwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNvcHlWZWN0b3Izc0FycmF5KHZlY3RvcnMpIHsKICAgIGNvbnN0IGFycmF5ID0gdGhpcy5hcnJheTsKICAgIGxldCBvZmZzZXQgPSAwOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSB2ZWN0b3JzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBsZXQgdmVjdG9yID0gdmVjdG9yc1tpXTsKICAgICAgaWYgKHZlY3RvciA9PT0gdm9pZCAwKSB7CiAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5CdWZmZXJBdHRyaWJ1dGUuY29weVZlY3RvcjNzQXJyYXkoKTogdmVjdG9yIGlzIHVuZGVmaW5lZCIsIGkpOwogICAgICAgIHZlY3RvciA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIH0KICAgICAgYXJyYXlbb2Zmc2V0KytdID0gdmVjdG9yLng7CiAgICAgIGFycmF5W29mZnNldCsrXSA9IHZlY3Rvci55OwogICAgICBhcnJheVtvZmZzZXQrK10gPSB2ZWN0b3IuejsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBjb3B5VmVjdG9yNHNBcnJheSh2ZWN0b3JzKSB7CiAgICBjb25zdCBhcnJheSA9IHRoaXMuYXJyYXk7CiAgICBsZXQgb2Zmc2V0ID0gMDsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gdmVjdG9ycy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgbGV0IHZlY3RvciA9IHZlY3RvcnNbaV07CiAgICAgIGlmICh2ZWN0b3IgPT09IHZvaWQgMCkgewogICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuQnVmZmVyQXR0cmlidXRlLmNvcHlWZWN0b3I0c0FycmF5KCk6IHZlY3RvciBpcyB1bmRlZmluZWQiLCBpKTsKICAgICAgICB2ZWN0b3IgPSBuZXcgVmVjdG9yNCgpOwogICAgICB9CiAgICAgIGFycmF5W29mZnNldCsrXSA9IHZlY3Rvci54OwogICAgICBhcnJheVtvZmZzZXQrK10gPSB2ZWN0b3IueTsKICAgICAgYXJyYXlbb2Zmc2V0KytdID0gdmVjdG9yLno7CiAgICAgIGFycmF5W29mZnNldCsrXSA9IHZlY3Rvci53OwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGFwcGx5TWF0cml4MyhtKSB7CiAgICBpZiAodGhpcy5pdGVtU2l6ZSA9PT0gMikgewogICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHRoaXMuY291bnQ7IGkgPCBsOyBpKyspIHsKICAgICAgICBfdmVjdG9yMiQxLmZyb21CdWZmZXJBdHRyaWJ1dGUodGhpcywgaSk7CiAgICAgICAgX3ZlY3RvcjIkMS5hcHBseU1hdHJpeDMobSk7CiAgICAgICAgdGhpcy5zZXRYWShpLCBfdmVjdG9yMiQxLngsIF92ZWN0b3IyJDEueSk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodGhpcy5pdGVtU2l6ZSA9PT0gMykgewogICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHRoaXMuY291bnQ7IGkgPCBsOyBpKyspIHsKICAgICAgICBfdmVjdG9yJDkuZnJvbUJ1ZmZlckF0dHJpYnV0ZSh0aGlzLCBpKTsKICAgICAgICBfdmVjdG9yJDkuYXBwbHlNYXRyaXgzKG0pOwogICAgICAgIHRoaXMuc2V0WFlaKGksIF92ZWN0b3IkOS54LCBfdmVjdG9yJDkueSwgX3ZlY3RvciQ5LnopOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9CiAgYXBwbHlNYXRyaXg0KG0pIHsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5jb3VudDsgaSA8IGw7IGkrKykgewogICAgICBfdmVjdG9yJDkueCA9IHRoaXMuZ2V0WChpKTsKICAgICAgX3ZlY3RvciQ5LnkgPSB0aGlzLmdldFkoaSk7CiAgICAgIF92ZWN0b3IkOS56ID0gdGhpcy5nZXRaKGkpOwogICAgICBfdmVjdG9yJDkuYXBwbHlNYXRyaXg0KG0pOwogICAgICB0aGlzLnNldFhZWihpLCBfdmVjdG9yJDkueCwgX3ZlY3RvciQ5LnksIF92ZWN0b3IkOS56KTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBhcHBseU5vcm1hbE1hdHJpeChtKSB7CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IHRoaXMuY291bnQ7IGkgPCBsOyBpKyspIHsKICAgICAgX3ZlY3RvciQ5LnggPSB0aGlzLmdldFgoaSk7CiAgICAgIF92ZWN0b3IkOS55ID0gdGhpcy5nZXRZKGkpOwogICAgICBfdmVjdG9yJDkueiA9IHRoaXMuZ2V0WihpKTsKICAgICAgX3ZlY3RvciQ5LmFwcGx5Tm9ybWFsTWF0cml4KG0pOwogICAgICB0aGlzLnNldFhZWihpLCBfdmVjdG9yJDkueCwgX3ZlY3RvciQ5LnksIF92ZWN0b3IkOS56KTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICB0cmFuc2Zvcm1EaXJlY3Rpb24obSkgewogICAgZm9yIChsZXQgaSA9IDAsIGwgPSB0aGlzLmNvdW50OyBpIDwgbDsgaSsrKSB7CiAgICAgIF92ZWN0b3IkOS54ID0gdGhpcy5nZXRYKGkpOwogICAgICBfdmVjdG9yJDkueSA9IHRoaXMuZ2V0WShpKTsKICAgICAgX3ZlY3RvciQ5LnogPSB0aGlzLmdldFooaSk7CiAgICAgIF92ZWN0b3IkOS50cmFuc2Zvcm1EaXJlY3Rpb24obSk7CiAgICAgIHRoaXMuc2V0WFlaKGksIF92ZWN0b3IkOS54LCBfdmVjdG9yJDkueSwgX3ZlY3RvciQ5LnopOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldCh2YWx1ZSwgb2Zmc2V0ID0gMCkgewogICAgdGhpcy5hcnJheS5zZXQodmFsdWUsIG9mZnNldCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZ2V0WChpbmRleCkgewogICAgcmV0dXJuIHRoaXMuYXJyYXlbaW5kZXggKiB0aGlzLml0ZW1TaXplXTsKICB9CiAgc2V0WChpbmRleCwgeCkgewogICAgdGhpcy5hcnJheVtpbmRleCAqIHRoaXMuaXRlbVNpemVdID0geDsKICAgIHJldHVybiB0aGlzOwogIH0KICBnZXRZKGluZGV4KSB7CiAgICByZXR1cm4gdGhpcy5hcnJheVtpbmRleCAqIHRoaXMuaXRlbVNpemUgKyAxXTsKICB9CiAgc2V0WShpbmRleCwgeSkgewogICAgdGhpcy5hcnJheVtpbmRleCAqIHRoaXMuaXRlbVNpemUgKyAxXSA9IHk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZ2V0WihpbmRleCkgewogICAgcmV0dXJuIHRoaXMuYXJyYXlbaW5kZXggKiB0aGlzLml0ZW1TaXplICsgMl07CiAgfQogIHNldFooaW5kZXgsIHopIHsKICAgIHRoaXMuYXJyYXlbaW5kZXggKiB0aGlzLml0ZW1TaXplICsgMl0gPSB6OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGdldFcoaW5kZXgpIHsKICAgIHJldHVybiB0aGlzLmFycmF5W2luZGV4ICogdGhpcy5pdGVtU2l6ZSArIDNdOwogIH0KICBzZXRXKGluZGV4LCB3KSB7CiAgICB0aGlzLmFycmF5W2luZGV4ICogdGhpcy5pdGVtU2l6ZSArIDNdID0gdzsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRYWShpbmRleCwgeCwgeSkgewogICAgaW5kZXggKj0gdGhpcy5pdGVtU2l6ZTsKICAgIHRoaXMuYXJyYXlbaW5kZXggKyAwXSA9IHg7CiAgICB0aGlzLmFycmF5W2luZGV4ICsgMV0gPSB5OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldFhZWihpbmRleCwgeCwgeSwgeikgewogICAgaW5kZXggKj0gdGhpcy5pdGVtU2l6ZTsKICAgIHRoaXMuYXJyYXlbaW5kZXggKyAwXSA9IHg7CiAgICB0aGlzLmFycmF5W2luZGV4ICsgMV0gPSB5OwogICAgdGhpcy5hcnJheVtpbmRleCArIDJdID0gejsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRYWVpXKGluZGV4LCB4LCB5LCB6LCB3KSB7CiAgICBpbmRleCAqPSB0aGlzLml0ZW1TaXplOwogICAgdGhpcy5hcnJheVtpbmRleCArIDBdID0geDsKICAgIHRoaXMuYXJyYXlbaW5kZXggKyAxXSA9IHk7CiAgICB0aGlzLmFycmF5W2luZGV4ICsgMl0gPSB6OwogICAgdGhpcy5hcnJheVtpbmRleCArIDNdID0gdzsKICAgIHJldHVybiB0aGlzOwogIH0KICBvblVwbG9hZChjYWxsYmFjaykgewogICAgdGhpcy5vblVwbG9hZENhbGxiYWNrID0gY2FsbGJhY2s7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xvbmUoKSB7CiAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5hcnJheSwgdGhpcy5pdGVtU2l6ZSkuY29weSh0aGlzKTsKICB9CiAgdG9KU09OKCkgewogICAgY29uc3QgZGF0YSA9IHsKICAgICAgaXRlbVNpemU6IHRoaXMuaXRlbVNpemUsCiAgICAgIHR5cGU6IHRoaXMuYXJyYXkuY29uc3RydWN0b3IubmFtZSwKICAgICAgYXJyYXk6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuYXJyYXkpLAogICAgICBub3JtYWxpemVkOiB0aGlzLm5vcm1hbGl6ZWQKICAgIH07CiAgICBpZiAodGhpcy5uYW1lICE9PSAiIikKICAgICAgZGF0YS5uYW1lID0gdGhpcy5uYW1lOwogICAgaWYgKHRoaXMudXNhZ2UgIT09IFN0YXRpY0RyYXdVc2FnZSkKICAgICAgZGF0YS51c2FnZSA9IHRoaXMudXNhZ2U7CiAgICBpZiAodGhpcy51cGRhdGVSYW5nZS5vZmZzZXQgIT09IDAgfHwgdGhpcy51cGRhdGVSYW5nZS5jb3VudCAhPT0gLTEpCiAgICAgIGRhdGEudXBkYXRlUmFuZ2UgPSB0aGlzLnVwZGF0ZVJhbmdlOwogICAgcmV0dXJuIGRhdGE7CiAgfQp9CkJ1ZmZlckF0dHJpYnV0ZS5wcm90b3R5cGUuaXNCdWZmZXJBdHRyaWJ1dGUgPSB0cnVlOwpjbGFzcyBJbnQ4QnVmZmVyQXR0cmlidXRlIGV4dGVuZHMgQnVmZmVyQXR0cmlidXRlIHsKICBjb25zdHJ1Y3RvcihhcnJheSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpIHsKICAgIHN1cGVyKG5ldyBJbnQ4QXJyYXkoYXJyYXkpLCBpdGVtU2l6ZSwgbm9ybWFsaXplZCk7CiAgfQp9CmNsYXNzIFVpbnQ4QnVmZmVyQXR0cmlidXRlIGV4dGVuZHMgQnVmZmVyQXR0cmlidXRlIHsKICBjb25zdHJ1Y3RvcihhcnJheSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpIHsKICAgIHN1cGVyKG5ldyBVaW50OEFycmF5KGFycmF5KSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpOwogIH0KfQpjbGFzcyBVaW50OENsYW1wZWRCdWZmZXJBdHRyaWJ1dGUgZXh0ZW5kcyBCdWZmZXJBdHRyaWJ1dGUgewogIGNvbnN0cnVjdG9yKGFycmF5LCBpdGVtU2l6ZSwgbm9ybWFsaXplZCkgewogICAgc3VwZXIobmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGFycmF5KSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpOwogIH0KfQpjbGFzcyBJbnQxNkJ1ZmZlckF0dHJpYnV0ZSBleHRlbmRzIEJ1ZmZlckF0dHJpYnV0ZSB7CiAgY29uc3RydWN0b3IoYXJyYXksIGl0ZW1TaXplLCBub3JtYWxpemVkKSB7CiAgICBzdXBlcihuZXcgSW50MTZBcnJheShhcnJheSksIGl0ZW1TaXplLCBub3JtYWxpemVkKTsKICB9Cn0KY2xhc3MgVWludDE2QnVmZmVyQXR0cmlidXRlIGV4dGVuZHMgQnVmZmVyQXR0cmlidXRlIHsKICBjb25zdHJ1Y3RvcihhcnJheSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpIHsKICAgIHN1cGVyKG5ldyBVaW50MTZBcnJheShhcnJheSksIGl0ZW1TaXplLCBub3JtYWxpemVkKTsKICB9Cn0KY2xhc3MgSW50MzJCdWZmZXJBdHRyaWJ1dGUgZXh0ZW5kcyBCdWZmZXJBdHRyaWJ1dGUgewogIGNvbnN0cnVjdG9yKGFycmF5LCBpdGVtU2l6ZSwgbm9ybWFsaXplZCkgewogICAgc3VwZXIobmV3IEludDMyQXJyYXkoYXJyYXkpLCBpdGVtU2l6ZSwgbm9ybWFsaXplZCk7CiAgfQp9CmNsYXNzIFVpbnQzMkJ1ZmZlckF0dHJpYnV0ZSBleHRlbmRzIEJ1ZmZlckF0dHJpYnV0ZSB7CiAgY29uc3RydWN0b3IoYXJyYXksIGl0ZW1TaXplLCBub3JtYWxpemVkKSB7CiAgICBzdXBlcihuZXcgVWludDMyQXJyYXkoYXJyYXkpLCBpdGVtU2l6ZSwgbm9ybWFsaXplZCk7CiAgfQp9CmNsYXNzIEZsb2F0MTZCdWZmZXJBdHRyaWJ1dGUgZXh0ZW5kcyBCdWZmZXJBdHRyaWJ1dGUgewogIGNvbnN0cnVjdG9yKGFycmF5LCBpdGVtU2l6ZSwgbm9ybWFsaXplZCkgewogICAgc3VwZXIobmV3IFVpbnQxNkFycmF5KGFycmF5KSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpOwogIH0KfQpGbG9hdDE2QnVmZmVyQXR0cmlidXRlLnByb3RvdHlwZS5pc0Zsb2F0MTZCdWZmZXJBdHRyaWJ1dGUgPSB0cnVlOwpjbGFzcyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlIGV4dGVuZHMgQnVmZmVyQXR0cmlidXRlIHsKICBjb25zdHJ1Y3RvcihhcnJheSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpIHsKICAgIHN1cGVyKG5ldyBGbG9hdDMyQXJyYXkoYXJyYXkpLCBpdGVtU2l6ZSwgbm9ybWFsaXplZCk7CiAgfQp9CmNsYXNzIEZsb2F0NjRCdWZmZXJBdHRyaWJ1dGUgZXh0ZW5kcyBCdWZmZXJBdHRyaWJ1dGUgewogIGNvbnN0cnVjdG9yKGFycmF5LCBpdGVtU2l6ZSwgbm9ybWFsaXplZCkgewogICAgc3VwZXIobmV3IEZsb2F0NjRBcnJheShhcnJheSksIGl0ZW1TaXplLCBub3JtYWxpemVkKTsKICB9Cn0KbGV0IF9pZCQxID0gMDsKY29uc3QgX20xID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXRyaXg0KCk7CmNvbnN0IF9vYmogPSAvKiBAX19QVVJFX18gKi8gbmV3IE9iamVjdDNEKCk7CmNvbnN0IF9vZmZzZXQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX2JveCQxID0gLyogQF9fUFVSRV9fICovIG5ldyBCb3gzKCk7CmNvbnN0IF9ib3hNb3JwaFRhcmdldHMgPSAvKiBAX19QVVJFX18gKi8gbmV3IEJveDMoKTsKY29uc3QgX3ZlY3RvciQ4ID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNsYXNzIEJ1ZmZlckdlb21ldHJ5IGV4dGVuZHMgRXZlbnREaXNwYXRjaGVyIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHN1cGVyKCk7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImlkIiwgeyB2YWx1ZTogX2lkJDErKyB9KTsKICAgIHRoaXMudXVpZCA9IGdlbmVyYXRlVVVJRCgpOwogICAgdGhpcy5uYW1lID0gIiI7CiAgICB0aGlzLnR5cGUgPSAiQnVmZmVyR2VvbWV0cnkiOwogICAgdGhpcy5pbmRleCA9IG51bGw7CiAgICB0aGlzLmF0dHJpYnV0ZXMgPSB7fTsKICAgIHRoaXMubW9ycGhBdHRyaWJ1dGVzID0ge307CiAgICB0aGlzLm1vcnBoVGFyZ2V0c1JlbGF0aXZlID0gZmFsc2U7CiAgICB0aGlzLmdyb3VwcyA9IFtdOwogICAgdGhpcy5ib3VuZGluZ0JveCA9IG51bGw7CiAgICB0aGlzLmJvdW5kaW5nU3BoZXJlID0gbnVsbDsKICAgIHRoaXMuZHJhd1JhbmdlID0geyBzdGFydDogMCwgY291bnQ6IEluZmluaXR5IH07CiAgICB0aGlzLnVzZXJEYXRhID0ge307CiAgfQogIGdldEluZGV4KCkgewogICAgcmV0dXJuIHRoaXMuaW5kZXg7CiAgfQogIHNldEluZGV4KGluZGV4KSB7CiAgICBpZiAoQXJyYXkuaXNBcnJheShpbmRleCkpIHsKICAgICAgdGhpcy5pbmRleCA9IG5ldyAoYXJyYXlOZWVkc1VpbnQzMihpbmRleCkgPyBVaW50MzJCdWZmZXJBdHRyaWJ1dGUgOiBVaW50MTZCdWZmZXJBdHRyaWJ1dGUpKGluZGV4LCAxKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuaW5kZXggPSBpbmRleDsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBnZXRBdHRyaWJ1dGUobmFtZSkgewogICAgcmV0dXJuIHRoaXMuYXR0cmlidXRlc1tuYW1lXTsKICB9CiAgc2V0QXR0cmlidXRlKG5hbWUsIGF0dHJpYnV0ZSkgewogICAgdGhpcy5hdHRyaWJ1dGVzW25hbWVdID0gYXR0cmlidXRlOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGRlbGV0ZUF0dHJpYnV0ZShuYW1lKSB7CiAgICBkZWxldGUgdGhpcy5hdHRyaWJ1dGVzW25hbWVdOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGhhc0F0dHJpYnV0ZShuYW1lKSB7CiAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGVzW25hbWVdICE9PSB2b2lkIDA7CiAgfQogIGFkZEdyb3VwKHN0YXJ0LCBjb3VudCwgbWF0ZXJpYWxJbmRleCA9IDApIHsKICAgIHRoaXMuZ3JvdXBzLnB1c2goewogICAgICBzdGFydCwKICAgICAgY291bnQsCiAgICAgIG1hdGVyaWFsSW5kZXgKICAgIH0pOwogIH0KICBjbGVhckdyb3VwcygpIHsKICAgIHRoaXMuZ3JvdXBzID0gW107CiAgfQogIHNldERyYXdSYW5nZShzdGFydCwgY291bnQpIHsKICAgIHRoaXMuZHJhd1JhbmdlLnN0YXJ0ID0gc3RhcnQ7CiAgICB0aGlzLmRyYXdSYW5nZS5jb3VudCA9IGNvdW50OwogIH0KICBhcHBseU1hdHJpeDQobWF0cml4KSB7CiAgICBjb25zdCBwb3NpdGlvbiA9IHRoaXMuYXR0cmlidXRlcy5wb3NpdGlvbjsKICAgIGlmIChwb3NpdGlvbiAhPT0gdm9pZCAwKSB7CiAgICAgIHBvc2l0aW9uLmFwcGx5TWF0cml4NChtYXRyaXgpOwogICAgICBwb3NpdGlvbi5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICB9CiAgICBjb25zdCBub3JtYWwgPSB0aGlzLmF0dHJpYnV0ZXMubm9ybWFsOwogICAgaWYgKG5vcm1hbCAhPT0gdm9pZCAwKSB7CiAgICAgIGNvbnN0IG5vcm1hbE1hdHJpeCA9IG5ldyBNYXRyaXgzKCkuZ2V0Tm9ybWFsTWF0cml4KG1hdHJpeCk7CiAgICAgIG5vcm1hbC5hcHBseU5vcm1hbE1hdHJpeChub3JtYWxNYXRyaXgpOwogICAgICBub3JtYWwubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgfQogICAgY29uc3QgdGFuZ2VudCA9IHRoaXMuYXR0cmlidXRlcy50YW5nZW50OwogICAgaWYgKHRhbmdlbnQgIT09IHZvaWQgMCkgewogICAgICB0YW5nZW50LnRyYW5zZm9ybURpcmVjdGlvbihtYXRyaXgpOwogICAgICB0YW5nZW50Lm5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgIH0KICAgIGlmICh0aGlzLmJvdW5kaW5nQm94ICE9PSBudWxsKSB7CiAgICAgIHRoaXMuY29tcHV0ZUJvdW5kaW5nQm94KCk7CiAgICB9CiAgICBpZiAodGhpcy5ib3VuZGluZ1NwaGVyZSAhPT0gbnVsbCkgewogICAgICB0aGlzLmNvbXB1dGVCb3VuZGluZ1NwaGVyZSgpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGFwcGx5UXVhdGVybmlvbihxKSB7CiAgICBfbTEubWFrZVJvdGF0aW9uRnJvbVF1YXRlcm5pb24ocSk7CiAgICB0aGlzLmFwcGx5TWF0cml4NChfbTEpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHJvdGF0ZVgoYW5nbGUpIHsKICAgIF9tMS5tYWtlUm90YXRpb25YKGFuZ2xlKTsKICAgIHRoaXMuYXBwbHlNYXRyaXg0KF9tMSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgcm90YXRlWShhbmdsZSkgewogICAgX20xLm1ha2VSb3RhdGlvblkoYW5nbGUpOwogICAgdGhpcy5hcHBseU1hdHJpeDQoX20xKTsKICAgIHJldHVybiB0aGlzOwogIH0KICByb3RhdGVaKGFuZ2xlKSB7CiAgICBfbTEubWFrZVJvdGF0aW9uWihhbmdsZSk7CiAgICB0aGlzLmFwcGx5TWF0cml4NChfbTEpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRyYW5zbGF0ZSh4LCB5LCB6KSB7CiAgICBfbTEubWFrZVRyYW5zbGF0aW9uKHgsIHksIHopOwogICAgdGhpcy5hcHBseU1hdHJpeDQoX20xKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzY2FsZSh4LCB5LCB6KSB7CiAgICBfbTEubWFrZVNjYWxlKHgsIHksIHopOwogICAgdGhpcy5hcHBseU1hdHJpeDQoX20xKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBsb29rQXQodmVjdG9yKSB7CiAgICBfb2JqLmxvb2tBdCh2ZWN0b3IpOwogICAgX29iai51cGRhdGVNYXRyaXgoKTsKICAgIHRoaXMuYXBwbHlNYXRyaXg0KF9vYmoubWF0cml4KTsKICAgIHJldHVybiB0aGlzOwogIH0KICBjZW50ZXIoKSB7CiAgICB0aGlzLmNvbXB1dGVCb3VuZGluZ0JveCgpOwogICAgdGhpcy5ib3VuZGluZ0JveC5nZXRDZW50ZXIoX29mZnNldCkubmVnYXRlKCk7CiAgICB0aGlzLnRyYW5zbGF0ZShfb2Zmc2V0LngsIF9vZmZzZXQueSwgX29mZnNldC56KTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRGcm9tUG9pbnRzKHBvaW50cykgewogICAgY29uc3QgcG9zaXRpb24gPSBbXTsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gcG9pbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBjb25zdCBwb2ludCA9IHBvaW50c1tpXTsKICAgICAgcG9zaXRpb24ucHVzaChwb2ludC54LCBwb2ludC55LCBwb2ludC56IHx8IDApOwogICAgfQogICAgdGhpcy5zZXRBdHRyaWJ1dGUoInBvc2l0aW9uIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUocG9zaXRpb24sIDMpKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBjb21wdXRlQm91bmRpbmdCb3goKSB7CiAgICBpZiAodGhpcy5ib3VuZGluZ0JveCA9PT0gbnVsbCkgewogICAgICB0aGlzLmJvdW5kaW5nQm94ID0gbmV3IEJveDMoKTsKICAgIH0KICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5hdHRyaWJ1dGVzLnBvc2l0aW9uOwogICAgY29uc3QgbW9ycGhBdHRyaWJ1dGVzUG9zaXRpb24gPSB0aGlzLm1vcnBoQXR0cmlidXRlcy5wb3NpdGlvbjsKICAgIGlmIChwb3NpdGlvbiAmJiBwb3NpdGlvbi5pc0dMQnVmZmVyQXR0cmlidXRlKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoJ1RIUkVFLkJ1ZmZlckdlb21ldHJ5LmNvbXB1dGVCb3VuZGluZ0JveCgpOiBHTEJ1ZmZlckF0dHJpYnV0ZSByZXF1aXJlcyBhIG1hbnVhbCBib3VuZGluZyBib3guIEFsdGVybmF0aXZlbHkgc2V0ICJtZXNoLmZydXN0dW1DdWxsZWQiIHRvICJmYWxzZSIuJywgdGhpcyk7CiAgICAgIHRoaXMuYm91bmRpbmdCb3guc2V0KG5ldyBWZWN0b3IzKC1JbmZpbml0eSwgLUluZmluaXR5LCAtSW5maW5pdHkpLCBuZXcgVmVjdG9yMyhJbmZpbml0eSwgSW5maW5pdHksIEluZmluaXR5KSk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmIChwb3NpdGlvbiAhPT0gdm9pZCAwKSB7CiAgICAgIHRoaXMuYm91bmRpbmdCb3guc2V0RnJvbUJ1ZmZlckF0dHJpYnV0ZShwb3NpdGlvbik7CiAgICAgIGlmIChtb3JwaEF0dHJpYnV0ZXNQb3NpdGlvbikgewogICAgICAgIGZvciAobGV0IGkgPSAwLCBpbCA9IG1vcnBoQXR0cmlidXRlc1Bvc2l0aW9uLmxlbmd0aDsgaSA8IGlsOyBpKyspIHsKICAgICAgICAgIGNvbnN0IG1vcnBoQXR0cmlidXRlID0gbW9ycGhBdHRyaWJ1dGVzUG9zaXRpb25baV07CiAgICAgICAgICBfYm94JDEuc2V0RnJvbUJ1ZmZlckF0dHJpYnV0ZShtb3JwaEF0dHJpYnV0ZSk7CiAgICAgICAgICBpZiAodGhpcy5tb3JwaFRhcmdldHNSZWxhdGl2ZSkgewogICAgICAgICAgICBfdmVjdG9yJDguYWRkVmVjdG9ycyh0aGlzLmJvdW5kaW5nQm94Lm1pbiwgX2JveCQxLm1pbik7CiAgICAgICAgICAgIHRoaXMuYm91bmRpbmdCb3guZXhwYW5kQnlQb2ludChfdmVjdG9yJDgpOwogICAgICAgICAgICBfdmVjdG9yJDguYWRkVmVjdG9ycyh0aGlzLmJvdW5kaW5nQm94Lm1heCwgX2JveCQxLm1heCk7CiAgICAgICAgICAgIHRoaXMuYm91bmRpbmdCb3guZXhwYW5kQnlQb2ludChfdmVjdG9yJDgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5ib3VuZGluZ0JveC5leHBhbmRCeVBvaW50KF9ib3gkMS5taW4pOwogICAgICAgICAgICB0aGlzLmJvdW5kaW5nQm94LmV4cGFuZEJ5UG9pbnQoX2JveCQxLm1heCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzLmJvdW5kaW5nQm94Lm1ha2VFbXB0eSgpOwogICAgfQogICAgaWYgKGlzTmFOKHRoaXMuYm91bmRpbmdCb3gubWluLngpIHx8IGlzTmFOKHRoaXMuYm91bmRpbmdCb3gubWluLnkpIHx8IGlzTmFOKHRoaXMuYm91bmRpbmdCb3gubWluLnopKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoJ1RIUkVFLkJ1ZmZlckdlb21ldHJ5LmNvbXB1dGVCb3VuZGluZ0JveCgpOiBDb21wdXRlZCBtaW4vbWF4IGhhdmUgTmFOIHZhbHVlcy4gVGhlICJwb3NpdGlvbiIgYXR0cmlidXRlIGlzIGxpa2VseSB0byBoYXZlIE5hTiB2YWx1ZXMuJywgdGhpcyk7CiAgICB9CiAgfQogIGNvbXB1dGVCb3VuZGluZ1NwaGVyZSgpIHsKICAgIGlmICh0aGlzLmJvdW5kaW5nU3BoZXJlID09PSBudWxsKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmUgPSBuZXcgU3BoZXJlKCk7CiAgICB9CiAgICBjb25zdCBwb3NpdGlvbiA9IHRoaXMuYXR0cmlidXRlcy5wb3NpdGlvbjsKICAgIGNvbnN0IG1vcnBoQXR0cmlidXRlc1Bvc2l0aW9uID0gdGhpcy5tb3JwaEF0dHJpYnV0ZXMucG9zaXRpb247CiAgICBpZiAocG9zaXRpb24gJiYgcG9zaXRpb24uaXNHTEJ1ZmZlckF0dHJpYnV0ZSkgewogICAgICBjb25zb2xlLmVycm9yKCdUSFJFRS5CdWZmZXJHZW9tZXRyeS5jb21wdXRlQm91bmRpbmdTcGhlcmUoKTogR0xCdWZmZXJBdHRyaWJ1dGUgcmVxdWlyZXMgYSBtYW51YWwgYm91bmRpbmcgc3BoZXJlLiBBbHRlcm5hdGl2ZWx5IHNldCAibWVzaC5mcnVzdHVtQ3VsbGVkIiB0byAiZmFsc2UiLicsIHRoaXMpOwogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlLnNldChuZXcgVmVjdG9yMygpLCBJbmZpbml0eSk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmIChwb3NpdGlvbikgewogICAgICBjb25zdCBjZW50ZXIgPSB0aGlzLmJvdW5kaW5nU3BoZXJlLmNlbnRlcjsKICAgICAgX2JveCQxLnNldEZyb21CdWZmZXJBdHRyaWJ1dGUocG9zaXRpb24pOwogICAgICBpZiAobW9ycGhBdHRyaWJ1dGVzUG9zaXRpb24pIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBtb3JwaEF0dHJpYnV0ZXNQb3NpdGlvbi5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgICAgICBjb25zdCBtb3JwaEF0dHJpYnV0ZSA9IG1vcnBoQXR0cmlidXRlc1Bvc2l0aW9uW2ldOwogICAgICAgICAgX2JveE1vcnBoVGFyZ2V0cy5zZXRGcm9tQnVmZmVyQXR0cmlidXRlKG1vcnBoQXR0cmlidXRlKTsKICAgICAgICAgIGlmICh0aGlzLm1vcnBoVGFyZ2V0c1JlbGF0aXZlKSB7CiAgICAgICAgICAgIF92ZWN0b3IkOC5hZGRWZWN0b3JzKF9ib3gkMS5taW4sIF9ib3hNb3JwaFRhcmdldHMubWluKTsKICAgICAgICAgICAgX2JveCQxLmV4cGFuZEJ5UG9pbnQoX3ZlY3RvciQ4KTsKICAgICAgICAgICAgX3ZlY3RvciQ4LmFkZFZlY3RvcnMoX2JveCQxLm1heCwgX2JveE1vcnBoVGFyZ2V0cy5tYXgpOwogICAgICAgICAgICBfYm94JDEuZXhwYW5kQnlQb2ludChfdmVjdG9yJDgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX2JveCQxLmV4cGFuZEJ5UG9pbnQoX2JveE1vcnBoVGFyZ2V0cy5taW4pOwogICAgICAgICAgICBfYm94JDEuZXhwYW5kQnlQb2ludChfYm94TW9ycGhUYXJnZXRzLm1heCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIF9ib3gkMS5nZXRDZW50ZXIoY2VudGVyKTsKICAgICAgbGV0IG1heFJhZGl1c1NxID0gMDsKICAgICAgZm9yIChsZXQgaSA9IDAsIGlsID0gcG9zaXRpb24uY291bnQ7IGkgPCBpbDsgaSsrKSB7CiAgICAgICAgX3ZlY3RvciQ4LmZyb21CdWZmZXJBdHRyaWJ1dGUocG9zaXRpb24sIGkpOwogICAgICAgIG1heFJhZGl1c1NxID0gTWF0aC5tYXgobWF4UmFkaXVzU3EsIGNlbnRlci5kaXN0YW5jZVRvU3F1YXJlZChfdmVjdG9yJDgpKTsKICAgICAgfQogICAgICBpZiAobW9ycGhBdHRyaWJ1dGVzUG9zaXRpb24pIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBtb3JwaEF0dHJpYnV0ZXNQb3NpdGlvbi5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgICAgICBjb25zdCBtb3JwaEF0dHJpYnV0ZSA9IG1vcnBoQXR0cmlidXRlc1Bvc2l0aW9uW2ldOwogICAgICAgICAgY29uc3QgbW9ycGhUYXJnZXRzUmVsYXRpdmUgPSB0aGlzLm1vcnBoVGFyZ2V0c1JlbGF0aXZlOwogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIGpsID0gbW9ycGhBdHRyaWJ1dGUuY291bnQ7IGogPCBqbDsgaisrKSB7CiAgICAgICAgICAgIF92ZWN0b3IkOC5mcm9tQnVmZmVyQXR0cmlidXRlKG1vcnBoQXR0cmlidXRlLCBqKTsKICAgICAgICAgICAgaWYgKG1vcnBoVGFyZ2V0c1JlbGF0aXZlKSB7CiAgICAgICAgICAgICAgX29mZnNldC5mcm9tQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9uLCBqKTsKICAgICAgICAgICAgICBfdmVjdG9yJDguYWRkKF9vZmZzZXQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG1heFJhZGl1c1NxID0gTWF0aC5tYXgobWF4UmFkaXVzU3EsIGNlbnRlci5kaXN0YW5jZVRvU3F1YXJlZChfdmVjdG9yJDgpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZS5yYWRpdXMgPSBNYXRoLnNxcnQobWF4UmFkaXVzU3EpOwogICAgICBpZiAoaXNOYU4odGhpcy5ib3VuZGluZ1NwaGVyZS5yYWRpdXMpKSB7CiAgICAgICAgY29uc29sZS5lcnJvcignVEhSRUUuQnVmZmVyR2VvbWV0cnkuY29tcHV0ZUJvdW5kaW5nU3BoZXJlKCk6IENvbXB1dGVkIHJhZGl1cyBpcyBOYU4uIFRoZSAicG9zaXRpb24iIGF0dHJpYnV0ZSBpcyBsaWtlbHkgdG8gaGF2ZSBOYU4gdmFsdWVzLicsIHRoaXMpOwogICAgICB9CiAgICB9CiAgfQogIGNvbXB1dGVUYW5nZW50cygpIHsKICAgIGNvbnN0IGluZGV4ID0gdGhpcy5pbmRleDsKICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXM7CiAgICBpZiAoaW5kZXggPT09IG51bGwgfHwgYXR0cmlidXRlcy5wb3NpdGlvbiA9PT0gdm9pZCAwIHx8IGF0dHJpYnV0ZXMubm9ybWFsID09PSB2b2lkIDAgfHwgYXR0cmlidXRlcy51diA9PT0gdm9pZCAwKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLkJ1ZmZlckdlb21ldHJ5OiAuY29tcHV0ZVRhbmdlbnRzKCkgZmFpbGVkLiBNaXNzaW5nIHJlcXVpcmVkIGF0dHJpYnV0ZXMgKGluZGV4LCBwb3NpdGlvbiwgbm9ybWFsIG9yIHV2KSIpOwogICAgICByZXR1cm47CiAgICB9CiAgICBjb25zdCBpbmRpY2VzID0gaW5kZXguYXJyYXk7CiAgICBjb25zdCBwb3NpdGlvbnMgPSBhdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5OwogICAgY29uc3Qgbm9ybWFscyA9IGF0dHJpYnV0ZXMubm9ybWFsLmFycmF5OwogICAgY29uc3QgdXZzID0gYXR0cmlidXRlcy51di5hcnJheTsKICAgIGNvbnN0IG5WZXJ0aWNlcyA9IHBvc2l0aW9ucy5sZW5ndGggLyAzOwogICAgaWYgKGF0dHJpYnV0ZXMudGFuZ2VudCA9PT0gdm9pZCAwKSB7CiAgICAgIHRoaXMuc2V0QXR0cmlidXRlKCJ0YW5nZW50IiwgbmV3IEJ1ZmZlckF0dHJpYnV0ZShuZXcgRmxvYXQzMkFycmF5KDQgKiBuVmVydGljZXMpLCA0KSk7CiAgICB9CiAgICBjb25zdCB0YW5nZW50cyA9IGF0dHJpYnV0ZXMudGFuZ2VudC5hcnJheTsKICAgIGNvbnN0IHRhbjEgPSBbXSwgdGFuMiA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuVmVydGljZXM7IGkrKykgewogICAgICB0YW4xW2ldID0gbmV3IFZlY3RvcjMoKTsKICAgICAgdGFuMltpXSA9IG5ldyBWZWN0b3IzKCk7CiAgICB9CiAgICBjb25zdCB2QSA9IG5ldyBWZWN0b3IzKCksIHZCID0gbmV3IFZlY3RvcjMoKSwgdkMgPSBuZXcgVmVjdG9yMygpLCB1dkEgPSBuZXcgVmVjdG9yMigpLCB1dkIgPSBuZXcgVmVjdG9yMigpLCB1dkMgPSBuZXcgVmVjdG9yMigpLCBzZGlyID0gbmV3IFZlY3RvcjMoKSwgdGRpciA9IG5ldyBWZWN0b3IzKCk7CiAgICBmdW5jdGlvbiBoYW5kbGVUcmlhbmdsZShhLCBiLCBjKSB7CiAgICAgIHZBLmZyb21BcnJheShwb3NpdGlvbnMsIGEgKiAzKTsKICAgICAgdkIuZnJvbUFycmF5KHBvc2l0aW9ucywgYiAqIDMpOwogICAgICB2Qy5mcm9tQXJyYXkocG9zaXRpb25zLCBjICogMyk7CiAgICAgIHV2QS5mcm9tQXJyYXkodXZzLCBhICogMik7CiAgICAgIHV2Qi5mcm9tQXJyYXkodXZzLCBiICogMik7CiAgICAgIHV2Qy5mcm9tQXJyYXkodXZzLCBjICogMik7CiAgICAgIHZCLnN1Yih2QSk7CiAgICAgIHZDLnN1Yih2QSk7CiAgICAgIHV2Qi5zdWIodXZBKTsKICAgICAgdXZDLnN1Yih1dkEpOwogICAgICBjb25zdCByID0gMSAvICh1dkIueCAqIHV2Qy55IC0gdXZDLnggKiB1dkIueSk7CiAgICAgIGlmICghaXNGaW5pdGUocikpCiAgICAgICAgcmV0dXJuOwogICAgICBzZGlyLmNvcHkodkIpLm11bHRpcGx5U2NhbGFyKHV2Qy55KS5hZGRTY2FsZWRWZWN0b3IodkMsIC11dkIueSkubXVsdGlwbHlTY2FsYXIocik7CiAgICAgIHRkaXIuY29weSh2QykubXVsdGlwbHlTY2FsYXIodXZCLngpLmFkZFNjYWxlZFZlY3Rvcih2QiwgLXV2Qy54KS5tdWx0aXBseVNjYWxhcihyKTsKICAgICAgdGFuMVthXS5hZGQoc2Rpcik7CiAgICAgIHRhbjFbYl0uYWRkKHNkaXIpOwogICAgICB0YW4xW2NdLmFkZChzZGlyKTsKICAgICAgdGFuMlthXS5hZGQodGRpcik7CiAgICAgIHRhbjJbYl0uYWRkKHRkaXIpOwogICAgICB0YW4yW2NdLmFkZCh0ZGlyKTsKICAgIH0KICAgIGxldCBncm91cHMgPSB0aGlzLmdyb3VwczsKICAgIGlmIChncm91cHMubGVuZ3RoID09PSAwKSB7CiAgICAgIGdyb3VwcyA9IFt7CiAgICAgICAgc3RhcnQ6IDAsCiAgICAgICAgY291bnQ6IGluZGljZXMubGVuZ3RoCiAgICAgIH1dOwogICAgfQogICAgZm9yIChsZXQgaSA9IDAsIGlsID0gZ3JvdXBzLmxlbmd0aDsgaSA8IGlsOyArK2kpIHsKICAgICAgY29uc3QgZ3JvdXAgPSBncm91cHNbaV07CiAgICAgIGNvbnN0IHN0YXJ0ID0gZ3JvdXAuc3RhcnQ7CiAgICAgIGNvbnN0IGNvdW50ID0gZ3JvdXAuY291bnQ7CiAgICAgIGZvciAobGV0IGogPSBzdGFydCwgamwgPSBzdGFydCArIGNvdW50OyBqIDwgamw7IGogKz0gMykgewogICAgICAgIGhhbmRsZVRyaWFuZ2xlKGluZGljZXNbaiArIDBdLCBpbmRpY2VzW2ogKyAxXSwgaW5kaWNlc1tqICsgMl0pOwogICAgICB9CiAgICB9CiAgICBjb25zdCB0bXAyID0gbmV3IFZlY3RvcjMoKSwgdG1wMjIgPSBuZXcgVmVjdG9yMygpOwogICAgY29uc3QgbiA9IG5ldyBWZWN0b3IzKCksIG4yID0gbmV3IFZlY3RvcjMoKTsKICAgIGZ1bmN0aW9uIGhhbmRsZVZlcnRleCh2KSB7CiAgICAgIG4uZnJvbUFycmF5KG5vcm1hbHMsIHYgKiAzKTsKICAgICAgbjIuY29weShuKTsKICAgICAgY29uc3QgdCA9IHRhbjFbdl07CiAgICAgIHRtcDIuY29weSh0KTsKICAgICAgdG1wMi5zdWIobi5tdWx0aXBseVNjYWxhcihuLmRvdCh0KSkpLm5vcm1hbGl6ZSgpOwogICAgICB0bXAyMi5jcm9zc1ZlY3RvcnMobjIsIHQpOwogICAgICBjb25zdCB0ZXN0ID0gdG1wMjIuZG90KHRhbjJbdl0pOwogICAgICBjb25zdCB3ID0gdGVzdCA8IDAgPyAtMSA6IDE7CiAgICAgIHRhbmdlbnRzW3YgKiA0XSA9IHRtcDIueDsKICAgICAgdGFuZ2VudHNbdiAqIDQgKyAxXSA9IHRtcDIueTsKICAgICAgdGFuZ2VudHNbdiAqIDQgKyAyXSA9IHRtcDIuejsKICAgICAgdGFuZ2VudHNbdiAqIDQgKyAzXSA9IHc7CiAgICB9CiAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBncm91cHMubGVuZ3RoOyBpIDwgaWw7ICsraSkgewogICAgICBjb25zdCBncm91cCA9IGdyb3Vwc1tpXTsKICAgICAgY29uc3Qgc3RhcnQgPSBncm91cC5zdGFydDsKICAgICAgY29uc3QgY291bnQgPSBncm91cC5jb3VudDsKICAgICAgZm9yIChsZXQgaiA9IHN0YXJ0LCBqbCA9IHN0YXJ0ICsgY291bnQ7IGogPCBqbDsgaiArPSAzKSB7CiAgICAgICAgaGFuZGxlVmVydGV4KGluZGljZXNbaiArIDBdKTsKICAgICAgICBoYW5kbGVWZXJ0ZXgoaW5kaWNlc1tqICsgMV0pOwogICAgICAgIGhhbmRsZVZlcnRleChpbmRpY2VzW2ogKyAyXSk7CiAgICAgIH0KICAgIH0KICB9CiAgY29tcHV0ZVZlcnRleE5vcm1hbHMoKSB7CiAgICBjb25zdCBpbmRleCA9IHRoaXMuaW5kZXg7CiAgICBjb25zdCBwb3NpdGlvbkF0dHJpYnV0ZSA9IHRoaXMuZ2V0QXR0cmlidXRlKCJwb3NpdGlvbiIpOwogICAgaWYgKHBvc2l0aW9uQXR0cmlidXRlICE9PSB2b2lkIDApIHsKICAgICAgbGV0IG5vcm1hbEF0dHJpYnV0ZSA9IHRoaXMuZ2V0QXR0cmlidXRlKCJub3JtYWwiKTsKICAgICAgaWYgKG5vcm1hbEF0dHJpYnV0ZSA9PT0gdm9pZCAwKSB7CiAgICAgICAgbm9ybWFsQXR0cmlidXRlID0gbmV3IEJ1ZmZlckF0dHJpYnV0ZShuZXcgRmxvYXQzMkFycmF5KHBvc2l0aW9uQXR0cmlidXRlLmNvdW50ICogMyksIDMpOwogICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKCJub3JtYWwiLCBub3JtYWxBdHRyaWJ1dGUpOwogICAgICB9IGVsc2UgewogICAgICAgIGZvciAobGV0IGkgPSAwLCBpbCA9IG5vcm1hbEF0dHJpYnV0ZS5jb3VudDsgaSA8IGlsOyBpKyspIHsKICAgICAgICAgIG5vcm1hbEF0dHJpYnV0ZS5zZXRYWVooaSwgMCwgMCwgMCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbnN0IHBBID0gbmV3IFZlY3RvcjMoKSwgcEIgPSBuZXcgVmVjdG9yMygpLCBwQyA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIGNvbnN0IG5BID0gbmV3IFZlY3RvcjMoKSwgbkIgPSBuZXcgVmVjdG9yMygpLCBuQyA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIGNvbnN0IGNiID0gbmV3IFZlY3RvcjMoKSwgYWIgPSBuZXcgVmVjdG9yMygpOwogICAgICBpZiAoaW5kZXgpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBpbmRleC5jb3VudDsgaSA8IGlsOyBpICs9IDMpIHsKICAgICAgICAgIGNvbnN0IHZBID0gaW5kZXguZ2V0WChpICsgMCk7CiAgICAgICAgICBjb25zdCB2QiA9IGluZGV4LmdldFgoaSArIDEpOwogICAgICAgICAgY29uc3QgdkMgPSBpbmRleC5nZXRYKGkgKyAyKTsKICAgICAgICAgIHBBLmZyb21CdWZmZXJBdHRyaWJ1dGUocG9zaXRpb25BdHRyaWJ1dGUsIHZBKTsKICAgICAgICAgIHBCLmZyb21CdWZmZXJBdHRyaWJ1dGUocG9zaXRpb25BdHRyaWJ1dGUsIHZCKTsKICAgICAgICAgIHBDLmZyb21CdWZmZXJBdHRyaWJ1dGUocG9zaXRpb25BdHRyaWJ1dGUsIHZDKTsKICAgICAgICAgIGNiLnN1YlZlY3RvcnMocEMsIHBCKTsKICAgICAgICAgIGFiLnN1YlZlY3RvcnMocEEsIHBCKTsKICAgICAgICAgIGNiLmNyb3NzKGFiKTsKICAgICAgICAgIG5BLmZyb21CdWZmZXJBdHRyaWJ1dGUobm9ybWFsQXR0cmlidXRlLCB2QSk7CiAgICAgICAgICBuQi5mcm9tQnVmZmVyQXR0cmlidXRlKG5vcm1hbEF0dHJpYnV0ZSwgdkIpOwogICAgICAgICAgbkMuZnJvbUJ1ZmZlckF0dHJpYnV0ZShub3JtYWxBdHRyaWJ1dGUsIHZDKTsKICAgICAgICAgIG5BLmFkZChjYik7CiAgICAgICAgICBuQi5hZGQoY2IpOwogICAgICAgICAgbkMuYWRkKGNiKTsKICAgICAgICAgIG5vcm1hbEF0dHJpYnV0ZS5zZXRYWVoodkEsIG5BLngsIG5BLnksIG5BLnopOwogICAgICAgICAgbm9ybWFsQXR0cmlidXRlLnNldFhZWih2QiwgbkIueCwgbkIueSwgbkIueik7CiAgICAgICAgICBub3JtYWxBdHRyaWJ1dGUuc2V0WFlaKHZDLCBuQy54LCBuQy55LCBuQy56KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlsID0gcG9zaXRpb25BdHRyaWJ1dGUuY291bnQ7IGkgPCBpbDsgaSArPSAzKSB7CiAgICAgICAgICBwQS5mcm9tQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9uQXR0cmlidXRlLCBpICsgMCk7CiAgICAgICAgICBwQi5mcm9tQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9uQXR0cmlidXRlLCBpICsgMSk7CiAgICAgICAgICBwQy5mcm9tQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9uQXR0cmlidXRlLCBpICsgMik7CiAgICAgICAgICBjYi5zdWJWZWN0b3JzKHBDLCBwQik7CiAgICAgICAgICBhYi5zdWJWZWN0b3JzKHBBLCBwQik7CiAgICAgICAgICBjYi5jcm9zcyhhYik7CiAgICAgICAgICBub3JtYWxBdHRyaWJ1dGUuc2V0WFlaKGkgKyAwLCBjYi54LCBjYi55LCBjYi56KTsKICAgICAgICAgIG5vcm1hbEF0dHJpYnV0ZS5zZXRYWVooaSArIDEsIGNiLngsIGNiLnksIGNiLnopOwogICAgICAgICAgbm9ybWFsQXR0cmlidXRlLnNldFhZWihpICsgMiwgY2IueCwgY2IueSwgY2Iueik7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMubm9ybWFsaXplTm9ybWFscygpOwogICAgICBub3JtYWxBdHRyaWJ1dGUubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgfQogIH0KICBtZXJnZShnZW9tZXRyeSwgb2Zmc2V0KSB7CiAgICBpZiAoIShnZW9tZXRyeSAmJiBnZW9tZXRyeS5pc0J1ZmZlckdlb21ldHJ5KSkgewogICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5CdWZmZXJHZW9tZXRyeS5tZXJnZSgpOiBnZW9tZXRyeSBub3QgYW4gaW5zdGFuY2Ugb2YgVEhSRUUuQnVmZmVyR2VvbWV0cnkuIiwgZ2VvbWV0cnkpOwogICAgICByZXR1cm47CiAgICB9CiAgICBpZiAob2Zmc2V0ID09PSB2b2lkIDApIHsKICAgICAgb2Zmc2V0ID0gMDsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5CdWZmZXJHZW9tZXRyeS5tZXJnZSgpOiBPdmVyd3JpdGluZyBvcmlnaW5hbCBnZW9tZXRyeSwgc3RhcnRpbmcgYXQgb2Zmc2V0PTAuIFVzZSBCdWZmZXJHZW9tZXRyeVV0aWxzLm1lcmdlQnVmZmVyR2VvbWV0cmllcygpIGZvciBsb3NzbGVzcyBtZXJnZS4iKTsKICAgIH0KICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXM7CiAgICBmb3IgKGNvbnN0IGtleSBpbiBhdHRyaWJ1dGVzKSB7CiAgICAgIGlmIChnZW9tZXRyeS5hdHRyaWJ1dGVzW2tleV0gPT09IHZvaWQgMCkKICAgICAgICBjb250aW51ZTsKICAgICAgY29uc3QgYXR0cmlidXRlMSA9IGF0dHJpYnV0ZXNba2V5XTsKICAgICAgY29uc3QgYXR0cmlidXRlQXJyYXkxID0gYXR0cmlidXRlMS5hcnJheTsKICAgICAgY29uc3QgYXR0cmlidXRlMiA9IGdlb21ldHJ5LmF0dHJpYnV0ZXNba2V5XTsKICAgICAgY29uc3QgYXR0cmlidXRlQXJyYXkyID0gYXR0cmlidXRlMi5hcnJheTsKICAgICAgY29uc3QgYXR0cmlidXRlT2Zmc2V0ID0gYXR0cmlidXRlMi5pdGVtU2l6ZSAqIG9mZnNldDsKICAgICAgY29uc3QgbGVuZ3RoID0gTWF0aC5taW4oYXR0cmlidXRlQXJyYXkyLmxlbmd0aCwgYXR0cmlidXRlQXJyYXkxLmxlbmd0aCAtIGF0dHJpYnV0ZU9mZnNldCk7CiAgICAgIGZvciAobGV0IGkgPSAwLCBqID0gYXR0cmlidXRlT2Zmc2V0OyBpIDwgbGVuZ3RoOyBpKyssIGorKykgewogICAgICAgIGF0dHJpYnV0ZUFycmF5MVtqXSA9IGF0dHJpYnV0ZUFycmF5MltpXTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIG5vcm1hbGl6ZU5vcm1hbHMoKSB7CiAgICBjb25zdCBub3JtYWxzID0gdGhpcy5hdHRyaWJ1dGVzLm5vcm1hbDsKICAgIGZvciAobGV0IGkgPSAwLCBpbCA9IG5vcm1hbHMuY291bnQ7IGkgPCBpbDsgaSsrKSB7CiAgICAgIF92ZWN0b3IkOC5mcm9tQnVmZmVyQXR0cmlidXRlKG5vcm1hbHMsIGkpOwogICAgICBfdmVjdG9yJDgubm9ybWFsaXplKCk7CiAgICAgIG5vcm1hbHMuc2V0WFlaKGksIF92ZWN0b3IkOC54LCBfdmVjdG9yJDgueSwgX3ZlY3RvciQ4LnopOwogICAgfQogIH0KICB0b05vbkluZGV4ZWQoKSB7CiAgICBmdW5jdGlvbiBjb252ZXJ0QnVmZmVyQXR0cmlidXRlKGF0dHJpYnV0ZSwgaW5kaWNlczIpIHsKICAgICAgY29uc3QgYXJyYXkgPSBhdHRyaWJ1dGUuYXJyYXk7CiAgICAgIGNvbnN0IGl0ZW1TaXplID0gYXR0cmlidXRlLml0ZW1TaXplOwogICAgICBjb25zdCBub3JtYWxpemVkID0gYXR0cmlidXRlLm5vcm1hbGl6ZWQ7CiAgICAgIGNvbnN0IGFycmF5MiA9IG5ldyBhcnJheS5jb25zdHJ1Y3RvcihpbmRpY2VzMi5sZW5ndGggKiBpdGVtU2l6ZSk7CiAgICAgIGxldCBpbmRleCA9IDAsIGluZGV4MiA9IDA7CiAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gaW5kaWNlczIubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgaWYgKGF0dHJpYnV0ZS5pc0ludGVybGVhdmVkQnVmZmVyQXR0cmlidXRlKSB7CiAgICAgICAgICBpbmRleCA9IGluZGljZXMyW2ldICogYXR0cmlidXRlLmRhdGEuc3RyaWRlICsgYXR0cmlidXRlLm9mZnNldDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaW5kZXggPSBpbmRpY2VzMltpXSAqIGl0ZW1TaXplOwogICAgICAgIH0KICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGl0ZW1TaXplOyBqKyspIHsKICAgICAgICAgIGFycmF5MltpbmRleDIrK10gPSBhcnJheVtpbmRleCsrXTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIG5ldyBCdWZmZXJBdHRyaWJ1dGUoYXJyYXkyLCBpdGVtU2l6ZSwgbm9ybWFsaXplZCk7CiAgICB9CiAgICBpZiAodGhpcy5pbmRleCA9PT0gbnVsbCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkJ1ZmZlckdlb21ldHJ5LnRvTm9uSW5kZXhlZCgpOiBCdWZmZXJHZW9tZXRyeSBpcyBhbHJlYWR5IG5vbi1pbmRleGVkLiIpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIGNvbnN0IGdlb21ldHJ5MiA9IG5ldyBCdWZmZXJHZW9tZXRyeSgpOwogICAgY29uc3QgaW5kaWNlcyA9IHRoaXMuaW5kZXguYXJyYXk7CiAgICBjb25zdCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzOwogICAgZm9yIChjb25zdCBuYW1lIGluIGF0dHJpYnV0ZXMpIHsKICAgICAgY29uc3QgYXR0cmlidXRlID0gYXR0cmlidXRlc1tuYW1lXTsKICAgICAgY29uc3QgbmV3QXR0cmlidXRlID0gY29udmVydEJ1ZmZlckF0dHJpYnV0ZShhdHRyaWJ1dGUsIGluZGljZXMpOwogICAgICBnZW9tZXRyeTIuc2V0QXR0cmlidXRlKG5hbWUsIG5ld0F0dHJpYnV0ZSk7CiAgICB9CiAgICBjb25zdCBtb3JwaEF0dHJpYnV0ZXMgPSB0aGlzLm1vcnBoQXR0cmlidXRlczsKICAgIGZvciAoY29uc3QgbmFtZSBpbiBtb3JwaEF0dHJpYnV0ZXMpIHsKICAgICAgY29uc3QgbW9ycGhBcnJheSA9IFtdOwogICAgICBjb25zdCBtb3JwaEF0dHJpYnV0ZSA9IG1vcnBoQXR0cmlidXRlc1tuYW1lXTsKICAgICAgZm9yIChsZXQgaSA9IDAsIGlsID0gbW9ycGhBdHRyaWJ1dGUubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IG1vcnBoQXR0cmlidXRlW2ldOwogICAgICAgIGNvbnN0IG5ld0F0dHJpYnV0ZSA9IGNvbnZlcnRCdWZmZXJBdHRyaWJ1dGUoYXR0cmlidXRlLCBpbmRpY2VzKTsKICAgICAgICBtb3JwaEFycmF5LnB1c2gobmV3QXR0cmlidXRlKTsKICAgICAgfQogICAgICBnZW9tZXRyeTIubW9ycGhBdHRyaWJ1dGVzW25hbWVdID0gbW9ycGhBcnJheTsKICAgIH0KICAgIGdlb21ldHJ5Mi5tb3JwaFRhcmdldHNSZWxhdGl2ZSA9IHRoaXMubW9ycGhUYXJnZXRzUmVsYXRpdmU7CiAgICBjb25zdCBncm91cHMgPSB0aGlzLmdyb3VwczsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gZ3JvdXBzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBjb25zdCBncm91cCA9IGdyb3Vwc1tpXTsKICAgICAgZ2VvbWV0cnkyLmFkZEdyb3VwKGdyb3VwLnN0YXJ0LCBncm91cC5jb3VudCwgZ3JvdXAubWF0ZXJpYWxJbmRleCk7CiAgICB9CiAgICByZXR1cm4gZ2VvbWV0cnkyOwogIH0KICB0b0pTT04oKSB7CiAgICBjb25zdCBkYXRhID0gewogICAgICBtZXRhZGF0YTogewogICAgICAgIHZlcnNpb246IDQuNSwKICAgICAgICB0eXBlOiAiQnVmZmVyR2VvbWV0cnkiLAogICAgICAgIGdlbmVyYXRvcjogIkJ1ZmZlckdlb21ldHJ5LnRvSlNPTiIKICAgICAgfQogICAgfTsKICAgIGRhdGEudXVpZCA9IHRoaXMudXVpZDsKICAgIGRhdGEudHlwZSA9IHRoaXMudHlwZTsKICAgIGlmICh0aGlzLm5hbWUgIT09ICIiKQogICAgICBkYXRhLm5hbWUgPSB0aGlzLm5hbWU7CiAgICBpZiAoT2JqZWN0LmtleXModGhpcy51c2VyRGF0YSkubGVuZ3RoID4gMCkKICAgICAgZGF0YS51c2VyRGF0YSA9IHRoaXMudXNlckRhdGE7CiAgICBpZiAodGhpcy5wYXJhbWV0ZXJzICE9PSB2b2lkIDApIHsKICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHRoaXMucGFyYW1ldGVyczsKICAgICAgZm9yIChjb25zdCBrZXkgaW4gcGFyYW1ldGVycykgewogICAgICAgIGlmIChwYXJhbWV0ZXJzW2tleV0gIT09IHZvaWQgMCkKICAgICAgICAgIGRhdGFba2V5XSA9IHBhcmFtZXRlcnNba2V5XTsKICAgICAgfQogICAgICByZXR1cm4gZGF0YTsKICAgIH0KICAgIGRhdGEuZGF0YSA9IHsgYXR0cmlidXRlczoge30gfTsKICAgIGNvbnN0IGluZGV4ID0gdGhpcy5pbmRleDsKICAgIGlmIChpbmRleCAhPT0gbnVsbCkgewogICAgICBkYXRhLmRhdGEuaW5kZXggPSB7CiAgICAgICAgdHlwZTogaW5kZXguYXJyYXkuY29uc3RydWN0b3IubmFtZSwKICAgICAgICBhcnJheTogQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoaW5kZXguYXJyYXkpCiAgICAgIH07CiAgICB9CiAgICBjb25zdCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzOwogICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cmlidXRlcykgewogICAgICBjb25zdCBhdHRyaWJ1dGUgPSBhdHRyaWJ1dGVzW2tleV07CiAgICAgIGRhdGEuZGF0YS5hdHRyaWJ1dGVzW2tleV0gPSBhdHRyaWJ1dGUudG9KU09OKGRhdGEuZGF0YSk7CiAgICB9CiAgICBjb25zdCBtb3JwaEF0dHJpYnV0ZXMgPSB7fTsKICAgIGxldCBoYXNNb3JwaEF0dHJpYnV0ZXMgPSBmYWxzZTsKICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMubW9ycGhBdHRyaWJ1dGVzKSB7CiAgICAgIGNvbnN0IGF0dHJpYnV0ZUFycmF5ID0gdGhpcy5tb3JwaEF0dHJpYnV0ZXNba2V5XTsKICAgICAgY29uc3QgYXJyYXkgPSBbXTsKICAgICAgZm9yIChsZXQgaSA9IDAsIGlsID0gYXR0cmlidXRlQXJyYXkubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IGF0dHJpYnV0ZUFycmF5W2ldOwogICAgICAgIGFycmF5LnB1c2goYXR0cmlidXRlLnRvSlNPTihkYXRhLmRhdGEpKTsKICAgICAgfQogICAgICBpZiAoYXJyYXkubGVuZ3RoID4gMCkgewogICAgICAgIG1vcnBoQXR0cmlidXRlc1trZXldID0gYXJyYXk7CiAgICAgICAgaGFzTW9ycGhBdHRyaWJ1dGVzID0gdHJ1ZTsKICAgICAgfQogICAgfQogICAgaWYgKGhhc01vcnBoQXR0cmlidXRlcykgewogICAgICBkYXRhLmRhdGEubW9ycGhBdHRyaWJ1dGVzID0gbW9ycGhBdHRyaWJ1dGVzOwogICAgICBkYXRhLmRhdGEubW9ycGhUYXJnZXRzUmVsYXRpdmUgPSB0aGlzLm1vcnBoVGFyZ2V0c1JlbGF0aXZlOwogICAgfQogICAgY29uc3QgZ3JvdXBzID0gdGhpcy5ncm91cHM7CiAgICBpZiAoZ3JvdXBzLmxlbmd0aCA+IDApIHsKICAgICAgZGF0YS5kYXRhLmdyb3VwcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZ3JvdXBzKSk7CiAgICB9CiAgICBjb25zdCBib3VuZGluZ1NwaGVyZSA9IHRoaXMuYm91bmRpbmdTcGhlcmU7CiAgICBpZiAoYm91bmRpbmdTcGhlcmUgIT09IG51bGwpIHsKICAgICAgZGF0YS5kYXRhLmJvdW5kaW5nU3BoZXJlID0gewogICAgICAgIGNlbnRlcjogYm91bmRpbmdTcGhlcmUuY2VudGVyLnRvQXJyYXkoKSwKICAgICAgICByYWRpdXM6IGJvdW5kaW5nU3BoZXJlLnJhZGl1cwogICAgICB9OwogICAgfQogICAgcmV0dXJuIGRhdGE7CiAgfQogIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKCkuY29weSh0aGlzKTsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHRoaXMuaW5kZXggPSBudWxsOwogICAgdGhpcy5hdHRyaWJ1dGVzID0ge307CiAgICB0aGlzLm1vcnBoQXR0cmlidXRlcyA9IHt9OwogICAgdGhpcy5ncm91cHMgPSBbXTsKICAgIHRoaXMuYm91bmRpbmdCb3ggPSBudWxsOwogICAgdGhpcy5ib3VuZGluZ1NwaGVyZSA9IG51bGw7CiAgICBjb25zdCBkYXRhID0ge307CiAgICB0aGlzLm5hbWUgPSBzb3VyY2UubmFtZTsKICAgIGNvbnN0IGluZGV4ID0gc291cmNlLmluZGV4OwogICAgaWYgKGluZGV4ICE9PSBudWxsKSB7CiAgICAgIHRoaXMuc2V0SW5kZXgoaW5kZXguY2xvbmUoZGF0YSkpOwogICAgfQogICAgY29uc3QgYXR0cmlidXRlcyA9IHNvdXJjZS5hdHRyaWJ1dGVzOwogICAgZm9yIChjb25zdCBuYW1lIGluIGF0dHJpYnV0ZXMpIHsKICAgICAgY29uc3QgYXR0cmlidXRlID0gYXR0cmlidXRlc1tuYW1lXTsKICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUobmFtZSwgYXR0cmlidXRlLmNsb25lKGRhdGEpKTsKICAgIH0KICAgIGNvbnN0IG1vcnBoQXR0cmlidXRlcyA9IHNvdXJjZS5tb3JwaEF0dHJpYnV0ZXM7CiAgICBmb3IgKGNvbnN0IG5hbWUgaW4gbW9ycGhBdHRyaWJ1dGVzKSB7CiAgICAgIGNvbnN0IGFycmF5ID0gW107CiAgICAgIGNvbnN0IG1vcnBoQXR0cmlidXRlID0gbW9ycGhBdHRyaWJ1dGVzW25hbWVdOwogICAgICBmb3IgKGxldCBpID0gMCwgbCA9IG1vcnBoQXR0cmlidXRlLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGFycmF5LnB1c2gobW9ycGhBdHRyaWJ1dGVbaV0uY2xvbmUoZGF0YSkpOwogICAgICB9CiAgICAgIHRoaXMubW9ycGhBdHRyaWJ1dGVzW25hbWVdID0gYXJyYXk7CiAgICB9CiAgICB0aGlzLm1vcnBoVGFyZ2V0c1JlbGF0aXZlID0gc291cmNlLm1vcnBoVGFyZ2V0c1JlbGF0aXZlOwogICAgY29uc3QgZ3JvdXBzID0gc291cmNlLmdyb3VwczsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gZ3JvdXBzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBjb25zdCBncm91cCA9IGdyb3Vwc1tpXTsKICAgICAgdGhpcy5hZGRHcm91cChncm91cC5zdGFydCwgZ3JvdXAuY291bnQsIGdyb3VwLm1hdGVyaWFsSW5kZXgpOwogICAgfQogICAgY29uc3QgYm91bmRpbmdCb3ggPSBzb3VyY2UuYm91bmRpbmdCb3g7CiAgICBpZiAoYm91bmRpbmdCb3ggIT09IG51bGwpIHsKICAgICAgdGhpcy5ib3VuZGluZ0JveCA9IGJvdW5kaW5nQm94LmNsb25lKCk7CiAgICB9CiAgICBjb25zdCBib3VuZGluZ1NwaGVyZSA9IHNvdXJjZS5ib3VuZGluZ1NwaGVyZTsKICAgIGlmIChib3VuZGluZ1NwaGVyZSAhPT0gbnVsbCkgewogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlID0gYm91bmRpbmdTcGhlcmUuY2xvbmUoKTsKICAgIH0KICAgIHRoaXMuZHJhd1JhbmdlLnN0YXJ0ID0gc291cmNlLmRyYXdSYW5nZS5zdGFydDsKICAgIHRoaXMuZHJhd1JhbmdlLmNvdW50ID0gc291cmNlLmRyYXdSYW5nZS5jb3VudDsKICAgIHRoaXMudXNlckRhdGEgPSBzb3VyY2UudXNlckRhdGE7CiAgICBpZiAoc291cmNlLnBhcmFtZXRlcnMgIT09IHZvaWQgMCkKICAgICAgdGhpcy5wYXJhbWV0ZXJzID0gT2JqZWN0LmFzc2lnbih7fSwgc291cmNlLnBhcmFtZXRlcnMpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGRpc3Bvc2UoKSB7CiAgICB0aGlzLmRpc3BhdGNoRXZlbnQoeyB0eXBlOiAiZGlzcG9zZSIgfSk7CiAgfQp9CkJ1ZmZlckdlb21ldHJ5LnByb3RvdHlwZS5pc0J1ZmZlckdlb21ldHJ5ID0gdHJ1ZTsKY29uc3QgX2ludmVyc2VNYXRyaXgkMiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWF0cml4NCgpOwpjb25zdCBfcmF5JDIgPSAvKiBAX19QVVJFX18gKi8gbmV3IFJheSgpOwpjb25zdCBfc3BoZXJlJDMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNwaGVyZSgpOwpjb25zdCBfdkEkMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfdkIkMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfdkMkMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfdGVtcEEgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3RlbXBCID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF90ZW1wQyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfbW9ycGhBID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF9tb3JwaEIgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX21vcnBoQyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfdXZBJDEgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjIoKTsKY29uc3QgX3V2QiQxID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IyKCk7CmNvbnN0IF91dkMkMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMigpOwpjb25zdCBfaW50ZXJzZWN0aW9uUG9pbnQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX2ludGVyc2VjdGlvblBvaW50V29ybGQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY2xhc3MgTWVzaCBleHRlbmRzIE9iamVjdDNEIHsKICBjb25zdHJ1Y3RvcihnZW9tZXRyeSA9IG5ldyBCdWZmZXJHZW9tZXRyeSgpLCBtYXRlcmlhbCA9IG5ldyBNZXNoQmFzaWNNYXRlcmlhbCgpKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIk1lc2giOwogICAgdGhpcy5nZW9tZXRyeSA9IGdlb21ldHJ5OwogICAgdGhpcy5tYXRlcmlhbCA9IG1hdGVyaWFsOwogICAgdGhpcy51cGRhdGVNb3JwaFRhcmdldHMoKTsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHN1cGVyLmNvcHkoc291cmNlKTsKICAgIGlmIChzb3VyY2UubW9ycGhUYXJnZXRJbmZsdWVuY2VzICE9PSB2b2lkIDApIHsKICAgICAgdGhpcy5tb3JwaFRhcmdldEluZmx1ZW5jZXMgPSBzb3VyY2UubW9ycGhUYXJnZXRJbmZsdWVuY2VzLnNsaWNlKCk7CiAgICB9CiAgICBpZiAoc291cmNlLm1vcnBoVGFyZ2V0RGljdGlvbmFyeSAhPT0gdm9pZCAwKSB7CiAgICAgIHRoaXMubW9ycGhUYXJnZXREaWN0aW9uYXJ5ID0gT2JqZWN0LmFzc2lnbih7fSwgc291cmNlLm1vcnBoVGFyZ2V0RGljdGlvbmFyeSk7CiAgICB9CiAgICB0aGlzLm1hdGVyaWFsID0gc291cmNlLm1hdGVyaWFsOwogICAgdGhpcy5nZW9tZXRyeSA9IHNvdXJjZS5nZW9tZXRyeTsKICAgIHJldHVybiB0aGlzOwogIH0KICB1cGRhdGVNb3JwaFRhcmdldHMoKSB7CiAgICBjb25zdCBnZW9tZXRyeSA9IHRoaXMuZ2VvbWV0cnk7CiAgICBpZiAoZ2VvbWV0cnkuaXNCdWZmZXJHZW9tZXRyeSkgewogICAgICBjb25zdCBtb3JwaEF0dHJpYnV0ZXMgPSBnZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXM7CiAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhtb3JwaEF0dHJpYnV0ZXMpOwogICAgICBpZiAoa2V5cy5sZW5ndGggPiAwKSB7CiAgICAgICAgY29uc3QgbW9ycGhBdHRyaWJ1dGUgPSBtb3JwaEF0dHJpYnV0ZXNba2V5c1swXV07CiAgICAgICAgaWYgKG1vcnBoQXR0cmlidXRlICE9PSB2b2lkIDApIHsKICAgICAgICAgIHRoaXMubW9ycGhUYXJnZXRJbmZsdWVuY2VzID0gW107CiAgICAgICAgICB0aGlzLm1vcnBoVGFyZ2V0RGljdGlvbmFyeSA9IHt9OwogICAgICAgICAgZm9yIChsZXQgbSA9IDAsIG1sID0gbW9ycGhBdHRyaWJ1dGUubGVuZ3RoOyBtIDwgbWw7IG0rKykgewogICAgICAgICAgICBjb25zdCBuYW1lID0gbW9ycGhBdHRyaWJ1dGVbbV0ubmFtZSB8fCBTdHJpbmcobSk7CiAgICAgICAgICAgIHRoaXMubW9ycGhUYXJnZXRJbmZsdWVuY2VzLnB1c2goMCk7CiAgICAgICAgICAgIHRoaXMubW9ycGhUYXJnZXREaWN0aW9uYXJ5W25hbWVdID0gbTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IG1vcnBoVGFyZ2V0cyA9IGdlb21ldHJ5Lm1vcnBoVGFyZ2V0czsKICAgICAgaWYgKG1vcnBoVGFyZ2V0cyAhPT0gdm9pZCAwICYmIG1vcnBoVGFyZ2V0cy5sZW5ndGggPiAwKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuTWVzaC51cGRhdGVNb3JwaFRhcmdldHMoKSBubyBsb25nZXIgc3VwcG9ydHMgVEhSRUUuR2VvbWV0cnkuIFVzZSBUSFJFRS5CdWZmZXJHZW9tZXRyeSBpbnN0ZWFkLiIpOwogICAgICB9CiAgICB9CiAgfQogIHJheWNhc3QocmF5Y2FzdGVyLCBpbnRlcnNlY3RzMikgewogICAgY29uc3QgZ2VvbWV0cnkgPSB0aGlzLmdlb21ldHJ5OwogICAgY29uc3QgbWF0ZXJpYWwgPSB0aGlzLm1hdGVyaWFsOwogICAgY29uc3QgbWF0cml4V29ybGQgPSB0aGlzLm1hdHJpeFdvcmxkOwogICAgaWYgKG1hdGVyaWFsID09PSB2b2lkIDApCiAgICAgIHJldHVybjsKICAgIGlmIChnZW9tZXRyeS5ib3VuZGluZ1NwaGVyZSA9PT0gbnVsbCkKICAgICAgZ2VvbWV0cnkuY29tcHV0ZUJvdW5kaW5nU3BoZXJlKCk7CiAgICBfc3BoZXJlJDMuY29weShnZW9tZXRyeS5ib3VuZGluZ1NwaGVyZSk7CiAgICBfc3BoZXJlJDMuYXBwbHlNYXRyaXg0KG1hdHJpeFdvcmxkKTsKICAgIGlmIChyYXljYXN0ZXIucmF5LmludGVyc2VjdHNTcGhlcmUoX3NwaGVyZSQzKSA9PT0gZmFsc2UpCiAgICAgIHJldHVybjsKICAgIF9pbnZlcnNlTWF0cml4JDIuY29weShtYXRyaXhXb3JsZCkuaW52ZXJ0KCk7CiAgICBfcmF5JDIuY29weShyYXljYXN0ZXIucmF5KS5hcHBseU1hdHJpeDQoX2ludmVyc2VNYXRyaXgkMik7CiAgICBpZiAoZ2VvbWV0cnkuYm91bmRpbmdCb3ggIT09IG51bGwpIHsKICAgICAgaWYgKF9yYXkkMi5pbnRlcnNlY3RzQm94KGdlb21ldHJ5LmJvdW5kaW5nQm94KSA9PT0gZmFsc2UpCiAgICAgICAgcmV0dXJuOwogICAgfQogICAgbGV0IGludGVyc2VjdGlvbjsKICAgIGlmIChnZW9tZXRyeS5pc0J1ZmZlckdlb21ldHJ5KSB7CiAgICAgIGNvbnN0IGluZGV4ID0gZ2VvbWV0cnkuaW5kZXg7CiAgICAgIGNvbnN0IHBvc2l0aW9uID0gZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbjsKICAgICAgY29uc3QgbW9ycGhQb3NpdGlvbiA9IGdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcy5wb3NpdGlvbjsKICAgICAgY29uc3QgbW9ycGhUYXJnZXRzUmVsYXRpdmUgPSBnZW9tZXRyeS5tb3JwaFRhcmdldHNSZWxhdGl2ZTsKICAgICAgY29uc3QgdXYgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzLnV2OwogICAgICBjb25zdCB1djIgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzLnV2MjsKICAgICAgY29uc3QgZ3JvdXBzID0gZ2VvbWV0cnkuZ3JvdXBzOwogICAgICBjb25zdCBkcmF3UmFuZ2UgPSBnZW9tZXRyeS5kcmF3UmFuZ2U7CiAgICAgIGlmIChpbmRleCAhPT0gbnVsbCkgewogICAgICAgIGlmIChBcnJheS5pc0FycmF5KG1hdGVyaWFsKSkgewogICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlsID0gZ3JvdXBzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHsKICAgICAgICAgICAgY29uc3QgZ3JvdXAgPSBncm91cHNbaV07CiAgICAgICAgICAgIGNvbnN0IGdyb3VwTWF0ZXJpYWwgPSBtYXRlcmlhbFtncm91cC5tYXRlcmlhbEluZGV4XTsKICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBNYXRoLm1heChncm91cC5zdGFydCwgZHJhd1JhbmdlLnN0YXJ0KTsKICAgICAgICAgICAgY29uc3QgZW5kID0gTWF0aC5taW4oaW5kZXguY291bnQsIE1hdGgubWluKGdyb3VwLnN0YXJ0ICsgZ3JvdXAuY291bnQsIGRyYXdSYW5nZS5zdGFydCArIGRyYXdSYW5nZS5jb3VudCkpOwogICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnQsIGpsID0gZW5kOyBqIDwgamw7IGogKz0gMykgewogICAgICAgICAgICAgIGNvbnN0IGEgPSBpbmRleC5nZXRYKGopOwogICAgICAgICAgICAgIGNvbnN0IGIgPSBpbmRleC5nZXRYKGogKyAxKTsKICAgICAgICAgICAgICBjb25zdCBjID0gaW5kZXguZ2V0WChqICsgMik7CiAgICAgICAgICAgICAgaW50ZXJzZWN0aW9uID0gY2hlY2tCdWZmZXJHZW9tZXRyeUludGVyc2VjdGlvbih0aGlzLCBncm91cE1hdGVyaWFsLCByYXljYXN0ZXIsIF9yYXkkMiwgcG9zaXRpb24sIG1vcnBoUG9zaXRpb24sIG1vcnBoVGFyZ2V0c1JlbGF0aXZlLCB1diwgdXYyLCBhLCBiLCBjKTsKICAgICAgICAgICAgICBpZiAoaW50ZXJzZWN0aW9uKSB7CiAgICAgICAgICAgICAgICBpbnRlcnNlY3Rpb24uZmFjZUluZGV4ID0gTWF0aC5mbG9vcihqIC8gMyk7CiAgICAgICAgICAgICAgICBpbnRlcnNlY3Rpb24uZmFjZS5tYXRlcmlhbEluZGV4ID0gZ3JvdXAubWF0ZXJpYWxJbmRleDsKICAgICAgICAgICAgICAgIGludGVyc2VjdHMyLnB1c2goaW50ZXJzZWN0aW9uKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3Qgc3RhcnQgPSBNYXRoLm1heCgwLCBkcmF3UmFuZ2Uuc3RhcnQpOwogICAgICAgICAgY29uc3QgZW5kID0gTWF0aC5taW4oaW5kZXguY291bnQsIGRyYXdSYW5nZS5zdGFydCArIGRyYXdSYW5nZS5jb3VudCk7CiAgICAgICAgICBmb3IgKGxldCBpID0gc3RhcnQsIGlsID0gZW5kOyBpIDwgaWw7IGkgKz0gMykgewogICAgICAgICAgICBjb25zdCBhID0gaW5kZXguZ2V0WChpKTsKICAgICAgICAgICAgY29uc3QgYiA9IGluZGV4LmdldFgoaSArIDEpOwogICAgICAgICAgICBjb25zdCBjID0gaW5kZXguZ2V0WChpICsgMik7CiAgICAgICAgICAgIGludGVyc2VjdGlvbiA9IGNoZWNrQnVmZmVyR2VvbWV0cnlJbnRlcnNlY3Rpb24odGhpcywgbWF0ZXJpYWwsIHJheWNhc3RlciwgX3JheSQyLCBwb3NpdGlvbiwgbW9ycGhQb3NpdGlvbiwgbW9ycGhUYXJnZXRzUmVsYXRpdmUsIHV2LCB1djIsIGEsIGIsIGMpOwogICAgICAgICAgICBpZiAoaW50ZXJzZWN0aW9uKSB7CiAgICAgICAgICAgICAgaW50ZXJzZWN0aW9uLmZhY2VJbmRleCA9IE1hdGguZmxvb3IoaSAvIDMpOwogICAgICAgICAgICAgIGludGVyc2VjdHMyLnB1c2goaW50ZXJzZWN0aW9uKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiAhPT0gdm9pZCAwKSB7CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobWF0ZXJpYWwpKSB7CiAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBncm91cHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICAgICAgICBjb25zdCBncm91cCA9IGdyb3Vwc1tpXTsKICAgICAgICAgICAgY29uc3QgZ3JvdXBNYXRlcmlhbCA9IG1hdGVyaWFsW2dyb3VwLm1hdGVyaWFsSW5kZXhdOwogICAgICAgICAgICBjb25zdCBzdGFydCA9IE1hdGgubWF4KGdyb3VwLnN0YXJ0LCBkcmF3UmFuZ2Uuc3RhcnQpOwogICAgICAgICAgICBjb25zdCBlbmQgPSBNYXRoLm1pbihwb3NpdGlvbi5jb3VudCwgTWF0aC5taW4oZ3JvdXAuc3RhcnQgKyBncm91cC5jb3VudCwgZHJhd1JhbmdlLnN0YXJ0ICsgZHJhd1JhbmdlLmNvdW50KSk7CiAgICAgICAgICAgIGZvciAobGV0IGogPSBzdGFydCwgamwgPSBlbmQ7IGogPCBqbDsgaiArPSAzKSB7CiAgICAgICAgICAgICAgY29uc3QgYSA9IGo7CiAgICAgICAgICAgICAgY29uc3QgYiA9IGogKyAxOwogICAgICAgICAgICAgIGNvbnN0IGMgPSBqICsgMjsKICAgICAgICAgICAgICBpbnRlcnNlY3Rpb24gPSBjaGVja0J1ZmZlckdlb21ldHJ5SW50ZXJzZWN0aW9uKHRoaXMsIGdyb3VwTWF0ZXJpYWwsIHJheWNhc3RlciwgX3JheSQyLCBwb3NpdGlvbiwgbW9ycGhQb3NpdGlvbiwgbW9ycGhUYXJnZXRzUmVsYXRpdmUsIHV2LCB1djIsIGEsIGIsIGMpOwogICAgICAgICAgICAgIGlmIChpbnRlcnNlY3Rpb24pIHsKICAgICAgICAgICAgICAgIGludGVyc2VjdGlvbi5mYWNlSW5kZXggPSBNYXRoLmZsb29yKGogLyAzKTsKICAgICAgICAgICAgICAgIGludGVyc2VjdGlvbi5mYWNlLm1hdGVyaWFsSW5kZXggPSBncm91cC5tYXRlcmlhbEluZGV4OwogICAgICAgICAgICAgICAgaW50ZXJzZWN0czIucHVzaChpbnRlcnNlY3Rpb24pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zdCBzdGFydCA9IE1hdGgubWF4KDAsIGRyYXdSYW5nZS5zdGFydCk7CiAgICAgICAgICBjb25zdCBlbmQgPSBNYXRoLm1pbihwb3NpdGlvbi5jb3VudCwgZHJhd1JhbmdlLnN0YXJ0ICsgZHJhd1JhbmdlLmNvdW50KTsKICAgICAgICAgIGZvciAobGV0IGkgPSBzdGFydCwgaWwgPSBlbmQ7IGkgPCBpbDsgaSArPSAzKSB7CiAgICAgICAgICAgIGNvbnN0IGEgPSBpOwogICAgICAgICAgICBjb25zdCBiID0gaSArIDE7CiAgICAgICAgICAgIGNvbnN0IGMgPSBpICsgMjsKICAgICAgICAgICAgaW50ZXJzZWN0aW9uID0gY2hlY2tCdWZmZXJHZW9tZXRyeUludGVyc2VjdGlvbih0aGlzLCBtYXRlcmlhbCwgcmF5Y2FzdGVyLCBfcmF5JDIsIHBvc2l0aW9uLCBtb3JwaFBvc2l0aW9uLCBtb3JwaFRhcmdldHNSZWxhdGl2ZSwgdXYsIHV2MiwgYSwgYiwgYyk7CiAgICAgICAgICAgIGlmIChpbnRlcnNlY3Rpb24pIHsKICAgICAgICAgICAgICBpbnRlcnNlY3Rpb24uZmFjZUluZGV4ID0gTWF0aC5mbG9vcihpIC8gMyk7CiAgICAgICAgICAgICAgaW50ZXJzZWN0czIucHVzaChpbnRlcnNlY3Rpb24pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKGdlb21ldHJ5LmlzR2VvbWV0cnkpIHsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuTWVzaC5yYXljYXN0KCkgbm8gbG9uZ2VyIHN1cHBvcnRzIFRIUkVFLkdlb21ldHJ5LiBVc2UgVEhSRUUuQnVmZmVyR2VvbWV0cnkgaW5zdGVhZC4iKTsKICAgIH0KICB9Cn0KTWVzaC5wcm90b3R5cGUuaXNNZXNoID0gdHJ1ZTsKZnVuY3Rpb24gY2hlY2tJbnRlcnNlY3Rpb24ob2JqZWN0LCBtYXRlcmlhbCwgcmF5Y2FzdGVyLCByYXksIHBBLCBwQiwgcEMsIHBvaW50KSB7CiAgbGV0IGludGVyc2VjdDsKICBpZiAobWF0ZXJpYWwuc2lkZSA9PT0gQmFja1NpZGUpIHsKICAgIGludGVyc2VjdCA9IHJheS5pbnRlcnNlY3RUcmlhbmdsZShwQywgcEIsIHBBLCB0cnVlLCBwb2ludCk7CiAgfSBlbHNlIHsKICAgIGludGVyc2VjdCA9IHJheS5pbnRlcnNlY3RUcmlhbmdsZShwQSwgcEIsIHBDLCBtYXRlcmlhbC5zaWRlICE9PSBEb3VibGVTaWRlLCBwb2ludCk7CiAgfQogIGlmIChpbnRlcnNlY3QgPT09IG51bGwpCiAgICByZXR1cm4gbnVsbDsKICBfaW50ZXJzZWN0aW9uUG9pbnRXb3JsZC5jb3B5KHBvaW50KTsKICBfaW50ZXJzZWN0aW9uUG9pbnRXb3JsZC5hcHBseU1hdHJpeDQob2JqZWN0Lm1hdHJpeFdvcmxkKTsKICBjb25zdCBkaXN0YW5jZSA9IHJheWNhc3Rlci5yYXkub3JpZ2luLmRpc3RhbmNlVG8oX2ludGVyc2VjdGlvblBvaW50V29ybGQpOwogIGlmIChkaXN0YW5jZSA8IHJheWNhc3Rlci5uZWFyIHx8IGRpc3RhbmNlID4gcmF5Y2FzdGVyLmZhcikKICAgIHJldHVybiBudWxsOwogIHJldHVybiB7CiAgICBkaXN0YW5jZSwKICAgIHBvaW50OiBfaW50ZXJzZWN0aW9uUG9pbnRXb3JsZC5jbG9uZSgpLAogICAgb2JqZWN0CiAgfTsKfQpmdW5jdGlvbiBjaGVja0J1ZmZlckdlb21ldHJ5SW50ZXJzZWN0aW9uKG9iamVjdCwgbWF0ZXJpYWwsIHJheWNhc3RlciwgcmF5LCBwb3NpdGlvbiwgbW9ycGhQb3NpdGlvbiwgbW9ycGhUYXJnZXRzUmVsYXRpdmUsIHV2LCB1djIsIGEsIGIsIGMpIHsKICBfdkEkMS5mcm9tQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9uLCBhKTsKICBfdkIkMS5mcm9tQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9uLCBiKTsKICBfdkMkMS5mcm9tQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9uLCBjKTsKICBjb25zdCBtb3JwaEluZmx1ZW5jZXMgPSBvYmplY3QubW9ycGhUYXJnZXRJbmZsdWVuY2VzOwogIGlmIChtb3JwaFBvc2l0aW9uICYmIG1vcnBoSW5mbHVlbmNlcykgewogICAgX21vcnBoQS5zZXQoMCwgMCwgMCk7CiAgICBfbW9ycGhCLnNldCgwLCAwLCAwKTsKICAgIF9tb3JwaEMuc2V0KDAsIDAsIDApOwogICAgZm9yIChsZXQgaSA9IDAsIGlsID0gbW9ycGhQb3NpdGlvbi5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgIGNvbnN0IGluZmx1ZW5jZSA9IG1vcnBoSW5mbHVlbmNlc1tpXTsKICAgICAgY29uc3QgbW9ycGhBdHRyaWJ1dGUgPSBtb3JwaFBvc2l0aW9uW2ldOwogICAgICBpZiAoaW5mbHVlbmNlID09PSAwKQogICAgICAgIGNvbnRpbnVlOwogICAgICBfdGVtcEEuZnJvbUJ1ZmZlckF0dHJpYnV0ZShtb3JwaEF0dHJpYnV0ZSwgYSk7CiAgICAgIF90ZW1wQi5mcm9tQnVmZmVyQXR0cmlidXRlKG1vcnBoQXR0cmlidXRlLCBiKTsKICAgICAgX3RlbXBDLmZyb21CdWZmZXJBdHRyaWJ1dGUobW9ycGhBdHRyaWJ1dGUsIGMpOwogICAgICBpZiAobW9ycGhUYXJnZXRzUmVsYXRpdmUpIHsKICAgICAgICBfbW9ycGhBLmFkZFNjYWxlZFZlY3RvcihfdGVtcEEsIGluZmx1ZW5jZSk7CiAgICAgICAgX21vcnBoQi5hZGRTY2FsZWRWZWN0b3IoX3RlbXBCLCBpbmZsdWVuY2UpOwogICAgICAgIF9tb3JwaEMuYWRkU2NhbGVkVmVjdG9yKF90ZW1wQywgaW5mbHVlbmNlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfbW9ycGhBLmFkZFNjYWxlZFZlY3RvcihfdGVtcEEuc3ViKF92QSQxKSwgaW5mbHVlbmNlKTsKICAgICAgICBfbW9ycGhCLmFkZFNjYWxlZFZlY3RvcihfdGVtcEIuc3ViKF92QiQxKSwgaW5mbHVlbmNlKTsKICAgICAgICBfbW9ycGhDLmFkZFNjYWxlZFZlY3RvcihfdGVtcEMuc3ViKF92QyQxKSwgaW5mbHVlbmNlKTsKICAgICAgfQogICAgfQogICAgX3ZBJDEuYWRkKF9tb3JwaEEpOwogICAgX3ZCJDEuYWRkKF9tb3JwaEIpOwogICAgX3ZDJDEuYWRkKF9tb3JwaEMpOwogIH0KICBpZiAob2JqZWN0LmlzU2tpbm5lZE1lc2gpIHsKICAgIG9iamVjdC5ib25lVHJhbnNmb3JtKGEsIF92QSQxKTsKICAgIG9iamVjdC5ib25lVHJhbnNmb3JtKGIsIF92QiQxKTsKICAgIG9iamVjdC5ib25lVHJhbnNmb3JtKGMsIF92QyQxKTsKICB9CiAgY29uc3QgaW50ZXJzZWN0aW9uID0gY2hlY2tJbnRlcnNlY3Rpb24ob2JqZWN0LCBtYXRlcmlhbCwgcmF5Y2FzdGVyLCByYXksIF92QSQxLCBfdkIkMSwgX3ZDJDEsIF9pbnRlcnNlY3Rpb25Qb2ludCk7CiAgaWYgKGludGVyc2VjdGlvbikgewogICAgaWYgKHV2KSB7CiAgICAgIF91dkEkMS5mcm9tQnVmZmVyQXR0cmlidXRlKHV2LCBhKTsKICAgICAgX3V2QiQxLmZyb21CdWZmZXJBdHRyaWJ1dGUodXYsIGIpOwogICAgICBfdXZDJDEuZnJvbUJ1ZmZlckF0dHJpYnV0ZSh1diwgYyk7CiAgICAgIGludGVyc2VjdGlvbi51diA9IFRyaWFuZ2xlLmdldFVWKF9pbnRlcnNlY3Rpb25Qb2ludCwgX3ZBJDEsIF92QiQxLCBfdkMkMSwgX3V2QSQxLCBfdXZCJDEsIF91dkMkMSwgbmV3IFZlY3RvcjIoKSk7CiAgICB9CiAgICBpZiAodXYyKSB7CiAgICAgIF91dkEkMS5mcm9tQnVmZmVyQXR0cmlidXRlKHV2MiwgYSk7CiAgICAgIF91dkIkMS5mcm9tQnVmZmVyQXR0cmlidXRlKHV2MiwgYik7CiAgICAgIF91dkMkMS5mcm9tQnVmZmVyQXR0cmlidXRlKHV2MiwgYyk7CiAgICAgIGludGVyc2VjdGlvbi51djIgPSBUcmlhbmdsZS5nZXRVVihfaW50ZXJzZWN0aW9uUG9pbnQsIF92QSQxLCBfdkIkMSwgX3ZDJDEsIF91dkEkMSwgX3V2QiQxLCBfdXZDJDEsIG5ldyBWZWN0b3IyKCkpOwogICAgfQogICAgY29uc3QgZmFjZSA9IHsKICAgICAgYSwKICAgICAgYiwKICAgICAgYywKICAgICAgbm9ybWFsOiBuZXcgVmVjdG9yMygpLAogICAgICBtYXRlcmlhbEluZGV4OiAwCiAgICB9OwogICAgVHJpYW5nbGUuZ2V0Tm9ybWFsKF92QSQxLCBfdkIkMSwgX3ZDJDEsIGZhY2Uubm9ybWFsKTsKICAgIGludGVyc2VjdGlvbi5mYWNlID0gZmFjZTsKICB9CiAgcmV0dXJuIGludGVyc2VjdGlvbjsKfQpjbGFzcyBCb3hHZW9tZXRyeSBleHRlbmRzIEJ1ZmZlckdlb21ldHJ5IHsKICBjb25zdHJ1Y3Rvcih3aWR0aCA9IDEsIGhlaWdodCA9IDEsIGRlcHRoID0gMSwgd2lkdGhTZWdtZW50cyA9IDEsIGhlaWdodFNlZ21lbnRzID0gMSwgZGVwdGhTZWdtZW50cyA9IDEpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLnR5cGUgPSAiQm94R2VvbWV0cnkiOwogICAgdGhpcy5wYXJhbWV0ZXJzID0gewogICAgICB3aWR0aCwKICAgICAgaGVpZ2h0LAogICAgICBkZXB0aCwKICAgICAgd2lkdGhTZWdtZW50cywKICAgICAgaGVpZ2h0U2VnbWVudHMsCiAgICAgIGRlcHRoU2VnbWVudHMKICAgIH07CiAgICBjb25zdCBzY29wZSA9IHRoaXM7CiAgICB3aWR0aFNlZ21lbnRzID0gTWF0aC5mbG9vcih3aWR0aFNlZ21lbnRzKTsKICAgIGhlaWdodFNlZ21lbnRzID0gTWF0aC5mbG9vcihoZWlnaHRTZWdtZW50cyk7CiAgICBkZXB0aFNlZ21lbnRzID0gTWF0aC5mbG9vcihkZXB0aFNlZ21lbnRzKTsKICAgIGNvbnN0IGluZGljZXMgPSBbXTsKICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICBjb25zdCBub3JtYWxzID0gW107CiAgICBjb25zdCB1dnMgPSBbXTsKICAgIGxldCBudW1iZXJPZlZlcnRpY2VzID0gMDsKICAgIGxldCBncm91cFN0YXJ0ID0gMDsKICAgIGJ1aWxkUGxhbmUoInoiLCAieSIsICJ4IiwgLTEsIC0xLCBkZXB0aCwgaGVpZ2h0LCB3aWR0aCwgZGVwdGhTZWdtZW50cywgaGVpZ2h0U2VnbWVudHMsIDApOwogICAgYnVpbGRQbGFuZSgieiIsICJ5IiwgIngiLCAxLCAtMSwgZGVwdGgsIGhlaWdodCwgLXdpZHRoLCBkZXB0aFNlZ21lbnRzLCBoZWlnaHRTZWdtZW50cywgMSk7CiAgICBidWlsZFBsYW5lKCJ4IiwgInoiLCAieSIsIDEsIDEsIHdpZHRoLCBkZXB0aCwgaGVpZ2h0LCB3aWR0aFNlZ21lbnRzLCBkZXB0aFNlZ21lbnRzLCAyKTsKICAgIGJ1aWxkUGxhbmUoIngiLCAieiIsICJ5IiwgMSwgLTEsIHdpZHRoLCBkZXB0aCwgLWhlaWdodCwgd2lkdGhTZWdtZW50cywgZGVwdGhTZWdtZW50cywgMyk7CiAgICBidWlsZFBsYW5lKCJ4IiwgInkiLCAieiIsIDEsIC0xLCB3aWR0aCwgaGVpZ2h0LCBkZXB0aCwgd2lkdGhTZWdtZW50cywgaGVpZ2h0U2VnbWVudHMsIDQpOwogICAgYnVpbGRQbGFuZSgieCIsICJ5IiwgInoiLCAtMSwgLTEsIHdpZHRoLCBoZWlnaHQsIC1kZXB0aCwgd2lkdGhTZWdtZW50cywgaGVpZ2h0U2VnbWVudHMsIDUpOwogICAgdGhpcy5zZXRJbmRleChpbmRpY2VzKTsKICAgIHRoaXMuc2V0QXR0cmlidXRlKCJwb3NpdGlvbiIsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKHZlcnRpY2VzLCAzKSk7CiAgICB0aGlzLnNldEF0dHJpYnV0ZSgibm9ybWFsIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUobm9ybWFscywgMykpOwogICAgdGhpcy5zZXRBdHRyaWJ1dGUoInV2IiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUodXZzLCAyKSk7CiAgICBmdW5jdGlvbiBidWlsZFBsYW5lKHUsIHYsIHcsIHVkaXIsIHZkaXIsIHdpZHRoMiwgaGVpZ2h0MiwgZGVwdGgyLCBncmlkWCwgZ3JpZFksIG1hdGVyaWFsSW5kZXgpIHsKICAgICAgY29uc3Qgc2VnbWVudFdpZHRoID0gd2lkdGgyIC8gZ3JpZFg7CiAgICAgIGNvbnN0IHNlZ21lbnRIZWlnaHQgPSBoZWlnaHQyIC8gZ3JpZFk7CiAgICAgIGNvbnN0IHdpZHRoSGFsZiA9IHdpZHRoMiAvIDI7CiAgICAgIGNvbnN0IGhlaWdodEhhbGYgPSBoZWlnaHQyIC8gMjsKICAgICAgY29uc3QgZGVwdGhIYWxmID0gZGVwdGgyIC8gMjsKICAgICAgY29uc3QgZ3JpZFgxID0gZ3JpZFggKyAxOwogICAgICBjb25zdCBncmlkWTEgPSBncmlkWSArIDE7CiAgICAgIGxldCB2ZXJ0ZXhDb3VudGVyID0gMDsKICAgICAgbGV0IGdyb3VwQ291bnQgPSAwOwogICAgICBjb25zdCB2ZWN0b3IgPSBuZXcgVmVjdG9yMygpOwogICAgICBmb3IgKGxldCBpeSA9IDA7IGl5IDwgZ3JpZFkxOyBpeSsrKSB7CiAgICAgICAgY29uc3QgeSA9IGl5ICogc2VnbWVudEhlaWdodCAtIGhlaWdodEhhbGY7CiAgICAgICAgZm9yIChsZXQgaXggPSAwOyBpeCA8IGdyaWRYMTsgaXgrKykgewogICAgICAgICAgY29uc3QgeCA9IGl4ICogc2VnbWVudFdpZHRoIC0gd2lkdGhIYWxmOwogICAgICAgICAgdmVjdG9yW3VdID0geCAqIHVkaXI7CiAgICAgICAgICB2ZWN0b3Jbdl0gPSB5ICogdmRpcjsKICAgICAgICAgIHZlY3Rvclt3XSA9IGRlcHRoSGFsZjsKICAgICAgICAgIHZlcnRpY2VzLnB1c2godmVjdG9yLngsIHZlY3Rvci55LCB2ZWN0b3Iueik7CiAgICAgICAgICB2ZWN0b3JbdV0gPSAwOwogICAgICAgICAgdmVjdG9yW3ZdID0gMDsKICAgICAgICAgIHZlY3Rvclt3XSA9IGRlcHRoMiA+IDAgPyAxIDogLTE7CiAgICAgICAgICBub3JtYWxzLnB1c2godmVjdG9yLngsIHZlY3Rvci55LCB2ZWN0b3Iueik7CiAgICAgICAgICB1dnMucHVzaChpeCAvIGdyaWRYKTsKICAgICAgICAgIHV2cy5wdXNoKDEgLSBpeSAvIGdyaWRZKTsKICAgICAgICAgIHZlcnRleENvdW50ZXIgKz0gMTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZm9yIChsZXQgaXkgPSAwOyBpeSA8IGdyaWRZOyBpeSsrKSB7CiAgICAgICAgZm9yIChsZXQgaXggPSAwOyBpeCA8IGdyaWRYOyBpeCsrKSB7CiAgICAgICAgICBjb25zdCBhID0gbnVtYmVyT2ZWZXJ0aWNlcyArIGl4ICsgZ3JpZFgxICogaXk7CiAgICAgICAgICBjb25zdCBiID0gbnVtYmVyT2ZWZXJ0aWNlcyArIGl4ICsgZ3JpZFgxICogKGl5ICsgMSk7CiAgICAgICAgICBjb25zdCBjID0gbnVtYmVyT2ZWZXJ0aWNlcyArIChpeCArIDEpICsgZ3JpZFgxICogKGl5ICsgMSk7CiAgICAgICAgICBjb25zdCBkID0gbnVtYmVyT2ZWZXJ0aWNlcyArIChpeCArIDEpICsgZ3JpZFgxICogaXk7CiAgICAgICAgICBpbmRpY2VzLnB1c2goYSwgYiwgZCk7CiAgICAgICAgICBpbmRpY2VzLnB1c2goYiwgYywgZCk7CiAgICAgICAgICBncm91cENvdW50ICs9IDY7CiAgICAgICAgfQogICAgICB9CiAgICAgIHNjb3BlLmFkZEdyb3VwKGdyb3VwU3RhcnQsIGdyb3VwQ291bnQsIG1hdGVyaWFsSW5kZXgpOwogICAgICBncm91cFN0YXJ0ICs9IGdyb3VwQ291bnQ7CiAgICAgIG51bWJlck9mVmVydGljZXMgKz0gdmVydGV4Q291bnRlcjsKICAgIH0KICB9CiAgc3RhdGljIGZyb21KU09OKGRhdGEpIHsKICAgIHJldHVybiBuZXcgQm94R2VvbWV0cnkoZGF0YS53aWR0aCwgZGF0YS5oZWlnaHQsIGRhdGEuZGVwdGgsIGRhdGEud2lkdGhTZWdtZW50cywgZGF0YS5oZWlnaHRTZWdtZW50cywgZGF0YS5kZXB0aFNlZ21lbnRzKTsKICB9Cn0KZnVuY3Rpb24gY2xvbmVVbmlmb3JtcyhzcmMpIHsKICBjb25zdCBkc3QgPSB7fTsKICBmb3IgKGNvbnN0IHUgaW4gc3JjKSB7CiAgICBkc3RbdV0gPSB7fTsKICAgIGZvciAoY29uc3QgcCBpbiBzcmNbdV0pIHsKICAgICAgY29uc3QgcHJvcGVydHkgPSBzcmNbdV1bcF07CiAgICAgIGlmIChwcm9wZXJ0eSAmJiAocHJvcGVydHkuaXNDb2xvciB8fCBwcm9wZXJ0eS5pc01hdHJpeDMgfHwgcHJvcGVydHkuaXNNYXRyaXg0IHx8IHByb3BlcnR5LmlzVmVjdG9yMiB8fCBwcm9wZXJ0eS5pc1ZlY3RvcjMgfHwgcHJvcGVydHkuaXNWZWN0b3I0IHx8IHByb3BlcnR5LmlzVGV4dHVyZSB8fCBwcm9wZXJ0eS5pc1F1YXRlcm5pb24pKSB7CiAgICAgICAgZHN0W3VdW3BdID0gcHJvcGVydHkuY2xvbmUoKTsKICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHByb3BlcnR5KSkgewogICAgICAgIGRzdFt1XVtwXSA9IHByb3BlcnR5LnNsaWNlKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZHN0W3VdW3BdID0gcHJvcGVydHk7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIGRzdDsKfQpmdW5jdGlvbiBtZXJnZVVuaWZvcm1zKHVuaWZvcm1zKSB7CiAgY29uc3QgbWVyZ2VkID0ge307CiAgZm9yIChsZXQgdSA9IDA7IHUgPCB1bmlmb3Jtcy5sZW5ndGg7IHUrKykgewogICAgY29uc3QgdG1wMiA9IGNsb25lVW5pZm9ybXModW5pZm9ybXNbdV0pOwogICAgZm9yIChjb25zdCBwIGluIHRtcDIpIHsKICAgICAgbWVyZ2VkW3BdID0gdG1wMltwXTsKICAgIH0KICB9CiAgcmV0dXJuIG1lcmdlZDsKfQpjb25zdCBVbmlmb3Jtc1V0aWxzID0geyBjbG9uZTogY2xvbmVVbmlmb3JtcywgbWVyZ2U6IG1lcmdlVW5pZm9ybXMgfTsKdmFyIGRlZmF1bHRfdmVydGV4ID0gInZvaWQgbWFpbigpIHtcbglnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICk7XG59IjsKdmFyIGRlZmF1bHRfZnJhZ21lbnQgPSAidm9pZCBtYWluKCkge1xuCWdsX0ZyYWdDb2xvciA9IHZlYzQoIDEuMCwgMC4wLCAwLjAsIDEuMCApO1xufSI7CmNsYXNzIFNoYWRlck1hdGVyaWFsIGV4dGVuZHMgTWF0ZXJpYWwgewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLnR5cGUgPSAiU2hhZGVyTWF0ZXJpYWwiOwogICAgdGhpcy5kZWZpbmVzID0ge307CiAgICB0aGlzLnVuaWZvcm1zID0ge307CiAgICB0aGlzLnZlcnRleFNoYWRlciA9IGRlZmF1bHRfdmVydGV4OwogICAgdGhpcy5mcmFnbWVudFNoYWRlciA9IGRlZmF1bHRfZnJhZ21lbnQ7CiAgICB0aGlzLmxpbmV3aWR0aCA9IDE7CiAgICB0aGlzLndpcmVmcmFtZSA9IGZhbHNlOwogICAgdGhpcy53aXJlZnJhbWVMaW5ld2lkdGggPSAxOwogICAgdGhpcy5mb2cgPSBmYWxzZTsKICAgIHRoaXMubGlnaHRzID0gZmFsc2U7CiAgICB0aGlzLmNsaXBwaW5nID0gZmFsc2U7CiAgICB0aGlzLmV4dGVuc2lvbnMgPSB7CiAgICAgIGRlcml2YXRpdmVzOiBmYWxzZSwKICAgICAgZnJhZ0RlcHRoOiBmYWxzZSwKICAgICAgZHJhd0J1ZmZlcnM6IGZhbHNlLAogICAgICBzaGFkZXJUZXh0dXJlTE9EOiBmYWxzZQogICAgfTsKICAgIHRoaXMuZGVmYXVsdEF0dHJpYnV0ZVZhbHVlcyA9IHsKICAgICAgImNvbG9yIjogWzEsIDEsIDFdLAogICAgICAidXYiOiBbMCwgMF0sCiAgICAgICJ1djIiOiBbMCwgMF0KICAgIH07CiAgICB0aGlzLmluZGV4MEF0dHJpYnV0ZU5hbWUgPSB2b2lkIDA7CiAgICB0aGlzLnVuaWZvcm1zTmVlZFVwZGF0ZSA9IGZhbHNlOwogICAgdGhpcy5nbHNsVmVyc2lvbiA9IG51bGw7CiAgICBpZiAocGFyYW1ldGVycyAhPT0gdm9pZCAwKSB7CiAgICAgIGlmIChwYXJhbWV0ZXJzLmF0dHJpYnV0ZXMgIT09IHZvaWQgMCkgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLlNoYWRlck1hdGVyaWFsOiBhdHRyaWJ1dGVzIHNob3VsZCBub3cgYmUgZGVmaW5lZCBpbiBUSFJFRS5CdWZmZXJHZW9tZXRyeSBpbnN0ZWFkLiIpOwogICAgICB9CiAgICAgIHRoaXMuc2V0VmFsdWVzKHBhcmFtZXRlcnMpOwogICAgfQogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy5mcmFnbWVudFNoYWRlciA9IHNvdXJjZS5mcmFnbWVudFNoYWRlcjsKICAgIHRoaXMudmVydGV4U2hhZGVyID0gc291cmNlLnZlcnRleFNoYWRlcjsKICAgIHRoaXMudW5pZm9ybXMgPSBjbG9uZVVuaWZvcm1zKHNvdXJjZS51bmlmb3Jtcyk7CiAgICB0aGlzLmRlZmluZXMgPSBPYmplY3QuYXNzaWduKHt9LCBzb3VyY2UuZGVmaW5lcyk7CiAgICB0aGlzLndpcmVmcmFtZSA9IHNvdXJjZS53aXJlZnJhbWU7CiAgICB0aGlzLndpcmVmcmFtZUxpbmV3aWR0aCA9IHNvdXJjZS53aXJlZnJhbWVMaW5ld2lkdGg7CiAgICB0aGlzLmxpZ2h0cyA9IHNvdXJjZS5saWdodHM7CiAgICB0aGlzLmNsaXBwaW5nID0gc291cmNlLmNsaXBwaW5nOwogICAgdGhpcy5leHRlbnNpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgc291cmNlLmV4dGVuc2lvbnMpOwogICAgdGhpcy5nbHNsVmVyc2lvbiA9IHNvdXJjZS5nbHNsVmVyc2lvbjsKICAgIHJldHVybiB0aGlzOwogIH0KICB0b0pTT04obWV0YSkgewogICAgY29uc3QgZGF0YSA9IHN1cGVyLnRvSlNPTihtZXRhKTsKICAgIGRhdGEuZ2xzbFZlcnNpb24gPSB0aGlzLmdsc2xWZXJzaW9uOwogICAgZGF0YS51bmlmb3JtcyA9IHt9OwogICAgZm9yIChjb25zdCBuYW1lIGluIHRoaXMudW5pZm9ybXMpIHsKICAgICAgY29uc3QgdW5pZm9ybSA9IHRoaXMudW5pZm9ybXNbbmFtZV07CiAgICAgIGNvbnN0IHZhbHVlID0gdW5pZm9ybS52YWx1ZTsKICAgICAgaWYgKHZhbHVlICYmIHZhbHVlLmlzVGV4dHVyZSkgewogICAgICAgIGRhdGEudW5pZm9ybXNbbmFtZV0gPSB7CiAgICAgICAgICB0eXBlOiAidCIsCiAgICAgICAgICB2YWx1ZTogdmFsdWUudG9KU09OKG1ldGEpLnV1aWQKICAgICAgICB9OwogICAgICB9IGVsc2UgaWYgKHZhbHVlICYmIHZhbHVlLmlzQ29sb3IpIHsKICAgICAgICBkYXRhLnVuaWZvcm1zW25hbWVdID0gewogICAgICAgICAgdHlwZTogImMiLAogICAgICAgICAgdmFsdWU6IHZhbHVlLmdldEhleCgpCiAgICAgICAgfTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSAmJiB2YWx1ZS5pc1ZlY3RvcjIpIHsKICAgICAgICBkYXRhLnVuaWZvcm1zW25hbWVdID0gewogICAgICAgICAgdHlwZTogInYyIiwKICAgICAgICAgIHZhbHVlOiB2YWx1ZS50b0FycmF5KCkKICAgICAgICB9OwogICAgICB9IGVsc2UgaWYgKHZhbHVlICYmIHZhbHVlLmlzVmVjdG9yMykgewogICAgICAgIGRhdGEudW5pZm9ybXNbbmFtZV0gPSB7CiAgICAgICAgICB0eXBlOiAidjMiLAogICAgICAgICAgdmFsdWU6IHZhbHVlLnRvQXJyYXkoKQogICAgICAgIH07CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgJiYgdmFsdWUuaXNWZWN0b3I0KSB7CiAgICAgICAgZGF0YS51bmlmb3Jtc1tuYW1lXSA9IHsKICAgICAgICAgIHR5cGU6ICJ2NCIsCiAgICAgICAgICB2YWx1ZTogdmFsdWUudG9BcnJheSgpCiAgICAgICAgfTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSAmJiB2YWx1ZS5pc01hdHJpeDMpIHsKICAgICAgICBkYXRhLnVuaWZvcm1zW25hbWVdID0gewogICAgICAgICAgdHlwZTogIm0zIiwKICAgICAgICAgIHZhbHVlOiB2YWx1ZS50b0FycmF5KCkKICAgICAgICB9OwogICAgICB9IGVsc2UgaWYgKHZhbHVlICYmIHZhbHVlLmlzTWF0cml4NCkgewogICAgICAgIGRhdGEudW5pZm9ybXNbbmFtZV0gPSB7CiAgICAgICAgICB0eXBlOiAibTQiLAogICAgICAgICAgdmFsdWU6IHZhbHVlLnRvQXJyYXkoKQogICAgICAgIH07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGF0YS51bmlmb3Jtc1tuYW1lXSA9IHsKICAgICAgICAgIHZhbHVlCiAgICAgICAgfTsKICAgICAgfQogICAgfQogICAgaWYgKE9iamVjdC5rZXlzKHRoaXMuZGVmaW5lcykubGVuZ3RoID4gMCkKICAgICAgZGF0YS5kZWZpbmVzID0gdGhpcy5kZWZpbmVzOwogICAgZGF0YS52ZXJ0ZXhTaGFkZXIgPSB0aGlzLnZlcnRleFNoYWRlcjsKICAgIGRhdGEuZnJhZ21lbnRTaGFkZXIgPSB0aGlzLmZyYWdtZW50U2hhZGVyOwogICAgY29uc3QgZXh0ZW5zaW9ucyA9IHt9OwogICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5leHRlbnNpb25zKSB7CiAgICAgIGlmICh0aGlzLmV4dGVuc2lvbnNba2V5XSA9PT0gdHJ1ZSkKICAgICAgICBleHRlbnNpb25zW2tleV0gPSB0cnVlOwogICAgfQogICAgaWYgKE9iamVjdC5rZXlzKGV4dGVuc2lvbnMpLmxlbmd0aCA+IDApCiAgICAgIGRhdGEuZXh0ZW5zaW9ucyA9IGV4dGVuc2lvbnM7CiAgICByZXR1cm4gZGF0YTsKICB9Cn0KU2hhZGVyTWF0ZXJpYWwucHJvdG90eXBlLmlzU2hhZGVyTWF0ZXJpYWwgPSB0cnVlOwpjbGFzcyBDYW1lcmEgZXh0ZW5kcyBPYmplY3QzRCB7CiAgY29uc3RydWN0b3IoKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkNhbWVyYSI7CiAgICB0aGlzLm1hdHJpeFdvcmxkSW52ZXJzZSA9IG5ldyBNYXRyaXg0KCk7CiAgICB0aGlzLnByb2plY3Rpb25NYXRyaXggPSBuZXcgTWF0cml4NCgpOwogICAgdGhpcy5wcm9qZWN0aW9uTWF0cml4SW52ZXJzZSA9IG5ldyBNYXRyaXg0KCk7CiAgfQogIGNvcHkoc291cmNlLCByZWN1cnNpdmUpIHsKICAgIHN1cGVyLmNvcHkoc291cmNlLCByZWN1cnNpdmUpOwogICAgdGhpcy5tYXRyaXhXb3JsZEludmVyc2UuY29weShzb3VyY2UubWF0cml4V29ybGRJbnZlcnNlKTsKICAgIHRoaXMucHJvamVjdGlvbk1hdHJpeC5jb3B5KHNvdXJjZS5wcm9qZWN0aW9uTWF0cml4KTsKICAgIHRoaXMucHJvamVjdGlvbk1hdHJpeEludmVyc2UuY29weShzb3VyY2UucHJvamVjdGlvbk1hdHJpeEludmVyc2UpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGdldFdvcmxkRGlyZWN0aW9uKHRhcmdldCkgewogICAgdGhpcy51cGRhdGVXb3JsZE1hdHJpeCh0cnVlLCBmYWxzZSk7CiAgICBjb25zdCBlID0gdGhpcy5tYXRyaXhXb3JsZC5lbGVtZW50czsKICAgIHJldHVybiB0YXJnZXQuc2V0KC1lWzhdLCAtZVs5XSwgLWVbMTBdKS5ub3JtYWxpemUoKTsKICB9CiAgdXBkYXRlTWF0cml4V29ybGQoZm9yY2UpIHsKICAgIHN1cGVyLnVwZGF0ZU1hdHJpeFdvcmxkKGZvcmNlKTsKICAgIHRoaXMubWF0cml4V29ybGRJbnZlcnNlLmNvcHkodGhpcy5tYXRyaXhXb3JsZCkuaW52ZXJ0KCk7CiAgfQogIHVwZGF0ZVdvcmxkTWF0cml4KHVwZGF0ZVBhcmVudHMsIHVwZGF0ZUNoaWxkcmVuKSB7CiAgICBzdXBlci51cGRhdGVXb3JsZE1hdHJpeCh1cGRhdGVQYXJlbnRzLCB1cGRhdGVDaGlsZHJlbik7CiAgICB0aGlzLm1hdHJpeFdvcmxkSW52ZXJzZS5jb3B5KHRoaXMubWF0cml4V29ybGQpLmludmVydCgpOwogIH0KICBjbG9uZSgpIHsKICAgIHJldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3RvcigpLmNvcHkodGhpcyk7CiAgfQp9CkNhbWVyYS5wcm90b3R5cGUuaXNDYW1lcmEgPSB0cnVlOwpjbGFzcyBQZXJzcGVjdGl2ZUNhbWVyYSBleHRlbmRzIENhbWVyYSB7CiAgY29uc3RydWN0b3IoZm92MiA9IDUwLCBhc3BlY3QyID0gMSwgbmVhciA9IDAuMSwgZmFyID0gMmUzKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIlBlcnNwZWN0aXZlQ2FtZXJhIjsKICAgIHRoaXMuZm92ID0gZm92MjsKICAgIHRoaXMuem9vbSA9IDE7CiAgICB0aGlzLm5lYXIgPSBuZWFyOwogICAgdGhpcy5mYXIgPSBmYXI7CiAgICB0aGlzLmZvY3VzID0gMTA7CiAgICB0aGlzLmFzcGVjdCA9IGFzcGVjdDI7CiAgICB0aGlzLnZpZXcgPSBudWxsOwogICAgdGhpcy5maWxtR2F1Z2UgPSAzNTsKICAgIHRoaXMuZmlsbU9mZnNldCA9IDA7CiAgICB0aGlzLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICB9CiAgY29weShzb3VyY2UsIHJlY3Vyc2l2ZSkgewogICAgc3VwZXIuY29weShzb3VyY2UsIHJlY3Vyc2l2ZSk7CiAgICB0aGlzLmZvdiA9IHNvdXJjZS5mb3Y7CiAgICB0aGlzLnpvb20gPSBzb3VyY2Uuem9vbTsKICAgIHRoaXMubmVhciA9IHNvdXJjZS5uZWFyOwogICAgdGhpcy5mYXIgPSBzb3VyY2UuZmFyOwogICAgdGhpcy5mb2N1cyA9IHNvdXJjZS5mb2N1czsKICAgIHRoaXMuYXNwZWN0ID0gc291cmNlLmFzcGVjdDsKICAgIHRoaXMudmlldyA9IHNvdXJjZS52aWV3ID09PSBudWxsID8gbnVsbCA6IE9iamVjdC5hc3NpZ24oe30sIHNvdXJjZS52aWV3KTsKICAgIHRoaXMuZmlsbUdhdWdlID0gc291cmNlLmZpbG1HYXVnZTsKICAgIHRoaXMuZmlsbU9mZnNldCA9IHNvdXJjZS5maWxtT2Zmc2V0OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldEZvY2FsTGVuZ3RoKGZvY2FsTGVuZ3RoKSB7CiAgICBjb25zdCB2RXh0ZW50U2xvcGUgPSAwLjUgKiB0aGlzLmdldEZpbG1IZWlnaHQoKSAvIGZvY2FsTGVuZ3RoOwogICAgdGhpcy5mb3YgPSBSQUQyREVHICogMiAqIE1hdGguYXRhbih2RXh0ZW50U2xvcGUpOwogICAgdGhpcy51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7CiAgfQogIGdldEZvY2FsTGVuZ3RoKCkgewogICAgY29uc3QgdkV4dGVudFNsb3BlID0gTWF0aC50YW4oREVHMlJBRCAqIDAuNSAqIHRoaXMuZm92KTsKICAgIHJldHVybiAwLjUgKiB0aGlzLmdldEZpbG1IZWlnaHQoKSAvIHZFeHRlbnRTbG9wZTsKICB9CiAgZ2V0RWZmZWN0aXZlRk9WKCkgewogICAgcmV0dXJuIFJBRDJERUcgKiAyICogTWF0aC5hdGFuKE1hdGgudGFuKERFRzJSQUQgKiAwLjUgKiB0aGlzLmZvdikgLyB0aGlzLnpvb20pOwogIH0KICBnZXRGaWxtV2lkdGgoKSB7CiAgICByZXR1cm4gdGhpcy5maWxtR2F1Z2UgKiBNYXRoLm1pbih0aGlzLmFzcGVjdCwgMSk7CiAgfQogIGdldEZpbG1IZWlnaHQoKSB7CiAgICByZXR1cm4gdGhpcy5maWxtR2F1Z2UgLyBNYXRoLm1heCh0aGlzLmFzcGVjdCwgMSk7CiAgfQogIHNldFZpZXdPZmZzZXQoZnVsbFdpZHRoLCBmdWxsSGVpZ2h0LCB4LCB5LCB3aWR0aCwgaGVpZ2h0KSB7CiAgICB0aGlzLmFzcGVjdCA9IGZ1bGxXaWR0aCAvIGZ1bGxIZWlnaHQ7CiAgICBpZiAodGhpcy52aWV3ID09PSBudWxsKSB7CiAgICAgIHRoaXMudmlldyA9IHsKICAgICAgICBlbmFibGVkOiB0cnVlLAogICAgICAgIGZ1bGxXaWR0aDogMSwKICAgICAgICBmdWxsSGVpZ2h0OiAxLAogICAgICAgIG9mZnNldFg6IDAsCiAgICAgICAgb2Zmc2V0WTogMCwKICAgICAgICB3aWR0aDogMSwKICAgICAgICBoZWlnaHQ6IDEKICAgICAgfTsKICAgIH0KICAgIHRoaXMudmlldy5lbmFibGVkID0gdHJ1ZTsKICAgIHRoaXMudmlldy5mdWxsV2lkdGggPSBmdWxsV2lkdGg7CiAgICB0aGlzLnZpZXcuZnVsbEhlaWdodCA9IGZ1bGxIZWlnaHQ7CiAgICB0aGlzLnZpZXcub2Zmc2V0WCA9IHg7CiAgICB0aGlzLnZpZXcub2Zmc2V0WSA9IHk7CiAgICB0aGlzLnZpZXcud2lkdGggPSB3aWR0aDsKICAgIHRoaXMudmlldy5oZWlnaHQgPSBoZWlnaHQ7CiAgICB0aGlzLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICB9CiAgY2xlYXJWaWV3T2Zmc2V0KCkgewogICAgaWYgKHRoaXMudmlldyAhPT0gbnVsbCkgewogICAgICB0aGlzLnZpZXcuZW5hYmxlZCA9IGZhbHNlOwogICAgfQogICAgdGhpcy51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7CiAgfQogIHVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKSB7CiAgICBjb25zdCBuZWFyID0gdGhpcy5uZWFyOwogICAgbGV0IHRvcCA9IG5lYXIgKiBNYXRoLnRhbihERUcyUkFEICogMC41ICogdGhpcy5mb3YpIC8gdGhpcy56b29tOwogICAgbGV0IGhlaWdodCA9IDIgKiB0b3A7CiAgICBsZXQgd2lkdGggPSB0aGlzLmFzcGVjdCAqIGhlaWdodDsKICAgIGxldCBsZWZ0ID0gLTAuNSAqIHdpZHRoOwogICAgY29uc3QgdmlldyA9IHRoaXMudmlldzsKICAgIGlmICh0aGlzLnZpZXcgIT09IG51bGwgJiYgdGhpcy52aWV3LmVuYWJsZWQpIHsKICAgICAgY29uc3QgZnVsbFdpZHRoID0gdmlldy5mdWxsV2lkdGgsIGZ1bGxIZWlnaHQgPSB2aWV3LmZ1bGxIZWlnaHQ7CiAgICAgIGxlZnQgKz0gdmlldy5vZmZzZXRYICogd2lkdGggLyBmdWxsV2lkdGg7CiAgICAgIHRvcCAtPSB2aWV3Lm9mZnNldFkgKiBoZWlnaHQgLyBmdWxsSGVpZ2h0OwogICAgICB3aWR0aCAqPSB2aWV3LndpZHRoIC8gZnVsbFdpZHRoOwogICAgICBoZWlnaHQgKj0gdmlldy5oZWlnaHQgLyBmdWxsSGVpZ2h0OwogICAgfQogICAgY29uc3Qgc2tldyA9IHRoaXMuZmlsbU9mZnNldDsKICAgIGlmIChza2V3ICE9PSAwKQogICAgICBsZWZ0ICs9IG5lYXIgKiBza2V3IC8gdGhpcy5nZXRGaWxtV2lkdGgoKTsKICAgIHRoaXMucHJvamVjdGlvbk1hdHJpeC5tYWtlUGVyc3BlY3RpdmUobGVmdCwgbGVmdCArIHdpZHRoLCB0b3AsIHRvcCAtIGhlaWdodCwgbmVhciwgdGhpcy5mYXIpOwogICAgdGhpcy5wcm9qZWN0aW9uTWF0cml4SW52ZXJzZS5jb3B5KHRoaXMucHJvamVjdGlvbk1hdHJpeCkuaW52ZXJ0KCk7CiAgfQogIHRvSlNPTihtZXRhKSB7CiAgICBjb25zdCBkYXRhID0gc3VwZXIudG9KU09OKG1ldGEpOwogICAgZGF0YS5vYmplY3QuZm92ID0gdGhpcy5mb3Y7CiAgICBkYXRhLm9iamVjdC56b29tID0gdGhpcy56b29tOwogICAgZGF0YS5vYmplY3QubmVhciA9IHRoaXMubmVhcjsKICAgIGRhdGEub2JqZWN0LmZhciA9IHRoaXMuZmFyOwogICAgZGF0YS5vYmplY3QuZm9jdXMgPSB0aGlzLmZvY3VzOwogICAgZGF0YS5vYmplY3QuYXNwZWN0ID0gdGhpcy5hc3BlY3Q7CiAgICBpZiAodGhpcy52aWV3ICE9PSBudWxsKQogICAgICBkYXRhLm9iamVjdC52aWV3ID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy52aWV3KTsKICAgIGRhdGEub2JqZWN0LmZpbG1HYXVnZSA9IHRoaXMuZmlsbUdhdWdlOwogICAgZGF0YS5vYmplY3QuZmlsbU9mZnNldCA9IHRoaXMuZmlsbU9mZnNldDsKICAgIHJldHVybiBkYXRhOwogIH0KfQpQZXJzcGVjdGl2ZUNhbWVyYS5wcm90b3R5cGUuaXNQZXJzcGVjdGl2ZUNhbWVyYSA9IHRydWU7CmNvbnN0IGZvdiA9IDkwLCBhc3BlY3QgPSAxOwpjbGFzcyBDdWJlQ2FtZXJhIGV4dGVuZHMgT2JqZWN0M0QgewogIGNvbnN0cnVjdG9yKG5lYXIsIGZhciwgcmVuZGVyVGFyZ2V0KSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkN1YmVDYW1lcmEiOwogICAgaWYgKHJlbmRlclRhcmdldC5pc1dlYkdMQ3ViZVJlbmRlclRhcmdldCAhPT0gdHJ1ZSkgewogICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5DdWJlQ2FtZXJhOiBUaGUgY29uc3RydWN0b3Igbm93IGV4cGVjdHMgYW4gaW5zdGFuY2Ugb2YgV2ViR0xDdWJlUmVuZGVyVGFyZ2V0IGFzIHRoaXJkIHBhcmFtZXRlci4iKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgdGhpcy5yZW5kZXJUYXJnZXQgPSByZW5kZXJUYXJnZXQ7CiAgICBjb25zdCBjYW1lcmFQWCA9IG5ldyBQZXJzcGVjdGl2ZUNhbWVyYShmb3YsIGFzcGVjdCwgbmVhciwgZmFyKTsKICAgIGNhbWVyYVBYLmxheWVycyA9IHRoaXMubGF5ZXJzOwogICAgY2FtZXJhUFgudXAuc2V0KDAsIC0xLCAwKTsKICAgIGNhbWVyYVBYLmxvb2tBdChuZXcgVmVjdG9yMygxLCAwLCAwKSk7CiAgICB0aGlzLmFkZChjYW1lcmFQWCk7CiAgICBjb25zdCBjYW1lcmFOWCA9IG5ldyBQZXJzcGVjdGl2ZUNhbWVyYShmb3YsIGFzcGVjdCwgbmVhciwgZmFyKTsKICAgIGNhbWVyYU5YLmxheWVycyA9IHRoaXMubGF5ZXJzOwogICAgY2FtZXJhTlgudXAuc2V0KDAsIC0xLCAwKTsKICAgIGNhbWVyYU5YLmxvb2tBdChuZXcgVmVjdG9yMygtMSwgMCwgMCkpOwogICAgdGhpcy5hZGQoY2FtZXJhTlgpOwogICAgY29uc3QgY2FtZXJhUFkgPSBuZXcgUGVyc3BlY3RpdmVDYW1lcmEoZm92LCBhc3BlY3QsIG5lYXIsIGZhcik7CiAgICBjYW1lcmFQWS5sYXllcnMgPSB0aGlzLmxheWVyczsKICAgIGNhbWVyYVBZLnVwLnNldCgwLCAwLCAxKTsKICAgIGNhbWVyYVBZLmxvb2tBdChuZXcgVmVjdG9yMygwLCAxLCAwKSk7CiAgICB0aGlzLmFkZChjYW1lcmFQWSk7CiAgICBjb25zdCBjYW1lcmFOWSA9IG5ldyBQZXJzcGVjdGl2ZUNhbWVyYShmb3YsIGFzcGVjdCwgbmVhciwgZmFyKTsKICAgIGNhbWVyYU5ZLmxheWVycyA9IHRoaXMubGF5ZXJzOwogICAgY2FtZXJhTlkudXAuc2V0KDAsIDAsIC0xKTsKICAgIGNhbWVyYU5ZLmxvb2tBdChuZXcgVmVjdG9yMygwLCAtMSwgMCkpOwogICAgdGhpcy5hZGQoY2FtZXJhTlkpOwogICAgY29uc3QgY2FtZXJhUFogPSBuZXcgUGVyc3BlY3RpdmVDYW1lcmEoZm92LCBhc3BlY3QsIG5lYXIsIGZhcik7CiAgICBjYW1lcmFQWi5sYXllcnMgPSB0aGlzLmxheWVyczsKICAgIGNhbWVyYVBaLnVwLnNldCgwLCAtMSwgMCk7CiAgICBjYW1lcmFQWi5sb29rQXQobmV3IFZlY3RvcjMoMCwgMCwgMSkpOwogICAgdGhpcy5hZGQoY2FtZXJhUFopOwogICAgY29uc3QgY2FtZXJhTlogPSBuZXcgUGVyc3BlY3RpdmVDYW1lcmEoZm92LCBhc3BlY3QsIG5lYXIsIGZhcik7CiAgICBjYW1lcmFOWi5sYXllcnMgPSB0aGlzLmxheWVyczsKICAgIGNhbWVyYU5aLnVwLnNldCgwLCAtMSwgMCk7CiAgICBjYW1lcmFOWi5sb29rQXQobmV3IFZlY3RvcjMoMCwgMCwgLTEpKTsKICAgIHRoaXMuYWRkKGNhbWVyYU5aKTsKICB9CiAgdXBkYXRlKHJlbmRlcmVyLCBzY2VuZSkgewogICAgaWYgKHRoaXMucGFyZW50ID09PSBudWxsKQogICAgICB0aGlzLnVwZGF0ZU1hdHJpeFdvcmxkKCk7CiAgICBjb25zdCByZW5kZXJUYXJnZXQgPSB0aGlzLnJlbmRlclRhcmdldDsKICAgIGNvbnN0IFtjYW1lcmFQWCwgY2FtZXJhTlgsIGNhbWVyYVBZLCBjYW1lcmFOWSwgY2FtZXJhUFosIGNhbWVyYU5aXSA9IHRoaXMuY2hpbGRyZW47CiAgICBjb25zdCBjdXJyZW50WHJFbmFibGVkID0gcmVuZGVyZXIueHIuZW5hYmxlZDsKICAgIGNvbnN0IGN1cnJlbnRSZW5kZXJUYXJnZXQgPSByZW5kZXJlci5nZXRSZW5kZXJUYXJnZXQoKTsKICAgIHJlbmRlcmVyLnhyLmVuYWJsZWQgPSBmYWxzZTsKICAgIGNvbnN0IGdlbmVyYXRlTWlwbWFwcyA9IHJlbmRlclRhcmdldC50ZXh0dXJlLmdlbmVyYXRlTWlwbWFwczsKICAgIHJlbmRlclRhcmdldC50ZXh0dXJlLmdlbmVyYXRlTWlwbWFwcyA9IGZhbHNlOwogICAgcmVuZGVyZXIuc2V0UmVuZGVyVGFyZ2V0KHJlbmRlclRhcmdldCwgMCk7CiAgICByZW5kZXJlci5yZW5kZXIoc2NlbmUsIGNhbWVyYVBYKTsKICAgIHJlbmRlcmVyLnNldFJlbmRlclRhcmdldChyZW5kZXJUYXJnZXQsIDEpOwogICAgcmVuZGVyZXIucmVuZGVyKHNjZW5lLCBjYW1lcmFOWCk7CiAgICByZW5kZXJlci5zZXRSZW5kZXJUYXJnZXQocmVuZGVyVGFyZ2V0LCAyKTsKICAgIHJlbmRlcmVyLnJlbmRlcihzY2VuZSwgY2FtZXJhUFkpOwogICAgcmVuZGVyZXIuc2V0UmVuZGVyVGFyZ2V0KHJlbmRlclRhcmdldCwgMyk7CiAgICByZW5kZXJlci5yZW5kZXIoc2NlbmUsIGNhbWVyYU5ZKTsKICAgIHJlbmRlcmVyLnNldFJlbmRlclRhcmdldChyZW5kZXJUYXJnZXQsIDQpOwogICAgcmVuZGVyZXIucmVuZGVyKHNjZW5lLCBjYW1lcmFQWik7CiAgICByZW5kZXJUYXJnZXQudGV4dHVyZS5nZW5lcmF0ZU1pcG1hcHMgPSBnZW5lcmF0ZU1pcG1hcHM7CiAgICByZW5kZXJlci5zZXRSZW5kZXJUYXJnZXQocmVuZGVyVGFyZ2V0LCA1KTsKICAgIHJlbmRlcmVyLnJlbmRlcihzY2VuZSwgY2FtZXJhTlopOwogICAgcmVuZGVyZXIuc2V0UmVuZGVyVGFyZ2V0KGN1cnJlbnRSZW5kZXJUYXJnZXQpOwogICAgcmVuZGVyZXIueHIuZW5hYmxlZCA9IGN1cnJlbnRYckVuYWJsZWQ7CiAgICByZW5kZXJUYXJnZXQudGV4dHVyZS5uZWVkc1BNUkVNVXBkYXRlID0gdHJ1ZTsKICB9Cn0KY2xhc3MgQ3ViZVRleHR1cmUgZXh0ZW5kcyBUZXh0dXJlIHsKICBjb25zdHJ1Y3RvcihpbWFnZXMsIG1hcHBpbmcsIHdyYXBTLCB3cmFwVCwgbWFnRmlsdGVyLCBtaW5GaWx0ZXIsIGZvcm1hdCwgdHlwZSwgYW5pc290cm9weSwgZW5jb2RpbmcpIHsKICAgIGltYWdlcyA9IGltYWdlcyAhPT0gdm9pZCAwID8gaW1hZ2VzIDogW107CiAgICBtYXBwaW5nID0gbWFwcGluZyAhPT0gdm9pZCAwID8gbWFwcGluZyA6IEN1YmVSZWZsZWN0aW9uTWFwcGluZzsKICAgIHN1cGVyKGltYWdlcywgbWFwcGluZywgd3JhcFMsIHdyYXBULCBtYWdGaWx0ZXIsIG1pbkZpbHRlciwgZm9ybWF0LCB0eXBlLCBhbmlzb3Ryb3B5LCBlbmNvZGluZyk7CiAgICB0aGlzLmZsaXBZID0gZmFsc2U7CiAgfQogIGdldCBpbWFnZXMoKSB7CiAgICByZXR1cm4gdGhpcy5pbWFnZTsKICB9CiAgc2V0IGltYWdlcyh2YWx1ZSkgewogICAgdGhpcy5pbWFnZSA9IHZhbHVlOwogIH0KfQpDdWJlVGV4dHVyZS5wcm90b3R5cGUuaXNDdWJlVGV4dHVyZSA9IHRydWU7CmNsYXNzIFdlYkdMQ3ViZVJlbmRlclRhcmdldCBleHRlbmRzIFdlYkdMUmVuZGVyVGFyZ2V0IHsKICBjb25zdHJ1Y3RvcihzaXplLCBvcHRpb25zLCBkdW1teSkgewogICAgaWYgKE51bWJlci5pc0ludGVnZXIob3B0aW9ucykpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTEN1YmVSZW5kZXJUYXJnZXQ6IGNvbnN0cnVjdG9yIHNpZ25hdHVyZSBpcyBub3cgV2ViR0xDdWJlUmVuZGVyVGFyZ2V0KCBzaXplLCBvcHRpb25zICkiKTsKICAgICAgb3B0aW9ucyA9IGR1bW15OwogICAgfQogICAgc3VwZXIoc2l6ZSwgc2l6ZSwgb3B0aW9ucyk7CiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgIHRoaXMudGV4dHVyZSA9IG5ldyBDdWJlVGV4dHVyZSh2b2lkIDAsIG9wdGlvbnMubWFwcGluZywgb3B0aW9ucy53cmFwUywgb3B0aW9ucy53cmFwVCwgb3B0aW9ucy5tYWdGaWx0ZXIsIG9wdGlvbnMubWluRmlsdGVyLCBvcHRpb25zLmZvcm1hdCwgb3B0aW9ucy50eXBlLCBvcHRpb25zLmFuaXNvdHJvcHksIG9wdGlvbnMuZW5jb2RpbmcpOwogICAgdGhpcy50ZXh0dXJlLmlzUmVuZGVyVGFyZ2V0VGV4dHVyZSA9IHRydWU7CiAgICB0aGlzLnRleHR1cmUuZ2VuZXJhdGVNaXBtYXBzID0gb3B0aW9ucy5nZW5lcmF0ZU1pcG1hcHMgIT09IHZvaWQgMCA/IG9wdGlvbnMuZ2VuZXJhdGVNaXBtYXBzIDogZmFsc2U7CiAgICB0aGlzLnRleHR1cmUubWluRmlsdGVyID0gb3B0aW9ucy5taW5GaWx0ZXIgIT09IHZvaWQgMCA/IG9wdGlvbnMubWluRmlsdGVyIDogTGluZWFyRmlsdGVyOwogIH0KICBmcm9tRXF1aXJlY3Rhbmd1bGFyVGV4dHVyZShyZW5kZXJlciwgdGV4dHVyZSkgewogICAgdGhpcy50ZXh0dXJlLnR5cGUgPSB0ZXh0dXJlLnR5cGU7CiAgICB0aGlzLnRleHR1cmUuZm9ybWF0ID0gUkdCQUZvcm1hdDsKICAgIHRoaXMudGV4dHVyZS5lbmNvZGluZyA9IHRleHR1cmUuZW5jb2Rpbmc7CiAgICB0aGlzLnRleHR1cmUuZ2VuZXJhdGVNaXBtYXBzID0gdGV4dHVyZS5nZW5lcmF0ZU1pcG1hcHM7CiAgICB0aGlzLnRleHR1cmUubWluRmlsdGVyID0gdGV4dHVyZS5taW5GaWx0ZXI7CiAgICB0aGlzLnRleHR1cmUubWFnRmlsdGVyID0gdGV4dHVyZS5tYWdGaWx0ZXI7CiAgICBjb25zdCBzaGFkZXIgPSB7CiAgICAgIHVuaWZvcm1zOiB7CiAgICAgICAgdEVxdWlyZWN0OiB7IHZhbHVlOiBudWxsIH0KICAgICAgfSwKICAgICAgdmVydGV4U2hhZGVyOiBgCgoJCQkJdmFyeWluZyB2ZWMzIHZXb3JsZERpcmVjdGlvbjsKCgkJCQl2ZWMzIHRyYW5zZm9ybURpcmVjdGlvbiggaW4gdmVjMyBkaXIsIGluIG1hdDQgbWF0cml4ICkgewoKCQkJCQlyZXR1cm4gbm9ybWFsaXplKCAoIG1hdHJpeCAqIHZlYzQoIGRpciwgMC4wICkgKS54eXogKTsKCgkJCQl9CgoJCQkJdm9pZCBtYWluKCkgewoKCQkJCQl2V29ybGREaXJlY3Rpb24gPSB0cmFuc2Zvcm1EaXJlY3Rpb24oIHBvc2l0aW9uLCBtb2RlbE1hdHJpeCApOwoKCQkJCQkjaW5jbHVkZSA8YmVnaW5fdmVydGV4PgoJCQkJCSNpbmNsdWRlIDxwcm9qZWN0X3ZlcnRleD4KCgkJCQl9CgkJCWAsCiAgICAgIGZyYWdtZW50U2hhZGVyOiBgCgoJCQkJdW5pZm9ybSBzYW1wbGVyMkQgdEVxdWlyZWN0OwoKCQkJCXZhcnlpbmcgdmVjMyB2V29ybGREaXJlY3Rpb247CgoJCQkJI2luY2x1ZGUgPGNvbW1vbj4KCgkJCQl2b2lkIG1haW4oKSB7CgoJCQkJCXZlYzMgZGlyZWN0aW9uID0gbm9ybWFsaXplKCB2V29ybGREaXJlY3Rpb24gKTsKCgkJCQkJdmVjMiBzYW1wbGVVViA9IGVxdWlyZWN0VXYoIGRpcmVjdGlvbiApOwoKCQkJCQlnbF9GcmFnQ29sb3IgPSB0ZXh0dXJlMkQoIHRFcXVpcmVjdCwgc2FtcGxlVVYgKTsKCgkJCQl9CgkJCWAKICAgIH07CiAgICBjb25zdCBnZW9tZXRyeSA9IG5ldyBCb3hHZW9tZXRyeSg1LCA1LCA1KTsKICAgIGNvbnN0IG1hdGVyaWFsID0gbmV3IFNoYWRlck1hdGVyaWFsKHsKICAgICAgbmFtZTogIkN1YmVtYXBGcm9tRXF1aXJlY3QiLAogICAgICB1bmlmb3JtczogY2xvbmVVbmlmb3JtcyhzaGFkZXIudW5pZm9ybXMpLAogICAgICB2ZXJ0ZXhTaGFkZXI6IHNoYWRlci52ZXJ0ZXhTaGFkZXIsCiAgICAgIGZyYWdtZW50U2hhZGVyOiBzaGFkZXIuZnJhZ21lbnRTaGFkZXIsCiAgICAgIHNpZGU6IEJhY2tTaWRlLAogICAgICBibGVuZGluZzogTm9CbGVuZGluZwogICAgfSk7CiAgICBtYXRlcmlhbC51bmlmb3Jtcy50RXF1aXJlY3QudmFsdWUgPSB0ZXh0dXJlOwogICAgY29uc3QgbWVzaCA9IG5ldyBNZXNoKGdlb21ldHJ5LCBtYXRlcmlhbCk7CiAgICBjb25zdCBjdXJyZW50TWluRmlsdGVyID0gdGV4dHVyZS5taW5GaWx0ZXI7CiAgICBpZiAodGV4dHVyZS5taW5GaWx0ZXIgPT09IExpbmVhck1pcG1hcExpbmVhckZpbHRlcikKICAgICAgdGV4dHVyZS5taW5GaWx0ZXIgPSBMaW5lYXJGaWx0ZXI7CiAgICBjb25zdCBjYW1lcmEgPSBuZXcgQ3ViZUNhbWVyYSgxLCAxMCwgdGhpcyk7CiAgICBjYW1lcmEudXBkYXRlKHJlbmRlcmVyLCBtZXNoKTsKICAgIHRleHR1cmUubWluRmlsdGVyID0gY3VycmVudE1pbkZpbHRlcjsKICAgIG1lc2guZ2VvbWV0cnkuZGlzcG9zZSgpOwogICAgbWVzaC5tYXRlcmlhbC5kaXNwb3NlKCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xlYXIocmVuZGVyZXIsIGNvbG9yLCBkZXB0aCwgc3RlbmNpbCkgewogICAgY29uc3QgY3VycmVudFJlbmRlclRhcmdldCA9IHJlbmRlcmVyLmdldFJlbmRlclRhcmdldCgpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCA2OyBpKyspIHsKICAgICAgcmVuZGVyZXIuc2V0UmVuZGVyVGFyZ2V0KHRoaXMsIGkpOwogICAgICByZW5kZXJlci5jbGVhcihjb2xvciwgZGVwdGgsIHN0ZW5jaWwpOwogICAgfQogICAgcmVuZGVyZXIuc2V0UmVuZGVyVGFyZ2V0KGN1cnJlbnRSZW5kZXJUYXJnZXQpOwogIH0KfQpXZWJHTEN1YmVSZW5kZXJUYXJnZXQucHJvdG90eXBlLmlzV2ViR0xDdWJlUmVuZGVyVGFyZ2V0ID0gdHJ1ZTsKY29uc3QgX3ZlY3RvcjEgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3ZlY3RvcjIgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX25vcm1hbE1hdHJpeCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWF0cml4MygpOwpjbGFzcyBQbGFuZSB7CiAgY29uc3RydWN0b3Iobm9ybWFsID0gbmV3IFZlY3RvcjMoMSwgMCwgMCksIGNvbnN0YW50ID0gMCkgewogICAgdGhpcy5ub3JtYWwgPSBub3JtYWw7CiAgICB0aGlzLmNvbnN0YW50ID0gY29uc3RhbnQ7CiAgfQogIHNldChub3JtYWwsIGNvbnN0YW50KSB7CiAgICB0aGlzLm5vcm1hbC5jb3B5KG5vcm1hbCk7CiAgICB0aGlzLmNvbnN0YW50ID0gY29uc3RhbnQ7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0Q29tcG9uZW50cyh4LCB5LCB6LCB3KSB7CiAgICB0aGlzLm5vcm1hbC5zZXQoeCwgeSwgeik7CiAgICB0aGlzLmNvbnN0YW50ID0gdzsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRGcm9tTm9ybWFsQW5kQ29wbGFuYXJQb2ludChub3JtYWwsIHBvaW50KSB7CiAgICB0aGlzLm5vcm1hbC5jb3B5KG5vcm1hbCk7CiAgICB0aGlzLmNvbnN0YW50ID0gLXBvaW50LmRvdCh0aGlzLm5vcm1hbCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0RnJvbUNvcGxhbmFyUG9pbnRzKGEsIGIsIGMpIHsKICAgIGNvbnN0IG5vcm1hbCA9IF92ZWN0b3IxLnN1YlZlY3RvcnMoYywgYikuY3Jvc3MoX3ZlY3RvcjIuc3ViVmVjdG9ycyhhLCBiKSkubm9ybWFsaXplKCk7CiAgICB0aGlzLnNldEZyb21Ob3JtYWxBbmRDb3BsYW5hclBvaW50KG5vcm1hbCwgYSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY29weShwbGFuZSkgewogICAgdGhpcy5ub3JtYWwuY29weShwbGFuZS5ub3JtYWwpOwogICAgdGhpcy5jb25zdGFudCA9IHBsYW5lLmNvbnN0YW50OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIG5vcm1hbGl6ZSgpIHsKICAgIGNvbnN0IGludmVyc2VOb3JtYWxMZW5ndGggPSAxIC8gdGhpcy5ub3JtYWwubGVuZ3RoKCk7CiAgICB0aGlzLm5vcm1hbC5tdWx0aXBseVNjYWxhcihpbnZlcnNlTm9ybWFsTGVuZ3RoKTsKICAgIHRoaXMuY29uc3RhbnQgKj0gaW52ZXJzZU5vcm1hbExlbmd0aDsKICAgIHJldHVybiB0aGlzOwogIH0KICBuZWdhdGUoKSB7CiAgICB0aGlzLmNvbnN0YW50ICo9IC0xOwogICAgdGhpcy5ub3JtYWwubmVnYXRlKCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZGlzdGFuY2VUb1BvaW50KHBvaW50KSB7CiAgICByZXR1cm4gdGhpcy5ub3JtYWwuZG90KHBvaW50KSArIHRoaXMuY29uc3RhbnQ7CiAgfQogIGRpc3RhbmNlVG9TcGhlcmUoc3BoZXJlKSB7CiAgICByZXR1cm4gdGhpcy5kaXN0YW5jZVRvUG9pbnQoc3BoZXJlLmNlbnRlcikgLSBzcGhlcmUucmFkaXVzOwogIH0KICBwcm9qZWN0UG9pbnQocG9pbnQsIHRhcmdldCkgewogICAgcmV0dXJuIHRhcmdldC5jb3B5KHRoaXMubm9ybWFsKS5tdWx0aXBseVNjYWxhcigtdGhpcy5kaXN0YW5jZVRvUG9pbnQocG9pbnQpKS5hZGQocG9pbnQpOwogIH0KICBpbnRlcnNlY3RMaW5lKGxpbmUsIHRhcmdldCkgewogICAgY29uc3QgZGlyZWN0aW9uID0gbGluZS5kZWx0YShfdmVjdG9yMSk7CiAgICBjb25zdCBkZW5vbWluYXRvciA9IHRoaXMubm9ybWFsLmRvdChkaXJlY3Rpb24pOwogICAgaWYgKGRlbm9taW5hdG9yID09PSAwKSB7CiAgICAgIGlmICh0aGlzLmRpc3RhbmNlVG9Qb2ludChsaW5lLnN0YXJ0KSA9PT0gMCkgewogICAgICAgIHJldHVybiB0YXJnZXQuY29weShsaW5lLnN0YXJ0KTsKICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIGNvbnN0IHQgPSAtKGxpbmUuc3RhcnQuZG90KHRoaXMubm9ybWFsKSArIHRoaXMuY29uc3RhbnQpIC8gZGVub21pbmF0b3I7CiAgICBpZiAodCA8IDAgfHwgdCA+IDEpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICByZXR1cm4gdGFyZ2V0LmNvcHkoZGlyZWN0aW9uKS5tdWx0aXBseVNjYWxhcih0KS5hZGQobGluZS5zdGFydCk7CiAgfQogIGludGVyc2VjdHNMaW5lKGxpbmUpIHsKICAgIGNvbnN0IHN0YXJ0U2lnbiA9IHRoaXMuZGlzdGFuY2VUb1BvaW50KGxpbmUuc3RhcnQpOwogICAgY29uc3QgZW5kU2lnbiA9IHRoaXMuZGlzdGFuY2VUb1BvaW50KGxpbmUuZW5kKTsKICAgIHJldHVybiBzdGFydFNpZ24gPCAwICYmIGVuZFNpZ24gPiAwIHx8IGVuZFNpZ24gPCAwICYmIHN0YXJ0U2lnbiA+IDA7CiAgfQogIGludGVyc2VjdHNCb3goYm94KSB7CiAgICByZXR1cm4gYm94LmludGVyc2VjdHNQbGFuZSh0aGlzKTsKICB9CiAgaW50ZXJzZWN0c1NwaGVyZShzcGhlcmUpIHsKICAgIHJldHVybiBzcGhlcmUuaW50ZXJzZWN0c1BsYW5lKHRoaXMpOwogIH0KICBjb3BsYW5hclBvaW50KHRhcmdldCkgewogICAgcmV0dXJuIHRhcmdldC5jb3B5KHRoaXMubm9ybWFsKS5tdWx0aXBseVNjYWxhcigtdGhpcy5jb25zdGFudCk7CiAgfQogIGFwcGx5TWF0cml4NChtYXRyaXgsIG9wdGlvbmFsTm9ybWFsTWF0cml4KSB7CiAgICBjb25zdCBub3JtYWxNYXRyaXggPSBvcHRpb25hbE5vcm1hbE1hdHJpeCB8fCBfbm9ybWFsTWF0cml4LmdldE5vcm1hbE1hdHJpeChtYXRyaXgpOwogICAgY29uc3QgcmVmZXJlbmNlUG9pbnQgPSB0aGlzLmNvcGxhbmFyUG9pbnQoX3ZlY3RvcjEpLmFwcGx5TWF0cml4NChtYXRyaXgpOwogICAgY29uc3Qgbm9ybWFsID0gdGhpcy5ub3JtYWwuYXBwbHlNYXRyaXgzKG5vcm1hbE1hdHJpeCkubm9ybWFsaXplKCk7CiAgICB0aGlzLmNvbnN0YW50ID0gLXJlZmVyZW5jZVBvaW50LmRvdChub3JtYWwpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRyYW5zbGF0ZShvZmZzZXQpIHsKICAgIHRoaXMuY29uc3RhbnQgLT0gb2Zmc2V0LmRvdCh0aGlzLm5vcm1hbCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZXF1YWxzKHBsYW5lKSB7CiAgICByZXR1cm4gcGxhbmUubm9ybWFsLmVxdWFscyh0aGlzLm5vcm1hbCkgJiYgcGxhbmUuY29uc3RhbnQgPT09IHRoaXMuY29uc3RhbnQ7CiAgfQogIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKCkuY29weSh0aGlzKTsKICB9Cn0KUGxhbmUucHJvdG90eXBlLmlzUGxhbmUgPSB0cnVlOwpjb25zdCBfc3BoZXJlJDIgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNwaGVyZSgpOwpjb25zdCBfdmVjdG9yJDcgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY2xhc3MgRnJ1c3R1bSB7CiAgY29uc3RydWN0b3IocDAgPSBuZXcgUGxhbmUoKSwgcDEgPSBuZXcgUGxhbmUoKSwgcDIgPSBuZXcgUGxhbmUoKSwgcDMgPSBuZXcgUGxhbmUoKSwgcDQgPSBuZXcgUGxhbmUoKSwgcDUgPSBuZXcgUGxhbmUoKSkgewogICAgdGhpcy5wbGFuZXMgPSBbcDAsIHAxLCBwMiwgcDMsIHA0LCBwNV07CiAgfQogIHNldChwMCwgcDEsIHAyLCBwMywgcDQsIHA1KSB7CiAgICBjb25zdCBwbGFuZXMgPSB0aGlzLnBsYW5lczsKICAgIHBsYW5lc1swXS5jb3B5KHAwKTsKICAgIHBsYW5lc1sxXS5jb3B5KHAxKTsKICAgIHBsYW5lc1syXS5jb3B5KHAyKTsKICAgIHBsYW5lc1szXS5jb3B5KHAzKTsKICAgIHBsYW5lc1s0XS5jb3B5KHA0KTsKICAgIHBsYW5lc1s1XS5jb3B5KHA1KTsKICAgIHJldHVybiB0aGlzOwogIH0KICBjb3B5KGZydXN0dW0pIHsKICAgIGNvbnN0IHBsYW5lcyA9IHRoaXMucGxhbmVzOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCA2OyBpKyspIHsKICAgICAgcGxhbmVzW2ldLmNvcHkoZnJ1c3R1bS5wbGFuZXNbaV0pOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldEZyb21Qcm9qZWN0aW9uTWF0cml4KG0pIHsKICAgIGNvbnN0IHBsYW5lcyA9IHRoaXMucGxhbmVzOwogICAgY29uc3QgbWUgPSBtLmVsZW1lbnRzOwogICAgY29uc3QgbWUwID0gbWVbMF0sIG1lMSA9IG1lWzFdLCBtZTIgPSBtZVsyXSwgbWUzID0gbWVbM107CiAgICBjb25zdCBtZTQgPSBtZVs0XSwgbWU1ID0gbWVbNV0sIG1lNiA9IG1lWzZdLCBtZTcgPSBtZVs3XTsKICAgIGNvbnN0IG1lOCA9IG1lWzhdLCBtZTkgPSBtZVs5XSwgbWUxMCA9IG1lWzEwXSwgbWUxMSA9IG1lWzExXTsKICAgIGNvbnN0IG1lMTIgPSBtZVsxMl0sIG1lMTMgPSBtZVsxM10sIG1lMTQgPSBtZVsxNF0sIG1lMTUgPSBtZVsxNV07CiAgICBwbGFuZXNbMF0uc2V0Q29tcG9uZW50cyhtZTMgLSBtZTAsIG1lNyAtIG1lNCwgbWUxMSAtIG1lOCwgbWUxNSAtIG1lMTIpLm5vcm1hbGl6ZSgpOwogICAgcGxhbmVzWzFdLnNldENvbXBvbmVudHMobWUzICsgbWUwLCBtZTcgKyBtZTQsIG1lMTEgKyBtZTgsIG1lMTUgKyBtZTEyKS5ub3JtYWxpemUoKTsKICAgIHBsYW5lc1syXS5zZXRDb21wb25lbnRzKG1lMyArIG1lMSwgbWU3ICsgbWU1LCBtZTExICsgbWU5LCBtZTE1ICsgbWUxMykubm9ybWFsaXplKCk7CiAgICBwbGFuZXNbM10uc2V0Q29tcG9uZW50cyhtZTMgLSBtZTEsIG1lNyAtIG1lNSwgbWUxMSAtIG1lOSwgbWUxNSAtIG1lMTMpLm5vcm1hbGl6ZSgpOwogICAgcGxhbmVzWzRdLnNldENvbXBvbmVudHMobWUzIC0gbWUyLCBtZTcgLSBtZTYsIG1lMTEgLSBtZTEwLCBtZTE1IC0gbWUxNCkubm9ybWFsaXplKCk7CiAgICBwbGFuZXNbNV0uc2V0Q29tcG9uZW50cyhtZTMgKyBtZTIsIG1lNyArIG1lNiwgbWUxMSArIG1lMTAsIG1lMTUgKyBtZTE0KS5ub3JtYWxpemUoKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBpbnRlcnNlY3RzT2JqZWN0KG9iamVjdCkgewogICAgY29uc3QgZ2VvbWV0cnkgPSBvYmplY3QuZ2VvbWV0cnk7CiAgICBpZiAoZ2VvbWV0cnkuYm91bmRpbmdTcGhlcmUgPT09IG51bGwpCiAgICAgIGdlb21ldHJ5LmNvbXB1dGVCb3VuZGluZ1NwaGVyZSgpOwogICAgX3NwaGVyZSQyLmNvcHkoZ2VvbWV0cnkuYm91bmRpbmdTcGhlcmUpLmFwcGx5TWF0cml4NChvYmplY3QubWF0cml4V29ybGQpOwogICAgcmV0dXJuIHRoaXMuaW50ZXJzZWN0c1NwaGVyZShfc3BoZXJlJDIpOwogIH0KICBpbnRlcnNlY3RzU3ByaXRlKHNwcml0ZSkgewogICAgX3NwaGVyZSQyLmNlbnRlci5zZXQoMCwgMCwgMCk7CiAgICBfc3BoZXJlJDIucmFkaXVzID0gMC43MDcxMDY3ODExODY1NDc2OwogICAgX3NwaGVyZSQyLmFwcGx5TWF0cml4NChzcHJpdGUubWF0cml4V29ybGQpOwogICAgcmV0dXJuIHRoaXMuaW50ZXJzZWN0c1NwaGVyZShfc3BoZXJlJDIpOwogIH0KICBpbnRlcnNlY3RzU3BoZXJlKHNwaGVyZSkgewogICAgY29uc3QgcGxhbmVzID0gdGhpcy5wbGFuZXM7CiAgICBjb25zdCBjZW50ZXIgPSBzcGhlcmUuY2VudGVyOwogICAgY29uc3QgbmVnUmFkaXVzID0gLXNwaGVyZS5yYWRpdXM7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY7IGkrKykgewogICAgICBjb25zdCBkaXN0YW5jZSA9IHBsYW5lc1tpXS5kaXN0YW5jZVRvUG9pbnQoY2VudGVyKTsKICAgICAgaWYgKGRpc3RhbmNlIDwgbmVnUmFkaXVzKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgaW50ZXJzZWN0c0JveChib3gpIHsKICAgIGNvbnN0IHBsYW5lcyA9IHRoaXMucGxhbmVzOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCA2OyBpKyspIHsKICAgICAgY29uc3QgcGxhbmUgPSBwbGFuZXNbaV07CiAgICAgIF92ZWN0b3IkNy54ID0gcGxhbmUubm9ybWFsLnggPiAwID8gYm94Lm1heC54IDogYm94Lm1pbi54OwogICAgICBfdmVjdG9yJDcueSA9IHBsYW5lLm5vcm1hbC55ID4gMCA/IGJveC5tYXgueSA6IGJveC5taW4ueTsKICAgICAgX3ZlY3RvciQ3LnogPSBwbGFuZS5ub3JtYWwueiA+IDAgPyBib3gubWF4LnogOiBib3gubWluLno7CiAgICAgIGlmIChwbGFuZS5kaXN0YW5jZVRvUG9pbnQoX3ZlY3RvciQ3KSA8IDApIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0cnVlOwogIH0KICBjb250YWluc1BvaW50KHBvaW50KSB7CiAgICBjb25zdCBwbGFuZXMgPSB0aGlzLnBsYW5lczsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNjsgaSsrKSB7CiAgICAgIGlmIChwbGFuZXNbaV0uZGlzdGFuY2VUb1BvaW50KHBvaW50KSA8IDApIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0cnVlOwogIH0KICBjbG9uZSgpIHsKICAgIHJldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3RvcigpLmNvcHkodGhpcyk7CiAgfQp9CmZ1bmN0aW9uIFdlYkdMQW5pbWF0aW9uKCkgewogIGxldCBjb250ZXh0ID0gbnVsbDsKICBsZXQgaXNBbmltYXRpbmcgPSBmYWxzZTsKICBsZXQgYW5pbWF0aW9uTG9vcCA9IG51bGw7CiAgbGV0IHJlcXVlc3RJZCA9IG51bGw7CiAgZnVuY3Rpb24gb25BbmltYXRpb25GcmFtZSh0aW1lLCBmcmFtZSkgewogICAgYW5pbWF0aW9uTG9vcCh0aW1lLCBmcmFtZSk7CiAgICByZXF1ZXN0SWQgPSBjb250ZXh0LnJlcXVlc3RBbmltYXRpb25GcmFtZShvbkFuaW1hdGlvbkZyYW1lKTsKICB9CiAgcmV0dXJuIHsKICAgIHN0YXJ0OiBmdW5jdGlvbigpIHsKICAgICAgaWYgKGlzQW5pbWF0aW5nID09PSB0cnVlKQogICAgICAgIHJldHVybjsKICAgICAgaWYgKGFuaW1hdGlvbkxvb3AgPT09IG51bGwpCiAgICAgICAgcmV0dXJuOwogICAgICByZXF1ZXN0SWQgPSBjb250ZXh0LnJlcXVlc3RBbmltYXRpb25GcmFtZShvbkFuaW1hdGlvbkZyYW1lKTsKICAgICAgaXNBbmltYXRpbmcgPSB0cnVlOwogICAgfSwKICAgIHN0b3A6IGZ1bmN0aW9uKCkgewogICAgICBjb250ZXh0LmNhbmNlbEFuaW1hdGlvbkZyYW1lKHJlcXVlc3RJZCk7CiAgICAgIGlzQW5pbWF0aW5nID0gZmFsc2U7CiAgICB9LAogICAgc2V0QW5pbWF0aW9uTG9vcDogZnVuY3Rpb24oY2FsbGJhY2spIHsKICAgICAgYW5pbWF0aW9uTG9vcCA9IGNhbGxiYWNrOwogICAgfSwKICAgIHNldENvbnRleHQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGNvbnRleHQgPSB2YWx1ZTsKICAgIH0KICB9Owp9CmZ1bmN0aW9uIFdlYkdMQXR0cmlidXRlcyhnbCwgY2FwYWJpbGl0aWVzKSB7CiAgY29uc3QgaXNXZWJHTDIgPSBjYXBhYmlsaXRpZXMuaXNXZWJHTDI7CiAgY29uc3QgYnVmZmVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwogIGZ1bmN0aW9uIGNyZWF0ZUJ1ZmZlcihhdHRyaWJ1dGUsIGJ1ZmZlclR5cGUpIHsKICAgIGNvbnN0IGFycmF5ID0gYXR0cmlidXRlLmFycmF5OwogICAgY29uc3QgdXNhZ2UgPSBhdHRyaWJ1dGUudXNhZ2U7CiAgICBjb25zdCBidWZmZXIgPSBnbC5jcmVhdGVCdWZmZXIoKTsKICAgIGdsLmJpbmRCdWZmZXIoYnVmZmVyVHlwZSwgYnVmZmVyKTsKICAgIGdsLmJ1ZmZlckRhdGEoYnVmZmVyVHlwZSwgYXJyYXksIHVzYWdlKTsKICAgIGF0dHJpYnV0ZS5vblVwbG9hZENhbGxiYWNrKCk7CiAgICBsZXQgdHlwZSA9IDUxMjY7CiAgICBpZiAoYXJyYXkgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXkpIHsKICAgICAgdHlwZSA9IDUxMjY7CiAgICB9IGVsc2UgaWYgKGFycmF5IGluc3RhbmNlb2YgRmxvYXQ2NEFycmF5KSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xBdHRyaWJ1dGVzOiBVbnN1cHBvcnRlZCBkYXRhIGJ1ZmZlciBmb3JtYXQ6IEZsb2F0NjRBcnJheS4iKTsKICAgIH0gZWxzZSBpZiAoYXJyYXkgaW5zdGFuY2VvZiBVaW50MTZBcnJheSkgewogICAgICBpZiAoYXR0cmlidXRlLmlzRmxvYXQxNkJ1ZmZlckF0dHJpYnV0ZSkgewogICAgICAgIGlmIChpc1dlYkdMMikgewogICAgICAgICAgdHlwZSA9IDUxMzE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xBdHRyaWJ1dGVzOiBVc2FnZSBvZiBGbG9hdDE2QnVmZmVyQXR0cmlidXRlIHJlcXVpcmVzIFdlYkdMMi4iKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHlwZSA9IDUxMjM7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoYXJyYXkgaW5zdGFuY2VvZiBJbnQxNkFycmF5KSB7CiAgICAgIHR5cGUgPSA1MTIyOwogICAgfSBlbHNlIGlmIChhcnJheSBpbnN0YW5jZW9mIFVpbnQzMkFycmF5KSB7CiAgICAgIHR5cGUgPSA1MTI1OwogICAgfSBlbHNlIGlmIChhcnJheSBpbnN0YW5jZW9mIEludDMyQXJyYXkpIHsKICAgICAgdHlwZSA9IDUxMjQ7CiAgICB9IGVsc2UgaWYgKGFycmF5IGluc3RhbmNlb2YgSW50OEFycmF5KSB7CiAgICAgIHR5cGUgPSA1MTIwOwogICAgfSBlbHNlIGlmIChhcnJheSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHsKICAgICAgdHlwZSA9IDUxMjE7CiAgICB9IGVsc2UgaWYgKGFycmF5IGluc3RhbmNlb2YgVWludDhDbGFtcGVkQXJyYXkpIHsKICAgICAgdHlwZSA9IDUxMjE7CiAgICB9CiAgICByZXR1cm4gewogICAgICBidWZmZXIsCiAgICAgIHR5cGUsCiAgICAgIGJ5dGVzUGVyRWxlbWVudDogYXJyYXkuQllURVNfUEVSX0VMRU1FTlQsCiAgICAgIHZlcnNpb246IGF0dHJpYnV0ZS52ZXJzaW9uCiAgICB9OwogIH0KICBmdW5jdGlvbiB1cGRhdGVCdWZmZXIoYnVmZmVyLCBhdHRyaWJ1dGUsIGJ1ZmZlclR5cGUpIHsKICAgIGNvbnN0IGFycmF5ID0gYXR0cmlidXRlLmFycmF5OwogICAgY29uc3QgdXBkYXRlUmFuZ2UgPSBhdHRyaWJ1dGUudXBkYXRlUmFuZ2U7CiAgICBnbC5iaW5kQnVmZmVyKGJ1ZmZlclR5cGUsIGJ1ZmZlcik7CiAgICBpZiAodXBkYXRlUmFuZ2UuY291bnQgPT09IC0xKSB7CiAgICAgIGdsLmJ1ZmZlclN1YkRhdGEoYnVmZmVyVHlwZSwgMCwgYXJyYXkpOwogICAgfSBlbHNlIHsKICAgICAgaWYgKGlzV2ViR0wyKSB7CiAgICAgICAgZ2wuYnVmZmVyU3ViRGF0YShidWZmZXJUeXBlLCB1cGRhdGVSYW5nZS5vZmZzZXQgKiBhcnJheS5CWVRFU19QRVJfRUxFTUVOVCwgYXJyYXksIHVwZGF0ZVJhbmdlLm9mZnNldCwgdXBkYXRlUmFuZ2UuY291bnQpOwogICAgICB9IGVsc2UgewogICAgICAgIGdsLmJ1ZmZlclN1YkRhdGEoYnVmZmVyVHlwZSwgdXBkYXRlUmFuZ2Uub2Zmc2V0ICogYXJyYXkuQllURVNfUEVSX0VMRU1FTlQsIGFycmF5LnN1YmFycmF5KHVwZGF0ZVJhbmdlLm9mZnNldCwgdXBkYXRlUmFuZ2Uub2Zmc2V0ICsgdXBkYXRlUmFuZ2UuY291bnQpKTsKICAgICAgfQogICAgICB1cGRhdGVSYW5nZS5jb3VudCA9IC0xOwogICAgfQogIH0KICBmdW5jdGlvbiBnZXQoYXR0cmlidXRlKSB7CiAgICBpZiAoYXR0cmlidXRlLmlzSW50ZXJsZWF2ZWRCdWZmZXJBdHRyaWJ1dGUpCiAgICAgIGF0dHJpYnV0ZSA9IGF0dHJpYnV0ZS5kYXRhOwogICAgcmV0dXJuIGJ1ZmZlcnMuZ2V0KGF0dHJpYnV0ZSk7CiAgfQogIGZ1bmN0aW9uIHJlbW92ZShhdHRyaWJ1dGUpIHsKICAgIGlmIChhdHRyaWJ1dGUuaXNJbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZSkKICAgICAgYXR0cmlidXRlID0gYXR0cmlidXRlLmRhdGE7CiAgICBjb25zdCBkYXRhID0gYnVmZmVycy5nZXQoYXR0cmlidXRlKTsKICAgIGlmIChkYXRhKSB7CiAgICAgIGdsLmRlbGV0ZUJ1ZmZlcihkYXRhLmJ1ZmZlcik7CiAgICAgIGJ1ZmZlcnMuZGVsZXRlKGF0dHJpYnV0ZSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHVwZGF0ZShhdHRyaWJ1dGUsIGJ1ZmZlclR5cGUpIHsKICAgIGlmIChhdHRyaWJ1dGUuaXNHTEJ1ZmZlckF0dHJpYnV0ZSkgewogICAgICBjb25zdCBjYWNoZWQgPSBidWZmZXJzLmdldChhdHRyaWJ1dGUpOwogICAgICBpZiAoIWNhY2hlZCB8fCBjYWNoZWQudmVyc2lvbiA8IGF0dHJpYnV0ZS52ZXJzaW9uKSB7CiAgICAgICAgYnVmZmVycy5zZXQoYXR0cmlidXRlLCB7CiAgICAgICAgICBidWZmZXI6IGF0dHJpYnV0ZS5idWZmZXIsCiAgICAgICAgICB0eXBlOiBhdHRyaWJ1dGUudHlwZSwKICAgICAgICAgIGJ5dGVzUGVyRWxlbWVudDogYXR0cmlidXRlLmVsZW1lbnRTaXplLAogICAgICAgICAgdmVyc2lvbjogYXR0cmlidXRlLnZlcnNpb24KICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CiAgICBpZiAoYXR0cmlidXRlLmlzSW50ZXJsZWF2ZWRCdWZmZXJBdHRyaWJ1dGUpCiAgICAgIGF0dHJpYnV0ZSA9IGF0dHJpYnV0ZS5kYXRhOwogICAgY29uc3QgZGF0YSA9IGJ1ZmZlcnMuZ2V0KGF0dHJpYnV0ZSk7CiAgICBpZiAoZGF0YSA9PT0gdm9pZCAwKSB7CiAgICAgIGJ1ZmZlcnMuc2V0KGF0dHJpYnV0ZSwgY3JlYXRlQnVmZmVyKGF0dHJpYnV0ZSwgYnVmZmVyVHlwZSkpOwogICAgfSBlbHNlIGlmIChkYXRhLnZlcnNpb24gPCBhdHRyaWJ1dGUudmVyc2lvbikgewogICAgICB1cGRhdGVCdWZmZXIoZGF0YS5idWZmZXIsIGF0dHJpYnV0ZSwgYnVmZmVyVHlwZSk7CiAgICAgIGRhdGEudmVyc2lvbiA9IGF0dHJpYnV0ZS52ZXJzaW9uOwogICAgfQogIH0KICByZXR1cm4gewogICAgZ2V0LAogICAgcmVtb3ZlLAogICAgdXBkYXRlCiAgfTsKfQpjbGFzcyBQbGFuZUdlb21ldHJ5IGV4dGVuZHMgQnVmZmVyR2VvbWV0cnkgewogIGNvbnN0cnVjdG9yKHdpZHRoID0gMSwgaGVpZ2h0ID0gMSwgd2lkdGhTZWdtZW50cyA9IDEsIGhlaWdodFNlZ21lbnRzID0gMSkgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJQbGFuZUdlb21ldHJ5IjsKICAgIHRoaXMucGFyYW1ldGVycyA9IHsKICAgICAgd2lkdGgsCiAgICAgIGhlaWdodCwKICAgICAgd2lkdGhTZWdtZW50cywKICAgICAgaGVpZ2h0U2VnbWVudHMKICAgIH07CiAgICBjb25zdCB3aWR0aF9oYWxmID0gd2lkdGggLyAyOwogICAgY29uc3QgaGVpZ2h0X2hhbGYgPSBoZWlnaHQgLyAyOwogICAgY29uc3QgZ3JpZFggPSBNYXRoLmZsb29yKHdpZHRoU2VnbWVudHMpOwogICAgY29uc3QgZ3JpZFkgPSBNYXRoLmZsb29yKGhlaWdodFNlZ21lbnRzKTsKICAgIGNvbnN0IGdyaWRYMSA9IGdyaWRYICsgMTsKICAgIGNvbnN0IGdyaWRZMSA9IGdyaWRZICsgMTsKICAgIGNvbnN0IHNlZ21lbnRfd2lkdGggPSB3aWR0aCAvIGdyaWRYOwogICAgY29uc3Qgc2VnbWVudF9oZWlnaHQgPSBoZWlnaHQgLyBncmlkWTsKICAgIGNvbnN0IGluZGljZXMgPSBbXTsKICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICBjb25zdCBub3JtYWxzID0gW107CiAgICBjb25zdCB1dnMgPSBbXTsKICAgIGZvciAobGV0IGl5ID0gMDsgaXkgPCBncmlkWTE7IGl5KyspIHsKICAgICAgY29uc3QgeSA9IGl5ICogc2VnbWVudF9oZWlnaHQgLSBoZWlnaHRfaGFsZjsKICAgICAgZm9yIChsZXQgaXggPSAwOyBpeCA8IGdyaWRYMTsgaXgrKykgewogICAgICAgIGNvbnN0IHggPSBpeCAqIHNlZ21lbnRfd2lkdGggLSB3aWR0aF9oYWxmOwogICAgICAgIHZlcnRpY2VzLnB1c2goeCwgLXksIDApOwogICAgICAgIG5vcm1hbHMucHVzaCgwLCAwLCAxKTsKICAgICAgICB1dnMucHVzaChpeCAvIGdyaWRYKTsKICAgICAgICB1dnMucHVzaCgxIC0gaXkgLyBncmlkWSk7CiAgICAgIH0KICAgIH0KICAgIGZvciAobGV0IGl5ID0gMDsgaXkgPCBncmlkWTsgaXkrKykgewogICAgICBmb3IgKGxldCBpeCA9IDA7IGl4IDwgZ3JpZFg7IGl4KyspIHsKICAgICAgICBjb25zdCBhID0gaXggKyBncmlkWDEgKiBpeTsKICAgICAgICBjb25zdCBiID0gaXggKyBncmlkWDEgKiAoaXkgKyAxKTsKICAgICAgICBjb25zdCBjID0gaXggKyAxICsgZ3JpZFgxICogKGl5ICsgMSk7CiAgICAgICAgY29uc3QgZCA9IGl4ICsgMSArIGdyaWRYMSAqIGl5OwogICAgICAgIGluZGljZXMucHVzaChhLCBiLCBkKTsKICAgICAgICBpbmRpY2VzLnB1c2goYiwgYywgZCk7CiAgICAgIH0KICAgIH0KICAgIHRoaXMuc2V0SW5kZXgoaW5kaWNlcyk7CiAgICB0aGlzLnNldEF0dHJpYnV0ZSgicG9zaXRpb24iLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh2ZXJ0aWNlcywgMykpOwogICAgdGhpcy5zZXRBdHRyaWJ1dGUoIm5vcm1hbCIsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKG5vcm1hbHMsIDMpKTsKICAgIHRoaXMuc2V0QXR0cmlidXRlKCJ1diIsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKHV2cywgMikpOwogIH0KICBzdGF0aWMgZnJvbUpTT04oZGF0YSkgewogICAgcmV0dXJuIG5ldyBQbGFuZUdlb21ldHJ5KGRhdGEud2lkdGgsIGRhdGEuaGVpZ2h0LCBkYXRhLndpZHRoU2VnbWVudHMsIGRhdGEuaGVpZ2h0U2VnbWVudHMpOwogIH0KfQp2YXIgYWxwaGFtYXBfZnJhZ21lbnQgPSAiI2lmZGVmIFVTRV9BTFBIQU1BUFxuCWRpZmZ1c2VDb2xvci5hICo9IHRleHR1cmUyRCggYWxwaGFNYXAsIHZVdiApLmc7XG4jZW5kaWYiOwp2YXIgYWxwaGFtYXBfcGFyc19mcmFnbWVudCA9ICIjaWZkZWYgVVNFX0FMUEhBTUFQXG4JdW5pZm9ybSBzYW1wbGVyMkQgYWxwaGFNYXA7XG4jZW5kaWYiOwp2YXIgYWxwaGF0ZXN0X2ZyYWdtZW50ID0gIiNpZmRlZiBVU0VfQUxQSEFURVNUXG4JaWYgKCBkaWZmdXNlQ29sb3IuYSA8IGFscGhhVGVzdCApIGRpc2NhcmQ7XG4jZW5kaWYiOwp2YXIgYWxwaGF0ZXN0X3BhcnNfZnJhZ21lbnQgPSAiI2lmZGVmIFVTRV9BTFBIQVRFU1Rcbgl1bmlmb3JtIGZsb2F0IGFscGhhVGVzdDtcbiNlbmRpZiI7CnZhciBhb21hcF9mcmFnbWVudCA9ICIjaWZkZWYgVVNFX0FPTUFQXG4JZmxvYXQgYW1iaWVudE9jY2x1c2lvbiA9ICggdGV4dHVyZTJEKCBhb01hcCwgdlV2MiApLnIgLSAxLjAgKSAqIGFvTWFwSW50ZW5zaXR5ICsgMS4wO1xuCXJlZmxlY3RlZExpZ2h0LmluZGlyZWN0RGlmZnVzZSAqPSBhbWJpZW50T2NjbHVzaW9uO1xuCSNpZiBkZWZpbmVkKCBVU0VfRU5WTUFQICkgJiYgZGVmaW5lZCggU1RBTkRBUkQgKVxuCQlmbG9hdCBkb3ROViA9IHNhdHVyYXRlKCBkb3QoIGdlb21ldHJ5Lm5vcm1hbCwgZ2VvbWV0cnkudmlld0RpciApICk7XG4JCXJlZmxlY3RlZExpZ2h0LmluZGlyZWN0U3BlY3VsYXIgKj0gY29tcHV0ZVNwZWN1bGFyT2NjbHVzaW9uKCBkb3ROViwgYW1iaWVudE9jY2x1c2lvbiwgbWF0ZXJpYWwucm91Z2huZXNzICk7XG4JI2VuZGlmXG4jZW5kaWYiOwp2YXIgYW9tYXBfcGFyc19mcmFnbWVudCA9ICIjaWZkZWYgVVNFX0FPTUFQXG4JdW5pZm9ybSBzYW1wbGVyMkQgYW9NYXA7XG4JdW5pZm9ybSBmbG9hdCBhb01hcEludGVuc2l0eTtcbiNlbmRpZiI7CnZhciBiZWdpbl92ZXJ0ZXggPSAidmVjMyB0cmFuc2Zvcm1lZCA9IHZlYzMoIHBvc2l0aW9uICk7IjsKdmFyIGJlZ2lubm9ybWFsX3ZlcnRleCA9ICJ2ZWMzIG9iamVjdE5vcm1hbCA9IHZlYzMoIG5vcm1hbCApO1xuI2lmZGVmIFVTRV9UQU5HRU5UXG4JdmVjMyBvYmplY3RUYW5nZW50ID0gdmVjMyggdGFuZ2VudC54eXogKTtcbiNlbmRpZiI7CnZhciBic2RmcyA9ICJ2ZWMzIEJSREZfTGFtYmVydCggY29uc3QgaW4gdmVjMyBkaWZmdXNlQ29sb3IgKSB7XG4JcmV0dXJuIFJFQ0lQUk9DQUxfUEkgKiBkaWZmdXNlQ29sb3I7XG59XG52ZWMzIEZfU2NobGljayggY29uc3QgaW4gdmVjMyBmMCwgY29uc3QgaW4gZmxvYXQgZjkwLCBjb25zdCBpbiBmbG9hdCBkb3RWSCApIHtcbglmbG9hdCBmcmVzbmVsID0gZXhwMiggKCAtIDUuNTU0NzMgKiBkb3RWSCAtIDYuOTgzMTYgKSAqIGRvdFZIICk7XG4JcmV0dXJuIGYwICogKCAxLjAgLSBmcmVzbmVsICkgKyAoIGY5MCAqIGZyZXNuZWwgKTtcbn1cbmZsb2F0IFZfR0dYX1NtaXRoQ29ycmVsYXRlZCggY29uc3QgaW4gZmxvYXQgYWxwaGEsIGNvbnN0IGluIGZsb2F0IGRvdE5MLCBjb25zdCBpbiBmbG9hdCBkb3ROViApIHtcbglmbG9hdCBhMiA9IHBvdzIoIGFscGhhICk7XG4JZmxvYXQgZ3YgPSBkb3ROTCAqIHNxcnQoIGEyICsgKCAxLjAgLSBhMiApICogcG93MiggZG90TlYgKSApO1xuCWZsb2F0IGdsID0gZG90TlYgKiBzcXJ0KCBhMiArICggMS4wIC0gYTIgKSAqIHBvdzIoIGRvdE5MICkgKTtcbglyZXR1cm4gMC41IC8gbWF4KCBndiArIGdsLCBFUFNJTE9OICk7XG59XG5mbG9hdCBEX0dHWCggY29uc3QgaW4gZmxvYXQgYWxwaGEsIGNvbnN0IGluIGZsb2F0IGRvdE5IICkge1xuCWZsb2F0IGEyID0gcG93MiggYWxwaGEgKTtcbglmbG9hdCBkZW5vbSA9IHBvdzIoIGRvdE5IICkgKiAoIGEyIC0gMS4wICkgKyAxLjA7XG4JcmV0dXJuIFJFQ0lQUk9DQUxfUEkgKiBhMiAvIHBvdzIoIGRlbm9tICk7XG59XG52ZWMzIEJSREZfR0dYKCBjb25zdCBpbiB2ZWMzIGxpZ2h0RGlyLCBjb25zdCBpbiB2ZWMzIHZpZXdEaXIsIGNvbnN0IGluIHZlYzMgbm9ybWFsLCBjb25zdCBpbiB2ZWMzIGYwLCBjb25zdCBpbiBmbG9hdCBmOTAsIGNvbnN0IGluIGZsb2F0IHJvdWdobmVzcyApIHtcbglmbG9hdCBhbHBoYSA9IHBvdzIoIHJvdWdobmVzcyApO1xuCXZlYzMgaGFsZkRpciA9IG5vcm1hbGl6ZSggbGlnaHREaXIgKyB2aWV3RGlyICk7XG4JZmxvYXQgZG90TkwgPSBzYXR1cmF0ZSggZG90KCBub3JtYWwsIGxpZ2h0RGlyICkgKTtcbglmbG9hdCBkb3ROViA9IHNhdHVyYXRlKCBkb3QoIG5vcm1hbCwgdmlld0RpciApICk7XG4JZmxvYXQgZG90TkggPSBzYXR1cmF0ZSggZG90KCBub3JtYWwsIGhhbGZEaXIgKSApO1xuCWZsb2F0IGRvdFZIID0gc2F0dXJhdGUoIGRvdCggdmlld0RpciwgaGFsZkRpciApICk7XG4JdmVjMyBGID0gRl9TY2hsaWNrKCBmMCwgZjkwLCBkb3RWSCApO1xuCWZsb2F0IFYgPSBWX0dHWF9TbWl0aENvcnJlbGF0ZWQoIGFscGhhLCBkb3ROTCwgZG90TlYgKTtcbglmbG9hdCBEID0gRF9HR1goIGFscGhhLCBkb3ROSCApO1xuCXJldHVybiBGICogKCBWICogRCApO1xufVxudmVjMiBMVENfVXYoIGNvbnN0IGluIHZlYzMgTiwgY29uc3QgaW4gdmVjMyBWLCBjb25zdCBpbiBmbG9hdCByb3VnaG5lc3MgKSB7XG4JY29uc3QgZmxvYXQgTFVUX1NJWkUgPSA2NC4wO1xuCWNvbnN0IGZsb2F0IExVVF9TQ0FMRSA9ICggTFVUX1NJWkUgLSAxLjAgKSAvIExVVF9TSVpFO1xuCWNvbnN0IGZsb2F0IExVVF9CSUFTID0gMC41IC8gTFVUX1NJWkU7XG4JZmxvYXQgZG90TlYgPSBzYXR1cmF0ZSggZG90KCBOLCBWICkgKTtcbgl2ZWMyIHV2ID0gdmVjMiggcm91Z2huZXNzLCBzcXJ0KCAxLjAgLSBkb3ROViApICk7XG4JdXYgPSB1diAqIExVVF9TQ0FMRSArIExVVF9CSUFTO1xuCXJldHVybiB1djtcbn1cbmZsb2F0IExUQ19DbGlwcGVkU3BoZXJlRm9ybUZhY3RvciggY29uc3QgaW4gdmVjMyBmICkge1xuCWZsb2F0IGwgPSBsZW5ndGgoIGYgKTtcbglyZXR1cm4gbWF4KCAoIGwgKiBsICsgZi56ICkgLyAoIGwgKyAxLjAgKSwgMC4wICk7XG59XG52ZWMzIExUQ19FZGdlVmVjdG9yRm9ybUZhY3RvciggY29uc3QgaW4gdmVjMyB2MSwgY29uc3QgaW4gdmVjMyB2MiApIHtcbglmbG9hdCB4ID0gZG90KCB2MSwgdjIgKTtcbglmbG9hdCB5ID0gYWJzKCB4ICk7XG4JZmxvYXQgYSA9IDAuODU0Mzk4NSArICggMC40OTY1MTU1ICsgMC4wMTQ1MjA2ICogeSApICogeTtcbglmbG9hdCBiID0gMy40MTc1OTQwICsgKCA0LjE2MTY3MjQgKyB5ICkgKiB5O1xuCWZsb2F0IHYgPSBhIC8gYjtcbglmbG9hdCB0aGV0YV9zaW50aGV0YSA9ICggeCA+IDAuMCApID8gdiA6IDAuNSAqIGludmVyc2VzcXJ0KCBtYXgoIDEuMCAtIHggKiB4LCAxZS03ICkgKSAtIHY7XG4JcmV0dXJuIGNyb3NzKCB2MSwgdjIgKSAqIHRoZXRhX3NpbnRoZXRhO1xufVxudmVjMyBMVENfRXZhbHVhdGUoIGNvbnN0IGluIHZlYzMgTiwgY29uc3QgaW4gdmVjMyBWLCBjb25zdCBpbiB2ZWMzIFAsIGNvbnN0IGluIG1hdDMgbUludiwgY29uc3QgaW4gdmVjMyByZWN0Q29vcmRzWyA0IF0gKSB7XG4JdmVjMyB2MSA9IHJlY3RDb29yZHNbIDEgXSAtIHJlY3RDb29yZHNbIDAgXTtcbgl2ZWMzIHYyID0gcmVjdENvb3Jkc1sgMyBdIC0gcmVjdENvb3Jkc1sgMCBdO1xuCXZlYzMgbGlnaHROb3JtYWwgPSBjcm9zcyggdjEsIHYyICk7XG4JaWYoIGRvdCggbGlnaHROb3JtYWwsIFAgLSByZWN0Q29vcmRzWyAwIF0gKSA8IDAuMCApIHJldHVybiB2ZWMzKCAwLjAgKTtcbgl2ZWMzIFQxLCBUMjtcbglUMSA9IG5vcm1hbGl6ZSggViAtIE4gKiBkb3QoIFYsIE4gKSApO1xuCVQyID0gLSBjcm9zcyggTiwgVDEgKTtcbgltYXQzIG1hdCA9IG1JbnYgKiB0cmFuc3Bvc2VNYXQzKCBtYXQzKCBUMSwgVDIsIE4gKSApO1xuCXZlYzMgY29vcmRzWyA0IF07XG4JY29vcmRzWyAwIF0gPSBtYXQgKiAoIHJlY3RDb29yZHNbIDAgXSAtIFAgKTtcbgljb29yZHNbIDEgXSA9IG1hdCAqICggcmVjdENvb3Jkc1sgMSBdIC0gUCApO1xuCWNvb3Jkc1sgMiBdID0gbWF0ICogKCByZWN0Q29vcmRzWyAyIF0gLSBQICk7XG4JY29vcmRzWyAzIF0gPSBtYXQgKiAoIHJlY3RDb29yZHNbIDMgXSAtIFAgKTtcbgljb29yZHNbIDAgXSA9IG5vcm1hbGl6ZSggY29vcmRzWyAwIF0gKTtcbgljb29yZHNbIDEgXSA9IG5vcm1hbGl6ZSggY29vcmRzWyAxIF0gKTtcbgljb29yZHNbIDIgXSA9IG5vcm1hbGl6ZSggY29vcmRzWyAyIF0gKTtcbgljb29yZHNbIDMgXSA9IG5vcm1hbGl6ZSggY29vcmRzWyAzIF0gKTtcbgl2ZWMzIHZlY3RvckZvcm1GYWN0b3IgPSB2ZWMzKCAwLjAgKTtcbgl2ZWN0b3JGb3JtRmFjdG9yICs9IExUQ19FZGdlVmVjdG9yRm9ybUZhY3RvciggY29vcmRzWyAwIF0sIGNvb3Jkc1sgMSBdICk7XG4JdmVjdG9yRm9ybUZhY3RvciArPSBMVENfRWRnZVZlY3RvckZvcm1GYWN0b3IoIGNvb3Jkc1sgMSBdLCBjb29yZHNbIDIgXSApO1xuCXZlY3RvckZvcm1GYWN0b3IgKz0gTFRDX0VkZ2VWZWN0b3JGb3JtRmFjdG9yKCBjb29yZHNbIDIgXSwgY29vcmRzWyAzIF0gKTtcbgl2ZWN0b3JGb3JtRmFjdG9yICs9IExUQ19FZGdlVmVjdG9yRm9ybUZhY3RvciggY29vcmRzWyAzIF0sIGNvb3Jkc1sgMCBdICk7XG4JZmxvYXQgcmVzdWx0ID0gTFRDX0NsaXBwZWRTcGhlcmVGb3JtRmFjdG9yKCB2ZWN0b3JGb3JtRmFjdG9yICk7XG4JcmV0dXJuIHZlYzMoIHJlc3VsdCApO1xufVxuZmxvYXQgR19CbGlublBob25nX0ltcGxpY2l0KCApIHtcbglyZXR1cm4gMC4yNTtcbn1cbmZsb2F0IERfQmxpbm5QaG9uZyggY29uc3QgaW4gZmxvYXQgc2hpbmluZXNzLCBjb25zdCBpbiBmbG9hdCBkb3ROSCApIHtcbglyZXR1cm4gUkVDSVBST0NBTF9QSSAqICggc2hpbmluZXNzICogMC41ICsgMS4wICkgKiBwb3coIGRvdE5ILCBzaGluaW5lc3MgKTtcbn1cbnZlYzMgQlJERl9CbGlublBob25nKCBjb25zdCBpbiB2ZWMzIGxpZ2h0RGlyLCBjb25zdCBpbiB2ZWMzIHZpZXdEaXIsIGNvbnN0IGluIHZlYzMgbm9ybWFsLCBjb25zdCBpbiB2ZWMzIHNwZWN1bGFyQ29sb3IsIGNvbnN0IGluIGZsb2F0IHNoaW5pbmVzcyApIHtcbgl2ZWMzIGhhbGZEaXIgPSBub3JtYWxpemUoIGxpZ2h0RGlyICsgdmlld0RpciApO1xuCWZsb2F0IGRvdE5IID0gc2F0dXJhdGUoIGRvdCggbm9ybWFsLCBoYWxmRGlyICkgKTtcbglmbG9hdCBkb3RWSCA9IHNhdHVyYXRlKCBkb3QoIHZpZXdEaXIsIGhhbGZEaXIgKSApO1xuCXZlYzMgRiA9IEZfU2NobGljayggc3BlY3VsYXJDb2xvciwgMS4wLCBkb3RWSCApO1xuCWZsb2F0IEcgPSBHX0JsaW5uUGhvbmdfSW1wbGljaXQoICk7XG4JZmxvYXQgRCA9IERfQmxpbm5QaG9uZyggc2hpbmluZXNzLCBkb3ROSCApO1xuCXJldHVybiBGICogKCBHICogRCApO1xufVxuI2lmIGRlZmluZWQoIFVTRV9TSEVFTiApXG5mbG9hdCBEX0NoYXJsaWUoIGZsb2F0IHJvdWdobmVzcywgZmxvYXQgZG90TkggKSB7XG4JZmxvYXQgYWxwaGEgPSBwb3cyKCByb3VnaG5lc3MgKTtcbglmbG9hdCBpbnZBbHBoYSA9IDEuMCAvIGFscGhhO1xuCWZsb2F0IGNvczJoID0gZG90TkggKiBkb3ROSDtcbglmbG9hdCBzaW4yaCA9IG1heCggMS4wIC0gY29zMmgsIDAuMDA3ODEyNSApO1xuCXJldHVybiAoIDIuMCArIGludkFscGhhICkgKiBwb3coIHNpbjJoLCBpbnZBbHBoYSAqIDAuNSApIC8gKCAyLjAgKiBQSSApO1xufVxuZmxvYXQgVl9OZXViZWx0KCBmbG9hdCBkb3ROViwgZmxvYXQgZG90TkwgKSB7XG4JcmV0dXJuIHNhdHVyYXRlKCAxLjAgLyAoIDQuMCAqICggZG90TkwgKyBkb3ROViAtIGRvdE5MICogZG90TlYgKSApICk7XG59XG52ZWMzIEJSREZfU2hlZW4oIGNvbnN0IGluIHZlYzMgbGlnaHREaXIsIGNvbnN0IGluIHZlYzMgdmlld0RpciwgY29uc3QgaW4gdmVjMyBub3JtYWwsIHZlYzMgc2hlZW5Db2xvciwgY29uc3QgaW4gZmxvYXQgc2hlZW5Sb3VnaG5lc3MgKSB7XG4JdmVjMyBoYWxmRGlyID0gbm9ybWFsaXplKCBsaWdodERpciArIHZpZXdEaXIgKTtcbglmbG9hdCBkb3ROTCA9IHNhdHVyYXRlKCBkb3QoIG5vcm1hbCwgbGlnaHREaXIgKSApO1xuCWZsb2F0IGRvdE5WID0gc2F0dXJhdGUoIGRvdCggbm9ybWFsLCB2aWV3RGlyICkgKTtcbglmbG9hdCBkb3ROSCA9IHNhdHVyYXRlKCBkb3QoIG5vcm1hbCwgaGFsZkRpciApICk7XG4JZmxvYXQgRCA9IERfQ2hhcmxpZSggc2hlZW5Sb3VnaG5lc3MsIGRvdE5IICk7XG4JZmxvYXQgViA9IFZfTmV1YmVsdCggZG90TlYsIGRvdE5MICk7XG4JcmV0dXJuIHNoZWVuQ29sb3IgKiAoIEQgKiBWICk7XG59XG4jZW5kaWYiOwp2YXIgYnVtcG1hcF9wYXJzX2ZyYWdtZW50ID0gIiNpZmRlZiBVU0VfQlVNUE1BUFxuCXVuaWZvcm0gc2FtcGxlcjJEIGJ1bXBNYXA7XG4JdW5pZm9ybSBmbG9hdCBidW1wU2NhbGU7XG4JdmVjMiBkSGR4eV9md2QoKSB7XG4JCXZlYzIgZFNUZHggPSBkRmR4KCB2VXYgKTtcbgkJdmVjMiBkU1RkeSA9IGRGZHkoIHZVdiApO1xuCQlmbG9hdCBIbGwgPSBidW1wU2NhbGUgKiB0ZXh0dXJlMkQoIGJ1bXBNYXAsIHZVdiApLng7XG4JCWZsb2F0IGRCeCA9IGJ1bXBTY2FsZSAqIHRleHR1cmUyRCggYnVtcE1hcCwgdlV2ICsgZFNUZHggKS54IC0gSGxsO1xuCQlmbG9hdCBkQnkgPSBidW1wU2NhbGUgKiB0ZXh0dXJlMkQoIGJ1bXBNYXAsIHZVdiArIGRTVGR5ICkueCAtIEhsbDtcbgkJcmV0dXJuIHZlYzIoIGRCeCwgZEJ5ICk7XG4JfVxuCXZlYzMgcGVydHVyYk5vcm1hbEFyYiggdmVjMyBzdXJmX3BvcywgdmVjMyBzdXJmX25vcm0sIHZlYzIgZEhkeHksIGZsb2F0IGZhY2VEaXJlY3Rpb24gKSB7XG4JCXZlYzMgdlNpZ21hWCA9IHZlYzMoIGRGZHgoIHN1cmZfcG9zLnggKSwgZEZkeCggc3VyZl9wb3MueSApLCBkRmR4KCBzdXJmX3Bvcy56ICkgKTtcbgkJdmVjMyB2U2lnbWFZID0gdmVjMyggZEZkeSggc3VyZl9wb3MueCApLCBkRmR5KCBzdXJmX3Bvcy55ICksIGRGZHkoIHN1cmZfcG9zLnogKSApO1xuCQl2ZWMzIHZOID0gc3VyZl9ub3JtO1xuCQl2ZWMzIFIxID0gY3Jvc3MoIHZTaWdtYVksIHZOICk7XG4JCXZlYzMgUjIgPSBjcm9zcyggdk4sIHZTaWdtYVggKTtcbgkJZmxvYXQgZkRldCA9IGRvdCggdlNpZ21hWCwgUjEgKSAqIGZhY2VEaXJlY3Rpb247XG4JCXZlYzMgdkdyYWQgPSBzaWduKCBmRGV0ICkgKiAoIGRIZHh5LnggKiBSMSArIGRIZHh5LnkgKiBSMiApO1xuCQlyZXR1cm4gbm9ybWFsaXplKCBhYnMoIGZEZXQgKSAqIHN1cmZfbm9ybSAtIHZHcmFkICk7XG4JfVxuI2VuZGlmIjsKdmFyIGNsaXBwaW5nX3BsYW5lc19mcmFnbWVudCA9ICIjaWYgTlVNX0NMSVBQSU5HX1BMQU5FUyA+IDBcbgl2ZWM0IHBsYW5lO1xuCSNwcmFnbWEgdW5yb2xsX2xvb3Bfc3RhcnRcbglmb3IgKCBpbnQgaSA9IDA7IGkgPCBVTklPTl9DTElQUElOR19QTEFORVM7IGkgKysgKSB7XG4JCXBsYW5lID0gY2xpcHBpbmdQbGFuZXNbIGkgXTtcbgkJaWYgKCBkb3QoIHZDbGlwUG9zaXRpb24sIHBsYW5lLnh5eiApID4gcGxhbmUudyApIGRpc2NhcmQ7XG4JfVxuCSNwcmFnbWEgdW5yb2xsX2xvb3BfZW5kXG4JI2lmIFVOSU9OX0NMSVBQSU5HX1BMQU5FUyA8IE5VTV9DTElQUElOR19QTEFORVNcbgkJYm9vbCBjbGlwcGVkID0gdHJ1ZTtcbgkJI3ByYWdtYSB1bnJvbGxfbG9vcF9zdGFydFxuCQlmb3IgKCBpbnQgaSA9IFVOSU9OX0NMSVBQSU5HX1BMQU5FUzsgaSA8IE5VTV9DTElQUElOR19QTEFORVM7IGkgKysgKSB7XG4JCQlwbGFuZSA9IGNsaXBwaW5nUGxhbmVzWyBpIF07XG4JCQljbGlwcGVkID0gKCBkb3QoIHZDbGlwUG9zaXRpb24sIHBsYW5lLnh5eiApID4gcGxhbmUudyApICYmIGNsaXBwZWQ7XG4JCX1cbgkJI3ByYWdtYSB1bnJvbGxfbG9vcF9lbmRcbgkJaWYgKCBjbGlwcGVkICkgZGlzY2FyZDtcbgkjZW5kaWZcbiNlbmRpZiI7CnZhciBjbGlwcGluZ19wbGFuZXNfcGFyc19mcmFnbWVudCA9ICIjaWYgTlVNX0NMSVBQSU5HX1BMQU5FUyA+IDBcbgl2YXJ5aW5nIHZlYzMgdkNsaXBQb3NpdGlvbjtcbgl1bmlmb3JtIHZlYzQgY2xpcHBpbmdQbGFuZXNbIE5VTV9DTElQUElOR19QTEFORVMgXTtcbiNlbmRpZiI7CnZhciBjbGlwcGluZ19wbGFuZXNfcGFyc192ZXJ0ZXggPSAiI2lmIE5VTV9DTElQUElOR19QTEFORVMgPiAwXG4JdmFyeWluZyB2ZWMzIHZDbGlwUG9zaXRpb247XG4jZW5kaWYiOwp2YXIgY2xpcHBpbmdfcGxhbmVzX3ZlcnRleCA9ICIjaWYgTlVNX0NMSVBQSU5HX1BMQU5FUyA+IDBcbgl2Q2xpcFBvc2l0aW9uID0gLSBtdlBvc2l0aW9uLnh5ejtcbiNlbmRpZiI7CnZhciBjb2xvcl9mcmFnbWVudCA9ICIjaWYgZGVmaW5lZCggVVNFX0NPTE9SX0FMUEhBIClcbglkaWZmdXNlQ29sb3IgKj0gdkNvbG9yO1xuI2VsaWYgZGVmaW5lZCggVVNFX0NPTE9SIClcbglkaWZmdXNlQ29sb3IucmdiICo9IHZDb2xvcjtcbiNlbmRpZiI7CnZhciBjb2xvcl9wYXJzX2ZyYWdtZW50ID0gIiNpZiBkZWZpbmVkKCBVU0VfQ09MT1JfQUxQSEEgKVxuCXZhcnlpbmcgdmVjNCB2Q29sb3I7XG4jZWxpZiBkZWZpbmVkKCBVU0VfQ09MT1IgKVxuCXZhcnlpbmcgdmVjMyB2Q29sb3I7XG4jZW5kaWYiOwp2YXIgY29sb3JfcGFyc192ZXJ0ZXggPSAiI2lmIGRlZmluZWQoIFVTRV9DT0xPUl9BTFBIQSApXG4JdmFyeWluZyB2ZWM0IHZDb2xvcjtcbiNlbGlmIGRlZmluZWQoIFVTRV9DT0xPUiApIHx8IGRlZmluZWQoIFVTRV9JTlNUQU5DSU5HX0NPTE9SIClcbgl2YXJ5aW5nIHZlYzMgdkNvbG9yO1xuI2VuZGlmIjsKdmFyIGNvbG9yX3ZlcnRleCA9ICIjaWYgZGVmaW5lZCggVVNFX0NPTE9SX0FMUEhBIClcbgl2Q29sb3IgPSB2ZWM0KCAxLjAgKTtcbiNlbGlmIGRlZmluZWQoIFVTRV9DT0xPUiApIHx8IGRlZmluZWQoIFVTRV9JTlNUQU5DSU5HX0NPTE9SIClcbgl2Q29sb3IgPSB2ZWMzKCAxLjAgKTtcbiNlbmRpZlxuI2lmZGVmIFVTRV9DT0xPUlxuCXZDb2xvciAqPSBjb2xvcjtcbiNlbmRpZlxuI2lmZGVmIFVTRV9JTlNUQU5DSU5HX0NPTE9SXG4JdkNvbG9yLnh5eiAqPSBpbnN0YW5jZUNvbG9yLnh5ejtcbiNlbmRpZiI7CnZhciBjb21tb24gPSAiI2RlZmluZSBQSSAzLjE0MTU5MjY1MzU4OTc5M1xuI2RlZmluZSBQSTIgNi4yODMxODUzMDcxNzk1ODZcbiNkZWZpbmUgUElfSEFMRiAxLjU3MDc5NjMyNjc5NDg5NjZcbiNkZWZpbmUgUkVDSVBST0NBTF9QSSAwLjMxODMwOTg4NjE4Mzc5MDdcbiNkZWZpbmUgUkVDSVBST0NBTF9QSTIgMC4xNTkxNTQ5NDMwOTE4OTUzNVxuI2RlZmluZSBFUFNJTE9OIDFlLTZcbiNpZm5kZWYgc2F0dXJhdGVcbiNkZWZpbmUgc2F0dXJhdGUoIGEgKSBjbGFtcCggYSwgMC4wLCAxLjAgKVxuI2VuZGlmXG4jZGVmaW5lIHdoaXRlQ29tcGxlbWVudCggYSApICggMS4wIC0gc2F0dXJhdGUoIGEgKSApXG5mbG9hdCBwb3cyKCBjb25zdCBpbiBmbG9hdCB4ICkgeyByZXR1cm4geCp4OyB9XG5mbG9hdCBwb3czKCBjb25zdCBpbiBmbG9hdCB4ICkgeyByZXR1cm4geCp4Kng7IH1cbmZsb2F0IHBvdzQoIGNvbnN0IGluIGZsb2F0IHggKSB7IGZsb2F0IHgyID0geCp4OyByZXR1cm4geDIqeDI7IH1cbmZsb2F0IG1heDMoIGNvbnN0IGluIHZlYzMgdiApIHsgcmV0dXJuIG1heCggbWF4KCB2LngsIHYueSApLCB2LnogKTsgfVxuZmxvYXQgYXZlcmFnZSggY29uc3QgaW4gdmVjMyBjb2xvciApIHsgcmV0dXJuIGRvdCggY29sb3IsIHZlYzMoIDAuMzMzMyApICk7IH1cbmhpZ2hwIGZsb2F0IHJhbmQoIGNvbnN0IGluIHZlYzIgdXYgKSB7XG4JY29uc3QgaGlnaHAgZmxvYXQgYSA9IDEyLjk4OTgsIGIgPSA3OC4yMzMsIGMgPSA0Mzc1OC41NDUzO1xuCWhpZ2hwIGZsb2F0IGR0ID0gZG90KCB1di54eSwgdmVjMiggYSxiICkgKSwgc24gPSBtb2QoIGR0LCBQSSApO1xuCXJldHVybiBmcmFjdCggc2luKCBzbiApICogYyApO1xufVxuI2lmZGVmIEhJR0hfUFJFQ0lTSU9OXG4JZmxvYXQgcHJlY2lzaW9uU2FmZUxlbmd0aCggdmVjMyB2ICkgeyByZXR1cm4gbGVuZ3RoKCB2ICk7IH1cbiNlbHNlXG4JZmxvYXQgcHJlY2lzaW9uU2FmZUxlbmd0aCggdmVjMyB2ICkge1xuCQlmbG9hdCBtYXhDb21wb25lbnQgPSBtYXgzKCBhYnMoIHYgKSApO1xuCQlyZXR1cm4gbGVuZ3RoKCB2IC8gbWF4Q29tcG9uZW50ICkgKiBtYXhDb21wb25lbnQ7XG4JfVxuI2VuZGlmXG5zdHJ1Y3QgSW5jaWRlbnRMaWdodCB7XG4JdmVjMyBjb2xvcjtcbgl2ZWMzIGRpcmVjdGlvbjtcbglib29sIHZpc2libGU7XG59O1xuc3RydWN0IFJlZmxlY3RlZExpZ2h0IHtcbgl2ZWMzIGRpcmVjdERpZmZ1c2U7XG4JdmVjMyBkaXJlY3RTcGVjdWxhcjtcbgl2ZWMzIGluZGlyZWN0RGlmZnVzZTtcbgl2ZWMzIGluZGlyZWN0U3BlY3VsYXI7XG59O1xuc3RydWN0IEdlb21ldHJpY0NvbnRleHQge1xuCXZlYzMgcG9zaXRpb247XG4JdmVjMyBub3JtYWw7XG4JdmVjMyB2aWV3RGlyO1xuI2lmZGVmIFVTRV9DTEVBUkNPQVRcbgl2ZWMzIGNsZWFyY29hdE5vcm1hbDtcbiNlbmRpZlxufTtcbnZlYzMgdHJhbnNmb3JtRGlyZWN0aW9uKCBpbiB2ZWMzIGRpciwgaW4gbWF0NCBtYXRyaXggKSB7XG4JcmV0dXJuIG5vcm1hbGl6ZSggKCBtYXRyaXggKiB2ZWM0KCBkaXIsIDAuMCApICkueHl6ICk7XG59XG52ZWMzIGludmVyc2VUcmFuc2Zvcm1EaXJlY3Rpb24oIGluIHZlYzMgZGlyLCBpbiBtYXQ0IG1hdHJpeCApIHtcbglyZXR1cm4gbm9ybWFsaXplKCAoIHZlYzQoIGRpciwgMC4wICkgKiBtYXRyaXggKS54eXogKTtcbn1cbm1hdDMgdHJhbnNwb3NlTWF0MyggY29uc3QgaW4gbWF0MyBtICkge1xuCW1hdDMgdG1wO1xuCXRtcFsgMCBdID0gdmVjMyggbVsgMCBdLngsIG1bIDEgXS54LCBtWyAyIF0ueCApO1xuCXRtcFsgMSBdID0gdmVjMyggbVsgMCBdLnksIG1bIDEgXS55LCBtWyAyIF0ueSApO1xuCXRtcFsgMiBdID0gdmVjMyggbVsgMCBdLnosIG1bIDEgXS56LCBtWyAyIF0ueiApO1xuCXJldHVybiB0bXA7XG59XG5mbG9hdCBsaW5lYXJUb1JlbGF0aXZlTHVtaW5hbmNlKCBjb25zdCBpbiB2ZWMzIGNvbG9yICkge1xuCXZlYzMgd2VpZ2h0cyA9IHZlYzMoIDAuMjEyNiwgMC43MTUyLCAwLjA3MjIgKTtcbglyZXR1cm4gZG90KCB3ZWlnaHRzLCBjb2xvci5yZ2IgKTtcbn1cbmJvb2wgaXNQZXJzcGVjdGl2ZU1hdHJpeCggbWF0NCBtICkge1xuCXJldHVybiBtWyAyIF1bIDMgXSA9PSAtIDEuMDtcbn1cbnZlYzIgZXF1aXJlY3RVdiggaW4gdmVjMyBkaXIgKSB7XG4JZmxvYXQgdSA9IGF0YW4oIGRpci56LCBkaXIueCApICogUkVDSVBST0NBTF9QSTIgKyAwLjU7XG4JZmxvYXQgdiA9IGFzaW4oIGNsYW1wKCBkaXIueSwgLSAxLjAsIDEuMCApICkgKiBSRUNJUFJPQ0FMX1BJICsgMC41O1xuCXJldHVybiB2ZWMyKCB1LCB2ICk7XG59IjsKdmFyIGN1YmVfdXZfcmVmbGVjdGlvbl9mcmFnbWVudCA9ICIjaWZkZWYgRU5WTUFQX1RZUEVfQ1VCRV9VVlxuCSNkZWZpbmUgY3ViZVVWX21heE1pcExldmVsIDguMFxuCSNkZWZpbmUgY3ViZVVWX21pbk1pcExldmVsIDQuMFxuCSNkZWZpbmUgY3ViZVVWX21heFRpbGVTaXplIDI1Ni4wXG4JI2RlZmluZSBjdWJlVVZfbWluVGlsZVNpemUgMTYuMFxuCWZsb2F0IGdldEZhY2UoIHZlYzMgZGlyZWN0aW9uICkge1xuCQl2ZWMzIGFic0RpcmVjdGlvbiA9IGFicyggZGlyZWN0aW9uICk7XG4JCWZsb2F0IGZhY2UgPSAtIDEuMDtcbgkJaWYgKCBhYnNEaXJlY3Rpb24ueCA+IGFic0RpcmVjdGlvbi56ICkge1xuCQkJaWYgKCBhYnNEaXJlY3Rpb24ueCA+IGFic0RpcmVjdGlvbi55IClcbgkJCQlmYWNlID0gZGlyZWN0aW9uLnggPiAwLjAgPyAwLjAgOiAzLjA7XG4JCQllbHNlXG4JCQkJZmFjZSA9IGRpcmVjdGlvbi55ID4gMC4wID8gMS4wIDogNC4wO1xuCQl9IGVsc2Uge1xuCQkJaWYgKCBhYnNEaXJlY3Rpb24ueiA+IGFic0RpcmVjdGlvbi55IClcbgkJCQlmYWNlID0gZGlyZWN0aW9uLnogPiAwLjAgPyAyLjAgOiA1LjA7XG4JCQllbHNlXG4JCQkJZmFjZSA9IGRpcmVjdGlvbi55ID4gMC4wID8gMS4wIDogNC4wO1xuCQl9XG4JCXJldHVybiBmYWNlO1xuCX1cbgl2ZWMyIGdldFVWKCB2ZWMzIGRpcmVjdGlvbiwgZmxvYXQgZmFjZSApIHtcbgkJdmVjMiB1djtcbgkJaWYgKCBmYWNlID09IDAuMCApIHtcbgkJCXV2ID0gdmVjMiggZGlyZWN0aW9uLnosIGRpcmVjdGlvbi55ICkgLyBhYnMoIGRpcmVjdGlvbi54ICk7XG4JCX0gZWxzZSBpZiAoIGZhY2UgPT0gMS4wICkge1xuCQkJdXYgPSB2ZWMyKCAtIGRpcmVjdGlvbi54LCAtIGRpcmVjdGlvbi56ICkgLyBhYnMoIGRpcmVjdGlvbi55ICk7XG4JCX0gZWxzZSBpZiAoIGZhY2UgPT0gMi4wICkge1xuCQkJdXYgPSB2ZWMyKCAtIGRpcmVjdGlvbi54LCBkaXJlY3Rpb24ueSApIC8gYWJzKCBkaXJlY3Rpb24ueiApO1xuCQl9IGVsc2UgaWYgKCBmYWNlID09IDMuMCApIHtcbgkJCXV2ID0gdmVjMiggLSBkaXJlY3Rpb24ueiwgZGlyZWN0aW9uLnkgKSAvIGFicyggZGlyZWN0aW9uLnggKTtcbgkJfSBlbHNlIGlmICggZmFjZSA9PSA0LjAgKSB7XG4JCQl1diA9IHZlYzIoIC0gZGlyZWN0aW9uLngsIGRpcmVjdGlvbi56ICkgLyBhYnMoIGRpcmVjdGlvbi55ICk7XG4JCX0gZWxzZSB7XG4JCQl1diA9IHZlYzIoIGRpcmVjdGlvbi54LCBkaXJlY3Rpb24ueSApIC8gYWJzKCBkaXJlY3Rpb24ueiApO1xuCQl9XG4JCXJldHVybiAwLjUgKiAoIHV2ICsgMS4wICk7XG4JfVxuCXZlYzMgYmlsaW5lYXJDdWJlVVYoIHNhbXBsZXIyRCBlbnZNYXAsIHZlYzMgZGlyZWN0aW9uLCBmbG9hdCBtaXBJbnQgKSB7XG4JCWZsb2F0IGZhY2UgPSBnZXRGYWNlKCBkaXJlY3Rpb24gKTtcbgkJZmxvYXQgZmlsdGVySW50ID0gbWF4KCBjdWJlVVZfbWluTWlwTGV2ZWwgLSBtaXBJbnQsIDAuMCApO1xuCQltaXBJbnQgPSBtYXgoIG1pcEludCwgY3ViZVVWX21pbk1pcExldmVsICk7XG4JCWZsb2F0IGZhY2VTaXplID0gZXhwMiggbWlwSW50ICk7XG4JCWZsb2F0IHRleGVsU2l6ZSA9IDEuMCAvICggMy4wICogY3ViZVVWX21heFRpbGVTaXplICk7XG4JCXZlYzIgdXYgPSBnZXRVViggZGlyZWN0aW9uLCBmYWNlICkgKiAoIGZhY2VTaXplIC0gMS4wICkgKyAwLjU7XG4JCWlmICggZmFjZSA+IDIuMCApIHtcbgkJCXV2LnkgKz0gZmFjZVNpemU7XG4JCQlmYWNlIC09IDMuMDtcbgkJfVxuCQl1di54ICs9IGZhY2UgKiBmYWNlU2l6ZTtcbgkJaWYgKCBtaXBJbnQgPCBjdWJlVVZfbWF4TWlwTGV2ZWwgKSB7XG4JCQl1di55ICs9IDIuMCAqIGN1YmVVVl9tYXhUaWxlU2l6ZTtcbgkJfVxuCQl1di55ICs9IGZpbHRlckludCAqIDIuMCAqIGN1YmVVVl9taW5UaWxlU2l6ZTtcbgkJdXYueCArPSAzLjAgKiBtYXgoIDAuMCwgY3ViZVVWX21heFRpbGVTaXplIC0gMi4wICogZmFjZVNpemUgKTtcbgkJdXYgKj0gdGV4ZWxTaXplO1xuCQlyZXR1cm4gdGV4dHVyZTJEKCBlbnZNYXAsIHV2ICkucmdiO1xuCX1cbgkjZGVmaW5lIHIwIDEuMFxuCSNkZWZpbmUgdjAgMC4zMzlcbgkjZGVmaW5lIG0wIC0gMi4wXG4JI2RlZmluZSByMSAwLjhcbgkjZGVmaW5lIHYxIDAuMjc2XG4JI2RlZmluZSBtMSAtIDEuMFxuCSNkZWZpbmUgcjQgMC40XG4JI2RlZmluZSB2NCAwLjA0NlxuCSNkZWZpbmUgbTQgMi4wXG4JI2RlZmluZSByNSAwLjMwNVxuCSNkZWZpbmUgdjUgMC4wMTZcbgkjZGVmaW5lIG01IDMuMFxuCSNkZWZpbmUgcjYgMC4yMVxuCSNkZWZpbmUgdjYgMC4wMDM4XG4JI2RlZmluZSBtNiA0LjBcbglmbG9hdCByb3VnaG5lc3NUb01pcCggZmxvYXQgcm91Z2huZXNzICkge1xuCQlmbG9hdCBtaXAgPSAwLjA7XG4JCWlmICggcm91Z2huZXNzID49IHIxICkge1xuCQkJbWlwID0gKCByMCAtIHJvdWdobmVzcyApICogKCBtMSAtIG0wICkgLyAoIHIwIC0gcjEgKSArIG0wO1xuCQl9IGVsc2UgaWYgKCByb3VnaG5lc3MgPj0gcjQgKSB7XG4JCQltaXAgPSAoIHIxIC0gcm91Z2huZXNzICkgKiAoIG00IC0gbTEgKSAvICggcjEgLSByNCApICsgbTE7XG4JCX0gZWxzZSBpZiAoIHJvdWdobmVzcyA+PSByNSApIHtcbgkJCW1pcCA9ICggcjQgLSByb3VnaG5lc3MgKSAqICggbTUgLSBtNCApIC8gKCByNCAtIHI1ICkgKyBtNDtcbgkJfSBlbHNlIGlmICggcm91Z2huZXNzID49IHI2ICkge1xuCQkJbWlwID0gKCByNSAtIHJvdWdobmVzcyApICogKCBtNiAtIG01ICkgLyAoIHI1IC0gcjYgKSArIG01O1xuCQl9IGVsc2Uge1xuCQkJbWlwID0gLSAyLjAgKiBsb2cyKCAxLjE2ICogcm91Z2huZXNzICk7CQl9XG4JCXJldHVybiBtaXA7XG4JfVxuCXZlYzQgdGV4dHVyZUN1YmVVViggc2FtcGxlcjJEIGVudk1hcCwgdmVjMyBzYW1wbGVEaXIsIGZsb2F0IHJvdWdobmVzcyApIHtcbgkJZmxvYXQgbWlwID0gY2xhbXAoIHJvdWdobmVzc1RvTWlwKCByb3VnaG5lc3MgKSwgbTAsIGN1YmVVVl9tYXhNaXBMZXZlbCApO1xuCQlmbG9hdCBtaXBGID0gZnJhY3QoIG1pcCApO1xuCQlmbG9hdCBtaXBJbnQgPSBmbG9vciggbWlwICk7XG4JCXZlYzMgY29sb3IwID0gYmlsaW5lYXJDdWJlVVYoIGVudk1hcCwgc2FtcGxlRGlyLCBtaXBJbnQgKTtcbgkJaWYgKCBtaXBGID09IDAuMCApIHtcbgkJCXJldHVybiB2ZWM0KCBjb2xvcjAsIDEuMCApO1xuCQl9IGVsc2Uge1xuCQkJdmVjMyBjb2xvcjEgPSBiaWxpbmVhckN1YmVVViggZW52TWFwLCBzYW1wbGVEaXIsIG1pcEludCArIDEuMCApO1xuCQkJcmV0dXJuIHZlYzQoIG1peCggY29sb3IwLCBjb2xvcjEsIG1pcEYgKSwgMS4wICk7XG4JCX1cbgl9XG4jZW5kaWYiOwp2YXIgZGVmYXVsdG5vcm1hbF92ZXJ0ZXggPSAidmVjMyB0cmFuc2Zvcm1lZE5vcm1hbCA9IG9iamVjdE5vcm1hbDtcbiNpZmRlZiBVU0VfSU5TVEFOQ0lOR1xuCW1hdDMgbSA9IG1hdDMoIGluc3RhbmNlTWF0cml4ICk7XG4JdHJhbnNmb3JtZWROb3JtYWwgLz0gdmVjMyggZG90KCBtWyAwIF0sIG1bIDAgXSApLCBkb3QoIG1bIDEgXSwgbVsgMSBdICksIGRvdCggbVsgMiBdLCBtWyAyIF0gKSApO1xuCXRyYW5zZm9ybWVkTm9ybWFsID0gbSAqIHRyYW5zZm9ybWVkTm9ybWFsO1xuI2VuZGlmXG50cmFuc2Zvcm1lZE5vcm1hbCA9IG5vcm1hbE1hdHJpeCAqIHRyYW5zZm9ybWVkTm9ybWFsO1xuI2lmZGVmIEZMSVBfU0lERURcbgl0cmFuc2Zvcm1lZE5vcm1hbCA9IC0gdHJhbnNmb3JtZWROb3JtYWw7XG4jZW5kaWZcbiNpZmRlZiBVU0VfVEFOR0VOVFxuCXZlYzMgdHJhbnNmb3JtZWRUYW5nZW50ID0gKCBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KCBvYmplY3RUYW5nZW50LCAwLjAgKSApLnh5ejtcbgkjaWZkZWYgRkxJUF9TSURFRFxuCQl0cmFuc2Zvcm1lZFRhbmdlbnQgPSAtIHRyYW5zZm9ybWVkVGFuZ2VudDtcbgkjZW5kaWZcbiNlbmRpZiI7CnZhciBkaXNwbGFjZW1lbnRtYXBfcGFyc192ZXJ0ZXggPSAiI2lmZGVmIFVTRV9ESVNQTEFDRU1FTlRNQVBcbgl1bmlmb3JtIHNhbXBsZXIyRCBkaXNwbGFjZW1lbnRNYXA7XG4JdW5pZm9ybSBmbG9hdCBkaXNwbGFjZW1lbnRTY2FsZTtcbgl1bmlmb3JtIGZsb2F0IGRpc3BsYWNlbWVudEJpYXM7XG4jZW5kaWYiOwp2YXIgZGlzcGxhY2VtZW50bWFwX3ZlcnRleCA9ICIjaWZkZWYgVVNFX0RJU1BMQUNFTUVOVE1BUFxuCXRyYW5zZm9ybWVkICs9IG5vcm1hbGl6ZSggb2JqZWN0Tm9ybWFsICkgKiAoIHRleHR1cmUyRCggZGlzcGxhY2VtZW50TWFwLCB2VXYgKS54ICogZGlzcGxhY2VtZW50U2NhbGUgKyBkaXNwbGFjZW1lbnRCaWFzICk7XG4jZW5kaWYiOwp2YXIgZW1pc3NpdmVtYXBfZnJhZ21lbnQgPSAiI2lmZGVmIFVTRV9FTUlTU0lWRU1BUFxuCXZlYzQgZW1pc3NpdmVDb2xvciA9IHRleHR1cmUyRCggZW1pc3NpdmVNYXAsIHZVdiApO1xuCXRvdGFsRW1pc3NpdmVSYWRpYW5jZSAqPSBlbWlzc2l2ZUNvbG9yLnJnYjtcbiNlbmRpZiI7CnZhciBlbWlzc2l2ZW1hcF9wYXJzX2ZyYWdtZW50ID0gIiNpZmRlZiBVU0VfRU1JU1NJVkVNQVBcbgl1bmlmb3JtIHNhbXBsZXIyRCBlbWlzc2l2ZU1hcDtcbiNlbmRpZiI7CnZhciBlbmNvZGluZ3NfZnJhZ21lbnQgPSAiZ2xfRnJhZ0NvbG9yID0gbGluZWFyVG9PdXRwdXRUZXhlbCggZ2xfRnJhZ0NvbG9yICk7IjsKdmFyIGVuY29kaW5nc19wYXJzX2ZyYWdtZW50ID0gInZlYzQgTGluZWFyVG9MaW5lYXIoIGluIHZlYzQgdmFsdWUgKSB7XG4JcmV0dXJuIHZhbHVlO1xufVxudmVjNCBMaW5lYXJUb3NSR0IoIGluIHZlYzQgdmFsdWUgKSB7XG4JcmV0dXJuIHZlYzQoIG1peCggcG93KCB2YWx1ZS5yZ2IsIHZlYzMoIDAuNDE2NjYgKSApICogMS4wNTUgLSB2ZWMzKCAwLjA1NSApLCB2YWx1ZS5yZ2IgKiAxMi45MiwgdmVjMyggbGVzc1RoYW5FcXVhbCggdmFsdWUucmdiLCB2ZWMzKCAwLjAwMzEzMDggKSApICkgKSwgdmFsdWUuYSApO1xufSI7CnZhciBlbnZtYXBfZnJhZ21lbnQgPSAiI2lmZGVmIFVTRV9FTlZNQVBcbgkjaWZkZWYgRU5WX1dPUkxEUE9TXG4JCXZlYzMgY2FtZXJhVG9GcmFnO1xuCQlpZiAoIGlzT3J0aG9ncmFwaGljICkge1xuCQkJY2FtZXJhVG9GcmFnID0gbm9ybWFsaXplKCB2ZWMzKCAtIHZpZXdNYXRyaXhbIDAgXVsgMiBdLCAtIHZpZXdNYXRyaXhbIDEgXVsgMiBdLCAtIHZpZXdNYXRyaXhbIDIgXVsgMiBdICkgKTtcbgkJfSBlbHNlIHtcbgkJCWNhbWVyYVRvRnJhZyA9IG5vcm1hbGl6ZSggdldvcmxkUG9zaXRpb24gLSBjYW1lcmFQb3NpdGlvbiApO1xuCQl9XG4JCXZlYzMgd29ybGROb3JtYWwgPSBpbnZlcnNlVHJhbnNmb3JtRGlyZWN0aW9uKCBub3JtYWwsIHZpZXdNYXRyaXggKTtcbgkJI2lmZGVmIEVOVk1BUF9NT0RFX1JFRkxFQ1RJT05cbgkJCXZlYzMgcmVmbGVjdFZlYyA9IHJlZmxlY3QoIGNhbWVyYVRvRnJhZywgd29ybGROb3JtYWwgKTtcbgkJI2Vsc2VcbgkJCXZlYzMgcmVmbGVjdFZlYyA9IHJlZnJhY3QoIGNhbWVyYVRvRnJhZywgd29ybGROb3JtYWwsIHJlZnJhY3Rpb25SYXRpbyApO1xuCQkjZW5kaWZcbgkjZWxzZVxuCQl2ZWMzIHJlZmxlY3RWZWMgPSB2UmVmbGVjdDtcbgkjZW5kaWZcbgkjaWZkZWYgRU5WTUFQX1RZUEVfQ1VCRVxuCQl2ZWM0IGVudkNvbG9yID0gdGV4dHVyZUN1YmUoIGVudk1hcCwgdmVjMyggZmxpcEVudk1hcCAqIHJlZmxlY3RWZWMueCwgcmVmbGVjdFZlYy55eiApICk7XG4JI2VsaWYgZGVmaW5lZCggRU5WTUFQX1RZUEVfQ1VCRV9VViApXG4JCXZlYzQgZW52Q29sb3IgPSB0ZXh0dXJlQ3ViZVVWKCBlbnZNYXAsIHJlZmxlY3RWZWMsIDAuMCApO1xuCSNlbHNlXG4JCXZlYzQgZW52Q29sb3IgPSB2ZWM0KCAwLjAgKTtcbgkjZW5kaWZcbgkjaWZkZWYgRU5WTUFQX0JMRU5ESU5HX01VTFRJUExZXG4JCW91dGdvaW5nTGlnaHQgPSBtaXgoIG91dGdvaW5nTGlnaHQsIG91dGdvaW5nTGlnaHQgKiBlbnZDb2xvci54eXosIHNwZWN1bGFyU3RyZW5ndGggKiByZWZsZWN0aXZpdHkgKTtcbgkjZWxpZiBkZWZpbmVkKCBFTlZNQVBfQkxFTkRJTkdfTUlYIClcbgkJb3V0Z29pbmdMaWdodCA9IG1peCggb3V0Z29pbmdMaWdodCwgZW52Q29sb3IueHl6LCBzcGVjdWxhclN0cmVuZ3RoICogcmVmbGVjdGl2aXR5ICk7XG4JI2VsaWYgZGVmaW5lZCggRU5WTUFQX0JMRU5ESU5HX0FERCApXG4JCW91dGdvaW5nTGlnaHQgKz0gZW52Q29sb3IueHl6ICogc3BlY3VsYXJTdHJlbmd0aCAqIHJlZmxlY3Rpdml0eTtcbgkjZW5kaWZcbiNlbmRpZiI7CnZhciBlbnZtYXBfY29tbW9uX3BhcnNfZnJhZ21lbnQgPSAiI2lmZGVmIFVTRV9FTlZNQVBcbgl1bmlmb3JtIGZsb2F0IGVudk1hcEludGVuc2l0eTtcbgl1bmlmb3JtIGZsb2F0IGZsaXBFbnZNYXA7XG4JI2lmZGVmIEVOVk1BUF9UWVBFX0NVQkVcbgkJdW5pZm9ybSBzYW1wbGVyQ3ViZSBlbnZNYXA7XG4JI2Vsc2VcbgkJdW5pZm9ybSBzYW1wbGVyMkQgZW52TWFwO1xuCSNlbmRpZlxuCVxuI2VuZGlmIjsKdmFyIGVudm1hcF9wYXJzX2ZyYWdtZW50ID0gIiNpZmRlZiBVU0VfRU5WTUFQXG4JdW5pZm9ybSBmbG9hdCByZWZsZWN0aXZpdHk7XG4JI2lmIGRlZmluZWQoIFVTRV9CVU1QTUFQICkgfHwgZGVmaW5lZCggVVNFX05PUk1BTE1BUCApIHx8IGRlZmluZWQoIFBIT05HIClcbgkJI2RlZmluZSBFTlZfV09STERQT1NcbgkjZW5kaWZcbgkjaWZkZWYgRU5WX1dPUkxEUE9TXG4JCXZhcnlpbmcgdmVjMyB2V29ybGRQb3NpdGlvbjtcbgkJdW5pZm9ybSBmbG9hdCByZWZyYWN0aW9uUmF0aW87XG4JI2Vsc2VcbgkJdmFyeWluZyB2ZWMzIHZSZWZsZWN0O1xuCSNlbmRpZlxuI2VuZGlmIjsKdmFyIGVudm1hcF9wYXJzX3ZlcnRleCA9ICIjaWZkZWYgVVNFX0VOVk1BUFxuCSNpZiBkZWZpbmVkKCBVU0VfQlVNUE1BUCApIHx8IGRlZmluZWQoIFVTRV9OT1JNQUxNQVAgKSB8fGRlZmluZWQoIFBIT05HIClcbgkJI2RlZmluZSBFTlZfV09STERQT1NcbgkjZW5kaWZcbgkjaWZkZWYgRU5WX1dPUkxEUE9TXG4JCVxuCQl2YXJ5aW5nIHZlYzMgdldvcmxkUG9zaXRpb247XG4JI2Vsc2VcbgkJdmFyeWluZyB2ZWMzIHZSZWZsZWN0O1xuCQl1bmlmb3JtIGZsb2F0IHJlZnJhY3Rpb25SYXRpbztcbgkjZW5kaWZcbiNlbmRpZiI7CnZhciBlbnZtYXBfdmVydGV4ID0gIiNpZmRlZiBVU0VfRU5WTUFQXG4JI2lmZGVmIEVOVl9XT1JMRFBPU1xuCQl2V29ybGRQb3NpdGlvbiA9IHdvcmxkUG9zaXRpb24ueHl6O1xuCSNlbHNlXG4JCXZlYzMgY2FtZXJhVG9WZXJ0ZXg7XG4JCWlmICggaXNPcnRob2dyYXBoaWMgKSB7XG4JCQljYW1lcmFUb1ZlcnRleCA9IG5vcm1hbGl6ZSggdmVjMyggLSB2aWV3TWF0cml4WyAwIF1bIDIgXSwgLSB2aWV3TWF0cml4WyAxIF1bIDIgXSwgLSB2aWV3TWF0cml4WyAyIF1bIDIgXSApICk7XG4JCX0gZWxzZSB7XG4JCQljYW1lcmFUb1ZlcnRleCA9IG5vcm1hbGl6ZSggd29ybGRQb3NpdGlvbi54eXogLSBjYW1lcmFQb3NpdGlvbiApO1xuCQl9XG4JCXZlYzMgd29ybGROb3JtYWwgPSBpbnZlcnNlVHJhbnNmb3JtRGlyZWN0aW9uKCB0cmFuc2Zvcm1lZE5vcm1hbCwgdmlld01hdHJpeCApO1xuCQkjaWZkZWYgRU5WTUFQX01PREVfUkVGTEVDVElPTlxuCQkJdlJlZmxlY3QgPSByZWZsZWN0KCBjYW1lcmFUb1ZlcnRleCwgd29ybGROb3JtYWwgKTtcbgkJI2Vsc2VcbgkJCXZSZWZsZWN0ID0gcmVmcmFjdCggY2FtZXJhVG9WZXJ0ZXgsIHdvcmxkTm9ybWFsLCByZWZyYWN0aW9uUmF0aW8gKTtcbgkJI2VuZGlmXG4JI2VuZGlmXG4jZW5kaWYiOwp2YXIgZm9nX3ZlcnRleCA9ICIjaWZkZWYgVVNFX0ZPR1xuCXZGb2dEZXB0aCA9IC0gbXZQb3NpdGlvbi56O1xuI2VuZGlmIjsKdmFyIGZvZ19wYXJzX3ZlcnRleCA9ICIjaWZkZWYgVVNFX0ZPR1xuCXZhcnlpbmcgZmxvYXQgdkZvZ0RlcHRoO1xuI2VuZGlmIjsKdmFyIGZvZ19mcmFnbWVudCA9ICIjaWZkZWYgVVNFX0ZPR1xuCSNpZmRlZiBGT0dfRVhQMlxuCQlmbG9hdCBmb2dGYWN0b3IgPSAxLjAgLSBleHAoIC0gZm9nRGVuc2l0eSAqIGZvZ0RlbnNpdHkgKiB2Rm9nRGVwdGggKiB2Rm9nRGVwdGggKTtcbgkjZWxzZVxuCQlmbG9hdCBmb2dGYWN0b3IgPSBzbW9vdGhzdGVwKCBmb2dOZWFyLCBmb2dGYXIsIHZGb2dEZXB0aCApO1xuCSNlbmRpZlxuCWdsX0ZyYWdDb2xvci5yZ2IgPSBtaXgoIGdsX0ZyYWdDb2xvci5yZ2IsIGZvZ0NvbG9yLCBmb2dGYWN0b3IgKTtcbiNlbmRpZiI7CnZhciBmb2dfcGFyc19mcmFnbWVudCA9ICIjaWZkZWYgVVNFX0ZPR1xuCXVuaWZvcm0gdmVjMyBmb2dDb2xvcjtcbgl2YXJ5aW5nIGZsb2F0IHZGb2dEZXB0aDtcbgkjaWZkZWYgRk9HX0VYUDJcbgkJdW5pZm9ybSBmbG9hdCBmb2dEZW5zaXR5O1xuCSNlbHNlXG4JCXVuaWZvcm0gZmxvYXQgZm9nTmVhcjtcbgkJdW5pZm9ybSBmbG9hdCBmb2dGYXI7XG4JI2VuZGlmXG4jZW5kaWYiOwp2YXIgZ3JhZGllbnRtYXBfcGFyc19mcmFnbWVudCA9ICIjaWZkZWYgVVNFX0dSQURJRU5UTUFQXG4JdW5pZm9ybSBzYW1wbGVyMkQgZ3JhZGllbnRNYXA7XG4jZW5kaWZcbnZlYzMgZ2V0R3JhZGllbnRJcnJhZGlhbmNlKCB2ZWMzIG5vcm1hbCwgdmVjMyBsaWdodERpcmVjdGlvbiApIHtcbglmbG9hdCBkb3ROTCA9IGRvdCggbm9ybWFsLCBsaWdodERpcmVjdGlvbiApO1xuCXZlYzIgY29vcmQgPSB2ZWMyKCBkb3ROTCAqIDAuNSArIDAuNSwgMC4wICk7XG4JI2lmZGVmIFVTRV9HUkFESUVOVE1BUFxuCQlyZXR1cm4gdmVjMyggdGV4dHVyZTJEKCBncmFkaWVudE1hcCwgY29vcmQgKS5yICk7XG4JI2Vsc2VcbgkJcmV0dXJuICggY29vcmQueCA8IDAuNyApID8gdmVjMyggMC43ICkgOiB2ZWMzKCAxLjAgKTtcbgkjZW5kaWZcbn0iOwp2YXIgbGlnaHRtYXBfZnJhZ21lbnQgPSAiI2lmZGVmIFVTRV9MSUdIVE1BUFxuCXZlYzQgbGlnaHRNYXBUZXhlbCA9IHRleHR1cmUyRCggbGlnaHRNYXAsIHZVdjIgKTtcbgl2ZWMzIGxpZ2h0TWFwSXJyYWRpYW5jZSA9IGxpZ2h0TWFwVGV4ZWwucmdiICogbGlnaHRNYXBJbnRlbnNpdHk7XG4JI2lmbmRlZiBQSFlTSUNBTExZX0NPUlJFQ1RfTElHSFRTXG4JCWxpZ2h0TWFwSXJyYWRpYW5jZSAqPSBQSTtcbgkjZW5kaWZcbglyZWZsZWN0ZWRMaWdodC5pbmRpcmVjdERpZmZ1c2UgKz0gbGlnaHRNYXBJcnJhZGlhbmNlO1xuI2VuZGlmIjsKdmFyIGxpZ2h0bWFwX3BhcnNfZnJhZ21lbnQgPSAiI2lmZGVmIFVTRV9MSUdIVE1BUFxuCXVuaWZvcm0gc2FtcGxlcjJEIGxpZ2h0TWFwO1xuCXVuaWZvcm0gZmxvYXQgbGlnaHRNYXBJbnRlbnNpdHk7XG4jZW5kaWYiOwp2YXIgbGlnaHRzX2xhbWJlcnRfdmVydGV4ID0gInZlYzMgZGlmZnVzZSA9IHZlYzMoIDEuMCApO1xuR2VvbWV0cmljQ29udGV4dCBnZW9tZXRyeTtcbmdlb21ldHJ5LnBvc2l0aW9uID0gbXZQb3NpdGlvbi54eXo7XG5nZW9tZXRyeS5ub3JtYWwgPSBub3JtYWxpemUoIHRyYW5zZm9ybWVkTm9ybWFsICk7XG5nZW9tZXRyeS52aWV3RGlyID0gKCBpc09ydGhvZ3JhcGhpYyApID8gdmVjMyggMCwgMCwgMSApIDogbm9ybWFsaXplKCAtbXZQb3NpdGlvbi54eXogKTtcbkdlb21ldHJpY0NvbnRleHQgYmFja0dlb21ldHJ5O1xuYmFja0dlb21ldHJ5LnBvc2l0aW9uID0gZ2VvbWV0cnkucG9zaXRpb247XG5iYWNrR2VvbWV0cnkubm9ybWFsID0gLWdlb21ldHJ5Lm5vcm1hbDtcbmJhY2tHZW9tZXRyeS52aWV3RGlyID0gZ2VvbWV0cnkudmlld0RpcjtcbnZMaWdodEZyb250ID0gdmVjMyggMC4wICk7XG52SW5kaXJlY3RGcm9udCA9IHZlYzMoIDAuMCApO1xuI2lmZGVmIERPVUJMRV9TSURFRFxuCXZMaWdodEJhY2sgPSB2ZWMzKCAwLjAgKTtcbgl2SW5kaXJlY3RCYWNrID0gdmVjMyggMC4wICk7XG4jZW5kaWZcbkluY2lkZW50TGlnaHQgZGlyZWN0TGlnaHQ7XG5mbG9hdCBkb3ROTDtcbnZlYzMgZGlyZWN0TGlnaHRDb2xvcl9EaWZmdXNlO1xudkluZGlyZWN0RnJvbnQgKz0gZ2V0QW1iaWVudExpZ2h0SXJyYWRpYW5jZSggYW1iaWVudExpZ2h0Q29sb3IgKTtcbnZJbmRpcmVjdEZyb250ICs9IGdldExpZ2h0UHJvYmVJcnJhZGlhbmNlKCBsaWdodFByb2JlLCBnZW9tZXRyeS5ub3JtYWwgKTtcbiNpZmRlZiBET1VCTEVfU0lERURcbgl2SW5kaXJlY3RCYWNrICs9IGdldEFtYmllbnRMaWdodElycmFkaWFuY2UoIGFtYmllbnRMaWdodENvbG9yICk7XG4JdkluZGlyZWN0QmFjayArPSBnZXRMaWdodFByb2JlSXJyYWRpYW5jZSggbGlnaHRQcm9iZSwgYmFja0dlb21ldHJ5Lm5vcm1hbCApO1xuI2VuZGlmXG4jaWYgTlVNX1BPSU5UX0xJR0hUUyA+IDBcbgkjcHJhZ21hIHVucm9sbF9sb29wX3N0YXJ0XG4JZm9yICggaW50IGkgPSAwOyBpIDwgTlVNX1BPSU5UX0xJR0hUUzsgaSArKyApIHtcbgkJZ2V0UG9pbnRMaWdodEluZm8oIHBvaW50TGlnaHRzWyBpIF0sIGdlb21ldHJ5LCBkaXJlY3RMaWdodCApO1xuCQlkb3ROTCA9IGRvdCggZ2VvbWV0cnkubm9ybWFsLCBkaXJlY3RMaWdodC5kaXJlY3Rpb24gKTtcbgkJZGlyZWN0TGlnaHRDb2xvcl9EaWZmdXNlID0gZGlyZWN0TGlnaHQuY29sb3I7XG4JCXZMaWdodEZyb250ICs9IHNhdHVyYXRlKCBkb3ROTCApICogZGlyZWN0TGlnaHRDb2xvcl9EaWZmdXNlO1xuCQkjaWZkZWYgRE9VQkxFX1NJREVEXG4JCQl2TGlnaHRCYWNrICs9IHNhdHVyYXRlKCAtIGRvdE5MICkgKiBkaXJlY3RMaWdodENvbG9yX0RpZmZ1c2U7XG4JCSNlbmRpZlxuCX1cbgkjcHJhZ21hIHVucm9sbF9sb29wX2VuZFxuI2VuZGlmXG4jaWYgTlVNX1NQT1RfTElHSFRTID4gMFxuCSNwcmFnbWEgdW5yb2xsX2xvb3Bfc3RhcnRcbglmb3IgKCBpbnQgaSA9IDA7IGkgPCBOVU1fU1BPVF9MSUdIVFM7IGkgKysgKSB7XG4JCWdldFNwb3RMaWdodEluZm8oIHNwb3RMaWdodHNbIGkgXSwgZ2VvbWV0cnksIGRpcmVjdExpZ2h0ICk7XG4JCWRvdE5MID0gZG90KCBnZW9tZXRyeS5ub3JtYWwsIGRpcmVjdExpZ2h0LmRpcmVjdGlvbiApO1xuCQlkaXJlY3RMaWdodENvbG9yX0RpZmZ1c2UgPSBkaXJlY3RMaWdodC5jb2xvcjtcbgkJdkxpZ2h0RnJvbnQgKz0gc2F0dXJhdGUoIGRvdE5MICkgKiBkaXJlY3RMaWdodENvbG9yX0RpZmZ1c2U7XG4JCSNpZmRlZiBET1VCTEVfU0lERURcbgkJCXZMaWdodEJhY2sgKz0gc2F0dXJhdGUoIC0gZG90TkwgKSAqIGRpcmVjdExpZ2h0Q29sb3JfRGlmZnVzZTtcbgkJI2VuZGlmXG4JfVxuCSNwcmFnbWEgdW5yb2xsX2xvb3BfZW5kXG4jZW5kaWZcbiNpZiBOVU1fRElSX0xJR0hUUyA+IDBcbgkjcHJhZ21hIHVucm9sbF9sb29wX3N0YXJ0XG4JZm9yICggaW50IGkgPSAwOyBpIDwgTlVNX0RJUl9MSUdIVFM7IGkgKysgKSB7XG4JCWdldERpcmVjdGlvbmFsTGlnaHRJbmZvKCBkaXJlY3Rpb25hbExpZ2h0c1sgaSBdLCBnZW9tZXRyeSwgZGlyZWN0TGlnaHQgKTtcbgkJZG90TkwgPSBkb3QoIGdlb21ldHJ5Lm5vcm1hbCwgZGlyZWN0TGlnaHQuZGlyZWN0aW9uICk7XG4JCWRpcmVjdExpZ2h0Q29sb3JfRGlmZnVzZSA9IGRpcmVjdExpZ2h0LmNvbG9yO1xuCQl2TGlnaHRGcm9udCArPSBzYXR1cmF0ZSggZG90TkwgKSAqIGRpcmVjdExpZ2h0Q29sb3JfRGlmZnVzZTtcbgkJI2lmZGVmIERPVUJMRV9TSURFRFxuCQkJdkxpZ2h0QmFjayArPSBzYXR1cmF0ZSggLSBkb3ROTCApICogZGlyZWN0TGlnaHRDb2xvcl9EaWZmdXNlO1xuCQkjZW5kaWZcbgl9XG4JI3ByYWdtYSB1bnJvbGxfbG9vcF9lbmRcbiNlbmRpZlxuI2lmIE5VTV9IRU1JX0xJR0hUUyA+IDBcbgkjcHJhZ21hIHVucm9sbF9sb29wX3N0YXJ0XG4JZm9yICggaW50IGkgPSAwOyBpIDwgTlVNX0hFTUlfTElHSFRTOyBpICsrICkge1xuCQl2SW5kaXJlY3RGcm9udCArPSBnZXRIZW1pc3BoZXJlTGlnaHRJcnJhZGlhbmNlKCBoZW1pc3BoZXJlTGlnaHRzWyBpIF0sIGdlb21ldHJ5Lm5vcm1hbCApO1xuCQkjaWZkZWYgRE9VQkxFX1NJREVEXG4JCQl2SW5kaXJlY3RCYWNrICs9IGdldEhlbWlzcGhlcmVMaWdodElycmFkaWFuY2UoIGhlbWlzcGhlcmVMaWdodHNbIGkgXSwgYmFja0dlb21ldHJ5Lm5vcm1hbCApO1xuCQkjZW5kaWZcbgl9XG4JI3ByYWdtYSB1bnJvbGxfbG9vcF9lbmRcbiNlbmRpZiI7CnZhciBsaWdodHNfcGFyc19iZWdpbiA9ICJ1bmlmb3JtIGJvb2wgcmVjZWl2ZVNoYWRvdztcbnVuaWZvcm0gdmVjMyBhbWJpZW50TGlnaHRDb2xvcjtcbnVuaWZvcm0gdmVjMyBsaWdodFByb2JlWyA5IF07XG52ZWMzIHNoR2V0SXJyYWRpYW5jZUF0KCBpbiB2ZWMzIG5vcm1hbCwgaW4gdmVjMyBzaENvZWZmaWNpZW50c1sgOSBdICkge1xuCWZsb2F0IHggPSBub3JtYWwueCwgeSA9IG5vcm1hbC55LCB6ID0gbm9ybWFsLno7XG4JdmVjMyByZXN1bHQgPSBzaENvZWZmaWNpZW50c1sgMCBdICogMC44ODYyMjc7XG4JcmVzdWx0ICs9IHNoQ29lZmZpY2llbnRzWyAxIF0gKiAyLjAgKiAwLjUxMTY2NCAqIHk7XG4JcmVzdWx0ICs9IHNoQ29lZmZpY2llbnRzWyAyIF0gKiAyLjAgKiAwLjUxMTY2NCAqIHo7XG4JcmVzdWx0ICs9IHNoQ29lZmZpY2llbnRzWyAzIF0gKiAyLjAgKiAwLjUxMTY2NCAqIHg7XG4JcmVzdWx0ICs9IHNoQ29lZmZpY2llbnRzWyA0IF0gKiAyLjAgKiAwLjQyOTA0MyAqIHggKiB5O1xuCXJlc3VsdCArPSBzaENvZWZmaWNpZW50c1sgNSBdICogMi4wICogMC40MjkwNDMgKiB5ICogejtcbglyZXN1bHQgKz0gc2hDb2VmZmljaWVudHNbIDYgXSAqICggMC43NDMxMjUgKiB6ICogeiAtIDAuMjQ3NzA4ICk7XG4JcmVzdWx0ICs9IHNoQ29lZmZpY2llbnRzWyA3IF0gKiAyLjAgKiAwLjQyOTA0MyAqIHggKiB6O1xuCXJlc3VsdCArPSBzaENvZWZmaWNpZW50c1sgOCBdICogMC40MjkwNDMgKiAoIHggKiB4IC0geSAqIHkgKTtcbglyZXR1cm4gcmVzdWx0O1xufVxudmVjMyBnZXRMaWdodFByb2JlSXJyYWRpYW5jZSggY29uc3QgaW4gdmVjMyBsaWdodFByb2JlWyA5IF0sIGNvbnN0IGluIHZlYzMgbm9ybWFsICkge1xuCXZlYzMgd29ybGROb3JtYWwgPSBpbnZlcnNlVHJhbnNmb3JtRGlyZWN0aW9uKCBub3JtYWwsIHZpZXdNYXRyaXggKTtcbgl2ZWMzIGlycmFkaWFuY2UgPSBzaEdldElycmFkaWFuY2VBdCggd29ybGROb3JtYWwsIGxpZ2h0UHJvYmUgKTtcbglyZXR1cm4gaXJyYWRpYW5jZTtcbn1cbnZlYzMgZ2V0QW1iaWVudExpZ2h0SXJyYWRpYW5jZSggY29uc3QgaW4gdmVjMyBhbWJpZW50TGlnaHRDb2xvciApIHtcbgl2ZWMzIGlycmFkaWFuY2UgPSBhbWJpZW50TGlnaHRDb2xvcjtcbglyZXR1cm4gaXJyYWRpYW5jZTtcbn1cbmZsb2F0IGdldERpc3RhbmNlQXR0ZW51YXRpb24oIGNvbnN0IGluIGZsb2F0IGxpZ2h0RGlzdGFuY2UsIGNvbnN0IGluIGZsb2F0IGN1dG9mZkRpc3RhbmNlLCBjb25zdCBpbiBmbG9hdCBkZWNheUV4cG9uZW50ICkge1xuCSNpZiBkZWZpbmVkICggUEhZU0lDQUxMWV9DT1JSRUNUX0xJR0hUUyApXG4JCWZsb2F0IGRpc3RhbmNlRmFsbG9mZiA9IDEuMCAvIG1heCggcG93KCBsaWdodERpc3RhbmNlLCBkZWNheUV4cG9uZW50ICksIDAuMDEgKTtcbgkJaWYgKCBjdXRvZmZEaXN0YW5jZSA+IDAuMCApIHtcbgkJCWRpc3RhbmNlRmFsbG9mZiAqPSBwb3cyKCBzYXR1cmF0ZSggMS4wIC0gcG93NCggbGlnaHREaXN0YW5jZSAvIGN1dG9mZkRpc3RhbmNlICkgKSApO1xuCQl9XG4JCXJldHVybiBkaXN0YW5jZUZhbGxvZmY7XG4JI2Vsc2VcbgkJaWYgKCBjdXRvZmZEaXN0YW5jZSA+IDAuMCAmJiBkZWNheUV4cG9uZW50ID4gMC4wICkge1xuCQkJcmV0dXJuIHBvdyggc2F0dXJhdGUoIC0gbGlnaHREaXN0YW5jZSAvIGN1dG9mZkRpc3RhbmNlICsgMS4wICksIGRlY2F5RXhwb25lbnQgKTtcbgkJfVxuCQlyZXR1cm4gMS4wO1xuCSNlbmRpZlxufVxuZmxvYXQgZ2V0U3BvdEF0dGVudWF0aW9uKCBjb25zdCBpbiBmbG9hdCBjb25lQ29zaW5lLCBjb25zdCBpbiBmbG9hdCBwZW51bWJyYUNvc2luZSwgY29uc3QgaW4gZmxvYXQgYW5nbGVDb3NpbmUgKSB7XG4JcmV0dXJuIHNtb290aHN0ZXAoIGNvbmVDb3NpbmUsIHBlbnVtYnJhQ29zaW5lLCBhbmdsZUNvc2luZSApO1xufVxuI2lmIE5VTV9ESVJfTElHSFRTID4gMFxuCXN0cnVjdCBEaXJlY3Rpb25hbExpZ2h0IHtcbgkJdmVjMyBkaXJlY3Rpb247XG4JCXZlYzMgY29sb3I7XG4JfTtcbgl1bmlmb3JtIERpcmVjdGlvbmFsTGlnaHQgZGlyZWN0aW9uYWxMaWdodHNbIE5VTV9ESVJfTElHSFRTIF07XG4Jdm9pZCBnZXREaXJlY3Rpb25hbExpZ2h0SW5mbyggY29uc3QgaW4gRGlyZWN0aW9uYWxMaWdodCBkaXJlY3Rpb25hbExpZ2h0LCBjb25zdCBpbiBHZW9tZXRyaWNDb250ZXh0IGdlb21ldHJ5LCBvdXQgSW5jaWRlbnRMaWdodCBsaWdodCApIHtcbgkJbGlnaHQuY29sb3IgPSBkaXJlY3Rpb25hbExpZ2h0LmNvbG9yO1xuCQlsaWdodC5kaXJlY3Rpb24gPSBkaXJlY3Rpb25hbExpZ2h0LmRpcmVjdGlvbjtcbgkJbGlnaHQudmlzaWJsZSA9IHRydWU7XG4JfVxuI2VuZGlmXG4jaWYgTlVNX1BPSU5UX0xJR0hUUyA+IDBcbglzdHJ1Y3QgUG9pbnRMaWdodCB7XG4JCXZlYzMgcG9zaXRpb247XG4JCXZlYzMgY29sb3I7XG4JCWZsb2F0IGRpc3RhbmNlO1xuCQlmbG9hdCBkZWNheTtcbgl9O1xuCXVuaWZvcm0gUG9pbnRMaWdodCBwb2ludExpZ2h0c1sgTlVNX1BPSU5UX0xJR0hUUyBdO1xuCXZvaWQgZ2V0UG9pbnRMaWdodEluZm8oIGNvbnN0IGluIFBvaW50TGlnaHQgcG9pbnRMaWdodCwgY29uc3QgaW4gR2VvbWV0cmljQ29udGV4dCBnZW9tZXRyeSwgb3V0IEluY2lkZW50TGlnaHQgbGlnaHQgKSB7XG4JCXZlYzMgbFZlY3RvciA9IHBvaW50TGlnaHQucG9zaXRpb24gLSBnZW9tZXRyeS5wb3NpdGlvbjtcbgkJbGlnaHQuZGlyZWN0aW9uID0gbm9ybWFsaXplKCBsVmVjdG9yICk7XG4JCWZsb2F0IGxpZ2h0RGlzdGFuY2UgPSBsZW5ndGgoIGxWZWN0b3IgKTtcbgkJbGlnaHQuY29sb3IgPSBwb2ludExpZ2h0LmNvbG9yO1xuCQlsaWdodC5jb2xvciAqPSBnZXREaXN0YW5jZUF0dGVudWF0aW9uKCBsaWdodERpc3RhbmNlLCBwb2ludExpZ2h0LmRpc3RhbmNlLCBwb2ludExpZ2h0LmRlY2F5ICk7XG4JCWxpZ2h0LnZpc2libGUgPSAoIGxpZ2h0LmNvbG9yICE9IHZlYzMoIDAuMCApICk7XG4JfVxuI2VuZGlmXG4jaWYgTlVNX1NQT1RfTElHSFRTID4gMFxuCXN0cnVjdCBTcG90TGlnaHQge1xuCQl2ZWMzIHBvc2l0aW9uO1xuCQl2ZWMzIGRpcmVjdGlvbjtcbgkJdmVjMyBjb2xvcjtcbgkJZmxvYXQgZGlzdGFuY2U7XG4JCWZsb2F0IGRlY2F5O1xuCQlmbG9hdCBjb25lQ29zO1xuCQlmbG9hdCBwZW51bWJyYUNvcztcbgl9O1xuCXVuaWZvcm0gU3BvdExpZ2h0IHNwb3RMaWdodHNbIE5VTV9TUE9UX0xJR0hUUyBdO1xuCXZvaWQgZ2V0U3BvdExpZ2h0SW5mbyggY29uc3QgaW4gU3BvdExpZ2h0IHNwb3RMaWdodCwgY29uc3QgaW4gR2VvbWV0cmljQ29udGV4dCBnZW9tZXRyeSwgb3V0IEluY2lkZW50TGlnaHQgbGlnaHQgKSB7XG4JCXZlYzMgbFZlY3RvciA9IHNwb3RMaWdodC5wb3NpdGlvbiAtIGdlb21ldHJ5LnBvc2l0aW9uO1xuCQlsaWdodC5kaXJlY3Rpb24gPSBub3JtYWxpemUoIGxWZWN0b3IgKTtcbgkJZmxvYXQgYW5nbGVDb3MgPSBkb3QoIGxpZ2h0LmRpcmVjdGlvbiwgc3BvdExpZ2h0LmRpcmVjdGlvbiApO1xuCQlmbG9hdCBzcG90QXR0ZW51YXRpb24gPSBnZXRTcG90QXR0ZW51YXRpb24oIHNwb3RMaWdodC5jb25lQ29zLCBzcG90TGlnaHQucGVudW1icmFDb3MsIGFuZ2xlQ29zICk7XG4JCWlmICggc3BvdEF0dGVudWF0aW9uID4gMC4wICkge1xuCQkJZmxvYXQgbGlnaHREaXN0YW5jZSA9IGxlbmd0aCggbFZlY3RvciApO1xuCQkJbGlnaHQuY29sb3IgPSBzcG90TGlnaHQuY29sb3IgKiBzcG90QXR0ZW51YXRpb247XG4JCQlsaWdodC5jb2xvciAqPSBnZXREaXN0YW5jZUF0dGVudWF0aW9uKCBsaWdodERpc3RhbmNlLCBzcG90TGlnaHQuZGlzdGFuY2UsIHNwb3RMaWdodC5kZWNheSApO1xuCQkJbGlnaHQudmlzaWJsZSA9ICggbGlnaHQuY29sb3IgIT0gdmVjMyggMC4wICkgKTtcbgkJfSBlbHNlIHtcbgkJCWxpZ2h0LmNvbG9yID0gdmVjMyggMC4wICk7XG4JCQlsaWdodC52aXNpYmxlID0gZmFsc2U7XG4JCX1cbgl9XG4jZW5kaWZcbiNpZiBOVU1fUkVDVF9BUkVBX0xJR0hUUyA+IDBcbglzdHJ1Y3QgUmVjdEFyZWFMaWdodCB7XG4JCXZlYzMgY29sb3I7XG4JCXZlYzMgcG9zaXRpb247XG4JCXZlYzMgaGFsZldpZHRoO1xuCQl2ZWMzIGhhbGZIZWlnaHQ7XG4JfTtcbgl1bmlmb3JtIHNhbXBsZXIyRCBsdGNfMTsJdW5pZm9ybSBzYW1wbGVyMkQgbHRjXzI7XG4JdW5pZm9ybSBSZWN0QXJlYUxpZ2h0IHJlY3RBcmVhTGlnaHRzWyBOVU1fUkVDVF9BUkVBX0xJR0hUUyBdO1xuI2VuZGlmXG4jaWYgTlVNX0hFTUlfTElHSFRTID4gMFxuCXN0cnVjdCBIZW1pc3BoZXJlTGlnaHQge1xuCQl2ZWMzIGRpcmVjdGlvbjtcbgkJdmVjMyBza3lDb2xvcjtcbgkJdmVjMyBncm91bmRDb2xvcjtcbgl9O1xuCXVuaWZvcm0gSGVtaXNwaGVyZUxpZ2h0IGhlbWlzcGhlcmVMaWdodHNbIE5VTV9IRU1JX0xJR0hUUyBdO1xuCXZlYzMgZ2V0SGVtaXNwaGVyZUxpZ2h0SXJyYWRpYW5jZSggY29uc3QgaW4gSGVtaXNwaGVyZUxpZ2h0IGhlbWlMaWdodCwgY29uc3QgaW4gdmVjMyBub3JtYWwgKSB7XG4JCWZsb2F0IGRvdE5MID0gZG90KCBub3JtYWwsIGhlbWlMaWdodC5kaXJlY3Rpb24gKTtcbgkJZmxvYXQgaGVtaURpZmZ1c2VXZWlnaHQgPSAwLjUgKiBkb3ROTCArIDAuNTtcbgkJdmVjMyBpcnJhZGlhbmNlID0gbWl4KCBoZW1pTGlnaHQuZ3JvdW5kQ29sb3IsIGhlbWlMaWdodC5za3lDb2xvciwgaGVtaURpZmZ1c2VXZWlnaHQgKTtcbgkJcmV0dXJuIGlycmFkaWFuY2U7XG4JfVxuI2VuZGlmIjsKdmFyIGVudm1hcF9waHlzaWNhbF9wYXJzX2ZyYWdtZW50ID0gIiNpZiBkZWZpbmVkKCBVU0VfRU5WTUFQIClcbgkjaWZkZWYgRU5WTUFQX01PREVfUkVGUkFDVElPTlxuCQl1bmlmb3JtIGZsb2F0IHJlZnJhY3Rpb25SYXRpbztcbgkjZW5kaWZcbgl2ZWMzIGdldElCTElycmFkaWFuY2UoIGNvbnN0IGluIHZlYzMgbm9ybWFsICkge1xuCQkjaWYgZGVmaW5lZCggRU5WTUFQX1RZUEVfQ1VCRV9VViApXG4JCQl2ZWMzIHdvcmxkTm9ybWFsID0gaW52ZXJzZVRyYW5zZm9ybURpcmVjdGlvbiggbm9ybWFsLCB2aWV3TWF0cml4ICk7XG4JCQl2ZWM0IGVudk1hcENvbG9yID0gdGV4dHVyZUN1YmVVViggZW52TWFwLCB3b3JsZE5vcm1hbCwgMS4wICk7XG4JCQlyZXR1cm4gUEkgKiBlbnZNYXBDb2xvci5yZ2IgKiBlbnZNYXBJbnRlbnNpdHk7XG4JCSNlbHNlXG4JCQlyZXR1cm4gdmVjMyggMC4wICk7XG4JCSNlbmRpZlxuCX1cbgl2ZWMzIGdldElCTFJhZGlhbmNlKCBjb25zdCBpbiB2ZWMzIHZpZXdEaXIsIGNvbnN0IGluIHZlYzMgbm9ybWFsLCBjb25zdCBpbiBmbG9hdCByb3VnaG5lc3MgKSB7XG4JCSNpZiBkZWZpbmVkKCBFTlZNQVBfVFlQRV9DVUJFX1VWIClcbgkJCXZlYzMgcmVmbGVjdFZlYztcbgkJCSNpZmRlZiBFTlZNQVBfTU9ERV9SRUZMRUNUSU9OXG4JCQkJcmVmbGVjdFZlYyA9IHJlZmxlY3QoIC0gdmlld0Rpciwgbm9ybWFsICk7XG4JCQkJcmVmbGVjdFZlYyA9IG5vcm1hbGl6ZSggbWl4KCByZWZsZWN0VmVjLCBub3JtYWwsIHJvdWdobmVzcyAqIHJvdWdobmVzcykgKTtcbgkJCSNlbHNlXG4JCQkJcmVmbGVjdFZlYyA9IHJlZnJhY3QoIC0gdmlld0Rpciwgbm9ybWFsLCByZWZyYWN0aW9uUmF0aW8gKTtcbgkJCSNlbmRpZlxuCQkJcmVmbGVjdFZlYyA9IGludmVyc2VUcmFuc2Zvcm1EaXJlY3Rpb24oIHJlZmxlY3RWZWMsIHZpZXdNYXRyaXggKTtcbgkJCXZlYzQgZW52TWFwQ29sb3IgPSB0ZXh0dXJlQ3ViZVVWKCBlbnZNYXAsIHJlZmxlY3RWZWMsIHJvdWdobmVzcyApO1xuCQkJcmV0dXJuIGVudk1hcENvbG9yLnJnYiAqIGVudk1hcEludGVuc2l0eTtcbgkJI2Vsc2VcbgkJCXJldHVybiB2ZWMzKCAwLjAgKTtcbgkJI2VuZGlmXG4JfVxuI2VuZGlmIjsKdmFyIGxpZ2h0c190b29uX2ZyYWdtZW50ID0gIlRvb25NYXRlcmlhbCBtYXRlcmlhbDtcbm1hdGVyaWFsLmRpZmZ1c2VDb2xvciA9IGRpZmZ1c2VDb2xvci5yZ2I7IjsKdmFyIGxpZ2h0c190b29uX3BhcnNfZnJhZ21lbnQgPSAidmFyeWluZyB2ZWMzIHZWaWV3UG9zaXRpb247XG5zdHJ1Y3QgVG9vbk1hdGVyaWFsIHtcbgl2ZWMzIGRpZmZ1c2VDb2xvcjtcbn07XG52b2lkIFJFX0RpcmVjdF9Ub29uKCBjb25zdCBpbiBJbmNpZGVudExpZ2h0IGRpcmVjdExpZ2h0LCBjb25zdCBpbiBHZW9tZXRyaWNDb250ZXh0IGdlb21ldHJ5LCBjb25zdCBpbiBUb29uTWF0ZXJpYWwgbWF0ZXJpYWwsIGlub3V0IFJlZmxlY3RlZExpZ2h0IHJlZmxlY3RlZExpZ2h0ICkge1xuCXZlYzMgaXJyYWRpYW5jZSA9IGdldEdyYWRpZW50SXJyYWRpYW5jZSggZ2VvbWV0cnkubm9ybWFsLCBkaXJlY3RMaWdodC5kaXJlY3Rpb24gKSAqIGRpcmVjdExpZ2h0LmNvbG9yO1xuCXJlZmxlY3RlZExpZ2h0LmRpcmVjdERpZmZ1c2UgKz0gaXJyYWRpYW5jZSAqIEJSREZfTGFtYmVydCggbWF0ZXJpYWwuZGlmZnVzZUNvbG9yICk7XG59XG52b2lkIFJFX0luZGlyZWN0RGlmZnVzZV9Ub29uKCBjb25zdCBpbiB2ZWMzIGlycmFkaWFuY2UsIGNvbnN0IGluIEdlb21ldHJpY0NvbnRleHQgZ2VvbWV0cnksIGNvbnN0IGluIFRvb25NYXRlcmlhbCBtYXRlcmlhbCwgaW5vdXQgUmVmbGVjdGVkTGlnaHQgcmVmbGVjdGVkTGlnaHQgKSB7XG4JcmVmbGVjdGVkTGlnaHQuaW5kaXJlY3REaWZmdXNlICs9IGlycmFkaWFuY2UgKiBCUkRGX0xhbWJlcnQoIG1hdGVyaWFsLmRpZmZ1c2VDb2xvciApO1xufVxuI2RlZmluZSBSRV9EaXJlY3QJCQkJUkVfRGlyZWN0X1Rvb25cbiNkZWZpbmUgUkVfSW5kaXJlY3REaWZmdXNlCQlSRV9JbmRpcmVjdERpZmZ1c2VfVG9vblxuI2RlZmluZSBNYXRlcmlhbF9MaWdodFByb2JlTE9EKCBtYXRlcmlhbCApCSgwKSI7CnZhciBsaWdodHNfcGhvbmdfZnJhZ21lbnQgPSAiQmxpbm5QaG9uZ01hdGVyaWFsIG1hdGVyaWFsO1xubWF0ZXJpYWwuZGlmZnVzZUNvbG9yID0gZGlmZnVzZUNvbG9yLnJnYjtcbm1hdGVyaWFsLnNwZWN1bGFyQ29sb3IgPSBzcGVjdWxhcjtcbm1hdGVyaWFsLnNwZWN1bGFyU2hpbmluZXNzID0gc2hpbmluZXNzO1xubWF0ZXJpYWwuc3BlY3VsYXJTdHJlbmd0aCA9IHNwZWN1bGFyU3RyZW5ndGg7IjsKdmFyIGxpZ2h0c19waG9uZ19wYXJzX2ZyYWdtZW50ID0gInZhcnlpbmcgdmVjMyB2Vmlld1Bvc2l0aW9uO1xuc3RydWN0IEJsaW5uUGhvbmdNYXRlcmlhbCB7XG4JdmVjMyBkaWZmdXNlQ29sb3I7XG4JdmVjMyBzcGVjdWxhckNvbG9yO1xuCWZsb2F0IHNwZWN1bGFyU2hpbmluZXNzO1xuCWZsb2F0IHNwZWN1bGFyU3RyZW5ndGg7XG59O1xudm9pZCBSRV9EaXJlY3RfQmxpbm5QaG9uZyggY29uc3QgaW4gSW5jaWRlbnRMaWdodCBkaXJlY3RMaWdodCwgY29uc3QgaW4gR2VvbWV0cmljQ29udGV4dCBnZW9tZXRyeSwgY29uc3QgaW4gQmxpbm5QaG9uZ01hdGVyaWFsIG1hdGVyaWFsLCBpbm91dCBSZWZsZWN0ZWRMaWdodCByZWZsZWN0ZWRMaWdodCApIHtcbglmbG9hdCBkb3ROTCA9IHNhdHVyYXRlKCBkb3QoIGdlb21ldHJ5Lm5vcm1hbCwgZGlyZWN0TGlnaHQuZGlyZWN0aW9uICkgKTtcbgl2ZWMzIGlycmFkaWFuY2UgPSBkb3ROTCAqIGRpcmVjdExpZ2h0LmNvbG9yO1xuCXJlZmxlY3RlZExpZ2h0LmRpcmVjdERpZmZ1c2UgKz0gaXJyYWRpYW5jZSAqIEJSREZfTGFtYmVydCggbWF0ZXJpYWwuZGlmZnVzZUNvbG9yICk7XG4JcmVmbGVjdGVkTGlnaHQuZGlyZWN0U3BlY3VsYXIgKz0gaXJyYWRpYW5jZSAqIEJSREZfQmxpbm5QaG9uZyggZGlyZWN0TGlnaHQuZGlyZWN0aW9uLCBnZW9tZXRyeS52aWV3RGlyLCBnZW9tZXRyeS5ub3JtYWwsIG1hdGVyaWFsLnNwZWN1bGFyQ29sb3IsIG1hdGVyaWFsLnNwZWN1bGFyU2hpbmluZXNzICkgKiBtYXRlcmlhbC5zcGVjdWxhclN0cmVuZ3RoO1xufVxudm9pZCBSRV9JbmRpcmVjdERpZmZ1c2VfQmxpbm5QaG9uZyggY29uc3QgaW4gdmVjMyBpcnJhZGlhbmNlLCBjb25zdCBpbiBHZW9tZXRyaWNDb250ZXh0IGdlb21ldHJ5LCBjb25zdCBpbiBCbGlublBob25nTWF0ZXJpYWwgbWF0ZXJpYWwsIGlub3V0IFJlZmxlY3RlZExpZ2h0IHJlZmxlY3RlZExpZ2h0ICkge1xuCXJlZmxlY3RlZExpZ2h0LmluZGlyZWN0RGlmZnVzZSArPSBpcnJhZGlhbmNlICogQlJERl9MYW1iZXJ0KCBtYXRlcmlhbC5kaWZmdXNlQ29sb3IgKTtcbn1cbiNkZWZpbmUgUkVfRGlyZWN0CQkJCVJFX0RpcmVjdF9CbGlublBob25nXG4jZGVmaW5lIFJFX0luZGlyZWN0RGlmZnVzZQkJUkVfSW5kaXJlY3REaWZmdXNlX0JsaW5uUGhvbmdcbiNkZWZpbmUgTWF0ZXJpYWxfTGlnaHRQcm9iZUxPRCggbWF0ZXJpYWwgKQkoMCkiOwp2YXIgbGlnaHRzX3BoeXNpY2FsX2ZyYWdtZW50ID0gIlBoeXNpY2FsTWF0ZXJpYWwgbWF0ZXJpYWw7XG5tYXRlcmlhbC5kaWZmdXNlQ29sb3IgPSBkaWZmdXNlQ29sb3IucmdiICogKCAxLjAgLSBtZXRhbG5lc3NGYWN0b3IgKTtcbnZlYzMgZHh5ID0gbWF4KCBhYnMoIGRGZHgoIGdlb21ldHJ5Tm9ybWFsICkgKSwgYWJzKCBkRmR5KCBnZW9tZXRyeU5vcm1hbCApICkgKTtcbmZsb2F0IGdlb21ldHJ5Um91Z2huZXNzID0gbWF4KCBtYXgoIGR4eS54LCBkeHkueSApLCBkeHkueiApO1xubWF0ZXJpYWwucm91Z2huZXNzID0gbWF4KCByb3VnaG5lc3NGYWN0b3IsIDAuMDUyNSApO21hdGVyaWFsLnJvdWdobmVzcyArPSBnZW9tZXRyeVJvdWdobmVzcztcbm1hdGVyaWFsLnJvdWdobmVzcyA9IG1pbiggbWF0ZXJpYWwucm91Z2huZXNzLCAxLjAgKTtcbiNpZmRlZiBJT1JcbgkjaWZkZWYgU1BFQ1VMQVJcbgkJZmxvYXQgc3BlY3VsYXJJbnRlbnNpdHlGYWN0b3IgPSBzcGVjdWxhckludGVuc2l0eTtcbgkJdmVjMyBzcGVjdWxhckNvbG9yRmFjdG9yID0gc3BlY3VsYXJDb2xvcjtcbgkJI2lmZGVmIFVTRV9TUEVDVUxBUklOVEVOU0lUWU1BUFxuCQkJc3BlY3VsYXJJbnRlbnNpdHlGYWN0b3IgKj0gdGV4dHVyZTJEKCBzcGVjdWxhckludGVuc2l0eU1hcCwgdlV2ICkuYTtcbgkJI2VuZGlmXG4JCSNpZmRlZiBVU0VfU1BFQ1VMQVJDT0xPUk1BUFxuCQkJc3BlY3VsYXJDb2xvckZhY3RvciAqPSB0ZXh0dXJlMkQoIHNwZWN1bGFyQ29sb3JNYXAsIHZVdiApLnJnYjtcbgkJI2VuZGlmXG4JCW1hdGVyaWFsLnNwZWN1bGFyRjkwID0gbWl4KCBzcGVjdWxhckludGVuc2l0eUZhY3RvciwgMS4wLCBtZXRhbG5lc3NGYWN0b3IgKTtcbgkjZWxzZVxuCQlmbG9hdCBzcGVjdWxhckludGVuc2l0eUZhY3RvciA9IDEuMDtcbgkJdmVjMyBzcGVjdWxhckNvbG9yRmFjdG9yID0gdmVjMyggMS4wICk7XG4JCW1hdGVyaWFsLnNwZWN1bGFyRjkwID0gMS4wO1xuCSNlbmRpZlxuCW1hdGVyaWFsLnNwZWN1bGFyQ29sb3IgPSBtaXgoIG1pbiggcG93MiggKCBpb3IgLSAxLjAgKSAvICggaW9yICsgMS4wICkgKSAqIHNwZWN1bGFyQ29sb3JGYWN0b3IsIHZlYzMoIDEuMCApICkgKiBzcGVjdWxhckludGVuc2l0eUZhY3RvciwgZGlmZnVzZUNvbG9yLnJnYiwgbWV0YWxuZXNzRmFjdG9yICk7XG4jZWxzZVxuCW1hdGVyaWFsLnNwZWN1bGFyQ29sb3IgPSBtaXgoIHZlYzMoIDAuMDQgKSwgZGlmZnVzZUNvbG9yLnJnYiwgbWV0YWxuZXNzRmFjdG9yICk7XG4JbWF0ZXJpYWwuc3BlY3VsYXJGOTAgPSAxLjA7XG4jZW5kaWZcbiNpZmRlZiBVU0VfQ0xFQVJDT0FUXG4JbWF0ZXJpYWwuY2xlYXJjb2F0ID0gY2xlYXJjb2F0O1xuCW1hdGVyaWFsLmNsZWFyY29hdFJvdWdobmVzcyA9IGNsZWFyY29hdFJvdWdobmVzcztcbgltYXRlcmlhbC5jbGVhcmNvYXRGMCA9IHZlYzMoIDAuMDQgKTtcbgltYXRlcmlhbC5jbGVhcmNvYXRGOTAgPSAxLjA7XG4JI2lmZGVmIFVTRV9DTEVBUkNPQVRNQVBcbgkJbWF0ZXJpYWwuY2xlYXJjb2F0ICo9IHRleHR1cmUyRCggY2xlYXJjb2F0TWFwLCB2VXYgKS54O1xuCSNlbmRpZlxuCSNpZmRlZiBVU0VfQ0xFQVJDT0FUX1JPVUdITkVTU01BUFxuCQltYXRlcmlhbC5jbGVhcmNvYXRSb3VnaG5lc3MgKj0gdGV4dHVyZTJEKCBjbGVhcmNvYXRSb3VnaG5lc3NNYXAsIHZVdiApLnk7XG4JI2VuZGlmXG4JbWF0ZXJpYWwuY2xlYXJjb2F0ID0gc2F0dXJhdGUoIG1hdGVyaWFsLmNsZWFyY29hdCApOwltYXRlcmlhbC5jbGVhcmNvYXRSb3VnaG5lc3MgPSBtYXgoIG1hdGVyaWFsLmNsZWFyY29hdFJvdWdobmVzcywgMC4wNTI1ICk7XG4JbWF0ZXJpYWwuY2xlYXJjb2F0Um91Z2huZXNzICs9IGdlb21ldHJ5Um91Z2huZXNzO1xuCW1hdGVyaWFsLmNsZWFyY29hdFJvdWdobmVzcyA9IG1pbiggbWF0ZXJpYWwuY2xlYXJjb2F0Um91Z2huZXNzLCAxLjAgKTtcbiNlbmRpZlxuI2lmZGVmIFVTRV9TSEVFTlxuCW1hdGVyaWFsLnNoZWVuQ29sb3IgPSBzaGVlbkNvbG9yO1xuCSNpZmRlZiBVU0VfU0hFRU5DT0xPUk1BUFxuCQltYXRlcmlhbC5zaGVlbkNvbG9yICo9IHRleHR1cmUyRCggc2hlZW5Db2xvck1hcCwgdlV2ICkucmdiO1xuCSNlbmRpZlxuCW1hdGVyaWFsLnNoZWVuUm91Z2huZXNzID0gY2xhbXAoIHNoZWVuUm91Z2huZXNzLCAwLjA3LCAxLjAgKTtcbgkjaWZkZWYgVVNFX1NIRUVOUk9VR0hORVNTTUFQXG4JCW1hdGVyaWFsLnNoZWVuUm91Z2huZXNzICo9IHRleHR1cmUyRCggc2hlZW5Sb3VnaG5lc3NNYXAsIHZVdiApLmE7XG4JI2VuZGlmXG4jZW5kaWYiOwp2YXIgbGlnaHRzX3BoeXNpY2FsX3BhcnNfZnJhZ21lbnQgPSAic3RydWN0IFBoeXNpY2FsTWF0ZXJpYWwge1xuCXZlYzMgZGlmZnVzZUNvbG9yO1xuCWZsb2F0IHJvdWdobmVzcztcbgl2ZWMzIHNwZWN1bGFyQ29sb3I7XG4JZmxvYXQgc3BlY3VsYXJGOTA7XG4JI2lmZGVmIFVTRV9DTEVBUkNPQVRcbgkJZmxvYXQgY2xlYXJjb2F0O1xuCQlmbG9hdCBjbGVhcmNvYXRSb3VnaG5lc3M7XG4JCXZlYzMgY2xlYXJjb2F0RjA7XG4JCWZsb2F0IGNsZWFyY29hdEY5MDtcbgkjZW5kaWZcbgkjaWZkZWYgVVNFX1NIRUVOXG4JCXZlYzMgc2hlZW5Db2xvcjtcbgkJZmxvYXQgc2hlZW5Sb3VnaG5lc3M7XG4JI2VuZGlmXG59O1xudmVjMyBjbGVhcmNvYXRTcGVjdWxhciA9IHZlYzMoIDAuMCApO1xudmVjMyBzaGVlblNwZWN1bGFyID0gdmVjMyggMC4wICk7XG5mbG9hdCBJQkxTaGVlbkJSREYoIGNvbnN0IGluIHZlYzMgbm9ybWFsLCBjb25zdCBpbiB2ZWMzIHZpZXdEaXIsIGNvbnN0IGluIGZsb2F0IHJvdWdobmVzcykge1xuCWZsb2F0IGRvdE5WID0gc2F0dXJhdGUoIGRvdCggbm9ybWFsLCB2aWV3RGlyICkgKTtcbglmbG9hdCByMiA9IHJvdWdobmVzcyAqIHJvdWdobmVzcztcbglmbG9hdCBhID0gcm91Z2huZXNzIDwgMC4yNSA/IC0zMzkuMiAqIHIyICsgMTYxLjQgKiByb3VnaG5lc3MgLSAyNS45IDogLTguNDggKiByMiArIDE0LjMgKiByb3VnaG5lc3MgLSA5Ljk1O1xuCWZsb2F0IGIgPSByb3VnaG5lc3MgPCAwLjI1ID8gNDQuMCAqIHIyIC0gMjMuNyAqIHJvdWdobmVzcyArIDMuMjYgOiAxLjk3ICogcjIgLSAzLjI3ICogcm91Z2huZXNzICsgMC43MjtcbglmbG9hdCBERyA9IGV4cCggYSAqIGRvdE5WICsgYiApICsgKCByb3VnaG5lc3MgPCAwLjI1ID8gMC4wIDogMC4xICogKCByb3VnaG5lc3MgLSAwLjI1ICkgKTtcbglyZXR1cm4gc2F0dXJhdGUoIERHICogUkVDSVBST0NBTF9QSSApO1xufVxudmVjMiBERkdBcHByb3goIGNvbnN0IGluIHZlYzMgbm9ybWFsLCBjb25zdCBpbiB2ZWMzIHZpZXdEaXIsIGNvbnN0IGluIGZsb2F0IHJvdWdobmVzcyApIHtcbglmbG9hdCBkb3ROViA9IHNhdHVyYXRlKCBkb3QoIG5vcm1hbCwgdmlld0RpciApICk7XG4JY29uc3QgdmVjNCBjMCA9IHZlYzQoIC0gMSwgLSAwLjAyNzUsIC0gMC41NzIsIDAuMDIyICk7XG4JY29uc3QgdmVjNCBjMSA9IHZlYzQoIDEsIDAuMDQyNSwgMS4wNCwgLSAwLjA0ICk7XG4JdmVjNCByID0gcm91Z2huZXNzICogYzAgKyBjMTtcbglmbG9hdCBhMDA0ID0gbWluKCByLnggKiByLngsIGV4cDIoIC0gOS4yOCAqIGRvdE5WICkgKSAqIHIueCArIHIueTtcbgl2ZWMyIGZhYiA9IHZlYzIoIC0gMS4wNCwgMS4wNCApICogYTAwNCArIHIuenc7XG4JcmV0dXJuIGZhYjtcbn1cbnZlYzMgRW52aXJvbm1lbnRCUkRGKCBjb25zdCBpbiB2ZWMzIG5vcm1hbCwgY29uc3QgaW4gdmVjMyB2aWV3RGlyLCBjb25zdCBpbiB2ZWMzIHNwZWN1bGFyQ29sb3IsIGNvbnN0IGluIGZsb2F0IHNwZWN1bGFyRjkwLCBjb25zdCBpbiBmbG9hdCByb3VnaG5lc3MgKSB7XG4JdmVjMiBmYWIgPSBERkdBcHByb3goIG5vcm1hbCwgdmlld0Rpciwgcm91Z2huZXNzICk7XG4JcmV0dXJuIHNwZWN1bGFyQ29sb3IgKiBmYWIueCArIHNwZWN1bGFyRjkwICogZmFiLnk7XG59XG52b2lkIGNvbXB1dGVNdWx0aXNjYXR0ZXJpbmcoIGNvbnN0IGluIHZlYzMgbm9ybWFsLCBjb25zdCBpbiB2ZWMzIHZpZXdEaXIsIGNvbnN0IGluIHZlYzMgc3BlY3VsYXJDb2xvciwgY29uc3QgaW4gZmxvYXQgc3BlY3VsYXJGOTAsIGNvbnN0IGluIGZsb2F0IHJvdWdobmVzcywgaW5vdXQgdmVjMyBzaW5nbGVTY2F0dGVyLCBpbm91dCB2ZWMzIG11bHRpU2NhdHRlciApIHtcbgl2ZWMyIGZhYiA9IERGR0FwcHJveCggbm9ybWFsLCB2aWV3RGlyLCByb3VnaG5lc3MgKTtcbgl2ZWMzIEZzc0VzcyA9IHNwZWN1bGFyQ29sb3IgKiBmYWIueCArIHNwZWN1bGFyRjkwICogZmFiLnk7XG4JZmxvYXQgRXNzID0gZmFiLnggKyBmYWIueTtcbglmbG9hdCBFbXMgPSAxLjAgLSBFc3M7XG4JdmVjMyBGYXZnID0gc3BlY3VsYXJDb2xvciArICggMS4wIC0gc3BlY3VsYXJDb2xvciApICogMC4wNDc2MTk7CXZlYzMgRm1zID0gRnNzRXNzICogRmF2ZyAvICggMS4wIC0gRW1zICogRmF2ZyApO1xuCXNpbmdsZVNjYXR0ZXIgKz0gRnNzRXNzO1xuCW11bHRpU2NhdHRlciArPSBGbXMgKiBFbXM7XG59XG4jaWYgTlVNX1JFQ1RfQVJFQV9MSUdIVFMgPiAwXG4Jdm9pZCBSRV9EaXJlY3RfUmVjdEFyZWFfUGh5c2ljYWwoIGNvbnN0IGluIFJlY3RBcmVhTGlnaHQgcmVjdEFyZWFMaWdodCwgY29uc3QgaW4gR2VvbWV0cmljQ29udGV4dCBnZW9tZXRyeSwgY29uc3QgaW4gUGh5c2ljYWxNYXRlcmlhbCBtYXRlcmlhbCwgaW5vdXQgUmVmbGVjdGVkTGlnaHQgcmVmbGVjdGVkTGlnaHQgKSB7XG4JCXZlYzMgbm9ybWFsID0gZ2VvbWV0cnkubm9ybWFsO1xuCQl2ZWMzIHZpZXdEaXIgPSBnZW9tZXRyeS52aWV3RGlyO1xuCQl2ZWMzIHBvc2l0aW9uID0gZ2VvbWV0cnkucG9zaXRpb247XG4JCXZlYzMgbGlnaHRQb3MgPSByZWN0QXJlYUxpZ2h0LnBvc2l0aW9uO1xuCQl2ZWMzIGhhbGZXaWR0aCA9IHJlY3RBcmVhTGlnaHQuaGFsZldpZHRoO1xuCQl2ZWMzIGhhbGZIZWlnaHQgPSByZWN0QXJlYUxpZ2h0LmhhbGZIZWlnaHQ7XG4JCXZlYzMgbGlnaHRDb2xvciA9IHJlY3RBcmVhTGlnaHQuY29sb3I7XG4JCWZsb2F0IHJvdWdobmVzcyA9IG1hdGVyaWFsLnJvdWdobmVzcztcbgkJdmVjMyByZWN0Q29vcmRzWyA0IF07XG4JCXJlY3RDb29yZHNbIDAgXSA9IGxpZ2h0UG9zICsgaGFsZldpZHRoIC0gaGFsZkhlaWdodDsJCXJlY3RDb29yZHNbIDEgXSA9IGxpZ2h0UG9zIC0gaGFsZldpZHRoIC0gaGFsZkhlaWdodDtcbgkJcmVjdENvb3Jkc1sgMiBdID0gbGlnaHRQb3MgLSBoYWxmV2lkdGggKyBoYWxmSGVpZ2h0O1xuCQlyZWN0Q29vcmRzWyAzIF0gPSBsaWdodFBvcyArIGhhbGZXaWR0aCArIGhhbGZIZWlnaHQ7XG4JCXZlYzIgdXYgPSBMVENfVXYoIG5vcm1hbCwgdmlld0Rpciwgcm91Z2huZXNzICk7XG4JCXZlYzQgdDEgPSB0ZXh0dXJlMkQoIGx0Y18xLCB1diApO1xuCQl2ZWM0IHQyID0gdGV4dHVyZTJEKCBsdGNfMiwgdXYgKTtcbgkJbWF0MyBtSW52ID0gbWF0MyhcbgkJCXZlYzMoIHQxLngsIDAsIHQxLnkgKSxcbgkJCXZlYzMoICAgIDAsIDEsICAgIDAgKSxcbgkJCXZlYzMoIHQxLnosIDAsIHQxLncgKVxuCQkpO1xuCQl2ZWMzIGZyZXNuZWwgPSAoIG1hdGVyaWFsLnNwZWN1bGFyQ29sb3IgKiB0Mi54ICsgKCB2ZWMzKCAxLjAgKSAtIG1hdGVyaWFsLnNwZWN1bGFyQ29sb3IgKSAqIHQyLnkgKTtcbgkJcmVmbGVjdGVkTGlnaHQuZGlyZWN0U3BlY3VsYXIgKz0gbGlnaHRDb2xvciAqIGZyZXNuZWwgKiBMVENfRXZhbHVhdGUoIG5vcm1hbCwgdmlld0RpciwgcG9zaXRpb24sIG1JbnYsIHJlY3RDb29yZHMgKTtcbgkJcmVmbGVjdGVkTGlnaHQuZGlyZWN0RGlmZnVzZSArPSBsaWdodENvbG9yICogbWF0ZXJpYWwuZGlmZnVzZUNvbG9yICogTFRDX0V2YWx1YXRlKCBub3JtYWwsIHZpZXdEaXIsIHBvc2l0aW9uLCBtYXQzKCAxLjAgKSwgcmVjdENvb3JkcyApO1xuCX1cbiNlbmRpZlxudm9pZCBSRV9EaXJlY3RfUGh5c2ljYWwoIGNvbnN0IGluIEluY2lkZW50TGlnaHQgZGlyZWN0TGlnaHQsIGNvbnN0IGluIEdlb21ldHJpY0NvbnRleHQgZ2VvbWV0cnksIGNvbnN0IGluIFBoeXNpY2FsTWF0ZXJpYWwgbWF0ZXJpYWwsIGlub3V0IFJlZmxlY3RlZExpZ2h0IHJlZmxlY3RlZExpZ2h0ICkge1xuCWZsb2F0IGRvdE5MID0gc2F0dXJhdGUoIGRvdCggZ2VvbWV0cnkubm9ybWFsLCBkaXJlY3RMaWdodC5kaXJlY3Rpb24gKSApO1xuCXZlYzMgaXJyYWRpYW5jZSA9IGRvdE5MICogZGlyZWN0TGlnaHQuY29sb3I7XG4JI2lmZGVmIFVTRV9DTEVBUkNPQVRcbgkJZmxvYXQgZG90TkxjYyA9IHNhdHVyYXRlKCBkb3QoIGdlb21ldHJ5LmNsZWFyY29hdE5vcm1hbCwgZGlyZWN0TGlnaHQuZGlyZWN0aW9uICkgKTtcbgkJdmVjMyBjY0lycmFkaWFuY2UgPSBkb3ROTGNjICogZGlyZWN0TGlnaHQuY29sb3I7XG4JCWNsZWFyY29hdFNwZWN1bGFyICs9IGNjSXJyYWRpYW5jZSAqIEJSREZfR0dYKCBkaXJlY3RMaWdodC5kaXJlY3Rpb24sIGdlb21ldHJ5LnZpZXdEaXIsIGdlb21ldHJ5LmNsZWFyY29hdE5vcm1hbCwgbWF0ZXJpYWwuY2xlYXJjb2F0RjAsIG1hdGVyaWFsLmNsZWFyY29hdEY5MCwgbWF0ZXJpYWwuY2xlYXJjb2F0Um91Z2huZXNzICk7XG4JI2VuZGlmXG4JI2lmZGVmIFVTRV9TSEVFTlxuCQlzaGVlblNwZWN1bGFyICs9IGlycmFkaWFuY2UgKiBCUkRGX1NoZWVuKCBkaXJlY3RMaWdodC5kaXJlY3Rpb24sIGdlb21ldHJ5LnZpZXdEaXIsIGdlb21ldHJ5Lm5vcm1hbCwgbWF0ZXJpYWwuc2hlZW5Db2xvciwgbWF0ZXJpYWwuc2hlZW5Sb3VnaG5lc3MgKTtcbgkjZW5kaWZcbglyZWZsZWN0ZWRMaWdodC5kaXJlY3RTcGVjdWxhciArPSBpcnJhZGlhbmNlICogQlJERl9HR1goIGRpcmVjdExpZ2h0LmRpcmVjdGlvbiwgZ2VvbWV0cnkudmlld0RpciwgZ2VvbWV0cnkubm9ybWFsLCBtYXRlcmlhbC5zcGVjdWxhckNvbG9yLCBtYXRlcmlhbC5zcGVjdWxhckY5MCwgbWF0ZXJpYWwucm91Z2huZXNzICk7XG4JcmVmbGVjdGVkTGlnaHQuZGlyZWN0RGlmZnVzZSArPSBpcnJhZGlhbmNlICogQlJERl9MYW1iZXJ0KCBtYXRlcmlhbC5kaWZmdXNlQ29sb3IgKTtcbn1cbnZvaWQgUkVfSW5kaXJlY3REaWZmdXNlX1BoeXNpY2FsKCBjb25zdCBpbiB2ZWMzIGlycmFkaWFuY2UsIGNvbnN0IGluIEdlb21ldHJpY0NvbnRleHQgZ2VvbWV0cnksIGNvbnN0IGluIFBoeXNpY2FsTWF0ZXJpYWwgbWF0ZXJpYWwsIGlub3V0IFJlZmxlY3RlZExpZ2h0IHJlZmxlY3RlZExpZ2h0ICkge1xuCXJlZmxlY3RlZExpZ2h0LmluZGlyZWN0RGlmZnVzZSArPSBpcnJhZGlhbmNlICogQlJERl9MYW1iZXJ0KCBtYXRlcmlhbC5kaWZmdXNlQ29sb3IgKTtcbn1cbnZvaWQgUkVfSW5kaXJlY3RTcGVjdWxhcl9QaHlzaWNhbCggY29uc3QgaW4gdmVjMyByYWRpYW5jZSwgY29uc3QgaW4gdmVjMyBpcnJhZGlhbmNlLCBjb25zdCBpbiB2ZWMzIGNsZWFyY29hdFJhZGlhbmNlLCBjb25zdCBpbiBHZW9tZXRyaWNDb250ZXh0IGdlb21ldHJ5LCBjb25zdCBpbiBQaHlzaWNhbE1hdGVyaWFsIG1hdGVyaWFsLCBpbm91dCBSZWZsZWN0ZWRMaWdodCByZWZsZWN0ZWRMaWdodCkge1xuCSNpZmRlZiBVU0VfQ0xFQVJDT0FUXG4JCWNsZWFyY29hdFNwZWN1bGFyICs9IGNsZWFyY29hdFJhZGlhbmNlICogRW52aXJvbm1lbnRCUkRGKCBnZW9tZXRyeS5jbGVhcmNvYXROb3JtYWwsIGdlb21ldHJ5LnZpZXdEaXIsIG1hdGVyaWFsLmNsZWFyY29hdEYwLCBtYXRlcmlhbC5jbGVhcmNvYXRGOTAsIG1hdGVyaWFsLmNsZWFyY29hdFJvdWdobmVzcyApO1xuCSNlbmRpZlxuCSNpZmRlZiBVU0VfU0hFRU5cbgkJc2hlZW5TcGVjdWxhciArPSBpcnJhZGlhbmNlICogbWF0ZXJpYWwuc2hlZW5Db2xvciAqIElCTFNoZWVuQlJERiggZ2VvbWV0cnkubm9ybWFsLCBnZW9tZXRyeS52aWV3RGlyLCBtYXRlcmlhbC5zaGVlblJvdWdobmVzcyApO1xuCSNlbmRpZlxuCXZlYzMgc2luZ2xlU2NhdHRlcmluZyA9IHZlYzMoIDAuMCApO1xuCXZlYzMgbXVsdGlTY2F0dGVyaW5nID0gdmVjMyggMC4wICk7XG4JdmVjMyBjb3NpbmVXZWlnaHRlZElycmFkaWFuY2UgPSBpcnJhZGlhbmNlICogUkVDSVBST0NBTF9QSTtcbgljb21wdXRlTXVsdGlzY2F0dGVyaW5nKCBnZW9tZXRyeS5ub3JtYWwsIGdlb21ldHJ5LnZpZXdEaXIsIG1hdGVyaWFsLnNwZWN1bGFyQ29sb3IsIG1hdGVyaWFsLnNwZWN1bGFyRjkwLCBtYXRlcmlhbC5yb3VnaG5lc3MsIHNpbmdsZVNjYXR0ZXJpbmcsIG11bHRpU2NhdHRlcmluZyApO1xuCXZlYzMgZGlmZnVzZSA9IG1hdGVyaWFsLmRpZmZ1c2VDb2xvciAqICggMS4wIC0gKCBzaW5nbGVTY2F0dGVyaW5nICsgbXVsdGlTY2F0dGVyaW5nICkgKTtcbglyZWZsZWN0ZWRMaWdodC5pbmRpcmVjdFNwZWN1bGFyICs9IHJhZGlhbmNlICogc2luZ2xlU2NhdHRlcmluZztcbglyZWZsZWN0ZWRMaWdodC5pbmRpcmVjdFNwZWN1bGFyICs9IG11bHRpU2NhdHRlcmluZyAqIGNvc2luZVdlaWdodGVkSXJyYWRpYW5jZTtcbglyZWZsZWN0ZWRMaWdodC5pbmRpcmVjdERpZmZ1c2UgKz0gZGlmZnVzZSAqIGNvc2luZVdlaWdodGVkSXJyYWRpYW5jZTtcbn1cbiNkZWZpbmUgUkVfRGlyZWN0CQkJCVJFX0RpcmVjdF9QaHlzaWNhbFxuI2RlZmluZSBSRV9EaXJlY3RfUmVjdEFyZWEJCVJFX0RpcmVjdF9SZWN0QXJlYV9QaHlzaWNhbFxuI2RlZmluZSBSRV9JbmRpcmVjdERpZmZ1c2UJCVJFX0luZGlyZWN0RGlmZnVzZV9QaHlzaWNhbFxuI2RlZmluZSBSRV9JbmRpcmVjdFNwZWN1bGFyCQlSRV9JbmRpcmVjdFNwZWN1bGFyX1BoeXNpY2FsXG5mbG9hdCBjb21wdXRlU3BlY3VsYXJPY2NsdXNpb24oIGNvbnN0IGluIGZsb2F0IGRvdE5WLCBjb25zdCBpbiBmbG9hdCBhbWJpZW50T2NjbHVzaW9uLCBjb25zdCBpbiBmbG9hdCByb3VnaG5lc3MgKSB7XG4JcmV0dXJuIHNhdHVyYXRlKCBwb3coIGRvdE5WICsgYW1iaWVudE9jY2x1c2lvbiwgZXhwMiggLSAxNi4wICogcm91Z2huZXNzIC0gMS4wICkgKSAtIDEuMCArIGFtYmllbnRPY2NsdXNpb24gKTtcbn0iOwp2YXIgbGlnaHRzX2ZyYWdtZW50X2JlZ2luID0gIlxuR2VvbWV0cmljQ29udGV4dCBnZW9tZXRyeTtcbmdlb21ldHJ5LnBvc2l0aW9uID0gLSB2Vmlld1Bvc2l0aW9uO1xuZ2VvbWV0cnkubm9ybWFsID0gbm9ybWFsO1xuZ2VvbWV0cnkudmlld0RpciA9ICggaXNPcnRob2dyYXBoaWMgKSA/IHZlYzMoIDAsIDAsIDEgKSA6IG5vcm1hbGl6ZSggdlZpZXdQb3NpdGlvbiApO1xuI2lmZGVmIFVTRV9DTEVBUkNPQVRcbglnZW9tZXRyeS5jbGVhcmNvYXROb3JtYWwgPSBjbGVhcmNvYXROb3JtYWw7XG4jZW5kaWZcbkluY2lkZW50TGlnaHQgZGlyZWN0TGlnaHQ7XG4jaWYgKCBOVU1fUE9JTlRfTElHSFRTID4gMCApICYmIGRlZmluZWQoIFJFX0RpcmVjdCApXG4JUG9pbnRMaWdodCBwb2ludExpZ2h0O1xuCSNpZiBkZWZpbmVkKCBVU0VfU0hBRE9XTUFQICkgJiYgTlVNX1BPSU5UX0xJR0hUX1NIQURPV1MgPiAwXG4JUG9pbnRMaWdodFNoYWRvdyBwb2ludExpZ2h0U2hhZG93O1xuCSNlbmRpZlxuCSNwcmFnbWEgdW5yb2xsX2xvb3Bfc3RhcnRcbglmb3IgKCBpbnQgaSA9IDA7IGkgPCBOVU1fUE9JTlRfTElHSFRTOyBpICsrICkge1xuCQlwb2ludExpZ2h0ID0gcG9pbnRMaWdodHNbIGkgXTtcbgkJZ2V0UG9pbnRMaWdodEluZm8oIHBvaW50TGlnaHQsIGdlb21ldHJ5LCBkaXJlY3RMaWdodCApO1xuCQkjaWYgZGVmaW5lZCggVVNFX1NIQURPV01BUCApICYmICggVU5ST0xMRURfTE9PUF9JTkRFWCA8IE5VTV9QT0lOVF9MSUdIVF9TSEFET1dTIClcbgkJcG9pbnRMaWdodFNoYWRvdyA9IHBvaW50TGlnaHRTaGFkb3dzWyBpIF07XG4JCWRpcmVjdExpZ2h0LmNvbG9yICo9IGFsbCggYnZlYzIoIGRpcmVjdExpZ2h0LnZpc2libGUsIHJlY2VpdmVTaGFkb3cgKSApID8gZ2V0UG9pbnRTaGFkb3coIHBvaW50U2hhZG93TWFwWyBpIF0sIHBvaW50TGlnaHRTaGFkb3cuc2hhZG93TWFwU2l6ZSwgcG9pbnRMaWdodFNoYWRvdy5zaGFkb3dCaWFzLCBwb2ludExpZ2h0U2hhZG93LnNoYWRvd1JhZGl1cywgdlBvaW50U2hhZG93Q29vcmRbIGkgXSwgcG9pbnRMaWdodFNoYWRvdy5zaGFkb3dDYW1lcmFOZWFyLCBwb2ludExpZ2h0U2hhZG93LnNoYWRvd0NhbWVyYUZhciApIDogMS4wO1xuCQkjZW5kaWZcbgkJUkVfRGlyZWN0KCBkaXJlY3RMaWdodCwgZ2VvbWV0cnksIG1hdGVyaWFsLCByZWZsZWN0ZWRMaWdodCApO1xuCX1cbgkjcHJhZ21hIHVucm9sbF9sb29wX2VuZFxuI2VuZGlmXG4jaWYgKCBOVU1fU1BPVF9MSUdIVFMgPiAwICkgJiYgZGVmaW5lZCggUkVfRGlyZWN0IClcbglTcG90TGlnaHQgc3BvdExpZ2h0O1xuCSNpZiBkZWZpbmVkKCBVU0VfU0hBRE9XTUFQICkgJiYgTlVNX1NQT1RfTElHSFRfU0hBRE9XUyA+IDBcbglTcG90TGlnaHRTaGFkb3cgc3BvdExpZ2h0U2hhZG93O1xuCSNlbmRpZlxuCSNwcmFnbWEgdW5yb2xsX2xvb3Bfc3RhcnRcbglmb3IgKCBpbnQgaSA9IDA7IGkgPCBOVU1fU1BPVF9MSUdIVFM7IGkgKysgKSB7XG4JCXNwb3RMaWdodCA9IHNwb3RMaWdodHNbIGkgXTtcbgkJZ2V0U3BvdExpZ2h0SW5mbyggc3BvdExpZ2h0LCBnZW9tZXRyeSwgZGlyZWN0TGlnaHQgKTtcbgkJI2lmIGRlZmluZWQoIFVTRV9TSEFET1dNQVAgKSAmJiAoIFVOUk9MTEVEX0xPT1BfSU5ERVggPCBOVU1fU1BPVF9MSUdIVF9TSEFET1dTIClcbgkJc3BvdExpZ2h0U2hhZG93ID0gc3BvdExpZ2h0U2hhZG93c1sgaSBdO1xuCQlkaXJlY3RMaWdodC5jb2xvciAqPSBhbGwoIGJ2ZWMyKCBkaXJlY3RMaWdodC52aXNpYmxlLCByZWNlaXZlU2hhZG93ICkgKSA/IGdldFNoYWRvdyggc3BvdFNoYWRvd01hcFsgaSBdLCBzcG90TGlnaHRTaGFkb3cuc2hhZG93TWFwU2l6ZSwgc3BvdExpZ2h0U2hhZG93LnNoYWRvd0JpYXMsIHNwb3RMaWdodFNoYWRvdy5zaGFkb3dSYWRpdXMsIHZTcG90U2hhZG93Q29vcmRbIGkgXSApIDogMS4wO1xuCQkjZW5kaWZcbgkJUkVfRGlyZWN0KCBkaXJlY3RMaWdodCwgZ2VvbWV0cnksIG1hdGVyaWFsLCByZWZsZWN0ZWRMaWdodCApO1xuCX1cbgkjcHJhZ21hIHVucm9sbF9sb29wX2VuZFxuI2VuZGlmXG4jaWYgKCBOVU1fRElSX0xJR0hUUyA+IDAgKSAmJiBkZWZpbmVkKCBSRV9EaXJlY3QgKVxuCURpcmVjdGlvbmFsTGlnaHQgZGlyZWN0aW9uYWxMaWdodDtcbgkjaWYgZGVmaW5lZCggVVNFX1NIQURPV01BUCApICYmIE5VTV9ESVJfTElHSFRfU0hBRE9XUyA+IDBcbglEaXJlY3Rpb25hbExpZ2h0U2hhZG93IGRpcmVjdGlvbmFsTGlnaHRTaGFkb3c7XG4JI2VuZGlmXG4JI3ByYWdtYSB1bnJvbGxfbG9vcF9zdGFydFxuCWZvciAoIGludCBpID0gMDsgaSA8IE5VTV9ESVJfTElHSFRTOyBpICsrICkge1xuCQlkaXJlY3Rpb25hbExpZ2h0ID0gZGlyZWN0aW9uYWxMaWdodHNbIGkgXTtcbgkJZ2V0RGlyZWN0aW9uYWxMaWdodEluZm8oIGRpcmVjdGlvbmFsTGlnaHQsIGdlb21ldHJ5LCBkaXJlY3RMaWdodCApO1xuCQkjaWYgZGVmaW5lZCggVVNFX1NIQURPV01BUCApICYmICggVU5ST0xMRURfTE9PUF9JTkRFWCA8IE5VTV9ESVJfTElHSFRfU0hBRE9XUyApXG4JCWRpcmVjdGlvbmFsTGlnaHRTaGFkb3cgPSBkaXJlY3Rpb25hbExpZ2h0U2hhZG93c1sgaSBdO1xuCQlkaXJlY3RMaWdodC5jb2xvciAqPSBhbGwoIGJ2ZWMyKCBkaXJlY3RMaWdodC52aXNpYmxlLCByZWNlaXZlU2hhZG93ICkgKSA/IGdldFNoYWRvdyggZGlyZWN0aW9uYWxTaGFkb3dNYXBbIGkgXSwgZGlyZWN0aW9uYWxMaWdodFNoYWRvdy5zaGFkb3dNYXBTaXplLCBkaXJlY3Rpb25hbExpZ2h0U2hhZG93LnNoYWRvd0JpYXMsIGRpcmVjdGlvbmFsTGlnaHRTaGFkb3cuc2hhZG93UmFkaXVzLCB2RGlyZWN0aW9uYWxTaGFkb3dDb29yZFsgaSBdICkgOiAxLjA7XG4JCSNlbmRpZlxuCQlSRV9EaXJlY3QoIGRpcmVjdExpZ2h0LCBnZW9tZXRyeSwgbWF0ZXJpYWwsIHJlZmxlY3RlZExpZ2h0ICk7XG4JfVxuCSNwcmFnbWEgdW5yb2xsX2xvb3BfZW5kXG4jZW5kaWZcbiNpZiAoIE5VTV9SRUNUX0FSRUFfTElHSFRTID4gMCApICYmIGRlZmluZWQoIFJFX0RpcmVjdF9SZWN0QXJlYSApXG4JUmVjdEFyZWFMaWdodCByZWN0QXJlYUxpZ2h0O1xuCSNwcmFnbWEgdW5yb2xsX2xvb3Bfc3RhcnRcbglmb3IgKCBpbnQgaSA9IDA7IGkgPCBOVU1fUkVDVF9BUkVBX0xJR0hUUzsgaSArKyApIHtcbgkJcmVjdEFyZWFMaWdodCA9IHJlY3RBcmVhTGlnaHRzWyBpIF07XG4JCVJFX0RpcmVjdF9SZWN0QXJlYSggcmVjdEFyZWFMaWdodCwgZ2VvbWV0cnksIG1hdGVyaWFsLCByZWZsZWN0ZWRMaWdodCApO1xuCX1cbgkjcHJhZ21hIHVucm9sbF9sb29wX2VuZFxuI2VuZGlmXG4jaWYgZGVmaW5lZCggUkVfSW5kaXJlY3REaWZmdXNlIClcbgl2ZWMzIGlibElycmFkaWFuY2UgPSB2ZWMzKCAwLjAgKTtcbgl2ZWMzIGlycmFkaWFuY2UgPSBnZXRBbWJpZW50TGlnaHRJcnJhZGlhbmNlKCBhbWJpZW50TGlnaHRDb2xvciApO1xuCWlycmFkaWFuY2UgKz0gZ2V0TGlnaHRQcm9iZUlycmFkaWFuY2UoIGxpZ2h0UHJvYmUsIGdlb21ldHJ5Lm5vcm1hbCApO1xuCSNpZiAoIE5VTV9IRU1JX0xJR0hUUyA+IDAgKVxuCQkjcHJhZ21hIHVucm9sbF9sb29wX3N0YXJ0XG4JCWZvciAoIGludCBpID0gMDsgaSA8IE5VTV9IRU1JX0xJR0hUUzsgaSArKyApIHtcbgkJCWlycmFkaWFuY2UgKz0gZ2V0SGVtaXNwaGVyZUxpZ2h0SXJyYWRpYW5jZSggaGVtaXNwaGVyZUxpZ2h0c1sgaSBdLCBnZW9tZXRyeS5ub3JtYWwgKTtcbgkJfVxuCQkjcHJhZ21hIHVucm9sbF9sb29wX2VuZFxuCSNlbmRpZlxuI2VuZGlmXG4jaWYgZGVmaW5lZCggUkVfSW5kaXJlY3RTcGVjdWxhciApXG4JdmVjMyByYWRpYW5jZSA9IHZlYzMoIDAuMCApO1xuCXZlYzMgY2xlYXJjb2F0UmFkaWFuY2UgPSB2ZWMzKCAwLjAgKTtcbiNlbmRpZiI7CnZhciBsaWdodHNfZnJhZ21lbnRfbWFwcyA9ICIjaWYgZGVmaW5lZCggUkVfSW5kaXJlY3REaWZmdXNlIClcbgkjaWZkZWYgVVNFX0xJR0hUTUFQXG4JCXZlYzQgbGlnaHRNYXBUZXhlbCA9IHRleHR1cmUyRCggbGlnaHRNYXAsIHZVdjIgKTtcbgkJdmVjMyBsaWdodE1hcElycmFkaWFuY2UgPSBsaWdodE1hcFRleGVsLnJnYiAqIGxpZ2h0TWFwSW50ZW5zaXR5O1xuCQkjaWZuZGVmIFBIWVNJQ0FMTFlfQ09SUkVDVF9MSUdIVFNcbgkJCWxpZ2h0TWFwSXJyYWRpYW5jZSAqPSBQSTtcbgkJI2VuZGlmXG4JCWlycmFkaWFuY2UgKz0gbGlnaHRNYXBJcnJhZGlhbmNlO1xuCSNlbmRpZlxuCSNpZiBkZWZpbmVkKCBVU0VfRU5WTUFQICkgJiYgZGVmaW5lZCggU1RBTkRBUkQgKSAmJiBkZWZpbmVkKCBFTlZNQVBfVFlQRV9DVUJFX1VWIClcbgkJaWJsSXJyYWRpYW5jZSArPSBnZXRJQkxJcnJhZGlhbmNlKCBnZW9tZXRyeS5ub3JtYWwgKTtcbgkjZW5kaWZcbiNlbmRpZlxuI2lmIGRlZmluZWQoIFVTRV9FTlZNQVAgKSAmJiBkZWZpbmVkKCBSRV9JbmRpcmVjdFNwZWN1bGFyIClcbglyYWRpYW5jZSArPSBnZXRJQkxSYWRpYW5jZSggZ2VvbWV0cnkudmlld0RpciwgZ2VvbWV0cnkubm9ybWFsLCBtYXRlcmlhbC5yb3VnaG5lc3MgKTtcbgkjaWZkZWYgVVNFX0NMRUFSQ09BVFxuCQljbGVhcmNvYXRSYWRpYW5jZSArPSBnZXRJQkxSYWRpYW5jZSggZ2VvbWV0cnkudmlld0RpciwgZ2VvbWV0cnkuY2xlYXJjb2F0Tm9ybWFsLCBtYXRlcmlhbC5jbGVhcmNvYXRSb3VnaG5lc3MgKTtcbgkjZW5kaWZcbiNlbmRpZiI7CnZhciBsaWdodHNfZnJhZ21lbnRfZW5kID0gIiNpZiBkZWZpbmVkKCBSRV9JbmRpcmVjdERpZmZ1c2UgKVxuCVJFX0luZGlyZWN0RGlmZnVzZSggaXJyYWRpYW5jZSwgZ2VvbWV0cnksIG1hdGVyaWFsLCByZWZsZWN0ZWRMaWdodCApO1xuI2VuZGlmXG4jaWYgZGVmaW5lZCggUkVfSW5kaXJlY3RTcGVjdWxhciApXG4JUkVfSW5kaXJlY3RTcGVjdWxhciggcmFkaWFuY2UsIGlibElycmFkaWFuY2UsIGNsZWFyY29hdFJhZGlhbmNlLCBnZW9tZXRyeSwgbWF0ZXJpYWwsIHJlZmxlY3RlZExpZ2h0ICk7XG4jZW5kaWYiOwp2YXIgbG9nZGVwdGhidWZfZnJhZ21lbnQgPSAiI2lmIGRlZmluZWQoIFVTRV9MT0dERVBUSEJVRiApICYmIGRlZmluZWQoIFVTRV9MT0dERVBUSEJVRl9FWFQgKVxuCWdsX0ZyYWdEZXB0aEVYVCA9IHZJc1BlcnNwZWN0aXZlID09IDAuMCA/IGdsX0ZyYWdDb29yZC56IDogbG9nMiggdkZyYWdEZXB0aCApICogbG9nRGVwdGhCdWZGQyAqIDAuNTtcbiNlbmRpZiI7CnZhciBsb2dkZXB0aGJ1Zl9wYXJzX2ZyYWdtZW50ID0gIiNpZiBkZWZpbmVkKCBVU0VfTE9HREVQVEhCVUYgKSAmJiBkZWZpbmVkKCBVU0VfTE9HREVQVEhCVUZfRVhUIClcbgl1bmlmb3JtIGZsb2F0IGxvZ0RlcHRoQnVmRkM7XG4JdmFyeWluZyBmbG9hdCB2RnJhZ0RlcHRoO1xuCXZhcnlpbmcgZmxvYXQgdklzUGVyc3BlY3RpdmU7XG4jZW5kaWYiOwp2YXIgbG9nZGVwdGhidWZfcGFyc192ZXJ0ZXggPSAiI2lmZGVmIFVTRV9MT0dERVBUSEJVRlxuCSNpZmRlZiBVU0VfTE9HREVQVEhCVUZfRVhUXG4JCXZhcnlpbmcgZmxvYXQgdkZyYWdEZXB0aDtcbgkJdmFyeWluZyBmbG9hdCB2SXNQZXJzcGVjdGl2ZTtcbgkjZWxzZVxuCQl1bmlmb3JtIGZsb2F0IGxvZ0RlcHRoQnVmRkM7XG4JI2VuZGlmXG4jZW5kaWYiOwp2YXIgbG9nZGVwdGhidWZfdmVydGV4ID0gIiNpZmRlZiBVU0VfTE9HREVQVEhCVUZcbgkjaWZkZWYgVVNFX0xPR0RFUFRIQlVGX0VYVFxuCQl2RnJhZ0RlcHRoID0gMS4wICsgZ2xfUG9zaXRpb24udztcbgkJdklzUGVyc3BlY3RpdmUgPSBmbG9hdCggaXNQZXJzcGVjdGl2ZU1hdHJpeCggcHJvamVjdGlvbk1hdHJpeCApICk7XG4JI2Vsc2VcbgkJaWYgKCBpc1BlcnNwZWN0aXZlTWF0cml4KCBwcm9qZWN0aW9uTWF0cml4ICkgKSB7XG4JCQlnbF9Qb3NpdGlvbi56ID0gbG9nMiggbWF4KCBFUFNJTE9OLCBnbF9Qb3NpdGlvbi53ICsgMS4wICkgKSAqIGxvZ0RlcHRoQnVmRkMgLSAxLjA7XG4JCQlnbF9Qb3NpdGlvbi56ICo9IGdsX1Bvc2l0aW9uLnc7XG4JCX1cbgkjZW5kaWZcbiNlbmRpZiI7CnZhciBtYXBfZnJhZ21lbnQgPSAiI2lmZGVmIFVTRV9NQVBcbgl2ZWM0IHNhbXBsZWREaWZmdXNlQ29sb3IgPSB0ZXh0dXJlMkQoIG1hcCwgdlV2ICk7XG4JI2lmZGVmIERFQ09ERV9WSURFT19URVhUVVJFXG4JCXNhbXBsZWREaWZmdXNlQ29sb3IgPSB2ZWM0KCBtaXgoIHBvdyggc2FtcGxlZERpZmZ1c2VDb2xvci5yZ2IgKiAwLjk0Nzg2NzI5ODYgKyB2ZWMzKCAwLjA1MjEzMjcwMTQgKSwgdmVjMyggMi40ICkgKSwgc2FtcGxlZERpZmZ1c2VDb2xvci5yZ2IgKiAwLjA3NzM5OTM4MDgsIHZlYzMoIGxlc3NUaGFuRXF1YWwoIHNhbXBsZWREaWZmdXNlQ29sb3IucmdiLCB2ZWMzKCAwLjA0MDQ1ICkgKSApICksIHNhbXBsZWREaWZmdXNlQ29sb3IudyApO1xuCSNlbmRpZlxuCWRpZmZ1c2VDb2xvciAqPSBzYW1wbGVkRGlmZnVzZUNvbG9yO1xuI2VuZGlmIjsKdmFyIG1hcF9wYXJzX2ZyYWdtZW50ID0gIiNpZmRlZiBVU0VfTUFQXG4JdW5pZm9ybSBzYW1wbGVyMkQgbWFwO1xuI2VuZGlmIjsKdmFyIG1hcF9wYXJ0aWNsZV9mcmFnbWVudCA9ICIjaWYgZGVmaW5lZCggVVNFX01BUCApIHx8IGRlZmluZWQoIFVTRV9BTFBIQU1BUCApXG4JdmVjMiB1diA9ICggdXZUcmFuc2Zvcm0gKiB2ZWMzKCBnbF9Qb2ludENvb3JkLngsIDEuMCAtIGdsX1BvaW50Q29vcmQueSwgMSApICkueHk7XG4jZW5kaWZcbiNpZmRlZiBVU0VfTUFQXG4JZGlmZnVzZUNvbG9yICo9IHRleHR1cmUyRCggbWFwLCB1diApO1xuI2VuZGlmXG4jaWZkZWYgVVNFX0FMUEhBTUFQXG4JZGlmZnVzZUNvbG9yLmEgKj0gdGV4dHVyZTJEKCBhbHBoYU1hcCwgdXYgKS5nO1xuI2VuZGlmIjsKdmFyIG1hcF9wYXJ0aWNsZV9wYXJzX2ZyYWdtZW50ID0gIiNpZiBkZWZpbmVkKCBVU0VfTUFQICkgfHwgZGVmaW5lZCggVVNFX0FMUEhBTUFQIClcbgl1bmlmb3JtIG1hdDMgdXZUcmFuc2Zvcm07XG4jZW5kaWZcbiNpZmRlZiBVU0VfTUFQXG4JdW5pZm9ybSBzYW1wbGVyMkQgbWFwO1xuI2VuZGlmXG4jaWZkZWYgVVNFX0FMUEhBTUFQXG4JdW5pZm9ybSBzYW1wbGVyMkQgYWxwaGFNYXA7XG4jZW5kaWYiOwp2YXIgbWV0YWxuZXNzbWFwX2ZyYWdtZW50ID0gImZsb2F0IG1ldGFsbmVzc0ZhY3RvciA9IG1ldGFsbmVzcztcbiNpZmRlZiBVU0VfTUVUQUxORVNTTUFQXG4JdmVjNCB0ZXhlbE1ldGFsbmVzcyA9IHRleHR1cmUyRCggbWV0YWxuZXNzTWFwLCB2VXYgKTtcbgltZXRhbG5lc3NGYWN0b3IgKj0gdGV4ZWxNZXRhbG5lc3MuYjtcbiNlbmRpZiI7CnZhciBtZXRhbG5lc3NtYXBfcGFyc19mcmFnbWVudCA9ICIjaWZkZWYgVVNFX01FVEFMTkVTU01BUFxuCXVuaWZvcm0gc2FtcGxlcjJEIG1ldGFsbmVzc01hcDtcbiNlbmRpZiI7CnZhciBtb3JwaG5vcm1hbF92ZXJ0ZXggPSAiI2lmZGVmIFVTRV9NT1JQSE5PUk1BTFNcbglvYmplY3ROb3JtYWwgKj0gbW9ycGhUYXJnZXRCYXNlSW5mbHVlbmNlO1xuCSNpZmRlZiBNT1JQSFRBUkdFVFNfVEVYVFVSRVxuCQlmb3IgKCBpbnQgaSA9IDA7IGkgPCBNT1JQSFRBUkdFVFNfQ09VTlQ7IGkgKysgKSB7XG4JCQlpZiAoIG1vcnBoVGFyZ2V0SW5mbHVlbmNlc1sgaSBdICE9IDAuMCApIG9iamVjdE5vcm1hbCArPSBnZXRNb3JwaCggZ2xfVmVydGV4SUQsIGksIDEsIDIgKSAqIG1vcnBoVGFyZ2V0SW5mbHVlbmNlc1sgaSBdO1xuCQl9XG4JI2Vsc2VcbgkJb2JqZWN0Tm9ybWFsICs9IG1vcnBoTm9ybWFsMCAqIG1vcnBoVGFyZ2V0SW5mbHVlbmNlc1sgMCBdO1xuCQlvYmplY3ROb3JtYWwgKz0gbW9ycGhOb3JtYWwxICogbW9ycGhUYXJnZXRJbmZsdWVuY2VzWyAxIF07XG4JCW9iamVjdE5vcm1hbCArPSBtb3JwaE5vcm1hbDIgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDIgXTtcbgkJb2JqZWN0Tm9ybWFsICs9IG1vcnBoTm9ybWFsMyAqIG1vcnBoVGFyZ2V0SW5mbHVlbmNlc1sgMyBdO1xuCSNlbmRpZlxuI2VuZGlmIjsKdmFyIG1vcnBodGFyZ2V0X3BhcnNfdmVydGV4ID0gIiNpZmRlZiBVU0VfTU9SUEhUQVJHRVRTXG4JdW5pZm9ybSBmbG9hdCBtb3JwaFRhcmdldEJhc2VJbmZsdWVuY2U7XG4JI2lmZGVmIE1PUlBIVEFSR0VUU19URVhUVVJFXG4JCXVuaWZvcm0gZmxvYXQgbW9ycGhUYXJnZXRJbmZsdWVuY2VzWyBNT1JQSFRBUkdFVFNfQ09VTlQgXTtcbgkJdW5pZm9ybSBzYW1wbGVyMkRBcnJheSBtb3JwaFRhcmdldHNUZXh0dXJlO1xuCQl1bmlmb3JtIHZlYzIgbW9ycGhUYXJnZXRzVGV4dHVyZVNpemU7XG4JCXZlYzMgZ2V0TW9ycGgoIGNvbnN0IGluIGludCB2ZXJ0ZXhJbmRleCwgY29uc3QgaW4gaW50IG1vcnBoVGFyZ2V0SW5kZXgsIGNvbnN0IGluIGludCBvZmZzZXQsIGNvbnN0IGluIGludCBzdHJpZGUgKSB7XG4JCQlmbG9hdCB0ZXhlbEluZGV4ID0gZmxvYXQoIHZlcnRleEluZGV4ICogc3RyaWRlICsgb2Zmc2V0ICk7XG4JCQlmbG9hdCB5ID0gZmxvb3IoIHRleGVsSW5kZXggLyBtb3JwaFRhcmdldHNUZXh0dXJlU2l6ZS54ICk7XG4JCQlmbG9hdCB4ID0gdGV4ZWxJbmRleCAtIHkgKiBtb3JwaFRhcmdldHNUZXh0dXJlU2l6ZS54O1xuCQkJdmVjMyBtb3JwaFVWID0gdmVjMyggKCB4ICsgMC41ICkgLyBtb3JwaFRhcmdldHNUZXh0dXJlU2l6ZS54LCB5IC8gbW9ycGhUYXJnZXRzVGV4dHVyZVNpemUueSwgbW9ycGhUYXJnZXRJbmRleCApO1xuCQkJcmV0dXJuIHRleHR1cmUoIG1vcnBoVGFyZ2V0c1RleHR1cmUsIG1vcnBoVVYgKS54eXo7XG4JCX1cbgkjZWxzZVxuCQkjaWZuZGVmIFVTRV9NT1JQSE5PUk1BTFNcbgkJCXVuaWZvcm0gZmxvYXQgbW9ycGhUYXJnZXRJbmZsdWVuY2VzWyA4IF07XG4JCSNlbHNlXG4JCQl1bmlmb3JtIGZsb2F0IG1vcnBoVGFyZ2V0SW5mbHVlbmNlc1sgNCBdO1xuCQkjZW5kaWZcbgkjZW5kaWZcbiNlbmRpZiI7CnZhciBtb3JwaHRhcmdldF92ZXJ0ZXggPSAiI2lmZGVmIFVTRV9NT1JQSFRBUkdFVFNcbgl0cmFuc2Zvcm1lZCAqPSBtb3JwaFRhcmdldEJhc2VJbmZsdWVuY2U7XG4JI2lmZGVmIE1PUlBIVEFSR0VUU19URVhUVVJFXG4JCWZvciAoIGludCBpID0gMDsgaSA8IE1PUlBIVEFSR0VUU19DT1VOVDsgaSArKyApIHtcbgkJCSNpZm5kZWYgVVNFX01PUlBITk9STUFMU1xuCQkJCWlmICggbW9ycGhUYXJnZXRJbmZsdWVuY2VzWyBpIF0gIT0gMC4wICkgdHJhbnNmb3JtZWQgKz0gZ2V0TW9ycGgoIGdsX1ZlcnRleElELCBpLCAwLCAxICkgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIGkgXTtcbgkJCSNlbHNlXG4JCQkJaWYgKCBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIGkgXSAhPSAwLjAgKSB0cmFuc2Zvcm1lZCArPSBnZXRNb3JwaCggZ2xfVmVydGV4SUQsIGksIDAsIDIgKSAqIG1vcnBoVGFyZ2V0SW5mbHVlbmNlc1sgaSBdO1xuCQkJI2VuZGlmXG4JCX1cbgkjZWxzZVxuCQl0cmFuc2Zvcm1lZCArPSBtb3JwaFRhcmdldDAgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDAgXTtcbgkJdHJhbnNmb3JtZWQgKz0gbW9ycGhUYXJnZXQxICogbW9ycGhUYXJnZXRJbmZsdWVuY2VzWyAxIF07XG4JCXRyYW5zZm9ybWVkICs9IG1vcnBoVGFyZ2V0MiAqIG1vcnBoVGFyZ2V0SW5mbHVlbmNlc1sgMiBdO1xuCQl0cmFuc2Zvcm1lZCArPSBtb3JwaFRhcmdldDMgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDMgXTtcbgkJI2lmbmRlZiBVU0VfTU9SUEhOT1JNQUxTXG4JCQl0cmFuc2Zvcm1lZCArPSBtb3JwaFRhcmdldDQgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDQgXTtcbgkJCXRyYW5zZm9ybWVkICs9IG1vcnBoVGFyZ2V0NSAqIG1vcnBoVGFyZ2V0SW5mbHVlbmNlc1sgNSBdO1xuCQkJdHJhbnNmb3JtZWQgKz0gbW9ycGhUYXJnZXQ2ICogbW9ycGhUYXJnZXRJbmZsdWVuY2VzWyA2IF07XG4JCQl0cmFuc2Zvcm1lZCArPSBtb3JwaFRhcmdldDcgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDcgXTtcbgkJI2VuZGlmXG4JI2VuZGlmXG4jZW5kaWYiOwp2YXIgbm9ybWFsX2ZyYWdtZW50X2JlZ2luID0gImZsb2F0IGZhY2VEaXJlY3Rpb24gPSBnbF9Gcm9udEZhY2luZyA/IDEuMCA6IC0gMS4wO1xuI2lmZGVmIEZMQVRfU0hBREVEXG4JdmVjMyBmZHggPSB2ZWMzKCBkRmR4KCB2Vmlld1Bvc2l0aW9uLnggKSwgZEZkeCggdlZpZXdQb3NpdGlvbi55ICksIGRGZHgoIHZWaWV3UG9zaXRpb24ueiApICk7XG4JdmVjMyBmZHkgPSB2ZWMzKCBkRmR5KCB2Vmlld1Bvc2l0aW9uLnggKSwgZEZkeSggdlZpZXdQb3NpdGlvbi55ICksIGRGZHkoIHZWaWV3UG9zaXRpb24ueiApICk7XG4JdmVjMyBub3JtYWwgPSBub3JtYWxpemUoIGNyb3NzKCBmZHgsIGZkeSApICk7XG4jZWxzZVxuCXZlYzMgbm9ybWFsID0gbm9ybWFsaXplKCB2Tm9ybWFsICk7XG4JI2lmZGVmIERPVUJMRV9TSURFRFxuCQlub3JtYWwgPSBub3JtYWwgKiBmYWNlRGlyZWN0aW9uO1xuCSNlbmRpZlxuCSNpZmRlZiBVU0VfVEFOR0VOVFxuCQl2ZWMzIHRhbmdlbnQgPSBub3JtYWxpemUoIHZUYW5nZW50ICk7XG4JCXZlYzMgYml0YW5nZW50ID0gbm9ybWFsaXplKCB2Qml0YW5nZW50ICk7XG4JCSNpZmRlZiBET1VCTEVfU0lERURcbgkJCXRhbmdlbnQgPSB0YW5nZW50ICogZmFjZURpcmVjdGlvbjtcbgkJCWJpdGFuZ2VudCA9IGJpdGFuZ2VudCAqIGZhY2VEaXJlY3Rpb247XG4JCSNlbmRpZlxuCQkjaWYgZGVmaW5lZCggVEFOR0VOVFNQQUNFX05PUk1BTE1BUCApIHx8IGRlZmluZWQoIFVTRV9DTEVBUkNPQVRfTk9STUFMTUFQIClcbgkJCW1hdDMgdlRCTiA9IG1hdDMoIHRhbmdlbnQsIGJpdGFuZ2VudCwgbm9ybWFsICk7XG4JCSNlbmRpZlxuCSNlbmRpZlxuI2VuZGlmXG52ZWMzIGdlb21ldHJ5Tm9ybWFsID0gbm9ybWFsOyI7CnZhciBub3JtYWxfZnJhZ21lbnRfbWFwcyA9ICIjaWZkZWYgT0JKRUNUU1BBQ0VfTk9STUFMTUFQXG4Jbm9ybWFsID0gdGV4dHVyZTJEKCBub3JtYWxNYXAsIHZVdiApLnh5eiAqIDIuMCAtIDEuMDtcbgkjaWZkZWYgRkxJUF9TSURFRFxuCQlub3JtYWwgPSAtIG5vcm1hbDtcbgkjZW5kaWZcbgkjaWZkZWYgRE9VQkxFX1NJREVEXG4JCW5vcm1hbCA9IG5vcm1hbCAqIGZhY2VEaXJlY3Rpb247XG4JI2VuZGlmXG4Jbm9ybWFsID0gbm9ybWFsaXplKCBub3JtYWxNYXRyaXggKiBub3JtYWwgKTtcbiNlbGlmIGRlZmluZWQoIFRBTkdFTlRTUEFDRV9OT1JNQUxNQVAgKVxuCXZlYzMgbWFwTiA9IHRleHR1cmUyRCggbm9ybWFsTWFwLCB2VXYgKS54eXogKiAyLjAgLSAxLjA7XG4JbWFwTi54eSAqPSBub3JtYWxTY2FsZTtcbgkjaWZkZWYgVVNFX1RBTkdFTlRcbgkJbm9ybWFsID0gbm9ybWFsaXplKCB2VEJOICogbWFwTiApO1xuCSNlbHNlXG4JCW5vcm1hbCA9IHBlcnR1cmJOb3JtYWwyQXJiKCAtIHZWaWV3UG9zaXRpb24sIG5vcm1hbCwgbWFwTiwgZmFjZURpcmVjdGlvbiApO1xuCSNlbmRpZlxuI2VsaWYgZGVmaW5lZCggVVNFX0JVTVBNQVAgKVxuCW5vcm1hbCA9IHBlcnR1cmJOb3JtYWxBcmIoIC0gdlZpZXdQb3NpdGlvbiwgbm9ybWFsLCBkSGR4eV9md2QoKSwgZmFjZURpcmVjdGlvbiApO1xuI2VuZGlmIjsKdmFyIG5vcm1hbF9wYXJzX2ZyYWdtZW50ID0gIiNpZm5kZWYgRkxBVF9TSEFERURcbgl2YXJ5aW5nIHZlYzMgdk5vcm1hbDtcbgkjaWZkZWYgVVNFX1RBTkdFTlRcbgkJdmFyeWluZyB2ZWMzIHZUYW5nZW50O1xuCQl2YXJ5aW5nIHZlYzMgdkJpdGFuZ2VudDtcbgkjZW5kaWZcbiNlbmRpZiI7CnZhciBub3JtYWxfcGFyc192ZXJ0ZXggPSAiI2lmbmRlZiBGTEFUX1NIQURFRFxuCXZhcnlpbmcgdmVjMyB2Tm9ybWFsO1xuCSNpZmRlZiBVU0VfVEFOR0VOVFxuCQl2YXJ5aW5nIHZlYzMgdlRhbmdlbnQ7XG4JCXZhcnlpbmcgdmVjMyB2Qml0YW5nZW50O1xuCSNlbmRpZlxuI2VuZGlmIjsKdmFyIG5vcm1hbF92ZXJ0ZXggPSAiI2lmbmRlZiBGTEFUX1NIQURFRFxuCXZOb3JtYWwgPSBub3JtYWxpemUoIHRyYW5zZm9ybWVkTm9ybWFsICk7XG4JI2lmZGVmIFVTRV9UQU5HRU5UXG4JCXZUYW5nZW50ID0gbm9ybWFsaXplKCB0cmFuc2Zvcm1lZFRhbmdlbnQgKTtcbgkJdkJpdGFuZ2VudCA9IG5vcm1hbGl6ZSggY3Jvc3MoIHZOb3JtYWwsIHZUYW5nZW50ICkgKiB0YW5nZW50LncgKTtcbgkjZW5kaWZcbiNlbmRpZiI7CnZhciBub3JtYWxtYXBfcGFyc19mcmFnbWVudCA9ICIjaWZkZWYgVVNFX05PUk1BTE1BUFxuCXVuaWZvcm0gc2FtcGxlcjJEIG5vcm1hbE1hcDtcbgl1bmlmb3JtIHZlYzIgbm9ybWFsU2NhbGU7XG4jZW5kaWZcbiNpZmRlZiBPQkpFQ1RTUEFDRV9OT1JNQUxNQVBcbgl1bmlmb3JtIG1hdDMgbm9ybWFsTWF0cml4O1xuI2VuZGlmXG4jaWYgISBkZWZpbmVkICggVVNFX1RBTkdFTlQgKSAmJiAoIGRlZmluZWQgKCBUQU5HRU5UU1BBQ0VfTk9STUFMTUFQICkgfHwgZGVmaW5lZCAoIFVTRV9DTEVBUkNPQVRfTk9STUFMTUFQICkgKVxuCXZlYzMgcGVydHVyYk5vcm1hbDJBcmIoIHZlYzMgZXllX3BvcywgdmVjMyBzdXJmX25vcm0sIHZlYzMgbWFwTiwgZmxvYXQgZmFjZURpcmVjdGlvbiApIHtcbgkJdmVjMyBxMCA9IHZlYzMoIGRGZHgoIGV5ZV9wb3MueCApLCBkRmR4KCBleWVfcG9zLnkgKSwgZEZkeCggZXllX3Bvcy56ICkgKTtcbgkJdmVjMyBxMSA9IHZlYzMoIGRGZHkoIGV5ZV9wb3MueCApLCBkRmR5KCBleWVfcG9zLnkgKSwgZEZkeSggZXllX3Bvcy56ICkgKTtcbgkJdmVjMiBzdDAgPSBkRmR4KCB2VXYuc3QgKTtcbgkJdmVjMiBzdDEgPSBkRmR5KCB2VXYuc3QgKTtcbgkJdmVjMyBOID0gc3VyZl9ub3JtO1xuCQl2ZWMzIHExcGVycCA9IGNyb3NzKCBxMSwgTiApO1xuCQl2ZWMzIHEwcGVycCA9IGNyb3NzKCBOLCBxMCApO1xuCQl2ZWMzIFQgPSBxMXBlcnAgKiBzdDAueCArIHEwcGVycCAqIHN0MS54O1xuCQl2ZWMzIEIgPSBxMXBlcnAgKiBzdDAueSArIHEwcGVycCAqIHN0MS55O1xuCQlmbG9hdCBkZXQgPSBtYXgoIGRvdCggVCwgVCApLCBkb3QoIEIsIEIgKSApO1xuCQlmbG9hdCBzY2FsZSA9ICggZGV0ID09IDAuMCApID8gMC4wIDogZmFjZURpcmVjdGlvbiAqIGludmVyc2VzcXJ0KCBkZXQgKTtcbgkJcmV0dXJuIG5vcm1hbGl6ZSggVCAqICggbWFwTi54ICogc2NhbGUgKSArIEIgKiAoIG1hcE4ueSAqIHNjYWxlICkgKyBOICogbWFwTi56ICk7XG4JfVxuI2VuZGlmIjsKdmFyIGNsZWFyY29hdF9ub3JtYWxfZnJhZ21lbnRfYmVnaW4gPSAiI2lmZGVmIFVTRV9DTEVBUkNPQVRcbgl2ZWMzIGNsZWFyY29hdE5vcm1hbCA9IGdlb21ldHJ5Tm9ybWFsO1xuI2VuZGlmIjsKdmFyIGNsZWFyY29hdF9ub3JtYWxfZnJhZ21lbnRfbWFwcyA9ICIjaWZkZWYgVVNFX0NMRUFSQ09BVF9OT1JNQUxNQVBcbgl2ZWMzIGNsZWFyY29hdE1hcE4gPSB0ZXh0dXJlMkQoIGNsZWFyY29hdE5vcm1hbE1hcCwgdlV2ICkueHl6ICogMi4wIC0gMS4wO1xuCWNsZWFyY29hdE1hcE4ueHkgKj0gY2xlYXJjb2F0Tm9ybWFsU2NhbGU7XG4JI2lmZGVmIFVTRV9UQU5HRU5UXG4JCWNsZWFyY29hdE5vcm1hbCA9IG5vcm1hbGl6ZSggdlRCTiAqIGNsZWFyY29hdE1hcE4gKTtcbgkjZWxzZVxuCQljbGVhcmNvYXROb3JtYWwgPSBwZXJ0dXJiTm9ybWFsMkFyYiggLSB2Vmlld1Bvc2l0aW9uLCBjbGVhcmNvYXROb3JtYWwsIGNsZWFyY29hdE1hcE4sIGZhY2VEaXJlY3Rpb24gKTtcbgkjZW5kaWZcbiNlbmRpZiI7CnZhciBjbGVhcmNvYXRfcGFyc19mcmFnbWVudCA9ICIjaWZkZWYgVVNFX0NMRUFSQ09BVE1BUFxuCXVuaWZvcm0gc2FtcGxlcjJEIGNsZWFyY29hdE1hcDtcbiNlbmRpZlxuI2lmZGVmIFVTRV9DTEVBUkNPQVRfUk9VR0hORVNTTUFQXG4JdW5pZm9ybSBzYW1wbGVyMkQgY2xlYXJjb2F0Um91Z2huZXNzTWFwO1xuI2VuZGlmXG4jaWZkZWYgVVNFX0NMRUFSQ09BVF9OT1JNQUxNQVBcbgl1bmlmb3JtIHNhbXBsZXIyRCBjbGVhcmNvYXROb3JtYWxNYXA7XG4JdW5pZm9ybSB2ZWMyIGNsZWFyY29hdE5vcm1hbFNjYWxlO1xuI2VuZGlmIjsKdmFyIG91dHB1dF9mcmFnbWVudCA9ICIjaWZkZWYgT1BBUVVFXG5kaWZmdXNlQ29sb3IuYSA9IDEuMDtcbiNlbmRpZlxuI2lmZGVmIFVTRV9UUkFOU01JU1NJT05cbmRpZmZ1c2VDb2xvci5hICo9IHRyYW5zbWlzc2lvbkFscGhhICsgMC4xO1xuI2VuZGlmXG5nbF9GcmFnQ29sb3IgPSB2ZWM0KCBvdXRnb2luZ0xpZ2h0LCBkaWZmdXNlQ29sb3IuYSApOyI7CnZhciBwYWNraW5nID0gInZlYzMgcGFja05vcm1hbFRvUkdCKCBjb25zdCBpbiB2ZWMzIG5vcm1hbCApIHtcbglyZXR1cm4gbm9ybWFsaXplKCBub3JtYWwgKSAqIDAuNSArIDAuNTtcbn1cbnZlYzMgdW5wYWNrUkdCVG9Ob3JtYWwoIGNvbnN0IGluIHZlYzMgcmdiICkge1xuCXJldHVybiAyLjAgKiByZ2IueHl6IC0gMS4wO1xufVxuY29uc3QgZmxvYXQgUGFja1Vwc2NhbGUgPSAyNTYuIC8gMjU1Ljtjb25zdCBmbG9hdCBVbnBhY2tEb3duc2NhbGUgPSAyNTUuIC8gMjU2LjtcbmNvbnN0IHZlYzMgUGFja0ZhY3RvcnMgPSB2ZWMzKCAyNTYuICogMjU2LiAqIDI1Ni4sIDI1Ni4gKiAyNTYuLCAyNTYuICk7XG5jb25zdCB2ZWM0IFVucGFja0ZhY3RvcnMgPSBVbnBhY2tEb3duc2NhbGUgLyB2ZWM0KCBQYWNrRmFjdG9ycywgMS4gKTtcbmNvbnN0IGZsb2F0IFNoaWZ0UmlnaHQ4ID0gMS4gLyAyNTYuO1xudmVjNCBwYWNrRGVwdGhUb1JHQkEoIGNvbnN0IGluIGZsb2F0IHYgKSB7XG4JdmVjNCByID0gdmVjNCggZnJhY3QoIHYgKiBQYWNrRmFjdG9ycyApLCB2ICk7XG4Jci55encgLT0gci54eXogKiBTaGlmdFJpZ2h0ODsJcmV0dXJuIHIgKiBQYWNrVXBzY2FsZTtcbn1cbmZsb2F0IHVucGFja1JHQkFUb0RlcHRoKCBjb25zdCBpbiB2ZWM0IHYgKSB7XG4JcmV0dXJuIGRvdCggdiwgVW5wYWNrRmFjdG9ycyApO1xufVxudmVjNCBwYWNrMkhhbGZUb1JHQkEoIHZlYzIgdiApIHtcbgl2ZWM0IHIgPSB2ZWM0KCB2LngsIGZyYWN0KCB2LnggKiAyNTUuMCApLCB2LnksIGZyYWN0KCB2LnkgKiAyNTUuMCApICk7XG4JcmV0dXJuIHZlYzQoIHIueCAtIHIueSAvIDI1NS4wLCByLnksIHIueiAtIHIudyAvIDI1NS4wLCByLncgKTtcbn1cbnZlYzIgdW5wYWNrUkdCQVRvMkhhbGYoIHZlYzQgdiApIHtcbglyZXR1cm4gdmVjMiggdi54ICsgKCB2LnkgLyAyNTUuMCApLCB2LnogKyAoIHYudyAvIDI1NS4wICkgKTtcbn1cbmZsb2F0IHZpZXdaVG9PcnRob2dyYXBoaWNEZXB0aCggY29uc3QgaW4gZmxvYXQgdmlld1osIGNvbnN0IGluIGZsb2F0IG5lYXIsIGNvbnN0IGluIGZsb2F0IGZhciApIHtcbglyZXR1cm4gKCB2aWV3WiArIG5lYXIgKSAvICggbmVhciAtIGZhciApO1xufVxuZmxvYXQgb3J0aG9ncmFwaGljRGVwdGhUb1ZpZXdaKCBjb25zdCBpbiBmbG9hdCBsaW5lYXJDbGlwWiwgY29uc3QgaW4gZmxvYXQgbmVhciwgY29uc3QgaW4gZmxvYXQgZmFyICkge1xuCXJldHVybiBsaW5lYXJDbGlwWiAqICggbmVhciAtIGZhciApIC0gbmVhcjtcbn1cbmZsb2F0IHZpZXdaVG9QZXJzcGVjdGl2ZURlcHRoKCBjb25zdCBpbiBmbG9hdCB2aWV3WiwgY29uc3QgaW4gZmxvYXQgbmVhciwgY29uc3QgaW4gZmxvYXQgZmFyICkge1xuCXJldHVybiAoICggbmVhciArIHZpZXdaICkgKiBmYXIgKSAvICggKCBmYXIgLSBuZWFyICkgKiB2aWV3WiApO1xufVxuZmxvYXQgcGVyc3BlY3RpdmVEZXB0aFRvVmlld1ooIGNvbnN0IGluIGZsb2F0IGludkNsaXBaLCBjb25zdCBpbiBmbG9hdCBuZWFyLCBjb25zdCBpbiBmbG9hdCBmYXIgKSB7XG4JcmV0dXJuICggbmVhciAqIGZhciApIC8gKCAoIGZhciAtIG5lYXIgKSAqIGludkNsaXBaIC0gZmFyICk7XG59IjsKdmFyIHByZW11bHRpcGxpZWRfYWxwaGFfZnJhZ21lbnQgPSAiI2lmZGVmIFBSRU1VTFRJUExJRURfQUxQSEFcbglnbF9GcmFnQ29sb3IucmdiICo9IGdsX0ZyYWdDb2xvci5hO1xuI2VuZGlmIjsKdmFyIHByb2plY3RfdmVydGV4ID0gInZlYzQgbXZQb3NpdGlvbiA9IHZlYzQoIHRyYW5zZm9ybWVkLCAxLjAgKTtcbiNpZmRlZiBVU0VfSU5TVEFOQ0lOR1xuCW12UG9zaXRpb24gPSBpbnN0YW5jZU1hdHJpeCAqIG12UG9zaXRpb247XG4jZW5kaWZcbm12UG9zaXRpb24gPSBtb2RlbFZpZXdNYXRyaXggKiBtdlBvc2l0aW9uO1xuZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbXZQb3NpdGlvbjsiOwp2YXIgZGl0aGVyaW5nX2ZyYWdtZW50ID0gIiNpZmRlZiBESVRIRVJJTkdcbglnbF9GcmFnQ29sb3IucmdiID0gZGl0aGVyaW5nKCBnbF9GcmFnQ29sb3IucmdiICk7XG4jZW5kaWYiOwp2YXIgZGl0aGVyaW5nX3BhcnNfZnJhZ21lbnQgPSAiI2lmZGVmIERJVEhFUklOR1xuCXZlYzMgZGl0aGVyaW5nKCB2ZWMzIGNvbG9yICkge1xuCQlmbG9hdCBncmlkX3Bvc2l0aW9uID0gcmFuZCggZ2xfRnJhZ0Nvb3JkLnh5ICk7XG4JCXZlYzMgZGl0aGVyX3NoaWZ0X1JHQiA9IHZlYzMoIDAuMjUgLyAyNTUuMCwgLTAuMjUgLyAyNTUuMCwgMC4yNSAvIDI1NS4wICk7XG4JCWRpdGhlcl9zaGlmdF9SR0IgPSBtaXgoIDIuMCAqIGRpdGhlcl9zaGlmdF9SR0IsIC0yLjAgKiBkaXRoZXJfc2hpZnRfUkdCLCBncmlkX3Bvc2l0aW9uICk7XG4JCXJldHVybiBjb2xvciArIGRpdGhlcl9zaGlmdF9SR0I7XG4JfVxuI2VuZGlmIjsKdmFyIHJvdWdobmVzc21hcF9mcmFnbWVudCA9ICJmbG9hdCByb3VnaG5lc3NGYWN0b3IgPSByb3VnaG5lc3M7XG4jaWZkZWYgVVNFX1JPVUdITkVTU01BUFxuCXZlYzQgdGV4ZWxSb3VnaG5lc3MgPSB0ZXh0dXJlMkQoIHJvdWdobmVzc01hcCwgdlV2ICk7XG4Jcm91Z2huZXNzRmFjdG9yICo9IHRleGVsUm91Z2huZXNzLmc7XG4jZW5kaWYiOwp2YXIgcm91Z2huZXNzbWFwX3BhcnNfZnJhZ21lbnQgPSAiI2lmZGVmIFVTRV9ST1VHSE5FU1NNQVBcbgl1bmlmb3JtIHNhbXBsZXIyRCByb3VnaG5lc3NNYXA7XG4jZW5kaWYiOwp2YXIgc2hhZG93bWFwX3BhcnNfZnJhZ21lbnQgPSAiI2lmZGVmIFVTRV9TSEFET1dNQVBcbgkjaWYgTlVNX0RJUl9MSUdIVF9TSEFET1dTID4gMFxuCQl1bmlmb3JtIHNhbXBsZXIyRCBkaXJlY3Rpb25hbFNoYWRvd01hcFsgTlVNX0RJUl9MSUdIVF9TSEFET1dTIF07XG4JCXZhcnlpbmcgdmVjNCB2RGlyZWN0aW9uYWxTaGFkb3dDb29yZFsgTlVNX0RJUl9MSUdIVF9TSEFET1dTIF07XG4JCXN0cnVjdCBEaXJlY3Rpb25hbExpZ2h0U2hhZG93IHtcbgkJCWZsb2F0IHNoYWRvd0JpYXM7XG4JCQlmbG9hdCBzaGFkb3dOb3JtYWxCaWFzO1xuCQkJZmxvYXQgc2hhZG93UmFkaXVzO1xuCQkJdmVjMiBzaGFkb3dNYXBTaXplO1xuCQl9O1xuCQl1bmlmb3JtIERpcmVjdGlvbmFsTGlnaHRTaGFkb3cgZGlyZWN0aW9uYWxMaWdodFNoYWRvd3NbIE5VTV9ESVJfTElHSFRfU0hBRE9XUyBdO1xuCSNlbmRpZlxuCSNpZiBOVU1fU1BPVF9MSUdIVF9TSEFET1dTID4gMFxuCQl1bmlmb3JtIHNhbXBsZXIyRCBzcG90U2hhZG93TWFwWyBOVU1fU1BPVF9MSUdIVF9TSEFET1dTIF07XG4JCXZhcnlpbmcgdmVjNCB2U3BvdFNoYWRvd0Nvb3JkWyBOVU1fU1BPVF9MSUdIVF9TSEFET1dTIF07XG4JCXN0cnVjdCBTcG90TGlnaHRTaGFkb3cge1xuCQkJZmxvYXQgc2hhZG93QmlhcztcbgkJCWZsb2F0IHNoYWRvd05vcm1hbEJpYXM7XG4JCQlmbG9hdCBzaGFkb3dSYWRpdXM7XG4JCQl2ZWMyIHNoYWRvd01hcFNpemU7XG4JCX07XG4JCXVuaWZvcm0gU3BvdExpZ2h0U2hhZG93IHNwb3RMaWdodFNoYWRvd3NbIE5VTV9TUE9UX0xJR0hUX1NIQURPV1MgXTtcbgkjZW5kaWZcbgkjaWYgTlVNX1BPSU5UX0xJR0hUX1NIQURPV1MgPiAwXG4JCXVuaWZvcm0gc2FtcGxlcjJEIHBvaW50U2hhZG93TWFwWyBOVU1fUE9JTlRfTElHSFRfU0hBRE9XUyBdO1xuCQl2YXJ5aW5nIHZlYzQgdlBvaW50U2hhZG93Q29vcmRbIE5VTV9QT0lOVF9MSUdIVF9TSEFET1dTIF07XG4JCXN0cnVjdCBQb2ludExpZ2h0U2hhZG93IHtcbgkJCWZsb2F0IHNoYWRvd0JpYXM7XG4JCQlmbG9hdCBzaGFkb3dOb3JtYWxCaWFzO1xuCQkJZmxvYXQgc2hhZG93UmFkaXVzO1xuCQkJdmVjMiBzaGFkb3dNYXBTaXplO1xuCQkJZmxvYXQgc2hhZG93Q2FtZXJhTmVhcjtcbgkJCWZsb2F0IHNoYWRvd0NhbWVyYUZhcjtcbgkJfTtcbgkJdW5pZm9ybSBQb2ludExpZ2h0U2hhZG93IHBvaW50TGlnaHRTaGFkb3dzWyBOVU1fUE9JTlRfTElHSFRfU0hBRE9XUyBdO1xuCSNlbmRpZlxuCWZsb2F0IHRleHR1cmUyRENvbXBhcmUoIHNhbXBsZXIyRCBkZXB0aHMsIHZlYzIgdXYsIGZsb2F0IGNvbXBhcmUgKSB7XG4JCXJldHVybiBzdGVwKCBjb21wYXJlLCB1bnBhY2tSR0JBVG9EZXB0aCggdGV4dHVyZTJEKCBkZXB0aHMsIHV2ICkgKSApO1xuCX1cbgl2ZWMyIHRleHR1cmUyRERpc3RyaWJ1dGlvbiggc2FtcGxlcjJEIHNoYWRvdywgdmVjMiB1diApIHtcbgkJcmV0dXJuIHVucGFja1JHQkFUbzJIYWxmKCB0ZXh0dXJlMkQoIHNoYWRvdywgdXYgKSApO1xuCX1cbglmbG9hdCBWU01TaGFkb3cgKHNhbXBsZXIyRCBzaGFkb3csIHZlYzIgdXYsIGZsb2F0IGNvbXBhcmUgKXtcbgkJZmxvYXQgb2NjbHVzaW9uID0gMS4wO1xuCQl2ZWMyIGRpc3RyaWJ1dGlvbiA9IHRleHR1cmUyRERpc3RyaWJ1dGlvbiggc2hhZG93LCB1diApO1xuCQlmbG9hdCBoYXJkX3NoYWRvdyA9IHN0ZXAoIGNvbXBhcmUgLCBkaXN0cmlidXRpb24ueCApO1xuCQlpZiAoaGFyZF9zaGFkb3cgIT0gMS4wICkge1xuCQkJZmxvYXQgZGlzdGFuY2UgPSBjb21wYXJlIC0gZGlzdHJpYnV0aW9uLnggO1xuCQkJZmxvYXQgdmFyaWFuY2UgPSBtYXgoIDAuMDAwMDAsIGRpc3RyaWJ1dGlvbi55ICogZGlzdHJpYnV0aW9uLnkgKTtcbgkJCWZsb2F0IHNvZnRuZXNzX3Byb2JhYmlsaXR5ID0gdmFyaWFuY2UgLyAodmFyaWFuY2UgKyBkaXN0YW5jZSAqIGRpc3RhbmNlICk7CQkJc29mdG5lc3NfcHJvYmFiaWxpdHkgPSBjbGFtcCggKCBzb2Z0bmVzc19wcm9iYWJpbGl0eSAtIDAuMyApIC8gKCAwLjk1IC0gMC4zICksIDAuMCwgMS4wICk7CQkJb2NjbHVzaW9uID0gY2xhbXAoIG1heCggaGFyZF9zaGFkb3csIHNvZnRuZXNzX3Byb2JhYmlsaXR5ICksIDAuMCwgMS4wICk7XG4JCX1cbgkJcmV0dXJuIG9jY2x1c2lvbjtcbgl9XG4JZmxvYXQgZ2V0U2hhZG93KCBzYW1wbGVyMkQgc2hhZG93TWFwLCB2ZWMyIHNoYWRvd01hcFNpemUsIGZsb2F0IHNoYWRvd0JpYXMsIGZsb2F0IHNoYWRvd1JhZGl1cywgdmVjNCBzaGFkb3dDb29yZCApIHtcbgkJZmxvYXQgc2hhZG93ID0gMS4wO1xuCQlzaGFkb3dDb29yZC54eXogLz0gc2hhZG93Q29vcmQudztcbgkJc2hhZG93Q29vcmQueiArPSBzaGFkb3dCaWFzO1xuCQlidmVjNCBpbkZydXN0dW1WZWMgPSBidmVjNCAoIHNoYWRvd0Nvb3JkLnggPj0gMC4wLCBzaGFkb3dDb29yZC54IDw9IDEuMCwgc2hhZG93Q29vcmQueSA+PSAwLjAsIHNoYWRvd0Nvb3JkLnkgPD0gMS4wICk7XG4JCWJvb2wgaW5GcnVzdHVtID0gYWxsKCBpbkZydXN0dW1WZWMgKTtcbgkJYnZlYzIgZnJ1c3R1bVRlc3RWZWMgPSBidmVjMiggaW5GcnVzdHVtLCBzaGFkb3dDb29yZC56IDw9IDEuMCApO1xuCQlib29sIGZydXN0dW1UZXN0ID0gYWxsKCBmcnVzdHVtVGVzdFZlYyApO1xuCQlpZiAoIGZydXN0dW1UZXN0ICkge1xuCQkjaWYgZGVmaW5lZCggU0hBRE9XTUFQX1RZUEVfUENGIClcbgkJCXZlYzIgdGV4ZWxTaXplID0gdmVjMiggMS4wICkgLyBzaGFkb3dNYXBTaXplO1xuCQkJZmxvYXQgZHgwID0gLSB0ZXhlbFNpemUueCAqIHNoYWRvd1JhZGl1cztcbgkJCWZsb2F0IGR5MCA9IC0gdGV4ZWxTaXplLnkgKiBzaGFkb3dSYWRpdXM7XG4JCQlmbG9hdCBkeDEgPSArIHRleGVsU2l6ZS54ICogc2hhZG93UmFkaXVzO1xuCQkJZmxvYXQgZHkxID0gKyB0ZXhlbFNpemUueSAqIHNoYWRvd1JhZGl1cztcbgkJCWZsb2F0IGR4MiA9IGR4MCAvIDIuMDtcbgkJCWZsb2F0IGR5MiA9IGR5MCAvIDIuMDtcbgkJCWZsb2F0IGR4MyA9IGR4MSAvIDIuMDtcbgkJCWZsb2F0IGR5MyA9IGR5MSAvIDIuMDtcbgkJCXNoYWRvdyA9IChcbgkJCQl0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggZHgwLCBkeTAgKSwgc2hhZG93Q29vcmQueiApICtcbgkJCQl0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggMC4wLCBkeTAgKSwgc2hhZG93Q29vcmQueiApICtcbgkJCQl0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggZHgxLCBkeTAgKSwgc2hhZG93Q29vcmQueiApICtcbgkJCQl0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggZHgyLCBkeTIgKSwgc2hhZG93Q29vcmQueiApICtcbgkJCQl0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggMC4wLCBkeTIgKSwgc2hhZG93Q29vcmQueiApICtcbgkJCQl0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggZHgzLCBkeTIgKSwgc2hhZG93Q29vcmQueiApICtcbgkJCQl0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggZHgwLCAwLjAgKSwgc2hhZG93Q29vcmQueiApICtcbgkJCQl0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggZHgyLCAwLjAgKSwgc2hhZG93Q29vcmQueiApICtcbgkJCQl0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5LCBzaGFkb3dDb29yZC56ICkgK1xuCQkJCXRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCBkeDMsIDAuMCApLCBzaGFkb3dDb29yZC56ICkgK1xuCQkJCXRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCBkeDEsIDAuMCApLCBzaGFkb3dDb29yZC56ICkgK1xuCQkJCXRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCBkeDIsIGR5MyApLCBzaGFkb3dDb29yZC56ICkgK1xuCQkJCXRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCAwLjAsIGR5MyApLCBzaGFkb3dDb29yZC56ICkgK1xuCQkJCXRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCBkeDMsIGR5MyApLCBzaGFkb3dDb29yZC56ICkgK1xuCQkJCXRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCBkeDAsIGR5MSApLCBzaGFkb3dDb29yZC56ICkgK1xuCQkJCXRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCAwLjAsIGR5MSApLCBzaGFkb3dDb29yZC56ICkgK1xuCQkJCXRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCBkeDEsIGR5MSApLCBzaGFkb3dDb29yZC56IClcbgkJCSkgKiAoIDEuMCAvIDE3LjAgKTtcbgkJI2VsaWYgZGVmaW5lZCggU0hBRE9XTUFQX1RZUEVfUENGX1NPRlQgKVxuCQkJdmVjMiB0ZXhlbFNpemUgPSB2ZWMyKCAxLjAgKSAvIHNoYWRvd01hcFNpemU7XG4JCQlmbG9hdCBkeCA9IHRleGVsU2l6ZS54O1xuCQkJZmxvYXQgZHkgPSB0ZXhlbFNpemUueTtcbgkJCXZlYzIgdXYgPSBzaGFkb3dDb29yZC54eTtcbgkJCXZlYzIgZiA9IGZyYWN0KCB1diAqIHNoYWRvd01hcFNpemUgKyAwLjUgKTtcbgkJCXV2IC09IGYgKiB0ZXhlbFNpemU7XG4JCQlzaGFkb3cgPSAoXG4JCQkJdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCB1diwgc2hhZG93Q29vcmQueiApICtcbgkJCQl0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHV2ICsgdmVjMiggZHgsIDAuMCApLCBzaGFkb3dDb29yZC56ICkgK1xuCQkJCXRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgdXYgKyB2ZWMyKCAwLjAsIGR5ICksIHNoYWRvd0Nvb3JkLnogKSArXG4JCQkJdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCB1diArIHRleGVsU2l6ZSwgc2hhZG93Q29vcmQueiApICtcbgkJCQltaXgoIHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgdXYgKyB2ZWMyKCAtZHgsIDAuMCApLCBzaGFkb3dDb29yZC56ICksIFxuCQkJCQkgdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCB1diArIHZlYzIoIDIuMCAqIGR4LCAwLjAgKSwgc2hhZG93Q29vcmQueiApLFxuCQkJCQkgZi54ICkgK1xuCQkJCW1peCggdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCB1diArIHZlYzIoIC1keCwgZHkgKSwgc2hhZG93Q29vcmQueiApLCBcbgkJCQkJIHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgdXYgKyB2ZWMyKCAyLjAgKiBkeCwgZHkgKSwgc2hhZG93Q29vcmQueiApLFxuCQkJCQkgZi54ICkgK1xuCQkJCW1peCggdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCB1diArIHZlYzIoIDAuMCwgLWR5ICksIHNoYWRvd0Nvb3JkLnogKSwgXG4JCQkJCSB0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHV2ICsgdmVjMiggMC4wLCAyLjAgKiBkeSApLCBzaGFkb3dDb29yZC56ICksXG4JCQkJCSBmLnkgKSArXG4JCQkJbWl4KCB0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHV2ICsgdmVjMiggZHgsIC1keSApLCBzaGFkb3dDb29yZC56ICksIFxuCQkJCQkgdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCB1diArIHZlYzIoIGR4LCAyLjAgKiBkeSApLCBzaGFkb3dDb29yZC56ICksXG4JCQkJCSBmLnkgKSArXG4JCQkJbWl4KCBtaXgoIHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgdXYgKyB2ZWMyKCAtZHgsIC1keSApLCBzaGFkb3dDb29yZC56ICksIFxuCQkJCQkJICB0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHV2ICsgdmVjMiggMi4wICogZHgsIC1keSApLCBzaGFkb3dDb29yZC56ICksXG4JCQkJCQkgIGYueCApLFxuCQkJCQkgbWl4KCB0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHV2ICsgdmVjMiggLWR4LCAyLjAgKiBkeSApLCBzaGFkb3dDb29yZC56ICksIFxuCQkJCQkJICB0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHV2ICsgdmVjMiggMi4wICogZHgsIDIuMCAqIGR5ICksIHNoYWRvd0Nvb3JkLnogKSxcbgkJCQkJCSAgZi54ICksXG4JCQkJCSBmLnkgKVxuCQkJKSAqICggMS4wIC8gOS4wICk7XG4JCSNlbGlmIGRlZmluZWQoIFNIQURPV01BUF9UWVBFX1ZTTSApXG4JCQlzaGFkb3cgPSBWU01TaGFkb3coIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHksIHNoYWRvd0Nvb3JkLnogKTtcbgkJI2Vsc2VcbgkJCXNoYWRvdyA9IHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHksIHNoYWRvd0Nvb3JkLnogKTtcbgkJI2VuZGlmXG4JCX1cbgkJcmV0dXJuIHNoYWRvdztcbgl9XG4JdmVjMiBjdWJlVG9VViggdmVjMyB2LCBmbG9hdCB0ZXhlbFNpemVZICkge1xuCQl2ZWMzIGFic1YgPSBhYnMoIHYgKTtcbgkJZmxvYXQgc2NhbGVUb0N1YmUgPSAxLjAgLyBtYXgoIGFic1YueCwgbWF4KCBhYnNWLnksIGFic1YueiApICk7XG4JCWFic1YgKj0gc2NhbGVUb0N1YmU7XG4JCXYgKj0gc2NhbGVUb0N1YmUgKiAoIDEuMCAtIDIuMCAqIHRleGVsU2l6ZVkgKTtcbgkJdmVjMiBwbGFuYXIgPSB2Lnh5O1xuCQlmbG9hdCBhbG1vc3RBVGV4ZWwgPSAxLjUgKiB0ZXhlbFNpemVZO1xuCQlmbG9hdCBhbG1vc3RPbmUgPSAxLjAgLSBhbG1vc3RBVGV4ZWw7XG4JCWlmICggYWJzVi56ID49IGFsbW9zdE9uZSApIHtcbgkJCWlmICggdi56ID4gMC4wIClcbgkJCQlwbGFuYXIueCA9IDQuMCAtIHYueDtcbgkJfSBlbHNlIGlmICggYWJzVi54ID49IGFsbW9zdE9uZSApIHtcbgkJCWZsb2F0IHNpZ25YID0gc2lnbiggdi54ICk7XG4JCQlwbGFuYXIueCA9IHYueiAqIHNpZ25YICsgMi4wICogc2lnblg7XG4JCX0gZWxzZSBpZiAoIGFic1YueSA+PSBhbG1vc3RPbmUgKSB7XG4JCQlmbG9hdCBzaWduWSA9IHNpZ24oIHYueSApO1xuCQkJcGxhbmFyLnggPSB2LnggKyAyLjAgKiBzaWduWSArIDIuMDtcbgkJCXBsYW5hci55ID0gdi56ICogc2lnblkgLSAyLjA7XG4JCX1cbgkJcmV0dXJuIHZlYzIoIDAuMTI1LCAwLjI1ICkgKiBwbGFuYXIgKyB2ZWMyKCAwLjM3NSwgMC43NSApO1xuCX1cbglmbG9hdCBnZXRQb2ludFNoYWRvdyggc2FtcGxlcjJEIHNoYWRvd01hcCwgdmVjMiBzaGFkb3dNYXBTaXplLCBmbG9hdCBzaGFkb3dCaWFzLCBmbG9hdCBzaGFkb3dSYWRpdXMsIHZlYzQgc2hhZG93Q29vcmQsIGZsb2F0IHNoYWRvd0NhbWVyYU5lYXIsIGZsb2F0IHNoYWRvd0NhbWVyYUZhciApIHtcbgkJdmVjMiB0ZXhlbFNpemUgPSB2ZWMyKCAxLjAgKSAvICggc2hhZG93TWFwU2l6ZSAqIHZlYzIoIDQuMCwgMi4wICkgKTtcbgkJdmVjMyBsaWdodFRvUG9zaXRpb24gPSBzaGFkb3dDb29yZC54eXo7XG4JCWZsb2F0IGRwID0gKCBsZW5ndGgoIGxpZ2h0VG9Qb3NpdGlvbiApIC0gc2hhZG93Q2FtZXJhTmVhciApIC8gKCBzaGFkb3dDYW1lcmFGYXIgLSBzaGFkb3dDYW1lcmFOZWFyICk7CQlkcCArPSBzaGFkb3dCaWFzO1xuCQl2ZWMzIGJkM0QgPSBub3JtYWxpemUoIGxpZ2h0VG9Qb3NpdGlvbiApO1xuCQkjaWYgZGVmaW5lZCggU0hBRE9XTUFQX1RZUEVfUENGICkgfHwgZGVmaW5lZCggU0hBRE9XTUFQX1RZUEVfUENGX1NPRlQgKSB8fCBkZWZpbmVkKCBTSEFET1dNQVBfVFlQRV9WU00gKVxuCQkJdmVjMiBvZmZzZXQgPSB2ZWMyKCAtIDEsIDEgKSAqIHNoYWRvd1JhZGl1cyAqIHRleGVsU2l6ZS55O1xuCQkJcmV0dXJuIChcbgkJCQl0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIGN1YmVUb1VWKCBiZDNEICsgb2Zmc2V0Lnh5eSwgdGV4ZWxTaXplLnkgKSwgZHAgKSArXG4JCQkJdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCBjdWJlVG9VViggYmQzRCArIG9mZnNldC55eXksIHRleGVsU2l6ZS55ICksIGRwICkgK1xuCQkJCXRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgY3ViZVRvVVYoIGJkM0QgKyBvZmZzZXQueHl4LCB0ZXhlbFNpemUueSApLCBkcCApICtcbgkJCQl0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIGN1YmVUb1VWKCBiZDNEICsgb2Zmc2V0Lnl5eCwgdGV4ZWxTaXplLnkgKSwgZHAgKSArXG4JCQkJdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCBjdWJlVG9VViggYmQzRCwgdGV4ZWxTaXplLnkgKSwgZHAgKSArXG4JCQkJdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCBjdWJlVG9VViggYmQzRCArIG9mZnNldC54eHksIHRleGVsU2l6ZS55ICksIGRwICkgK1xuCQkJCXRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgY3ViZVRvVVYoIGJkM0QgKyBvZmZzZXQueXh5LCB0ZXhlbFNpemUueSApLCBkcCApICtcbgkJCQl0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIGN1YmVUb1VWKCBiZDNEICsgb2Zmc2V0Lnh4eCwgdGV4ZWxTaXplLnkgKSwgZHAgKSArXG4JCQkJdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCBjdWJlVG9VViggYmQzRCArIG9mZnNldC55eHgsIHRleGVsU2l6ZS55ICksIGRwIClcbgkJCSkgKiAoIDEuMCAvIDkuMCApO1xuCQkjZWxzZVxuCQkJcmV0dXJuIHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgY3ViZVRvVVYoIGJkM0QsIHRleGVsU2l6ZS55ICksIGRwICk7XG4JCSNlbmRpZlxuCX1cbiNlbmRpZiI7CnZhciBzaGFkb3dtYXBfcGFyc192ZXJ0ZXggPSAiI2lmZGVmIFVTRV9TSEFET1dNQVBcbgkjaWYgTlVNX0RJUl9MSUdIVF9TSEFET1dTID4gMFxuCQl1bmlmb3JtIG1hdDQgZGlyZWN0aW9uYWxTaGFkb3dNYXRyaXhbIE5VTV9ESVJfTElHSFRfU0hBRE9XUyBdO1xuCQl2YXJ5aW5nIHZlYzQgdkRpcmVjdGlvbmFsU2hhZG93Q29vcmRbIE5VTV9ESVJfTElHSFRfU0hBRE9XUyBdO1xuCQlzdHJ1Y3QgRGlyZWN0aW9uYWxMaWdodFNoYWRvdyB7XG4JCQlmbG9hdCBzaGFkb3dCaWFzO1xuCQkJZmxvYXQgc2hhZG93Tm9ybWFsQmlhcztcbgkJCWZsb2F0IHNoYWRvd1JhZGl1cztcbgkJCXZlYzIgc2hhZG93TWFwU2l6ZTtcbgkJfTtcbgkJdW5pZm9ybSBEaXJlY3Rpb25hbExpZ2h0U2hhZG93IGRpcmVjdGlvbmFsTGlnaHRTaGFkb3dzWyBOVU1fRElSX0xJR0hUX1NIQURPV1MgXTtcbgkjZW5kaWZcbgkjaWYgTlVNX1NQT1RfTElHSFRfU0hBRE9XUyA+IDBcbgkJdW5pZm9ybSBtYXQ0IHNwb3RTaGFkb3dNYXRyaXhbIE5VTV9TUE9UX0xJR0hUX1NIQURPV1MgXTtcbgkJdmFyeWluZyB2ZWM0IHZTcG90U2hhZG93Q29vcmRbIE5VTV9TUE9UX0xJR0hUX1NIQURPV1MgXTtcbgkJc3RydWN0IFNwb3RMaWdodFNoYWRvdyB7XG4JCQlmbG9hdCBzaGFkb3dCaWFzO1xuCQkJZmxvYXQgc2hhZG93Tm9ybWFsQmlhcztcbgkJCWZsb2F0IHNoYWRvd1JhZGl1cztcbgkJCXZlYzIgc2hhZG93TWFwU2l6ZTtcbgkJfTtcbgkJdW5pZm9ybSBTcG90TGlnaHRTaGFkb3cgc3BvdExpZ2h0U2hhZG93c1sgTlVNX1NQT1RfTElHSFRfU0hBRE9XUyBdO1xuCSNlbmRpZlxuCSNpZiBOVU1fUE9JTlRfTElHSFRfU0hBRE9XUyA+IDBcbgkJdW5pZm9ybSBtYXQ0IHBvaW50U2hhZG93TWF0cml4WyBOVU1fUE9JTlRfTElHSFRfU0hBRE9XUyBdO1xuCQl2YXJ5aW5nIHZlYzQgdlBvaW50U2hhZG93Q29vcmRbIE5VTV9QT0lOVF9MSUdIVF9TSEFET1dTIF07XG4JCXN0cnVjdCBQb2ludExpZ2h0U2hhZG93IHtcbgkJCWZsb2F0IHNoYWRvd0JpYXM7XG4JCQlmbG9hdCBzaGFkb3dOb3JtYWxCaWFzO1xuCQkJZmxvYXQgc2hhZG93UmFkaXVzO1xuCQkJdmVjMiBzaGFkb3dNYXBTaXplO1xuCQkJZmxvYXQgc2hhZG93Q2FtZXJhTmVhcjtcbgkJCWZsb2F0IHNoYWRvd0NhbWVyYUZhcjtcbgkJfTtcbgkJdW5pZm9ybSBQb2ludExpZ2h0U2hhZG93IHBvaW50TGlnaHRTaGFkb3dzWyBOVU1fUE9JTlRfTElHSFRfU0hBRE9XUyBdO1xuCSNlbmRpZlxuI2VuZGlmIjsKdmFyIHNoYWRvd21hcF92ZXJ0ZXggPSAiI2lmZGVmIFVTRV9TSEFET1dNQVBcbgkjaWYgTlVNX0RJUl9MSUdIVF9TSEFET1dTID4gMCB8fCBOVU1fU1BPVF9MSUdIVF9TSEFET1dTID4gMCB8fCBOVU1fUE9JTlRfTElHSFRfU0hBRE9XUyA+IDBcbgkJdmVjMyBzaGFkb3dXb3JsZE5vcm1hbCA9IGludmVyc2VUcmFuc2Zvcm1EaXJlY3Rpb24oIHRyYW5zZm9ybWVkTm9ybWFsLCB2aWV3TWF0cml4ICk7XG4JCXZlYzQgc2hhZG93V29ybGRQb3NpdGlvbjtcbgkjZW5kaWZcbgkjaWYgTlVNX0RJUl9MSUdIVF9TSEFET1dTID4gMFxuCSNwcmFnbWEgdW5yb2xsX2xvb3Bfc3RhcnRcbglmb3IgKCBpbnQgaSA9IDA7IGkgPCBOVU1fRElSX0xJR0hUX1NIQURPV1M7IGkgKysgKSB7XG4JCXNoYWRvd1dvcmxkUG9zaXRpb24gPSB3b3JsZFBvc2l0aW9uICsgdmVjNCggc2hhZG93V29ybGROb3JtYWwgKiBkaXJlY3Rpb25hbExpZ2h0U2hhZG93c1sgaSBdLnNoYWRvd05vcm1hbEJpYXMsIDAgKTtcbgkJdkRpcmVjdGlvbmFsU2hhZG93Q29vcmRbIGkgXSA9IGRpcmVjdGlvbmFsU2hhZG93TWF0cml4WyBpIF0gKiBzaGFkb3dXb3JsZFBvc2l0aW9uO1xuCX1cbgkjcHJhZ21hIHVucm9sbF9sb29wX2VuZFxuCSNlbmRpZlxuCSNpZiBOVU1fU1BPVF9MSUdIVF9TSEFET1dTID4gMFxuCSNwcmFnbWEgdW5yb2xsX2xvb3Bfc3RhcnRcbglmb3IgKCBpbnQgaSA9IDA7IGkgPCBOVU1fU1BPVF9MSUdIVF9TSEFET1dTOyBpICsrICkge1xuCQlzaGFkb3dXb3JsZFBvc2l0aW9uID0gd29ybGRQb3NpdGlvbiArIHZlYzQoIHNoYWRvd1dvcmxkTm9ybWFsICogc3BvdExpZ2h0U2hhZG93c1sgaSBdLnNoYWRvd05vcm1hbEJpYXMsIDAgKTtcbgkJdlNwb3RTaGFkb3dDb29yZFsgaSBdID0gc3BvdFNoYWRvd01hdHJpeFsgaSBdICogc2hhZG93V29ybGRQb3NpdGlvbjtcbgl9XG4JI3ByYWdtYSB1bnJvbGxfbG9vcF9lbmRcbgkjZW5kaWZcbgkjaWYgTlVNX1BPSU5UX0xJR0hUX1NIQURPV1MgPiAwXG4JI3ByYWdtYSB1bnJvbGxfbG9vcF9zdGFydFxuCWZvciAoIGludCBpID0gMDsgaSA8IE5VTV9QT0lOVF9MSUdIVF9TSEFET1dTOyBpICsrICkge1xuCQlzaGFkb3dXb3JsZFBvc2l0aW9uID0gd29ybGRQb3NpdGlvbiArIHZlYzQoIHNoYWRvd1dvcmxkTm9ybWFsICogcG9pbnRMaWdodFNoYWRvd3NbIGkgXS5zaGFkb3dOb3JtYWxCaWFzLCAwICk7XG4JCXZQb2ludFNoYWRvd0Nvb3JkWyBpIF0gPSBwb2ludFNoYWRvd01hdHJpeFsgaSBdICogc2hhZG93V29ybGRQb3NpdGlvbjtcbgl9XG4JI3ByYWdtYSB1bnJvbGxfbG9vcF9lbmRcbgkjZW5kaWZcbiNlbmRpZiI7CnZhciBzaGFkb3dtYXNrX3BhcnNfZnJhZ21lbnQgPSAiZmxvYXQgZ2V0U2hhZG93TWFzaygpIHtcbglmbG9hdCBzaGFkb3cgPSAxLjA7XG4JI2lmZGVmIFVTRV9TSEFET1dNQVBcbgkjaWYgTlVNX0RJUl9MSUdIVF9TSEFET1dTID4gMFxuCURpcmVjdGlvbmFsTGlnaHRTaGFkb3cgZGlyZWN0aW9uYWxMaWdodDtcbgkjcHJhZ21hIHVucm9sbF9sb29wX3N0YXJ0XG4JZm9yICggaW50IGkgPSAwOyBpIDwgTlVNX0RJUl9MSUdIVF9TSEFET1dTOyBpICsrICkge1xuCQlkaXJlY3Rpb25hbExpZ2h0ID0gZGlyZWN0aW9uYWxMaWdodFNoYWRvd3NbIGkgXTtcbgkJc2hhZG93ICo9IHJlY2VpdmVTaGFkb3cgPyBnZXRTaGFkb3coIGRpcmVjdGlvbmFsU2hhZG93TWFwWyBpIF0sIGRpcmVjdGlvbmFsTGlnaHQuc2hhZG93TWFwU2l6ZSwgZGlyZWN0aW9uYWxMaWdodC5zaGFkb3dCaWFzLCBkaXJlY3Rpb25hbExpZ2h0LnNoYWRvd1JhZGl1cywgdkRpcmVjdGlvbmFsU2hhZG93Q29vcmRbIGkgXSApIDogMS4wO1xuCX1cbgkjcHJhZ21hIHVucm9sbF9sb29wX2VuZFxuCSNlbmRpZlxuCSNpZiBOVU1fU1BPVF9MSUdIVF9TSEFET1dTID4gMFxuCVNwb3RMaWdodFNoYWRvdyBzcG90TGlnaHQ7XG4JI3ByYWdtYSB1bnJvbGxfbG9vcF9zdGFydFxuCWZvciAoIGludCBpID0gMDsgaSA8IE5VTV9TUE9UX0xJR0hUX1NIQURPV1M7IGkgKysgKSB7XG4JCXNwb3RMaWdodCA9IHNwb3RMaWdodFNoYWRvd3NbIGkgXTtcbgkJc2hhZG93ICo9IHJlY2VpdmVTaGFkb3cgPyBnZXRTaGFkb3coIHNwb3RTaGFkb3dNYXBbIGkgXSwgc3BvdExpZ2h0LnNoYWRvd01hcFNpemUsIHNwb3RMaWdodC5zaGFkb3dCaWFzLCBzcG90TGlnaHQuc2hhZG93UmFkaXVzLCB2U3BvdFNoYWRvd0Nvb3JkWyBpIF0gKSA6IDEuMDtcbgl9XG4JI3ByYWdtYSB1bnJvbGxfbG9vcF9lbmRcbgkjZW5kaWZcbgkjaWYgTlVNX1BPSU5UX0xJR0hUX1NIQURPV1MgPiAwXG4JUG9pbnRMaWdodFNoYWRvdyBwb2ludExpZ2h0O1xuCSNwcmFnbWEgdW5yb2xsX2xvb3Bfc3RhcnRcbglmb3IgKCBpbnQgaSA9IDA7IGkgPCBOVU1fUE9JTlRfTElHSFRfU0hBRE9XUzsgaSArKyApIHtcbgkJcG9pbnRMaWdodCA9IHBvaW50TGlnaHRTaGFkb3dzWyBpIF07XG4JCXNoYWRvdyAqPSByZWNlaXZlU2hhZG93ID8gZ2V0UG9pbnRTaGFkb3coIHBvaW50U2hhZG93TWFwWyBpIF0sIHBvaW50TGlnaHQuc2hhZG93TWFwU2l6ZSwgcG9pbnRMaWdodC5zaGFkb3dCaWFzLCBwb2ludExpZ2h0LnNoYWRvd1JhZGl1cywgdlBvaW50U2hhZG93Q29vcmRbIGkgXSwgcG9pbnRMaWdodC5zaGFkb3dDYW1lcmFOZWFyLCBwb2ludExpZ2h0LnNoYWRvd0NhbWVyYUZhciApIDogMS4wO1xuCX1cbgkjcHJhZ21hIHVucm9sbF9sb29wX2VuZFxuCSNlbmRpZlxuCSNlbmRpZlxuCXJldHVybiBzaGFkb3c7XG59IjsKdmFyIHNraW5iYXNlX3ZlcnRleCA9ICIjaWZkZWYgVVNFX1NLSU5OSU5HXG4JbWF0NCBib25lTWF0WCA9IGdldEJvbmVNYXRyaXgoIHNraW5JbmRleC54ICk7XG4JbWF0NCBib25lTWF0WSA9IGdldEJvbmVNYXRyaXgoIHNraW5JbmRleC55ICk7XG4JbWF0NCBib25lTWF0WiA9IGdldEJvbmVNYXRyaXgoIHNraW5JbmRleC56ICk7XG4JbWF0NCBib25lTWF0VyA9IGdldEJvbmVNYXRyaXgoIHNraW5JbmRleC53ICk7XG4jZW5kaWYiOwp2YXIgc2tpbm5pbmdfcGFyc192ZXJ0ZXggPSAiI2lmZGVmIFVTRV9TS0lOTklOR1xuCXVuaWZvcm0gbWF0NCBiaW5kTWF0cml4O1xuCXVuaWZvcm0gbWF0NCBiaW5kTWF0cml4SW52ZXJzZTtcbgkjaWZkZWYgQk9ORV9URVhUVVJFXG4JCXVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEIGJvbmVUZXh0dXJlO1xuCQl1bmlmb3JtIGludCBib25lVGV4dHVyZVNpemU7XG4JCW1hdDQgZ2V0Qm9uZU1hdHJpeCggY29uc3QgaW4gZmxvYXQgaSApIHtcbgkJCWZsb2F0IGogPSBpICogNC4wO1xuCQkJZmxvYXQgeCA9IG1vZCggaiwgZmxvYXQoIGJvbmVUZXh0dXJlU2l6ZSApICk7XG4JCQlmbG9hdCB5ID0gZmxvb3IoIGogLyBmbG9hdCggYm9uZVRleHR1cmVTaXplICkgKTtcbgkJCWZsb2F0IGR4ID0gMS4wIC8gZmxvYXQoIGJvbmVUZXh0dXJlU2l6ZSApO1xuCQkJZmxvYXQgZHkgPSAxLjAgLyBmbG9hdCggYm9uZVRleHR1cmVTaXplICk7XG4JCQl5ID0gZHkgKiAoIHkgKyAwLjUgKTtcbgkJCXZlYzQgdjEgPSB0ZXh0dXJlMkQoIGJvbmVUZXh0dXJlLCB2ZWMyKCBkeCAqICggeCArIDAuNSApLCB5ICkgKTtcbgkJCXZlYzQgdjIgPSB0ZXh0dXJlMkQoIGJvbmVUZXh0dXJlLCB2ZWMyKCBkeCAqICggeCArIDEuNSApLCB5ICkgKTtcbgkJCXZlYzQgdjMgPSB0ZXh0dXJlMkQoIGJvbmVUZXh0dXJlLCB2ZWMyKCBkeCAqICggeCArIDIuNSApLCB5ICkgKTtcbgkJCXZlYzQgdjQgPSB0ZXh0dXJlMkQoIGJvbmVUZXh0dXJlLCB2ZWMyKCBkeCAqICggeCArIDMuNSApLCB5ICkgKTtcbgkJCW1hdDQgYm9uZSA9IG1hdDQoIHYxLCB2MiwgdjMsIHY0ICk7XG4JCQlyZXR1cm4gYm9uZTtcbgkJfVxuCSNlbHNlXG4JCXVuaWZvcm0gbWF0NCBib25lTWF0cmljZXNbIE1BWF9CT05FUyBdO1xuCQltYXQ0IGdldEJvbmVNYXRyaXgoIGNvbnN0IGluIGZsb2F0IGkgKSB7XG4JCQltYXQ0IGJvbmUgPSBib25lTWF0cmljZXNbIGludChpKSBdO1xuCQkJcmV0dXJuIGJvbmU7XG4JCX1cbgkjZW5kaWZcbiNlbmRpZiI7CnZhciBza2lubmluZ192ZXJ0ZXggPSAiI2lmZGVmIFVTRV9TS0lOTklOR1xuCXZlYzQgc2tpblZlcnRleCA9IGJpbmRNYXRyaXggKiB2ZWM0KCB0cmFuc2Zvcm1lZCwgMS4wICk7XG4JdmVjNCBza2lubmVkID0gdmVjNCggMC4wICk7XG4Jc2tpbm5lZCArPSBib25lTWF0WCAqIHNraW5WZXJ0ZXggKiBza2luV2VpZ2h0Lng7XG4Jc2tpbm5lZCArPSBib25lTWF0WSAqIHNraW5WZXJ0ZXggKiBza2luV2VpZ2h0Lnk7XG4Jc2tpbm5lZCArPSBib25lTWF0WiAqIHNraW5WZXJ0ZXggKiBza2luV2VpZ2h0Lno7XG4Jc2tpbm5lZCArPSBib25lTWF0VyAqIHNraW5WZXJ0ZXggKiBza2luV2VpZ2h0Lnc7XG4JdHJhbnNmb3JtZWQgPSAoIGJpbmRNYXRyaXhJbnZlcnNlICogc2tpbm5lZCApLnh5ejtcbiNlbmRpZiI7CnZhciBza2lubm9ybWFsX3ZlcnRleCA9ICIjaWZkZWYgVVNFX1NLSU5OSU5HXG4JbWF0NCBza2luTWF0cml4ID0gbWF0NCggMC4wICk7XG4Jc2tpbk1hdHJpeCArPSBza2luV2VpZ2h0LnggKiBib25lTWF0WDtcbglza2luTWF0cml4ICs9IHNraW5XZWlnaHQueSAqIGJvbmVNYXRZO1xuCXNraW5NYXRyaXggKz0gc2tpbldlaWdodC56ICogYm9uZU1hdFo7XG4Jc2tpbk1hdHJpeCArPSBza2luV2VpZ2h0LncgKiBib25lTWF0Vztcbglza2luTWF0cml4ID0gYmluZE1hdHJpeEludmVyc2UgKiBza2luTWF0cml4ICogYmluZE1hdHJpeDtcbglvYmplY3ROb3JtYWwgPSB2ZWM0KCBza2luTWF0cml4ICogdmVjNCggb2JqZWN0Tm9ybWFsLCAwLjAgKSApLnh5ejtcbgkjaWZkZWYgVVNFX1RBTkdFTlRcbgkJb2JqZWN0VGFuZ2VudCA9IHZlYzQoIHNraW5NYXRyaXggKiB2ZWM0KCBvYmplY3RUYW5nZW50LCAwLjAgKSApLnh5ejtcbgkjZW5kaWZcbiNlbmRpZiI7CnZhciBzcGVjdWxhcm1hcF9mcmFnbWVudCA9ICJmbG9hdCBzcGVjdWxhclN0cmVuZ3RoO1xuI2lmZGVmIFVTRV9TUEVDVUxBUk1BUFxuCXZlYzQgdGV4ZWxTcGVjdWxhciA9IHRleHR1cmUyRCggc3BlY3VsYXJNYXAsIHZVdiApO1xuCXNwZWN1bGFyU3RyZW5ndGggPSB0ZXhlbFNwZWN1bGFyLnI7XG4jZWxzZVxuCXNwZWN1bGFyU3RyZW5ndGggPSAxLjA7XG4jZW5kaWYiOwp2YXIgc3BlY3VsYXJtYXBfcGFyc19mcmFnbWVudCA9ICIjaWZkZWYgVVNFX1NQRUNVTEFSTUFQXG4JdW5pZm9ybSBzYW1wbGVyMkQgc3BlY3VsYXJNYXA7XG4jZW5kaWYiOwp2YXIgdG9uZW1hcHBpbmdfZnJhZ21lbnQgPSAiI2lmIGRlZmluZWQoIFRPTkVfTUFQUElORyApXG4JZ2xfRnJhZ0NvbG9yLnJnYiA9IHRvbmVNYXBwaW5nKCBnbF9GcmFnQ29sb3IucmdiICk7XG4jZW5kaWYiOwp2YXIgdG9uZW1hcHBpbmdfcGFyc19mcmFnbWVudCA9ICIjaWZuZGVmIHNhdHVyYXRlXG4jZGVmaW5lIHNhdHVyYXRlKCBhICkgY2xhbXAoIGEsIDAuMCwgMS4wIClcbiNlbmRpZlxudW5pZm9ybSBmbG9hdCB0b25lTWFwcGluZ0V4cG9zdXJlO1xudmVjMyBMaW5lYXJUb25lTWFwcGluZyggdmVjMyBjb2xvciApIHtcbglyZXR1cm4gdG9uZU1hcHBpbmdFeHBvc3VyZSAqIGNvbG9yO1xufVxudmVjMyBSZWluaGFyZFRvbmVNYXBwaW5nKCB2ZWMzIGNvbG9yICkge1xuCWNvbG9yICo9IHRvbmVNYXBwaW5nRXhwb3N1cmU7XG4JcmV0dXJuIHNhdHVyYXRlKCBjb2xvciAvICggdmVjMyggMS4wICkgKyBjb2xvciApICk7XG59XG52ZWMzIE9wdGltaXplZENpbmVvblRvbmVNYXBwaW5nKCB2ZWMzIGNvbG9yICkge1xuCWNvbG9yICo9IHRvbmVNYXBwaW5nRXhwb3N1cmU7XG4JY29sb3IgPSBtYXgoIHZlYzMoIDAuMCApLCBjb2xvciAtIDAuMDA0ICk7XG4JcmV0dXJuIHBvdyggKCBjb2xvciAqICggNi4yICogY29sb3IgKyAwLjUgKSApIC8gKCBjb2xvciAqICggNi4yICogY29sb3IgKyAxLjcgKSArIDAuMDYgKSwgdmVjMyggMi4yICkgKTtcbn1cbnZlYzMgUlJUQW5kT0RURml0KCB2ZWMzIHYgKSB7XG4JdmVjMyBhID0gdiAqICggdiArIDAuMDI0NTc4NiApIC0gMC4wMDAwOTA1Mzc7XG4JdmVjMyBiID0gdiAqICggMC45ODM3MjkgKiB2ICsgMC40MzI5NTEwICkgKyAwLjIzODA4MTtcbglyZXR1cm4gYSAvIGI7XG59XG52ZWMzIEFDRVNGaWxtaWNUb25lTWFwcGluZyggdmVjMyBjb2xvciApIHtcbgljb25zdCBtYXQzIEFDRVNJbnB1dE1hdCA9IG1hdDMoXG4JCXZlYzMoIDAuNTk3MTksIDAuMDc2MDAsIDAuMDI4NDAgKSwJCXZlYzMoIDAuMzU0NTgsIDAuOTA4MzQsIDAuMTMzODMgKSxcbgkJdmVjMyggMC4wNDgyMywgMC4wMTU2NiwgMC44Mzc3NyApXG4JKTtcbgljb25zdCBtYXQzIEFDRVNPdXRwdXRNYXQgPSBtYXQzKFxuCQl2ZWMzKCAgMS42MDQ3NSwgLTAuMTAyMDgsIC0wLjAwMzI3ICksCQl2ZWMzKCAtMC41MzEwOCwgIDEuMTA4MTMsIC0wLjA3Mjc2ICksXG4JCXZlYzMoIC0wLjA3MzY3LCAtMC4wMDYwNSwgIDEuMDc2MDIgKVxuCSk7XG4JY29sb3IgKj0gdG9uZU1hcHBpbmdFeHBvc3VyZSAvIDAuNjtcbgljb2xvciA9IEFDRVNJbnB1dE1hdCAqIGNvbG9yO1xuCWNvbG9yID0gUlJUQW5kT0RURml0KCBjb2xvciApO1xuCWNvbG9yID0gQUNFU091dHB1dE1hdCAqIGNvbG9yO1xuCXJldHVybiBzYXR1cmF0ZSggY29sb3IgKTtcbn1cbnZlYzMgQ3VzdG9tVG9uZU1hcHBpbmcoIHZlYzMgY29sb3IgKSB7IHJldHVybiBjb2xvcjsgfSI7CnZhciB0cmFuc21pc3Npb25fZnJhZ21lbnQgPSAiI2lmZGVmIFVTRV9UUkFOU01JU1NJT05cbglmbG9hdCB0cmFuc21pc3Npb25BbHBoYSA9IDEuMDtcbglmbG9hdCB0cmFuc21pc3Npb25GYWN0b3IgPSB0cmFuc21pc3Npb247XG4JZmxvYXQgdGhpY2tuZXNzRmFjdG9yID0gdGhpY2tuZXNzO1xuCSNpZmRlZiBVU0VfVFJBTlNNSVNTSU9OTUFQXG4JCXRyYW5zbWlzc2lvbkZhY3RvciAqPSB0ZXh0dXJlMkQoIHRyYW5zbWlzc2lvbk1hcCwgdlV2ICkucjtcbgkjZW5kaWZcbgkjaWZkZWYgVVNFX1RISUNLTkVTU01BUFxuCQl0aGlja25lc3NGYWN0b3IgKj0gdGV4dHVyZTJEKCB0aGlja25lc3NNYXAsIHZVdiApLmc7XG4JI2VuZGlmXG4JdmVjMyBwb3MgPSB2V29ybGRQb3NpdGlvbjtcbgl2ZWMzIHYgPSBub3JtYWxpemUoIGNhbWVyYVBvc2l0aW9uIC0gcG9zICk7XG4JdmVjMyBuID0gaW52ZXJzZVRyYW5zZm9ybURpcmVjdGlvbiggbm9ybWFsLCB2aWV3TWF0cml4ICk7XG4JdmVjNCB0cmFuc21pc3Npb24gPSBnZXRJQkxWb2x1bWVSZWZyYWN0aW9uKFxuCQluLCB2LCByb3VnaG5lc3NGYWN0b3IsIG1hdGVyaWFsLmRpZmZ1c2VDb2xvciwgbWF0ZXJpYWwuc3BlY3VsYXJDb2xvciwgbWF0ZXJpYWwuc3BlY3VsYXJGOTAsXG4JCXBvcywgbW9kZWxNYXRyaXgsIHZpZXdNYXRyaXgsIHByb2plY3Rpb25NYXRyaXgsIGlvciwgdGhpY2tuZXNzRmFjdG9yLFxuCQlhdHRlbnVhdGlvbkNvbG9yLCBhdHRlbnVhdGlvbkRpc3RhbmNlICk7XG4JdG90YWxEaWZmdXNlID0gbWl4KCB0b3RhbERpZmZ1c2UsIHRyYW5zbWlzc2lvbi5yZ2IsIHRyYW5zbWlzc2lvbkZhY3RvciApO1xuCXRyYW5zbWlzc2lvbkFscGhhID0gbWl4KCB0cmFuc21pc3Npb25BbHBoYSwgdHJhbnNtaXNzaW9uLmEsIHRyYW5zbWlzc2lvbkZhY3RvciApO1xuI2VuZGlmIjsKdmFyIHRyYW5zbWlzc2lvbl9wYXJzX2ZyYWdtZW50ID0gIiNpZmRlZiBVU0VfVFJBTlNNSVNTSU9OXG4JdW5pZm9ybSBmbG9hdCB0cmFuc21pc3Npb247XG4JdW5pZm9ybSBmbG9hdCB0aGlja25lc3M7XG4JdW5pZm9ybSBmbG9hdCBhdHRlbnVhdGlvbkRpc3RhbmNlO1xuCXVuaWZvcm0gdmVjMyBhdHRlbnVhdGlvbkNvbG9yO1xuCSNpZmRlZiBVU0VfVFJBTlNNSVNTSU9OTUFQXG4JCXVuaWZvcm0gc2FtcGxlcjJEIHRyYW5zbWlzc2lvbk1hcDtcbgkjZW5kaWZcbgkjaWZkZWYgVVNFX1RISUNLTkVTU01BUFxuCQl1bmlmb3JtIHNhbXBsZXIyRCB0aGlja25lc3NNYXA7XG4JI2VuZGlmXG4JdW5pZm9ybSB2ZWMyIHRyYW5zbWlzc2lvblNhbXBsZXJTaXplO1xuCXVuaWZvcm0gc2FtcGxlcjJEIHRyYW5zbWlzc2lvblNhbXBsZXJNYXA7XG4JdW5pZm9ybSBtYXQ0IG1vZGVsTWF0cml4O1xuCXVuaWZvcm0gbWF0NCBwcm9qZWN0aW9uTWF0cml4O1xuCXZhcnlpbmcgdmVjMyB2V29ybGRQb3NpdGlvbjtcbgl2ZWMzIGdldFZvbHVtZVRyYW5zbWlzc2lvblJheSggY29uc3QgaW4gdmVjMyBuLCBjb25zdCBpbiB2ZWMzIHYsIGNvbnN0IGluIGZsb2F0IHRoaWNrbmVzcywgY29uc3QgaW4gZmxvYXQgaW9yLCBjb25zdCBpbiBtYXQ0IG1vZGVsTWF0cml4ICkge1xuCQl2ZWMzIHJlZnJhY3Rpb25WZWN0b3IgPSByZWZyYWN0KCAtIHYsIG5vcm1hbGl6ZSggbiApLCAxLjAgLyBpb3IgKTtcbgkJdmVjMyBtb2RlbFNjYWxlO1xuCQltb2RlbFNjYWxlLnggPSBsZW5ndGgoIHZlYzMoIG1vZGVsTWF0cml4WyAwIF0ueHl6ICkgKTtcbgkJbW9kZWxTY2FsZS55ID0gbGVuZ3RoKCB2ZWMzKCBtb2RlbE1hdHJpeFsgMSBdLnh5eiApICk7XG4JCW1vZGVsU2NhbGUueiA9IGxlbmd0aCggdmVjMyggbW9kZWxNYXRyaXhbIDIgXS54eXogKSApO1xuCQlyZXR1cm4gbm9ybWFsaXplKCByZWZyYWN0aW9uVmVjdG9yICkgKiB0aGlja25lc3MgKiBtb2RlbFNjYWxlO1xuCX1cbglmbG9hdCBhcHBseUlvclRvUm91Z2huZXNzKCBjb25zdCBpbiBmbG9hdCByb3VnaG5lc3MsIGNvbnN0IGluIGZsb2F0IGlvciApIHtcbgkJcmV0dXJuIHJvdWdobmVzcyAqIGNsYW1wKCBpb3IgKiAyLjAgLSAyLjAsIDAuMCwgMS4wICk7XG4JfVxuCXZlYzQgZ2V0VHJhbnNtaXNzaW9uU2FtcGxlKCBjb25zdCBpbiB2ZWMyIGZyYWdDb29yZCwgY29uc3QgaW4gZmxvYXQgcm91Z2huZXNzLCBjb25zdCBpbiBmbG9hdCBpb3IgKSB7XG4JCWZsb2F0IGZyYW1lYnVmZmVyTG9kID0gbG9nMiggdHJhbnNtaXNzaW9uU2FtcGxlclNpemUueCApICogYXBwbHlJb3JUb1JvdWdobmVzcyggcm91Z2huZXNzLCBpb3IgKTtcbgkJI2lmZGVmIFRFWFRVUkVfTE9EX0VYVFxuCQkJcmV0dXJuIHRleHR1cmUyRExvZEVYVCggdHJhbnNtaXNzaW9uU2FtcGxlck1hcCwgZnJhZ0Nvb3JkLnh5LCBmcmFtZWJ1ZmZlckxvZCApO1xuCQkjZWxzZVxuCQkJcmV0dXJuIHRleHR1cmUyRCggdHJhbnNtaXNzaW9uU2FtcGxlck1hcCwgZnJhZ0Nvb3JkLnh5LCBmcmFtZWJ1ZmZlckxvZCApO1xuCQkjZW5kaWZcbgl9XG4JdmVjMyBhcHBseVZvbHVtZUF0dGVudWF0aW9uKCBjb25zdCBpbiB2ZWMzIHJhZGlhbmNlLCBjb25zdCBpbiBmbG9hdCB0cmFuc21pc3Npb25EaXN0YW5jZSwgY29uc3QgaW4gdmVjMyBhdHRlbnVhdGlvbkNvbG9yLCBjb25zdCBpbiBmbG9hdCBhdHRlbnVhdGlvbkRpc3RhbmNlICkge1xuCQlpZiAoIGF0dGVudWF0aW9uRGlzdGFuY2UgPT0gMC4wICkge1xuCQkJcmV0dXJuIHJhZGlhbmNlO1xuCQl9IGVsc2Uge1xuCQkJdmVjMyBhdHRlbnVhdGlvbkNvZWZmaWNpZW50ID0gLWxvZyggYXR0ZW51YXRpb25Db2xvciApIC8gYXR0ZW51YXRpb25EaXN0YW5jZTtcbgkJCXZlYzMgdHJhbnNtaXR0YW5jZSA9IGV4cCggLSBhdHRlbnVhdGlvbkNvZWZmaWNpZW50ICogdHJhbnNtaXNzaW9uRGlzdGFuY2UgKTsJCQlyZXR1cm4gdHJhbnNtaXR0YW5jZSAqIHJhZGlhbmNlO1xuCQl9XG4JfVxuCXZlYzQgZ2V0SUJMVm9sdW1lUmVmcmFjdGlvbiggY29uc3QgaW4gdmVjMyBuLCBjb25zdCBpbiB2ZWMzIHYsIGNvbnN0IGluIGZsb2F0IHJvdWdobmVzcywgY29uc3QgaW4gdmVjMyBkaWZmdXNlQ29sb3IsXG4JCWNvbnN0IGluIHZlYzMgc3BlY3VsYXJDb2xvciwgY29uc3QgaW4gZmxvYXQgc3BlY3VsYXJGOTAsIGNvbnN0IGluIHZlYzMgcG9zaXRpb24sIGNvbnN0IGluIG1hdDQgbW9kZWxNYXRyaXgsXG4JCWNvbnN0IGluIG1hdDQgdmlld01hdHJpeCwgY29uc3QgaW4gbWF0NCBwcm9qTWF0cml4LCBjb25zdCBpbiBmbG9hdCBpb3IsIGNvbnN0IGluIGZsb2F0IHRoaWNrbmVzcyxcbgkJY29uc3QgaW4gdmVjMyBhdHRlbnVhdGlvbkNvbG9yLCBjb25zdCBpbiBmbG9hdCBhdHRlbnVhdGlvbkRpc3RhbmNlICkge1xuCQl2ZWMzIHRyYW5zbWlzc2lvblJheSA9IGdldFZvbHVtZVRyYW5zbWlzc2lvblJheSggbiwgdiwgdGhpY2tuZXNzLCBpb3IsIG1vZGVsTWF0cml4ICk7XG4JCXZlYzMgcmVmcmFjdGVkUmF5RXhpdCA9IHBvc2l0aW9uICsgdHJhbnNtaXNzaW9uUmF5O1xuCQl2ZWM0IG5kY1BvcyA9IHByb2pNYXRyaXggKiB2aWV3TWF0cml4ICogdmVjNCggcmVmcmFjdGVkUmF5RXhpdCwgMS4wICk7XG4JCXZlYzIgcmVmcmFjdGlvbkNvb3JkcyA9IG5kY1Bvcy54eSAvIG5kY1Bvcy53O1xuCQlyZWZyYWN0aW9uQ29vcmRzICs9IDEuMDtcbgkJcmVmcmFjdGlvbkNvb3JkcyAvPSAyLjA7XG4JCXZlYzQgdHJhbnNtaXR0ZWRMaWdodCA9IGdldFRyYW5zbWlzc2lvblNhbXBsZSggcmVmcmFjdGlvbkNvb3Jkcywgcm91Z2huZXNzLCBpb3IgKTtcbgkJdmVjMyBhdHRlbnVhdGVkQ29sb3IgPSBhcHBseVZvbHVtZUF0dGVudWF0aW9uKCB0cmFuc21pdHRlZExpZ2h0LnJnYiwgbGVuZ3RoKCB0cmFuc21pc3Npb25SYXkgKSwgYXR0ZW51YXRpb25Db2xvciwgYXR0ZW51YXRpb25EaXN0YW5jZSApO1xuCQl2ZWMzIEYgPSBFbnZpcm9ubWVudEJSREYoIG4sIHYsIHNwZWN1bGFyQ29sb3IsIHNwZWN1bGFyRjkwLCByb3VnaG5lc3MgKTtcbgkJcmV0dXJuIHZlYzQoICggMS4wIC0gRiApICogYXR0ZW51YXRlZENvbG9yICogZGlmZnVzZUNvbG9yLCB0cmFuc21pdHRlZExpZ2h0LmEgKTtcbgl9XG4jZW5kaWYiOwp2YXIgdXZfcGFyc19mcmFnbWVudCA9ICIjaWYgKCBkZWZpbmVkKCBVU0VfVVYgKSAmJiAhIGRlZmluZWQoIFVWU19WRVJURVhfT05MWSApIClcbgl2YXJ5aW5nIHZlYzIgdlV2O1xuI2VuZGlmIjsKdmFyIHV2X3BhcnNfdmVydGV4ID0gIiNpZmRlZiBVU0VfVVZcbgkjaWZkZWYgVVZTX1ZFUlRFWF9PTkxZXG4JCXZlYzIgdlV2O1xuCSNlbHNlXG4JCXZhcnlpbmcgdmVjMiB2VXY7XG4JI2VuZGlmXG4JdW5pZm9ybSBtYXQzIHV2VHJhbnNmb3JtO1xuI2VuZGlmIjsKdmFyIHV2X3ZlcnRleCA9ICIjaWZkZWYgVVNFX1VWXG4JdlV2ID0gKCB1dlRyYW5zZm9ybSAqIHZlYzMoIHV2LCAxICkgKS54eTtcbiNlbmRpZiI7CnZhciB1djJfcGFyc19mcmFnbWVudCA9ICIjaWYgZGVmaW5lZCggVVNFX0xJR0hUTUFQICkgfHwgZGVmaW5lZCggVVNFX0FPTUFQIClcbgl2YXJ5aW5nIHZlYzIgdlV2MjtcbiNlbmRpZiI7CnZhciB1djJfcGFyc192ZXJ0ZXggPSAiI2lmIGRlZmluZWQoIFVTRV9MSUdIVE1BUCApIHx8IGRlZmluZWQoIFVTRV9BT01BUCApXG4JYXR0cmlidXRlIHZlYzIgdXYyO1xuCXZhcnlpbmcgdmVjMiB2VXYyO1xuCXVuaWZvcm0gbWF0MyB1djJUcmFuc2Zvcm07XG4jZW5kaWYiOwp2YXIgdXYyX3ZlcnRleCA9ICIjaWYgZGVmaW5lZCggVVNFX0xJR0hUTUFQICkgfHwgZGVmaW5lZCggVVNFX0FPTUFQIClcbgl2VXYyID0gKCB1djJUcmFuc2Zvcm0gKiB2ZWMzKCB1djIsIDEgKSApLnh5O1xuI2VuZGlmIjsKdmFyIHdvcmxkcG9zX3ZlcnRleCA9ICIjaWYgZGVmaW5lZCggVVNFX0VOVk1BUCApIHx8IGRlZmluZWQoIERJU1RBTkNFICkgfHwgZGVmaW5lZCAoIFVTRV9TSEFET1dNQVAgKSB8fCBkZWZpbmVkICggVVNFX1RSQU5TTUlTU0lPTiApXG4JdmVjNCB3b3JsZFBvc2l0aW9uID0gdmVjNCggdHJhbnNmb3JtZWQsIDEuMCApO1xuCSNpZmRlZiBVU0VfSU5TVEFOQ0lOR1xuCQl3b3JsZFBvc2l0aW9uID0gaW5zdGFuY2VNYXRyaXggKiB3b3JsZFBvc2l0aW9uO1xuCSNlbmRpZlxuCXdvcmxkUG9zaXRpb24gPSBtb2RlbE1hdHJpeCAqIHdvcmxkUG9zaXRpb247XG4jZW5kaWYiOwpjb25zdCB2ZXJ0ZXgkZyA9ICJ2YXJ5aW5nIHZlYzIgdlV2O1xudW5pZm9ybSBtYXQzIHV2VHJhbnNmb3JtO1xudm9pZCBtYWluKCkge1xuCXZVdiA9ICggdXZUcmFuc2Zvcm0gKiB2ZWMzKCB1diwgMSApICkueHk7XG4JZ2xfUG9zaXRpb24gPSB2ZWM0KCBwb3NpdGlvbi54eSwgMS4wLCAxLjAgKTtcbn0iOwpjb25zdCBmcmFnbWVudCRnID0gInVuaWZvcm0gc2FtcGxlcjJEIHQyRDtcbnZhcnlpbmcgdmVjMiB2VXY7XG52b2lkIG1haW4oKSB7XG4JZ2xfRnJhZ0NvbG9yID0gdGV4dHVyZTJEKCB0MkQsIHZVdiApO1xuCSNpbmNsdWRlIDx0b25lbWFwcGluZ19mcmFnbWVudD5cbgkjaW5jbHVkZSA8ZW5jb2RpbmdzX2ZyYWdtZW50PlxufSI7CmNvbnN0IHZlcnRleCRmID0gInZhcnlpbmcgdmVjMyB2V29ybGREaXJlY3Rpb247XG4jaW5jbHVkZSA8Y29tbW9uPlxudm9pZCBtYWluKCkge1xuCXZXb3JsZERpcmVjdGlvbiA9IHRyYW5zZm9ybURpcmVjdGlvbiggcG9zaXRpb24sIG1vZGVsTWF0cml4ICk7XG4JI2luY2x1ZGUgPGJlZ2luX3ZlcnRleD5cbgkjaW5jbHVkZSA8cHJvamVjdF92ZXJ0ZXg+XG4JZ2xfUG9zaXRpb24ueiA9IGdsX1Bvc2l0aW9uLnc7XG59IjsKY29uc3QgZnJhZ21lbnQkZiA9ICIjaW5jbHVkZSA8ZW52bWFwX2NvbW1vbl9wYXJzX2ZyYWdtZW50PlxudW5pZm9ybSBmbG9hdCBvcGFjaXR5O1xudmFyeWluZyB2ZWMzIHZXb3JsZERpcmVjdGlvbjtcbiNpbmNsdWRlIDxjdWJlX3V2X3JlZmxlY3Rpb25fZnJhZ21lbnQ+XG52b2lkIG1haW4oKSB7XG4JdmVjMyB2UmVmbGVjdCA9IHZXb3JsZERpcmVjdGlvbjtcbgkjaW5jbHVkZSA8ZW52bWFwX2ZyYWdtZW50PlxuCWdsX0ZyYWdDb2xvciA9IGVudkNvbG9yO1xuCWdsX0ZyYWdDb2xvci5hICo9IG9wYWNpdHk7XG4JI2luY2x1ZGUgPHRvbmVtYXBwaW5nX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxlbmNvZGluZ3NfZnJhZ21lbnQ+XG59IjsKY29uc3QgdmVydGV4JGUgPSAiI2luY2x1ZGUgPGNvbW1vbj5cbiNpbmNsdWRlIDx1dl9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxkaXNwbGFjZW1lbnRtYXBfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8bW9ycGh0YXJnZXRfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8c2tpbm5pbmdfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8bG9nZGVwdGhidWZfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfdmVydGV4PlxudmFyeWluZyB2ZWMyIHZIaWdoUHJlY2lzaW9uWlc7XG52b2lkIG1haW4oKSB7XG4JI2luY2x1ZGUgPHV2X3ZlcnRleD5cbgkjaW5jbHVkZSA8c2tpbmJhc2VfdmVydGV4PlxuCSNpZmRlZiBVU0VfRElTUExBQ0VNRU5UTUFQXG4JCSNpbmNsdWRlIDxiZWdpbm5vcm1hbF92ZXJ0ZXg+XG4JCSNpbmNsdWRlIDxtb3JwaG5vcm1hbF92ZXJ0ZXg+XG4JCSNpbmNsdWRlIDxza2lubm9ybWFsX3ZlcnRleD5cbgkjZW5kaWZcbgkjaW5jbHVkZSA8YmVnaW5fdmVydGV4PlxuCSNpbmNsdWRlIDxtb3JwaHRhcmdldF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPHNraW5uaW5nX3ZlcnRleD5cbgkjaW5jbHVkZSA8ZGlzcGxhY2VtZW50bWFwX3ZlcnRleD5cbgkjaW5jbHVkZSA8cHJvamVjdF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3ZlcnRleD5cbgkjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3ZlcnRleD5cbgl2SGlnaFByZWNpc2lvblpXID0gZ2xfUG9zaXRpb24uenc7XG59IjsKY29uc3QgZnJhZ21lbnQkZSA9ICIjaWYgREVQVEhfUEFDS0lORyA9PSAzMjAwXG4JdW5pZm9ybSBmbG9hdCBvcGFjaXR5O1xuI2VuZGlmXG4jaW5jbHVkZSA8Y29tbW9uPlxuI2luY2x1ZGUgPHBhY2tpbmc+XG4jaW5jbHVkZSA8dXZfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxhbHBoYW1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGFscGhhdGVzdF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfZnJhZ21lbnQ+XG52YXJ5aW5nIHZlYzIgdkhpZ2hQcmVjaXNpb25aVztcbnZvaWQgbWFpbigpIHtcbgkjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX2ZyYWdtZW50PlxuCXZlYzQgZGlmZnVzZUNvbG9yID0gdmVjNCggMS4wICk7XG4JI2lmIERFUFRIX1BBQ0tJTkcgPT0gMzIwMFxuCQlkaWZmdXNlQ29sb3IuYSA9IG9wYWNpdHk7XG4JI2VuZGlmXG4JI2luY2x1ZGUgPG1hcF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8YWxwaGFtYXBfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGFscGhhdGVzdF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8bG9nZGVwdGhidWZfZnJhZ21lbnQ+XG4JZmxvYXQgZnJhZ0Nvb3JkWiA9IDAuNSAqIHZIaWdoUHJlY2lzaW9uWldbMF0gLyB2SGlnaFByZWNpc2lvblpXWzFdICsgMC41O1xuCSNpZiBERVBUSF9QQUNLSU5HID09IDMyMDBcbgkJZ2xfRnJhZ0NvbG9yID0gdmVjNCggdmVjMyggMS4wIC0gZnJhZ0Nvb3JkWiApLCBvcGFjaXR5ICk7XG4JI2VsaWYgREVQVEhfUEFDS0lORyA9PSAzMjAxXG4JCWdsX0ZyYWdDb2xvciA9IHBhY2tEZXB0aFRvUkdCQSggZnJhZ0Nvb3JkWiApO1xuCSNlbmRpZlxufSI7CmNvbnN0IHZlcnRleCRkID0gIiNkZWZpbmUgRElTVEFOQ0VcbnZhcnlpbmcgdmVjMyB2V29ybGRQb3NpdGlvbjtcbiNpbmNsdWRlIDxjb21tb24+XG4jaW5jbHVkZSA8dXZfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8ZGlzcGxhY2VtZW50bWFwX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPG1vcnBodGFyZ2V0X3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPHNraW5uaW5nX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX3ZlcnRleD5cbnZvaWQgbWFpbigpIHtcbgkjaW5jbHVkZSA8dXZfdmVydGV4PlxuCSNpbmNsdWRlIDxza2luYmFzZV92ZXJ0ZXg+XG4JI2lmZGVmIFVTRV9ESVNQTEFDRU1FTlRNQVBcbgkJI2luY2x1ZGUgPGJlZ2lubm9ybWFsX3ZlcnRleD5cbgkJI2luY2x1ZGUgPG1vcnBobm9ybWFsX3ZlcnRleD5cbgkJI2luY2x1ZGUgPHNraW5ub3JtYWxfdmVydGV4PlxuCSNlbmRpZlxuCSNpbmNsdWRlIDxiZWdpbl92ZXJ0ZXg+XG4JI2luY2x1ZGUgPG1vcnBodGFyZ2V0X3ZlcnRleD5cbgkjaW5jbHVkZSA8c2tpbm5pbmdfdmVydGV4PlxuCSNpbmNsdWRlIDxkaXNwbGFjZW1lbnRtYXBfdmVydGV4PlxuCSNpbmNsdWRlIDxwcm9qZWN0X3ZlcnRleD5cbgkjaW5jbHVkZSA8d29ybGRwb3NfdmVydGV4PlxuCSNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfdmVydGV4PlxuCXZXb3JsZFBvc2l0aW9uID0gd29ybGRQb3NpdGlvbi54eXo7XG59IjsKY29uc3QgZnJhZ21lbnQkZCA9ICIjZGVmaW5lIERJU1RBTkNFXG51bmlmb3JtIHZlYzMgcmVmZXJlbmNlUG9zaXRpb247XG51bmlmb3JtIGZsb2F0IG5lYXJEaXN0YW5jZTtcbnVuaWZvcm0gZmxvYXQgZmFyRGlzdGFuY2U7XG52YXJ5aW5nIHZlYzMgdldvcmxkUG9zaXRpb247XG4jaW5jbHVkZSA8Y29tbW9uPlxuI2luY2x1ZGUgPHBhY2tpbmc+XG4jaW5jbHVkZSA8dXZfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxhbHBoYW1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGFscGhhdGVzdF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX2ZyYWdtZW50Plxudm9pZCBtYWluICgpIHtcbgkjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX2ZyYWdtZW50PlxuCXZlYzQgZGlmZnVzZUNvbG9yID0gdmVjNCggMS4wICk7XG4JI2luY2x1ZGUgPG1hcF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8YWxwaGFtYXBfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGFscGhhdGVzdF9mcmFnbWVudD5cbglmbG9hdCBkaXN0ID0gbGVuZ3RoKCB2V29ybGRQb3NpdGlvbiAtIHJlZmVyZW5jZVBvc2l0aW9uICk7XG4JZGlzdCA9ICggZGlzdCAtIG5lYXJEaXN0YW5jZSApIC8gKCBmYXJEaXN0YW5jZSAtIG5lYXJEaXN0YW5jZSApO1xuCWRpc3QgPSBzYXR1cmF0ZSggZGlzdCApO1xuCWdsX0ZyYWdDb2xvciA9IHBhY2tEZXB0aFRvUkdCQSggZGlzdCApO1xufSI7CmNvbnN0IHZlcnRleCRjID0gInZhcnlpbmcgdmVjMyB2V29ybGREaXJlY3Rpb247XG4jaW5jbHVkZSA8Y29tbW9uPlxudm9pZCBtYWluKCkge1xuCXZXb3JsZERpcmVjdGlvbiA9IHRyYW5zZm9ybURpcmVjdGlvbiggcG9zaXRpb24sIG1vZGVsTWF0cml4ICk7XG4JI2luY2x1ZGUgPGJlZ2luX3ZlcnRleD5cbgkjaW5jbHVkZSA8cHJvamVjdF92ZXJ0ZXg+XG59IjsKY29uc3QgZnJhZ21lbnQkYyA9ICJ1bmlmb3JtIHNhbXBsZXIyRCB0RXF1aXJlY3Q7XG52YXJ5aW5nIHZlYzMgdldvcmxkRGlyZWN0aW9uO1xuI2luY2x1ZGUgPGNvbW1vbj5cbnZvaWQgbWFpbigpIHtcbgl2ZWMzIGRpcmVjdGlvbiA9IG5vcm1hbGl6ZSggdldvcmxkRGlyZWN0aW9uICk7XG4JdmVjMiBzYW1wbGVVViA9IGVxdWlyZWN0VXYoIGRpcmVjdGlvbiApO1xuCWdsX0ZyYWdDb2xvciA9IHRleHR1cmUyRCggdEVxdWlyZWN0LCBzYW1wbGVVViApO1xuCSNpbmNsdWRlIDx0b25lbWFwcGluZ19mcmFnbWVudD5cbgkjaW5jbHVkZSA8ZW5jb2RpbmdzX2ZyYWdtZW50PlxufSI7CmNvbnN0IHZlcnRleCRiID0gInVuaWZvcm0gZmxvYXQgc2NhbGU7XG5hdHRyaWJ1dGUgZmxvYXQgbGluZURpc3RhbmNlO1xudmFyeWluZyBmbG9hdCB2TGluZURpc3RhbmNlO1xuI2luY2x1ZGUgPGNvbW1vbj5cbiNpbmNsdWRlIDxjb2xvcl9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxmb2dfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8bW9ycGh0YXJnZXRfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8bG9nZGVwdGhidWZfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfdmVydGV4Plxudm9pZCBtYWluKCkge1xuCXZMaW5lRGlzdGFuY2UgPSBzY2FsZSAqIGxpbmVEaXN0YW5jZTtcbgkjaW5jbHVkZSA8Y29sb3JfdmVydGV4PlxuCSNpbmNsdWRlIDxiZWdpbl92ZXJ0ZXg+XG4JI2luY2x1ZGUgPG1vcnBodGFyZ2V0X3ZlcnRleD5cbgkjaW5jbHVkZSA8cHJvamVjdF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3ZlcnRleD5cbgkjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3ZlcnRleD5cbgkjaW5jbHVkZSA8Zm9nX3ZlcnRleD5cbn0iOwpjb25zdCBmcmFnbWVudCRiID0gInVuaWZvcm0gdmVjMyBkaWZmdXNlO1xudW5pZm9ybSBmbG9hdCBvcGFjaXR5O1xudW5pZm9ybSBmbG9hdCBkYXNoU2l6ZTtcbnVuaWZvcm0gZmxvYXQgdG90YWxTaXplO1xudmFyeWluZyBmbG9hdCB2TGluZURpc3RhbmNlO1xuI2luY2x1ZGUgPGNvbW1vbj5cbiNpbmNsdWRlIDxjb2xvcl9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGZvZ19wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfZnJhZ21lbnQ+XG52b2lkIG1haW4oKSB7XG4JI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19mcmFnbWVudD5cbglpZiAoIG1vZCggdkxpbmVEaXN0YW5jZSwgdG90YWxTaXplICkgPiBkYXNoU2l6ZSApIHtcbgkJZGlzY2FyZDtcbgl9XG4JdmVjMyBvdXRnb2luZ0xpZ2h0ID0gdmVjMyggMC4wICk7XG4JdmVjNCBkaWZmdXNlQ29sb3IgPSB2ZWM0KCBkaWZmdXNlLCBvcGFjaXR5ICk7XG4JI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxjb2xvcl9mcmFnbWVudD5cbglvdXRnb2luZ0xpZ2h0ID0gZGlmZnVzZUNvbG9yLnJnYjtcbgkjaW5jbHVkZSA8b3V0cHV0X2ZyYWdtZW50PlxuCSNpbmNsdWRlIDx0b25lbWFwcGluZ19mcmFnbWVudD5cbgkjaW5jbHVkZSA8ZW5jb2RpbmdzX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxmb2dfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPHByZW11bHRpcGxpZWRfYWxwaGFfZnJhZ21lbnQ+XG59IjsKY29uc3QgdmVydGV4JGEgPSAiI2luY2x1ZGUgPGNvbW1vbj5cbiNpbmNsdWRlIDx1dl9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDx1djJfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8ZW52bWFwX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGNvbG9yX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGZvZ19wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxtb3JwaHRhcmdldF9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxza2lubmluZ19wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfcGFyc192ZXJ0ZXg+XG52b2lkIG1haW4oKSB7XG4JI2luY2x1ZGUgPHV2X3ZlcnRleD5cbgkjaW5jbHVkZSA8dXYyX3ZlcnRleD5cbgkjaW5jbHVkZSA8Y29sb3JfdmVydGV4PlxuCSNpZiBkZWZpbmVkICggVVNFX0VOVk1BUCApIHx8IGRlZmluZWQgKCBVU0VfU0tJTk5JTkcgKVxuCQkjaW5jbHVkZSA8YmVnaW5ub3JtYWxfdmVydGV4PlxuCQkjaW5jbHVkZSA8bW9ycGhub3JtYWxfdmVydGV4PlxuCQkjaW5jbHVkZSA8c2tpbmJhc2VfdmVydGV4PlxuCQkjaW5jbHVkZSA8c2tpbm5vcm1hbF92ZXJ0ZXg+XG4JCSNpbmNsdWRlIDxkZWZhdWx0bm9ybWFsX3ZlcnRleD5cbgkjZW5kaWZcbgkjaW5jbHVkZSA8YmVnaW5fdmVydGV4PlxuCSNpbmNsdWRlIDxtb3JwaHRhcmdldF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPHNraW5uaW5nX3ZlcnRleD5cbgkjaW5jbHVkZSA8cHJvamVjdF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3ZlcnRleD5cbgkjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3ZlcnRleD5cbgkjaW5jbHVkZSA8d29ybGRwb3NfdmVydGV4PlxuCSNpbmNsdWRlIDxlbnZtYXBfdmVydGV4PlxuCSNpbmNsdWRlIDxmb2dfdmVydGV4PlxufSI7CmNvbnN0IGZyYWdtZW50JGEgPSAidW5pZm9ybSB2ZWMzIGRpZmZ1c2U7XG51bmlmb3JtIGZsb2F0IG9wYWNpdHk7XG4jaWZuZGVmIEZMQVRfU0hBREVEXG4JdmFyeWluZyB2ZWMzIHZOb3JtYWw7XG4jZW5kaWZcbiNpbmNsdWRlIDxjb21tb24+XG4jaW5jbHVkZSA8ZGl0aGVyaW5nX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8Y29sb3JfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDx1dl9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPHV2Ml9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPG1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGFscGhhbWFwX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8YWxwaGF0ZXN0X3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8YW9tYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxsaWdodG1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGVudm1hcF9jb21tb25fcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxlbnZtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxjdWJlX3V2X3JlZmxlY3Rpb25fZnJhZ21lbnQ+XG4jaW5jbHVkZSA8Zm9nX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8c3BlY3VsYXJtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX2ZyYWdtZW50Plxudm9pZCBtYWluKCkge1xuCSNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfZnJhZ21lbnQ+XG4JdmVjNCBkaWZmdXNlQ29sb3IgPSB2ZWM0KCBkaWZmdXNlLCBvcGFjaXR5ICk7XG4JI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxtYXBfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGNvbG9yX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxhbHBoYW1hcF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8YWxwaGF0ZXN0X2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxzcGVjdWxhcm1hcF9mcmFnbWVudD5cbglSZWZsZWN0ZWRMaWdodCByZWZsZWN0ZWRMaWdodCA9IFJlZmxlY3RlZExpZ2h0KCB2ZWMzKCAwLjAgKSwgdmVjMyggMC4wICksIHZlYzMoIDAuMCApLCB2ZWMzKCAwLjAgKSApO1xuCSNpZmRlZiBVU0VfTElHSFRNQVBcbgkJdmVjNCBsaWdodE1hcFRleGVsPSB0ZXh0dXJlMkQoIGxpZ2h0TWFwLCB2VXYyICk7XG4JCXJlZmxlY3RlZExpZ2h0LmluZGlyZWN0RGlmZnVzZSArPSBsaWdodE1hcFRleGVsLnJnYiAqIGxpZ2h0TWFwSW50ZW5zaXR5O1xuCSNlbHNlXG4JCXJlZmxlY3RlZExpZ2h0LmluZGlyZWN0RGlmZnVzZSArPSB2ZWMzKCAxLjAgKTtcbgkjZW5kaWZcbgkjaW5jbHVkZSA8YW9tYXBfZnJhZ21lbnQ+XG4JcmVmbGVjdGVkTGlnaHQuaW5kaXJlY3REaWZmdXNlICo9IGRpZmZ1c2VDb2xvci5yZ2I7XG4JdmVjMyBvdXRnb2luZ0xpZ2h0ID0gcmVmbGVjdGVkTGlnaHQuaW5kaXJlY3REaWZmdXNlO1xuCSNpbmNsdWRlIDxlbnZtYXBfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPG91dHB1dF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8dG9uZW1hcHBpbmdfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGVuY29kaW5nc19mcmFnbWVudD5cbgkjaW5jbHVkZSA8Zm9nX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxwcmVtdWx0aXBsaWVkX2FscGhhX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxkaXRoZXJpbmdfZnJhZ21lbnQ+XG59IjsKY29uc3QgdmVydGV4JDkgPSAiI2RlZmluZSBMQU1CRVJUXG52YXJ5aW5nIHZlYzMgdkxpZ2h0RnJvbnQ7XG52YXJ5aW5nIHZlYzMgdkluZGlyZWN0RnJvbnQ7XG4jaWZkZWYgRE9VQkxFX1NJREVEXG4JdmFyeWluZyB2ZWMzIHZMaWdodEJhY2s7XG4JdmFyeWluZyB2ZWMzIHZJbmRpcmVjdEJhY2s7XG4jZW5kaWZcbiNpbmNsdWRlIDxjb21tb24+XG4jaW5jbHVkZSA8dXZfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8dXYyX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGVudm1hcF9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxic2Rmcz5cbiNpbmNsdWRlIDxsaWdodHNfcGFyc19iZWdpbj5cbiNpbmNsdWRlIDxjb2xvcl9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxmb2dfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8bW9ycGh0YXJnZXRfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8c2tpbm5pbmdfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8c2hhZG93bWFwX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX3ZlcnRleD5cbnZvaWQgbWFpbigpIHtcbgkjaW5jbHVkZSA8dXZfdmVydGV4PlxuCSNpbmNsdWRlIDx1djJfdmVydGV4PlxuCSNpbmNsdWRlIDxjb2xvcl92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGJlZ2lubm9ybWFsX3ZlcnRleD5cbgkjaW5jbHVkZSA8bW9ycGhub3JtYWxfdmVydGV4PlxuCSNpbmNsdWRlIDxza2luYmFzZV92ZXJ0ZXg+XG4JI2luY2x1ZGUgPHNraW5ub3JtYWxfdmVydGV4PlxuCSNpbmNsdWRlIDxkZWZhdWx0bm9ybWFsX3ZlcnRleD5cbgkjaW5jbHVkZSA8YmVnaW5fdmVydGV4PlxuCSNpbmNsdWRlIDxtb3JwaHRhcmdldF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPHNraW5uaW5nX3ZlcnRleD5cbgkjaW5jbHVkZSA8cHJvamVjdF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3ZlcnRleD5cbgkjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3ZlcnRleD5cbgkjaW5jbHVkZSA8d29ybGRwb3NfdmVydGV4PlxuCSNpbmNsdWRlIDxlbnZtYXBfdmVydGV4PlxuCSNpbmNsdWRlIDxsaWdodHNfbGFtYmVydF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPHNoYWRvd21hcF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGZvZ192ZXJ0ZXg+XG59IjsKY29uc3QgZnJhZ21lbnQkOSA9ICJ1bmlmb3JtIHZlYzMgZGlmZnVzZTtcbnVuaWZvcm0gdmVjMyBlbWlzc2l2ZTtcbnVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcbnZhcnlpbmcgdmVjMyB2TGlnaHRGcm9udDtcbnZhcnlpbmcgdmVjMyB2SW5kaXJlY3RGcm9udDtcbiNpZmRlZiBET1VCTEVfU0lERURcbgl2YXJ5aW5nIHZlYzMgdkxpZ2h0QmFjaztcbgl2YXJ5aW5nIHZlYzMgdkluZGlyZWN0QmFjaztcbiNlbmRpZlxuI2luY2x1ZGUgPGNvbW1vbj5cbiNpbmNsdWRlIDxwYWNraW5nPlxuI2luY2x1ZGUgPGRpdGhlcmluZ19wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGNvbG9yX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8dXZfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDx1djJfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxhbHBoYW1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGFscGhhdGVzdF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGFvbWFwX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8bGlnaHRtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxlbWlzc2l2ZW1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGVudm1hcF9jb21tb25fcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxlbnZtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxjdWJlX3V2X3JlZmxlY3Rpb25fZnJhZ21lbnQ+XG4jaW5jbHVkZSA8YnNkZnM+XG4jaW5jbHVkZSA8bGlnaHRzX3BhcnNfYmVnaW4+XG4jaW5jbHVkZSA8Zm9nX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8c2hhZG93bWFwX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8c2hhZG93bWFza19wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPHNwZWN1bGFybWFwX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8bG9nZGVwdGhidWZfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfcGFyc19mcmFnbWVudD5cbnZvaWQgbWFpbigpIHtcbgkjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX2ZyYWdtZW50PlxuCXZlYzQgZGlmZnVzZUNvbG9yID0gdmVjNCggZGlmZnVzZSwgb3BhY2l0eSApO1xuCVJlZmxlY3RlZExpZ2h0IHJlZmxlY3RlZExpZ2h0ID0gUmVmbGVjdGVkTGlnaHQoIHZlYzMoIDAuMCApLCB2ZWMzKCAwLjAgKSwgdmVjMyggMC4wICksIHZlYzMoIDAuMCApICk7XG4JdmVjMyB0b3RhbEVtaXNzaXZlUmFkaWFuY2UgPSBlbWlzc2l2ZTtcbgkjaW5jbHVkZSA8bG9nZGVwdGhidWZfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPG1hcF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8Y29sb3JfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGFscGhhbWFwX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxhbHBoYXRlc3RfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPHNwZWN1bGFybWFwX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxlbWlzc2l2ZW1hcF9mcmFnbWVudD5cbgkjaWZkZWYgRE9VQkxFX1NJREVEXG4JCXJlZmxlY3RlZExpZ2h0LmluZGlyZWN0RGlmZnVzZSArPSAoIGdsX0Zyb250RmFjaW5nICkgPyB2SW5kaXJlY3RGcm9udCA6IHZJbmRpcmVjdEJhY2s7XG4JI2Vsc2VcbgkJcmVmbGVjdGVkTGlnaHQuaW5kaXJlY3REaWZmdXNlICs9IHZJbmRpcmVjdEZyb250O1xuCSNlbmRpZlxuCSNpbmNsdWRlIDxsaWdodG1hcF9mcmFnbWVudD5cbglyZWZsZWN0ZWRMaWdodC5pbmRpcmVjdERpZmZ1c2UgKj0gQlJERl9MYW1iZXJ0KCBkaWZmdXNlQ29sb3IucmdiICk7XG4JI2lmZGVmIERPVUJMRV9TSURFRFxuCQlyZWZsZWN0ZWRMaWdodC5kaXJlY3REaWZmdXNlID0gKCBnbF9Gcm9udEZhY2luZyApID8gdkxpZ2h0RnJvbnQgOiB2TGlnaHRCYWNrO1xuCSNlbHNlXG4JCXJlZmxlY3RlZExpZ2h0LmRpcmVjdERpZmZ1c2UgPSB2TGlnaHRGcm9udDtcbgkjZW5kaWZcbglyZWZsZWN0ZWRMaWdodC5kaXJlY3REaWZmdXNlICo9IEJSREZfTGFtYmVydCggZGlmZnVzZUNvbG9yLnJnYiApICogZ2V0U2hhZG93TWFzaygpO1xuCSNpbmNsdWRlIDxhb21hcF9mcmFnbWVudD5cbgl2ZWMzIG91dGdvaW5nTGlnaHQgPSByZWZsZWN0ZWRMaWdodC5kaXJlY3REaWZmdXNlICsgcmVmbGVjdGVkTGlnaHQuaW5kaXJlY3REaWZmdXNlICsgdG90YWxFbWlzc2l2ZVJhZGlhbmNlO1xuCSNpbmNsdWRlIDxlbnZtYXBfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPG91dHB1dF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8dG9uZW1hcHBpbmdfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGVuY29kaW5nc19mcmFnbWVudD5cbgkjaW5jbHVkZSA8Zm9nX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxwcmVtdWx0aXBsaWVkX2FscGhhX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxkaXRoZXJpbmdfZnJhZ21lbnQ+XG59IjsKY29uc3QgdmVydGV4JDggPSAiI2RlZmluZSBNQVRDQVBcbnZhcnlpbmcgdmVjMyB2Vmlld1Bvc2l0aW9uO1xuI2luY2x1ZGUgPGNvbW1vbj5cbiNpbmNsdWRlIDx1dl9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxjb2xvcl9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxkaXNwbGFjZW1lbnRtYXBfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8Zm9nX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPG5vcm1hbF9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxtb3JwaHRhcmdldF9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxza2lubmluZ19wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfcGFyc192ZXJ0ZXg+XG52b2lkIG1haW4oKSB7XG4JI2luY2x1ZGUgPHV2X3ZlcnRleD5cbgkjaW5jbHVkZSA8Y29sb3JfdmVydGV4PlxuCSNpbmNsdWRlIDxiZWdpbm5vcm1hbF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPG1vcnBobm9ybWFsX3ZlcnRleD5cbgkjaW5jbHVkZSA8c2tpbmJhc2VfdmVydGV4PlxuCSNpbmNsdWRlIDxza2lubm9ybWFsX3ZlcnRleD5cbgkjaW5jbHVkZSA8ZGVmYXVsdG5vcm1hbF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPG5vcm1hbF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGJlZ2luX3ZlcnRleD5cbgkjaW5jbHVkZSA8bW9ycGh0YXJnZXRfdmVydGV4PlxuCSNpbmNsdWRlIDxza2lubmluZ192ZXJ0ZXg+XG4JI2luY2x1ZGUgPGRpc3BsYWNlbWVudG1hcF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPHByb2plY3RfdmVydGV4PlxuCSNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc192ZXJ0ZXg+XG4JI2luY2x1ZGUgPGZvZ192ZXJ0ZXg+XG4JdlZpZXdQb3NpdGlvbiA9IC0gbXZQb3NpdGlvbi54eXo7XG59IjsKY29uc3QgZnJhZ21lbnQkOCA9ICIjZGVmaW5lIE1BVENBUFxudW5pZm9ybSB2ZWMzIGRpZmZ1c2U7XG51bmlmb3JtIGZsb2F0IG9wYWNpdHk7XG51bmlmb3JtIHNhbXBsZXIyRCBtYXRjYXA7XG52YXJ5aW5nIHZlYzMgdlZpZXdQb3NpdGlvbjtcbiNpbmNsdWRlIDxjb21tb24+XG4jaW5jbHVkZSA8ZGl0aGVyaW5nX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8Y29sb3JfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDx1dl9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPG1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGFscGhhbWFwX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8YWxwaGF0ZXN0X3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8Zm9nX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8bm9ybWFsX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8YnVtcG1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPG5vcm1hbG1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfZnJhZ21lbnQ+XG52b2lkIG1haW4oKSB7XG4JI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19mcmFnbWVudD5cbgl2ZWM0IGRpZmZ1c2VDb2xvciA9IHZlYzQoIGRpZmZ1c2UsIG9wYWNpdHkgKTtcbgkjaW5jbHVkZSA8bG9nZGVwdGhidWZfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPG1hcF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8Y29sb3JfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGFscGhhbWFwX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxhbHBoYXRlc3RfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPG5vcm1hbF9mcmFnbWVudF9iZWdpbj5cbgkjaW5jbHVkZSA8bm9ybWFsX2ZyYWdtZW50X21hcHM+XG4JdmVjMyB2aWV3RGlyID0gbm9ybWFsaXplKCB2Vmlld1Bvc2l0aW9uICk7XG4JdmVjMyB4ID0gbm9ybWFsaXplKCB2ZWMzKCB2aWV3RGlyLnosIDAuMCwgLSB2aWV3RGlyLnggKSApO1xuCXZlYzMgeSA9IGNyb3NzKCB2aWV3RGlyLCB4ICk7XG4JdmVjMiB1diA9IHZlYzIoIGRvdCggeCwgbm9ybWFsICksIGRvdCggeSwgbm9ybWFsICkgKSAqIDAuNDk1ICsgMC41O1xuCSNpZmRlZiBVU0VfTUFUQ0FQXG4JCXZlYzQgbWF0Y2FwQ29sb3IgPSB0ZXh0dXJlMkQoIG1hdGNhcCwgdXYgKTtcbgkjZWxzZVxuCQl2ZWM0IG1hdGNhcENvbG9yID0gdmVjNCggdmVjMyggbWl4KCAwLjIsIDAuOCwgdXYueSApICksIDEuMCApO1xuCSNlbmRpZlxuCXZlYzMgb3V0Z29pbmdMaWdodCA9IGRpZmZ1c2VDb2xvci5yZ2IgKiBtYXRjYXBDb2xvci5yZ2I7XG4JI2luY2x1ZGUgPG91dHB1dF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8dG9uZW1hcHBpbmdfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGVuY29kaW5nc19mcmFnbWVudD5cbgkjaW5jbHVkZSA8Zm9nX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxwcmVtdWx0aXBsaWVkX2FscGhhX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxkaXRoZXJpbmdfZnJhZ21lbnQ+XG59IjsKY29uc3QgdmVydGV4JDcgPSAiI2RlZmluZSBOT1JNQUxcbiNpZiBkZWZpbmVkKCBGTEFUX1NIQURFRCApIHx8IGRlZmluZWQoIFVTRV9CVU1QTUFQICkgfHwgZGVmaW5lZCggVEFOR0VOVFNQQUNFX05PUk1BTE1BUCApXG4JdmFyeWluZyB2ZWMzIHZWaWV3UG9zaXRpb247XG4jZW5kaWZcbiNpbmNsdWRlIDxjb21tb24+XG4jaW5jbHVkZSA8dXZfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8ZGlzcGxhY2VtZW50bWFwX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPG5vcm1hbF9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxtb3JwaHRhcmdldF9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxza2lubmluZ19wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfcGFyc192ZXJ0ZXg+XG52b2lkIG1haW4oKSB7XG4JI2luY2x1ZGUgPHV2X3ZlcnRleD5cbgkjaW5jbHVkZSA8YmVnaW5ub3JtYWxfdmVydGV4PlxuCSNpbmNsdWRlIDxtb3JwaG5vcm1hbF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPHNraW5iYXNlX3ZlcnRleD5cbgkjaW5jbHVkZSA8c2tpbm5vcm1hbF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGRlZmF1bHRub3JtYWxfdmVydGV4PlxuCSNpbmNsdWRlIDxub3JtYWxfdmVydGV4PlxuCSNpbmNsdWRlIDxiZWdpbl92ZXJ0ZXg+XG4JI2luY2x1ZGUgPG1vcnBodGFyZ2V0X3ZlcnRleD5cbgkjaW5jbHVkZSA8c2tpbm5pbmdfdmVydGV4PlxuCSNpbmNsdWRlIDxkaXNwbGFjZW1lbnRtYXBfdmVydGV4PlxuCSNpbmNsdWRlIDxwcm9qZWN0X3ZlcnRleD5cbgkjaW5jbHVkZSA8bG9nZGVwdGhidWZfdmVydGV4PlxuCSNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfdmVydGV4PlxuI2lmIGRlZmluZWQoIEZMQVRfU0hBREVEICkgfHwgZGVmaW5lZCggVVNFX0JVTVBNQVAgKSB8fCBkZWZpbmVkKCBUQU5HRU5UU1BBQ0VfTk9STUFMTUFQIClcbgl2Vmlld1Bvc2l0aW9uID0gLSBtdlBvc2l0aW9uLnh5ejtcbiNlbmRpZlxufSI7CmNvbnN0IGZyYWdtZW50JDcgPSAiI2RlZmluZSBOT1JNQUxcbnVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcbiNpZiBkZWZpbmVkKCBGTEFUX1NIQURFRCApIHx8IGRlZmluZWQoIFVTRV9CVU1QTUFQICkgfHwgZGVmaW5lZCggVEFOR0VOVFNQQUNFX05PUk1BTE1BUCApXG4JdmFyeWluZyB2ZWMzIHZWaWV3UG9zaXRpb247XG4jZW5kaWZcbiNpbmNsdWRlIDxwYWNraW5nPlxuI2luY2x1ZGUgPHV2X3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8bm9ybWFsX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8YnVtcG1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPG5vcm1hbG1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfZnJhZ21lbnQ+XG52b2lkIG1haW4oKSB7XG4JI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19mcmFnbWVudD5cbgkjaW5jbHVkZSA8bG9nZGVwdGhidWZfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPG5vcm1hbF9mcmFnbWVudF9iZWdpbj5cbgkjaW5jbHVkZSA8bm9ybWFsX2ZyYWdtZW50X21hcHM+XG4JZ2xfRnJhZ0NvbG9yID0gdmVjNCggcGFja05vcm1hbFRvUkdCKCBub3JtYWwgKSwgb3BhY2l0eSApO1xuCSNpZmRlZiBPUEFRVUVcbgkJZ2xfRnJhZ0NvbG9yLmEgPSAxLjA7XG4JI2VuZGlmXG59IjsKY29uc3QgdmVydGV4JDYgPSAiI2RlZmluZSBQSE9OR1xudmFyeWluZyB2ZWMzIHZWaWV3UG9zaXRpb247XG4jaW5jbHVkZSA8Y29tbW9uPlxuI2luY2x1ZGUgPHV2X3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPHV2Ml9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxkaXNwbGFjZW1lbnRtYXBfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8ZW52bWFwX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGNvbG9yX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGZvZ19wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxub3JtYWxfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8bW9ycGh0YXJnZXRfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8c2tpbm5pbmdfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8c2hhZG93bWFwX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX3ZlcnRleD5cbnZvaWQgbWFpbigpIHtcbgkjaW5jbHVkZSA8dXZfdmVydGV4PlxuCSNpbmNsdWRlIDx1djJfdmVydGV4PlxuCSNpbmNsdWRlIDxjb2xvcl92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGJlZ2lubm9ybWFsX3ZlcnRleD5cbgkjaW5jbHVkZSA8bW9ycGhub3JtYWxfdmVydGV4PlxuCSNpbmNsdWRlIDxza2luYmFzZV92ZXJ0ZXg+XG4JI2luY2x1ZGUgPHNraW5ub3JtYWxfdmVydGV4PlxuCSNpbmNsdWRlIDxkZWZhdWx0bm9ybWFsX3ZlcnRleD5cbgkjaW5jbHVkZSA8bm9ybWFsX3ZlcnRleD5cbgkjaW5jbHVkZSA8YmVnaW5fdmVydGV4PlxuCSNpbmNsdWRlIDxtb3JwaHRhcmdldF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPHNraW5uaW5nX3ZlcnRleD5cbgkjaW5jbHVkZSA8ZGlzcGxhY2VtZW50bWFwX3ZlcnRleD5cbgkjaW5jbHVkZSA8cHJvamVjdF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3ZlcnRleD5cbgkjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3ZlcnRleD5cbgl2Vmlld1Bvc2l0aW9uID0gLSBtdlBvc2l0aW9uLnh5ejtcbgkjaW5jbHVkZSA8d29ybGRwb3NfdmVydGV4PlxuCSNpbmNsdWRlIDxlbnZtYXBfdmVydGV4PlxuCSNpbmNsdWRlIDxzaGFkb3dtYXBfdmVydGV4PlxuCSNpbmNsdWRlIDxmb2dfdmVydGV4PlxufSI7CmNvbnN0IGZyYWdtZW50JDYgPSAiI2RlZmluZSBQSE9OR1xudW5pZm9ybSB2ZWMzIGRpZmZ1c2U7XG51bmlmb3JtIHZlYzMgZW1pc3NpdmU7XG51bmlmb3JtIHZlYzMgc3BlY3VsYXI7XG51bmlmb3JtIGZsb2F0IHNoaW5pbmVzcztcbnVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcbiNpbmNsdWRlIDxjb21tb24+XG4jaW5jbHVkZSA8cGFja2luZz5cbiNpbmNsdWRlIDxkaXRoZXJpbmdfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxjb2xvcl9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPHV2X3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8dXYyX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8bWFwX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8YWxwaGFtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxhbHBoYXRlc3RfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxhb21hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGxpZ2h0bWFwX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8ZW1pc3NpdmVtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxlbnZtYXBfY29tbW9uX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8ZW52bWFwX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8Y3ViZV91dl9yZWZsZWN0aW9uX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGZvZ19wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGJzZGZzPlxuI2luY2x1ZGUgPGxpZ2h0c19wYXJzX2JlZ2luPlxuI2luY2x1ZGUgPG5vcm1hbF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGxpZ2h0c19waG9uZ19wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPHNoYWRvd21hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGJ1bXBtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxub3JtYWxtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxzcGVjdWxhcm1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfZnJhZ21lbnQ+XG52b2lkIG1haW4oKSB7XG4JI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19mcmFnbWVudD5cbgl2ZWM0IGRpZmZ1c2VDb2xvciA9IHZlYzQoIGRpZmZ1c2UsIG9wYWNpdHkgKTtcbglSZWZsZWN0ZWRMaWdodCByZWZsZWN0ZWRMaWdodCA9IFJlZmxlY3RlZExpZ2h0KCB2ZWMzKCAwLjAgKSwgdmVjMyggMC4wICksIHZlYzMoIDAuMCApLCB2ZWMzKCAwLjAgKSApO1xuCXZlYzMgdG90YWxFbWlzc2l2ZVJhZGlhbmNlID0gZW1pc3NpdmU7XG4JI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxtYXBfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGNvbG9yX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxhbHBoYW1hcF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8YWxwaGF0ZXN0X2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxzcGVjdWxhcm1hcF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8bm9ybWFsX2ZyYWdtZW50X2JlZ2luPlxuCSNpbmNsdWRlIDxub3JtYWxfZnJhZ21lbnRfbWFwcz5cbgkjaW5jbHVkZSA8ZW1pc3NpdmVtYXBfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGxpZ2h0c19waG9uZ19mcmFnbWVudD5cbgkjaW5jbHVkZSA8bGlnaHRzX2ZyYWdtZW50X2JlZ2luPlxuCSNpbmNsdWRlIDxsaWdodHNfZnJhZ21lbnRfbWFwcz5cbgkjaW5jbHVkZSA8bGlnaHRzX2ZyYWdtZW50X2VuZD5cbgkjaW5jbHVkZSA8YW9tYXBfZnJhZ21lbnQ+XG4JdmVjMyBvdXRnb2luZ0xpZ2h0ID0gcmVmbGVjdGVkTGlnaHQuZGlyZWN0RGlmZnVzZSArIHJlZmxlY3RlZExpZ2h0LmluZGlyZWN0RGlmZnVzZSArIHJlZmxlY3RlZExpZ2h0LmRpcmVjdFNwZWN1bGFyICsgcmVmbGVjdGVkTGlnaHQuaW5kaXJlY3RTcGVjdWxhciArIHRvdGFsRW1pc3NpdmVSYWRpYW5jZTtcbgkjaW5jbHVkZSA8ZW52bWFwX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxvdXRwdXRfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPHRvbmVtYXBwaW5nX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxlbmNvZGluZ3NfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGZvZ19mcmFnbWVudD5cbgkjaW5jbHVkZSA8cHJlbXVsdGlwbGllZF9hbHBoYV9mcmFnbWVudD5cbgkjaW5jbHVkZSA8ZGl0aGVyaW5nX2ZyYWdtZW50PlxufSI7CmNvbnN0IHZlcnRleCQ1ID0gIiNkZWZpbmUgU1RBTkRBUkRcbnZhcnlpbmcgdmVjMyB2Vmlld1Bvc2l0aW9uO1xuI2lmZGVmIFVTRV9UUkFOU01JU1NJT05cbgl2YXJ5aW5nIHZlYzMgdldvcmxkUG9zaXRpb247XG4jZW5kaWZcbiNpbmNsdWRlIDxjb21tb24+XG4jaW5jbHVkZSA8dXZfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8dXYyX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGRpc3BsYWNlbWVudG1hcF9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxjb2xvcl9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxmb2dfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8bm9ybWFsX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPG1vcnBodGFyZ2V0X3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPHNraW5uaW5nX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPHNoYWRvd21hcF9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfcGFyc192ZXJ0ZXg+XG52b2lkIG1haW4oKSB7XG4JI2luY2x1ZGUgPHV2X3ZlcnRleD5cbgkjaW5jbHVkZSA8dXYyX3ZlcnRleD5cbgkjaW5jbHVkZSA8Y29sb3JfdmVydGV4PlxuCSNpbmNsdWRlIDxiZWdpbm5vcm1hbF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPG1vcnBobm9ybWFsX3ZlcnRleD5cbgkjaW5jbHVkZSA8c2tpbmJhc2VfdmVydGV4PlxuCSNpbmNsdWRlIDxza2lubm9ybWFsX3ZlcnRleD5cbgkjaW5jbHVkZSA8ZGVmYXVsdG5vcm1hbF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPG5vcm1hbF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGJlZ2luX3ZlcnRleD5cbgkjaW5jbHVkZSA8bW9ycGh0YXJnZXRfdmVydGV4PlxuCSNpbmNsdWRlIDxza2lubmluZ192ZXJ0ZXg+XG4JI2luY2x1ZGUgPGRpc3BsYWNlbWVudG1hcF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPHByb2plY3RfdmVydGV4PlxuCSNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc192ZXJ0ZXg+XG4JdlZpZXdQb3NpdGlvbiA9IC0gbXZQb3NpdGlvbi54eXo7XG4JI2luY2x1ZGUgPHdvcmxkcG9zX3ZlcnRleD5cbgkjaW5jbHVkZSA8c2hhZG93bWFwX3ZlcnRleD5cbgkjaW5jbHVkZSA8Zm9nX3ZlcnRleD5cbiNpZmRlZiBVU0VfVFJBTlNNSVNTSU9OXG4JdldvcmxkUG9zaXRpb24gPSB3b3JsZFBvc2l0aW9uLnh5ejtcbiNlbmRpZlxufSI7CmNvbnN0IGZyYWdtZW50JDUgPSAiI2RlZmluZSBTVEFOREFSRFxuI2lmZGVmIFBIWVNJQ0FMXG4JI2RlZmluZSBJT1JcbgkjZGVmaW5lIFNQRUNVTEFSXG4jZW5kaWZcbnVuaWZvcm0gdmVjMyBkaWZmdXNlO1xudW5pZm9ybSB2ZWMzIGVtaXNzaXZlO1xudW5pZm9ybSBmbG9hdCByb3VnaG5lc3M7XG51bmlmb3JtIGZsb2F0IG1ldGFsbmVzcztcbnVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcbiNpZmRlZiBJT1Jcbgl1bmlmb3JtIGZsb2F0IGlvcjtcbiNlbmRpZlxuI2lmZGVmIFNQRUNVTEFSXG4JdW5pZm9ybSBmbG9hdCBzcGVjdWxhckludGVuc2l0eTtcbgl1bmlmb3JtIHZlYzMgc3BlY3VsYXJDb2xvcjtcbgkjaWZkZWYgVVNFX1NQRUNVTEFSSU5URU5TSVRZTUFQXG4JCXVuaWZvcm0gc2FtcGxlcjJEIHNwZWN1bGFySW50ZW5zaXR5TWFwO1xuCSNlbmRpZlxuCSNpZmRlZiBVU0VfU1BFQ1VMQVJDT0xPUk1BUFxuCQl1bmlmb3JtIHNhbXBsZXIyRCBzcGVjdWxhckNvbG9yTWFwO1xuCSNlbmRpZlxuI2VuZGlmXG4jaWZkZWYgVVNFX0NMRUFSQ09BVFxuCXVuaWZvcm0gZmxvYXQgY2xlYXJjb2F0O1xuCXVuaWZvcm0gZmxvYXQgY2xlYXJjb2F0Um91Z2huZXNzO1xuI2VuZGlmXG4jaWZkZWYgVVNFX1NIRUVOXG4JdW5pZm9ybSB2ZWMzIHNoZWVuQ29sb3I7XG4JdW5pZm9ybSBmbG9hdCBzaGVlblJvdWdobmVzcztcbgkjaWZkZWYgVVNFX1NIRUVOQ09MT1JNQVBcbgkJdW5pZm9ybSBzYW1wbGVyMkQgc2hlZW5Db2xvck1hcDtcbgkjZW5kaWZcbgkjaWZkZWYgVVNFX1NIRUVOUk9VR0hORVNTTUFQXG4JCXVuaWZvcm0gc2FtcGxlcjJEIHNoZWVuUm91Z2huZXNzTWFwO1xuCSNlbmRpZlxuI2VuZGlmXG52YXJ5aW5nIHZlYzMgdlZpZXdQb3NpdGlvbjtcbiNpbmNsdWRlIDxjb21tb24+XG4jaW5jbHVkZSA8cGFja2luZz5cbiNpbmNsdWRlIDxkaXRoZXJpbmdfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxjb2xvcl9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPHV2X3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8dXYyX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8bWFwX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8YWxwaGFtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxhbHBoYXRlc3RfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxhb21hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGxpZ2h0bWFwX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8ZW1pc3NpdmVtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxic2Rmcz5cbiNpbmNsdWRlIDxjdWJlX3V2X3JlZmxlY3Rpb25fZnJhZ21lbnQ+XG4jaW5jbHVkZSA8ZW52bWFwX2NvbW1vbl9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGVudm1hcF9waHlzaWNhbF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGZvZ19wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGxpZ2h0c19wYXJzX2JlZ2luPlxuI2luY2x1ZGUgPG5vcm1hbF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGxpZ2h0c19waHlzaWNhbF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPHRyYW5zbWlzc2lvbl9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPHNoYWRvd21hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGJ1bXBtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxub3JtYWxtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxjbGVhcmNvYXRfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxyb3VnaG5lc3NtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxtZXRhbG5lc3NtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX2ZyYWdtZW50Plxudm9pZCBtYWluKCkge1xuCSNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfZnJhZ21lbnQ+XG4JdmVjNCBkaWZmdXNlQ29sb3IgPSB2ZWM0KCBkaWZmdXNlLCBvcGFjaXR5ICk7XG4JUmVmbGVjdGVkTGlnaHQgcmVmbGVjdGVkTGlnaHQgPSBSZWZsZWN0ZWRMaWdodCggdmVjMyggMC4wICksIHZlYzMoIDAuMCApLCB2ZWMzKCAwLjAgKSwgdmVjMyggMC4wICkgKTtcbgl2ZWMzIHRvdGFsRW1pc3NpdmVSYWRpYW5jZSA9IGVtaXNzaXZlO1xuCSNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9mcmFnbWVudD5cbgkjaW5jbHVkZSA8bWFwX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxjb2xvcl9mcmFnbWVudD5cbgkjaW5jbHVkZSA8YWxwaGFtYXBfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGFscGhhdGVzdF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8cm91Z2huZXNzbWFwX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxtZXRhbG5lc3NtYXBfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPG5vcm1hbF9mcmFnbWVudF9iZWdpbj5cbgkjaW5jbHVkZSA8bm9ybWFsX2ZyYWdtZW50X21hcHM+XG4JI2luY2x1ZGUgPGNsZWFyY29hdF9ub3JtYWxfZnJhZ21lbnRfYmVnaW4+XG4JI2luY2x1ZGUgPGNsZWFyY29hdF9ub3JtYWxfZnJhZ21lbnRfbWFwcz5cbgkjaW5jbHVkZSA8ZW1pc3NpdmVtYXBfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGxpZ2h0c19waHlzaWNhbF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8bGlnaHRzX2ZyYWdtZW50X2JlZ2luPlxuCSNpbmNsdWRlIDxsaWdodHNfZnJhZ21lbnRfbWFwcz5cbgkjaW5jbHVkZSA8bGlnaHRzX2ZyYWdtZW50X2VuZD5cbgkjaW5jbHVkZSA8YW9tYXBfZnJhZ21lbnQ+XG4JdmVjMyB0b3RhbERpZmZ1c2UgPSByZWZsZWN0ZWRMaWdodC5kaXJlY3REaWZmdXNlICsgcmVmbGVjdGVkTGlnaHQuaW5kaXJlY3REaWZmdXNlO1xuCXZlYzMgdG90YWxTcGVjdWxhciA9IHJlZmxlY3RlZExpZ2h0LmRpcmVjdFNwZWN1bGFyICsgcmVmbGVjdGVkTGlnaHQuaW5kaXJlY3RTcGVjdWxhcjtcbgkjaW5jbHVkZSA8dHJhbnNtaXNzaW9uX2ZyYWdtZW50PlxuCXZlYzMgb3V0Z29pbmdMaWdodCA9IHRvdGFsRGlmZnVzZSArIHRvdGFsU3BlY3VsYXIgKyB0b3RhbEVtaXNzaXZlUmFkaWFuY2U7XG4JI2lmZGVmIFVTRV9TSEVFTlxuCQlmbG9hdCBzaGVlbkVuZXJneUNvbXAgPSAxLjAgLSAwLjE1NyAqIG1heDMoIG1hdGVyaWFsLnNoZWVuQ29sb3IgKTtcbgkJb3V0Z29pbmdMaWdodCA9IG91dGdvaW5nTGlnaHQgKiBzaGVlbkVuZXJneUNvbXAgKyBzaGVlblNwZWN1bGFyO1xuCSNlbmRpZlxuCSNpZmRlZiBVU0VfQ0xFQVJDT0FUXG4JCWZsb2F0IGRvdE5WY2MgPSBzYXR1cmF0ZSggZG90KCBnZW9tZXRyeS5jbGVhcmNvYXROb3JtYWwsIGdlb21ldHJ5LnZpZXdEaXIgKSApO1xuCQl2ZWMzIEZjYyA9IEZfU2NobGljayggbWF0ZXJpYWwuY2xlYXJjb2F0RjAsIG1hdGVyaWFsLmNsZWFyY29hdEY5MCwgZG90TlZjYyApO1xuCQlvdXRnb2luZ0xpZ2h0ID0gb3V0Z29pbmdMaWdodCAqICggMS4wIC0gbWF0ZXJpYWwuY2xlYXJjb2F0ICogRmNjICkgKyBjbGVhcmNvYXRTcGVjdWxhciAqIG1hdGVyaWFsLmNsZWFyY29hdDtcbgkjZW5kaWZcbgkjaW5jbHVkZSA8b3V0cHV0X2ZyYWdtZW50PlxuCSNpbmNsdWRlIDx0b25lbWFwcGluZ19mcmFnbWVudD5cbgkjaW5jbHVkZSA8ZW5jb2RpbmdzX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxmb2dfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPHByZW11bHRpcGxpZWRfYWxwaGFfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGRpdGhlcmluZ19mcmFnbWVudD5cbn0iOwpjb25zdCB2ZXJ0ZXgkNCA9ICIjZGVmaW5lIFRPT05cbnZhcnlpbmcgdmVjMyB2Vmlld1Bvc2l0aW9uO1xuI2luY2x1ZGUgPGNvbW1vbj5cbiNpbmNsdWRlIDx1dl9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDx1djJfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8ZGlzcGxhY2VtZW50bWFwX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGNvbG9yX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGZvZ19wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxub3JtYWxfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8bW9ycGh0YXJnZXRfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8c2tpbm5pbmdfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8c2hhZG93bWFwX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX3ZlcnRleD5cbnZvaWQgbWFpbigpIHtcbgkjaW5jbHVkZSA8dXZfdmVydGV4PlxuCSNpbmNsdWRlIDx1djJfdmVydGV4PlxuCSNpbmNsdWRlIDxjb2xvcl92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGJlZ2lubm9ybWFsX3ZlcnRleD5cbgkjaW5jbHVkZSA8bW9ycGhub3JtYWxfdmVydGV4PlxuCSNpbmNsdWRlIDxza2luYmFzZV92ZXJ0ZXg+XG4JI2luY2x1ZGUgPHNraW5ub3JtYWxfdmVydGV4PlxuCSNpbmNsdWRlIDxkZWZhdWx0bm9ybWFsX3ZlcnRleD5cbgkjaW5jbHVkZSA8bm9ybWFsX3ZlcnRleD5cbgkjaW5jbHVkZSA8YmVnaW5fdmVydGV4PlxuCSNpbmNsdWRlIDxtb3JwaHRhcmdldF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPHNraW5uaW5nX3ZlcnRleD5cbgkjaW5jbHVkZSA8ZGlzcGxhY2VtZW50bWFwX3ZlcnRleD5cbgkjaW5jbHVkZSA8cHJvamVjdF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3ZlcnRleD5cbgkjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3ZlcnRleD5cbgl2Vmlld1Bvc2l0aW9uID0gLSBtdlBvc2l0aW9uLnh5ejtcbgkjaW5jbHVkZSA8d29ybGRwb3NfdmVydGV4PlxuCSNpbmNsdWRlIDxzaGFkb3dtYXBfdmVydGV4PlxuCSNpbmNsdWRlIDxmb2dfdmVydGV4PlxufSI7CmNvbnN0IGZyYWdtZW50JDQgPSAiI2RlZmluZSBUT09OXG51bmlmb3JtIHZlYzMgZGlmZnVzZTtcbnVuaWZvcm0gdmVjMyBlbWlzc2l2ZTtcbnVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcbiNpbmNsdWRlIDxjb21tb24+XG4jaW5jbHVkZSA8cGFja2luZz5cbiNpbmNsdWRlIDxkaXRoZXJpbmdfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxjb2xvcl9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPHV2X3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8dXYyX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8bWFwX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8YWxwaGFtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxhbHBoYXRlc3RfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxhb21hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGxpZ2h0bWFwX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8ZW1pc3NpdmVtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxncmFkaWVudG1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGZvZ19wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGJzZGZzPlxuI2luY2x1ZGUgPGxpZ2h0c19wYXJzX2JlZ2luPlxuI2luY2x1ZGUgPG5vcm1hbF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGxpZ2h0c190b29uX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8c2hhZG93bWFwX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8YnVtcG1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPG5vcm1hbG1hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfZnJhZ21lbnQ+XG52b2lkIG1haW4oKSB7XG4JI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19mcmFnbWVudD5cbgl2ZWM0IGRpZmZ1c2VDb2xvciA9IHZlYzQoIGRpZmZ1c2UsIG9wYWNpdHkgKTtcbglSZWZsZWN0ZWRMaWdodCByZWZsZWN0ZWRMaWdodCA9IFJlZmxlY3RlZExpZ2h0KCB2ZWMzKCAwLjAgKSwgdmVjMyggMC4wICksIHZlYzMoIDAuMCApLCB2ZWMzKCAwLjAgKSApO1xuCXZlYzMgdG90YWxFbWlzc2l2ZVJhZGlhbmNlID0gZW1pc3NpdmU7XG4JI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxtYXBfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGNvbG9yX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxhbHBoYW1hcF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8YWxwaGF0ZXN0X2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxub3JtYWxfZnJhZ21lbnRfYmVnaW4+XG4JI2luY2x1ZGUgPG5vcm1hbF9mcmFnbWVudF9tYXBzPlxuCSNpbmNsdWRlIDxlbWlzc2l2ZW1hcF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8bGlnaHRzX3Rvb25fZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGxpZ2h0c19mcmFnbWVudF9iZWdpbj5cbgkjaW5jbHVkZSA8bGlnaHRzX2ZyYWdtZW50X21hcHM+XG4JI2luY2x1ZGUgPGxpZ2h0c19mcmFnbWVudF9lbmQ+XG4JI2luY2x1ZGUgPGFvbWFwX2ZyYWdtZW50PlxuCXZlYzMgb3V0Z29pbmdMaWdodCA9IHJlZmxlY3RlZExpZ2h0LmRpcmVjdERpZmZ1c2UgKyByZWZsZWN0ZWRMaWdodC5pbmRpcmVjdERpZmZ1c2UgKyB0b3RhbEVtaXNzaXZlUmFkaWFuY2U7XG4JI2luY2x1ZGUgPG91dHB1dF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8dG9uZW1hcHBpbmdfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGVuY29kaW5nc19mcmFnbWVudD5cbgkjaW5jbHVkZSA8Zm9nX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxwcmVtdWx0aXBsaWVkX2FscGhhX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxkaXRoZXJpbmdfZnJhZ21lbnQ+XG59IjsKY29uc3QgdmVydGV4JDMgPSAidW5pZm9ybSBmbG9hdCBzaXplO1xudW5pZm9ybSBmbG9hdCBzY2FsZTtcbiNpbmNsdWRlIDxjb21tb24+XG4jaW5jbHVkZSA8Y29sb3JfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8Zm9nX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPG1vcnBodGFyZ2V0X3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX3ZlcnRleD5cbnZvaWQgbWFpbigpIHtcbgkjaW5jbHVkZSA8Y29sb3JfdmVydGV4PlxuCSNpbmNsdWRlIDxiZWdpbl92ZXJ0ZXg+XG4JI2luY2x1ZGUgPG1vcnBodGFyZ2V0X3ZlcnRleD5cbgkjaW5jbHVkZSA8cHJvamVjdF92ZXJ0ZXg+XG4JZ2xfUG9pbnRTaXplID0gc2l6ZTtcbgkjaWZkZWYgVVNFX1NJWkVBVFRFTlVBVElPTlxuCQlib29sIGlzUGVyc3BlY3RpdmUgPSBpc1BlcnNwZWN0aXZlTWF0cml4KCBwcm9qZWN0aW9uTWF0cml4ICk7XG4JCWlmICggaXNQZXJzcGVjdGl2ZSApIGdsX1BvaW50U2l6ZSAqPSAoIHNjYWxlIC8gLSBtdlBvc2l0aW9uLnogKTtcbgkjZW5kaWZcbgkjaW5jbHVkZSA8bG9nZGVwdGhidWZfdmVydGV4PlxuCSNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfdmVydGV4PlxuCSNpbmNsdWRlIDx3b3JsZHBvc192ZXJ0ZXg+XG4JI2luY2x1ZGUgPGZvZ192ZXJ0ZXg+XG59IjsKY29uc3QgZnJhZ21lbnQkMyA9ICJ1bmlmb3JtIHZlYzMgZGlmZnVzZTtcbnVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcbiNpbmNsdWRlIDxjb21tb24+XG4jaW5jbHVkZSA8Y29sb3JfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxtYXBfcGFydGljbGVfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxhbHBoYXRlc3RfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxmb2dfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX2ZyYWdtZW50Plxudm9pZCBtYWluKCkge1xuCSNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfZnJhZ21lbnQ+XG4JdmVjMyBvdXRnb2luZ0xpZ2h0ID0gdmVjMyggMC4wICk7XG4JdmVjNCBkaWZmdXNlQ29sb3IgPSB2ZWM0KCBkaWZmdXNlLCBvcGFjaXR5ICk7XG4JI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxtYXBfcGFydGljbGVfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGNvbG9yX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxhbHBoYXRlc3RfZnJhZ21lbnQ+XG4Jb3V0Z29pbmdMaWdodCA9IGRpZmZ1c2VDb2xvci5yZ2I7XG4JI2luY2x1ZGUgPG91dHB1dF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8dG9uZW1hcHBpbmdfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGVuY29kaW5nc19mcmFnbWVudD5cbgkjaW5jbHVkZSA8Zm9nX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxwcmVtdWx0aXBsaWVkX2FscGhhX2ZyYWdtZW50PlxufSI7CmNvbnN0IHZlcnRleCQyID0gIiNpbmNsdWRlIDxjb21tb24+XG4jaW5jbHVkZSA8Zm9nX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPG1vcnBodGFyZ2V0X3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPHNraW5uaW5nX3BhcnNfdmVydGV4PlxuI2luY2x1ZGUgPHNoYWRvd21hcF9wYXJzX3ZlcnRleD5cbnZvaWQgbWFpbigpIHtcbgkjaW5jbHVkZSA8YmVnaW5ub3JtYWxfdmVydGV4PlxuCSNpbmNsdWRlIDxtb3JwaG5vcm1hbF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPHNraW5iYXNlX3ZlcnRleD5cbgkjaW5jbHVkZSA8c2tpbm5vcm1hbF92ZXJ0ZXg+XG4JI2luY2x1ZGUgPGRlZmF1bHRub3JtYWxfdmVydGV4PlxuCSNpbmNsdWRlIDxiZWdpbl92ZXJ0ZXg+XG4JI2luY2x1ZGUgPG1vcnBodGFyZ2V0X3ZlcnRleD5cbgkjaW5jbHVkZSA8c2tpbm5pbmdfdmVydGV4PlxuCSNpbmNsdWRlIDxwcm9qZWN0X3ZlcnRleD5cbgkjaW5jbHVkZSA8d29ybGRwb3NfdmVydGV4PlxuCSNpbmNsdWRlIDxzaGFkb3dtYXBfdmVydGV4PlxuCSNpbmNsdWRlIDxmb2dfdmVydGV4PlxufSI7CmNvbnN0IGZyYWdtZW50JDIgPSAidW5pZm9ybSB2ZWMzIGNvbG9yO1xudW5pZm9ybSBmbG9hdCBvcGFjaXR5O1xuI2luY2x1ZGUgPGNvbW1vbj5cbiNpbmNsdWRlIDxwYWNraW5nPlxuI2luY2x1ZGUgPGZvZ19wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGJzZGZzPlxuI2luY2x1ZGUgPGxpZ2h0c19wYXJzX2JlZ2luPlxuI2luY2x1ZGUgPHNoYWRvd21hcF9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPHNoYWRvd21hc2tfcGFyc19mcmFnbWVudD5cbnZvaWQgbWFpbigpIHtcbglnbF9GcmFnQ29sb3IgPSB2ZWM0KCBjb2xvciwgb3BhY2l0eSAqICggMS4wIC0gZ2V0U2hhZG93TWFzaygpICkgKTtcbgkjaW5jbHVkZSA8dG9uZW1hcHBpbmdfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGVuY29kaW5nc19mcmFnbWVudD5cbgkjaW5jbHVkZSA8Zm9nX2ZyYWdtZW50PlxufSI7CmNvbnN0IHZlcnRleCQxID0gInVuaWZvcm0gZmxvYXQgcm90YXRpb247XG51bmlmb3JtIHZlYzIgY2VudGVyO1xuI2luY2x1ZGUgPGNvbW1vbj5cbiNpbmNsdWRlIDx1dl9wYXJzX3ZlcnRleD5cbiNpbmNsdWRlIDxmb2dfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8bG9nZGVwdGhidWZfcGFyc192ZXJ0ZXg+XG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfdmVydGV4Plxudm9pZCBtYWluKCkge1xuCSNpbmNsdWRlIDx1dl92ZXJ0ZXg+XG4JdmVjNCBtdlBvc2l0aW9uID0gbW9kZWxWaWV3TWF0cml4ICogdmVjNCggMC4wLCAwLjAsIDAuMCwgMS4wICk7XG4JdmVjMiBzY2FsZTtcbglzY2FsZS54ID0gbGVuZ3RoKCB2ZWMzKCBtb2RlbE1hdHJpeFsgMCBdLngsIG1vZGVsTWF0cml4WyAwIF0ueSwgbW9kZWxNYXRyaXhbIDAgXS56ICkgKTtcbglzY2FsZS55ID0gbGVuZ3RoKCB2ZWMzKCBtb2RlbE1hdHJpeFsgMSBdLngsIG1vZGVsTWF0cml4WyAxIF0ueSwgbW9kZWxNYXRyaXhbIDEgXS56ICkgKTtcbgkjaWZuZGVmIFVTRV9TSVpFQVRURU5VQVRJT05cbgkJYm9vbCBpc1BlcnNwZWN0aXZlID0gaXNQZXJzcGVjdGl2ZU1hdHJpeCggcHJvamVjdGlvbk1hdHJpeCApO1xuCQlpZiAoIGlzUGVyc3BlY3RpdmUgKSBzY2FsZSAqPSAtIG12UG9zaXRpb24uejtcbgkjZW5kaWZcbgl2ZWMyIGFsaWduZWRQb3NpdGlvbiA9ICggcG9zaXRpb24ueHkgLSAoIGNlbnRlciAtIHZlYzIoIDAuNSApICkgKSAqIHNjYWxlO1xuCXZlYzIgcm90YXRlZFBvc2l0aW9uO1xuCXJvdGF0ZWRQb3NpdGlvbi54ID0gY29zKCByb3RhdGlvbiApICogYWxpZ25lZFBvc2l0aW9uLnggLSBzaW4oIHJvdGF0aW9uICkgKiBhbGlnbmVkUG9zaXRpb24ueTtcbglyb3RhdGVkUG9zaXRpb24ueSA9IHNpbiggcm90YXRpb24gKSAqIGFsaWduZWRQb3NpdGlvbi54ICsgY29zKCByb3RhdGlvbiApICogYWxpZ25lZFBvc2l0aW9uLnk7XG4JbXZQb3NpdGlvbi54eSArPSByb3RhdGVkUG9zaXRpb247XG4JZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbXZQb3NpdGlvbjtcbgkjaW5jbHVkZSA8bG9nZGVwdGhidWZfdmVydGV4PlxuCSNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfdmVydGV4PlxuCSNpbmNsdWRlIDxmb2dfdmVydGV4PlxufSI7CmNvbnN0IGZyYWdtZW50JDEgPSAidW5pZm9ybSB2ZWMzIGRpZmZ1c2U7XG51bmlmb3JtIGZsb2F0IG9wYWNpdHk7XG4jaW5jbHVkZSA8Y29tbW9uPlxuI2luY2x1ZGUgPHV2X3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8bWFwX3BhcnNfZnJhZ21lbnQ+XG4jaW5jbHVkZSA8YWxwaGFtYXBfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxhbHBoYXRlc3RfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxmb2dfcGFyc19mcmFnbWVudD5cbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX2ZyYWdtZW50PlxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX2ZyYWdtZW50Plxudm9pZCBtYWluKCkge1xuCSNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfZnJhZ21lbnQ+XG4JdmVjMyBvdXRnb2luZ0xpZ2h0ID0gdmVjMyggMC4wICk7XG4JdmVjNCBkaWZmdXNlQ29sb3IgPSB2ZWM0KCBkaWZmdXNlLCBvcGFjaXR5ICk7XG4JI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxtYXBfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGFscGhhbWFwX2ZyYWdtZW50PlxuCSNpbmNsdWRlIDxhbHBoYXRlc3RfZnJhZ21lbnQ+XG4Jb3V0Z29pbmdMaWdodCA9IGRpZmZ1c2VDb2xvci5yZ2I7XG4JI2luY2x1ZGUgPG91dHB1dF9mcmFnbWVudD5cbgkjaW5jbHVkZSA8dG9uZW1hcHBpbmdfZnJhZ21lbnQ+XG4JI2luY2x1ZGUgPGVuY29kaW5nc19mcmFnbWVudD5cbgkjaW5jbHVkZSA8Zm9nX2ZyYWdtZW50PlxufSI7CmNvbnN0IFNoYWRlckNodW5rID0gewogIGFscGhhbWFwX2ZyYWdtZW50LAogIGFscGhhbWFwX3BhcnNfZnJhZ21lbnQsCiAgYWxwaGF0ZXN0X2ZyYWdtZW50LAogIGFscGhhdGVzdF9wYXJzX2ZyYWdtZW50LAogIGFvbWFwX2ZyYWdtZW50LAogIGFvbWFwX3BhcnNfZnJhZ21lbnQsCiAgYmVnaW5fdmVydGV4LAogIGJlZ2lubm9ybWFsX3ZlcnRleCwKICBic2RmcywKICBidW1wbWFwX3BhcnNfZnJhZ21lbnQsCiAgY2xpcHBpbmdfcGxhbmVzX2ZyYWdtZW50LAogIGNsaXBwaW5nX3BsYW5lc19wYXJzX2ZyYWdtZW50LAogIGNsaXBwaW5nX3BsYW5lc19wYXJzX3ZlcnRleCwKICBjbGlwcGluZ19wbGFuZXNfdmVydGV4LAogIGNvbG9yX2ZyYWdtZW50LAogIGNvbG9yX3BhcnNfZnJhZ21lbnQsCiAgY29sb3JfcGFyc192ZXJ0ZXgsCiAgY29sb3JfdmVydGV4LAogIGNvbW1vbiwKICBjdWJlX3V2X3JlZmxlY3Rpb25fZnJhZ21lbnQsCiAgZGVmYXVsdG5vcm1hbF92ZXJ0ZXgsCiAgZGlzcGxhY2VtZW50bWFwX3BhcnNfdmVydGV4LAogIGRpc3BsYWNlbWVudG1hcF92ZXJ0ZXgsCiAgZW1pc3NpdmVtYXBfZnJhZ21lbnQsCiAgZW1pc3NpdmVtYXBfcGFyc19mcmFnbWVudCwKICBlbmNvZGluZ3NfZnJhZ21lbnQsCiAgZW5jb2RpbmdzX3BhcnNfZnJhZ21lbnQsCiAgZW52bWFwX2ZyYWdtZW50LAogIGVudm1hcF9jb21tb25fcGFyc19mcmFnbWVudCwKICBlbnZtYXBfcGFyc19mcmFnbWVudCwKICBlbnZtYXBfcGFyc192ZXJ0ZXgsCiAgZW52bWFwX3BoeXNpY2FsX3BhcnNfZnJhZ21lbnQsCiAgZW52bWFwX3ZlcnRleCwKICBmb2dfdmVydGV4LAogIGZvZ19wYXJzX3ZlcnRleCwKICBmb2dfZnJhZ21lbnQsCiAgZm9nX3BhcnNfZnJhZ21lbnQsCiAgZ3JhZGllbnRtYXBfcGFyc19mcmFnbWVudCwKICBsaWdodG1hcF9mcmFnbWVudCwKICBsaWdodG1hcF9wYXJzX2ZyYWdtZW50LAogIGxpZ2h0c19sYW1iZXJ0X3ZlcnRleCwKICBsaWdodHNfcGFyc19iZWdpbiwKICBsaWdodHNfdG9vbl9mcmFnbWVudCwKICBsaWdodHNfdG9vbl9wYXJzX2ZyYWdtZW50LAogIGxpZ2h0c19waG9uZ19mcmFnbWVudCwKICBsaWdodHNfcGhvbmdfcGFyc19mcmFnbWVudCwKICBsaWdodHNfcGh5c2ljYWxfZnJhZ21lbnQsCiAgbGlnaHRzX3BoeXNpY2FsX3BhcnNfZnJhZ21lbnQsCiAgbGlnaHRzX2ZyYWdtZW50X2JlZ2luLAogIGxpZ2h0c19mcmFnbWVudF9tYXBzLAogIGxpZ2h0c19mcmFnbWVudF9lbmQsCiAgbG9nZGVwdGhidWZfZnJhZ21lbnQsCiAgbG9nZGVwdGhidWZfcGFyc19mcmFnbWVudCwKICBsb2dkZXB0aGJ1Zl9wYXJzX3ZlcnRleCwKICBsb2dkZXB0aGJ1Zl92ZXJ0ZXgsCiAgbWFwX2ZyYWdtZW50LAogIG1hcF9wYXJzX2ZyYWdtZW50LAogIG1hcF9wYXJ0aWNsZV9mcmFnbWVudCwKICBtYXBfcGFydGljbGVfcGFyc19mcmFnbWVudCwKICBtZXRhbG5lc3NtYXBfZnJhZ21lbnQsCiAgbWV0YWxuZXNzbWFwX3BhcnNfZnJhZ21lbnQsCiAgbW9ycGhub3JtYWxfdmVydGV4LAogIG1vcnBodGFyZ2V0X3BhcnNfdmVydGV4LAogIG1vcnBodGFyZ2V0X3ZlcnRleCwKICBub3JtYWxfZnJhZ21lbnRfYmVnaW4sCiAgbm9ybWFsX2ZyYWdtZW50X21hcHMsCiAgbm9ybWFsX3BhcnNfZnJhZ21lbnQsCiAgbm9ybWFsX3BhcnNfdmVydGV4LAogIG5vcm1hbF92ZXJ0ZXgsCiAgbm9ybWFsbWFwX3BhcnNfZnJhZ21lbnQsCiAgY2xlYXJjb2F0X25vcm1hbF9mcmFnbWVudF9iZWdpbiwKICBjbGVhcmNvYXRfbm9ybWFsX2ZyYWdtZW50X21hcHMsCiAgY2xlYXJjb2F0X3BhcnNfZnJhZ21lbnQsCiAgb3V0cHV0X2ZyYWdtZW50LAogIHBhY2tpbmcsCiAgcHJlbXVsdGlwbGllZF9hbHBoYV9mcmFnbWVudCwKICBwcm9qZWN0X3ZlcnRleCwKICBkaXRoZXJpbmdfZnJhZ21lbnQsCiAgZGl0aGVyaW5nX3BhcnNfZnJhZ21lbnQsCiAgcm91Z2huZXNzbWFwX2ZyYWdtZW50LAogIHJvdWdobmVzc21hcF9wYXJzX2ZyYWdtZW50LAogIHNoYWRvd21hcF9wYXJzX2ZyYWdtZW50LAogIHNoYWRvd21hcF9wYXJzX3ZlcnRleCwKICBzaGFkb3dtYXBfdmVydGV4LAogIHNoYWRvd21hc2tfcGFyc19mcmFnbWVudCwKICBza2luYmFzZV92ZXJ0ZXgsCiAgc2tpbm5pbmdfcGFyc192ZXJ0ZXgsCiAgc2tpbm5pbmdfdmVydGV4LAogIHNraW5ub3JtYWxfdmVydGV4LAogIHNwZWN1bGFybWFwX2ZyYWdtZW50LAogIHNwZWN1bGFybWFwX3BhcnNfZnJhZ21lbnQsCiAgdG9uZW1hcHBpbmdfZnJhZ21lbnQsCiAgdG9uZW1hcHBpbmdfcGFyc19mcmFnbWVudCwKICB0cmFuc21pc3Npb25fZnJhZ21lbnQsCiAgdHJhbnNtaXNzaW9uX3BhcnNfZnJhZ21lbnQsCiAgdXZfcGFyc19mcmFnbWVudCwKICB1dl9wYXJzX3ZlcnRleCwKICB1dl92ZXJ0ZXgsCiAgdXYyX3BhcnNfZnJhZ21lbnQsCiAgdXYyX3BhcnNfdmVydGV4LAogIHV2Ml92ZXJ0ZXgsCiAgd29ybGRwb3NfdmVydGV4LAogIGJhY2tncm91bmRfdmVydDogdmVydGV4JGcsCiAgYmFja2dyb3VuZF9mcmFnOiBmcmFnbWVudCRnLAogIGN1YmVfdmVydDogdmVydGV4JGYsCiAgY3ViZV9mcmFnOiBmcmFnbWVudCRmLAogIGRlcHRoX3ZlcnQ6IHZlcnRleCRlLAogIGRlcHRoX2ZyYWc6IGZyYWdtZW50JGUsCiAgZGlzdGFuY2VSR0JBX3ZlcnQ6IHZlcnRleCRkLAogIGRpc3RhbmNlUkdCQV9mcmFnOiBmcmFnbWVudCRkLAogIGVxdWlyZWN0X3ZlcnQ6IHZlcnRleCRjLAogIGVxdWlyZWN0X2ZyYWc6IGZyYWdtZW50JGMsCiAgbGluZWRhc2hlZF92ZXJ0OiB2ZXJ0ZXgkYiwKICBsaW5lZGFzaGVkX2ZyYWc6IGZyYWdtZW50JGIsCiAgbWVzaGJhc2ljX3ZlcnQ6IHZlcnRleCRhLAogIG1lc2hiYXNpY19mcmFnOiBmcmFnbWVudCRhLAogIG1lc2hsYW1iZXJ0X3ZlcnQ6IHZlcnRleCQ5LAogIG1lc2hsYW1iZXJ0X2ZyYWc6IGZyYWdtZW50JDksCiAgbWVzaG1hdGNhcF92ZXJ0OiB2ZXJ0ZXgkOCwKICBtZXNobWF0Y2FwX2ZyYWc6IGZyYWdtZW50JDgsCiAgbWVzaG5vcm1hbF92ZXJ0OiB2ZXJ0ZXgkNywKICBtZXNobm9ybWFsX2ZyYWc6IGZyYWdtZW50JDcsCiAgbWVzaHBob25nX3ZlcnQ6IHZlcnRleCQ2LAogIG1lc2hwaG9uZ19mcmFnOiBmcmFnbWVudCQ2LAogIG1lc2hwaHlzaWNhbF92ZXJ0OiB2ZXJ0ZXgkNSwKICBtZXNocGh5c2ljYWxfZnJhZzogZnJhZ21lbnQkNSwKICBtZXNodG9vbl92ZXJ0OiB2ZXJ0ZXgkNCwKICBtZXNodG9vbl9mcmFnOiBmcmFnbWVudCQ0LAogIHBvaW50c192ZXJ0OiB2ZXJ0ZXgkMywKICBwb2ludHNfZnJhZzogZnJhZ21lbnQkMywKICBzaGFkb3dfdmVydDogdmVydGV4JDIsCiAgc2hhZG93X2ZyYWc6IGZyYWdtZW50JDIsCiAgc3ByaXRlX3ZlcnQ6IHZlcnRleCQxLAogIHNwcml0ZV9mcmFnOiBmcmFnbWVudCQxCn07CmNvbnN0IFVuaWZvcm1zTGliID0gewogIGNvbW1vbjogewogICAgZGlmZnVzZTogeyB2YWx1ZTogbmV3IENvbG9yKDE2Nzc3MjE1KSB9LAogICAgb3BhY2l0eTogeyB2YWx1ZTogMSB9LAogICAgbWFwOiB7IHZhbHVlOiBudWxsIH0sCiAgICB1dlRyYW5zZm9ybTogeyB2YWx1ZTogbmV3IE1hdHJpeDMoKSB9LAogICAgdXYyVHJhbnNmb3JtOiB7IHZhbHVlOiBuZXcgTWF0cml4MygpIH0sCiAgICBhbHBoYU1hcDogeyB2YWx1ZTogbnVsbCB9LAogICAgYWxwaGFUZXN0OiB7IHZhbHVlOiAwIH0KICB9LAogIHNwZWN1bGFybWFwOiB7CiAgICBzcGVjdWxhck1hcDogeyB2YWx1ZTogbnVsbCB9CiAgfSwKICBlbnZtYXA6IHsKICAgIGVudk1hcDogeyB2YWx1ZTogbnVsbCB9LAogICAgZmxpcEVudk1hcDogeyB2YWx1ZTogLTEgfSwKICAgIHJlZmxlY3Rpdml0eTogeyB2YWx1ZTogMSB9LAogICAgaW9yOiB7IHZhbHVlOiAxLjUgfSwKICAgIHJlZnJhY3Rpb25SYXRpbzogeyB2YWx1ZTogMC45OCB9CiAgfSwKICBhb21hcDogewogICAgYW9NYXA6IHsgdmFsdWU6IG51bGwgfSwKICAgIGFvTWFwSW50ZW5zaXR5OiB7IHZhbHVlOiAxIH0KICB9LAogIGxpZ2h0bWFwOiB7CiAgICBsaWdodE1hcDogeyB2YWx1ZTogbnVsbCB9LAogICAgbGlnaHRNYXBJbnRlbnNpdHk6IHsgdmFsdWU6IDEgfQogIH0sCiAgZW1pc3NpdmVtYXA6IHsKICAgIGVtaXNzaXZlTWFwOiB7IHZhbHVlOiBudWxsIH0KICB9LAogIGJ1bXBtYXA6IHsKICAgIGJ1bXBNYXA6IHsgdmFsdWU6IG51bGwgfSwKICAgIGJ1bXBTY2FsZTogeyB2YWx1ZTogMSB9CiAgfSwKICBub3JtYWxtYXA6IHsKICAgIG5vcm1hbE1hcDogeyB2YWx1ZTogbnVsbCB9LAogICAgbm9ybWFsU2NhbGU6IHsgdmFsdWU6IG5ldyBWZWN0b3IyKDEsIDEpIH0KICB9LAogIGRpc3BsYWNlbWVudG1hcDogewogICAgZGlzcGxhY2VtZW50TWFwOiB7IHZhbHVlOiBudWxsIH0sCiAgICBkaXNwbGFjZW1lbnRTY2FsZTogeyB2YWx1ZTogMSB9LAogICAgZGlzcGxhY2VtZW50QmlhczogeyB2YWx1ZTogMCB9CiAgfSwKICByb3VnaG5lc3NtYXA6IHsKICAgIHJvdWdobmVzc01hcDogeyB2YWx1ZTogbnVsbCB9CiAgfSwKICBtZXRhbG5lc3NtYXA6IHsKICAgIG1ldGFsbmVzc01hcDogeyB2YWx1ZTogbnVsbCB9CiAgfSwKICBncmFkaWVudG1hcDogewogICAgZ3JhZGllbnRNYXA6IHsgdmFsdWU6IG51bGwgfQogIH0sCiAgZm9nOiB7CiAgICBmb2dEZW5zaXR5OiB7IHZhbHVlOiAyNWUtNSB9LAogICAgZm9nTmVhcjogeyB2YWx1ZTogMSB9LAogICAgZm9nRmFyOiB7IHZhbHVlOiAyZTMgfSwKICAgIGZvZ0NvbG9yOiB7IHZhbHVlOiBuZXcgQ29sb3IoMTY3NzcyMTUpIH0KICB9LAogIGxpZ2h0czogewogICAgYW1iaWVudExpZ2h0Q29sb3I6IHsgdmFsdWU6IFtdIH0sCiAgICBsaWdodFByb2JlOiB7IHZhbHVlOiBbXSB9LAogICAgZGlyZWN0aW9uYWxMaWdodHM6IHsgdmFsdWU6IFtdLCBwcm9wZXJ0aWVzOiB7CiAgICAgIGRpcmVjdGlvbjoge30sCiAgICAgIGNvbG9yOiB7fQogICAgfSB9LAogICAgZGlyZWN0aW9uYWxMaWdodFNoYWRvd3M6IHsgdmFsdWU6IFtdLCBwcm9wZXJ0aWVzOiB7CiAgICAgIHNoYWRvd0JpYXM6IHt9LAogICAgICBzaGFkb3dOb3JtYWxCaWFzOiB7fSwKICAgICAgc2hhZG93UmFkaXVzOiB7fSwKICAgICAgc2hhZG93TWFwU2l6ZToge30KICAgIH0gfSwKICAgIGRpcmVjdGlvbmFsU2hhZG93TWFwOiB7IHZhbHVlOiBbXSB9LAogICAgZGlyZWN0aW9uYWxTaGFkb3dNYXRyaXg6IHsgdmFsdWU6IFtdIH0sCiAgICBzcG90TGlnaHRzOiB7IHZhbHVlOiBbXSwgcHJvcGVydGllczogewogICAgICBjb2xvcjoge30sCiAgICAgIHBvc2l0aW9uOiB7fSwKICAgICAgZGlyZWN0aW9uOiB7fSwKICAgICAgZGlzdGFuY2U6IHt9LAogICAgICBjb25lQ29zOiB7fSwKICAgICAgcGVudW1icmFDb3M6IHt9LAogICAgICBkZWNheToge30KICAgIH0gfSwKICAgIHNwb3RMaWdodFNoYWRvd3M6IHsgdmFsdWU6IFtdLCBwcm9wZXJ0aWVzOiB7CiAgICAgIHNoYWRvd0JpYXM6IHt9LAogICAgICBzaGFkb3dOb3JtYWxCaWFzOiB7fSwKICAgICAgc2hhZG93UmFkaXVzOiB7fSwKICAgICAgc2hhZG93TWFwU2l6ZToge30KICAgIH0gfSwKICAgIHNwb3RTaGFkb3dNYXA6IHsgdmFsdWU6IFtdIH0sCiAgICBzcG90U2hhZG93TWF0cml4OiB7IHZhbHVlOiBbXSB9LAogICAgcG9pbnRMaWdodHM6IHsgdmFsdWU6IFtdLCBwcm9wZXJ0aWVzOiB7CiAgICAgIGNvbG9yOiB7fSwKICAgICAgcG9zaXRpb246IHt9LAogICAgICBkZWNheToge30sCiAgICAgIGRpc3RhbmNlOiB7fQogICAgfSB9LAogICAgcG9pbnRMaWdodFNoYWRvd3M6IHsgdmFsdWU6IFtdLCBwcm9wZXJ0aWVzOiB7CiAgICAgIHNoYWRvd0JpYXM6IHt9LAogICAgICBzaGFkb3dOb3JtYWxCaWFzOiB7fSwKICAgICAgc2hhZG93UmFkaXVzOiB7fSwKICAgICAgc2hhZG93TWFwU2l6ZToge30sCiAgICAgIHNoYWRvd0NhbWVyYU5lYXI6IHt9LAogICAgICBzaGFkb3dDYW1lcmFGYXI6IHt9CiAgICB9IH0sCiAgICBwb2ludFNoYWRvd01hcDogeyB2YWx1ZTogW10gfSwKICAgIHBvaW50U2hhZG93TWF0cml4OiB7IHZhbHVlOiBbXSB9LAogICAgaGVtaXNwaGVyZUxpZ2h0czogeyB2YWx1ZTogW10sIHByb3BlcnRpZXM6IHsKICAgICAgZGlyZWN0aW9uOiB7fSwKICAgICAgc2t5Q29sb3I6IHt9LAogICAgICBncm91bmRDb2xvcjoge30KICAgIH0gfSwKICAgIHJlY3RBcmVhTGlnaHRzOiB7IHZhbHVlOiBbXSwgcHJvcGVydGllczogewogICAgICBjb2xvcjoge30sCiAgICAgIHBvc2l0aW9uOiB7fSwKICAgICAgd2lkdGg6IHt9LAogICAgICBoZWlnaHQ6IHt9CiAgICB9IH0sCiAgICBsdGNfMTogeyB2YWx1ZTogbnVsbCB9LAogICAgbHRjXzI6IHsgdmFsdWU6IG51bGwgfQogIH0sCiAgcG9pbnRzOiB7CiAgICBkaWZmdXNlOiB7IHZhbHVlOiBuZXcgQ29sb3IoMTY3NzcyMTUpIH0sCiAgICBvcGFjaXR5OiB7IHZhbHVlOiAxIH0sCiAgICBzaXplOiB7IHZhbHVlOiAxIH0sCiAgICBzY2FsZTogeyB2YWx1ZTogMSB9LAogICAgbWFwOiB7IHZhbHVlOiBudWxsIH0sCiAgICBhbHBoYU1hcDogeyB2YWx1ZTogbnVsbCB9LAogICAgYWxwaGFUZXN0OiB7IHZhbHVlOiAwIH0sCiAgICB1dlRyYW5zZm9ybTogeyB2YWx1ZTogbmV3IE1hdHJpeDMoKSB9CiAgfSwKICBzcHJpdGU6IHsKICAgIGRpZmZ1c2U6IHsgdmFsdWU6IG5ldyBDb2xvcigxNjc3NzIxNSkgfSwKICAgIG9wYWNpdHk6IHsgdmFsdWU6IDEgfSwKICAgIGNlbnRlcjogeyB2YWx1ZTogbmV3IFZlY3RvcjIoMC41LCAwLjUpIH0sCiAgICByb3RhdGlvbjogeyB2YWx1ZTogMCB9LAogICAgbWFwOiB7IHZhbHVlOiBudWxsIH0sCiAgICBhbHBoYU1hcDogeyB2YWx1ZTogbnVsbCB9LAogICAgYWxwaGFUZXN0OiB7IHZhbHVlOiAwIH0sCiAgICB1dlRyYW5zZm9ybTogeyB2YWx1ZTogbmV3IE1hdHJpeDMoKSB9CiAgfQp9Owpjb25zdCBTaGFkZXJMaWIgPSB7CiAgYmFzaWM6IHsKICAgIHVuaWZvcm1zOiBtZXJnZVVuaWZvcm1zKFsKICAgICAgVW5pZm9ybXNMaWIuY29tbW9uLAogICAgICBVbmlmb3Jtc0xpYi5zcGVjdWxhcm1hcCwKICAgICAgVW5pZm9ybXNMaWIuZW52bWFwLAogICAgICBVbmlmb3Jtc0xpYi5hb21hcCwKICAgICAgVW5pZm9ybXNMaWIubGlnaHRtYXAsCiAgICAgIFVuaWZvcm1zTGliLmZvZwogICAgXSksCiAgICB2ZXJ0ZXhTaGFkZXI6IFNoYWRlckNodW5rLm1lc2hiYXNpY192ZXJ0LAogICAgZnJhZ21lbnRTaGFkZXI6IFNoYWRlckNodW5rLm1lc2hiYXNpY19mcmFnCiAgfSwKICBsYW1iZXJ0OiB7CiAgICB1bmlmb3JtczogbWVyZ2VVbmlmb3JtcyhbCiAgICAgIFVuaWZvcm1zTGliLmNvbW1vbiwKICAgICAgVW5pZm9ybXNMaWIuc3BlY3VsYXJtYXAsCiAgICAgIFVuaWZvcm1zTGliLmVudm1hcCwKICAgICAgVW5pZm9ybXNMaWIuYW9tYXAsCiAgICAgIFVuaWZvcm1zTGliLmxpZ2h0bWFwLAogICAgICBVbmlmb3Jtc0xpYi5lbWlzc2l2ZW1hcCwKICAgICAgVW5pZm9ybXNMaWIuZm9nLAogICAgICBVbmlmb3Jtc0xpYi5saWdodHMsCiAgICAgIHsKICAgICAgICBlbWlzc2l2ZTogeyB2YWx1ZTogbmV3IENvbG9yKDApIH0KICAgICAgfQogICAgXSksCiAgICB2ZXJ0ZXhTaGFkZXI6IFNoYWRlckNodW5rLm1lc2hsYW1iZXJ0X3ZlcnQsCiAgICBmcmFnbWVudFNoYWRlcjogU2hhZGVyQ2h1bmsubWVzaGxhbWJlcnRfZnJhZwogIH0sCiAgcGhvbmc6IHsKICAgIHVuaWZvcm1zOiBtZXJnZVVuaWZvcm1zKFsKICAgICAgVW5pZm9ybXNMaWIuY29tbW9uLAogICAgICBVbmlmb3Jtc0xpYi5zcGVjdWxhcm1hcCwKICAgICAgVW5pZm9ybXNMaWIuZW52bWFwLAogICAgICBVbmlmb3Jtc0xpYi5hb21hcCwKICAgICAgVW5pZm9ybXNMaWIubGlnaHRtYXAsCiAgICAgIFVuaWZvcm1zTGliLmVtaXNzaXZlbWFwLAogICAgICBVbmlmb3Jtc0xpYi5idW1wbWFwLAogICAgICBVbmlmb3Jtc0xpYi5ub3JtYWxtYXAsCiAgICAgIFVuaWZvcm1zTGliLmRpc3BsYWNlbWVudG1hcCwKICAgICAgVW5pZm9ybXNMaWIuZm9nLAogICAgICBVbmlmb3Jtc0xpYi5saWdodHMsCiAgICAgIHsKICAgICAgICBlbWlzc2l2ZTogeyB2YWx1ZTogbmV3IENvbG9yKDApIH0sCiAgICAgICAgc3BlY3VsYXI6IHsgdmFsdWU6IG5ldyBDb2xvcigxMTE4NDgxKSB9LAogICAgICAgIHNoaW5pbmVzczogeyB2YWx1ZTogMzAgfQogICAgICB9CiAgICBdKSwKICAgIHZlcnRleFNoYWRlcjogU2hhZGVyQ2h1bmsubWVzaHBob25nX3ZlcnQsCiAgICBmcmFnbWVudFNoYWRlcjogU2hhZGVyQ2h1bmsubWVzaHBob25nX2ZyYWcKICB9LAogIHN0YW5kYXJkOiB7CiAgICB1bmlmb3JtczogbWVyZ2VVbmlmb3JtcyhbCiAgICAgIFVuaWZvcm1zTGliLmNvbW1vbiwKICAgICAgVW5pZm9ybXNMaWIuZW52bWFwLAogICAgICBVbmlmb3Jtc0xpYi5hb21hcCwKICAgICAgVW5pZm9ybXNMaWIubGlnaHRtYXAsCiAgICAgIFVuaWZvcm1zTGliLmVtaXNzaXZlbWFwLAogICAgICBVbmlmb3Jtc0xpYi5idW1wbWFwLAogICAgICBVbmlmb3Jtc0xpYi5ub3JtYWxtYXAsCiAgICAgIFVuaWZvcm1zTGliLmRpc3BsYWNlbWVudG1hcCwKICAgICAgVW5pZm9ybXNMaWIucm91Z2huZXNzbWFwLAogICAgICBVbmlmb3Jtc0xpYi5tZXRhbG5lc3NtYXAsCiAgICAgIFVuaWZvcm1zTGliLmZvZywKICAgICAgVW5pZm9ybXNMaWIubGlnaHRzLAogICAgICB7CiAgICAgICAgZW1pc3NpdmU6IHsgdmFsdWU6IG5ldyBDb2xvcigwKSB9LAogICAgICAgIHJvdWdobmVzczogeyB2YWx1ZTogMSB9LAogICAgICAgIG1ldGFsbmVzczogeyB2YWx1ZTogMCB9LAogICAgICAgIGVudk1hcEludGVuc2l0eTogeyB2YWx1ZTogMSB9CiAgICAgIH0KICAgIF0pLAogICAgdmVydGV4U2hhZGVyOiBTaGFkZXJDaHVuay5tZXNocGh5c2ljYWxfdmVydCwKICAgIGZyYWdtZW50U2hhZGVyOiBTaGFkZXJDaHVuay5tZXNocGh5c2ljYWxfZnJhZwogIH0sCiAgdG9vbjogewogICAgdW5pZm9ybXM6IG1lcmdlVW5pZm9ybXMoWwogICAgICBVbmlmb3Jtc0xpYi5jb21tb24sCiAgICAgIFVuaWZvcm1zTGliLmFvbWFwLAogICAgICBVbmlmb3Jtc0xpYi5saWdodG1hcCwKICAgICAgVW5pZm9ybXNMaWIuZW1pc3NpdmVtYXAsCiAgICAgIFVuaWZvcm1zTGliLmJ1bXBtYXAsCiAgICAgIFVuaWZvcm1zTGliLm5vcm1hbG1hcCwKICAgICAgVW5pZm9ybXNMaWIuZGlzcGxhY2VtZW50bWFwLAogICAgICBVbmlmb3Jtc0xpYi5ncmFkaWVudG1hcCwKICAgICAgVW5pZm9ybXNMaWIuZm9nLAogICAgICBVbmlmb3Jtc0xpYi5saWdodHMsCiAgICAgIHsKICAgICAgICBlbWlzc2l2ZTogeyB2YWx1ZTogbmV3IENvbG9yKDApIH0KICAgICAgfQogICAgXSksCiAgICB2ZXJ0ZXhTaGFkZXI6IFNoYWRlckNodW5rLm1lc2h0b29uX3ZlcnQsCiAgICBmcmFnbWVudFNoYWRlcjogU2hhZGVyQ2h1bmsubWVzaHRvb25fZnJhZwogIH0sCiAgbWF0Y2FwOiB7CiAgICB1bmlmb3JtczogbWVyZ2VVbmlmb3JtcyhbCiAgICAgIFVuaWZvcm1zTGliLmNvbW1vbiwKICAgICAgVW5pZm9ybXNMaWIuYnVtcG1hcCwKICAgICAgVW5pZm9ybXNMaWIubm9ybWFsbWFwLAogICAgICBVbmlmb3Jtc0xpYi5kaXNwbGFjZW1lbnRtYXAsCiAgICAgIFVuaWZvcm1zTGliLmZvZywKICAgICAgewogICAgICAgIG1hdGNhcDogeyB2YWx1ZTogbnVsbCB9CiAgICAgIH0KICAgIF0pLAogICAgdmVydGV4U2hhZGVyOiBTaGFkZXJDaHVuay5tZXNobWF0Y2FwX3ZlcnQsCiAgICBmcmFnbWVudFNoYWRlcjogU2hhZGVyQ2h1bmsubWVzaG1hdGNhcF9mcmFnCiAgfSwKICBwb2ludHM6IHsKICAgIHVuaWZvcm1zOiBtZXJnZVVuaWZvcm1zKFsKICAgICAgVW5pZm9ybXNMaWIucG9pbnRzLAogICAgICBVbmlmb3Jtc0xpYi5mb2cKICAgIF0pLAogICAgdmVydGV4U2hhZGVyOiBTaGFkZXJDaHVuay5wb2ludHNfdmVydCwKICAgIGZyYWdtZW50U2hhZGVyOiBTaGFkZXJDaHVuay5wb2ludHNfZnJhZwogIH0sCiAgZGFzaGVkOiB7CiAgICB1bmlmb3JtczogbWVyZ2VVbmlmb3JtcyhbCiAgICAgIFVuaWZvcm1zTGliLmNvbW1vbiwKICAgICAgVW5pZm9ybXNMaWIuZm9nLAogICAgICB7CiAgICAgICAgc2NhbGU6IHsgdmFsdWU6IDEgfSwKICAgICAgICBkYXNoU2l6ZTogeyB2YWx1ZTogMSB9LAogICAgICAgIHRvdGFsU2l6ZTogeyB2YWx1ZTogMiB9CiAgICAgIH0KICAgIF0pLAogICAgdmVydGV4U2hhZGVyOiBTaGFkZXJDaHVuay5saW5lZGFzaGVkX3ZlcnQsCiAgICBmcmFnbWVudFNoYWRlcjogU2hhZGVyQ2h1bmsubGluZWRhc2hlZF9mcmFnCiAgfSwKICBkZXB0aDogewogICAgdW5pZm9ybXM6IG1lcmdlVW5pZm9ybXMoWwogICAgICBVbmlmb3Jtc0xpYi5jb21tb24sCiAgICAgIFVuaWZvcm1zTGliLmRpc3BsYWNlbWVudG1hcAogICAgXSksCiAgICB2ZXJ0ZXhTaGFkZXI6IFNoYWRlckNodW5rLmRlcHRoX3ZlcnQsCiAgICBmcmFnbWVudFNoYWRlcjogU2hhZGVyQ2h1bmsuZGVwdGhfZnJhZwogIH0sCiAgbm9ybWFsOiB7CiAgICB1bmlmb3JtczogbWVyZ2VVbmlmb3JtcyhbCiAgICAgIFVuaWZvcm1zTGliLmNvbW1vbiwKICAgICAgVW5pZm9ybXNMaWIuYnVtcG1hcCwKICAgICAgVW5pZm9ybXNMaWIubm9ybWFsbWFwLAogICAgICBVbmlmb3Jtc0xpYi5kaXNwbGFjZW1lbnRtYXAsCiAgICAgIHsKICAgICAgICBvcGFjaXR5OiB7IHZhbHVlOiAxIH0KICAgICAgfQogICAgXSksCiAgICB2ZXJ0ZXhTaGFkZXI6IFNoYWRlckNodW5rLm1lc2hub3JtYWxfdmVydCwKICAgIGZyYWdtZW50U2hhZGVyOiBTaGFkZXJDaHVuay5tZXNobm9ybWFsX2ZyYWcKICB9LAogIHNwcml0ZTogewogICAgdW5pZm9ybXM6IG1lcmdlVW5pZm9ybXMoWwogICAgICBVbmlmb3Jtc0xpYi5zcHJpdGUsCiAgICAgIFVuaWZvcm1zTGliLmZvZwogICAgXSksCiAgICB2ZXJ0ZXhTaGFkZXI6IFNoYWRlckNodW5rLnNwcml0ZV92ZXJ0LAogICAgZnJhZ21lbnRTaGFkZXI6IFNoYWRlckNodW5rLnNwcml0ZV9mcmFnCiAgfSwKICBiYWNrZ3JvdW5kOiB7CiAgICB1bmlmb3JtczogewogICAgICB1dlRyYW5zZm9ybTogeyB2YWx1ZTogbmV3IE1hdHJpeDMoKSB9LAogICAgICB0MkQ6IHsgdmFsdWU6IG51bGwgfQogICAgfSwKICAgIHZlcnRleFNoYWRlcjogU2hhZGVyQ2h1bmsuYmFja2dyb3VuZF92ZXJ0LAogICAgZnJhZ21lbnRTaGFkZXI6IFNoYWRlckNodW5rLmJhY2tncm91bmRfZnJhZwogIH0sCiAgY3ViZTogewogICAgdW5pZm9ybXM6IG1lcmdlVW5pZm9ybXMoWwogICAgICBVbmlmb3Jtc0xpYi5lbnZtYXAsCiAgICAgIHsKICAgICAgICBvcGFjaXR5OiB7IHZhbHVlOiAxIH0KICAgICAgfQogICAgXSksCiAgICB2ZXJ0ZXhTaGFkZXI6IFNoYWRlckNodW5rLmN1YmVfdmVydCwKICAgIGZyYWdtZW50U2hhZGVyOiBTaGFkZXJDaHVuay5jdWJlX2ZyYWcKICB9LAogIGVxdWlyZWN0OiB7CiAgICB1bmlmb3JtczogewogICAgICB0RXF1aXJlY3Q6IHsgdmFsdWU6IG51bGwgfQogICAgfSwKICAgIHZlcnRleFNoYWRlcjogU2hhZGVyQ2h1bmsuZXF1aXJlY3RfdmVydCwKICAgIGZyYWdtZW50U2hhZGVyOiBTaGFkZXJDaHVuay5lcXVpcmVjdF9mcmFnCiAgfSwKICBkaXN0YW5jZVJHQkE6IHsKICAgIHVuaWZvcm1zOiBtZXJnZVVuaWZvcm1zKFsKICAgICAgVW5pZm9ybXNMaWIuY29tbW9uLAogICAgICBVbmlmb3Jtc0xpYi5kaXNwbGFjZW1lbnRtYXAsCiAgICAgIHsKICAgICAgICByZWZlcmVuY2VQb3NpdGlvbjogeyB2YWx1ZTogbmV3IFZlY3RvcjMoKSB9LAogICAgICAgIG5lYXJEaXN0YW5jZTogeyB2YWx1ZTogMSB9LAogICAgICAgIGZhckRpc3RhbmNlOiB7IHZhbHVlOiAxZTMgfQogICAgICB9CiAgICBdKSwKICAgIHZlcnRleFNoYWRlcjogU2hhZGVyQ2h1bmsuZGlzdGFuY2VSR0JBX3ZlcnQsCiAgICBmcmFnbWVudFNoYWRlcjogU2hhZGVyQ2h1bmsuZGlzdGFuY2VSR0JBX2ZyYWcKICB9LAogIHNoYWRvdzogewogICAgdW5pZm9ybXM6IG1lcmdlVW5pZm9ybXMoWwogICAgICBVbmlmb3Jtc0xpYi5saWdodHMsCiAgICAgIFVuaWZvcm1zTGliLmZvZywKICAgICAgewogICAgICAgIGNvbG9yOiB7IHZhbHVlOiBuZXcgQ29sb3IoMCkgfSwKICAgICAgICBvcGFjaXR5OiB7IHZhbHVlOiAxIH0KICAgICAgfQogICAgXSksCiAgICB2ZXJ0ZXhTaGFkZXI6IFNoYWRlckNodW5rLnNoYWRvd192ZXJ0LAogICAgZnJhZ21lbnRTaGFkZXI6IFNoYWRlckNodW5rLnNoYWRvd19mcmFnCiAgfQp9OwpTaGFkZXJMaWIucGh5c2ljYWwgPSB7CiAgdW5pZm9ybXM6IG1lcmdlVW5pZm9ybXMoWwogICAgU2hhZGVyTGliLnN0YW5kYXJkLnVuaWZvcm1zLAogICAgewogICAgICBjbGVhcmNvYXQ6IHsgdmFsdWU6IDAgfSwKICAgICAgY2xlYXJjb2F0TWFwOiB7IHZhbHVlOiBudWxsIH0sCiAgICAgIGNsZWFyY29hdFJvdWdobmVzczogeyB2YWx1ZTogMCB9LAogICAgICBjbGVhcmNvYXRSb3VnaG5lc3NNYXA6IHsgdmFsdWU6IG51bGwgfSwKICAgICAgY2xlYXJjb2F0Tm9ybWFsU2NhbGU6IHsgdmFsdWU6IG5ldyBWZWN0b3IyKDEsIDEpIH0sCiAgICAgIGNsZWFyY29hdE5vcm1hbE1hcDogeyB2YWx1ZTogbnVsbCB9LAogICAgICBzaGVlbjogeyB2YWx1ZTogMCB9LAogICAgICBzaGVlbkNvbG9yOiB7IHZhbHVlOiBuZXcgQ29sb3IoMCkgfSwKICAgICAgc2hlZW5Db2xvck1hcDogeyB2YWx1ZTogbnVsbCB9LAogICAgICBzaGVlblJvdWdobmVzczogeyB2YWx1ZTogMSB9LAogICAgICBzaGVlblJvdWdobmVzc01hcDogeyB2YWx1ZTogbnVsbCB9LAogICAgICB0cmFuc21pc3Npb246IHsgdmFsdWU6IDAgfSwKICAgICAgdHJhbnNtaXNzaW9uTWFwOiB7IHZhbHVlOiBudWxsIH0sCiAgICAgIHRyYW5zbWlzc2lvblNhbXBsZXJTaXplOiB7IHZhbHVlOiBuZXcgVmVjdG9yMigpIH0sCiAgICAgIHRyYW5zbWlzc2lvblNhbXBsZXJNYXA6IHsgdmFsdWU6IG51bGwgfSwKICAgICAgdGhpY2tuZXNzOiB7IHZhbHVlOiAwIH0sCiAgICAgIHRoaWNrbmVzc01hcDogeyB2YWx1ZTogbnVsbCB9LAogICAgICBhdHRlbnVhdGlvbkRpc3RhbmNlOiB7IHZhbHVlOiAwIH0sCiAgICAgIGF0dGVudWF0aW9uQ29sb3I6IHsgdmFsdWU6IG5ldyBDb2xvcigwKSB9LAogICAgICBzcGVjdWxhckludGVuc2l0eTogeyB2YWx1ZTogMSB9LAogICAgICBzcGVjdWxhckludGVuc2l0eU1hcDogeyB2YWx1ZTogbnVsbCB9LAogICAgICBzcGVjdWxhckNvbG9yOiB7IHZhbHVlOiBuZXcgQ29sb3IoMSwgMSwgMSkgfSwKICAgICAgc3BlY3VsYXJDb2xvck1hcDogeyB2YWx1ZTogbnVsbCB9CiAgICB9CiAgXSksCiAgdmVydGV4U2hhZGVyOiBTaGFkZXJDaHVuay5tZXNocGh5c2ljYWxfdmVydCwKICBmcmFnbWVudFNoYWRlcjogU2hhZGVyQ2h1bmsubWVzaHBoeXNpY2FsX2ZyYWcKfTsKZnVuY3Rpb24gV2ViR0xCYWNrZ3JvdW5kKHJlbmRlcmVyLCBjdWJlbWFwcywgc3RhdGUsIG9iamVjdHMsIGFscGhhLCBwcmVtdWx0aXBsaWVkQWxwaGEpIHsKICBjb25zdCBjbGVhckNvbG9yID0gbmV3IENvbG9yKDApOwogIGxldCBjbGVhckFscGhhID0gYWxwaGEgPT09IHRydWUgPyAwIDogMTsKICBsZXQgcGxhbmVNZXNoOwogIGxldCBib3hNZXNoOwogIGxldCBjdXJyZW50QmFja2dyb3VuZCA9IG51bGw7CiAgbGV0IGN1cnJlbnRCYWNrZ3JvdW5kVmVyc2lvbiA9IDA7CiAgbGV0IGN1cnJlbnRUb25lbWFwcGluZyA9IG51bGw7CiAgZnVuY3Rpb24gcmVuZGVyKHJlbmRlckxpc3QsIHNjZW5lKSB7CiAgICBsZXQgZm9yY2VDbGVhciA9IGZhbHNlOwogICAgbGV0IGJhY2tncm91bmQgPSBzY2VuZS5pc1NjZW5lID09PSB0cnVlID8gc2NlbmUuYmFja2dyb3VuZCA6IG51bGw7CiAgICBpZiAoYmFja2dyb3VuZCAmJiBiYWNrZ3JvdW5kLmlzVGV4dHVyZSkgewogICAgICBiYWNrZ3JvdW5kID0gY3ViZW1hcHMuZ2V0KGJhY2tncm91bmQpOwogICAgfQogICAgY29uc3QgeHIgPSByZW5kZXJlci54cjsKICAgIGNvbnN0IHNlc3Npb24gPSB4ci5nZXRTZXNzaW9uICYmIHhyLmdldFNlc3Npb24oKTsKICAgIGlmIChzZXNzaW9uICYmIHNlc3Npb24uZW52aXJvbm1lbnRCbGVuZE1vZGUgPT09ICJhZGRpdGl2ZSIpIHsKICAgICAgYmFja2dyb3VuZCA9IG51bGw7CiAgICB9CiAgICBpZiAoYmFja2dyb3VuZCA9PT0gbnVsbCkgewogICAgICBzZXRDbGVhcihjbGVhckNvbG9yLCBjbGVhckFscGhhKTsKICAgIH0gZWxzZSBpZiAoYmFja2dyb3VuZCAmJiBiYWNrZ3JvdW5kLmlzQ29sb3IpIHsKICAgICAgc2V0Q2xlYXIoYmFja2dyb3VuZCwgMSk7CiAgICAgIGZvcmNlQ2xlYXIgPSB0cnVlOwogICAgfQogICAgaWYgKHJlbmRlcmVyLmF1dG9DbGVhciB8fCBmb3JjZUNsZWFyKSB7CiAgICAgIHJlbmRlcmVyLmNsZWFyKHJlbmRlcmVyLmF1dG9DbGVhckNvbG9yLCByZW5kZXJlci5hdXRvQ2xlYXJEZXB0aCwgcmVuZGVyZXIuYXV0b0NsZWFyU3RlbmNpbCk7CiAgICB9CiAgICBpZiAoYmFja2dyb3VuZCAmJiAoYmFja2dyb3VuZC5pc0N1YmVUZXh0dXJlIHx8IGJhY2tncm91bmQubWFwcGluZyA9PT0gQ3ViZVVWUmVmbGVjdGlvbk1hcHBpbmcpKSB7CiAgICAgIGlmIChib3hNZXNoID09PSB2b2lkIDApIHsKICAgICAgICBib3hNZXNoID0gbmV3IE1lc2gobmV3IEJveEdlb21ldHJ5KDEsIDEsIDEpLCBuZXcgU2hhZGVyTWF0ZXJpYWwoewogICAgICAgICAgbmFtZTogIkJhY2tncm91bmRDdWJlTWF0ZXJpYWwiLAogICAgICAgICAgdW5pZm9ybXM6IGNsb25lVW5pZm9ybXMoU2hhZGVyTGliLmN1YmUudW5pZm9ybXMpLAogICAgICAgICAgdmVydGV4U2hhZGVyOiBTaGFkZXJMaWIuY3ViZS52ZXJ0ZXhTaGFkZXIsCiAgICAgICAgICBmcmFnbWVudFNoYWRlcjogU2hhZGVyTGliLmN1YmUuZnJhZ21lbnRTaGFkZXIsCiAgICAgICAgICBzaWRlOiBCYWNrU2lkZSwKICAgICAgICAgIGRlcHRoVGVzdDogZmFsc2UsCiAgICAgICAgICBkZXB0aFdyaXRlOiBmYWxzZSwKICAgICAgICAgIGZvZzogZmFsc2UKICAgICAgICB9KSk7CiAgICAgICAgYm94TWVzaC5nZW9tZXRyeS5kZWxldGVBdHRyaWJ1dGUoIm5vcm1hbCIpOwogICAgICAgIGJveE1lc2guZ2VvbWV0cnkuZGVsZXRlQXR0cmlidXRlKCJ1diIpOwogICAgICAgIGJveE1lc2gub25CZWZvcmVSZW5kZXIgPSBmdW5jdGlvbihyZW5kZXJlcjIsIHNjZW5lMiwgY2FtZXJhKSB7CiAgICAgICAgICB0aGlzLm1hdHJpeFdvcmxkLmNvcHlQb3NpdGlvbihjYW1lcmEubWF0cml4V29ybGQpOwogICAgICAgIH07CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGJveE1lc2gubWF0ZXJpYWwsICJlbnZNYXAiLCB7CiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy51bmlmb3Jtcy5lbnZNYXAudmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgb2JqZWN0cy51cGRhdGUoYm94TWVzaCk7CiAgICAgIH0KICAgICAgYm94TWVzaC5tYXRlcmlhbC51bmlmb3Jtcy5lbnZNYXAudmFsdWUgPSBiYWNrZ3JvdW5kOwogICAgICBib3hNZXNoLm1hdGVyaWFsLnVuaWZvcm1zLmZsaXBFbnZNYXAudmFsdWUgPSBiYWNrZ3JvdW5kLmlzQ3ViZVRleHR1cmUgJiYgYmFja2dyb3VuZC5pc1JlbmRlclRhcmdldFRleHR1cmUgPT09IGZhbHNlID8gLTEgOiAxOwogICAgICBpZiAoY3VycmVudEJhY2tncm91bmQgIT09IGJhY2tncm91bmQgfHwgY3VycmVudEJhY2tncm91bmRWZXJzaW9uICE9PSBiYWNrZ3JvdW5kLnZlcnNpb24gfHwgY3VycmVudFRvbmVtYXBwaW5nICE9PSByZW5kZXJlci50b25lTWFwcGluZykgewogICAgICAgIGJveE1lc2gubWF0ZXJpYWwubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICAgIGN1cnJlbnRCYWNrZ3JvdW5kID0gYmFja2dyb3VuZDsKICAgICAgICBjdXJyZW50QmFja2dyb3VuZFZlcnNpb24gPSBiYWNrZ3JvdW5kLnZlcnNpb247CiAgICAgICAgY3VycmVudFRvbmVtYXBwaW5nID0gcmVuZGVyZXIudG9uZU1hcHBpbmc7CiAgICAgIH0KICAgICAgcmVuZGVyTGlzdC51bnNoaWZ0KGJveE1lc2gsIGJveE1lc2guZ2VvbWV0cnksIGJveE1lc2gubWF0ZXJpYWwsIDAsIDAsIG51bGwpOwogICAgfSBlbHNlIGlmIChiYWNrZ3JvdW5kICYmIGJhY2tncm91bmQuaXNUZXh0dXJlKSB7CiAgICAgIGlmIChwbGFuZU1lc2ggPT09IHZvaWQgMCkgewogICAgICAgIHBsYW5lTWVzaCA9IG5ldyBNZXNoKG5ldyBQbGFuZUdlb21ldHJ5KDIsIDIpLCBuZXcgU2hhZGVyTWF0ZXJpYWwoewogICAgICAgICAgbmFtZTogIkJhY2tncm91bmRNYXRlcmlhbCIsCiAgICAgICAgICB1bmlmb3JtczogY2xvbmVVbmlmb3JtcyhTaGFkZXJMaWIuYmFja2dyb3VuZC51bmlmb3JtcyksCiAgICAgICAgICB2ZXJ0ZXhTaGFkZXI6IFNoYWRlckxpYi5iYWNrZ3JvdW5kLnZlcnRleFNoYWRlciwKICAgICAgICAgIGZyYWdtZW50U2hhZGVyOiBTaGFkZXJMaWIuYmFja2dyb3VuZC5mcmFnbWVudFNoYWRlciwKICAgICAgICAgIHNpZGU6IEZyb250U2lkZSwKICAgICAgICAgIGRlcHRoVGVzdDogZmFsc2UsCiAgICAgICAgICBkZXB0aFdyaXRlOiBmYWxzZSwKICAgICAgICAgIGZvZzogZmFsc2UKICAgICAgICB9KSk7CiAgICAgICAgcGxhbmVNZXNoLmdlb21ldHJ5LmRlbGV0ZUF0dHJpYnV0ZSgibm9ybWFsIik7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYW5lTWVzaC5tYXRlcmlhbCwgIm1hcCIsIHsKICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnVuaWZvcm1zLnQyRC52YWx1ZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBvYmplY3RzLnVwZGF0ZShwbGFuZU1lc2gpOwogICAgICB9CiAgICAgIHBsYW5lTWVzaC5tYXRlcmlhbC51bmlmb3Jtcy50MkQudmFsdWUgPSBiYWNrZ3JvdW5kOwogICAgICBpZiAoYmFja2dyb3VuZC5tYXRyaXhBdXRvVXBkYXRlID09PSB0cnVlKSB7CiAgICAgICAgYmFja2dyb3VuZC51cGRhdGVNYXRyaXgoKTsKICAgICAgfQogICAgICBwbGFuZU1lc2gubWF0ZXJpYWwudW5pZm9ybXMudXZUcmFuc2Zvcm0udmFsdWUuY29weShiYWNrZ3JvdW5kLm1hdHJpeCk7CiAgICAgIGlmIChjdXJyZW50QmFja2dyb3VuZCAhPT0gYmFja2dyb3VuZCB8fCBjdXJyZW50QmFja2dyb3VuZFZlcnNpb24gIT09IGJhY2tncm91bmQudmVyc2lvbiB8fCBjdXJyZW50VG9uZW1hcHBpbmcgIT09IHJlbmRlcmVyLnRvbmVNYXBwaW5nKSB7CiAgICAgICAgcGxhbmVNZXNoLm1hdGVyaWFsLm5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgICBjdXJyZW50QmFja2dyb3VuZCA9IGJhY2tncm91bmQ7CiAgICAgICAgY3VycmVudEJhY2tncm91bmRWZXJzaW9uID0gYmFja2dyb3VuZC52ZXJzaW9uOwogICAgICAgIGN1cnJlbnRUb25lbWFwcGluZyA9IHJlbmRlcmVyLnRvbmVNYXBwaW5nOwogICAgICB9CiAgICAgIHJlbmRlckxpc3QudW5zaGlmdChwbGFuZU1lc2gsIHBsYW5lTWVzaC5nZW9tZXRyeSwgcGxhbmVNZXNoLm1hdGVyaWFsLCAwLCAwLCBudWxsKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gc2V0Q2xlYXIoY29sb3IsIGFscGhhMikgewogICAgc3RhdGUuYnVmZmVycy5jb2xvci5zZXRDbGVhcihjb2xvci5yLCBjb2xvci5nLCBjb2xvci5iLCBhbHBoYTIsIHByZW11bHRpcGxpZWRBbHBoYSk7CiAgfQogIHJldHVybiB7CiAgICBnZXRDbGVhckNvbG9yOiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIGNsZWFyQ29sb3I7CiAgICB9LAogICAgc2V0Q2xlYXJDb2xvcjogZnVuY3Rpb24oY29sb3IsIGFscGhhMiA9IDEpIHsKICAgICAgY2xlYXJDb2xvci5zZXQoY29sb3IpOwogICAgICBjbGVhckFscGhhID0gYWxwaGEyOwogICAgICBzZXRDbGVhcihjbGVhckNvbG9yLCBjbGVhckFscGhhKTsKICAgIH0sCiAgICBnZXRDbGVhckFscGhhOiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIGNsZWFyQWxwaGE7CiAgICB9LAogICAgc2V0Q2xlYXJBbHBoYTogZnVuY3Rpb24oYWxwaGEyKSB7CiAgICAgIGNsZWFyQWxwaGEgPSBhbHBoYTI7CiAgICAgIHNldENsZWFyKGNsZWFyQ29sb3IsIGNsZWFyQWxwaGEpOwogICAgfSwKICAgIHJlbmRlcgogIH07Cn0KZnVuY3Rpb24gV2ViR0xCaW5kaW5nU3RhdGVzKGdsLCBleHRlbnNpb25zLCBhdHRyaWJ1dGVzLCBjYXBhYmlsaXRpZXMpIHsKICBjb25zdCBtYXhWZXJ0ZXhBdHRyaWJ1dGVzID0gZ2wuZ2V0UGFyYW1ldGVyKDM0OTIxKTsKICBjb25zdCBleHRlbnNpb24gPSBjYXBhYmlsaXRpZXMuaXNXZWJHTDIgPyBudWxsIDogZXh0ZW5zaW9ucy5nZXQoIk9FU192ZXJ0ZXhfYXJyYXlfb2JqZWN0Iik7CiAgY29uc3QgdmFvQXZhaWxhYmxlID0gY2FwYWJpbGl0aWVzLmlzV2ViR0wyIHx8IGV4dGVuc2lvbiAhPT0gbnVsbDsKICBjb25zdCBiaW5kaW5nU3RhdGVzID0ge307CiAgY29uc3QgZGVmYXVsdFN0YXRlID0gY3JlYXRlQmluZGluZ1N0YXRlKG51bGwpOwogIGxldCBjdXJyZW50U3RhdGUgPSBkZWZhdWx0U3RhdGU7CiAgZnVuY3Rpb24gc2V0dXAob2JqZWN0LCBtYXRlcmlhbCwgcHJvZ3JhbSwgZ2VvbWV0cnksIGluZGV4KSB7CiAgICBsZXQgdXBkYXRlQnVmZmVycyA9IGZhbHNlOwogICAgaWYgKHZhb0F2YWlsYWJsZSkgewogICAgICBjb25zdCBzdGF0ZSA9IGdldEJpbmRpbmdTdGF0ZShnZW9tZXRyeSwgcHJvZ3JhbSwgbWF0ZXJpYWwpOwogICAgICBpZiAoY3VycmVudFN0YXRlICE9PSBzdGF0ZSkgewogICAgICAgIGN1cnJlbnRTdGF0ZSA9IHN0YXRlOwogICAgICAgIGJpbmRWZXJ0ZXhBcnJheU9iamVjdChjdXJyZW50U3RhdGUub2JqZWN0KTsKICAgICAgfQogICAgICB1cGRhdGVCdWZmZXJzID0gbmVlZHNVcGRhdGUoZ2VvbWV0cnksIGluZGV4KTsKICAgICAgaWYgKHVwZGF0ZUJ1ZmZlcnMpCiAgICAgICAgc2F2ZUNhY2hlKGdlb21ldHJ5LCBpbmRleCk7CiAgICB9IGVsc2UgewogICAgICBjb25zdCB3aXJlZnJhbWUgPSBtYXRlcmlhbC53aXJlZnJhbWUgPT09IHRydWU7CiAgICAgIGlmIChjdXJyZW50U3RhdGUuZ2VvbWV0cnkgIT09IGdlb21ldHJ5LmlkIHx8IGN1cnJlbnRTdGF0ZS5wcm9ncmFtICE9PSBwcm9ncmFtLmlkIHx8IGN1cnJlbnRTdGF0ZS53aXJlZnJhbWUgIT09IHdpcmVmcmFtZSkgewogICAgICAgIGN1cnJlbnRTdGF0ZS5nZW9tZXRyeSA9IGdlb21ldHJ5LmlkOwogICAgICAgIGN1cnJlbnRTdGF0ZS5wcm9ncmFtID0gcHJvZ3JhbS5pZDsKICAgICAgICBjdXJyZW50U3RhdGUud2lyZWZyYW1lID0gd2lyZWZyYW1lOwogICAgICAgIHVwZGF0ZUJ1ZmZlcnMgPSB0cnVlOwogICAgICB9CiAgICB9CiAgICBpZiAob2JqZWN0LmlzSW5zdGFuY2VkTWVzaCA9PT0gdHJ1ZSkgewogICAgICB1cGRhdGVCdWZmZXJzID0gdHJ1ZTsKICAgIH0KICAgIGlmIChpbmRleCAhPT0gbnVsbCkgewogICAgICBhdHRyaWJ1dGVzLnVwZGF0ZShpbmRleCwgMzQ5NjMpOwogICAgfQogICAgaWYgKHVwZGF0ZUJ1ZmZlcnMpIHsKICAgICAgc2V0dXBWZXJ0ZXhBdHRyaWJ1dGVzKG9iamVjdCwgbWF0ZXJpYWwsIHByb2dyYW0sIGdlb21ldHJ5KTsKICAgICAgaWYgKGluZGV4ICE9PSBudWxsKSB7CiAgICAgICAgZ2wuYmluZEJ1ZmZlcigzNDk2MywgYXR0cmlidXRlcy5nZXQoaW5kZXgpLmJ1ZmZlcik7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gY3JlYXRlVmVydGV4QXJyYXlPYmplY3QoKSB7CiAgICBpZiAoY2FwYWJpbGl0aWVzLmlzV2ViR0wyKQogICAgICByZXR1cm4gZ2wuY3JlYXRlVmVydGV4QXJyYXkoKTsKICAgIHJldHVybiBleHRlbnNpb24uY3JlYXRlVmVydGV4QXJyYXlPRVMoKTsKICB9CiAgZnVuY3Rpb24gYmluZFZlcnRleEFycmF5T2JqZWN0KHZhbykgewogICAgaWYgKGNhcGFiaWxpdGllcy5pc1dlYkdMMikKICAgICAgcmV0dXJuIGdsLmJpbmRWZXJ0ZXhBcnJheSh2YW8pOwogICAgcmV0dXJuIGV4dGVuc2lvbi5iaW5kVmVydGV4QXJyYXlPRVModmFvKTsKICB9CiAgZnVuY3Rpb24gZGVsZXRlVmVydGV4QXJyYXlPYmplY3QodmFvKSB7CiAgICBpZiAoY2FwYWJpbGl0aWVzLmlzV2ViR0wyKQogICAgICByZXR1cm4gZ2wuZGVsZXRlVmVydGV4QXJyYXkodmFvKTsKICAgIHJldHVybiBleHRlbnNpb24uZGVsZXRlVmVydGV4QXJyYXlPRVModmFvKTsKICB9CiAgZnVuY3Rpb24gZ2V0QmluZGluZ1N0YXRlKGdlb21ldHJ5LCBwcm9ncmFtLCBtYXRlcmlhbCkgewogICAgY29uc3Qgd2lyZWZyYW1lID0gbWF0ZXJpYWwud2lyZWZyYW1lID09PSB0cnVlOwogICAgbGV0IHByb2dyYW1NYXAgPSBiaW5kaW5nU3RhdGVzW2dlb21ldHJ5LmlkXTsKICAgIGlmIChwcm9ncmFtTWFwID09PSB2b2lkIDApIHsKICAgICAgcHJvZ3JhbU1hcCA9IHt9OwogICAgICBiaW5kaW5nU3RhdGVzW2dlb21ldHJ5LmlkXSA9IHByb2dyYW1NYXA7CiAgICB9CiAgICBsZXQgc3RhdGVNYXAgPSBwcm9ncmFtTWFwW3Byb2dyYW0uaWRdOwogICAgaWYgKHN0YXRlTWFwID09PSB2b2lkIDApIHsKICAgICAgc3RhdGVNYXAgPSB7fTsKICAgICAgcHJvZ3JhbU1hcFtwcm9ncmFtLmlkXSA9IHN0YXRlTWFwOwogICAgfQogICAgbGV0IHN0YXRlID0gc3RhdGVNYXBbd2lyZWZyYW1lXTsKICAgIGlmIChzdGF0ZSA9PT0gdm9pZCAwKSB7CiAgICAgIHN0YXRlID0gY3JlYXRlQmluZGluZ1N0YXRlKGNyZWF0ZVZlcnRleEFycmF5T2JqZWN0KCkpOwogICAgICBzdGF0ZU1hcFt3aXJlZnJhbWVdID0gc3RhdGU7CiAgICB9CiAgICByZXR1cm4gc3RhdGU7CiAgfQogIGZ1bmN0aW9uIGNyZWF0ZUJpbmRpbmdTdGF0ZSh2YW8pIHsKICAgIGNvbnN0IG5ld0F0dHJpYnV0ZXMgPSBbXTsKICAgIGNvbnN0IGVuYWJsZWRBdHRyaWJ1dGVzID0gW107CiAgICBjb25zdCBhdHRyaWJ1dGVEaXZpc29ycyA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhWZXJ0ZXhBdHRyaWJ1dGVzOyBpKyspIHsKICAgICAgbmV3QXR0cmlidXRlc1tpXSA9IDA7CiAgICAgIGVuYWJsZWRBdHRyaWJ1dGVzW2ldID0gMDsKICAgICAgYXR0cmlidXRlRGl2aXNvcnNbaV0gPSAwOwogICAgfQogICAgcmV0dXJuIHsKICAgICAgZ2VvbWV0cnk6IG51bGwsCiAgICAgIHByb2dyYW06IG51bGwsCiAgICAgIHdpcmVmcmFtZTogZmFsc2UsCiAgICAgIG5ld0F0dHJpYnV0ZXMsCiAgICAgIGVuYWJsZWRBdHRyaWJ1dGVzLAogICAgICBhdHRyaWJ1dGVEaXZpc29ycywKICAgICAgb2JqZWN0OiB2YW8sCiAgICAgIGF0dHJpYnV0ZXM6IHt9LAogICAgICBpbmRleDogbnVsbAogICAgfTsKICB9CiAgZnVuY3Rpb24gbmVlZHNVcGRhdGUoZ2VvbWV0cnksIGluZGV4KSB7CiAgICBjb25zdCBjYWNoZWRBdHRyaWJ1dGVzID0gY3VycmVudFN0YXRlLmF0dHJpYnV0ZXM7CiAgICBjb25zdCBnZW9tZXRyeUF0dHJpYnV0ZXMgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzOwogICAgbGV0IGF0dHJpYnV0ZXNOdW0gPSAwOwogICAgZm9yIChjb25zdCBrZXkgaW4gZ2VvbWV0cnlBdHRyaWJ1dGVzKSB7CiAgICAgIGNvbnN0IGNhY2hlZEF0dHJpYnV0ZSA9IGNhY2hlZEF0dHJpYnV0ZXNba2V5XTsKICAgICAgY29uc3QgZ2VvbWV0cnlBdHRyaWJ1dGUgPSBnZW9tZXRyeUF0dHJpYnV0ZXNba2V5XTsKICAgICAgaWYgKGNhY2hlZEF0dHJpYnV0ZSA9PT0gdm9pZCAwKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICBpZiAoY2FjaGVkQXR0cmlidXRlLmF0dHJpYnV0ZSAhPT0gZ2VvbWV0cnlBdHRyaWJ1dGUpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGlmIChjYWNoZWRBdHRyaWJ1dGUuZGF0YSAhPT0gZ2VvbWV0cnlBdHRyaWJ1dGUuZGF0YSkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgYXR0cmlidXRlc051bSsrOwogICAgfQogICAgaWYgKGN1cnJlbnRTdGF0ZS5hdHRyaWJ1dGVzTnVtICE9PSBhdHRyaWJ1dGVzTnVtKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmIChjdXJyZW50U3RhdGUuaW5kZXggIT09IGluZGV4KQogICAgICByZXR1cm4gdHJ1ZTsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgZnVuY3Rpb24gc2F2ZUNhY2hlKGdlb21ldHJ5LCBpbmRleCkgewogICAgY29uc3QgY2FjaGUgPSB7fTsKICAgIGNvbnN0IGF0dHJpYnV0ZXMyID0gZ2VvbWV0cnkuYXR0cmlidXRlczsKICAgIGxldCBhdHRyaWJ1dGVzTnVtID0gMDsKICAgIGZvciAoY29uc3Qga2V5IGluIGF0dHJpYnV0ZXMyKSB7CiAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IGF0dHJpYnV0ZXMyW2tleV07CiAgICAgIGNvbnN0IGRhdGEgPSB7fTsKICAgICAgZGF0YS5hdHRyaWJ1dGUgPSBhdHRyaWJ1dGU7CiAgICAgIGlmIChhdHRyaWJ1dGUuZGF0YSkgewogICAgICAgIGRhdGEuZGF0YSA9IGF0dHJpYnV0ZS5kYXRhOwogICAgICB9CiAgICAgIGNhY2hlW2tleV0gPSBkYXRhOwogICAgICBhdHRyaWJ1dGVzTnVtKys7CiAgICB9CiAgICBjdXJyZW50U3RhdGUuYXR0cmlidXRlcyA9IGNhY2hlOwogICAgY3VycmVudFN0YXRlLmF0dHJpYnV0ZXNOdW0gPSBhdHRyaWJ1dGVzTnVtOwogICAgY3VycmVudFN0YXRlLmluZGV4ID0gaW5kZXg7CiAgfQogIGZ1bmN0aW9uIGluaXRBdHRyaWJ1dGVzKCkgewogICAgY29uc3QgbmV3QXR0cmlidXRlcyA9IGN1cnJlbnRTdGF0ZS5uZXdBdHRyaWJ1dGVzOwogICAgZm9yIChsZXQgaSA9IDAsIGlsID0gbmV3QXR0cmlidXRlcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgIG5ld0F0dHJpYnV0ZXNbaV0gPSAwOwogICAgfQogIH0KICBmdW5jdGlvbiBlbmFibGVBdHRyaWJ1dGUoYXR0cmlidXRlKSB7CiAgICBlbmFibGVBdHRyaWJ1dGVBbmREaXZpc29yKGF0dHJpYnV0ZSwgMCk7CiAgfQogIGZ1bmN0aW9uIGVuYWJsZUF0dHJpYnV0ZUFuZERpdmlzb3IoYXR0cmlidXRlLCBtZXNoUGVyQXR0cmlidXRlKSB7CiAgICBjb25zdCBuZXdBdHRyaWJ1dGVzID0gY3VycmVudFN0YXRlLm5ld0F0dHJpYnV0ZXM7CiAgICBjb25zdCBlbmFibGVkQXR0cmlidXRlcyA9IGN1cnJlbnRTdGF0ZS5lbmFibGVkQXR0cmlidXRlczsKICAgIGNvbnN0IGF0dHJpYnV0ZURpdmlzb3JzID0gY3VycmVudFN0YXRlLmF0dHJpYnV0ZURpdmlzb3JzOwogICAgbmV3QXR0cmlidXRlc1thdHRyaWJ1dGVdID0gMTsKICAgIGlmIChlbmFibGVkQXR0cmlidXRlc1thdHRyaWJ1dGVdID09PSAwKSB7CiAgICAgIGdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KGF0dHJpYnV0ZSk7CiAgICAgIGVuYWJsZWRBdHRyaWJ1dGVzW2F0dHJpYnV0ZV0gPSAxOwogICAgfQogICAgaWYgKGF0dHJpYnV0ZURpdmlzb3JzW2F0dHJpYnV0ZV0gIT09IG1lc2hQZXJBdHRyaWJ1dGUpIHsKICAgICAgY29uc3QgZXh0ZW5zaW9uMiA9IGNhcGFiaWxpdGllcy5pc1dlYkdMMiA/IGdsIDogZXh0ZW5zaW9ucy5nZXQoIkFOR0xFX2luc3RhbmNlZF9hcnJheXMiKTsKICAgICAgZXh0ZW5zaW9uMltjYXBhYmlsaXRpZXMuaXNXZWJHTDIgPyAidmVydGV4QXR0cmliRGl2aXNvciIgOiAidmVydGV4QXR0cmliRGl2aXNvckFOR0xFIl0oYXR0cmlidXRlLCBtZXNoUGVyQXR0cmlidXRlKTsKICAgICAgYXR0cmlidXRlRGl2aXNvcnNbYXR0cmlidXRlXSA9IG1lc2hQZXJBdHRyaWJ1dGU7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGRpc2FibGVVbnVzZWRBdHRyaWJ1dGVzKCkgewogICAgY29uc3QgbmV3QXR0cmlidXRlcyA9IGN1cnJlbnRTdGF0ZS5uZXdBdHRyaWJ1dGVzOwogICAgY29uc3QgZW5hYmxlZEF0dHJpYnV0ZXMgPSBjdXJyZW50U3RhdGUuZW5hYmxlZEF0dHJpYnV0ZXM7CiAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBlbmFibGVkQXR0cmlidXRlcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgIGlmIChlbmFibGVkQXR0cmlidXRlc1tpXSAhPT0gbmV3QXR0cmlidXRlc1tpXSkgewogICAgICAgIGdsLmRpc2FibGVWZXJ0ZXhBdHRyaWJBcnJheShpKTsKICAgICAgICBlbmFibGVkQXR0cmlidXRlc1tpXSA9IDA7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gdmVydGV4QXR0cmliUG9pbnRlcihpbmRleCwgc2l6ZSwgdHlwZSwgbm9ybWFsaXplZCwgc3RyaWRlLCBvZmZzZXQpIHsKICAgIGlmIChjYXBhYmlsaXRpZXMuaXNXZWJHTDIgPT09IHRydWUgJiYgKHR5cGUgPT09IDUxMjQgfHwgdHlwZSA9PT0gNTEyNSkpIHsKICAgICAgZ2wudmVydGV4QXR0cmliSVBvaW50ZXIoaW5kZXgsIHNpemUsIHR5cGUsIHN0cmlkZSwgb2Zmc2V0KTsKICAgIH0gZWxzZSB7CiAgICAgIGdsLnZlcnRleEF0dHJpYlBvaW50ZXIoaW5kZXgsIHNpemUsIHR5cGUsIG5vcm1hbGl6ZWQsIHN0cmlkZSwgb2Zmc2V0KTsKICAgIH0KICB9CiAgZnVuY3Rpb24gc2V0dXBWZXJ0ZXhBdHRyaWJ1dGVzKG9iamVjdCwgbWF0ZXJpYWwsIHByb2dyYW0sIGdlb21ldHJ5KSB7CiAgICBpZiAoY2FwYWJpbGl0aWVzLmlzV2ViR0wyID09PSBmYWxzZSAmJiAob2JqZWN0LmlzSW5zdGFuY2VkTWVzaCB8fCBnZW9tZXRyeS5pc0luc3RhbmNlZEJ1ZmZlckdlb21ldHJ5KSkgewogICAgICBpZiAoZXh0ZW5zaW9ucy5nZXQoIkFOR0xFX2luc3RhbmNlZF9hcnJheXMiKSA9PT0gbnVsbCkKICAgICAgICByZXR1cm47CiAgICB9CiAgICBpbml0QXR0cmlidXRlcygpOwogICAgY29uc3QgZ2VvbWV0cnlBdHRyaWJ1dGVzID0gZ2VvbWV0cnkuYXR0cmlidXRlczsKICAgIGNvbnN0IHByb2dyYW1BdHRyaWJ1dGVzID0gcHJvZ3JhbS5nZXRBdHRyaWJ1dGVzKCk7CiAgICBjb25zdCBtYXRlcmlhbERlZmF1bHRBdHRyaWJ1dGVWYWx1ZXMgPSBtYXRlcmlhbC5kZWZhdWx0QXR0cmlidXRlVmFsdWVzOwogICAgZm9yIChjb25zdCBuYW1lIGluIHByb2dyYW1BdHRyaWJ1dGVzKSB7CiAgICAgIGNvbnN0IHByb2dyYW1BdHRyaWJ1dGUgPSBwcm9ncmFtQXR0cmlidXRlc1tuYW1lXTsKICAgICAgaWYgKHByb2dyYW1BdHRyaWJ1dGUubG9jYXRpb24gPj0gMCkgewogICAgICAgIGxldCBnZW9tZXRyeUF0dHJpYnV0ZSA9IGdlb21ldHJ5QXR0cmlidXRlc1tuYW1lXTsKICAgICAgICBpZiAoZ2VvbWV0cnlBdHRyaWJ1dGUgPT09IHZvaWQgMCkgewogICAgICAgICAgaWYgKG5hbWUgPT09ICJpbnN0YW5jZU1hdHJpeCIgJiYgb2JqZWN0Lmluc3RhbmNlTWF0cml4KQogICAgICAgICAgICBnZW9tZXRyeUF0dHJpYnV0ZSA9IG9iamVjdC5pbnN0YW5jZU1hdHJpeDsKICAgICAgICAgIGlmIChuYW1lID09PSAiaW5zdGFuY2VDb2xvciIgJiYgb2JqZWN0Lmluc3RhbmNlQ29sb3IpCiAgICAgICAgICAgIGdlb21ldHJ5QXR0cmlidXRlID0gb2JqZWN0Lmluc3RhbmNlQ29sb3I7CiAgICAgICAgfQogICAgICAgIGlmIChnZW9tZXRyeUF0dHJpYnV0ZSAhPT0gdm9pZCAwKSB7CiAgICAgICAgICBjb25zdCBub3JtYWxpemVkID0gZ2VvbWV0cnlBdHRyaWJ1dGUubm9ybWFsaXplZDsKICAgICAgICAgIGNvbnN0IHNpemUgPSBnZW9tZXRyeUF0dHJpYnV0ZS5pdGVtU2l6ZTsKICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IGF0dHJpYnV0ZXMuZ2V0KGdlb21ldHJ5QXR0cmlidXRlKTsKICAgICAgICAgIGlmIChhdHRyaWJ1dGUgPT09IHZvaWQgMCkKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICBjb25zdCBidWZmZXIgPSBhdHRyaWJ1dGUuYnVmZmVyOwogICAgICAgICAgY29uc3QgdHlwZSA9IGF0dHJpYnV0ZS50eXBlOwogICAgICAgICAgY29uc3QgYnl0ZXNQZXJFbGVtZW50ID0gYXR0cmlidXRlLmJ5dGVzUGVyRWxlbWVudDsKICAgICAgICAgIGlmIChnZW9tZXRyeUF0dHJpYnV0ZS5pc0ludGVybGVhdmVkQnVmZmVyQXR0cmlidXRlKSB7CiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBnZW9tZXRyeUF0dHJpYnV0ZS5kYXRhOwogICAgICAgICAgICBjb25zdCBzdHJpZGUgPSBkYXRhLnN0cmlkZTsKICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gZ2VvbWV0cnlBdHRyaWJ1dGUub2Zmc2V0OwogICAgICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLmlzSW5zdGFuY2VkSW50ZXJsZWF2ZWRCdWZmZXIpIHsKICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb2dyYW1BdHRyaWJ1dGUubG9jYXRpb25TaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGVuYWJsZUF0dHJpYnV0ZUFuZERpdmlzb3IocHJvZ3JhbUF0dHJpYnV0ZS5sb2NhdGlvbiArIGksIGRhdGEubWVzaFBlckF0dHJpYnV0ZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChvYmplY3QuaXNJbnN0YW5jZWRNZXNoICE9PSB0cnVlICYmIGdlb21ldHJ5Ll9tYXhJbnN0YW5jZUNvdW50ID09PSB2b2lkIDApIHsKICAgICAgICAgICAgICAgIGdlb21ldHJ5Ll9tYXhJbnN0YW5jZUNvdW50ID0gZGF0YS5tZXNoUGVyQXR0cmlidXRlICogZGF0YS5jb3VudDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9ncmFtQXR0cmlidXRlLmxvY2F0aW9uU2l6ZTsgaSsrKSB7CiAgICAgICAgICAgICAgICBlbmFibGVBdHRyaWJ1dGUocHJvZ3JhbUF0dHJpYnV0ZS5sb2NhdGlvbiArIGkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBnbC5iaW5kQnVmZmVyKDM0OTYyLCBidWZmZXIpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb2dyYW1BdHRyaWJ1dGUubG9jYXRpb25TaXplOyBpKyspIHsKICAgICAgICAgICAgICB2ZXJ0ZXhBdHRyaWJQb2ludGVyKHByb2dyYW1BdHRyaWJ1dGUubG9jYXRpb24gKyBpLCBzaXplIC8gcHJvZ3JhbUF0dHJpYnV0ZS5sb2NhdGlvblNpemUsIHR5cGUsIG5vcm1hbGl6ZWQsIHN0cmlkZSAqIGJ5dGVzUGVyRWxlbWVudCwgKG9mZnNldCArIHNpemUgLyBwcm9ncmFtQXR0cmlidXRlLmxvY2F0aW9uU2l6ZSAqIGkpICogYnl0ZXNQZXJFbGVtZW50KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKGdlb21ldHJ5QXR0cmlidXRlLmlzSW5zdGFuY2VkQnVmZmVyQXR0cmlidXRlKSB7CiAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9ncmFtQXR0cmlidXRlLmxvY2F0aW9uU2l6ZTsgaSsrKSB7CiAgICAgICAgICAgICAgICBlbmFibGVBdHRyaWJ1dGVBbmREaXZpc29yKHByb2dyYW1BdHRyaWJ1dGUubG9jYXRpb24gKyBpLCBnZW9tZXRyeUF0dHJpYnV0ZS5tZXNoUGVyQXR0cmlidXRlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKG9iamVjdC5pc0luc3RhbmNlZE1lc2ggIT09IHRydWUgJiYgZ2VvbWV0cnkuX21heEluc3RhbmNlQ291bnQgPT09IHZvaWQgMCkgewogICAgICAgICAgICAgICAgZ2VvbWV0cnkuX21heEluc3RhbmNlQ291bnQgPSBnZW9tZXRyeUF0dHJpYnV0ZS5tZXNoUGVyQXR0cmlidXRlICogZ2VvbWV0cnlBdHRyaWJ1dGUuY291bnQ7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJvZ3JhbUF0dHJpYnV0ZS5sb2NhdGlvblNpemU7IGkrKykgewogICAgICAgICAgICAgICAgZW5hYmxlQXR0cmlidXRlKHByb2dyYW1BdHRyaWJ1dGUubG9jYXRpb24gKyBpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2wuYmluZEJ1ZmZlcigzNDk2MiwgYnVmZmVyKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9ncmFtQXR0cmlidXRlLmxvY2F0aW9uU2l6ZTsgaSsrKSB7CiAgICAgICAgICAgICAgdmVydGV4QXR0cmliUG9pbnRlcihwcm9ncmFtQXR0cmlidXRlLmxvY2F0aW9uICsgaSwgc2l6ZSAvIHByb2dyYW1BdHRyaWJ1dGUubG9jYXRpb25TaXplLCB0eXBlLCBub3JtYWxpemVkLCBzaXplICogYnl0ZXNQZXJFbGVtZW50LCBzaXplIC8gcHJvZ3JhbUF0dHJpYnV0ZS5sb2NhdGlvblNpemUgKiBpICogYnl0ZXNQZXJFbGVtZW50KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAobWF0ZXJpYWxEZWZhdWx0QXR0cmlidXRlVmFsdWVzICE9PSB2b2lkIDApIHsKICAgICAgICAgIGNvbnN0IHZhbHVlID0gbWF0ZXJpYWxEZWZhdWx0QXR0cmlidXRlVmFsdWVzW25hbWVdOwogICAgICAgICAgaWYgKHZhbHVlICE9PSB2b2lkIDApIHsKICAgICAgICAgICAgc3dpdGNoICh2YWx1ZS5sZW5ndGgpIHsKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBnbC52ZXJ0ZXhBdHRyaWIyZnYocHJvZ3JhbUF0dHJpYnV0ZS5sb2NhdGlvbiwgdmFsdWUpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgZ2wudmVydGV4QXR0cmliM2Z2KHByb2dyYW1BdHRyaWJ1dGUubG9jYXRpb24sIHZhbHVlKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIGdsLnZlcnRleEF0dHJpYjRmdihwcm9ncmFtQXR0cmlidXRlLmxvY2F0aW9uLCB2YWx1ZSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgZ2wudmVydGV4QXR0cmliMWZ2KHByb2dyYW1BdHRyaWJ1dGUubG9jYXRpb24sIHZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgZGlzYWJsZVVudXNlZEF0dHJpYnV0ZXMoKTsKICB9CiAgZnVuY3Rpb24gZGlzcG9zZSgpIHsKICAgIHJlc2V0KCk7CiAgICBmb3IgKGNvbnN0IGdlb21ldHJ5SWQgaW4gYmluZGluZ1N0YXRlcykgewogICAgICBjb25zdCBwcm9ncmFtTWFwID0gYmluZGluZ1N0YXRlc1tnZW9tZXRyeUlkXTsKICAgICAgZm9yIChjb25zdCBwcm9ncmFtSWQgaW4gcHJvZ3JhbU1hcCkgewogICAgICAgIGNvbnN0IHN0YXRlTWFwID0gcHJvZ3JhbU1hcFtwcm9ncmFtSWRdOwogICAgICAgIGZvciAoY29uc3Qgd2lyZWZyYW1lIGluIHN0YXRlTWFwKSB7CiAgICAgICAgICBkZWxldGVWZXJ0ZXhBcnJheU9iamVjdChzdGF0ZU1hcFt3aXJlZnJhbWVdLm9iamVjdCk7CiAgICAgICAgICBkZWxldGUgc3RhdGVNYXBbd2lyZWZyYW1lXTsKICAgICAgICB9CiAgICAgICAgZGVsZXRlIHByb2dyYW1NYXBbcHJvZ3JhbUlkXTsKICAgICAgfQogICAgICBkZWxldGUgYmluZGluZ1N0YXRlc1tnZW9tZXRyeUlkXTsKICAgIH0KICB9CiAgZnVuY3Rpb24gcmVsZWFzZVN0YXRlc09mR2VvbWV0cnkoZ2VvbWV0cnkpIHsKICAgIGlmIChiaW5kaW5nU3RhdGVzW2dlb21ldHJ5LmlkXSA9PT0gdm9pZCAwKQogICAgICByZXR1cm47CiAgICBjb25zdCBwcm9ncmFtTWFwID0gYmluZGluZ1N0YXRlc1tnZW9tZXRyeS5pZF07CiAgICBmb3IgKGNvbnN0IHByb2dyYW1JZCBpbiBwcm9ncmFtTWFwKSB7CiAgICAgIGNvbnN0IHN0YXRlTWFwID0gcHJvZ3JhbU1hcFtwcm9ncmFtSWRdOwogICAgICBmb3IgKGNvbnN0IHdpcmVmcmFtZSBpbiBzdGF0ZU1hcCkgewogICAgICAgIGRlbGV0ZVZlcnRleEFycmF5T2JqZWN0KHN0YXRlTWFwW3dpcmVmcmFtZV0ub2JqZWN0KTsKICAgICAgICBkZWxldGUgc3RhdGVNYXBbd2lyZWZyYW1lXTsKICAgICAgfQogICAgICBkZWxldGUgcHJvZ3JhbU1hcFtwcm9ncmFtSWRdOwogICAgfQogICAgZGVsZXRlIGJpbmRpbmdTdGF0ZXNbZ2VvbWV0cnkuaWRdOwogIH0KICBmdW5jdGlvbiByZWxlYXNlU3RhdGVzT2ZQcm9ncmFtKHByb2dyYW0pIHsKICAgIGZvciAoY29uc3QgZ2VvbWV0cnlJZCBpbiBiaW5kaW5nU3RhdGVzKSB7CiAgICAgIGNvbnN0IHByb2dyYW1NYXAgPSBiaW5kaW5nU3RhdGVzW2dlb21ldHJ5SWRdOwogICAgICBpZiAocHJvZ3JhbU1hcFtwcm9ncmFtLmlkXSA9PT0gdm9pZCAwKQogICAgICAgIGNvbnRpbnVlOwogICAgICBjb25zdCBzdGF0ZU1hcCA9IHByb2dyYW1NYXBbcHJvZ3JhbS5pZF07CiAgICAgIGZvciAoY29uc3Qgd2lyZWZyYW1lIGluIHN0YXRlTWFwKSB7CiAgICAgICAgZGVsZXRlVmVydGV4QXJyYXlPYmplY3Qoc3RhdGVNYXBbd2lyZWZyYW1lXS5vYmplY3QpOwogICAgICAgIGRlbGV0ZSBzdGF0ZU1hcFt3aXJlZnJhbWVdOwogICAgICB9CiAgICAgIGRlbGV0ZSBwcm9ncmFtTWFwW3Byb2dyYW0uaWRdOwogICAgfQogIH0KICBmdW5jdGlvbiByZXNldCgpIHsKICAgIHJlc2V0RGVmYXVsdFN0YXRlKCk7CiAgICBpZiAoY3VycmVudFN0YXRlID09PSBkZWZhdWx0U3RhdGUpCiAgICAgIHJldHVybjsKICAgIGN1cnJlbnRTdGF0ZSA9IGRlZmF1bHRTdGF0ZTsKICAgIGJpbmRWZXJ0ZXhBcnJheU9iamVjdChjdXJyZW50U3RhdGUub2JqZWN0KTsKICB9CiAgZnVuY3Rpb24gcmVzZXREZWZhdWx0U3RhdGUoKSB7CiAgICBkZWZhdWx0U3RhdGUuZ2VvbWV0cnkgPSBudWxsOwogICAgZGVmYXVsdFN0YXRlLnByb2dyYW0gPSBudWxsOwogICAgZGVmYXVsdFN0YXRlLndpcmVmcmFtZSA9IGZhbHNlOwogIH0KICByZXR1cm4gewogICAgc2V0dXAsCiAgICByZXNldCwKICAgIHJlc2V0RGVmYXVsdFN0YXRlLAogICAgZGlzcG9zZSwKICAgIHJlbGVhc2VTdGF0ZXNPZkdlb21ldHJ5LAogICAgcmVsZWFzZVN0YXRlc09mUHJvZ3JhbSwKICAgIGluaXRBdHRyaWJ1dGVzLAogICAgZW5hYmxlQXR0cmlidXRlLAogICAgZGlzYWJsZVVudXNlZEF0dHJpYnV0ZXMKICB9Owp9CmZ1bmN0aW9uIFdlYkdMQnVmZmVyUmVuZGVyZXIoZ2wsIGV4dGVuc2lvbnMsIGluZm8sIGNhcGFiaWxpdGllcykgewogIGNvbnN0IGlzV2ViR0wyID0gY2FwYWJpbGl0aWVzLmlzV2ViR0wyOwogIGxldCBtb2RlOwogIGZ1bmN0aW9uIHNldE1vZGUodmFsdWUpIHsKICAgIG1vZGUgPSB2YWx1ZTsKICB9CiAgZnVuY3Rpb24gcmVuZGVyKHN0YXJ0LCBjb3VudCkgewogICAgZ2wuZHJhd0FycmF5cyhtb2RlLCBzdGFydCwgY291bnQpOwogICAgaW5mby51cGRhdGUoY291bnQsIG1vZGUsIDEpOwogIH0KICBmdW5jdGlvbiByZW5kZXJJbnN0YW5jZXMoc3RhcnQsIGNvdW50LCBwcmltY291bnQpIHsKICAgIGlmIChwcmltY291bnQgPT09IDApCiAgICAgIHJldHVybjsKICAgIGxldCBleHRlbnNpb24sIG1ldGhvZE5hbWU7CiAgICBpZiAoaXNXZWJHTDIpIHsKICAgICAgZXh0ZW5zaW9uID0gZ2w7CiAgICAgIG1ldGhvZE5hbWUgPSAiZHJhd0FycmF5c0luc3RhbmNlZCI7CiAgICB9IGVsc2UgewogICAgICBleHRlbnNpb24gPSBleHRlbnNpb25zLmdldCgiQU5HTEVfaW5zdGFuY2VkX2FycmF5cyIpOwogICAgICBtZXRob2ROYW1lID0gImRyYXdBcnJheXNJbnN0YW5jZWRBTkdMRSI7CiAgICAgIGlmIChleHRlbnNpb24gPT09IG51bGwpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5XZWJHTEJ1ZmZlclJlbmRlcmVyOiB1c2luZyBUSFJFRS5JbnN0YW5jZWRCdWZmZXJHZW9tZXRyeSBidXQgaGFyZHdhcmUgZG9lcyBub3Qgc3VwcG9ydCBleHRlbnNpb24gQU5HTEVfaW5zdGFuY2VkX2FycmF5cy4iKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KICAgIGV4dGVuc2lvblttZXRob2ROYW1lXShtb2RlLCBzdGFydCwgY291bnQsIHByaW1jb3VudCk7CiAgICBpbmZvLnVwZGF0ZShjb3VudCwgbW9kZSwgcHJpbWNvdW50KTsKICB9CiAgdGhpcy5zZXRNb2RlID0gc2V0TW9kZTsKICB0aGlzLnJlbmRlciA9IHJlbmRlcjsKICB0aGlzLnJlbmRlckluc3RhbmNlcyA9IHJlbmRlckluc3RhbmNlczsKfQpmdW5jdGlvbiBXZWJHTENhcGFiaWxpdGllcyhnbCwgZXh0ZW5zaW9ucywgcGFyYW1ldGVycykgewogIGxldCBtYXhBbmlzb3Ryb3B5OwogIGZ1bmN0aW9uIGdldE1heEFuaXNvdHJvcHkoKSB7CiAgICBpZiAobWF4QW5pc290cm9weSAhPT0gdm9pZCAwKQogICAgICByZXR1cm4gbWF4QW5pc290cm9weTsKICAgIGlmIChleHRlbnNpb25zLmhhcygiRVhUX3RleHR1cmVfZmlsdGVyX2FuaXNvdHJvcGljIikgPT09IHRydWUpIHsKICAgICAgY29uc3QgZXh0ZW5zaW9uID0gZXh0ZW5zaW9ucy5nZXQoIkVYVF90ZXh0dXJlX2ZpbHRlcl9hbmlzb3Ryb3BpYyIpOwogICAgICBtYXhBbmlzb3Ryb3B5ID0gZ2wuZ2V0UGFyYW1ldGVyKGV4dGVuc2lvbi5NQVhfVEVYVFVSRV9NQVhfQU5JU09UUk9QWV9FWFQpOwogICAgfSBlbHNlIHsKICAgICAgbWF4QW5pc290cm9weSA9IDA7CiAgICB9CiAgICByZXR1cm4gbWF4QW5pc290cm9weTsKICB9CiAgZnVuY3Rpb24gZ2V0TWF4UHJlY2lzaW9uKHByZWNpc2lvbjIpIHsKICAgIGlmIChwcmVjaXNpb24yID09PSAiaGlnaHAiKSB7CiAgICAgIGlmIChnbC5nZXRTaGFkZXJQcmVjaXNpb25Gb3JtYXQoMzU2MzMsIDM2MzM4KS5wcmVjaXNpb24gPiAwICYmIGdsLmdldFNoYWRlclByZWNpc2lvbkZvcm1hdCgzNTYzMiwgMzYzMzgpLnByZWNpc2lvbiA+IDApIHsKICAgICAgICByZXR1cm4gImhpZ2hwIjsKICAgICAgfQogICAgICBwcmVjaXNpb24yID0gIm1lZGl1bXAiOwogICAgfQogICAgaWYgKHByZWNpc2lvbjIgPT09ICJtZWRpdW1wIikgewogICAgICBpZiAoZ2wuZ2V0U2hhZGVyUHJlY2lzaW9uRm9ybWF0KDM1NjMzLCAzNjMzNykucHJlY2lzaW9uID4gMCAmJiBnbC5nZXRTaGFkZXJQcmVjaXNpb25Gb3JtYXQoMzU2MzIsIDM2MzM3KS5wcmVjaXNpb24gPiAwKSB7CiAgICAgICAgcmV0dXJuICJtZWRpdW1wIjsKICAgICAgfQogICAgfQogICAgcmV0dXJuICJsb3dwIjsKICB9CiAgY29uc3QgaXNXZWJHTDIgPSB0eXBlb2YgV2ViR0wyUmVuZGVyaW5nQ29udGV4dCAhPT0gInVuZGVmaW5lZCIgJiYgZ2wgaW5zdGFuY2VvZiBXZWJHTDJSZW5kZXJpbmdDb250ZXh0IHx8IHR5cGVvZiBXZWJHTDJDb21wdXRlUmVuZGVyaW5nQ29udGV4dCAhPT0gInVuZGVmaW5lZCIgJiYgZ2wgaW5zdGFuY2VvZiBXZWJHTDJDb21wdXRlUmVuZGVyaW5nQ29udGV4dDsKICBsZXQgcHJlY2lzaW9uID0gcGFyYW1ldGVycy5wcmVjaXNpb24gIT09IHZvaWQgMCA/IHBhcmFtZXRlcnMucHJlY2lzaW9uIDogImhpZ2hwIjsKICBjb25zdCBtYXhQcmVjaXNpb24gPSBnZXRNYXhQcmVjaXNpb24ocHJlY2lzaW9uKTsKICBpZiAobWF4UHJlY2lzaW9uICE9PSBwcmVjaXNpb24pIHsKICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjoiLCBwcmVjaXNpb24sICJub3Qgc3VwcG9ydGVkLCB1c2luZyIsIG1heFByZWNpc2lvbiwgImluc3RlYWQuIik7CiAgICBwcmVjaXNpb24gPSBtYXhQcmVjaXNpb247CiAgfQogIGNvbnN0IGRyYXdCdWZmZXJzID0gaXNXZWJHTDIgfHwgZXh0ZW5zaW9ucy5oYXMoIldFQkdMX2RyYXdfYnVmZmVycyIpOwogIGNvbnN0IGxvZ2FyaXRobWljRGVwdGhCdWZmZXIgPSBwYXJhbWV0ZXJzLmxvZ2FyaXRobWljRGVwdGhCdWZmZXIgPT09IHRydWU7CiAgY29uc3QgbWF4VGV4dHVyZXMgPSBnbC5nZXRQYXJhbWV0ZXIoMzQ5MzApOwogIGNvbnN0IG1heFZlcnRleFRleHR1cmVzID0gZ2wuZ2V0UGFyYW1ldGVyKDM1NjYwKTsKICBjb25zdCBtYXhUZXh0dXJlU2l6ZSA9IGdsLmdldFBhcmFtZXRlcigzMzc5KTsKICBjb25zdCBtYXhDdWJlbWFwU2l6ZSA9IGdsLmdldFBhcmFtZXRlcigzNDA3Nik7CiAgY29uc3QgbWF4QXR0cmlidXRlcyA9IGdsLmdldFBhcmFtZXRlcigzNDkyMSk7CiAgY29uc3QgbWF4VmVydGV4VW5pZm9ybXMgPSBnbC5nZXRQYXJhbWV0ZXIoMzYzNDcpOwogIGNvbnN0IG1heFZhcnlpbmdzID0gZ2wuZ2V0UGFyYW1ldGVyKDM2MzQ4KTsKICBjb25zdCBtYXhGcmFnbWVudFVuaWZvcm1zID0gZ2wuZ2V0UGFyYW1ldGVyKDM2MzQ5KTsKICBjb25zdCB2ZXJ0ZXhUZXh0dXJlcyA9IG1heFZlcnRleFRleHR1cmVzID4gMDsKICBjb25zdCBmbG9hdEZyYWdtZW50VGV4dHVyZXMgPSBpc1dlYkdMMiB8fCBleHRlbnNpb25zLmhhcygiT0VTX3RleHR1cmVfZmxvYXQiKTsKICBjb25zdCBmbG9hdFZlcnRleFRleHR1cmVzID0gdmVydGV4VGV4dHVyZXMgJiYgZmxvYXRGcmFnbWVudFRleHR1cmVzOwogIGNvbnN0IG1heFNhbXBsZXMgPSBpc1dlYkdMMiA/IGdsLmdldFBhcmFtZXRlcigzNjE4MykgOiAwOwogIHJldHVybiB7CiAgICBpc1dlYkdMMiwKICAgIGRyYXdCdWZmZXJzLAogICAgZ2V0TWF4QW5pc290cm9weSwKICAgIGdldE1heFByZWNpc2lvbiwKICAgIHByZWNpc2lvbiwKICAgIGxvZ2FyaXRobWljRGVwdGhCdWZmZXIsCiAgICBtYXhUZXh0dXJlcywKICAgIG1heFZlcnRleFRleHR1cmVzLAogICAgbWF4VGV4dHVyZVNpemUsCiAgICBtYXhDdWJlbWFwU2l6ZSwKICAgIG1heEF0dHJpYnV0ZXMsCiAgICBtYXhWZXJ0ZXhVbmlmb3JtcywKICAgIG1heFZhcnlpbmdzLAogICAgbWF4RnJhZ21lbnRVbmlmb3JtcywKICAgIHZlcnRleFRleHR1cmVzLAogICAgZmxvYXRGcmFnbWVudFRleHR1cmVzLAogICAgZmxvYXRWZXJ0ZXhUZXh0dXJlcywKICAgIG1heFNhbXBsZXMKICB9Owp9CmZ1bmN0aW9uIFdlYkdMQ2xpcHBpbmcocHJvcGVydGllcykgewogIGNvbnN0IHNjb3BlID0gdGhpczsKICBsZXQgZ2xvYmFsU3RhdGUgPSBudWxsLCBudW1HbG9iYWxQbGFuZXMgPSAwLCBsb2NhbENsaXBwaW5nRW5hYmxlZCA9IGZhbHNlLCByZW5kZXJpbmdTaGFkb3dzID0gZmFsc2U7CiAgY29uc3QgcGxhbmUgPSBuZXcgUGxhbmUoKSwgdmlld05vcm1hbE1hdHJpeCA9IG5ldyBNYXRyaXgzKCksIHVuaWZvcm0gPSB7IHZhbHVlOiBudWxsLCBuZWVkc1VwZGF0ZTogZmFsc2UgfTsKICB0aGlzLnVuaWZvcm0gPSB1bmlmb3JtOwogIHRoaXMubnVtUGxhbmVzID0gMDsKICB0aGlzLm51bUludGVyc2VjdGlvbiA9IDA7CiAgdGhpcy5pbml0ID0gZnVuY3Rpb24ocGxhbmVzLCBlbmFibGVMb2NhbENsaXBwaW5nLCBjYW1lcmEpIHsKICAgIGNvbnN0IGVuYWJsZWQgPSBwbGFuZXMubGVuZ3RoICE9PSAwIHx8IGVuYWJsZUxvY2FsQ2xpcHBpbmcgfHwgbnVtR2xvYmFsUGxhbmVzICE9PSAwIHx8IGxvY2FsQ2xpcHBpbmdFbmFibGVkOwogICAgbG9jYWxDbGlwcGluZ0VuYWJsZWQgPSBlbmFibGVMb2NhbENsaXBwaW5nOwogICAgZ2xvYmFsU3RhdGUgPSBwcm9qZWN0UGxhbmVzKHBsYW5lcywgY2FtZXJhLCAwKTsKICAgIG51bUdsb2JhbFBsYW5lcyA9IHBsYW5lcy5sZW5ndGg7CiAgICByZXR1cm4gZW5hYmxlZDsKICB9OwogIHRoaXMuYmVnaW5TaGFkb3dzID0gZnVuY3Rpb24oKSB7CiAgICByZW5kZXJpbmdTaGFkb3dzID0gdHJ1ZTsKICAgIHByb2plY3RQbGFuZXMobnVsbCk7CiAgfTsKICB0aGlzLmVuZFNoYWRvd3MgPSBmdW5jdGlvbigpIHsKICAgIHJlbmRlcmluZ1NoYWRvd3MgPSBmYWxzZTsKICAgIHJlc2V0R2xvYmFsU3RhdGUoKTsKICB9OwogIHRoaXMuc2V0U3RhdGUgPSBmdW5jdGlvbihtYXRlcmlhbCwgY2FtZXJhLCB1c2VDYWNoZSkgewogICAgY29uc3QgcGxhbmVzID0gbWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMsIGNsaXBJbnRlcnNlY3Rpb24gPSBtYXRlcmlhbC5jbGlwSW50ZXJzZWN0aW9uLCBjbGlwU2hhZG93cyA9IG1hdGVyaWFsLmNsaXBTaGFkb3dzOwogICAgY29uc3QgbWF0ZXJpYWxQcm9wZXJ0aWVzID0gcHJvcGVydGllcy5nZXQobWF0ZXJpYWwpOwogICAgaWYgKCFsb2NhbENsaXBwaW5nRW5hYmxlZCB8fCBwbGFuZXMgPT09IG51bGwgfHwgcGxhbmVzLmxlbmd0aCA9PT0gMCB8fCByZW5kZXJpbmdTaGFkb3dzICYmICFjbGlwU2hhZG93cykgewogICAgICBpZiAocmVuZGVyaW5nU2hhZG93cykgewogICAgICAgIHByb2plY3RQbGFuZXMobnVsbCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVzZXRHbG9iYWxTdGF0ZSgpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBjb25zdCBuR2xvYmFsID0gcmVuZGVyaW5nU2hhZG93cyA/IDAgOiBudW1HbG9iYWxQbGFuZXMsIGxHbG9iYWwgPSBuR2xvYmFsICogNDsKICAgICAgbGV0IGRzdEFycmF5ID0gbWF0ZXJpYWxQcm9wZXJ0aWVzLmNsaXBwaW5nU3RhdGUgfHwgbnVsbDsKICAgICAgdW5pZm9ybS52YWx1ZSA9IGRzdEFycmF5OwogICAgICBkc3RBcnJheSA9IHByb2plY3RQbGFuZXMocGxhbmVzLCBjYW1lcmEsIGxHbG9iYWwsIHVzZUNhY2hlKTsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IGxHbG9iYWw7ICsraSkgewogICAgICAgIGRzdEFycmF5W2ldID0gZ2xvYmFsU3RhdGVbaV07CiAgICAgIH0KICAgICAgbWF0ZXJpYWxQcm9wZXJ0aWVzLmNsaXBwaW5nU3RhdGUgPSBkc3RBcnJheTsKICAgICAgdGhpcy5udW1JbnRlcnNlY3Rpb24gPSBjbGlwSW50ZXJzZWN0aW9uID8gdGhpcy5udW1QbGFuZXMgOiAwOwogICAgICB0aGlzLm51bVBsYW5lcyArPSBuR2xvYmFsOwogICAgfQogIH07CiAgZnVuY3Rpb24gcmVzZXRHbG9iYWxTdGF0ZSgpIHsKICAgIGlmICh1bmlmb3JtLnZhbHVlICE9PSBnbG9iYWxTdGF0ZSkgewogICAgICB1bmlmb3JtLnZhbHVlID0gZ2xvYmFsU3RhdGU7CiAgICAgIHVuaWZvcm0ubmVlZHNVcGRhdGUgPSBudW1HbG9iYWxQbGFuZXMgPiAwOwogICAgfQogICAgc2NvcGUubnVtUGxhbmVzID0gbnVtR2xvYmFsUGxhbmVzOwogICAgc2NvcGUubnVtSW50ZXJzZWN0aW9uID0gMDsKICB9CiAgZnVuY3Rpb24gcHJvamVjdFBsYW5lcyhwbGFuZXMsIGNhbWVyYSwgZHN0T2Zmc2V0LCBza2lwVHJhbnNmb3JtKSB7CiAgICBjb25zdCBuUGxhbmVzID0gcGxhbmVzICE9PSBudWxsID8gcGxhbmVzLmxlbmd0aCA6IDA7CiAgICBsZXQgZHN0QXJyYXkgPSBudWxsOwogICAgaWYgKG5QbGFuZXMgIT09IDApIHsKICAgICAgZHN0QXJyYXkgPSB1bmlmb3JtLnZhbHVlOwogICAgICBpZiAoc2tpcFRyYW5zZm9ybSAhPT0gdHJ1ZSB8fCBkc3RBcnJheSA9PT0gbnVsbCkgewogICAgICAgIGNvbnN0IGZsYXRTaXplID0gZHN0T2Zmc2V0ICsgblBsYW5lcyAqIDQsIHZpZXdNYXRyaXggPSBjYW1lcmEubWF0cml4V29ybGRJbnZlcnNlOwogICAgICAgIHZpZXdOb3JtYWxNYXRyaXguZ2V0Tm9ybWFsTWF0cml4KHZpZXdNYXRyaXgpOwogICAgICAgIGlmIChkc3RBcnJheSA9PT0gbnVsbCB8fCBkc3RBcnJheS5sZW5ndGggPCBmbGF0U2l6ZSkgewogICAgICAgICAgZHN0QXJyYXkgPSBuZXcgRmxvYXQzMkFycmF5KGZsYXRTaXplKTsKICAgICAgICB9CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGk0ID0gZHN0T2Zmc2V0OyBpICE9PSBuUGxhbmVzOyArK2ksIGk0ICs9IDQpIHsKICAgICAgICAgIHBsYW5lLmNvcHkocGxhbmVzW2ldKS5hcHBseU1hdHJpeDQodmlld01hdHJpeCwgdmlld05vcm1hbE1hdHJpeCk7CiAgICAgICAgICBwbGFuZS5ub3JtYWwudG9BcnJheShkc3RBcnJheSwgaTQpOwogICAgICAgICAgZHN0QXJyYXlbaTQgKyAzXSA9IHBsYW5lLmNvbnN0YW50OwogICAgICAgIH0KICAgICAgfQogICAgICB1bmlmb3JtLnZhbHVlID0gZHN0QXJyYXk7CiAgICAgIHVuaWZvcm0ubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgfQogICAgc2NvcGUubnVtUGxhbmVzID0gblBsYW5lczsKICAgIHNjb3BlLm51bUludGVyc2VjdGlvbiA9IDA7CiAgICByZXR1cm4gZHN0QXJyYXk7CiAgfQp9CmZ1bmN0aW9uIFdlYkdMQ3ViZU1hcHMocmVuZGVyZXIpIHsKICBsZXQgY3ViZW1hcHMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKICBmdW5jdGlvbiBtYXBUZXh0dXJlTWFwcGluZyh0ZXh0dXJlLCBtYXBwaW5nKSB7CiAgICBpZiAobWFwcGluZyA9PT0gRXF1aXJlY3Rhbmd1bGFyUmVmbGVjdGlvbk1hcHBpbmcpIHsKICAgICAgdGV4dHVyZS5tYXBwaW5nID0gQ3ViZVJlZmxlY3Rpb25NYXBwaW5nOwogICAgfSBlbHNlIGlmIChtYXBwaW5nID09PSBFcXVpcmVjdGFuZ3VsYXJSZWZyYWN0aW9uTWFwcGluZykgewogICAgICB0ZXh0dXJlLm1hcHBpbmcgPSBDdWJlUmVmcmFjdGlvbk1hcHBpbmc7CiAgICB9CiAgICByZXR1cm4gdGV4dHVyZTsKICB9CiAgZnVuY3Rpb24gZ2V0KHRleHR1cmUpIHsKICAgIGlmICh0ZXh0dXJlICYmIHRleHR1cmUuaXNUZXh0dXJlICYmIHRleHR1cmUuaXNSZW5kZXJUYXJnZXRUZXh0dXJlID09PSBmYWxzZSkgewogICAgICBjb25zdCBtYXBwaW5nID0gdGV4dHVyZS5tYXBwaW5nOwogICAgICBpZiAobWFwcGluZyA9PT0gRXF1aXJlY3Rhbmd1bGFyUmVmbGVjdGlvbk1hcHBpbmcgfHwgbWFwcGluZyA9PT0gRXF1aXJlY3Rhbmd1bGFyUmVmcmFjdGlvbk1hcHBpbmcpIHsKICAgICAgICBpZiAoY3ViZW1hcHMuaGFzKHRleHR1cmUpKSB7CiAgICAgICAgICBjb25zdCBjdWJlbWFwID0gY3ViZW1hcHMuZ2V0KHRleHR1cmUpLnRleHR1cmU7CiAgICAgICAgICByZXR1cm4gbWFwVGV4dHVyZU1hcHBpbmcoY3ViZW1hcCwgdGV4dHVyZS5tYXBwaW5nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgaW1hZ2UgPSB0ZXh0dXJlLmltYWdlOwogICAgICAgICAgaWYgKGltYWdlICYmIGltYWdlLmhlaWdodCA+IDApIHsKICAgICAgICAgICAgY29uc3QgcmVuZGVyVGFyZ2V0ID0gbmV3IFdlYkdMQ3ViZVJlbmRlclRhcmdldChpbWFnZS5oZWlnaHQgLyAyKTsKICAgICAgICAgICAgcmVuZGVyVGFyZ2V0LmZyb21FcXVpcmVjdGFuZ3VsYXJUZXh0dXJlKHJlbmRlcmVyLCB0ZXh0dXJlKTsKICAgICAgICAgICAgY3ViZW1hcHMuc2V0KHRleHR1cmUsIHJlbmRlclRhcmdldCk7CiAgICAgICAgICAgIHRleHR1cmUuYWRkRXZlbnRMaXN0ZW5lcigiZGlzcG9zZSIsIG9uVGV4dHVyZURpc3Bvc2UpOwogICAgICAgICAgICByZXR1cm4gbWFwVGV4dHVyZU1hcHBpbmcocmVuZGVyVGFyZ2V0LnRleHR1cmUsIHRleHR1cmUubWFwcGluZyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0ZXh0dXJlOwogIH0KICBmdW5jdGlvbiBvblRleHR1cmVEaXNwb3NlKGV2ZW50KSB7CiAgICBjb25zdCB0ZXh0dXJlID0gZXZlbnQudGFyZ2V0OwogICAgdGV4dHVyZS5yZW1vdmVFdmVudExpc3RlbmVyKCJkaXNwb3NlIiwgb25UZXh0dXJlRGlzcG9zZSk7CiAgICBjb25zdCBjdWJlbWFwID0gY3ViZW1hcHMuZ2V0KHRleHR1cmUpOwogICAgaWYgKGN1YmVtYXAgIT09IHZvaWQgMCkgewogICAgICBjdWJlbWFwcy5kZWxldGUodGV4dHVyZSk7CiAgICAgIGN1YmVtYXAuZGlzcG9zZSgpOwogICAgfQogIH0KICBmdW5jdGlvbiBkaXNwb3NlKCkgewogICAgY3ViZW1hcHMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKICB9CiAgcmV0dXJuIHsKICAgIGdldCwKICAgIGRpc3Bvc2UKICB9Owp9CmNsYXNzIE9ydGhvZ3JhcGhpY0NhbWVyYSBleHRlbmRzIENhbWVyYSB7CiAgY29uc3RydWN0b3IobGVmdCA9IC0xLCByaWdodCA9IDEsIHRvcCA9IDEsIGJvdHRvbSA9IC0xLCBuZWFyID0gMC4xLCBmYXIgPSAyZTMpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLnR5cGUgPSAiT3J0aG9ncmFwaGljQ2FtZXJhIjsKICAgIHRoaXMuem9vbSA9IDE7CiAgICB0aGlzLnZpZXcgPSBudWxsOwogICAgdGhpcy5sZWZ0ID0gbGVmdDsKICAgIHRoaXMucmlnaHQgPSByaWdodDsKICAgIHRoaXMudG9wID0gdG9wOwogICAgdGhpcy5ib3R0b20gPSBib3R0b207CiAgICB0aGlzLm5lYXIgPSBuZWFyOwogICAgdGhpcy5mYXIgPSBmYXI7CiAgICB0aGlzLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICB9CiAgY29weShzb3VyY2UsIHJlY3Vyc2l2ZSkgewogICAgc3VwZXIuY29weShzb3VyY2UsIHJlY3Vyc2l2ZSk7CiAgICB0aGlzLmxlZnQgPSBzb3VyY2UubGVmdDsKICAgIHRoaXMucmlnaHQgPSBzb3VyY2UucmlnaHQ7CiAgICB0aGlzLnRvcCA9IHNvdXJjZS50b3A7CiAgICB0aGlzLmJvdHRvbSA9IHNvdXJjZS5ib3R0b207CiAgICB0aGlzLm5lYXIgPSBzb3VyY2UubmVhcjsKICAgIHRoaXMuZmFyID0gc291cmNlLmZhcjsKICAgIHRoaXMuem9vbSA9IHNvdXJjZS56b29tOwogICAgdGhpcy52aWV3ID0gc291cmNlLnZpZXcgPT09IG51bGwgPyBudWxsIDogT2JqZWN0LmFzc2lnbih7fSwgc291cmNlLnZpZXcpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldFZpZXdPZmZzZXQoZnVsbFdpZHRoLCBmdWxsSGVpZ2h0LCB4LCB5LCB3aWR0aCwgaGVpZ2h0KSB7CiAgICBpZiAodGhpcy52aWV3ID09PSBudWxsKSB7CiAgICAgIHRoaXMudmlldyA9IHsKICAgICAgICBlbmFibGVkOiB0cnVlLAogICAgICAgIGZ1bGxXaWR0aDogMSwKICAgICAgICBmdWxsSGVpZ2h0OiAxLAogICAgICAgIG9mZnNldFg6IDAsCiAgICAgICAgb2Zmc2V0WTogMCwKICAgICAgICB3aWR0aDogMSwKICAgICAgICBoZWlnaHQ6IDEKICAgICAgfTsKICAgIH0KICAgIHRoaXMudmlldy5lbmFibGVkID0gdHJ1ZTsKICAgIHRoaXMudmlldy5mdWxsV2lkdGggPSBmdWxsV2lkdGg7CiAgICB0aGlzLnZpZXcuZnVsbEhlaWdodCA9IGZ1bGxIZWlnaHQ7CiAgICB0aGlzLnZpZXcub2Zmc2V0WCA9IHg7CiAgICB0aGlzLnZpZXcub2Zmc2V0WSA9IHk7CiAgICB0aGlzLnZpZXcud2lkdGggPSB3aWR0aDsKICAgIHRoaXMudmlldy5oZWlnaHQgPSBoZWlnaHQ7CiAgICB0aGlzLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICB9CiAgY2xlYXJWaWV3T2Zmc2V0KCkgewogICAgaWYgKHRoaXMudmlldyAhPT0gbnVsbCkgewogICAgICB0aGlzLnZpZXcuZW5hYmxlZCA9IGZhbHNlOwogICAgfQogICAgdGhpcy51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7CiAgfQogIHVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKSB7CiAgICBjb25zdCBkeCA9ICh0aGlzLnJpZ2h0IC0gdGhpcy5sZWZ0KSAvICgyICogdGhpcy56b29tKTsKICAgIGNvbnN0IGR5ID0gKHRoaXMudG9wIC0gdGhpcy5ib3R0b20pIC8gKDIgKiB0aGlzLnpvb20pOwogICAgY29uc3QgY3ggPSAodGhpcy5yaWdodCArIHRoaXMubGVmdCkgLyAyOwogICAgY29uc3QgY3kgPSAodGhpcy50b3AgKyB0aGlzLmJvdHRvbSkgLyAyOwogICAgbGV0IGxlZnQgPSBjeCAtIGR4OwogICAgbGV0IHJpZ2h0ID0gY3ggKyBkeDsKICAgIGxldCB0b3AgPSBjeSArIGR5OwogICAgbGV0IGJvdHRvbSA9IGN5IC0gZHk7CiAgICBpZiAodGhpcy52aWV3ICE9PSBudWxsICYmIHRoaXMudmlldy5lbmFibGVkKSB7CiAgICAgIGNvbnN0IHNjYWxlVyA9ICh0aGlzLnJpZ2h0IC0gdGhpcy5sZWZ0KSAvIHRoaXMudmlldy5mdWxsV2lkdGggLyB0aGlzLnpvb207CiAgICAgIGNvbnN0IHNjYWxlSCA9ICh0aGlzLnRvcCAtIHRoaXMuYm90dG9tKSAvIHRoaXMudmlldy5mdWxsSGVpZ2h0IC8gdGhpcy56b29tOwogICAgICBsZWZ0ICs9IHNjYWxlVyAqIHRoaXMudmlldy5vZmZzZXRYOwogICAgICByaWdodCA9IGxlZnQgKyBzY2FsZVcgKiB0aGlzLnZpZXcud2lkdGg7CiAgICAgIHRvcCAtPSBzY2FsZUggKiB0aGlzLnZpZXcub2Zmc2V0WTsKICAgICAgYm90dG9tID0gdG9wIC0gc2NhbGVIICogdGhpcy52aWV3LmhlaWdodDsKICAgIH0KICAgIHRoaXMucHJvamVjdGlvbk1hdHJpeC5tYWtlT3J0aG9ncmFwaGljKGxlZnQsIHJpZ2h0LCB0b3AsIGJvdHRvbSwgdGhpcy5uZWFyLCB0aGlzLmZhcik7CiAgICB0aGlzLnByb2plY3Rpb25NYXRyaXhJbnZlcnNlLmNvcHkodGhpcy5wcm9qZWN0aW9uTWF0cml4KS5pbnZlcnQoKTsKICB9CiAgdG9KU09OKG1ldGEpIHsKICAgIGNvbnN0IGRhdGEgPSBzdXBlci50b0pTT04obWV0YSk7CiAgICBkYXRhLm9iamVjdC56b29tID0gdGhpcy56b29tOwogICAgZGF0YS5vYmplY3QubGVmdCA9IHRoaXMubGVmdDsKICAgIGRhdGEub2JqZWN0LnJpZ2h0ID0gdGhpcy5yaWdodDsKICAgIGRhdGEub2JqZWN0LnRvcCA9IHRoaXMudG9wOwogICAgZGF0YS5vYmplY3QuYm90dG9tID0gdGhpcy5ib3R0b207CiAgICBkYXRhLm9iamVjdC5uZWFyID0gdGhpcy5uZWFyOwogICAgZGF0YS5vYmplY3QuZmFyID0gdGhpcy5mYXI7CiAgICBpZiAodGhpcy52aWV3ICE9PSBudWxsKQogICAgICBkYXRhLm9iamVjdC52aWV3ID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy52aWV3KTsKICAgIHJldHVybiBkYXRhOwogIH0KfQpPcnRob2dyYXBoaWNDYW1lcmEucHJvdG90eXBlLmlzT3J0aG9ncmFwaGljQ2FtZXJhID0gdHJ1ZTsKY2xhc3MgUmF3U2hhZGVyTWF0ZXJpYWwgZXh0ZW5kcyBTaGFkZXJNYXRlcmlhbCB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgc3VwZXIocGFyYW1ldGVycyk7CiAgICB0aGlzLnR5cGUgPSAiUmF3U2hhZGVyTWF0ZXJpYWwiOwogIH0KfQpSYXdTaGFkZXJNYXRlcmlhbC5wcm90b3R5cGUuaXNSYXdTaGFkZXJNYXRlcmlhbCA9IHRydWU7CmNvbnN0IExPRF9NSU4gPSA0Owpjb25zdCBMT0RfTUFYID0gODsKY29uc3QgU0laRV9NQVggPSBNYXRoLnBvdygyLCBMT0RfTUFYKTsKY29uc3QgRVhUUkFfTE9EX1NJR01BID0gWzAuMTI1LCAwLjIxNSwgMC4zNSwgMC40NDYsIDAuNTI2LCAwLjU4Ml07CmNvbnN0IFRPVEFMX0xPRFMgPSBMT0RfTUFYIC0gTE9EX01JTiArIDEgKyBFWFRSQV9MT0RfU0lHTUEubGVuZ3RoOwpjb25zdCBNQVhfU0FNUExFUyA9IDIwOwpjb25zdCBfZmxhdENhbWVyYSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgT3J0aG9ncmFwaGljQ2FtZXJhKCk7CmNvbnN0IHsgX2xvZFBsYW5lcywgX3NpemVMb2RzLCBfc2lnbWFzIH0gPSAvKiBAX19QVVJFX18gKi8gX2NyZWF0ZVBsYW5lcygpOwpjb25zdCBfY2xlYXJDb2xvciA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgQ29sb3IoKTsKbGV0IF9vbGRUYXJnZXQgPSBudWxsOwpjb25zdCBQSEkgPSAoMSArIE1hdGguc3FydCg1KSkgLyAyOwpjb25zdCBJTlZfUEhJID0gMSAvIFBISTsKY29uc3QgX2F4aXNEaXJlY3Rpb25zID0gWwogIC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygxLCAxLCAxKSwKICAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoLTEsIDEsIDEpLAogIC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygxLCAxLCAtMSksCiAgLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKC0xLCAxLCAtMSksCiAgLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKDAsIFBISSwgSU5WX1BISSksCiAgLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKDAsIFBISSwgLUlOVl9QSEkpLAogIC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMyhJTlZfUEhJLCAwLCBQSEkpLAogIC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygtSU5WX1BISSwgMCwgUEhJKSwKICAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoUEhJLCBJTlZfUEhJLCAwKSwKICAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoLVBISSwgSU5WX1BISSwgMCkKXTsKY2xhc3MgUE1SRU1HZW5lcmF0b3IgewogIGNvbnN0cnVjdG9yKHJlbmRlcmVyKSB7CiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyOwogICAgdGhpcy5fcGluZ1BvbmdSZW5kZXJUYXJnZXQgPSBudWxsOwogICAgdGhpcy5fYmx1ck1hdGVyaWFsID0gX2dldEJsdXJTaGFkZXIoTUFYX1NBTVBMRVMpOwogICAgdGhpcy5fZXF1aXJlY3RTaGFkZXIgPSBudWxsOwogICAgdGhpcy5fY3ViZW1hcFNoYWRlciA9IG51bGw7CiAgICB0aGlzLl9jb21waWxlTWF0ZXJpYWwodGhpcy5fYmx1ck1hdGVyaWFsKTsKICB9CiAgZnJvbVNjZW5lKHNjZW5lLCBzaWdtYSA9IDAsIG5lYXIgPSAwLjEsIGZhciA9IDEwMCkgewogICAgX29sZFRhcmdldCA9IHRoaXMuX3JlbmRlcmVyLmdldFJlbmRlclRhcmdldCgpOwogICAgY29uc3QgY3ViZVVWUmVuZGVyVGFyZ2V0ID0gdGhpcy5fYWxsb2NhdGVUYXJnZXRzKCk7CiAgICB0aGlzLl9zY2VuZVRvQ3ViZVVWKHNjZW5lLCBuZWFyLCBmYXIsIGN1YmVVVlJlbmRlclRhcmdldCk7CiAgICBpZiAoc2lnbWEgPiAwKSB7CiAgICAgIHRoaXMuX2JsdXIoY3ViZVVWUmVuZGVyVGFyZ2V0LCAwLCAwLCBzaWdtYSk7CiAgICB9CiAgICB0aGlzLl9hcHBseVBNUkVNKGN1YmVVVlJlbmRlclRhcmdldCk7CiAgICB0aGlzLl9jbGVhbnVwKGN1YmVVVlJlbmRlclRhcmdldCk7CiAgICByZXR1cm4gY3ViZVVWUmVuZGVyVGFyZ2V0OwogIH0KICBmcm9tRXF1aXJlY3Rhbmd1bGFyKGVxdWlyZWN0YW5ndWxhciwgcmVuZGVyVGFyZ2V0ID0gbnVsbCkgewogICAgcmV0dXJuIHRoaXMuX2Zyb21UZXh0dXJlKGVxdWlyZWN0YW5ndWxhciwgcmVuZGVyVGFyZ2V0KTsKICB9CiAgZnJvbUN1YmVtYXAoY3ViZW1hcCwgcmVuZGVyVGFyZ2V0ID0gbnVsbCkgewogICAgcmV0dXJuIHRoaXMuX2Zyb21UZXh0dXJlKGN1YmVtYXAsIHJlbmRlclRhcmdldCk7CiAgfQogIGNvbXBpbGVDdWJlbWFwU2hhZGVyKCkgewogICAgaWYgKHRoaXMuX2N1YmVtYXBTaGFkZXIgPT09IG51bGwpIHsKICAgICAgdGhpcy5fY3ViZW1hcFNoYWRlciA9IF9nZXRDdWJlbWFwU2hhZGVyKCk7CiAgICAgIHRoaXMuX2NvbXBpbGVNYXRlcmlhbCh0aGlzLl9jdWJlbWFwU2hhZGVyKTsKICAgIH0KICB9CiAgY29tcGlsZUVxdWlyZWN0YW5ndWxhclNoYWRlcigpIHsKICAgIGlmICh0aGlzLl9lcXVpcmVjdFNoYWRlciA9PT0gbnVsbCkgewogICAgICB0aGlzLl9lcXVpcmVjdFNoYWRlciA9IF9nZXRFcXVpcmVjdFNoYWRlcigpOwogICAgICB0aGlzLl9jb21waWxlTWF0ZXJpYWwodGhpcy5fZXF1aXJlY3RTaGFkZXIpOwogICAgfQogIH0KICBkaXNwb3NlKCkgewogICAgdGhpcy5fYmx1ck1hdGVyaWFsLmRpc3Bvc2UoKTsKICAgIGlmICh0aGlzLl9waW5nUG9uZ1JlbmRlclRhcmdldCAhPT0gbnVsbCkKICAgICAgdGhpcy5fcGluZ1BvbmdSZW5kZXJUYXJnZXQuZGlzcG9zZSgpOwogICAgaWYgKHRoaXMuX2N1YmVtYXBTaGFkZXIgIT09IG51bGwpCiAgICAgIHRoaXMuX2N1YmVtYXBTaGFkZXIuZGlzcG9zZSgpOwogICAgaWYgKHRoaXMuX2VxdWlyZWN0U2hhZGVyICE9PSBudWxsKQogICAgICB0aGlzLl9lcXVpcmVjdFNoYWRlci5kaXNwb3NlKCk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IF9sb2RQbGFuZXMubGVuZ3RoOyBpKyspIHsKICAgICAgX2xvZFBsYW5lc1tpXS5kaXNwb3NlKCk7CiAgICB9CiAgfQogIF9jbGVhbnVwKG91dHB1dFRhcmdldCkgewogICAgdGhpcy5fcmVuZGVyZXIuc2V0UmVuZGVyVGFyZ2V0KF9vbGRUYXJnZXQpOwogICAgb3V0cHV0VGFyZ2V0LnNjaXNzb3JUZXN0ID0gZmFsc2U7CiAgICBfc2V0Vmlld3BvcnQob3V0cHV0VGFyZ2V0LCAwLCAwLCBvdXRwdXRUYXJnZXQud2lkdGgsIG91dHB1dFRhcmdldC5oZWlnaHQpOwogIH0KICBfZnJvbVRleHR1cmUodGV4dHVyZSwgcmVuZGVyVGFyZ2V0KSB7CiAgICBfb2xkVGFyZ2V0ID0gdGhpcy5fcmVuZGVyZXIuZ2V0UmVuZGVyVGFyZ2V0KCk7CiAgICBjb25zdCBjdWJlVVZSZW5kZXJUYXJnZXQgPSByZW5kZXJUYXJnZXQgfHwgdGhpcy5fYWxsb2NhdGVUYXJnZXRzKHRleHR1cmUpOwogICAgdGhpcy5fdGV4dHVyZVRvQ3ViZVVWKHRleHR1cmUsIGN1YmVVVlJlbmRlclRhcmdldCk7CiAgICB0aGlzLl9hcHBseVBNUkVNKGN1YmVVVlJlbmRlclRhcmdldCk7CiAgICB0aGlzLl9jbGVhbnVwKGN1YmVVVlJlbmRlclRhcmdldCk7CiAgICByZXR1cm4gY3ViZVVWUmVuZGVyVGFyZ2V0OwogIH0KICBfYWxsb2NhdGVUYXJnZXRzKHRleHR1cmUpIHsKICAgIGNvbnN0IHBhcmFtcyA9IHsKICAgICAgbWFnRmlsdGVyOiBMaW5lYXJGaWx0ZXIsCiAgICAgIG1pbkZpbHRlcjogTGluZWFyRmlsdGVyLAogICAgICBnZW5lcmF0ZU1pcG1hcHM6IGZhbHNlLAogICAgICB0eXBlOiBIYWxmRmxvYXRUeXBlLAogICAgICBmb3JtYXQ6IFJHQkFGb3JtYXQsCiAgICAgIGVuY29kaW5nOiBMaW5lYXJFbmNvZGluZywKICAgICAgZGVwdGhCdWZmZXI6IGZhbHNlCiAgICB9OwogICAgY29uc3QgY3ViZVVWUmVuZGVyVGFyZ2V0ID0gX2NyZWF0ZVJlbmRlclRhcmdldChwYXJhbXMpOwogICAgY3ViZVVWUmVuZGVyVGFyZ2V0LmRlcHRoQnVmZmVyID0gdGV4dHVyZSA/IGZhbHNlIDogdHJ1ZTsKICAgIGlmICh0aGlzLl9waW5nUG9uZ1JlbmRlclRhcmdldCA9PT0gbnVsbCkgewogICAgICB0aGlzLl9waW5nUG9uZ1JlbmRlclRhcmdldCA9IF9jcmVhdGVSZW5kZXJUYXJnZXQocGFyYW1zKTsKICAgIH0KICAgIHJldHVybiBjdWJlVVZSZW5kZXJUYXJnZXQ7CiAgfQogIF9jb21waWxlTWF0ZXJpYWwobWF0ZXJpYWwpIHsKICAgIGNvbnN0IHRtcE1lc2ggPSBuZXcgTWVzaChfbG9kUGxhbmVzWzBdLCBtYXRlcmlhbCk7CiAgICB0aGlzLl9yZW5kZXJlci5jb21waWxlKHRtcE1lc2gsIF9mbGF0Q2FtZXJhKTsKICB9CiAgX3NjZW5lVG9DdWJlVVYoc2NlbmUsIG5lYXIsIGZhciwgY3ViZVVWUmVuZGVyVGFyZ2V0KSB7CiAgICBjb25zdCBmb3YyID0gOTA7CiAgICBjb25zdCBhc3BlY3QyID0gMTsKICAgIGNvbnN0IGN1YmVDYW1lcmEgPSBuZXcgUGVyc3BlY3RpdmVDYW1lcmEoZm92MiwgYXNwZWN0MiwgbmVhciwgZmFyKTsKICAgIGNvbnN0IHVwU2lnbiA9IFsxLCAtMSwgMSwgMSwgMSwgMV07CiAgICBjb25zdCBmb3J3YXJkU2lnbiA9IFsxLCAxLCAxLCAtMSwgLTEsIC0xXTsKICAgIGNvbnN0IHJlbmRlcmVyID0gdGhpcy5fcmVuZGVyZXI7CiAgICBjb25zdCBvcmlnaW5hbEF1dG9DbGVhciA9IHJlbmRlcmVyLmF1dG9DbGVhcjsKICAgIGNvbnN0IHRvbmVNYXBwaW5nID0gcmVuZGVyZXIudG9uZU1hcHBpbmc7CiAgICByZW5kZXJlci5nZXRDbGVhckNvbG9yKF9jbGVhckNvbG9yKTsKICAgIHJlbmRlcmVyLnRvbmVNYXBwaW5nID0gTm9Ub25lTWFwcGluZzsKICAgIHJlbmRlcmVyLmF1dG9DbGVhciA9IGZhbHNlOwogICAgY29uc3QgYmFja2dyb3VuZE1hdGVyaWFsID0gbmV3IE1lc2hCYXNpY01hdGVyaWFsKHsKICAgICAgbmFtZTogIlBNUkVNLkJhY2tncm91bmQiLAogICAgICBzaWRlOiBCYWNrU2lkZSwKICAgICAgZGVwdGhXcml0ZTogZmFsc2UsCiAgICAgIGRlcHRoVGVzdDogZmFsc2UKICAgIH0pOwogICAgY29uc3QgYmFja2dyb3VuZEJveCA9IG5ldyBNZXNoKG5ldyBCb3hHZW9tZXRyeSgpLCBiYWNrZ3JvdW5kTWF0ZXJpYWwpOwogICAgbGV0IHVzZVNvbGlkQ29sb3IgPSBmYWxzZTsKICAgIGNvbnN0IGJhY2tncm91bmQgPSBzY2VuZS5iYWNrZ3JvdW5kOwogICAgaWYgKGJhY2tncm91bmQpIHsKICAgICAgaWYgKGJhY2tncm91bmQuaXNDb2xvcikgewogICAgICAgIGJhY2tncm91bmRNYXRlcmlhbC5jb2xvci5jb3B5KGJhY2tncm91bmQpOwogICAgICAgIHNjZW5lLmJhY2tncm91bmQgPSBudWxsOwogICAgICAgIHVzZVNvbGlkQ29sb3IgPSB0cnVlOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBiYWNrZ3JvdW5kTWF0ZXJpYWwuY29sb3IuY29weShfY2xlYXJDb2xvcik7CiAgICAgIHVzZVNvbGlkQ29sb3IgPSB0cnVlOwogICAgfQogICAgZm9yIChsZXQgaSA9IDA7IGkgPCA2OyBpKyspIHsKICAgICAgY29uc3QgY29sID0gaSAlIDM7CiAgICAgIGlmIChjb2wgPT09IDApIHsKICAgICAgICBjdWJlQ2FtZXJhLnVwLnNldCgwLCB1cFNpZ25baV0sIDApOwogICAgICAgIGN1YmVDYW1lcmEubG9va0F0KGZvcndhcmRTaWduW2ldLCAwLCAwKTsKICAgICAgfSBlbHNlIGlmIChjb2wgPT09IDEpIHsKICAgICAgICBjdWJlQ2FtZXJhLnVwLnNldCgwLCAwLCB1cFNpZ25baV0pOwogICAgICAgIGN1YmVDYW1lcmEubG9va0F0KDAsIGZvcndhcmRTaWduW2ldLCAwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjdWJlQ2FtZXJhLnVwLnNldCgwLCB1cFNpZ25baV0sIDApOwogICAgICAgIGN1YmVDYW1lcmEubG9va0F0KDAsIDAsIGZvcndhcmRTaWduW2ldKTsKICAgICAgfQogICAgICBfc2V0Vmlld3BvcnQoY3ViZVVWUmVuZGVyVGFyZ2V0LCBjb2wgKiBTSVpFX01BWCwgaSA+IDIgPyBTSVpFX01BWCA6IDAsIFNJWkVfTUFYLCBTSVpFX01BWCk7CiAgICAgIHJlbmRlcmVyLnNldFJlbmRlclRhcmdldChjdWJlVVZSZW5kZXJUYXJnZXQpOwogICAgICBpZiAodXNlU29saWRDb2xvcikgewogICAgICAgIHJlbmRlcmVyLnJlbmRlcihiYWNrZ3JvdW5kQm94LCBjdWJlQ2FtZXJhKTsKICAgICAgfQogICAgICByZW5kZXJlci5yZW5kZXIoc2NlbmUsIGN1YmVDYW1lcmEpOwogICAgfQogICAgYmFja2dyb3VuZEJveC5nZW9tZXRyeS5kaXNwb3NlKCk7CiAgICBiYWNrZ3JvdW5kQm94Lm1hdGVyaWFsLmRpc3Bvc2UoKTsKICAgIHJlbmRlcmVyLnRvbmVNYXBwaW5nID0gdG9uZU1hcHBpbmc7CiAgICByZW5kZXJlci5hdXRvQ2xlYXIgPSBvcmlnaW5hbEF1dG9DbGVhcjsKICAgIHNjZW5lLmJhY2tncm91bmQgPSBiYWNrZ3JvdW5kOwogIH0KICBfdGV4dHVyZVRvQ3ViZVVWKHRleHR1cmUsIGN1YmVVVlJlbmRlclRhcmdldCkgewogICAgY29uc3QgcmVuZGVyZXIgPSB0aGlzLl9yZW5kZXJlcjsKICAgIGNvbnN0IGlzQ3ViZVRleHR1cmUgPSB0ZXh0dXJlLm1hcHBpbmcgPT09IEN1YmVSZWZsZWN0aW9uTWFwcGluZyB8fCB0ZXh0dXJlLm1hcHBpbmcgPT09IEN1YmVSZWZyYWN0aW9uTWFwcGluZzsKICAgIGlmIChpc0N1YmVUZXh0dXJlKSB7CiAgICAgIGlmICh0aGlzLl9jdWJlbWFwU2hhZGVyID09PSBudWxsKSB7CiAgICAgICAgdGhpcy5fY3ViZW1hcFNoYWRlciA9IF9nZXRDdWJlbWFwU2hhZGVyKCk7CiAgICAgIH0KICAgICAgdGhpcy5fY3ViZW1hcFNoYWRlci51bmlmb3Jtcy5mbGlwRW52TWFwLnZhbHVlID0gdGV4dHVyZS5pc1JlbmRlclRhcmdldFRleHR1cmUgPT09IGZhbHNlID8gLTEgOiAxOwogICAgfSBlbHNlIHsKICAgICAgaWYgKHRoaXMuX2VxdWlyZWN0U2hhZGVyID09PSBudWxsKSB7CiAgICAgICAgdGhpcy5fZXF1aXJlY3RTaGFkZXIgPSBfZ2V0RXF1aXJlY3RTaGFkZXIoKTsKICAgICAgfQogICAgfQogICAgY29uc3QgbWF0ZXJpYWwgPSBpc0N1YmVUZXh0dXJlID8gdGhpcy5fY3ViZW1hcFNoYWRlciA6IHRoaXMuX2VxdWlyZWN0U2hhZGVyOwogICAgY29uc3QgbWVzaCA9IG5ldyBNZXNoKF9sb2RQbGFuZXNbMF0sIG1hdGVyaWFsKTsKICAgIGNvbnN0IHVuaWZvcm1zID0gbWF0ZXJpYWwudW5pZm9ybXM7CiAgICB1bmlmb3Jtc1siZW52TWFwIl0udmFsdWUgPSB0ZXh0dXJlOwogICAgaWYgKCFpc0N1YmVUZXh0dXJlKSB7CiAgICAgIHVuaWZvcm1zWyJ0ZXhlbFNpemUiXS52YWx1ZS5zZXQoMSAvIHRleHR1cmUuaW1hZ2Uud2lkdGgsIDEgLyB0ZXh0dXJlLmltYWdlLmhlaWdodCk7CiAgICB9CiAgICBfc2V0Vmlld3BvcnQoY3ViZVVWUmVuZGVyVGFyZ2V0LCAwLCAwLCAzICogU0laRV9NQVgsIDIgKiBTSVpFX01BWCk7CiAgICByZW5kZXJlci5zZXRSZW5kZXJUYXJnZXQoY3ViZVVWUmVuZGVyVGFyZ2V0KTsKICAgIHJlbmRlcmVyLnJlbmRlcihtZXNoLCBfZmxhdENhbWVyYSk7CiAgfQogIF9hcHBseVBNUkVNKGN1YmVVVlJlbmRlclRhcmdldCkgewogICAgY29uc3QgcmVuZGVyZXIgPSB0aGlzLl9yZW5kZXJlcjsKICAgIGNvbnN0IGF1dG9DbGVhciA9IHJlbmRlcmVyLmF1dG9DbGVhcjsKICAgIHJlbmRlcmVyLmF1dG9DbGVhciA9IGZhbHNlOwogICAgZm9yIChsZXQgaSA9IDE7IGkgPCBUT1RBTF9MT0RTOyBpKyspIHsKICAgICAgY29uc3Qgc2lnbWEgPSBNYXRoLnNxcnQoX3NpZ21hc1tpXSAqIF9zaWdtYXNbaV0gLSBfc2lnbWFzW2kgLSAxXSAqIF9zaWdtYXNbaSAtIDFdKTsKICAgICAgY29uc3QgcG9sZUF4aXMgPSBfYXhpc0RpcmVjdGlvbnNbKGkgLSAxKSAlIF9heGlzRGlyZWN0aW9ucy5sZW5ndGhdOwogICAgICB0aGlzLl9ibHVyKGN1YmVVVlJlbmRlclRhcmdldCwgaSAtIDEsIGksIHNpZ21hLCBwb2xlQXhpcyk7CiAgICB9CiAgICByZW5kZXJlci5hdXRvQ2xlYXIgPSBhdXRvQ2xlYXI7CiAgfQogIF9ibHVyKGN1YmVVVlJlbmRlclRhcmdldCwgbG9kSW4sIGxvZE91dCwgc2lnbWEsIHBvbGVBeGlzKSB7CiAgICBjb25zdCBwaW5nUG9uZ1JlbmRlclRhcmdldCA9IHRoaXMuX3BpbmdQb25nUmVuZGVyVGFyZ2V0OwogICAgdGhpcy5faGFsZkJsdXIoY3ViZVVWUmVuZGVyVGFyZ2V0LCBwaW5nUG9uZ1JlbmRlclRhcmdldCwgbG9kSW4sIGxvZE91dCwgc2lnbWEsICJsYXRpdHVkaW5hbCIsIHBvbGVBeGlzKTsKICAgIHRoaXMuX2hhbGZCbHVyKHBpbmdQb25nUmVuZGVyVGFyZ2V0LCBjdWJlVVZSZW5kZXJUYXJnZXQsIGxvZE91dCwgbG9kT3V0LCBzaWdtYSwgImxvbmdpdHVkaW5hbCIsIHBvbGVBeGlzKTsKICB9CiAgX2hhbGZCbHVyKHRhcmdldEluLCB0YXJnZXRPdXQsIGxvZEluLCBsb2RPdXQsIHNpZ21hUmFkaWFucywgZGlyZWN0aW9uLCBwb2xlQXhpcykgewogICAgY29uc3QgcmVuZGVyZXIgPSB0aGlzLl9yZW5kZXJlcjsKICAgIGNvbnN0IGJsdXJNYXRlcmlhbCA9IHRoaXMuX2JsdXJNYXRlcmlhbDsKICAgIGlmIChkaXJlY3Rpb24gIT09ICJsYXRpdHVkaW5hbCIgJiYgZGlyZWN0aW9uICE9PSAibG9uZ2l0dWRpbmFsIikgewogICAgICBjb25zb2xlLmVycm9yKCJibHVyIGRpcmVjdGlvbiBtdXN0IGJlIGVpdGhlciBsYXRpdHVkaW5hbCBvciBsb25naXR1ZGluYWwhIik7CiAgICB9CiAgICBjb25zdCBTVEFOREFSRF9ERVZJQVRJT05TID0gMzsKICAgIGNvbnN0IGJsdXJNZXNoID0gbmV3IE1lc2goX2xvZFBsYW5lc1tsb2RPdXRdLCBibHVyTWF0ZXJpYWwpOwogICAgY29uc3QgYmx1clVuaWZvcm1zID0gYmx1ck1hdGVyaWFsLnVuaWZvcm1zOwogICAgY29uc3QgcGl4ZWxzID0gX3NpemVMb2RzW2xvZEluXSAtIDE7CiAgICBjb25zdCByYWRpYW5zUGVyUGl4ZWwgPSBpc0Zpbml0ZShzaWdtYVJhZGlhbnMpID8gTWF0aC5QSSAvICgyICogcGl4ZWxzKSA6IDIgKiBNYXRoLlBJIC8gKDIgKiBNQVhfU0FNUExFUyAtIDEpOwogICAgY29uc3Qgc2lnbWFQaXhlbHMgPSBzaWdtYVJhZGlhbnMgLyByYWRpYW5zUGVyUGl4ZWw7CiAgICBjb25zdCBzYW1wbGVzID0gaXNGaW5pdGUoc2lnbWFSYWRpYW5zKSA/IDEgKyBNYXRoLmZsb29yKFNUQU5EQVJEX0RFVklBVElPTlMgKiBzaWdtYVBpeGVscykgOiBNQVhfU0FNUExFUzsKICAgIGlmIChzYW1wbGVzID4gTUFYX1NBTVBMRVMpIHsKICAgICAgY29uc29sZS53YXJuKGBzaWdtYVJhZGlhbnMsICR7c2lnbWFSYWRpYW5zfSwgaXMgdG9vIGxhcmdlIGFuZCB3aWxsIGNsaXAsIGFzIGl0IHJlcXVlc3RlZCAke3NhbXBsZXN9IHNhbXBsZXMgd2hlbiB0aGUgbWF4aW11bSBpcyBzZXQgdG8gJHtNQVhfU0FNUExFU31gKTsKICAgIH0KICAgIGNvbnN0IHdlaWdodHMgPSBbXTsKICAgIGxldCBzdW0gPSAwOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNQVhfU0FNUExFUzsgKytpKSB7CiAgICAgIGNvbnN0IHgyID0gaSAvIHNpZ21hUGl4ZWxzOwogICAgICBjb25zdCB3ZWlnaHQgPSBNYXRoLmV4cCgteDIgKiB4MiAvIDIpOwogICAgICB3ZWlnaHRzLnB1c2god2VpZ2h0KTsKICAgICAgaWYgKGkgPT09IDApIHsKICAgICAgICBzdW0gKz0gd2VpZ2h0OwogICAgICB9IGVsc2UgaWYgKGkgPCBzYW1wbGVzKSB7CiAgICAgICAgc3VtICs9IDIgKiB3ZWlnaHQ7CiAgICAgIH0KICAgIH0KICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd2VpZ2h0cy5sZW5ndGg7IGkrKykgewogICAgICB3ZWlnaHRzW2ldID0gd2VpZ2h0c1tpXSAvIHN1bTsKICAgIH0KICAgIGJsdXJVbmlmb3Jtc1siZW52TWFwIl0udmFsdWUgPSB0YXJnZXRJbi50ZXh0dXJlOwogICAgYmx1clVuaWZvcm1zWyJzYW1wbGVzIl0udmFsdWUgPSBzYW1wbGVzOwogICAgYmx1clVuaWZvcm1zWyJ3ZWlnaHRzIl0udmFsdWUgPSB3ZWlnaHRzOwogICAgYmx1clVuaWZvcm1zWyJsYXRpdHVkaW5hbCJdLnZhbHVlID0gZGlyZWN0aW9uID09PSAibGF0aXR1ZGluYWwiOwogICAgaWYgKHBvbGVBeGlzKSB7CiAgICAgIGJsdXJVbmlmb3Jtc1sicG9sZUF4aXMiXS52YWx1ZSA9IHBvbGVBeGlzOwogICAgfQogICAgYmx1clVuaWZvcm1zWyJkVGhldGEiXS52YWx1ZSA9IHJhZGlhbnNQZXJQaXhlbDsKICAgIGJsdXJVbmlmb3Jtc1sibWlwSW50Il0udmFsdWUgPSBMT0RfTUFYIC0gbG9kSW47CiAgICBjb25zdCBvdXRwdXRTaXplID0gX3NpemVMb2RzW2xvZE91dF07CiAgICBjb25zdCB4ID0gMyAqIE1hdGgubWF4KDAsIFNJWkVfTUFYIC0gMiAqIG91dHB1dFNpemUpOwogICAgY29uc3QgeSA9IChsb2RPdXQgPT09IDAgPyAwIDogMiAqIFNJWkVfTUFYKSArIDIgKiBvdXRwdXRTaXplICogKGxvZE91dCA+IExPRF9NQVggLSBMT0RfTUlOID8gbG9kT3V0IC0gTE9EX01BWCArIExPRF9NSU4gOiAwKTsKICAgIF9zZXRWaWV3cG9ydCh0YXJnZXRPdXQsIHgsIHksIDMgKiBvdXRwdXRTaXplLCAyICogb3V0cHV0U2l6ZSk7CiAgICByZW5kZXJlci5zZXRSZW5kZXJUYXJnZXQodGFyZ2V0T3V0KTsKICAgIHJlbmRlcmVyLnJlbmRlcihibHVyTWVzaCwgX2ZsYXRDYW1lcmEpOwogIH0KfQpmdW5jdGlvbiBfY3JlYXRlUGxhbmVzKCkgewogIGNvbnN0IF9sb2RQbGFuZXMyID0gW107CiAgY29uc3QgX3NpemVMb2RzMiA9IFtdOwogIGNvbnN0IF9zaWdtYXMyID0gW107CiAgbGV0IGxvZCA9IExPRF9NQVg7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBUT1RBTF9MT0RTOyBpKyspIHsKICAgIGNvbnN0IHNpemVMb2QgPSBNYXRoLnBvdygyLCBsb2QpOwogICAgX3NpemVMb2RzMi5wdXNoKHNpemVMb2QpOwogICAgbGV0IHNpZ21hID0gMSAvIHNpemVMb2Q7CiAgICBpZiAoaSA+IExPRF9NQVggLSBMT0RfTUlOKSB7CiAgICAgIHNpZ21hID0gRVhUUkFfTE9EX1NJR01BW2kgLSBMT0RfTUFYICsgTE9EX01JTiAtIDFdOwogICAgfSBlbHNlIGlmIChpID09PSAwKSB7CiAgICAgIHNpZ21hID0gMDsKICAgIH0KICAgIF9zaWdtYXMyLnB1c2goc2lnbWEpOwogICAgY29uc3QgdGV4ZWxTaXplID0gMSAvIChzaXplTG9kIC0gMSk7CiAgICBjb25zdCBtaW4gPSAtdGV4ZWxTaXplIC8gMjsKICAgIGNvbnN0IG1heCA9IDEgKyB0ZXhlbFNpemUgLyAyOwogICAgY29uc3QgdXYxID0gW21pbiwgbWluLCBtYXgsIG1pbiwgbWF4LCBtYXgsIG1pbiwgbWluLCBtYXgsIG1heCwgbWluLCBtYXhdOwogICAgY29uc3QgY3ViZUZhY2VzID0gNjsKICAgIGNvbnN0IHZlcnRpY2VzID0gNjsKICAgIGNvbnN0IHBvc2l0aW9uU2l6ZSA9IDM7CiAgICBjb25zdCB1dlNpemUgPSAyOwogICAgY29uc3QgZmFjZUluZGV4U2l6ZSA9IDE7CiAgICBjb25zdCBwb3NpdGlvbiA9IG5ldyBGbG9hdDMyQXJyYXkocG9zaXRpb25TaXplICogdmVydGljZXMgKiBjdWJlRmFjZXMpOwogICAgY29uc3QgdXYgPSBuZXcgRmxvYXQzMkFycmF5KHV2U2l6ZSAqIHZlcnRpY2VzICogY3ViZUZhY2VzKTsKICAgIGNvbnN0IGZhY2VJbmRleCA9IG5ldyBGbG9hdDMyQXJyYXkoZmFjZUluZGV4U2l6ZSAqIHZlcnRpY2VzICogY3ViZUZhY2VzKTsKICAgIGZvciAobGV0IGZhY2UgPSAwOyBmYWNlIDwgY3ViZUZhY2VzOyBmYWNlKyspIHsKICAgICAgY29uc3QgeCA9IGZhY2UgJSAzICogMiAvIDMgLSAxOwogICAgICBjb25zdCB5ID0gZmFjZSA+IDIgPyAwIDogLTE7CiAgICAgIGNvbnN0IGNvb3JkaW5hdGVzID0gWwogICAgICAgIHgsCiAgICAgICAgeSwKICAgICAgICAwLAogICAgICAgIHggKyAyIC8gMywKICAgICAgICB5LAogICAgICAgIDAsCiAgICAgICAgeCArIDIgLyAzLAogICAgICAgIHkgKyAxLAogICAgICAgIDAsCiAgICAgICAgeCwKICAgICAgICB5LAogICAgICAgIDAsCiAgICAgICAgeCArIDIgLyAzLAogICAgICAgIHkgKyAxLAogICAgICAgIDAsCiAgICAgICAgeCwKICAgICAgICB5ICsgMSwKICAgICAgICAwCiAgICAgIF07CiAgICAgIHBvc2l0aW9uLnNldChjb29yZGluYXRlcywgcG9zaXRpb25TaXplICogdmVydGljZXMgKiBmYWNlKTsKICAgICAgdXYuc2V0KHV2MSwgdXZTaXplICogdmVydGljZXMgKiBmYWNlKTsKICAgICAgY29uc3QgZmlsbCA9IFtmYWNlLCBmYWNlLCBmYWNlLCBmYWNlLCBmYWNlLCBmYWNlXTsKICAgICAgZmFjZUluZGV4LnNldChmaWxsLCBmYWNlSW5kZXhTaXplICogdmVydGljZXMgKiBmYWNlKTsKICAgIH0KICAgIGNvbnN0IHBsYW5lcyA9IG5ldyBCdWZmZXJHZW9tZXRyeSgpOwogICAgcGxhbmVzLnNldEF0dHJpYnV0ZSgicG9zaXRpb24iLCBuZXcgQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9uLCBwb3NpdGlvblNpemUpKTsKICAgIHBsYW5lcy5zZXRBdHRyaWJ1dGUoInV2IiwgbmV3IEJ1ZmZlckF0dHJpYnV0ZSh1diwgdXZTaXplKSk7CiAgICBwbGFuZXMuc2V0QXR0cmlidXRlKCJmYWNlSW5kZXgiLCBuZXcgQnVmZmVyQXR0cmlidXRlKGZhY2VJbmRleCwgZmFjZUluZGV4U2l6ZSkpOwogICAgX2xvZFBsYW5lczIucHVzaChwbGFuZXMpOwogICAgaWYgKGxvZCA+IExPRF9NSU4pIHsKICAgICAgbG9kLS07CiAgICB9CiAgfQogIHJldHVybiB7IF9sb2RQbGFuZXM6IF9sb2RQbGFuZXMyLCBfc2l6ZUxvZHM6IF9zaXplTG9kczIsIF9zaWdtYXM6IF9zaWdtYXMyIH07Cn0KZnVuY3Rpb24gX2NyZWF0ZVJlbmRlclRhcmdldChwYXJhbXMpIHsKICBjb25zdCBjdWJlVVZSZW5kZXJUYXJnZXQgPSBuZXcgV2ViR0xSZW5kZXJUYXJnZXQoMyAqIFNJWkVfTUFYLCAzICogU0laRV9NQVgsIHBhcmFtcyk7CiAgY3ViZVVWUmVuZGVyVGFyZ2V0LnRleHR1cmUubWFwcGluZyA9IEN1YmVVVlJlZmxlY3Rpb25NYXBwaW5nOwogIGN1YmVVVlJlbmRlclRhcmdldC50ZXh0dXJlLm5hbWUgPSAiUE1SRU0uY3ViZVV2IjsKICBjdWJlVVZSZW5kZXJUYXJnZXQuc2Npc3NvclRlc3QgPSB0cnVlOwogIHJldHVybiBjdWJlVVZSZW5kZXJUYXJnZXQ7Cn0KZnVuY3Rpb24gX3NldFZpZXdwb3J0KHRhcmdldCwgeCwgeSwgd2lkdGgsIGhlaWdodCkgewogIHRhcmdldC52aWV3cG9ydC5zZXQoeCwgeSwgd2lkdGgsIGhlaWdodCk7CiAgdGFyZ2V0LnNjaXNzb3Iuc2V0KHgsIHksIHdpZHRoLCBoZWlnaHQpOwp9CmZ1bmN0aW9uIF9nZXRCbHVyU2hhZGVyKG1heFNhbXBsZXMpIHsKICBjb25zdCB3ZWlnaHRzID0gbmV3IEZsb2F0MzJBcnJheShtYXhTYW1wbGVzKTsKICBjb25zdCBwb2xlQXhpcyA9IG5ldyBWZWN0b3IzKDAsIDEsIDApOwogIGNvbnN0IHNoYWRlck1hdGVyaWFsID0gbmV3IFJhd1NoYWRlck1hdGVyaWFsKHsKICAgIG5hbWU6ICJTcGhlcmljYWxHYXVzc2lhbkJsdXIiLAogICAgZGVmaW5lczogeyAibiI6IG1heFNhbXBsZXMgfSwKICAgIHVuaWZvcm1zOiB7CiAgICAgICJlbnZNYXAiOiB7IHZhbHVlOiBudWxsIH0sCiAgICAgICJzYW1wbGVzIjogeyB2YWx1ZTogMSB9LAogICAgICAid2VpZ2h0cyI6IHsgdmFsdWU6IHdlaWdodHMgfSwKICAgICAgImxhdGl0dWRpbmFsIjogeyB2YWx1ZTogZmFsc2UgfSwKICAgICAgImRUaGV0YSI6IHsgdmFsdWU6IDAgfSwKICAgICAgIm1pcEludCI6IHsgdmFsdWU6IDAgfSwKICAgICAgInBvbGVBeGlzIjogeyB2YWx1ZTogcG9sZUF4aXMgfQogICAgfSwKICAgIHZlcnRleFNoYWRlcjogX2dldENvbW1vblZlcnRleFNoYWRlcigpLAogICAgZnJhZ21lbnRTaGFkZXI6IGAKCgkJCXByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwoJCQlwcmVjaXNpb24gbWVkaXVtcCBpbnQ7CgoJCQl2YXJ5aW5nIHZlYzMgdk91dHB1dERpcmVjdGlvbjsKCgkJCXVuaWZvcm0gc2FtcGxlcjJEIGVudk1hcDsKCQkJdW5pZm9ybSBpbnQgc2FtcGxlczsKCQkJdW5pZm9ybSBmbG9hdCB3ZWlnaHRzWyBuIF07CgkJCXVuaWZvcm0gYm9vbCBsYXRpdHVkaW5hbDsKCQkJdW5pZm9ybSBmbG9hdCBkVGhldGE7CgkJCXVuaWZvcm0gZmxvYXQgbWlwSW50OwoJCQl1bmlmb3JtIHZlYzMgcG9sZUF4aXM7CgoJCQkjZGVmaW5lIEVOVk1BUF9UWVBFX0NVQkVfVVYKCQkJI2luY2x1ZGUgPGN1YmVfdXZfcmVmbGVjdGlvbl9mcmFnbWVudD4KCgkJCXZlYzMgZ2V0U2FtcGxlKCBmbG9hdCB0aGV0YSwgdmVjMyBheGlzICkgewoKCQkJCWZsb2F0IGNvc1RoZXRhID0gY29zKCB0aGV0YSApOwoJCQkJLy8gUm9kcmlndWVzJyBheGlzLWFuZ2xlIHJvdGF0aW9uCgkJCQl2ZWMzIHNhbXBsZURpcmVjdGlvbiA9IHZPdXRwdXREaXJlY3Rpb24gKiBjb3NUaGV0YQoJCQkJCSsgY3Jvc3MoIGF4aXMsIHZPdXRwdXREaXJlY3Rpb24gKSAqIHNpbiggdGhldGEgKQoJCQkJCSsgYXhpcyAqIGRvdCggYXhpcywgdk91dHB1dERpcmVjdGlvbiApICogKCAxLjAgLSBjb3NUaGV0YSApOwoKCQkJCXJldHVybiBiaWxpbmVhckN1YmVVViggZW52TWFwLCBzYW1wbGVEaXJlY3Rpb24sIG1pcEludCApOwoKCQkJfQoKCQkJdm9pZCBtYWluKCkgewoKCQkJCXZlYzMgYXhpcyA9IGxhdGl0dWRpbmFsID8gcG9sZUF4aXMgOiBjcm9zcyggcG9sZUF4aXMsIHZPdXRwdXREaXJlY3Rpb24gKTsKCgkJCQlpZiAoIGFsbCggZXF1YWwoIGF4aXMsIHZlYzMoIDAuMCApICkgKSApIHsKCgkJCQkJYXhpcyA9IHZlYzMoIHZPdXRwdXREaXJlY3Rpb24ueiwgMC4wLCAtIHZPdXRwdXREaXJlY3Rpb24ueCApOwoKCQkJCX0KCgkJCQlheGlzID0gbm9ybWFsaXplKCBheGlzICk7CgoJCQkJZ2xfRnJhZ0NvbG9yID0gdmVjNCggMC4wLCAwLjAsIDAuMCwgMS4wICk7CgkJCQlnbF9GcmFnQ29sb3IucmdiICs9IHdlaWdodHNbIDAgXSAqIGdldFNhbXBsZSggMC4wLCBheGlzICk7CgoJCQkJZm9yICggaW50IGkgPSAxOyBpIDwgbjsgaSsrICkgewoKCQkJCQlpZiAoIGkgPj0gc2FtcGxlcyApIHsKCgkJCQkJCWJyZWFrOwoKCQkJCQl9CgoJCQkJCWZsb2F0IHRoZXRhID0gZFRoZXRhICogZmxvYXQoIGkgKTsKCQkJCQlnbF9GcmFnQ29sb3IucmdiICs9IHdlaWdodHNbIGkgXSAqIGdldFNhbXBsZSggLTEuMCAqIHRoZXRhLCBheGlzICk7CgkJCQkJZ2xfRnJhZ0NvbG9yLnJnYiArPSB3ZWlnaHRzWyBpIF0gKiBnZXRTYW1wbGUoIHRoZXRhLCBheGlzICk7CgoJCQkJfQoKCQkJfQoJCWAsCiAgICBibGVuZGluZzogTm9CbGVuZGluZywKICAgIGRlcHRoVGVzdDogZmFsc2UsCiAgICBkZXB0aFdyaXRlOiBmYWxzZQogIH0pOwogIHJldHVybiBzaGFkZXJNYXRlcmlhbDsKfQpmdW5jdGlvbiBfZ2V0RXF1aXJlY3RTaGFkZXIoKSB7CiAgY29uc3QgdGV4ZWxTaXplID0gbmV3IFZlY3RvcjIoMSwgMSk7CiAgY29uc3Qgc2hhZGVyTWF0ZXJpYWwgPSBuZXcgUmF3U2hhZGVyTWF0ZXJpYWwoewogICAgbmFtZTogIkVxdWlyZWN0YW5ndWxhclRvQ3ViZVVWIiwKICAgIHVuaWZvcm1zOiB7CiAgICAgICJlbnZNYXAiOiB7IHZhbHVlOiBudWxsIH0sCiAgICAgICJ0ZXhlbFNpemUiOiB7IHZhbHVlOiB0ZXhlbFNpemUgfQogICAgfSwKICAgIHZlcnRleFNoYWRlcjogX2dldENvbW1vblZlcnRleFNoYWRlcigpLAogICAgZnJhZ21lbnRTaGFkZXI6IGAKCgkJCXByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwoJCQlwcmVjaXNpb24gbWVkaXVtcCBpbnQ7CgoJCQl2YXJ5aW5nIHZlYzMgdk91dHB1dERpcmVjdGlvbjsKCgkJCXVuaWZvcm0gc2FtcGxlcjJEIGVudk1hcDsKCQkJdW5pZm9ybSB2ZWMyIHRleGVsU2l6ZTsKCgkJCSNpbmNsdWRlIDxjb21tb24+CgoJCQl2b2lkIG1haW4oKSB7CgoJCQkJZ2xfRnJhZ0NvbG9yID0gdmVjNCggMC4wLCAwLjAsIDAuMCwgMS4wICk7CgoJCQkJdmVjMyBvdXRwdXREaXJlY3Rpb24gPSBub3JtYWxpemUoIHZPdXRwdXREaXJlY3Rpb24gKTsKCQkJCXZlYzIgdXYgPSBlcXVpcmVjdFV2KCBvdXRwdXREaXJlY3Rpb24gKTsKCgkJCQl2ZWMyIGYgPSBmcmFjdCggdXYgLyB0ZXhlbFNpemUgLSAwLjUgKTsKCQkJCXV2IC09IGYgKiB0ZXhlbFNpemU7CgkJCQl2ZWMzIHRsID0gdGV4dHVyZTJEICggZW52TWFwLCB1diApLnJnYjsKCQkJCXV2LnggKz0gdGV4ZWxTaXplLng7CgkJCQl2ZWMzIHRyID0gdGV4dHVyZTJEICggZW52TWFwLCB1diApLnJnYjsKCQkJCXV2LnkgKz0gdGV4ZWxTaXplLnk7CgkJCQl2ZWMzIGJyID0gdGV4dHVyZTJEICggZW52TWFwLCB1diApLnJnYjsKCQkJCXV2LnggLT0gdGV4ZWxTaXplLng7CgkJCQl2ZWMzIGJsID0gdGV4dHVyZTJEICggZW52TWFwLCB1diApLnJnYjsKCgkJCQl2ZWMzIHRtID0gbWl4KCB0bCwgdHIsIGYueCApOwoJCQkJdmVjMyBibSA9IG1peCggYmwsIGJyLCBmLnggKTsKCQkJCWdsX0ZyYWdDb2xvci5yZ2IgPSBtaXgoIHRtLCBibSwgZi55ICk7CgoJCQl9CgkJYCwKICAgIGJsZW5kaW5nOiBOb0JsZW5kaW5nLAogICAgZGVwdGhUZXN0OiBmYWxzZSwKICAgIGRlcHRoV3JpdGU6IGZhbHNlCiAgfSk7CiAgcmV0dXJuIHNoYWRlck1hdGVyaWFsOwp9CmZ1bmN0aW9uIF9nZXRDdWJlbWFwU2hhZGVyKCkgewogIGNvbnN0IHNoYWRlck1hdGVyaWFsID0gbmV3IFJhd1NoYWRlck1hdGVyaWFsKHsKICAgIG5hbWU6ICJDdWJlbWFwVG9DdWJlVVYiLAogICAgdW5pZm9ybXM6IHsKICAgICAgImVudk1hcCI6IHsgdmFsdWU6IG51bGwgfSwKICAgICAgImZsaXBFbnZNYXAiOiB7IHZhbHVlOiAtMSB9CiAgICB9LAogICAgdmVydGV4U2hhZGVyOiBfZ2V0Q29tbW9uVmVydGV4U2hhZGVyKCksCiAgICBmcmFnbWVudFNoYWRlcjogYAoKCQkJcHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CgkJCXByZWNpc2lvbiBtZWRpdW1wIGludDsKCgkJCXVuaWZvcm0gZmxvYXQgZmxpcEVudk1hcDsKCgkJCXZhcnlpbmcgdmVjMyB2T3V0cHV0RGlyZWN0aW9uOwoKCQkJdW5pZm9ybSBzYW1wbGVyQ3ViZSBlbnZNYXA7CgoJCQl2b2lkIG1haW4oKSB7CgoJCQkJZ2xfRnJhZ0NvbG9yID0gdGV4dHVyZUN1YmUoIGVudk1hcCwgdmVjMyggZmxpcEVudk1hcCAqIHZPdXRwdXREaXJlY3Rpb24ueCwgdk91dHB1dERpcmVjdGlvbi55eiApICk7CgoJCQl9CgkJYCwKICAgIGJsZW5kaW5nOiBOb0JsZW5kaW5nLAogICAgZGVwdGhUZXN0OiBmYWxzZSwKICAgIGRlcHRoV3JpdGU6IGZhbHNlCiAgfSk7CiAgcmV0dXJuIHNoYWRlck1hdGVyaWFsOwp9CmZ1bmN0aW9uIF9nZXRDb21tb25WZXJ0ZXhTaGFkZXIoKSB7CiAgcmV0dXJuIGAKCgkJcHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CgkJcHJlY2lzaW9uIG1lZGl1bXAgaW50OwoKCQlhdHRyaWJ1dGUgdmVjMyBwb3NpdGlvbjsKCQlhdHRyaWJ1dGUgdmVjMiB1djsKCQlhdHRyaWJ1dGUgZmxvYXQgZmFjZUluZGV4OwoKCQl2YXJ5aW5nIHZlYzMgdk91dHB1dERpcmVjdGlvbjsKCgkJLy8gUkggY29vcmRpbmF0ZSBzeXN0ZW07IFBNUkVNIGZhY2UtaW5kZXhpbmcgY29udmVudGlvbgoJCXZlYzMgZ2V0RGlyZWN0aW9uKCB2ZWMyIHV2LCBmbG9hdCBmYWNlICkgewoKCQkJdXYgPSAyLjAgKiB1diAtIDEuMDsKCgkJCXZlYzMgZGlyZWN0aW9uID0gdmVjMyggdXYsIDEuMCApOwoKCQkJaWYgKCBmYWNlID09IDAuMCApIHsKCgkJCQlkaXJlY3Rpb24gPSBkaXJlY3Rpb24uenl4OyAvLyAoIDEsIHYsIHUgKSBwb3MgeAoKCQkJfSBlbHNlIGlmICggZmFjZSA9PSAxLjAgKSB7CgoJCQkJZGlyZWN0aW9uID0gZGlyZWN0aW9uLnh6eTsKCQkJCWRpcmVjdGlvbi54eiAqPSAtMS4wOyAvLyAoIC11LCAxLCAtdiApIHBvcyB5CgoJCQl9IGVsc2UgaWYgKCBmYWNlID09IDIuMCApIHsKCgkJCQlkaXJlY3Rpb24ueCAqPSAtMS4wOyAvLyAoIC11LCB2LCAxICkgcG9zIHoKCgkJCX0gZWxzZSBpZiAoIGZhY2UgPT0gMy4wICkgewoKCQkJCWRpcmVjdGlvbiA9IGRpcmVjdGlvbi56eXg7CgkJCQlkaXJlY3Rpb24ueHogKj0gLTEuMDsgLy8gKCAtMSwgdiwgLXUgKSBuZWcgeAoKCQkJfSBlbHNlIGlmICggZmFjZSA9PSA0LjAgKSB7CgoJCQkJZGlyZWN0aW9uID0gZGlyZWN0aW9uLnh6eTsKCQkJCWRpcmVjdGlvbi54eSAqPSAtMS4wOyAvLyAoIC11LCAtMSwgdiApIG5lZyB5CgoJCQl9IGVsc2UgaWYgKCBmYWNlID09IDUuMCApIHsKCgkJCQlkaXJlY3Rpb24ueiAqPSAtMS4wOyAvLyAoIHUsIHYsIC0xICkgbmVnIHoKCgkJCX0KCgkJCXJldHVybiBkaXJlY3Rpb247CgoJCX0KCgkJdm9pZCBtYWluKCkgewoKCQkJdk91dHB1dERpcmVjdGlvbiA9IGdldERpcmVjdGlvbiggdXYsIGZhY2VJbmRleCApOwoJCQlnbF9Qb3NpdGlvbiA9IHZlYzQoIHBvc2l0aW9uLCAxLjAgKTsKCgkJfQoJYDsKfQpmdW5jdGlvbiBXZWJHTEN1YmVVVk1hcHMocmVuZGVyZXIpIHsKICBsZXQgY3ViZVVWbWFwcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwogIGxldCBwbXJlbUdlbmVyYXRvciA9IG51bGw7CiAgZnVuY3Rpb24gZ2V0KHRleHR1cmUpIHsKICAgIGlmICh0ZXh0dXJlICYmIHRleHR1cmUuaXNUZXh0dXJlKSB7CiAgICAgIGNvbnN0IG1hcHBpbmcgPSB0ZXh0dXJlLm1hcHBpbmc7CiAgICAgIGNvbnN0IGlzRXF1aXJlY3RNYXAgPSBtYXBwaW5nID09PSBFcXVpcmVjdGFuZ3VsYXJSZWZsZWN0aW9uTWFwcGluZyB8fCBtYXBwaW5nID09PSBFcXVpcmVjdGFuZ3VsYXJSZWZyYWN0aW9uTWFwcGluZzsKICAgICAgY29uc3QgaXNDdWJlTWFwID0gbWFwcGluZyA9PT0gQ3ViZVJlZmxlY3Rpb25NYXBwaW5nIHx8IG1hcHBpbmcgPT09IEN1YmVSZWZyYWN0aW9uTWFwcGluZzsKICAgICAgaWYgKGlzRXF1aXJlY3RNYXAgfHwgaXNDdWJlTWFwKSB7CiAgICAgICAgaWYgKHRleHR1cmUuaXNSZW5kZXJUYXJnZXRUZXh0dXJlICYmIHRleHR1cmUubmVlZHNQTVJFTVVwZGF0ZSA9PT0gdHJ1ZSkgewogICAgICAgICAgdGV4dHVyZS5uZWVkc1BNUkVNVXBkYXRlID0gZmFsc2U7CiAgICAgICAgICBsZXQgcmVuZGVyVGFyZ2V0ID0gY3ViZVVWbWFwcy5nZXQodGV4dHVyZSk7CiAgICAgICAgICBpZiAocG1yZW1HZW5lcmF0b3IgPT09IG51bGwpCiAgICAgICAgICAgIHBtcmVtR2VuZXJhdG9yID0gbmV3IFBNUkVNR2VuZXJhdG9yKHJlbmRlcmVyKTsKICAgICAgICAgIHJlbmRlclRhcmdldCA9IGlzRXF1aXJlY3RNYXAgPyBwbXJlbUdlbmVyYXRvci5mcm9tRXF1aXJlY3Rhbmd1bGFyKHRleHR1cmUsIHJlbmRlclRhcmdldCkgOiBwbXJlbUdlbmVyYXRvci5mcm9tQ3ViZW1hcCh0ZXh0dXJlLCByZW5kZXJUYXJnZXQpOwogICAgICAgICAgY3ViZVVWbWFwcy5zZXQodGV4dHVyZSwgcmVuZGVyVGFyZ2V0KTsKICAgICAgICAgIHJldHVybiByZW5kZXJUYXJnZXQudGV4dHVyZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKGN1YmVVVm1hcHMuaGFzKHRleHR1cmUpKSB7CiAgICAgICAgICAgIHJldHVybiBjdWJlVVZtYXBzLmdldCh0ZXh0dXJlKS50ZXh0dXJlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3QgaW1hZ2UgPSB0ZXh0dXJlLmltYWdlOwogICAgICAgICAgICBpZiAoaXNFcXVpcmVjdE1hcCAmJiBpbWFnZSAmJiBpbWFnZS5oZWlnaHQgPiAwIHx8IGlzQ3ViZU1hcCAmJiBpbWFnZSAmJiBpc0N1YmVUZXh0dXJlQ29tcGxldGUoaW1hZ2UpKSB7CiAgICAgICAgICAgICAgaWYgKHBtcmVtR2VuZXJhdG9yID09PSBudWxsKQogICAgICAgICAgICAgICAgcG1yZW1HZW5lcmF0b3IgPSBuZXcgUE1SRU1HZW5lcmF0b3IocmVuZGVyZXIpOwogICAgICAgICAgICAgIGNvbnN0IHJlbmRlclRhcmdldCA9IGlzRXF1aXJlY3RNYXAgPyBwbXJlbUdlbmVyYXRvci5mcm9tRXF1aXJlY3Rhbmd1bGFyKHRleHR1cmUpIDogcG1yZW1HZW5lcmF0b3IuZnJvbUN1YmVtYXAodGV4dHVyZSk7CiAgICAgICAgICAgICAgY3ViZVVWbWFwcy5zZXQodGV4dHVyZSwgcmVuZGVyVGFyZ2V0KTsKICAgICAgICAgICAgICB0ZXh0dXJlLmFkZEV2ZW50TGlzdGVuZXIoImRpc3Bvc2UiLCBvblRleHR1cmVEaXNwb3NlKTsKICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyVGFyZ2V0LnRleHR1cmU7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0ZXh0dXJlOwogIH0KICBmdW5jdGlvbiBpc0N1YmVUZXh0dXJlQ29tcGxldGUoaW1hZ2UpIHsKICAgIGxldCBjb3VudCA9IDA7CiAgICBjb25zdCBsZW5ndGggPSA2OwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICBpZiAoaW1hZ2VbaV0gIT09IHZvaWQgMCkKICAgICAgICBjb3VudCsrOwogICAgfQogICAgcmV0dXJuIGNvdW50ID09PSBsZW5ndGg7CiAgfQogIGZ1bmN0aW9uIG9uVGV4dHVyZURpc3Bvc2UoZXZlbnQpIHsKICAgIGNvbnN0IHRleHR1cmUgPSBldmVudC50YXJnZXQ7CiAgICB0ZXh0dXJlLnJlbW92ZUV2ZW50TGlzdGVuZXIoImRpc3Bvc2UiLCBvblRleHR1cmVEaXNwb3NlKTsKICAgIGNvbnN0IGN1YmVtYXBVViA9IGN1YmVVVm1hcHMuZ2V0KHRleHR1cmUpOwogICAgaWYgKGN1YmVtYXBVViAhPT0gdm9pZCAwKSB7CiAgICAgIGN1YmVVVm1hcHMuZGVsZXRlKHRleHR1cmUpOwogICAgICBjdWJlbWFwVVYuZGlzcG9zZSgpOwogICAgfQogIH0KICBmdW5jdGlvbiBkaXNwb3NlKCkgewogICAgY3ViZVVWbWFwcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwogICAgaWYgKHBtcmVtR2VuZXJhdG9yICE9PSBudWxsKSB7CiAgICAgIHBtcmVtR2VuZXJhdG9yLmRpc3Bvc2UoKTsKICAgICAgcG1yZW1HZW5lcmF0b3IgPSBudWxsOwogICAgfQogIH0KICByZXR1cm4gewogICAgZ2V0LAogICAgZGlzcG9zZQogIH07Cn0KZnVuY3Rpb24gV2ViR0xFeHRlbnNpb25zKGdsKSB7CiAgY29uc3QgZXh0ZW5zaW9ucyA9IHt9OwogIGZ1bmN0aW9uIGdldEV4dGVuc2lvbihuYW1lKSB7CiAgICBpZiAoZXh0ZW5zaW9uc1tuYW1lXSAhPT0gdm9pZCAwKSB7CiAgICAgIHJldHVybiBleHRlbnNpb25zW25hbWVdOwogICAgfQogICAgbGV0IGV4dGVuc2lvbjsKICAgIHN3aXRjaCAobmFtZSkgewogICAgICBjYXNlICJXRUJHTF9kZXB0aF90ZXh0dXJlIjoKICAgICAgICBleHRlbnNpb24gPSBnbC5nZXRFeHRlbnNpb24oIldFQkdMX2RlcHRoX3RleHR1cmUiKSB8fCBnbC5nZXRFeHRlbnNpb24oIk1PWl9XRUJHTF9kZXB0aF90ZXh0dXJlIikgfHwgZ2wuZ2V0RXh0ZW5zaW9uKCJXRUJLSVRfV0VCR0xfZGVwdGhfdGV4dHVyZSIpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJFWFRfdGV4dHVyZV9maWx0ZXJfYW5pc290cm9waWMiOgogICAgICAgIGV4dGVuc2lvbiA9IGdsLmdldEV4dGVuc2lvbigiRVhUX3RleHR1cmVfZmlsdGVyX2FuaXNvdHJvcGljIikgfHwgZ2wuZ2V0RXh0ZW5zaW9uKCJNT1pfRVhUX3RleHR1cmVfZmlsdGVyX2FuaXNvdHJvcGljIikgfHwgZ2wuZ2V0RXh0ZW5zaW9uKCJXRUJLSVRfRVhUX3RleHR1cmVfZmlsdGVyX2FuaXNvdHJvcGljIik7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9zM3RjIjoKICAgICAgICBleHRlbnNpb24gPSBnbC5nZXRFeHRlbnNpb24oIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9zM3RjIikgfHwgZ2wuZ2V0RXh0ZW5zaW9uKCJNT1pfV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX3MzdGMiKSB8fCBnbC5nZXRFeHRlbnNpb24oIldFQktJVF9XRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfczN0YyIpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJXRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfcHZydGMiOgogICAgICAgIGV4dGVuc2lvbiA9IGdsLmdldEV4dGVuc2lvbigiV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX3B2cnRjIikgfHwgZ2wuZ2V0RXh0ZW5zaW9uKCJXRUJLSVRfV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX3B2cnRjIik7CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgZXh0ZW5zaW9uID0gZ2wuZ2V0RXh0ZW5zaW9uKG5hbWUpOwogICAgfQogICAgZXh0ZW5zaW9uc1tuYW1lXSA9IGV4dGVuc2lvbjsKICAgIHJldHVybiBleHRlbnNpb247CiAgfQogIHJldHVybiB7CiAgICBoYXM6IGZ1bmN0aW9uKG5hbWUpIHsKICAgICAgcmV0dXJuIGdldEV4dGVuc2lvbihuYW1lKSAhPT0gbnVsbDsKICAgIH0sCiAgICBpbml0OiBmdW5jdGlvbihjYXBhYmlsaXRpZXMpIHsKICAgICAgaWYgKGNhcGFiaWxpdGllcy5pc1dlYkdMMikgewogICAgICAgIGdldEV4dGVuc2lvbigiRVhUX2NvbG9yX2J1ZmZlcl9mbG9hdCIpOwogICAgICB9IGVsc2UgewogICAgICAgIGdldEV4dGVuc2lvbigiV0VCR0xfZGVwdGhfdGV4dHVyZSIpOwogICAgICAgIGdldEV4dGVuc2lvbigiT0VTX3RleHR1cmVfZmxvYXQiKTsKICAgICAgICBnZXRFeHRlbnNpb24oIk9FU190ZXh0dXJlX2hhbGZfZmxvYXQiKTsKICAgICAgICBnZXRFeHRlbnNpb24oIk9FU190ZXh0dXJlX2hhbGZfZmxvYXRfbGluZWFyIik7CiAgICAgICAgZ2V0RXh0ZW5zaW9uKCJPRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXMiKTsKICAgICAgICBnZXRFeHRlbnNpb24oIk9FU19lbGVtZW50X2luZGV4X3VpbnQiKTsKICAgICAgICBnZXRFeHRlbnNpb24oIk9FU192ZXJ0ZXhfYXJyYXlfb2JqZWN0Iik7CiAgICAgICAgZ2V0RXh0ZW5zaW9uKCJBTkdMRV9pbnN0YW5jZWRfYXJyYXlzIik7CiAgICAgIH0KICAgICAgZ2V0RXh0ZW5zaW9uKCJPRVNfdGV4dHVyZV9mbG9hdF9saW5lYXIiKTsKICAgICAgZ2V0RXh0ZW5zaW9uKCJFWFRfY29sb3JfYnVmZmVyX2hhbGZfZmxvYXQiKTsKICAgICAgZ2V0RXh0ZW5zaW9uKCJXRUJHTF9tdWx0aXNhbXBsZWRfcmVuZGVyX3RvX3RleHR1cmUiKTsKICAgIH0sCiAgICBnZXQ6IGZ1bmN0aW9uKG5hbWUpIHsKICAgICAgY29uc3QgZXh0ZW5zaW9uID0gZ2V0RXh0ZW5zaW9uKG5hbWUpOwogICAgICBpZiAoZXh0ZW5zaW9uID09PSBudWxsKSB7CiAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAiICsgbmFtZSArICIgZXh0ZW5zaW9uIG5vdCBzdXBwb3J0ZWQuIik7CiAgICAgIH0KICAgICAgcmV0dXJuIGV4dGVuc2lvbjsKICAgIH0KICB9Owp9CmZ1bmN0aW9uIFdlYkdMR2VvbWV0cmllcyhnbCwgYXR0cmlidXRlcywgaW5mbywgYmluZGluZ1N0YXRlcykgewogIGNvbnN0IGdlb21ldHJpZXMgPSB7fTsKICBjb25zdCB3aXJlZnJhbWVBdHRyaWJ1dGVzID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CiAgZnVuY3Rpb24gb25HZW9tZXRyeURpc3Bvc2UoZXZlbnQpIHsKICAgIGNvbnN0IGdlb21ldHJ5ID0gZXZlbnQudGFyZ2V0OwogICAgaWYgKGdlb21ldHJ5LmluZGV4ICE9PSBudWxsKSB7CiAgICAgIGF0dHJpYnV0ZXMucmVtb3ZlKGdlb21ldHJ5LmluZGV4KTsKICAgIH0KICAgIGZvciAoY29uc3QgbmFtZSBpbiBnZW9tZXRyeS5hdHRyaWJ1dGVzKSB7CiAgICAgIGF0dHJpYnV0ZXMucmVtb3ZlKGdlb21ldHJ5LmF0dHJpYnV0ZXNbbmFtZV0pOwogICAgfQogICAgZ2VvbWV0cnkucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZGlzcG9zZSIsIG9uR2VvbWV0cnlEaXNwb3NlKTsKICAgIGRlbGV0ZSBnZW9tZXRyaWVzW2dlb21ldHJ5LmlkXTsKICAgIGNvbnN0IGF0dHJpYnV0ZSA9IHdpcmVmcmFtZUF0dHJpYnV0ZXMuZ2V0KGdlb21ldHJ5KTsKICAgIGlmIChhdHRyaWJ1dGUpIHsKICAgICAgYXR0cmlidXRlcy5yZW1vdmUoYXR0cmlidXRlKTsKICAgICAgd2lyZWZyYW1lQXR0cmlidXRlcy5kZWxldGUoZ2VvbWV0cnkpOwogICAgfQogICAgYmluZGluZ1N0YXRlcy5yZWxlYXNlU3RhdGVzT2ZHZW9tZXRyeShnZW9tZXRyeSk7CiAgICBpZiAoZ2VvbWV0cnkuaXNJbnN0YW5jZWRCdWZmZXJHZW9tZXRyeSA9PT0gdHJ1ZSkgewogICAgICBkZWxldGUgZ2VvbWV0cnkuX21heEluc3RhbmNlQ291bnQ7CiAgICB9CiAgICBpbmZvLm1lbW9yeS5nZW9tZXRyaWVzLS07CiAgfQogIGZ1bmN0aW9uIGdldChvYmplY3QsIGdlb21ldHJ5KSB7CiAgICBpZiAoZ2VvbWV0cmllc1tnZW9tZXRyeS5pZF0gPT09IHRydWUpCiAgICAgIHJldHVybiBnZW9tZXRyeTsKICAgIGdlb21ldHJ5LmFkZEV2ZW50TGlzdGVuZXIoImRpc3Bvc2UiLCBvbkdlb21ldHJ5RGlzcG9zZSk7CiAgICBnZW9tZXRyaWVzW2dlb21ldHJ5LmlkXSA9IHRydWU7CiAgICBpbmZvLm1lbW9yeS5nZW9tZXRyaWVzKys7CiAgICByZXR1cm4gZ2VvbWV0cnk7CiAgfQogIGZ1bmN0aW9uIHVwZGF0ZShnZW9tZXRyeSkgewogICAgY29uc3QgZ2VvbWV0cnlBdHRyaWJ1dGVzID0gZ2VvbWV0cnkuYXR0cmlidXRlczsKICAgIGZvciAoY29uc3QgbmFtZSBpbiBnZW9tZXRyeUF0dHJpYnV0ZXMpIHsKICAgICAgYXR0cmlidXRlcy51cGRhdGUoZ2VvbWV0cnlBdHRyaWJ1dGVzW25hbWVdLCAzNDk2Mik7CiAgICB9CiAgICBjb25zdCBtb3JwaEF0dHJpYnV0ZXMgPSBnZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXM7CiAgICBmb3IgKGNvbnN0IG5hbWUgaW4gbW9ycGhBdHRyaWJ1dGVzKSB7CiAgICAgIGNvbnN0IGFycmF5ID0gbW9ycGhBdHRyaWJ1dGVzW25hbWVdOwogICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGFycmF5Lmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGF0dHJpYnV0ZXMudXBkYXRlKGFycmF5W2ldLCAzNDk2Mik7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gdXBkYXRlV2lyZWZyYW1lQXR0cmlidXRlKGdlb21ldHJ5KSB7CiAgICBjb25zdCBpbmRpY2VzID0gW107CiAgICBjb25zdCBnZW9tZXRyeUluZGV4ID0gZ2VvbWV0cnkuaW5kZXg7CiAgICBjb25zdCBnZW9tZXRyeVBvc2l0aW9uID0gZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbjsKICAgIGxldCB2ZXJzaW9uID0gMDsKICAgIGlmIChnZW9tZXRyeUluZGV4ICE9PSBudWxsKSB7CiAgICAgIGNvbnN0IGFycmF5ID0gZ2VvbWV0cnlJbmRleC5hcnJheTsKICAgICAgdmVyc2lvbiA9IGdlb21ldHJ5SW5kZXgudmVyc2lvbjsKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBhcnJheS5sZW5ndGg7IGkgPCBsOyBpICs9IDMpIHsKICAgICAgICBjb25zdCBhID0gYXJyYXlbaSArIDBdOwogICAgICAgIGNvbnN0IGIgPSBhcnJheVtpICsgMV07CiAgICAgICAgY29uc3QgYyA9IGFycmF5W2kgKyAyXTsKICAgICAgICBpbmRpY2VzLnB1c2goYSwgYiwgYiwgYywgYywgYSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGFycmF5ID0gZ2VvbWV0cnlQb3NpdGlvbi5hcnJheTsKICAgICAgdmVyc2lvbiA9IGdlb21ldHJ5UG9zaXRpb24udmVyc2lvbjsKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBhcnJheS5sZW5ndGggLyAzIC0gMTsgaSA8IGw7IGkgKz0gMykgewogICAgICAgIGNvbnN0IGEgPSBpICsgMDsKICAgICAgICBjb25zdCBiID0gaSArIDE7CiAgICAgICAgY29uc3QgYyA9IGkgKyAyOwogICAgICAgIGluZGljZXMucHVzaChhLCBiLCBiLCBjLCBjLCBhKTsKICAgICAgfQogICAgfQogICAgY29uc3QgYXR0cmlidXRlID0gbmV3IChhcnJheU5lZWRzVWludDMyKGluZGljZXMpID8gVWludDMyQnVmZmVyQXR0cmlidXRlIDogVWludDE2QnVmZmVyQXR0cmlidXRlKShpbmRpY2VzLCAxKTsKICAgIGF0dHJpYnV0ZS52ZXJzaW9uID0gdmVyc2lvbjsKICAgIGNvbnN0IHByZXZpb3VzQXR0cmlidXRlID0gd2lyZWZyYW1lQXR0cmlidXRlcy5nZXQoZ2VvbWV0cnkpOwogICAgaWYgKHByZXZpb3VzQXR0cmlidXRlKQogICAgICBhdHRyaWJ1dGVzLnJlbW92ZShwcmV2aW91c0F0dHJpYnV0ZSk7CiAgICB3aXJlZnJhbWVBdHRyaWJ1dGVzLnNldChnZW9tZXRyeSwgYXR0cmlidXRlKTsKICB9CiAgZnVuY3Rpb24gZ2V0V2lyZWZyYW1lQXR0cmlidXRlKGdlb21ldHJ5KSB7CiAgICBjb25zdCBjdXJyZW50QXR0cmlidXRlID0gd2lyZWZyYW1lQXR0cmlidXRlcy5nZXQoZ2VvbWV0cnkpOwogICAgaWYgKGN1cnJlbnRBdHRyaWJ1dGUpIHsKICAgICAgY29uc3QgZ2VvbWV0cnlJbmRleCA9IGdlb21ldHJ5LmluZGV4OwogICAgICBpZiAoZ2VvbWV0cnlJbmRleCAhPT0gbnVsbCkgewogICAgICAgIGlmIChjdXJyZW50QXR0cmlidXRlLnZlcnNpb24gPCBnZW9tZXRyeUluZGV4LnZlcnNpb24pIHsKICAgICAgICAgIHVwZGF0ZVdpcmVmcmFtZUF0dHJpYnV0ZShnZW9tZXRyeSk7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICB1cGRhdGVXaXJlZnJhbWVBdHRyaWJ1dGUoZ2VvbWV0cnkpOwogICAgfQogICAgcmV0dXJuIHdpcmVmcmFtZUF0dHJpYnV0ZXMuZ2V0KGdlb21ldHJ5KTsKICB9CiAgcmV0dXJuIHsKICAgIGdldCwKICAgIHVwZGF0ZSwKICAgIGdldFdpcmVmcmFtZUF0dHJpYnV0ZQogIH07Cn0KZnVuY3Rpb24gV2ViR0xJbmRleGVkQnVmZmVyUmVuZGVyZXIoZ2wsIGV4dGVuc2lvbnMsIGluZm8sIGNhcGFiaWxpdGllcykgewogIGNvbnN0IGlzV2ViR0wyID0gY2FwYWJpbGl0aWVzLmlzV2ViR0wyOwogIGxldCBtb2RlOwogIGZ1bmN0aW9uIHNldE1vZGUodmFsdWUpIHsKICAgIG1vZGUgPSB2YWx1ZTsKICB9CiAgbGV0IHR5cGUsIGJ5dGVzUGVyRWxlbWVudDsKICBmdW5jdGlvbiBzZXRJbmRleCh2YWx1ZSkgewogICAgdHlwZSA9IHZhbHVlLnR5cGU7CiAgICBieXRlc1BlckVsZW1lbnQgPSB2YWx1ZS5ieXRlc1BlckVsZW1lbnQ7CiAgfQogIGZ1bmN0aW9uIHJlbmRlcihzdGFydCwgY291bnQpIHsKICAgIGdsLmRyYXdFbGVtZW50cyhtb2RlLCBjb3VudCwgdHlwZSwgc3RhcnQgKiBieXRlc1BlckVsZW1lbnQpOwogICAgaW5mby51cGRhdGUoY291bnQsIG1vZGUsIDEpOwogIH0KICBmdW5jdGlvbiByZW5kZXJJbnN0YW5jZXMoc3RhcnQsIGNvdW50LCBwcmltY291bnQpIHsKICAgIGlmIChwcmltY291bnQgPT09IDApCiAgICAgIHJldHVybjsKICAgIGxldCBleHRlbnNpb24sIG1ldGhvZE5hbWU7CiAgICBpZiAoaXNXZWJHTDIpIHsKICAgICAgZXh0ZW5zaW9uID0gZ2w7CiAgICAgIG1ldGhvZE5hbWUgPSAiZHJhd0VsZW1lbnRzSW5zdGFuY2VkIjsKICAgIH0gZWxzZSB7CiAgICAgIGV4dGVuc2lvbiA9IGV4dGVuc2lvbnMuZ2V0KCJBTkdMRV9pbnN0YW5jZWRfYXJyYXlzIik7CiAgICAgIG1ldGhvZE5hbWUgPSAiZHJhd0VsZW1lbnRzSW5zdGFuY2VkQU5HTEUiOwogICAgICBpZiAoZXh0ZW5zaW9uID09PSBudWxsKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuV2ViR0xJbmRleGVkQnVmZmVyUmVuZGVyZXI6IHVzaW5nIFRIUkVFLkluc3RhbmNlZEJ1ZmZlckdlb21ldHJ5IGJ1dCBoYXJkd2FyZSBkb2VzIG5vdCBzdXBwb3J0IGV4dGVuc2lvbiBBTkdMRV9pbnN0YW5jZWRfYXJyYXlzLiIpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfQogICAgZXh0ZW5zaW9uW21ldGhvZE5hbWVdKG1vZGUsIGNvdW50LCB0eXBlLCBzdGFydCAqIGJ5dGVzUGVyRWxlbWVudCwgcHJpbWNvdW50KTsKICAgIGluZm8udXBkYXRlKGNvdW50LCBtb2RlLCBwcmltY291bnQpOwogIH0KICB0aGlzLnNldE1vZGUgPSBzZXRNb2RlOwogIHRoaXMuc2V0SW5kZXggPSBzZXRJbmRleDsKICB0aGlzLnJlbmRlciA9IHJlbmRlcjsKICB0aGlzLnJlbmRlckluc3RhbmNlcyA9IHJlbmRlckluc3RhbmNlczsKfQpmdW5jdGlvbiBXZWJHTEluZm8oZ2wpIHsKICBjb25zdCBtZW1vcnkgPSB7CiAgICBnZW9tZXRyaWVzOiAwLAogICAgdGV4dHVyZXM6IDAKICB9OwogIGNvbnN0IHJlbmRlciA9IHsKICAgIGZyYW1lOiAwLAogICAgY2FsbHM6IDAsCiAgICB0cmlhbmdsZXM6IDAsCiAgICBwb2ludHM6IDAsCiAgICBsaW5lczogMAogIH07CiAgZnVuY3Rpb24gdXBkYXRlKGNvdW50LCBtb2RlLCBpbnN0YW5jZUNvdW50KSB7CiAgICByZW5kZXIuY2FsbHMrKzsKICAgIHN3aXRjaCAobW9kZSkgewogICAgICBjYXNlIDQ6CiAgICAgICAgcmVuZGVyLnRyaWFuZ2xlcyArPSBpbnN0YW5jZUNvdW50ICogKGNvdW50IC8gMyk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgMToKICAgICAgICByZW5kZXIubGluZXMgKz0gaW5zdGFuY2VDb3VudCAqIChjb3VudCAvIDIpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIDM6CiAgICAgICAgcmVuZGVyLmxpbmVzICs9IGluc3RhbmNlQ291bnQgKiAoY291bnQgLSAxKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAyOgogICAgICAgIHJlbmRlci5saW5lcyArPSBpbnN0YW5jZUNvdW50ICogY291bnQ7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgMDoKICAgICAgICByZW5kZXIucG9pbnRzICs9IGluc3RhbmNlQ291bnQgKiBjb3VudDsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5XZWJHTEluZm86IFVua25vd24gZHJhdyBtb2RlOiIsIG1vZGUpOwogICAgICAgIGJyZWFrOwogICAgfQogIH0KICBmdW5jdGlvbiByZXNldCgpIHsKICAgIHJlbmRlci5mcmFtZSsrOwogICAgcmVuZGVyLmNhbGxzID0gMDsKICAgIHJlbmRlci50cmlhbmdsZXMgPSAwOwogICAgcmVuZGVyLnBvaW50cyA9IDA7CiAgICByZW5kZXIubGluZXMgPSAwOwogIH0KICByZXR1cm4gewogICAgbWVtb3J5LAogICAgcmVuZGVyLAogICAgcHJvZ3JhbXM6IG51bGwsCiAgICBhdXRvUmVzZXQ6IHRydWUsCiAgICByZXNldCwKICAgIHVwZGF0ZQogIH07Cn0KY2xhc3MgRGF0YVRleHR1cmUyREFycmF5IGV4dGVuZHMgVGV4dHVyZSB7CiAgY29uc3RydWN0b3IoZGF0YSA9IG51bGwsIHdpZHRoID0gMSwgaGVpZ2h0ID0gMSwgZGVwdGggPSAxKSB7CiAgICBzdXBlcihudWxsKTsKICAgIHRoaXMuaW1hZ2UgPSB7IGRhdGEsIHdpZHRoLCBoZWlnaHQsIGRlcHRoIH07CiAgICB0aGlzLm1hZ0ZpbHRlciA9IE5lYXJlc3RGaWx0ZXI7CiAgICB0aGlzLm1pbkZpbHRlciA9IE5lYXJlc3RGaWx0ZXI7CiAgICB0aGlzLndyYXBSID0gQ2xhbXBUb0VkZ2VXcmFwcGluZzsKICAgIHRoaXMuZ2VuZXJhdGVNaXBtYXBzID0gZmFsc2U7CiAgICB0aGlzLmZsaXBZID0gZmFsc2U7CiAgICB0aGlzLnVucGFja0FsaWdubWVudCA9IDE7CiAgfQp9CkRhdGFUZXh0dXJlMkRBcnJheS5wcm90b3R5cGUuaXNEYXRhVGV4dHVyZTJEQXJyYXkgPSB0cnVlOwpmdW5jdGlvbiBudW1lcmljYWxTb3J0KGEsIGIpIHsKICByZXR1cm4gYVswXSAtIGJbMF07Cn0KZnVuY3Rpb24gYWJzTnVtZXJpY2FsU29ydChhLCBiKSB7CiAgcmV0dXJuIE1hdGguYWJzKGJbMV0pIC0gTWF0aC5hYnMoYVsxXSk7Cn0KZnVuY3Rpb24gZGVub3JtYWxpemUobW9ycGgsIGF0dHJpYnV0ZSkgewogIGxldCBkZW5vbWluYXRvciA9IDE7CiAgY29uc3QgYXJyYXkgPSBhdHRyaWJ1dGUuaXNJbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZSA/IGF0dHJpYnV0ZS5kYXRhLmFycmF5IDogYXR0cmlidXRlLmFycmF5OwogIGlmIChhcnJheSBpbnN0YW5jZW9mIEludDhBcnJheSkKICAgIGRlbm9taW5hdG9yID0gMTI3OwogIGVsc2UgaWYgKGFycmF5IGluc3RhbmNlb2YgSW50MTZBcnJheSkKICAgIGRlbm9taW5hdG9yID0gMzI3Njc7CiAgZWxzZSBpZiAoYXJyYXkgaW5zdGFuY2VvZiBJbnQzMkFycmF5KQogICAgZGVub21pbmF0b3IgPSAyMTQ3NDgzNjQ3OwogIGVsc2UKICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLldlYkdMTW9ycGh0YXJnZXRzOiBVbnN1cHBvcnRlZCBtb3JwaCBhdHRyaWJ1dGUgZGF0YSB0eXBlOiAiLCBhcnJheSk7CiAgbW9ycGguZGl2aWRlU2NhbGFyKGRlbm9taW5hdG9yKTsKfQpmdW5jdGlvbiBXZWJHTE1vcnBodGFyZ2V0cyhnbCwgY2FwYWJpbGl0aWVzLCB0ZXh0dXJlcykgewogIGNvbnN0IGluZmx1ZW5jZXNMaXN0ID0ge307CiAgY29uc3QgbW9ycGhJbmZsdWVuY2VzID0gbmV3IEZsb2F0MzJBcnJheSg4KTsKICBjb25zdCBtb3JwaFRleHR1cmVzID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CiAgY29uc3QgbW9ycGggPSBuZXcgVmVjdG9yMygpOwogIGNvbnN0IHdvcmtJbmZsdWVuY2VzID0gW107CiAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpKyspIHsKICAgIHdvcmtJbmZsdWVuY2VzW2ldID0gW2ksIDBdOwogIH0KICBmdW5jdGlvbiB1cGRhdGUob2JqZWN0LCBnZW9tZXRyeSwgbWF0ZXJpYWwsIHByb2dyYW0pIHsKICAgIGNvbnN0IG9iamVjdEluZmx1ZW5jZXMgPSBvYmplY3QubW9ycGhUYXJnZXRJbmZsdWVuY2VzOwogICAgaWYgKGNhcGFiaWxpdGllcy5pc1dlYkdMMiA9PT0gdHJ1ZSkgewogICAgICBjb25zdCBudW1iZXJPZk1vcnBoVGFyZ2V0cyA9IGdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcy5wb3NpdGlvbi5sZW5ndGg7CiAgICAgIGxldCBlbnRyeSA9IG1vcnBoVGV4dHVyZXMuZ2V0KGdlb21ldHJ5KTsKICAgICAgaWYgKGVudHJ5ID09PSB2b2lkIDAgfHwgZW50cnkuY291bnQgIT09IG51bWJlck9mTW9ycGhUYXJnZXRzKSB7CiAgICAgICAgbGV0IGRpc3Bvc2VUZXh0dXJlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICB0ZXh0dXJlLmRpc3Bvc2UoKTsKICAgICAgICAgIG1vcnBoVGV4dHVyZXMuZGVsZXRlKGdlb21ldHJ5KTsKICAgICAgICAgIGdlb21ldHJ5LnJlbW92ZUV2ZW50TGlzdGVuZXIoImRpc3Bvc2UiLCBkaXNwb3NlVGV4dHVyZSk7CiAgICAgICAgfTsKICAgICAgICBpZiAoZW50cnkgIT09IHZvaWQgMCkKICAgICAgICAgIGVudHJ5LnRleHR1cmUuZGlzcG9zZSgpOwogICAgICAgIGNvbnN0IGhhc01vcnBoTm9ybWFscyA9IGdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcy5ub3JtYWwgIT09IHZvaWQgMDsKICAgICAgICBjb25zdCBtb3JwaFRhcmdldHMgPSBnZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXMucG9zaXRpb247CiAgICAgICAgY29uc3QgbW9ycGhOb3JtYWxzID0gZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzLm5vcm1hbCB8fCBbXTsKICAgICAgICBjb25zdCBudW1iZXJPZlZlcnRpY2VzID0gZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5jb3VudDsKICAgICAgICBjb25zdCBudW1iZXJPZlZlcnRleERhdGEgPSBoYXNNb3JwaE5vcm1hbHMgPT09IHRydWUgPyAyIDogMTsKICAgICAgICBsZXQgd2lkdGggPSBudW1iZXJPZlZlcnRpY2VzICogbnVtYmVyT2ZWZXJ0ZXhEYXRhOwogICAgICAgIGxldCBoZWlnaHQgPSAxOwogICAgICAgIGlmICh3aWR0aCA+IGNhcGFiaWxpdGllcy5tYXhUZXh0dXJlU2l6ZSkgewogICAgICAgICAgaGVpZ2h0ID0gTWF0aC5jZWlsKHdpZHRoIC8gY2FwYWJpbGl0aWVzLm1heFRleHR1cmVTaXplKTsKICAgICAgICAgIHdpZHRoID0gY2FwYWJpbGl0aWVzLm1heFRleHR1cmVTaXplOwogICAgICAgIH0KICAgICAgICBjb25zdCBidWZmZXIgPSBuZXcgRmxvYXQzMkFycmF5KHdpZHRoICogaGVpZ2h0ICogNCAqIG51bWJlck9mTW9ycGhUYXJnZXRzKTsKICAgICAgICBjb25zdCB0ZXh0dXJlID0gbmV3IERhdGFUZXh0dXJlMkRBcnJheShidWZmZXIsIHdpZHRoLCBoZWlnaHQsIG51bWJlck9mTW9ycGhUYXJnZXRzKTsKICAgICAgICB0ZXh0dXJlLmZvcm1hdCA9IFJHQkFGb3JtYXQ7CiAgICAgICAgdGV4dHVyZS50eXBlID0gRmxvYXRUeXBlOwogICAgICAgIHRleHR1cmUubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICAgIGNvbnN0IHZlcnRleERhdGFTdHJpZGUgPSBudW1iZXJPZlZlcnRleERhdGEgKiA0OwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtYmVyT2ZNb3JwaFRhcmdldHM7IGkrKykgewogICAgICAgICAgY29uc3QgbW9ycGhUYXJnZXQgPSBtb3JwaFRhcmdldHNbaV07CiAgICAgICAgICBjb25zdCBtb3JwaE5vcm1hbCA9IG1vcnBoTm9ybWFsc1tpXTsKICAgICAgICAgIGNvbnN0IG9mZnNldCA9IHdpZHRoICogaGVpZ2h0ICogNCAqIGk7CiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IG1vcnBoVGFyZ2V0LmNvdW50OyBqKyspIHsKICAgICAgICAgICAgbW9ycGguZnJvbUJ1ZmZlckF0dHJpYnV0ZShtb3JwaFRhcmdldCwgaik7CiAgICAgICAgICAgIGlmIChtb3JwaFRhcmdldC5ub3JtYWxpemVkID09PSB0cnVlKQogICAgICAgICAgICAgIGRlbm9ybWFsaXplKG1vcnBoLCBtb3JwaFRhcmdldCk7CiAgICAgICAgICAgIGNvbnN0IHN0cmlkZSA9IGogKiB2ZXJ0ZXhEYXRhU3RyaWRlOwogICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgc3RyaWRlICsgMF0gPSBtb3JwaC54OwogICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgc3RyaWRlICsgMV0gPSBtb3JwaC55OwogICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgc3RyaWRlICsgMl0gPSBtb3JwaC56OwogICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgc3RyaWRlICsgM10gPSAwOwogICAgICAgICAgICBpZiAoaGFzTW9ycGhOb3JtYWxzID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgbW9ycGguZnJvbUJ1ZmZlckF0dHJpYnV0ZShtb3JwaE5vcm1hbCwgaik7CiAgICAgICAgICAgICAgaWYgKG1vcnBoTm9ybWFsLm5vcm1hbGl6ZWQgPT09IHRydWUpCiAgICAgICAgICAgICAgICBkZW5vcm1hbGl6ZShtb3JwaCwgbW9ycGhOb3JtYWwpOwogICAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXQgKyBzdHJpZGUgKyA0XSA9IG1vcnBoLng7CiAgICAgICAgICAgICAgYnVmZmVyW29mZnNldCArIHN0cmlkZSArIDVdID0gbW9ycGgueTsKICAgICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgc3RyaWRlICsgNl0gPSBtb3JwaC56OwogICAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXQgKyBzdHJpZGUgKyA3XSA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZW50cnkgPSB7CiAgICAgICAgICBjb3VudDogbnVtYmVyT2ZNb3JwaFRhcmdldHMsCiAgICAgICAgICB0ZXh0dXJlLAogICAgICAgICAgc2l6ZTogbmV3IFZlY3RvcjIod2lkdGgsIGhlaWdodCkKICAgICAgICB9OwogICAgICAgIG1vcnBoVGV4dHVyZXMuc2V0KGdlb21ldHJ5LCBlbnRyeSk7CiAgICAgICAgZ2VvbWV0cnkuYWRkRXZlbnRMaXN0ZW5lcigiZGlzcG9zZSIsIGRpc3Bvc2VUZXh0dXJlKTsKICAgICAgfQogICAgICBsZXQgbW9ycGhJbmZsdWVuY2VzU3VtID0gMDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvYmplY3RJbmZsdWVuY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgbW9ycGhJbmZsdWVuY2VzU3VtICs9IG9iamVjdEluZmx1ZW5jZXNbaV07CiAgICAgIH0KICAgICAgY29uc3QgbW9ycGhCYXNlSW5mbHVlbmNlID0gZ2VvbWV0cnkubW9ycGhUYXJnZXRzUmVsYXRpdmUgPyAxIDogMSAtIG1vcnBoSW5mbHVlbmNlc1N1bTsKICAgICAgcHJvZ3JhbS5nZXRVbmlmb3JtcygpLnNldFZhbHVlKGdsLCAibW9ycGhUYXJnZXRCYXNlSW5mbHVlbmNlIiwgbW9ycGhCYXNlSW5mbHVlbmNlKTsKICAgICAgcHJvZ3JhbS5nZXRVbmlmb3JtcygpLnNldFZhbHVlKGdsLCAibW9ycGhUYXJnZXRJbmZsdWVuY2VzIiwgb2JqZWN0SW5mbHVlbmNlcyk7CiAgICAgIHByb2dyYW0uZ2V0VW5pZm9ybXMoKS5zZXRWYWx1ZShnbCwgIm1vcnBoVGFyZ2V0c1RleHR1cmUiLCBlbnRyeS50ZXh0dXJlLCB0ZXh0dXJlcyk7CiAgICAgIHByb2dyYW0uZ2V0VW5pZm9ybXMoKS5zZXRWYWx1ZShnbCwgIm1vcnBoVGFyZ2V0c1RleHR1cmVTaXplIiwgZW50cnkuc2l6ZSk7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBsZW5ndGggPSBvYmplY3RJbmZsdWVuY2VzID09PSB2b2lkIDAgPyAwIDogb2JqZWN0SW5mbHVlbmNlcy5sZW5ndGg7CiAgICAgIGxldCBpbmZsdWVuY2VzID0gaW5mbHVlbmNlc0xpc3RbZ2VvbWV0cnkuaWRdOwogICAgICBpZiAoaW5mbHVlbmNlcyA9PT0gdm9pZCAwIHx8IGluZmx1ZW5jZXMubGVuZ3RoICE9PSBsZW5ndGgpIHsKICAgICAgICBpbmZsdWVuY2VzID0gW107CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgICAgaW5mbHVlbmNlc1tpXSA9IFtpLCAwXTsKICAgICAgICB9CiAgICAgICAgaW5mbHVlbmNlc0xpc3RbZ2VvbWV0cnkuaWRdID0gaW5mbHVlbmNlczsKICAgICAgfQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgaW5mbHVlbmNlID0gaW5mbHVlbmNlc1tpXTsKICAgICAgICBpbmZsdWVuY2VbMF0gPSBpOwogICAgICAgIGluZmx1ZW5jZVsxXSA9IG9iamVjdEluZmx1ZW5jZXNbaV07CiAgICAgIH0KICAgICAgaW5mbHVlbmNlcy5zb3J0KGFic051bWVyaWNhbFNvcnQpOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDg7IGkrKykgewogICAgICAgIGlmIChpIDwgbGVuZ3RoICYmIGluZmx1ZW5jZXNbaV1bMV0pIHsKICAgICAgICAgIHdvcmtJbmZsdWVuY2VzW2ldWzBdID0gaW5mbHVlbmNlc1tpXVswXTsKICAgICAgICAgIHdvcmtJbmZsdWVuY2VzW2ldWzFdID0gaW5mbHVlbmNlc1tpXVsxXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgd29ya0luZmx1ZW5jZXNbaV1bMF0gPSBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUjsKICAgICAgICAgIHdvcmtJbmZsdWVuY2VzW2ldWzFdID0gMDsKICAgICAgICB9CiAgICAgIH0KICAgICAgd29ya0luZmx1ZW5jZXMuc29ydChudW1lcmljYWxTb3J0KTsKICAgICAgY29uc3QgbW9ycGhUYXJnZXRzID0gZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzLnBvc2l0aW9uOwogICAgICBjb25zdCBtb3JwaE5vcm1hbHMgPSBnZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXMubm9ybWFsOwogICAgICBsZXQgbW9ycGhJbmZsdWVuY2VzU3VtID0gMDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpKyspIHsKICAgICAgICBjb25zdCBpbmZsdWVuY2UgPSB3b3JrSW5mbHVlbmNlc1tpXTsKICAgICAgICBjb25zdCBpbmRleCA9IGluZmx1ZW5jZVswXTsKICAgICAgICBjb25zdCB2YWx1ZSA9IGluZmx1ZW5jZVsxXTsKICAgICAgICBpZiAoaW5kZXggIT09IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSICYmIHZhbHVlKSB7CiAgICAgICAgICBpZiAobW9ycGhUYXJnZXRzICYmIGdlb21ldHJ5LmdldEF0dHJpYnV0ZSgibW9ycGhUYXJnZXQiICsgaSkgIT09IG1vcnBoVGFyZ2V0c1tpbmRleF0pIHsKICAgICAgICAgICAgZ2VvbWV0cnkuc2V0QXR0cmlidXRlKCJtb3JwaFRhcmdldCIgKyBpLCBtb3JwaFRhcmdldHNbaW5kZXhdKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChtb3JwaE5vcm1hbHMgJiYgZ2VvbWV0cnkuZ2V0QXR0cmlidXRlKCJtb3JwaE5vcm1hbCIgKyBpKSAhPT0gbW9ycGhOb3JtYWxzW2luZGV4XSkgewogICAgICAgICAgICBnZW9tZXRyeS5zZXRBdHRyaWJ1dGUoIm1vcnBoTm9ybWFsIiArIGksIG1vcnBoTm9ybWFsc1tpbmRleF0pOwogICAgICAgICAgfQogICAgICAgICAgbW9ycGhJbmZsdWVuY2VzW2ldID0gdmFsdWU7CiAgICAgICAgICBtb3JwaEluZmx1ZW5jZXNTdW0gKz0gdmFsdWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChtb3JwaFRhcmdldHMgJiYgZ2VvbWV0cnkuaGFzQXR0cmlidXRlKCJtb3JwaFRhcmdldCIgKyBpKSA9PT0gdHJ1ZSkgewogICAgICAgICAgICBnZW9tZXRyeS5kZWxldGVBdHRyaWJ1dGUoIm1vcnBoVGFyZ2V0IiArIGkpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKG1vcnBoTm9ybWFscyAmJiBnZW9tZXRyeS5oYXNBdHRyaWJ1dGUoIm1vcnBoTm9ybWFsIiArIGkpID09PSB0cnVlKSB7CiAgICAgICAgICAgIGdlb21ldHJ5LmRlbGV0ZUF0dHJpYnV0ZSgibW9ycGhOb3JtYWwiICsgaSk7CiAgICAgICAgICB9CiAgICAgICAgICBtb3JwaEluZmx1ZW5jZXNbaV0gPSAwOwogICAgICAgIH0KICAgICAgfQogICAgICBjb25zdCBtb3JwaEJhc2VJbmZsdWVuY2UgPSBnZW9tZXRyeS5tb3JwaFRhcmdldHNSZWxhdGl2ZSA/IDEgOiAxIC0gbW9ycGhJbmZsdWVuY2VzU3VtOwogICAgICBwcm9ncmFtLmdldFVuaWZvcm1zKCkuc2V0VmFsdWUoZ2wsICJtb3JwaFRhcmdldEJhc2VJbmZsdWVuY2UiLCBtb3JwaEJhc2VJbmZsdWVuY2UpOwogICAgICBwcm9ncmFtLmdldFVuaWZvcm1zKCkuc2V0VmFsdWUoZ2wsICJtb3JwaFRhcmdldEluZmx1ZW5jZXMiLCBtb3JwaEluZmx1ZW5jZXMpOwogICAgfQogIH0KICByZXR1cm4gewogICAgdXBkYXRlCiAgfTsKfQpmdW5jdGlvbiBXZWJHTE9iamVjdHMoZ2wsIGdlb21ldHJpZXMsIGF0dHJpYnV0ZXMsIGluZm8pIHsKICBsZXQgdXBkYXRlTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CiAgZnVuY3Rpb24gdXBkYXRlKG9iamVjdCkgewogICAgY29uc3QgZnJhbWUgPSBpbmZvLnJlbmRlci5mcmFtZTsKICAgIGNvbnN0IGdlb21ldHJ5ID0gb2JqZWN0Lmdlb21ldHJ5OwogICAgY29uc3QgYnVmZmVyZ2VvbWV0cnkgPSBnZW9tZXRyaWVzLmdldChvYmplY3QsIGdlb21ldHJ5KTsKICAgIGlmICh1cGRhdGVNYXAuZ2V0KGJ1ZmZlcmdlb21ldHJ5KSAhPT0gZnJhbWUpIHsKICAgICAgZ2VvbWV0cmllcy51cGRhdGUoYnVmZmVyZ2VvbWV0cnkpOwogICAgICB1cGRhdGVNYXAuc2V0KGJ1ZmZlcmdlb21ldHJ5LCBmcmFtZSk7CiAgICB9CiAgICBpZiAob2JqZWN0LmlzSW5zdGFuY2VkTWVzaCkgewogICAgICBpZiAob2JqZWN0Lmhhc0V2ZW50TGlzdGVuZXIoImRpc3Bvc2UiLCBvbkluc3RhbmNlZE1lc2hEaXNwb3NlKSA9PT0gZmFsc2UpIHsKICAgICAgICBvYmplY3QuYWRkRXZlbnRMaXN0ZW5lcigiZGlzcG9zZSIsIG9uSW5zdGFuY2VkTWVzaERpc3Bvc2UpOwogICAgICB9CiAgICAgIGF0dHJpYnV0ZXMudXBkYXRlKG9iamVjdC5pbnN0YW5jZU1hdHJpeCwgMzQ5NjIpOwogICAgICBpZiAob2JqZWN0Lmluc3RhbmNlQ29sb3IgIT09IG51bGwpIHsKICAgICAgICBhdHRyaWJ1dGVzLnVwZGF0ZShvYmplY3QuaW5zdGFuY2VDb2xvciwgMzQ5NjIpOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gYnVmZmVyZ2VvbWV0cnk7CiAgfQogIGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICB1cGRhdGVNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKICB9CiAgZnVuY3Rpb24gb25JbnN0YW5jZWRNZXNoRGlzcG9zZShldmVudCkgewogICAgY29uc3QgaW5zdGFuY2VkTWVzaCA9IGV2ZW50LnRhcmdldDsKICAgIGluc3RhbmNlZE1lc2gucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZGlzcG9zZSIsIG9uSW5zdGFuY2VkTWVzaERpc3Bvc2UpOwogICAgYXR0cmlidXRlcy5yZW1vdmUoaW5zdGFuY2VkTWVzaC5pbnN0YW5jZU1hdHJpeCk7CiAgICBpZiAoaW5zdGFuY2VkTWVzaC5pbnN0YW5jZUNvbG9yICE9PSBudWxsKQogICAgICBhdHRyaWJ1dGVzLnJlbW92ZShpbnN0YW5jZWRNZXNoLmluc3RhbmNlQ29sb3IpOwogIH0KICByZXR1cm4gewogICAgdXBkYXRlLAogICAgZGlzcG9zZQogIH07Cn0KY2xhc3MgRGF0YVRleHR1cmUzRCBleHRlbmRzIFRleHR1cmUgewogIGNvbnN0cnVjdG9yKGRhdGEgPSBudWxsLCB3aWR0aCA9IDEsIGhlaWdodCA9IDEsIGRlcHRoID0gMSkgewogICAgc3VwZXIobnVsbCk7CiAgICB0aGlzLmltYWdlID0geyBkYXRhLCB3aWR0aCwgaGVpZ2h0LCBkZXB0aCB9OwogICAgdGhpcy5tYWdGaWx0ZXIgPSBOZWFyZXN0RmlsdGVyOwogICAgdGhpcy5taW5GaWx0ZXIgPSBOZWFyZXN0RmlsdGVyOwogICAgdGhpcy53cmFwUiA9IENsYW1wVG9FZGdlV3JhcHBpbmc7CiAgICB0aGlzLmdlbmVyYXRlTWlwbWFwcyA9IGZhbHNlOwogICAgdGhpcy5mbGlwWSA9IGZhbHNlOwogICAgdGhpcy51bnBhY2tBbGlnbm1lbnQgPSAxOwogIH0KfQpEYXRhVGV4dHVyZTNELnByb3RvdHlwZS5pc0RhdGFUZXh0dXJlM0QgPSB0cnVlOwpjb25zdCBlbXB0eVRleHR1cmUgPSBuZXcgVGV4dHVyZSgpOwpjb25zdCBlbXB0eVRleHR1cmUyZEFycmF5ID0gbmV3IERhdGFUZXh0dXJlMkRBcnJheSgpOwpjb25zdCBlbXB0eVRleHR1cmUzZCA9IG5ldyBEYXRhVGV4dHVyZTNEKCk7CmNvbnN0IGVtcHR5Q3ViZVRleHR1cmUgPSBuZXcgQ3ViZVRleHR1cmUoKTsKY29uc3QgYXJyYXlDYWNoZUYzMiA9IFtdOwpjb25zdCBhcnJheUNhY2hlSTMyID0gW107CmNvbnN0IG1hdDRhcnJheSA9IG5ldyBGbG9hdDMyQXJyYXkoMTYpOwpjb25zdCBtYXQzYXJyYXkgPSBuZXcgRmxvYXQzMkFycmF5KDkpOwpjb25zdCBtYXQyYXJyYXkgPSBuZXcgRmxvYXQzMkFycmF5KDQpOwpmdW5jdGlvbiBmbGF0dGVuKGFycmF5LCBuQmxvY2tzLCBibG9ja1NpemUpIHsKICBjb25zdCBmaXJzdEVsZW0gPSBhcnJheVswXTsKICBpZiAoZmlyc3RFbGVtIDw9IDAgfHwgZmlyc3RFbGVtID4gMCkKICAgIHJldHVybiBhcnJheTsKICBjb25zdCBuID0gbkJsb2NrcyAqIGJsb2NrU2l6ZTsKICBsZXQgciA9IGFycmF5Q2FjaGVGMzJbbl07CiAgaWYgKHIgPT09IHZvaWQgMCkgewogICAgciA9IG5ldyBGbG9hdDMyQXJyYXkobik7CiAgICBhcnJheUNhY2hlRjMyW25dID0gcjsKICB9CiAgaWYgKG5CbG9ja3MgIT09IDApIHsKICAgIGZpcnN0RWxlbS50b0FycmF5KHIsIDApOwogICAgZm9yIChsZXQgaSA9IDEsIG9mZnNldCA9IDA7IGkgIT09IG5CbG9ja3M7ICsraSkgewogICAgICBvZmZzZXQgKz0gYmxvY2tTaXplOwogICAgICBhcnJheVtpXS50b0FycmF5KHIsIG9mZnNldCk7CiAgICB9CiAgfQogIHJldHVybiByOwp9CmZ1bmN0aW9uIGFycmF5c0VxdWFsKGEsIGIpIHsKICBpZiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKQogICAgcmV0dXJuIGZhbHNlOwogIGZvciAobGV0IGkgPSAwLCBsID0gYS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgIGlmIChhW2ldICE9PSBiW2ldKQogICAgICByZXR1cm4gZmFsc2U7CiAgfQogIHJldHVybiB0cnVlOwp9CmZ1bmN0aW9uIGNvcHlBcnJheShhLCBiKSB7CiAgZm9yIChsZXQgaSA9IDAsIGwgPSBiLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgYVtpXSA9IGJbaV07CiAgfQp9CmZ1bmN0aW9uIGFsbG9jVGV4VW5pdHModGV4dHVyZXMsIG4pIHsKICBsZXQgciA9IGFycmF5Q2FjaGVJMzJbbl07CiAgaWYgKHIgPT09IHZvaWQgMCkgewogICAgciA9IG5ldyBJbnQzMkFycmF5KG4pOwogICAgYXJyYXlDYWNoZUkzMltuXSA9IHI7CiAgfQogIGZvciAobGV0IGkgPSAwOyBpICE9PSBuOyArK2kpIHsKICAgIHJbaV0gPSB0ZXh0dXJlcy5hbGxvY2F0ZVRleHR1cmVVbml0KCk7CiAgfQogIHJldHVybiByOwp9CmZ1bmN0aW9uIHNldFZhbHVlVjFmKGdsLCB2KSB7CiAgY29uc3QgY2FjaGUgPSB0aGlzLmNhY2hlOwogIGlmIChjYWNoZVswXSA9PT0gdikKICAgIHJldHVybjsKICBnbC51bmlmb3JtMWYodGhpcy5hZGRyLCB2KTsKICBjYWNoZVswXSA9IHY7Cn0KZnVuY3Rpb24gc2V0VmFsdWVWMmYoZ2wsIHYpIHsKICBjb25zdCBjYWNoZSA9IHRoaXMuY2FjaGU7CiAgaWYgKHYueCAhPT0gdm9pZCAwKSB7CiAgICBpZiAoY2FjaGVbMF0gIT09IHYueCB8fCBjYWNoZVsxXSAhPT0gdi55KSB7CiAgICAgIGdsLnVuaWZvcm0yZih0aGlzLmFkZHIsIHYueCwgdi55KTsKICAgICAgY2FjaGVbMF0gPSB2Lng7CiAgICAgIGNhY2hlWzFdID0gdi55OwogICAgfQogIH0gZWxzZSB7CiAgICBpZiAoYXJyYXlzRXF1YWwoY2FjaGUsIHYpKQogICAgICByZXR1cm47CiAgICBnbC51bmlmb3JtMmZ2KHRoaXMuYWRkciwgdik7CiAgICBjb3B5QXJyYXkoY2FjaGUsIHYpOwogIH0KfQpmdW5jdGlvbiBzZXRWYWx1ZVYzZihnbCwgdikgewogIGNvbnN0IGNhY2hlID0gdGhpcy5jYWNoZTsKICBpZiAodi54ICE9PSB2b2lkIDApIHsKICAgIGlmIChjYWNoZVswXSAhPT0gdi54IHx8IGNhY2hlWzFdICE9PSB2LnkgfHwgY2FjaGVbMl0gIT09IHYueikgewogICAgICBnbC51bmlmb3JtM2YodGhpcy5hZGRyLCB2LngsIHYueSwgdi56KTsKICAgICAgY2FjaGVbMF0gPSB2Lng7CiAgICAgIGNhY2hlWzFdID0gdi55OwogICAgICBjYWNoZVsyXSA9IHYuejsKICAgIH0KICB9IGVsc2UgaWYgKHYuciAhPT0gdm9pZCAwKSB7CiAgICBpZiAoY2FjaGVbMF0gIT09IHYuciB8fCBjYWNoZVsxXSAhPT0gdi5nIHx8IGNhY2hlWzJdICE9PSB2LmIpIHsKICAgICAgZ2wudW5pZm9ybTNmKHRoaXMuYWRkciwgdi5yLCB2LmcsIHYuYik7CiAgICAgIGNhY2hlWzBdID0gdi5yOwogICAgICBjYWNoZVsxXSA9IHYuZzsKICAgICAgY2FjaGVbMl0gPSB2LmI7CiAgICB9CiAgfSBlbHNlIHsKICAgIGlmIChhcnJheXNFcXVhbChjYWNoZSwgdikpCiAgICAgIHJldHVybjsKICAgIGdsLnVuaWZvcm0zZnYodGhpcy5hZGRyLCB2KTsKICAgIGNvcHlBcnJheShjYWNoZSwgdik7CiAgfQp9CmZ1bmN0aW9uIHNldFZhbHVlVjRmKGdsLCB2KSB7CiAgY29uc3QgY2FjaGUgPSB0aGlzLmNhY2hlOwogIGlmICh2LnggIT09IHZvaWQgMCkgewogICAgaWYgKGNhY2hlWzBdICE9PSB2LnggfHwgY2FjaGVbMV0gIT09IHYueSB8fCBjYWNoZVsyXSAhPT0gdi56IHx8IGNhY2hlWzNdICE9PSB2LncpIHsKICAgICAgZ2wudW5pZm9ybTRmKHRoaXMuYWRkciwgdi54LCB2LnksIHYueiwgdi53KTsKICAgICAgY2FjaGVbMF0gPSB2Lng7CiAgICAgIGNhY2hlWzFdID0gdi55OwogICAgICBjYWNoZVsyXSA9IHYuejsKICAgICAgY2FjaGVbM10gPSB2Lnc7CiAgICB9CiAgfSBlbHNlIHsKICAgIGlmIChhcnJheXNFcXVhbChjYWNoZSwgdikpCiAgICAgIHJldHVybjsKICAgIGdsLnVuaWZvcm00ZnYodGhpcy5hZGRyLCB2KTsKICAgIGNvcHlBcnJheShjYWNoZSwgdik7CiAgfQp9CmZ1bmN0aW9uIHNldFZhbHVlTTIoZ2wsIHYpIHsKICBjb25zdCBjYWNoZSA9IHRoaXMuY2FjaGU7CiAgY29uc3QgZWxlbWVudHMgPSB2LmVsZW1lbnRzOwogIGlmIChlbGVtZW50cyA9PT0gdm9pZCAwKSB7CiAgICBpZiAoYXJyYXlzRXF1YWwoY2FjaGUsIHYpKQogICAgICByZXR1cm47CiAgICBnbC51bmlmb3JtTWF0cml4MmZ2KHRoaXMuYWRkciwgZmFsc2UsIHYpOwogICAgY29weUFycmF5KGNhY2hlLCB2KTsKICB9IGVsc2UgewogICAgaWYgKGFycmF5c0VxdWFsKGNhY2hlLCBlbGVtZW50cykpCiAgICAgIHJldHVybjsKICAgIG1hdDJhcnJheS5zZXQoZWxlbWVudHMpOwogICAgZ2wudW5pZm9ybU1hdHJpeDJmdih0aGlzLmFkZHIsIGZhbHNlLCBtYXQyYXJyYXkpOwogICAgY29weUFycmF5KGNhY2hlLCBlbGVtZW50cyk7CiAgfQp9CmZ1bmN0aW9uIHNldFZhbHVlTTMoZ2wsIHYpIHsKICBjb25zdCBjYWNoZSA9IHRoaXMuY2FjaGU7CiAgY29uc3QgZWxlbWVudHMgPSB2LmVsZW1lbnRzOwogIGlmIChlbGVtZW50cyA9PT0gdm9pZCAwKSB7CiAgICBpZiAoYXJyYXlzRXF1YWwoY2FjaGUsIHYpKQogICAgICByZXR1cm47CiAgICBnbC51bmlmb3JtTWF0cml4M2Z2KHRoaXMuYWRkciwgZmFsc2UsIHYpOwogICAgY29weUFycmF5KGNhY2hlLCB2KTsKICB9IGVsc2UgewogICAgaWYgKGFycmF5c0VxdWFsKGNhY2hlLCBlbGVtZW50cykpCiAgICAgIHJldHVybjsKICAgIG1hdDNhcnJheS5zZXQoZWxlbWVudHMpOwogICAgZ2wudW5pZm9ybU1hdHJpeDNmdih0aGlzLmFkZHIsIGZhbHNlLCBtYXQzYXJyYXkpOwogICAgY29weUFycmF5KGNhY2hlLCBlbGVtZW50cyk7CiAgfQp9CmZ1bmN0aW9uIHNldFZhbHVlTTQoZ2wsIHYpIHsKICBjb25zdCBjYWNoZSA9IHRoaXMuY2FjaGU7CiAgY29uc3QgZWxlbWVudHMgPSB2LmVsZW1lbnRzOwogIGlmIChlbGVtZW50cyA9PT0gdm9pZCAwKSB7CiAgICBpZiAoYXJyYXlzRXF1YWwoY2FjaGUsIHYpKQogICAgICByZXR1cm47CiAgICBnbC51bmlmb3JtTWF0cml4NGZ2KHRoaXMuYWRkciwgZmFsc2UsIHYpOwogICAgY29weUFycmF5KGNhY2hlLCB2KTsKICB9IGVsc2UgewogICAgaWYgKGFycmF5c0VxdWFsKGNhY2hlLCBlbGVtZW50cykpCiAgICAgIHJldHVybjsKICAgIG1hdDRhcnJheS5zZXQoZWxlbWVudHMpOwogICAgZ2wudW5pZm9ybU1hdHJpeDRmdih0aGlzLmFkZHIsIGZhbHNlLCBtYXQ0YXJyYXkpOwogICAgY29weUFycmF5KGNhY2hlLCBlbGVtZW50cyk7CiAgfQp9CmZ1bmN0aW9uIHNldFZhbHVlVjFpKGdsLCB2KSB7CiAgY29uc3QgY2FjaGUgPSB0aGlzLmNhY2hlOwogIGlmIChjYWNoZVswXSA9PT0gdikKICAgIHJldHVybjsKICBnbC51bmlmb3JtMWkodGhpcy5hZGRyLCB2KTsKICBjYWNoZVswXSA9IHY7Cn0KZnVuY3Rpb24gc2V0VmFsdWVWMmkoZ2wsIHYpIHsKICBjb25zdCBjYWNoZSA9IHRoaXMuY2FjaGU7CiAgaWYgKGFycmF5c0VxdWFsKGNhY2hlLCB2KSkKICAgIHJldHVybjsKICBnbC51bmlmb3JtMml2KHRoaXMuYWRkciwgdik7CiAgY29weUFycmF5KGNhY2hlLCB2KTsKfQpmdW5jdGlvbiBzZXRWYWx1ZVYzaShnbCwgdikgewogIGNvbnN0IGNhY2hlID0gdGhpcy5jYWNoZTsKICBpZiAoYXJyYXlzRXF1YWwoY2FjaGUsIHYpKQogICAgcmV0dXJuOwogIGdsLnVuaWZvcm0zaXYodGhpcy5hZGRyLCB2KTsKICBjb3B5QXJyYXkoY2FjaGUsIHYpOwp9CmZ1bmN0aW9uIHNldFZhbHVlVjRpKGdsLCB2KSB7CiAgY29uc3QgY2FjaGUgPSB0aGlzLmNhY2hlOwogIGlmIChhcnJheXNFcXVhbChjYWNoZSwgdikpCiAgICByZXR1cm47CiAgZ2wudW5pZm9ybTRpdih0aGlzLmFkZHIsIHYpOwogIGNvcHlBcnJheShjYWNoZSwgdik7Cn0KZnVuY3Rpb24gc2V0VmFsdWVWMXVpKGdsLCB2KSB7CiAgY29uc3QgY2FjaGUgPSB0aGlzLmNhY2hlOwogIGlmIChjYWNoZVswXSA9PT0gdikKICAgIHJldHVybjsKICBnbC51bmlmb3JtMXVpKHRoaXMuYWRkciwgdik7CiAgY2FjaGVbMF0gPSB2Owp9CmZ1bmN0aW9uIHNldFZhbHVlVjJ1aShnbCwgdikgewogIGNvbnN0IGNhY2hlID0gdGhpcy5jYWNoZTsKICBpZiAoYXJyYXlzRXF1YWwoY2FjaGUsIHYpKQogICAgcmV0dXJuOwogIGdsLnVuaWZvcm0ydWl2KHRoaXMuYWRkciwgdik7CiAgY29weUFycmF5KGNhY2hlLCB2KTsKfQpmdW5jdGlvbiBzZXRWYWx1ZVYzdWkoZ2wsIHYpIHsKICBjb25zdCBjYWNoZSA9IHRoaXMuY2FjaGU7CiAgaWYgKGFycmF5c0VxdWFsKGNhY2hlLCB2KSkKICAgIHJldHVybjsKICBnbC51bmlmb3JtM3Vpdih0aGlzLmFkZHIsIHYpOwogIGNvcHlBcnJheShjYWNoZSwgdik7Cn0KZnVuY3Rpb24gc2V0VmFsdWVWNHVpKGdsLCB2KSB7CiAgY29uc3QgY2FjaGUgPSB0aGlzLmNhY2hlOwogIGlmIChhcnJheXNFcXVhbChjYWNoZSwgdikpCiAgICByZXR1cm47CiAgZ2wudW5pZm9ybTR1aXYodGhpcy5hZGRyLCB2KTsKICBjb3B5QXJyYXkoY2FjaGUsIHYpOwp9CmZ1bmN0aW9uIHNldFZhbHVlVDEoZ2wsIHYsIHRleHR1cmVzKSB7CiAgY29uc3QgY2FjaGUgPSB0aGlzLmNhY2hlOwogIGNvbnN0IHVuaXQgPSB0ZXh0dXJlcy5hbGxvY2F0ZVRleHR1cmVVbml0KCk7CiAgaWYgKGNhY2hlWzBdICE9PSB1bml0KSB7CiAgICBnbC51bmlmb3JtMWkodGhpcy5hZGRyLCB1bml0KTsKICAgIGNhY2hlWzBdID0gdW5pdDsKICB9CiAgdGV4dHVyZXMuc2FmZVNldFRleHR1cmUyRCh2IHx8IGVtcHR5VGV4dHVyZSwgdW5pdCk7Cn0KZnVuY3Rpb24gc2V0VmFsdWVUM0QxKGdsLCB2LCB0ZXh0dXJlcykgewogIGNvbnN0IGNhY2hlID0gdGhpcy5jYWNoZTsKICBjb25zdCB1bml0ID0gdGV4dHVyZXMuYWxsb2NhdGVUZXh0dXJlVW5pdCgpOwogIGlmIChjYWNoZVswXSAhPT0gdW5pdCkgewogICAgZ2wudW5pZm9ybTFpKHRoaXMuYWRkciwgdW5pdCk7CiAgICBjYWNoZVswXSA9IHVuaXQ7CiAgfQogIHRleHR1cmVzLnNldFRleHR1cmUzRCh2IHx8IGVtcHR5VGV4dHVyZTNkLCB1bml0KTsKfQpmdW5jdGlvbiBzZXRWYWx1ZVQ2KGdsLCB2LCB0ZXh0dXJlcykgewogIGNvbnN0IGNhY2hlID0gdGhpcy5jYWNoZTsKICBjb25zdCB1bml0ID0gdGV4dHVyZXMuYWxsb2NhdGVUZXh0dXJlVW5pdCgpOwogIGlmIChjYWNoZVswXSAhPT0gdW5pdCkgewogICAgZ2wudW5pZm9ybTFpKHRoaXMuYWRkciwgdW5pdCk7CiAgICBjYWNoZVswXSA9IHVuaXQ7CiAgfQogIHRleHR1cmVzLnNhZmVTZXRUZXh0dXJlQ3ViZSh2IHx8IGVtcHR5Q3ViZVRleHR1cmUsIHVuaXQpOwp9CmZ1bmN0aW9uIHNldFZhbHVlVDJEQXJyYXkxKGdsLCB2LCB0ZXh0dXJlcykgewogIGNvbnN0IGNhY2hlID0gdGhpcy5jYWNoZTsKICBjb25zdCB1bml0ID0gdGV4dHVyZXMuYWxsb2NhdGVUZXh0dXJlVW5pdCgpOwogIGlmIChjYWNoZVswXSAhPT0gdW5pdCkgewogICAgZ2wudW5pZm9ybTFpKHRoaXMuYWRkciwgdW5pdCk7CiAgICBjYWNoZVswXSA9IHVuaXQ7CiAgfQogIHRleHR1cmVzLnNldFRleHR1cmUyREFycmF5KHYgfHwgZW1wdHlUZXh0dXJlMmRBcnJheSwgdW5pdCk7Cn0KZnVuY3Rpb24gZ2V0U2luZ3VsYXJTZXR0ZXIodHlwZSkgewogIHN3aXRjaCAodHlwZSkgewogICAgY2FzZSA1MTI2OgogICAgICByZXR1cm4gc2V0VmFsdWVWMWY7CiAgICBjYXNlIDM1NjY0OgogICAgICByZXR1cm4gc2V0VmFsdWVWMmY7CiAgICBjYXNlIDM1NjY1OgogICAgICByZXR1cm4gc2V0VmFsdWVWM2Y7CiAgICBjYXNlIDM1NjY2OgogICAgICByZXR1cm4gc2V0VmFsdWVWNGY7CiAgICBjYXNlIDM1Njc0OgogICAgICByZXR1cm4gc2V0VmFsdWVNMjsKICAgIGNhc2UgMzU2NzU6CiAgICAgIHJldHVybiBzZXRWYWx1ZU0zOwogICAgY2FzZSAzNTY3NjoKICAgICAgcmV0dXJuIHNldFZhbHVlTTQ7CiAgICBjYXNlIDUxMjQ6CiAgICBjYXNlIDM1NjcwOgogICAgICByZXR1cm4gc2V0VmFsdWVWMWk7CiAgICBjYXNlIDM1NjY3OgogICAgY2FzZSAzNTY3MToKICAgICAgcmV0dXJuIHNldFZhbHVlVjJpOwogICAgY2FzZSAzNTY2ODoKICAgIGNhc2UgMzU2NzI6CiAgICAgIHJldHVybiBzZXRWYWx1ZVYzaTsKICAgIGNhc2UgMzU2Njk6CiAgICBjYXNlIDM1NjczOgogICAgICByZXR1cm4gc2V0VmFsdWVWNGk7CiAgICBjYXNlIDUxMjU6CiAgICAgIHJldHVybiBzZXRWYWx1ZVYxdWk7CiAgICBjYXNlIDM2Mjk0OgogICAgICByZXR1cm4gc2V0VmFsdWVWMnVpOwogICAgY2FzZSAzNjI5NToKICAgICAgcmV0dXJuIHNldFZhbHVlVjN1aTsKICAgIGNhc2UgMzYyOTY6CiAgICAgIHJldHVybiBzZXRWYWx1ZVY0dWk7CiAgICBjYXNlIDM1Njc4OgogICAgY2FzZSAzNjE5ODoKICAgIGNhc2UgMzYyOTg6CiAgICBjYXNlIDM2MzA2OgogICAgY2FzZSAzNTY4MjoKICAgICAgcmV0dXJuIHNldFZhbHVlVDE7CiAgICBjYXNlIDM1Njc5OgogICAgY2FzZSAzNjI5OToKICAgIGNhc2UgMzYzMDc6CiAgICAgIHJldHVybiBzZXRWYWx1ZVQzRDE7CiAgICBjYXNlIDM1NjgwOgogICAgY2FzZSAzNjMwMDoKICAgIGNhc2UgMzYzMDg6CiAgICBjYXNlIDM2MjkzOgogICAgICByZXR1cm4gc2V0VmFsdWVUNjsKICAgIGNhc2UgMzYyODk6CiAgICBjYXNlIDM2MzAzOgogICAgY2FzZSAzNjMxMToKICAgIGNhc2UgMzYyOTI6CiAgICAgIHJldHVybiBzZXRWYWx1ZVQyREFycmF5MTsKICB9Cn0KZnVuY3Rpb24gc2V0VmFsdWVWMWZBcnJheShnbCwgdikgewogIGdsLnVuaWZvcm0xZnYodGhpcy5hZGRyLCB2KTsKfQpmdW5jdGlvbiBzZXRWYWx1ZVYyZkFycmF5KGdsLCB2KSB7CiAgY29uc3QgZGF0YSA9IGZsYXR0ZW4odiwgdGhpcy5zaXplLCAyKTsKICBnbC51bmlmb3JtMmZ2KHRoaXMuYWRkciwgZGF0YSk7Cn0KZnVuY3Rpb24gc2V0VmFsdWVWM2ZBcnJheShnbCwgdikgewogIGNvbnN0IGRhdGEgPSBmbGF0dGVuKHYsIHRoaXMuc2l6ZSwgMyk7CiAgZ2wudW5pZm9ybTNmdih0aGlzLmFkZHIsIGRhdGEpOwp9CmZ1bmN0aW9uIHNldFZhbHVlVjRmQXJyYXkoZ2wsIHYpIHsKICBjb25zdCBkYXRhID0gZmxhdHRlbih2LCB0aGlzLnNpemUsIDQpOwogIGdsLnVuaWZvcm00ZnYodGhpcy5hZGRyLCBkYXRhKTsKfQpmdW5jdGlvbiBzZXRWYWx1ZU0yQXJyYXkoZ2wsIHYpIHsKICBjb25zdCBkYXRhID0gZmxhdHRlbih2LCB0aGlzLnNpemUsIDQpOwogIGdsLnVuaWZvcm1NYXRyaXgyZnYodGhpcy5hZGRyLCBmYWxzZSwgZGF0YSk7Cn0KZnVuY3Rpb24gc2V0VmFsdWVNM0FycmF5KGdsLCB2KSB7CiAgY29uc3QgZGF0YSA9IGZsYXR0ZW4odiwgdGhpcy5zaXplLCA5KTsKICBnbC51bmlmb3JtTWF0cml4M2Z2KHRoaXMuYWRkciwgZmFsc2UsIGRhdGEpOwp9CmZ1bmN0aW9uIHNldFZhbHVlTTRBcnJheShnbCwgdikgewogIGNvbnN0IGRhdGEgPSBmbGF0dGVuKHYsIHRoaXMuc2l6ZSwgMTYpOwogIGdsLnVuaWZvcm1NYXRyaXg0ZnYodGhpcy5hZGRyLCBmYWxzZSwgZGF0YSk7Cn0KZnVuY3Rpb24gc2V0VmFsdWVWMWlBcnJheShnbCwgdikgewogIGdsLnVuaWZvcm0xaXYodGhpcy5hZGRyLCB2KTsKfQpmdW5jdGlvbiBzZXRWYWx1ZVYyaUFycmF5KGdsLCB2KSB7CiAgZ2wudW5pZm9ybTJpdih0aGlzLmFkZHIsIHYpOwp9CmZ1bmN0aW9uIHNldFZhbHVlVjNpQXJyYXkoZ2wsIHYpIHsKICBnbC51bmlmb3JtM2l2KHRoaXMuYWRkciwgdik7Cn0KZnVuY3Rpb24gc2V0VmFsdWVWNGlBcnJheShnbCwgdikgewogIGdsLnVuaWZvcm00aXYodGhpcy5hZGRyLCB2KTsKfQpmdW5jdGlvbiBzZXRWYWx1ZVYxdWlBcnJheShnbCwgdikgewogIGdsLnVuaWZvcm0xdWl2KHRoaXMuYWRkciwgdik7Cn0KZnVuY3Rpb24gc2V0VmFsdWVWMnVpQXJyYXkoZ2wsIHYpIHsKICBnbC51bmlmb3JtMnVpdih0aGlzLmFkZHIsIHYpOwp9CmZ1bmN0aW9uIHNldFZhbHVlVjN1aUFycmF5KGdsLCB2KSB7CiAgZ2wudW5pZm9ybTN1aXYodGhpcy5hZGRyLCB2KTsKfQpmdW5jdGlvbiBzZXRWYWx1ZVY0dWlBcnJheShnbCwgdikgewogIGdsLnVuaWZvcm00dWl2KHRoaXMuYWRkciwgdik7Cn0KZnVuY3Rpb24gc2V0VmFsdWVUMUFycmF5KGdsLCB2LCB0ZXh0dXJlcykgewogIGNvbnN0IG4gPSB2Lmxlbmd0aDsKICBjb25zdCB1bml0cyA9IGFsbG9jVGV4VW5pdHModGV4dHVyZXMsIG4pOwogIGdsLnVuaWZvcm0xaXYodGhpcy5hZGRyLCB1bml0cyk7CiAgZm9yIChsZXQgaSA9IDA7IGkgIT09IG47ICsraSkgewogICAgdGV4dHVyZXMuc2FmZVNldFRleHR1cmUyRCh2W2ldIHx8IGVtcHR5VGV4dHVyZSwgdW5pdHNbaV0pOwogIH0KfQpmdW5jdGlvbiBzZXRWYWx1ZVQzREFycmF5KGdsLCB2LCB0ZXh0dXJlcykgewogIGNvbnN0IG4gPSB2Lmxlbmd0aDsKICBjb25zdCB1bml0cyA9IGFsbG9jVGV4VW5pdHModGV4dHVyZXMsIG4pOwogIGdsLnVuaWZvcm0xaXYodGhpcy5hZGRyLCB1bml0cyk7CiAgZm9yIChsZXQgaSA9IDA7IGkgIT09IG47ICsraSkgewogICAgdGV4dHVyZXMuc2V0VGV4dHVyZTNEKHZbaV0gfHwgZW1wdHlUZXh0dXJlM2QsIHVuaXRzW2ldKTsKICB9Cn0KZnVuY3Rpb24gc2V0VmFsdWVUNkFycmF5KGdsLCB2LCB0ZXh0dXJlcykgewogIGNvbnN0IG4gPSB2Lmxlbmd0aDsKICBjb25zdCB1bml0cyA9IGFsbG9jVGV4VW5pdHModGV4dHVyZXMsIG4pOwogIGdsLnVuaWZvcm0xaXYodGhpcy5hZGRyLCB1bml0cyk7CiAgZm9yIChsZXQgaSA9IDA7IGkgIT09IG47ICsraSkgewogICAgdGV4dHVyZXMuc2FmZVNldFRleHR1cmVDdWJlKHZbaV0gfHwgZW1wdHlDdWJlVGV4dHVyZSwgdW5pdHNbaV0pOwogIH0KfQpmdW5jdGlvbiBzZXRWYWx1ZVQyREFycmF5QXJyYXkoZ2wsIHYsIHRleHR1cmVzKSB7CiAgY29uc3QgbiA9IHYubGVuZ3RoOwogIGNvbnN0IHVuaXRzID0gYWxsb2NUZXhVbml0cyh0ZXh0dXJlcywgbik7CiAgZ2wudW5pZm9ybTFpdih0aGlzLmFkZHIsIHVuaXRzKTsKICBmb3IgKGxldCBpID0gMDsgaSAhPT0gbjsgKytpKSB7CiAgICB0ZXh0dXJlcy5zZXRUZXh0dXJlMkRBcnJheSh2W2ldIHx8IGVtcHR5VGV4dHVyZTJkQXJyYXksIHVuaXRzW2ldKTsKICB9Cn0KZnVuY3Rpb24gZ2V0UHVyZUFycmF5U2V0dGVyKHR5cGUpIHsKICBzd2l0Y2ggKHR5cGUpIHsKICAgIGNhc2UgNTEyNjoKICAgICAgcmV0dXJuIHNldFZhbHVlVjFmQXJyYXk7CiAgICBjYXNlIDM1NjY0OgogICAgICByZXR1cm4gc2V0VmFsdWVWMmZBcnJheTsKICAgIGNhc2UgMzU2NjU6CiAgICAgIHJldHVybiBzZXRWYWx1ZVYzZkFycmF5OwogICAgY2FzZSAzNTY2NjoKICAgICAgcmV0dXJuIHNldFZhbHVlVjRmQXJyYXk7CiAgICBjYXNlIDM1Njc0OgogICAgICByZXR1cm4gc2V0VmFsdWVNMkFycmF5OwogICAgY2FzZSAzNTY3NToKICAgICAgcmV0dXJuIHNldFZhbHVlTTNBcnJheTsKICAgIGNhc2UgMzU2NzY6CiAgICAgIHJldHVybiBzZXRWYWx1ZU00QXJyYXk7CiAgICBjYXNlIDUxMjQ6CiAgICBjYXNlIDM1NjcwOgogICAgICByZXR1cm4gc2V0VmFsdWVWMWlBcnJheTsKICAgIGNhc2UgMzU2Njc6CiAgICBjYXNlIDM1NjcxOgogICAgICByZXR1cm4gc2V0VmFsdWVWMmlBcnJheTsKICAgIGNhc2UgMzU2Njg6CiAgICBjYXNlIDM1NjcyOgogICAgICByZXR1cm4gc2V0VmFsdWVWM2lBcnJheTsKICAgIGNhc2UgMzU2Njk6CiAgICBjYXNlIDM1NjczOgogICAgICByZXR1cm4gc2V0VmFsdWVWNGlBcnJheTsKICAgIGNhc2UgNTEyNToKICAgICAgcmV0dXJuIHNldFZhbHVlVjF1aUFycmF5OwogICAgY2FzZSAzNjI5NDoKICAgICAgcmV0dXJuIHNldFZhbHVlVjJ1aUFycmF5OwogICAgY2FzZSAzNjI5NToKICAgICAgcmV0dXJuIHNldFZhbHVlVjN1aUFycmF5OwogICAgY2FzZSAzNjI5NjoKICAgICAgcmV0dXJuIHNldFZhbHVlVjR1aUFycmF5OwogICAgY2FzZSAzNTY3ODoKICAgIGNhc2UgMzYxOTg6CiAgICBjYXNlIDM2Mjk4OgogICAgY2FzZSAzNjMwNjoKICAgIGNhc2UgMzU2ODI6CiAgICAgIHJldHVybiBzZXRWYWx1ZVQxQXJyYXk7CiAgICBjYXNlIDM1Njc5OgogICAgY2FzZSAzNjI5OToKICAgIGNhc2UgMzYzMDc6CiAgICAgIHJldHVybiBzZXRWYWx1ZVQzREFycmF5OwogICAgY2FzZSAzNTY4MDoKICAgIGNhc2UgMzYzMDA6CiAgICBjYXNlIDM2MzA4OgogICAgY2FzZSAzNjI5MzoKICAgICAgcmV0dXJuIHNldFZhbHVlVDZBcnJheTsKICAgIGNhc2UgMzYyODk6CiAgICBjYXNlIDM2MzAzOgogICAgY2FzZSAzNjMxMToKICAgIGNhc2UgMzYyOTI6CiAgICAgIHJldHVybiBzZXRWYWx1ZVQyREFycmF5QXJyYXk7CiAgfQp9CmZ1bmN0aW9uIFNpbmdsZVVuaWZvcm0oaWQsIGFjdGl2ZUluZm8sIGFkZHIpIHsKICB0aGlzLmlkID0gaWQ7CiAgdGhpcy5hZGRyID0gYWRkcjsKICB0aGlzLmNhY2hlID0gW107CiAgdGhpcy5zZXRWYWx1ZSA9IGdldFNpbmd1bGFyU2V0dGVyKGFjdGl2ZUluZm8udHlwZSk7Cn0KZnVuY3Rpb24gUHVyZUFycmF5VW5pZm9ybShpZCwgYWN0aXZlSW5mbywgYWRkcikgewogIHRoaXMuaWQgPSBpZDsKICB0aGlzLmFkZHIgPSBhZGRyOwogIHRoaXMuY2FjaGUgPSBbXTsKICB0aGlzLnNpemUgPSBhY3RpdmVJbmZvLnNpemU7CiAgdGhpcy5zZXRWYWx1ZSA9IGdldFB1cmVBcnJheVNldHRlcihhY3RpdmVJbmZvLnR5cGUpOwp9ClB1cmVBcnJheVVuaWZvcm0ucHJvdG90eXBlLnVwZGF0ZUNhY2hlID0gZnVuY3Rpb24oZGF0YSkgewogIGNvbnN0IGNhY2hlID0gdGhpcy5jYWNoZTsKICBpZiAoZGF0YSBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheSAmJiBjYWNoZS5sZW5ndGggIT09IGRhdGEubGVuZ3RoKSB7CiAgICB0aGlzLmNhY2hlID0gbmV3IEZsb2F0MzJBcnJheShkYXRhLmxlbmd0aCk7CiAgfQogIGNvcHlBcnJheShjYWNoZSwgZGF0YSk7Cn07CmZ1bmN0aW9uIFN0cnVjdHVyZWRVbmlmb3JtKGlkKSB7CiAgdGhpcy5pZCA9IGlkOwogIHRoaXMuc2VxID0gW107CiAgdGhpcy5tYXAgPSB7fTsKfQpTdHJ1Y3R1cmVkVW5pZm9ybS5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbihnbCwgdmFsdWUsIHRleHR1cmVzKSB7CiAgY29uc3Qgc2VxID0gdGhpcy5zZXE7CiAgZm9yIChsZXQgaSA9IDAsIG4gPSBzZXEubGVuZ3RoOyBpICE9PSBuOyArK2kpIHsKICAgIGNvbnN0IHUgPSBzZXFbaV07CiAgICB1LnNldFZhbHVlKGdsLCB2YWx1ZVt1LmlkXSwgdGV4dHVyZXMpOwogIH0KfTsKY29uc3QgUmVQYXRoUGFydCA9IC8oXHcrKShcXSk/KFxbfFwuKT8vZzsKZnVuY3Rpb24gYWRkVW5pZm9ybShjb250YWluZXIsIHVuaWZvcm1PYmplY3QpIHsKICBjb250YWluZXIuc2VxLnB1c2godW5pZm9ybU9iamVjdCk7CiAgY29udGFpbmVyLm1hcFt1bmlmb3JtT2JqZWN0LmlkXSA9IHVuaWZvcm1PYmplY3Q7Cn0KZnVuY3Rpb24gcGFyc2VVbmlmb3JtKGFjdGl2ZUluZm8sIGFkZHIsIGNvbnRhaW5lcikgewogIGNvbnN0IHBhdGggPSBhY3RpdmVJbmZvLm5hbWUsIHBhdGhMZW5ndGggPSBwYXRoLmxlbmd0aDsKICBSZVBhdGhQYXJ0Lmxhc3RJbmRleCA9IDA7CiAgd2hpbGUgKHRydWUpIHsKICAgIGNvbnN0IG1hdGNoID0gUmVQYXRoUGFydC5leGVjKHBhdGgpLCBtYXRjaEVuZCA9IFJlUGF0aFBhcnQubGFzdEluZGV4OwogICAgbGV0IGlkID0gbWF0Y2hbMV07CiAgICBjb25zdCBpZElzSW5kZXggPSBtYXRjaFsyXSA9PT0gIl0iLCBzdWJzY3JpcHQgPSBtYXRjaFszXTsKICAgIGlmIChpZElzSW5kZXgpCiAgICAgIGlkID0gaWQgfCAwOwogICAgaWYgKHN1YnNjcmlwdCA9PT0gdm9pZCAwIHx8IHN1YnNjcmlwdCA9PT0gIlsiICYmIG1hdGNoRW5kICsgMiA9PT0gcGF0aExlbmd0aCkgewogICAgICBhZGRVbmlmb3JtKGNvbnRhaW5lciwgc3Vic2NyaXB0ID09PSB2b2lkIDAgPyBuZXcgU2luZ2xlVW5pZm9ybShpZCwgYWN0aXZlSW5mbywgYWRkcikgOiBuZXcgUHVyZUFycmF5VW5pZm9ybShpZCwgYWN0aXZlSW5mbywgYWRkcikpOwogICAgICBicmVhazsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IG1hcCA9IGNvbnRhaW5lci5tYXA7CiAgICAgIGxldCBuZXh0ID0gbWFwW2lkXTsKICAgICAgaWYgKG5leHQgPT09IHZvaWQgMCkgewogICAgICAgIG5leHQgPSBuZXcgU3RydWN0dXJlZFVuaWZvcm0oaWQpOwogICAgICAgIGFkZFVuaWZvcm0oY29udGFpbmVyLCBuZXh0KTsKICAgICAgfQogICAgICBjb250YWluZXIgPSBuZXh0OwogICAgfQogIH0KfQpmdW5jdGlvbiBXZWJHTFVuaWZvcm1zKGdsLCBwcm9ncmFtKSB7CiAgdGhpcy5zZXEgPSBbXTsKICB0aGlzLm1hcCA9IHt9OwogIGNvbnN0IG4gPSBnbC5nZXRQcm9ncmFtUGFyYW1ldGVyKHByb2dyYW0sIDM1NzE4KTsKICBmb3IgKGxldCBpID0gMDsgaSA8IG47ICsraSkgewogICAgY29uc3QgaW5mbyA9IGdsLmdldEFjdGl2ZVVuaWZvcm0ocHJvZ3JhbSwgaSksIGFkZHIgPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ocHJvZ3JhbSwgaW5mby5uYW1lKTsKICAgIHBhcnNlVW5pZm9ybShpbmZvLCBhZGRyLCB0aGlzKTsKICB9Cn0KV2ViR0xVbmlmb3Jtcy5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbihnbCwgbmFtZSwgdmFsdWUsIHRleHR1cmVzKSB7CiAgY29uc3QgdSA9IHRoaXMubWFwW25hbWVdOwogIGlmICh1ICE9PSB2b2lkIDApCiAgICB1LnNldFZhbHVlKGdsLCB2YWx1ZSwgdGV4dHVyZXMpOwp9OwpXZWJHTFVuaWZvcm1zLnByb3RvdHlwZS5zZXRPcHRpb25hbCA9IGZ1bmN0aW9uKGdsLCBvYmplY3QsIG5hbWUpIHsKICBjb25zdCB2ID0gb2JqZWN0W25hbWVdOwogIGlmICh2ICE9PSB2b2lkIDApCiAgICB0aGlzLnNldFZhbHVlKGdsLCBuYW1lLCB2KTsKfTsKV2ViR0xVbmlmb3Jtcy51cGxvYWQgPSBmdW5jdGlvbihnbCwgc2VxLCB2YWx1ZXMsIHRleHR1cmVzKSB7CiAgZm9yIChsZXQgaSA9IDAsIG4gPSBzZXEubGVuZ3RoOyBpICE9PSBuOyArK2kpIHsKICAgIGNvbnN0IHUgPSBzZXFbaV0sIHYgPSB2YWx1ZXNbdS5pZF07CiAgICBpZiAodi5uZWVkc1VwZGF0ZSAhPT0gZmFsc2UpIHsKICAgICAgdS5zZXRWYWx1ZShnbCwgdi52YWx1ZSwgdGV4dHVyZXMpOwogICAgfQogIH0KfTsKV2ViR0xVbmlmb3Jtcy5zZXFXaXRoVmFsdWUgPSBmdW5jdGlvbihzZXEsIHZhbHVlcykgewogIGNvbnN0IHIgPSBbXTsKICBmb3IgKGxldCBpID0gMCwgbiA9IHNlcS5sZW5ndGg7IGkgIT09IG47ICsraSkgewogICAgY29uc3QgdSA9IHNlcVtpXTsKICAgIGlmICh1LmlkIGluIHZhbHVlcykKICAgICAgci5wdXNoKHUpOwogIH0KICByZXR1cm4gcjsKfTsKZnVuY3Rpb24gV2ViR0xTaGFkZXIoZ2wsIHR5cGUsIHN0cmluZykgewogIGNvbnN0IHNoYWRlciA9IGdsLmNyZWF0ZVNoYWRlcih0eXBlKTsKICBnbC5zaGFkZXJTb3VyY2Uoc2hhZGVyLCBzdHJpbmcpOwogIGdsLmNvbXBpbGVTaGFkZXIoc2hhZGVyKTsKICByZXR1cm4gc2hhZGVyOwp9CmxldCBwcm9ncmFtSWRDb3VudCA9IDA7CmZ1bmN0aW9uIGFkZExpbmVOdW1iZXJzKHN0cmluZykgewogIGNvbnN0IGxpbmVzID0gc3RyaW5nLnNwbGl0KCJcbiIpOwogIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHsKICAgIGxpbmVzW2ldID0gaSArIDEgKyAiOiAiICsgbGluZXNbaV07CiAgfQogIHJldHVybiBsaW5lcy5qb2luKCJcbiIpOwp9CmZ1bmN0aW9uIGdldEVuY29kaW5nQ29tcG9uZW50cyhlbmNvZGluZykgewogIHN3aXRjaCAoZW5jb2RpbmcpIHsKICAgIGNhc2UgTGluZWFyRW5jb2Rpbmc6CiAgICAgIHJldHVybiBbIkxpbmVhciIsICIoIHZhbHVlICkiXTsKICAgIGNhc2Ugc1JHQkVuY29kaW5nOgogICAgICByZXR1cm4gWyJzUkdCIiwgIiggdmFsdWUgKSJdOwogICAgZGVmYXVsdDoKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFByb2dyYW06IFVuc3VwcG9ydGVkIGVuY29kaW5nOiIsIGVuY29kaW5nKTsKICAgICAgcmV0dXJuIFsiTGluZWFyIiwgIiggdmFsdWUgKSJdOwogIH0KfQpmdW5jdGlvbiBnZXRTaGFkZXJFcnJvcnMoZ2wsIHNoYWRlciwgdHlwZSkgewogIGNvbnN0IHN0YXR1cyA9IGdsLmdldFNoYWRlclBhcmFtZXRlcihzaGFkZXIsIDM1NzEzKTsKICBjb25zdCBlcnJvcnMgPSBnbC5nZXRTaGFkZXJJbmZvTG9nKHNoYWRlcikudHJpbSgpOwogIGlmIChzdGF0dXMgJiYgZXJyb3JzID09PSAiIikKICAgIHJldHVybiAiIjsKICByZXR1cm4gdHlwZS50b1VwcGVyQ2FzZSgpICsgIlxuXG4iICsgZXJyb3JzICsgIlxuXG4iICsgYWRkTGluZU51bWJlcnMoZ2wuZ2V0U2hhZGVyU291cmNlKHNoYWRlcikpOwp9CmZ1bmN0aW9uIGdldFRleGVsRW5jb2RpbmdGdW5jdGlvbihmdW5jdGlvbk5hbWUsIGVuY29kaW5nKSB7CiAgY29uc3QgY29tcG9uZW50cyA9IGdldEVuY29kaW5nQ29tcG9uZW50cyhlbmNvZGluZyk7CiAgcmV0dXJuICJ2ZWM0ICIgKyBmdW5jdGlvbk5hbWUgKyAiKCB2ZWM0IHZhbHVlICkgeyByZXR1cm4gTGluZWFyVG8iICsgY29tcG9uZW50c1swXSArIGNvbXBvbmVudHNbMV0gKyAiOyB9IjsKfQpmdW5jdGlvbiBnZXRUb25lTWFwcGluZ0Z1bmN0aW9uKGZ1bmN0aW9uTmFtZSwgdG9uZU1hcHBpbmcpIHsKICBsZXQgdG9uZU1hcHBpbmdOYW1lOwogIHN3aXRjaCAodG9uZU1hcHBpbmcpIHsKICAgIGNhc2UgTGluZWFyVG9uZU1hcHBpbmc6CiAgICAgIHRvbmVNYXBwaW5nTmFtZSA9ICJMaW5lYXIiOwogICAgICBicmVhazsKICAgIGNhc2UgUmVpbmhhcmRUb25lTWFwcGluZzoKICAgICAgdG9uZU1hcHBpbmdOYW1lID0gIlJlaW5oYXJkIjsKICAgICAgYnJlYWs7CiAgICBjYXNlIENpbmVvblRvbmVNYXBwaW5nOgogICAgICB0b25lTWFwcGluZ05hbWUgPSAiT3B0aW1pemVkQ2luZW9uIjsKICAgICAgYnJlYWs7CiAgICBjYXNlIEFDRVNGaWxtaWNUb25lTWFwcGluZzoKICAgICAgdG9uZU1hcHBpbmdOYW1lID0gIkFDRVNGaWxtaWMiOwogICAgICBicmVhazsKICAgIGNhc2UgQ3VzdG9tVG9uZU1hcHBpbmc6CiAgICAgIHRvbmVNYXBwaW5nTmFtZSA9ICJDdXN0b20iOwogICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xQcm9ncmFtOiBVbnN1cHBvcnRlZCB0b25lTWFwcGluZzoiLCB0b25lTWFwcGluZyk7CiAgICAgIHRvbmVNYXBwaW5nTmFtZSA9ICJMaW5lYXIiOwogIH0KICByZXR1cm4gInZlYzMgIiArIGZ1bmN0aW9uTmFtZSArICIoIHZlYzMgY29sb3IgKSB7IHJldHVybiAiICsgdG9uZU1hcHBpbmdOYW1lICsgIlRvbmVNYXBwaW5nKCBjb2xvciApOyB9IjsKfQpmdW5jdGlvbiBnZW5lcmF0ZUV4dGVuc2lvbnMocGFyYW1ldGVycykgewogIGNvbnN0IGNodW5rcyA9IFsKICAgIHBhcmFtZXRlcnMuZXh0ZW5zaW9uRGVyaXZhdGl2ZXMgfHwgcGFyYW1ldGVycy5lbnZNYXBDdWJlVVYgfHwgcGFyYW1ldGVycy5idW1wTWFwIHx8IHBhcmFtZXRlcnMudGFuZ2VudFNwYWNlTm9ybWFsTWFwIHx8IHBhcmFtZXRlcnMuY2xlYXJjb2F0Tm9ybWFsTWFwIHx8IHBhcmFtZXRlcnMuZmxhdFNoYWRpbmcgfHwgcGFyYW1ldGVycy5zaGFkZXJJRCA9PT0gInBoeXNpY2FsIiA/ICIjZXh0ZW5zaW9uIEdMX09FU19zdGFuZGFyZF9kZXJpdmF0aXZlcyA6IGVuYWJsZSIgOiAiIiwKICAgIChwYXJhbWV0ZXJzLmV4dGVuc2lvbkZyYWdEZXB0aCB8fCBwYXJhbWV0ZXJzLmxvZ2FyaXRobWljRGVwdGhCdWZmZXIpICYmIHBhcmFtZXRlcnMucmVuZGVyZXJFeHRlbnNpb25GcmFnRGVwdGggPyAiI2V4dGVuc2lvbiBHTF9FWFRfZnJhZ19kZXB0aCA6IGVuYWJsZSIgOiAiIiwKICAgIHBhcmFtZXRlcnMuZXh0ZW5zaW9uRHJhd0J1ZmZlcnMgJiYgcGFyYW1ldGVycy5yZW5kZXJlckV4dGVuc2lvbkRyYXdCdWZmZXJzID8gIiNleHRlbnNpb24gR0xfRVhUX2RyYXdfYnVmZmVycyA6IHJlcXVpcmUiIDogIiIsCiAgICAocGFyYW1ldGVycy5leHRlbnNpb25TaGFkZXJUZXh0dXJlTE9EIHx8IHBhcmFtZXRlcnMuZW52TWFwIHx8IHBhcmFtZXRlcnMudHJhbnNtaXNzaW9uKSAmJiBwYXJhbWV0ZXJzLnJlbmRlcmVyRXh0ZW5zaW9uU2hhZGVyVGV4dHVyZUxvZCA/ICIjZXh0ZW5zaW9uIEdMX0VYVF9zaGFkZXJfdGV4dHVyZV9sb2QgOiBlbmFibGUiIDogIiIKICBdOwogIHJldHVybiBjaHVua3MuZmlsdGVyKGZpbHRlckVtcHR5TGluZSkuam9pbigiXG4iKTsKfQpmdW5jdGlvbiBnZW5lcmF0ZURlZmluZXMoZGVmaW5lcykgewogIGNvbnN0IGNodW5rcyA9IFtdOwogIGZvciAoY29uc3QgbmFtZSBpbiBkZWZpbmVzKSB7CiAgICBjb25zdCB2YWx1ZSA9IGRlZmluZXNbbmFtZV07CiAgICBpZiAodmFsdWUgPT09IGZhbHNlKQogICAgICBjb250aW51ZTsKICAgIGNodW5rcy5wdXNoKCIjZGVmaW5lICIgKyBuYW1lICsgIiAiICsgdmFsdWUpOwogIH0KICByZXR1cm4gY2h1bmtzLmpvaW4oIlxuIik7Cn0KZnVuY3Rpb24gZmV0Y2hBdHRyaWJ1dGVMb2NhdGlvbnMoZ2wsIHByb2dyYW0pIHsKICBjb25zdCBhdHRyaWJ1dGVzID0ge307CiAgY29uc3QgbiA9IGdsLmdldFByb2dyYW1QYXJhbWV0ZXIocHJvZ3JhbSwgMzU3MjEpOwogIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICBjb25zdCBpbmZvID0gZ2wuZ2V0QWN0aXZlQXR0cmliKHByb2dyYW0sIGkpOwogICAgY29uc3QgbmFtZSA9IGluZm8ubmFtZTsKICAgIGxldCBsb2NhdGlvblNpemUgPSAxOwogICAgaWYgKGluZm8udHlwZSA9PT0gMzU2NzQpCiAgICAgIGxvY2F0aW9uU2l6ZSA9IDI7CiAgICBpZiAoaW5mby50eXBlID09PSAzNTY3NSkKICAgICAgbG9jYXRpb25TaXplID0gMzsKICAgIGlmIChpbmZvLnR5cGUgPT09IDM1Njc2KQogICAgICBsb2NhdGlvblNpemUgPSA0OwogICAgYXR0cmlidXRlc1tuYW1lXSA9IHsKICAgICAgdHlwZTogaW5mby50eXBlLAogICAgICBsb2NhdGlvbjogZ2wuZ2V0QXR0cmliTG9jYXRpb24ocHJvZ3JhbSwgbmFtZSksCiAgICAgIGxvY2F0aW9uU2l6ZQogICAgfTsKICB9CiAgcmV0dXJuIGF0dHJpYnV0ZXM7Cn0KZnVuY3Rpb24gZmlsdGVyRW1wdHlMaW5lKHN0cmluZykgewogIHJldHVybiBzdHJpbmcgIT09ICIiOwp9CmZ1bmN0aW9uIHJlcGxhY2VMaWdodE51bXMoc3RyaW5nLCBwYXJhbWV0ZXJzKSB7CiAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC9OVU1fRElSX0xJR0hUUy9nLCBwYXJhbWV0ZXJzLm51bURpckxpZ2h0cykucmVwbGFjZSgvTlVNX1NQT1RfTElHSFRTL2csIHBhcmFtZXRlcnMubnVtU3BvdExpZ2h0cykucmVwbGFjZSgvTlVNX1JFQ1RfQVJFQV9MSUdIVFMvZywgcGFyYW1ldGVycy5udW1SZWN0QXJlYUxpZ2h0cykucmVwbGFjZSgvTlVNX1BPSU5UX0xJR0hUUy9nLCBwYXJhbWV0ZXJzLm51bVBvaW50TGlnaHRzKS5yZXBsYWNlKC9OVU1fSEVNSV9MSUdIVFMvZywgcGFyYW1ldGVycy5udW1IZW1pTGlnaHRzKS5yZXBsYWNlKC9OVU1fRElSX0xJR0hUX1NIQURPV1MvZywgcGFyYW1ldGVycy5udW1EaXJMaWdodFNoYWRvd3MpLnJlcGxhY2UoL05VTV9TUE9UX0xJR0hUX1NIQURPV1MvZywgcGFyYW1ldGVycy5udW1TcG90TGlnaHRTaGFkb3dzKS5yZXBsYWNlKC9OVU1fUE9JTlRfTElHSFRfU0hBRE9XUy9nLCBwYXJhbWV0ZXJzLm51bVBvaW50TGlnaHRTaGFkb3dzKTsKfQpmdW5jdGlvbiByZXBsYWNlQ2xpcHBpbmdQbGFuZU51bXMoc3RyaW5nLCBwYXJhbWV0ZXJzKSB7CiAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC9OVU1fQ0xJUFBJTkdfUExBTkVTL2csIHBhcmFtZXRlcnMubnVtQ2xpcHBpbmdQbGFuZXMpLnJlcGxhY2UoL1VOSU9OX0NMSVBQSU5HX1BMQU5FUy9nLCBwYXJhbWV0ZXJzLm51bUNsaXBwaW5nUGxhbmVzIC0gcGFyYW1ldGVycy5udW1DbGlwSW50ZXJzZWN0aW9uKTsKfQpjb25zdCBpbmNsdWRlUGF0dGVybiA9IC9eWyBcdF0qI2luY2x1ZGUgKzwoW1x3XGQuL10rKT4vZ207CmZ1bmN0aW9uIHJlc29sdmVJbmNsdWRlcyhzdHJpbmcpIHsKICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoaW5jbHVkZVBhdHRlcm4sIGluY2x1ZGVSZXBsYWNlcik7Cn0KZnVuY3Rpb24gaW5jbHVkZVJlcGxhY2VyKG1hdGNoLCBpbmNsdWRlKSB7CiAgY29uc3Qgc3RyaW5nID0gU2hhZGVyQ2h1bmtbaW5jbHVkZV07CiAgaWYgKHN0cmluZyA9PT0gdm9pZCAwKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoIkNhbiBub3QgcmVzb2x2ZSAjaW5jbHVkZSA8IiArIGluY2x1ZGUgKyAiPiIpOwogIH0KICByZXR1cm4gcmVzb2x2ZUluY2x1ZGVzKHN0cmluZyk7Cn0KY29uc3QgZGVwcmVjYXRlZFVucm9sbExvb3BQYXR0ZXJuID0gLyNwcmFnbWEgdW5yb2xsX2xvb3BbXHNdKz9mb3IgXCggaW50IGkgXD0gKFxkKylcOyBpIDwgKFxkKylcOyBpIFwrXCsgXCkgXHsoW1xzXFNdKz8pKD89XH0pXH0vZzsKY29uc3QgdW5yb2xsTG9vcFBhdHRlcm4gPSAvI3ByYWdtYSB1bnJvbGxfbG9vcF9zdGFydFxzK2ZvclxzKlwoXHMqaW50XHMraVxzKj1ccyooXGQrKVxzKjtccyppXHMqPFxzKihcZCspXHMqO1xzKmlccypcK1wrXHMqXClccyp7KFtcc1xTXSs/KX1ccysjcHJhZ21hIHVucm9sbF9sb29wX2VuZC9nOwpmdW5jdGlvbiB1bnJvbGxMb29wcyhzdHJpbmcpIHsKICByZXR1cm4gc3RyaW5nLnJlcGxhY2UodW5yb2xsTG9vcFBhdHRlcm4sIGxvb3BSZXBsYWNlcikucmVwbGFjZShkZXByZWNhdGVkVW5yb2xsTG9vcFBhdHRlcm4sIGRlcHJlY2F0ZWRMb29wUmVwbGFjZXIpOwp9CmZ1bmN0aW9uIGRlcHJlY2F0ZWRMb29wUmVwbGFjZXIobWF0Y2gsIHN0YXJ0LCBlbmQsIHNuaXBwZXQpIHsKICBjb25zb2xlLndhcm4oIldlYkdMUHJvZ3JhbTogI3ByYWdtYSB1bnJvbGxfbG9vcCBzaGFkZXIgc3ludGF4IGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgI3ByYWdtYSB1bnJvbGxfbG9vcF9zdGFydCBzeW50YXggaW5zdGVhZC4iKTsKICByZXR1cm4gbG9vcFJlcGxhY2VyKG1hdGNoLCBzdGFydCwgZW5kLCBzbmlwcGV0KTsKfQpmdW5jdGlvbiBsb29wUmVwbGFjZXIobWF0Y2gsIHN0YXJ0LCBlbmQsIHNuaXBwZXQpIHsKICBsZXQgc3RyaW5nID0gIiI7CiAgZm9yIChsZXQgaSA9IHBhcnNlSW50KHN0YXJ0KTsgaSA8IHBhcnNlSW50KGVuZCk7IGkrKykgewogICAgc3RyaW5nICs9IHNuaXBwZXQucmVwbGFjZSgvXFtccyppXHMqXF0vZywgIlsgIiArIGkgKyAiIF0iKS5yZXBsYWNlKC9VTlJPTExFRF9MT09QX0lOREVYL2csIGkpOwogIH0KICByZXR1cm4gc3RyaW5nOwp9CmZ1bmN0aW9uIGdlbmVyYXRlUHJlY2lzaW9uKHBhcmFtZXRlcnMpIHsKICBsZXQgcHJlY2lzaW9uc3RyaW5nID0gInByZWNpc2lvbiAiICsgcGFyYW1ldGVycy5wcmVjaXNpb24gKyAiIGZsb2F0O1xucHJlY2lzaW9uICIgKyBwYXJhbWV0ZXJzLnByZWNpc2lvbiArICIgaW50OyI7CiAgaWYgKHBhcmFtZXRlcnMucHJlY2lzaW9uID09PSAiaGlnaHAiKSB7CiAgICBwcmVjaXNpb25zdHJpbmcgKz0gIlxuI2RlZmluZSBISUdIX1BSRUNJU0lPTiI7CiAgfSBlbHNlIGlmIChwYXJhbWV0ZXJzLnByZWNpc2lvbiA9PT0gIm1lZGl1bXAiKSB7CiAgICBwcmVjaXNpb25zdHJpbmcgKz0gIlxuI2RlZmluZSBNRURJVU1fUFJFQ0lTSU9OIjsKICB9IGVsc2UgaWYgKHBhcmFtZXRlcnMucHJlY2lzaW9uID09PSAibG93cCIpIHsKICAgIHByZWNpc2lvbnN0cmluZyArPSAiXG4jZGVmaW5lIExPV19QUkVDSVNJT04iOwogIH0KICByZXR1cm4gcHJlY2lzaW9uc3RyaW5nOwp9CmZ1bmN0aW9uIGdlbmVyYXRlU2hhZG93TWFwVHlwZURlZmluZShwYXJhbWV0ZXJzKSB7CiAgbGV0IHNoYWRvd01hcFR5cGVEZWZpbmUgPSAiU0hBRE9XTUFQX1RZUEVfQkFTSUMiOwogIGlmIChwYXJhbWV0ZXJzLnNoYWRvd01hcFR5cGUgPT09IFBDRlNoYWRvd01hcCkgewogICAgc2hhZG93TWFwVHlwZURlZmluZSA9ICJTSEFET1dNQVBfVFlQRV9QQ0YiOwogIH0gZWxzZSBpZiAocGFyYW1ldGVycy5zaGFkb3dNYXBUeXBlID09PSBQQ0ZTb2Z0U2hhZG93TWFwKSB7CiAgICBzaGFkb3dNYXBUeXBlRGVmaW5lID0gIlNIQURPV01BUF9UWVBFX1BDRl9TT0ZUIjsKICB9IGVsc2UgaWYgKHBhcmFtZXRlcnMuc2hhZG93TWFwVHlwZSA9PT0gVlNNU2hhZG93TWFwKSB7CiAgICBzaGFkb3dNYXBUeXBlRGVmaW5lID0gIlNIQURPV01BUF9UWVBFX1ZTTSI7CiAgfQogIHJldHVybiBzaGFkb3dNYXBUeXBlRGVmaW5lOwp9CmZ1bmN0aW9uIGdlbmVyYXRlRW52TWFwVHlwZURlZmluZShwYXJhbWV0ZXJzKSB7CiAgbGV0IGVudk1hcFR5cGVEZWZpbmUgPSAiRU5WTUFQX1RZUEVfQ1VCRSI7CiAgaWYgKHBhcmFtZXRlcnMuZW52TWFwKSB7CiAgICBzd2l0Y2ggKHBhcmFtZXRlcnMuZW52TWFwTW9kZSkgewogICAgICBjYXNlIEN1YmVSZWZsZWN0aW9uTWFwcGluZzoKICAgICAgY2FzZSBDdWJlUmVmcmFjdGlvbk1hcHBpbmc6CiAgICAgICAgZW52TWFwVHlwZURlZmluZSA9ICJFTlZNQVBfVFlQRV9DVUJFIjsKICAgICAgICBicmVhazsKICAgICAgY2FzZSBDdWJlVVZSZWZsZWN0aW9uTWFwcGluZzoKICAgICAgY2FzZSBDdWJlVVZSZWZyYWN0aW9uTWFwcGluZzoKICAgICAgICBlbnZNYXBUeXBlRGVmaW5lID0gIkVOVk1BUF9UWVBFX0NVQkVfVVYiOwogICAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gZW52TWFwVHlwZURlZmluZTsKfQpmdW5jdGlvbiBnZW5lcmF0ZUVudk1hcE1vZGVEZWZpbmUocGFyYW1ldGVycykgewogIGxldCBlbnZNYXBNb2RlRGVmaW5lID0gIkVOVk1BUF9NT0RFX1JFRkxFQ1RJT04iOwogIGlmIChwYXJhbWV0ZXJzLmVudk1hcCkgewogICAgc3dpdGNoIChwYXJhbWV0ZXJzLmVudk1hcE1vZGUpIHsKICAgICAgY2FzZSBDdWJlUmVmcmFjdGlvbk1hcHBpbmc6CiAgICAgIGNhc2UgQ3ViZVVWUmVmcmFjdGlvbk1hcHBpbmc6CiAgICAgICAgZW52TWFwTW9kZURlZmluZSA9ICJFTlZNQVBfTU9ERV9SRUZSQUNUSU9OIjsKICAgICAgICBicmVhazsKICAgIH0KICB9CiAgcmV0dXJuIGVudk1hcE1vZGVEZWZpbmU7Cn0KZnVuY3Rpb24gZ2VuZXJhdGVFbnZNYXBCbGVuZGluZ0RlZmluZShwYXJhbWV0ZXJzKSB7CiAgbGV0IGVudk1hcEJsZW5kaW5nRGVmaW5lID0gIkVOVk1BUF9CTEVORElOR19OT05FIjsKICBpZiAocGFyYW1ldGVycy5lbnZNYXApIHsKICAgIHN3aXRjaCAocGFyYW1ldGVycy5jb21iaW5lKSB7CiAgICAgIGNhc2UgTXVsdGlwbHlPcGVyYXRpb246CiAgICAgICAgZW52TWFwQmxlbmRpbmdEZWZpbmUgPSAiRU5WTUFQX0JMRU5ESU5HX01VTFRJUExZIjsKICAgICAgICBicmVhazsKICAgICAgY2FzZSBNaXhPcGVyYXRpb246CiAgICAgICAgZW52TWFwQmxlbmRpbmdEZWZpbmUgPSAiRU5WTUFQX0JMRU5ESU5HX01JWCI7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgQWRkT3BlcmF0aW9uOgogICAgICAgIGVudk1hcEJsZW5kaW5nRGVmaW5lID0gIkVOVk1BUF9CTEVORElOR19BREQiOwogICAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gZW52TWFwQmxlbmRpbmdEZWZpbmU7Cn0KZnVuY3Rpb24gV2ViR0xQcm9ncmFtKHJlbmRlcmVyLCBjYWNoZUtleSwgcGFyYW1ldGVycywgYmluZGluZ1N0YXRlcykgewogIGNvbnN0IGdsID0gcmVuZGVyZXIuZ2V0Q29udGV4dCgpOwogIGNvbnN0IGRlZmluZXMgPSBwYXJhbWV0ZXJzLmRlZmluZXM7CiAgbGV0IHZlcnRleFNoYWRlciA9IHBhcmFtZXRlcnMudmVydGV4U2hhZGVyOwogIGxldCBmcmFnbWVudFNoYWRlciA9IHBhcmFtZXRlcnMuZnJhZ21lbnRTaGFkZXI7CiAgY29uc3Qgc2hhZG93TWFwVHlwZURlZmluZSA9IGdlbmVyYXRlU2hhZG93TWFwVHlwZURlZmluZShwYXJhbWV0ZXJzKTsKICBjb25zdCBlbnZNYXBUeXBlRGVmaW5lID0gZ2VuZXJhdGVFbnZNYXBUeXBlRGVmaW5lKHBhcmFtZXRlcnMpOwogIGNvbnN0IGVudk1hcE1vZGVEZWZpbmUgPSBnZW5lcmF0ZUVudk1hcE1vZGVEZWZpbmUocGFyYW1ldGVycyk7CiAgY29uc3QgZW52TWFwQmxlbmRpbmdEZWZpbmUgPSBnZW5lcmF0ZUVudk1hcEJsZW5kaW5nRGVmaW5lKHBhcmFtZXRlcnMpOwogIGNvbnN0IGN1c3RvbUV4dGVuc2lvbnMgPSBwYXJhbWV0ZXJzLmlzV2ViR0wyID8gIiIgOiBnZW5lcmF0ZUV4dGVuc2lvbnMocGFyYW1ldGVycyk7CiAgY29uc3QgY3VzdG9tRGVmaW5lcyA9IGdlbmVyYXRlRGVmaW5lcyhkZWZpbmVzKTsKICBjb25zdCBwcm9ncmFtID0gZ2wuY3JlYXRlUHJvZ3JhbSgpOwogIGxldCBwcmVmaXhWZXJ0ZXgsIHByZWZpeEZyYWdtZW50OwogIGxldCB2ZXJzaW9uU3RyaW5nID0gcGFyYW1ldGVycy5nbHNsVmVyc2lvbiA/ICIjdmVyc2lvbiAiICsgcGFyYW1ldGVycy5nbHNsVmVyc2lvbiArICJcbiIgOiAiIjsKICBpZiAocGFyYW1ldGVycy5pc1Jhd1NoYWRlck1hdGVyaWFsKSB7CiAgICBwcmVmaXhWZXJ0ZXggPSBbCiAgICAgIGN1c3RvbURlZmluZXMKICAgIF0uZmlsdGVyKGZpbHRlckVtcHR5TGluZSkuam9pbigiXG4iKTsKICAgIGlmIChwcmVmaXhWZXJ0ZXgubGVuZ3RoID4gMCkgewogICAgICBwcmVmaXhWZXJ0ZXggKz0gIlxuIjsKICAgIH0KICAgIHByZWZpeEZyYWdtZW50ID0gWwogICAgICBjdXN0b21FeHRlbnNpb25zLAogICAgICBjdXN0b21EZWZpbmVzCiAgICBdLmZpbHRlcihmaWx0ZXJFbXB0eUxpbmUpLmpvaW4oIlxuIik7CiAgICBpZiAocHJlZml4RnJhZ21lbnQubGVuZ3RoID4gMCkgewogICAgICBwcmVmaXhGcmFnbWVudCArPSAiXG4iOwogICAgfQogIH0gZWxzZSB7CiAgICBwcmVmaXhWZXJ0ZXggPSBbCiAgICAgIGdlbmVyYXRlUHJlY2lzaW9uKHBhcmFtZXRlcnMpLAogICAgICAiI2RlZmluZSBTSEFERVJfTkFNRSAiICsgcGFyYW1ldGVycy5zaGFkZXJOYW1lLAogICAgICBjdXN0b21EZWZpbmVzLAogICAgICBwYXJhbWV0ZXJzLmluc3RhbmNpbmcgPyAiI2RlZmluZSBVU0VfSU5TVEFOQ0lORyIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5pbnN0YW5jaW5nQ29sb3IgPyAiI2RlZmluZSBVU0VfSU5TVEFOQ0lOR19DT0xPUiIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5zdXBwb3J0c1ZlcnRleFRleHR1cmVzID8gIiNkZWZpbmUgVkVSVEVYX1RFWFRVUkVTIiA6ICIiLAogICAgICAiI2RlZmluZSBNQVhfQk9ORVMgIiArIHBhcmFtZXRlcnMubWF4Qm9uZXMsCiAgICAgIHBhcmFtZXRlcnMudXNlRm9nICYmIHBhcmFtZXRlcnMuZm9nID8gIiNkZWZpbmUgVVNFX0ZPRyIgOiAiIiwKICAgICAgcGFyYW1ldGVycy51c2VGb2cgJiYgcGFyYW1ldGVycy5mb2dFeHAyID8gIiNkZWZpbmUgRk9HX0VYUDIiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMubWFwID8gIiNkZWZpbmUgVVNFX01BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5lbnZNYXAgPyAiI2RlZmluZSBVU0VfRU5WTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLmVudk1hcCA/ICIjZGVmaW5lICIgKyBlbnZNYXBNb2RlRGVmaW5lIDogIiIsCiAgICAgIHBhcmFtZXRlcnMubGlnaHRNYXAgPyAiI2RlZmluZSBVU0VfTElHSFRNQVAiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMuYW9NYXAgPyAiI2RlZmluZSBVU0VfQU9NQVAiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMuZW1pc3NpdmVNYXAgPyAiI2RlZmluZSBVU0VfRU1JU1NJVkVNQVAiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMuYnVtcE1hcCA/ICIjZGVmaW5lIFVTRV9CVU1QTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLm5vcm1hbE1hcCA/ICIjZGVmaW5lIFVTRV9OT1JNQUxNQVAiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMubm9ybWFsTWFwICYmIHBhcmFtZXRlcnMub2JqZWN0U3BhY2VOb3JtYWxNYXAgPyAiI2RlZmluZSBPQkpFQ1RTUEFDRV9OT1JNQUxNQVAiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMubm9ybWFsTWFwICYmIHBhcmFtZXRlcnMudGFuZ2VudFNwYWNlTm9ybWFsTWFwID8gIiNkZWZpbmUgVEFOR0VOVFNQQUNFX05PUk1BTE1BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5jbGVhcmNvYXRNYXAgPyAiI2RlZmluZSBVU0VfQ0xFQVJDT0FUTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLmNsZWFyY29hdFJvdWdobmVzc01hcCA/ICIjZGVmaW5lIFVTRV9DTEVBUkNPQVRfUk9VR0hORVNTTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLmNsZWFyY29hdE5vcm1hbE1hcCA/ICIjZGVmaW5lIFVTRV9DTEVBUkNPQVRfTk9STUFMTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLmRpc3BsYWNlbWVudE1hcCAmJiBwYXJhbWV0ZXJzLnN1cHBvcnRzVmVydGV4VGV4dHVyZXMgPyAiI2RlZmluZSBVU0VfRElTUExBQ0VNRU5UTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnNwZWN1bGFyTWFwID8gIiNkZWZpbmUgVVNFX1NQRUNVTEFSTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnNwZWN1bGFySW50ZW5zaXR5TWFwID8gIiNkZWZpbmUgVVNFX1NQRUNVTEFSSU5URU5TSVRZTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnNwZWN1bGFyQ29sb3JNYXAgPyAiI2RlZmluZSBVU0VfU1BFQ1VMQVJDT0xPUk1BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5yb3VnaG5lc3NNYXAgPyAiI2RlZmluZSBVU0VfUk9VR0hORVNTTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLm1ldGFsbmVzc01hcCA/ICIjZGVmaW5lIFVTRV9NRVRBTE5FU1NNQVAiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMuYWxwaGFNYXAgPyAiI2RlZmluZSBVU0VfQUxQSEFNQVAiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMudHJhbnNtaXNzaW9uID8gIiNkZWZpbmUgVVNFX1RSQU5TTUlTU0lPTiIgOiAiIiwKICAgICAgcGFyYW1ldGVycy50cmFuc21pc3Npb25NYXAgPyAiI2RlZmluZSBVU0VfVFJBTlNNSVNTSU9OTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnRoaWNrbmVzc01hcCA/ICIjZGVmaW5lIFVTRV9USElDS05FU1NNQVAiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMuc2hlZW5Db2xvck1hcCA/ICIjZGVmaW5lIFVTRV9TSEVFTkNPTE9STUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnNoZWVuUm91Z2huZXNzTWFwID8gIiNkZWZpbmUgVVNFX1NIRUVOUk9VR0hORVNTTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnZlcnRleFRhbmdlbnRzID8gIiNkZWZpbmUgVVNFX1RBTkdFTlQiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMudmVydGV4Q29sb3JzID8gIiNkZWZpbmUgVVNFX0NPTE9SIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnZlcnRleEFscGhhcyA/ICIjZGVmaW5lIFVTRV9DT0xPUl9BTFBIQSIgOiAiIiwKICAgICAgcGFyYW1ldGVycy52ZXJ0ZXhVdnMgPyAiI2RlZmluZSBVU0VfVVYiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMudXZzVmVydGV4T25seSA/ICIjZGVmaW5lIFVWU19WRVJURVhfT05MWSIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5mbGF0U2hhZGluZyA/ICIjZGVmaW5lIEZMQVRfU0hBREVEIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnNraW5uaW5nID8gIiNkZWZpbmUgVVNFX1NLSU5OSU5HIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnVzZVZlcnRleFRleHR1cmUgPyAiI2RlZmluZSBCT05FX1RFWFRVUkUiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMubW9ycGhUYXJnZXRzID8gIiNkZWZpbmUgVVNFX01PUlBIVEFSR0VUUyIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5tb3JwaE5vcm1hbHMgJiYgcGFyYW1ldGVycy5mbGF0U2hhZGluZyA9PT0gZmFsc2UgPyAiI2RlZmluZSBVU0VfTU9SUEhOT1JNQUxTIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLm1vcnBoVGFyZ2V0cyAmJiBwYXJhbWV0ZXJzLmlzV2ViR0wyID8gIiNkZWZpbmUgTU9SUEhUQVJHRVRTX1RFWFRVUkUiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMubW9ycGhUYXJnZXRzICYmIHBhcmFtZXRlcnMuaXNXZWJHTDIgPyAiI2RlZmluZSBNT1JQSFRBUkdFVFNfQ09VTlQgIiArIHBhcmFtZXRlcnMubW9ycGhUYXJnZXRzQ291bnQgOiAiIiwKICAgICAgcGFyYW1ldGVycy5kb3VibGVTaWRlZCA/ICIjZGVmaW5lIERPVUJMRV9TSURFRCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5mbGlwU2lkZWQgPyAiI2RlZmluZSBGTElQX1NJREVEIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnNoYWRvd01hcEVuYWJsZWQgPyAiI2RlZmluZSBVU0VfU0hBRE9XTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnNoYWRvd01hcEVuYWJsZWQgPyAiI2RlZmluZSAiICsgc2hhZG93TWFwVHlwZURlZmluZSA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnNpemVBdHRlbnVhdGlvbiA/ICIjZGVmaW5lIFVTRV9TSVpFQVRURU5VQVRJT04iIDogIiIsCiAgICAgIHBhcmFtZXRlcnMubG9nYXJpdGhtaWNEZXB0aEJ1ZmZlciA/ICIjZGVmaW5lIFVTRV9MT0dERVBUSEJVRiIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5sb2dhcml0aG1pY0RlcHRoQnVmZmVyICYmIHBhcmFtZXRlcnMucmVuZGVyZXJFeHRlbnNpb25GcmFnRGVwdGggPyAiI2RlZmluZSBVU0VfTE9HREVQVEhCVUZfRVhUIiA6ICIiLAogICAgICAidW5pZm9ybSBtYXQ0IG1vZGVsTWF0cml4OyIsCiAgICAgICJ1bmlmb3JtIG1hdDQgbW9kZWxWaWV3TWF0cml4OyIsCiAgICAgICJ1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsiLAogICAgICAidW5pZm9ybSBtYXQ0IHZpZXdNYXRyaXg7IiwKICAgICAgInVuaWZvcm0gbWF0MyBub3JtYWxNYXRyaXg7IiwKICAgICAgInVuaWZvcm0gdmVjMyBjYW1lcmFQb3NpdGlvbjsiLAogICAgICAidW5pZm9ybSBib29sIGlzT3J0aG9ncmFwaGljOyIsCiAgICAgICIjaWZkZWYgVVNFX0lOU1RBTkNJTkciLAogICAgICAiCWF0dHJpYnV0ZSBtYXQ0IGluc3RhbmNlTWF0cml4OyIsCiAgICAgICIjZW5kaWYiLAogICAgICAiI2lmZGVmIFVTRV9JTlNUQU5DSU5HX0NPTE9SIiwKICAgICAgIglhdHRyaWJ1dGUgdmVjMyBpbnN0YW5jZUNvbG9yOyIsCiAgICAgICIjZW5kaWYiLAogICAgICAiYXR0cmlidXRlIHZlYzMgcG9zaXRpb247IiwKICAgICAgImF0dHJpYnV0ZSB2ZWMzIG5vcm1hbDsiLAogICAgICAiYXR0cmlidXRlIHZlYzIgdXY7IiwKICAgICAgIiNpZmRlZiBVU0VfVEFOR0VOVCIsCiAgICAgICIJYXR0cmlidXRlIHZlYzQgdGFuZ2VudDsiLAogICAgICAiI2VuZGlmIiwKICAgICAgIiNpZiBkZWZpbmVkKCBVU0VfQ09MT1JfQUxQSEEgKSIsCiAgICAgICIJYXR0cmlidXRlIHZlYzQgY29sb3I7IiwKICAgICAgIiNlbGlmIGRlZmluZWQoIFVTRV9DT0xPUiApIiwKICAgICAgIglhdHRyaWJ1dGUgdmVjMyBjb2xvcjsiLAogICAgICAiI2VuZGlmIiwKICAgICAgIiNpZiAoIGRlZmluZWQoIFVTRV9NT1JQSFRBUkdFVFMgKSAmJiAhIGRlZmluZWQoIE1PUlBIVEFSR0VUU19URVhUVVJFICkgKSIsCiAgICAgICIJYXR0cmlidXRlIHZlYzMgbW9ycGhUYXJnZXQwOyIsCiAgICAgICIJYXR0cmlidXRlIHZlYzMgbW9ycGhUYXJnZXQxOyIsCiAgICAgICIJYXR0cmlidXRlIHZlYzMgbW9ycGhUYXJnZXQyOyIsCiAgICAgICIJYXR0cmlidXRlIHZlYzMgbW9ycGhUYXJnZXQzOyIsCiAgICAgICIJI2lmZGVmIFVTRV9NT1JQSE5PUk1BTFMiLAogICAgICAiCQlhdHRyaWJ1dGUgdmVjMyBtb3JwaE5vcm1hbDA7IiwKICAgICAgIgkJYXR0cmlidXRlIHZlYzMgbW9ycGhOb3JtYWwxOyIsCiAgICAgICIJCWF0dHJpYnV0ZSB2ZWMzIG1vcnBoTm9ybWFsMjsiLAogICAgICAiCQlhdHRyaWJ1dGUgdmVjMyBtb3JwaE5vcm1hbDM7IiwKICAgICAgIgkjZWxzZSIsCiAgICAgICIJCWF0dHJpYnV0ZSB2ZWMzIG1vcnBoVGFyZ2V0NDsiLAogICAgICAiCQlhdHRyaWJ1dGUgdmVjMyBtb3JwaFRhcmdldDU7IiwKICAgICAgIgkJYXR0cmlidXRlIHZlYzMgbW9ycGhUYXJnZXQ2OyIsCiAgICAgICIJCWF0dHJpYnV0ZSB2ZWMzIG1vcnBoVGFyZ2V0NzsiLAogICAgICAiCSNlbmRpZiIsCiAgICAgICIjZW5kaWYiLAogICAgICAiI2lmZGVmIFVTRV9TS0lOTklORyIsCiAgICAgICIJYXR0cmlidXRlIHZlYzQgc2tpbkluZGV4OyIsCiAgICAgICIJYXR0cmlidXRlIHZlYzQgc2tpbldlaWdodDsiLAogICAgICAiI2VuZGlmIiwKICAgICAgIlxuIgogICAgXS5maWx0ZXIoZmlsdGVyRW1wdHlMaW5lKS5qb2luKCJcbiIpOwogICAgcHJlZml4RnJhZ21lbnQgPSBbCiAgICAgIGN1c3RvbUV4dGVuc2lvbnMsCiAgICAgIGdlbmVyYXRlUHJlY2lzaW9uKHBhcmFtZXRlcnMpLAogICAgICAiI2RlZmluZSBTSEFERVJfTkFNRSAiICsgcGFyYW1ldGVycy5zaGFkZXJOYW1lLAogICAgICBjdXN0b21EZWZpbmVzLAogICAgICBwYXJhbWV0ZXJzLnVzZUZvZyAmJiBwYXJhbWV0ZXJzLmZvZyA/ICIjZGVmaW5lIFVTRV9GT0ciIDogIiIsCiAgICAgIHBhcmFtZXRlcnMudXNlRm9nICYmIHBhcmFtZXRlcnMuZm9nRXhwMiA/ICIjZGVmaW5lIEZPR19FWFAyIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLm1hcCA/ICIjZGVmaW5lIFVTRV9NQVAiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMubWF0Y2FwID8gIiNkZWZpbmUgVVNFX01BVENBUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5lbnZNYXAgPyAiI2RlZmluZSBVU0VfRU5WTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLmVudk1hcCA/ICIjZGVmaW5lICIgKyBlbnZNYXBUeXBlRGVmaW5lIDogIiIsCiAgICAgIHBhcmFtZXRlcnMuZW52TWFwID8gIiNkZWZpbmUgIiArIGVudk1hcE1vZGVEZWZpbmUgOiAiIiwKICAgICAgcGFyYW1ldGVycy5lbnZNYXAgPyAiI2RlZmluZSAiICsgZW52TWFwQmxlbmRpbmdEZWZpbmUgOiAiIiwKICAgICAgcGFyYW1ldGVycy5saWdodE1hcCA/ICIjZGVmaW5lIFVTRV9MSUdIVE1BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5hb01hcCA/ICIjZGVmaW5lIFVTRV9BT01BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5lbWlzc2l2ZU1hcCA/ICIjZGVmaW5lIFVTRV9FTUlTU0lWRU1BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5idW1wTWFwID8gIiNkZWZpbmUgVVNFX0JVTVBNQVAiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMubm9ybWFsTWFwID8gIiNkZWZpbmUgVVNFX05PUk1BTE1BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5ub3JtYWxNYXAgJiYgcGFyYW1ldGVycy5vYmplY3RTcGFjZU5vcm1hbE1hcCA/ICIjZGVmaW5lIE9CSkVDVFNQQUNFX05PUk1BTE1BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5ub3JtYWxNYXAgJiYgcGFyYW1ldGVycy50YW5nZW50U3BhY2VOb3JtYWxNYXAgPyAiI2RlZmluZSBUQU5HRU5UU1BBQ0VfTk9STUFMTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLmNsZWFyY29hdCA/ICIjZGVmaW5lIFVTRV9DTEVBUkNPQVQiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMuY2xlYXJjb2F0TWFwID8gIiNkZWZpbmUgVVNFX0NMRUFSQ09BVE1BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5jbGVhcmNvYXRSb3VnaG5lc3NNYXAgPyAiI2RlZmluZSBVU0VfQ0xFQVJDT0FUX1JPVUdITkVTU01BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5jbGVhcmNvYXROb3JtYWxNYXAgPyAiI2RlZmluZSBVU0VfQ0xFQVJDT0FUX05PUk1BTE1BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5zcGVjdWxhck1hcCA/ICIjZGVmaW5lIFVTRV9TUEVDVUxBUk1BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5zcGVjdWxhckludGVuc2l0eU1hcCA/ICIjZGVmaW5lIFVTRV9TUEVDVUxBUklOVEVOU0lUWU1BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5zcGVjdWxhckNvbG9yTWFwID8gIiNkZWZpbmUgVVNFX1NQRUNVTEFSQ09MT1JNQVAiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMucm91Z2huZXNzTWFwID8gIiNkZWZpbmUgVVNFX1JPVUdITkVTU01BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5tZXRhbG5lc3NNYXAgPyAiI2RlZmluZSBVU0VfTUVUQUxORVNTTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLmFscGhhTWFwID8gIiNkZWZpbmUgVVNFX0FMUEhBTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLmFscGhhVGVzdCA/ICIjZGVmaW5lIFVTRV9BTFBIQVRFU1QiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMuc2hlZW4gPyAiI2RlZmluZSBVU0VfU0hFRU4iIDogIiIsCiAgICAgIHBhcmFtZXRlcnMuc2hlZW5Db2xvck1hcCA/ICIjZGVmaW5lIFVTRV9TSEVFTkNPTE9STUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnNoZWVuUm91Z2huZXNzTWFwID8gIiNkZWZpbmUgVVNFX1NIRUVOUk9VR0hORVNTTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnRyYW5zbWlzc2lvbiA/ICIjZGVmaW5lIFVTRV9UUkFOU01JU1NJT04iIDogIiIsCiAgICAgIHBhcmFtZXRlcnMudHJhbnNtaXNzaW9uTWFwID8gIiNkZWZpbmUgVVNFX1RSQU5TTUlTU0lPTk1BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy50aGlja25lc3NNYXAgPyAiI2RlZmluZSBVU0VfVEhJQ0tORVNTTUFQIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLmRlY29kZVZpZGVvVGV4dHVyZSA/ICIjZGVmaW5lIERFQ09ERV9WSURFT19URVhUVVJFIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnZlcnRleFRhbmdlbnRzID8gIiNkZWZpbmUgVVNFX1RBTkdFTlQiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMudmVydGV4Q29sb3JzIHx8IHBhcmFtZXRlcnMuaW5zdGFuY2luZ0NvbG9yID8gIiNkZWZpbmUgVVNFX0NPTE9SIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnZlcnRleEFscGhhcyA/ICIjZGVmaW5lIFVTRV9DT0xPUl9BTFBIQSIgOiAiIiwKICAgICAgcGFyYW1ldGVycy52ZXJ0ZXhVdnMgPyAiI2RlZmluZSBVU0VfVVYiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMudXZzVmVydGV4T25seSA/ICIjZGVmaW5lIFVWU19WRVJURVhfT05MWSIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5ncmFkaWVudE1hcCA/ICIjZGVmaW5lIFVTRV9HUkFESUVOVE1BUCIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5mbGF0U2hhZGluZyA/ICIjZGVmaW5lIEZMQVRfU0hBREVEIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLmRvdWJsZVNpZGVkID8gIiNkZWZpbmUgRE9VQkxFX1NJREVEIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLmZsaXBTaWRlZCA/ICIjZGVmaW5lIEZMSVBfU0lERUQiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMuc2hhZG93TWFwRW5hYmxlZCA/ICIjZGVmaW5lIFVTRV9TSEFET1dNQVAiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMuc2hhZG93TWFwRW5hYmxlZCA/ICIjZGVmaW5lICIgKyBzaGFkb3dNYXBUeXBlRGVmaW5lIDogIiIsCiAgICAgIHBhcmFtZXRlcnMucHJlbXVsdGlwbGllZEFscGhhID8gIiNkZWZpbmUgUFJFTVVMVElQTElFRF9BTFBIQSIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5waHlzaWNhbGx5Q29ycmVjdExpZ2h0cyA/ICIjZGVmaW5lIFBIWVNJQ0FMTFlfQ09SUkVDVF9MSUdIVFMiIDogIiIsCiAgICAgIHBhcmFtZXRlcnMubG9nYXJpdGhtaWNEZXB0aEJ1ZmZlciA/ICIjZGVmaW5lIFVTRV9MT0dERVBUSEJVRiIgOiAiIiwKICAgICAgcGFyYW1ldGVycy5sb2dhcml0aG1pY0RlcHRoQnVmZmVyICYmIHBhcmFtZXRlcnMucmVuZGVyZXJFeHRlbnNpb25GcmFnRGVwdGggPyAiI2RlZmluZSBVU0VfTE9HREVQVEhCVUZfRVhUIiA6ICIiLAogICAgICAocGFyYW1ldGVycy5leHRlbnNpb25TaGFkZXJUZXh0dXJlTE9EIHx8IHBhcmFtZXRlcnMuZW52TWFwKSAmJiBwYXJhbWV0ZXJzLnJlbmRlcmVyRXh0ZW5zaW9uU2hhZGVyVGV4dHVyZUxvZCA/ICIjZGVmaW5lIFRFWFRVUkVfTE9EX0VYVCIgOiAiIiwKICAgICAgInVuaWZvcm0gbWF0NCB2aWV3TWF0cml4OyIsCiAgICAgICJ1bmlmb3JtIHZlYzMgY2FtZXJhUG9zaXRpb247IiwKICAgICAgInVuaWZvcm0gYm9vbCBpc09ydGhvZ3JhcGhpYzsiLAogICAgICBwYXJhbWV0ZXJzLnRvbmVNYXBwaW5nICE9PSBOb1RvbmVNYXBwaW5nID8gIiNkZWZpbmUgVE9ORV9NQVBQSU5HIiA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnRvbmVNYXBwaW5nICE9PSBOb1RvbmVNYXBwaW5nID8gU2hhZGVyQ2h1bmtbInRvbmVtYXBwaW5nX3BhcnNfZnJhZ21lbnQiXSA6ICIiLAogICAgICBwYXJhbWV0ZXJzLnRvbmVNYXBwaW5nICE9PSBOb1RvbmVNYXBwaW5nID8gZ2V0VG9uZU1hcHBpbmdGdW5jdGlvbigidG9uZU1hcHBpbmciLCBwYXJhbWV0ZXJzLnRvbmVNYXBwaW5nKSA6ICIiLAogICAgICBwYXJhbWV0ZXJzLmRpdGhlcmluZyA/ICIjZGVmaW5lIERJVEhFUklORyIgOiAiIiwKICAgICAgcGFyYW1ldGVycy50cmFuc3BhcmVudCA/ICIiIDogIiNkZWZpbmUgT1BBUVVFIiwKICAgICAgU2hhZGVyQ2h1bmtbImVuY29kaW5nc19wYXJzX2ZyYWdtZW50Il0sCiAgICAgIGdldFRleGVsRW5jb2RpbmdGdW5jdGlvbigibGluZWFyVG9PdXRwdXRUZXhlbCIsIHBhcmFtZXRlcnMub3V0cHV0RW5jb2RpbmcpLAogICAgICBwYXJhbWV0ZXJzLmRlcHRoUGFja2luZyA/ICIjZGVmaW5lIERFUFRIX1BBQ0tJTkcgIiArIHBhcmFtZXRlcnMuZGVwdGhQYWNraW5nIDogIiIsCiAgICAgICJcbiIKICAgIF0uZmlsdGVyKGZpbHRlckVtcHR5TGluZSkuam9pbigiXG4iKTsKICB9CiAgdmVydGV4U2hhZGVyID0gcmVzb2x2ZUluY2x1ZGVzKHZlcnRleFNoYWRlcik7CiAgdmVydGV4U2hhZGVyID0gcmVwbGFjZUxpZ2h0TnVtcyh2ZXJ0ZXhTaGFkZXIsIHBhcmFtZXRlcnMpOwogIHZlcnRleFNoYWRlciA9IHJlcGxhY2VDbGlwcGluZ1BsYW5lTnVtcyh2ZXJ0ZXhTaGFkZXIsIHBhcmFtZXRlcnMpOwogIGZyYWdtZW50U2hhZGVyID0gcmVzb2x2ZUluY2x1ZGVzKGZyYWdtZW50U2hhZGVyKTsKICBmcmFnbWVudFNoYWRlciA9IHJlcGxhY2VMaWdodE51bXMoZnJhZ21lbnRTaGFkZXIsIHBhcmFtZXRlcnMpOwogIGZyYWdtZW50U2hhZGVyID0gcmVwbGFjZUNsaXBwaW5nUGxhbmVOdW1zKGZyYWdtZW50U2hhZGVyLCBwYXJhbWV0ZXJzKTsKICB2ZXJ0ZXhTaGFkZXIgPSB1bnJvbGxMb29wcyh2ZXJ0ZXhTaGFkZXIpOwogIGZyYWdtZW50U2hhZGVyID0gdW5yb2xsTG9vcHMoZnJhZ21lbnRTaGFkZXIpOwogIGlmIChwYXJhbWV0ZXJzLmlzV2ViR0wyICYmIHBhcmFtZXRlcnMuaXNSYXdTaGFkZXJNYXRlcmlhbCAhPT0gdHJ1ZSkgewogICAgdmVyc2lvblN0cmluZyA9ICIjdmVyc2lvbiAzMDAgZXNcbiI7CiAgICBwcmVmaXhWZXJ0ZXggPSBbCiAgICAgICJwcmVjaXNpb24gbWVkaXVtcCBzYW1wbGVyMkRBcnJheTsiLAogICAgICAiI2RlZmluZSBhdHRyaWJ1dGUgaW4iLAogICAgICAiI2RlZmluZSB2YXJ5aW5nIG91dCIsCiAgICAgICIjZGVmaW5lIHRleHR1cmUyRCB0ZXh0dXJlIgogICAgXS5qb2luKCJcbiIpICsgIlxuIiArIHByZWZpeFZlcnRleDsKICAgIHByZWZpeEZyYWdtZW50ID0gWwogICAgICAiI2RlZmluZSB2YXJ5aW5nIGluIiwKICAgICAgcGFyYW1ldGVycy5nbHNsVmVyc2lvbiA9PT0gR0xTTDMgPyAiIiA6ICJsYXlvdXQobG9jYXRpb24gPSAwKSBvdXQgaGlnaHAgdmVjNCBwY19mcmFnQ29sb3I7IiwKICAgICAgcGFyYW1ldGVycy5nbHNsVmVyc2lvbiA9PT0gR0xTTDMgPyAiIiA6ICIjZGVmaW5lIGdsX0ZyYWdDb2xvciBwY19mcmFnQ29sb3IiLAogICAgICAiI2RlZmluZSBnbF9GcmFnRGVwdGhFWFQgZ2xfRnJhZ0RlcHRoIiwKICAgICAgIiNkZWZpbmUgdGV4dHVyZTJEIHRleHR1cmUiLAogICAgICAiI2RlZmluZSB0ZXh0dXJlQ3ViZSB0ZXh0dXJlIiwKICAgICAgIiNkZWZpbmUgdGV4dHVyZTJEUHJvaiB0ZXh0dXJlUHJvaiIsCiAgICAgICIjZGVmaW5lIHRleHR1cmUyRExvZEVYVCB0ZXh0dXJlTG9kIiwKICAgICAgIiNkZWZpbmUgdGV4dHVyZTJEUHJvakxvZEVYVCB0ZXh0dXJlUHJvakxvZCIsCiAgICAgICIjZGVmaW5lIHRleHR1cmVDdWJlTG9kRVhUIHRleHR1cmVMb2QiLAogICAgICAiI2RlZmluZSB0ZXh0dXJlMkRHcmFkRVhUIHRleHR1cmVHcmFkIiwKICAgICAgIiNkZWZpbmUgdGV4dHVyZTJEUHJvakdyYWRFWFQgdGV4dHVyZVByb2pHcmFkIiwKICAgICAgIiNkZWZpbmUgdGV4dHVyZUN1YmVHcmFkRVhUIHRleHR1cmVHcmFkIgogICAgXS5qb2luKCJcbiIpICsgIlxuIiArIHByZWZpeEZyYWdtZW50OwogIH0KICBjb25zdCB2ZXJ0ZXhHbHNsID0gdmVyc2lvblN0cmluZyArIHByZWZpeFZlcnRleCArIHZlcnRleFNoYWRlcjsKICBjb25zdCBmcmFnbWVudEdsc2wgPSB2ZXJzaW9uU3RyaW5nICsgcHJlZml4RnJhZ21lbnQgKyBmcmFnbWVudFNoYWRlcjsKICBjb25zdCBnbFZlcnRleFNoYWRlciA9IFdlYkdMU2hhZGVyKGdsLCAzNTYzMywgdmVydGV4R2xzbCk7CiAgY29uc3QgZ2xGcmFnbWVudFNoYWRlciA9IFdlYkdMU2hhZGVyKGdsLCAzNTYzMiwgZnJhZ21lbnRHbHNsKTsKICBnbC5hdHRhY2hTaGFkZXIocHJvZ3JhbSwgZ2xWZXJ0ZXhTaGFkZXIpOwogIGdsLmF0dGFjaFNoYWRlcihwcm9ncmFtLCBnbEZyYWdtZW50U2hhZGVyKTsKICBpZiAocGFyYW1ldGVycy5pbmRleDBBdHRyaWJ1dGVOYW1lICE9PSB2b2lkIDApIHsKICAgIGdsLmJpbmRBdHRyaWJMb2NhdGlvbihwcm9ncmFtLCAwLCBwYXJhbWV0ZXJzLmluZGV4MEF0dHJpYnV0ZU5hbWUpOwogIH0gZWxzZSBpZiAocGFyYW1ldGVycy5tb3JwaFRhcmdldHMgPT09IHRydWUpIHsKICAgIGdsLmJpbmRBdHRyaWJMb2NhdGlvbihwcm9ncmFtLCAwLCAicG9zaXRpb24iKTsKICB9CiAgZ2wubGlua1Byb2dyYW0ocHJvZ3JhbSk7CiAgaWYgKHJlbmRlcmVyLmRlYnVnLmNoZWNrU2hhZGVyRXJyb3JzKSB7CiAgICBjb25zdCBwcm9ncmFtTG9nID0gZ2wuZ2V0UHJvZ3JhbUluZm9Mb2cocHJvZ3JhbSkudHJpbSgpOwogICAgY29uc3QgdmVydGV4TG9nID0gZ2wuZ2V0U2hhZGVySW5mb0xvZyhnbFZlcnRleFNoYWRlcikudHJpbSgpOwogICAgY29uc3QgZnJhZ21lbnRMb2cgPSBnbC5nZXRTaGFkZXJJbmZvTG9nKGdsRnJhZ21lbnRTaGFkZXIpLnRyaW0oKTsKICAgIGxldCBydW5uYWJsZSA9IHRydWU7CiAgICBsZXQgaGF2ZURpYWdub3N0aWNzID0gdHJ1ZTsKICAgIGlmIChnbC5nZXRQcm9ncmFtUGFyYW1ldGVyKHByb2dyYW0sIDM1NzE0KSA9PT0gZmFsc2UpIHsKICAgICAgcnVubmFibGUgPSBmYWxzZTsKICAgICAgY29uc3QgdmVydGV4RXJyb3JzID0gZ2V0U2hhZGVyRXJyb3JzKGdsLCBnbFZlcnRleFNoYWRlciwgInZlcnRleCIpOwogICAgICBjb25zdCBmcmFnbWVudEVycm9ycyA9IGdldFNoYWRlckVycm9ycyhnbCwgZ2xGcmFnbWVudFNoYWRlciwgImZyYWdtZW50Iik7CiAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLldlYkdMUHJvZ3JhbTogU2hhZGVyIEVycm9yICIgKyBnbC5nZXRFcnJvcigpICsgIiAtIFZBTElEQVRFX1NUQVRVUyAiICsgZ2wuZ2V0UHJvZ3JhbVBhcmFtZXRlcihwcm9ncmFtLCAzNTcxNSkgKyAiXG5cblByb2dyYW0gSW5mbyBMb2c6ICIgKyBwcm9ncmFtTG9nICsgIlxuIiArIHZlcnRleEVycm9ycyArICJcbiIgKyBmcmFnbWVudEVycm9ycyk7CiAgICB9IGVsc2UgaWYgKHByb2dyYW1Mb2cgIT09ICIiKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xQcm9ncmFtOiBQcm9ncmFtIEluZm8gTG9nOiIsIHByb2dyYW1Mb2cpOwogICAgfSBlbHNlIGlmICh2ZXJ0ZXhMb2cgPT09ICIiIHx8IGZyYWdtZW50TG9nID09PSAiIikgewogICAgICBoYXZlRGlhZ25vc3RpY3MgPSBmYWxzZTsKICAgIH0KICAgIGlmIChoYXZlRGlhZ25vc3RpY3MpIHsKICAgICAgdGhpcy5kaWFnbm9zdGljcyA9IHsKICAgICAgICBydW5uYWJsZSwKICAgICAgICBwcm9ncmFtTG9nLAogICAgICAgIHZlcnRleFNoYWRlcjogewogICAgICAgICAgbG9nOiB2ZXJ0ZXhMb2csCiAgICAgICAgICBwcmVmaXg6IHByZWZpeFZlcnRleAogICAgICAgIH0sCiAgICAgICAgZnJhZ21lbnRTaGFkZXI6IHsKICAgICAgICAgIGxvZzogZnJhZ21lbnRMb2csCiAgICAgICAgICBwcmVmaXg6IHByZWZpeEZyYWdtZW50CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0KICBnbC5kZWxldGVTaGFkZXIoZ2xWZXJ0ZXhTaGFkZXIpOwogIGdsLmRlbGV0ZVNoYWRlcihnbEZyYWdtZW50U2hhZGVyKTsKICBsZXQgY2FjaGVkVW5pZm9ybXM7CiAgdGhpcy5nZXRVbmlmb3JtcyA9IGZ1bmN0aW9uKCkgewogICAgaWYgKGNhY2hlZFVuaWZvcm1zID09PSB2b2lkIDApIHsKICAgICAgY2FjaGVkVW5pZm9ybXMgPSBuZXcgV2ViR0xVbmlmb3JtcyhnbCwgcHJvZ3JhbSk7CiAgICB9CiAgICByZXR1cm4gY2FjaGVkVW5pZm9ybXM7CiAgfTsKICBsZXQgY2FjaGVkQXR0cmlidXRlczsKICB0aGlzLmdldEF0dHJpYnV0ZXMgPSBmdW5jdGlvbigpIHsKICAgIGlmIChjYWNoZWRBdHRyaWJ1dGVzID09PSB2b2lkIDApIHsKICAgICAgY2FjaGVkQXR0cmlidXRlcyA9IGZldGNoQXR0cmlidXRlTG9jYXRpb25zKGdsLCBwcm9ncmFtKTsKICAgIH0KICAgIHJldHVybiBjYWNoZWRBdHRyaWJ1dGVzOwogIH07CiAgdGhpcy5kZXN0cm95ID0gZnVuY3Rpb24oKSB7CiAgICBiaW5kaW5nU3RhdGVzLnJlbGVhc2VTdGF0ZXNPZlByb2dyYW0odGhpcyk7CiAgICBnbC5kZWxldGVQcm9ncmFtKHByb2dyYW0pOwogICAgdGhpcy5wcm9ncmFtID0gdm9pZCAwOwogIH07CiAgdGhpcy5uYW1lID0gcGFyYW1ldGVycy5zaGFkZXJOYW1lOwogIHRoaXMuaWQgPSBwcm9ncmFtSWRDb3VudCsrOwogIHRoaXMuY2FjaGVLZXkgPSBjYWNoZUtleTsKICB0aGlzLnVzZWRUaW1lcyA9IDE7CiAgdGhpcy5wcm9ncmFtID0gcHJvZ3JhbTsKICB0aGlzLnZlcnRleFNoYWRlciA9IGdsVmVydGV4U2hhZGVyOwogIHRoaXMuZnJhZ21lbnRTaGFkZXIgPSBnbEZyYWdtZW50U2hhZGVyOwogIHJldHVybiB0aGlzOwp9CmxldCBfaWQgPSAwOwpjbGFzcyBXZWJHTFNoYWRlckNhY2hlIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHRoaXMuc2hhZGVyQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogICAgdGhpcy5tYXRlcmlhbENhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICB9CiAgdXBkYXRlKG1hdGVyaWFsKSB7CiAgICBjb25zdCB2ZXJ0ZXhTaGFkZXIgPSBtYXRlcmlhbC52ZXJ0ZXhTaGFkZXI7CiAgICBjb25zdCBmcmFnbWVudFNoYWRlciA9IG1hdGVyaWFsLmZyYWdtZW50U2hhZGVyOwogICAgY29uc3QgdmVydGV4U2hhZGVyU3RhZ2UgPSB0aGlzLl9nZXRTaGFkZXJTdGFnZSh2ZXJ0ZXhTaGFkZXIpOwogICAgY29uc3QgZnJhZ21lbnRTaGFkZXJTdGFnZSA9IHRoaXMuX2dldFNoYWRlclN0YWdlKGZyYWdtZW50U2hhZGVyKTsKICAgIGNvbnN0IG1hdGVyaWFsU2hhZGVycyA9IHRoaXMuX2dldFNoYWRlckNhY2hlRm9yTWF0ZXJpYWwobWF0ZXJpYWwpOwogICAgaWYgKG1hdGVyaWFsU2hhZGVycy5oYXModmVydGV4U2hhZGVyU3RhZ2UpID09PSBmYWxzZSkgewogICAgICBtYXRlcmlhbFNoYWRlcnMuYWRkKHZlcnRleFNoYWRlclN0YWdlKTsKICAgICAgdmVydGV4U2hhZGVyU3RhZ2UudXNlZFRpbWVzKys7CiAgICB9CiAgICBpZiAobWF0ZXJpYWxTaGFkZXJzLmhhcyhmcmFnbWVudFNoYWRlclN0YWdlKSA9PT0gZmFsc2UpIHsKICAgICAgbWF0ZXJpYWxTaGFkZXJzLmFkZChmcmFnbWVudFNoYWRlclN0YWdlKTsKICAgICAgZnJhZ21lbnRTaGFkZXJTdGFnZS51c2VkVGltZXMrKzsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICByZW1vdmUobWF0ZXJpYWwpIHsKICAgIGNvbnN0IG1hdGVyaWFsU2hhZGVycyA9IHRoaXMubWF0ZXJpYWxDYWNoZS5nZXQobWF0ZXJpYWwpOwogICAgZm9yIChjb25zdCBzaGFkZXJTdGFnZSBvZiBtYXRlcmlhbFNoYWRlcnMpIHsKICAgICAgc2hhZGVyU3RhZ2UudXNlZFRpbWVzLS07CiAgICAgIGlmIChzaGFkZXJTdGFnZS51c2VkVGltZXMgPT09IDApCiAgICAgICAgdGhpcy5zaGFkZXJDYWNoZS5kZWxldGUoc2hhZGVyU3RhZ2UpOwogICAgfQogICAgdGhpcy5tYXRlcmlhbENhY2hlLmRlbGV0ZShtYXRlcmlhbCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZ2V0VmVydGV4U2hhZGVySUQobWF0ZXJpYWwpIHsKICAgIHJldHVybiB0aGlzLl9nZXRTaGFkZXJTdGFnZShtYXRlcmlhbC52ZXJ0ZXhTaGFkZXIpLmlkOwogIH0KICBnZXRGcmFnbWVudFNoYWRlcklEKG1hdGVyaWFsKSB7CiAgICByZXR1cm4gdGhpcy5fZ2V0U2hhZGVyU3RhZ2UobWF0ZXJpYWwuZnJhZ21lbnRTaGFkZXIpLmlkOwogIH0KICBkaXNwb3NlKCkgewogICAgdGhpcy5zaGFkZXJDYWNoZS5jbGVhcigpOwogICAgdGhpcy5tYXRlcmlhbENhY2hlLmNsZWFyKCk7CiAgfQogIF9nZXRTaGFkZXJDYWNoZUZvck1hdGVyaWFsKG1hdGVyaWFsKSB7CiAgICBjb25zdCBjYWNoZSA9IHRoaXMubWF0ZXJpYWxDYWNoZTsKICAgIGlmIChjYWNoZS5oYXMobWF0ZXJpYWwpID09PSBmYWxzZSkgewogICAgICBjYWNoZS5zZXQobWF0ZXJpYWwsIC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCkpOwogICAgfQogICAgcmV0dXJuIGNhY2hlLmdldChtYXRlcmlhbCk7CiAgfQogIF9nZXRTaGFkZXJTdGFnZShjb2RlKSB7CiAgICBjb25zdCBjYWNoZSA9IHRoaXMuc2hhZGVyQ2FjaGU7CiAgICBpZiAoY2FjaGUuaGFzKGNvZGUpID09PSBmYWxzZSkgewogICAgICBjb25zdCBzdGFnZSA9IG5ldyBXZWJHTFNoYWRlclN0YWdlKCk7CiAgICAgIGNhY2hlLnNldChjb2RlLCBzdGFnZSk7CiAgICB9CiAgICByZXR1cm4gY2FjaGUuZ2V0KGNvZGUpOwogIH0KfQpjbGFzcyBXZWJHTFNoYWRlclN0YWdlIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHRoaXMuaWQgPSBfaWQrKzsKICAgIHRoaXMudXNlZFRpbWVzID0gMDsKICB9Cn0KZnVuY3Rpb24gV2ViR0xQcm9ncmFtcyhyZW5kZXJlciwgY3ViZW1hcHMsIGN1YmV1dm1hcHMsIGV4dGVuc2lvbnMsIGNhcGFiaWxpdGllcywgYmluZGluZ1N0YXRlcywgY2xpcHBpbmcpIHsKICBjb25zdCBfcHJvZ3JhbUxheWVycyA9IG5ldyBMYXllcnMoKTsKICBjb25zdCBfY3VzdG9tU2hhZGVycyA9IG5ldyBXZWJHTFNoYWRlckNhY2hlKCk7CiAgY29uc3QgcHJvZ3JhbXMgPSBbXTsKICBjb25zdCBpc1dlYkdMMiA9IGNhcGFiaWxpdGllcy5pc1dlYkdMMjsKICBjb25zdCBsb2dhcml0aG1pY0RlcHRoQnVmZmVyID0gY2FwYWJpbGl0aWVzLmxvZ2FyaXRobWljRGVwdGhCdWZmZXI7CiAgY29uc3QgZmxvYXRWZXJ0ZXhUZXh0dXJlcyA9IGNhcGFiaWxpdGllcy5mbG9hdFZlcnRleFRleHR1cmVzOwogIGNvbnN0IG1heFZlcnRleFVuaWZvcm1zID0gY2FwYWJpbGl0aWVzLm1heFZlcnRleFVuaWZvcm1zOwogIGNvbnN0IHZlcnRleFRleHR1cmVzID0gY2FwYWJpbGl0aWVzLnZlcnRleFRleHR1cmVzOwogIGxldCBwcmVjaXNpb24gPSBjYXBhYmlsaXRpZXMucHJlY2lzaW9uOwogIGNvbnN0IHNoYWRlcklEcyA9IHsKICAgIE1lc2hEZXB0aE1hdGVyaWFsOiAiZGVwdGgiLAogICAgTWVzaERpc3RhbmNlTWF0ZXJpYWw6ICJkaXN0YW5jZVJHQkEiLAogICAgTWVzaE5vcm1hbE1hdGVyaWFsOiAibm9ybWFsIiwKICAgIE1lc2hCYXNpY01hdGVyaWFsOiAiYmFzaWMiLAogICAgTWVzaExhbWJlcnRNYXRlcmlhbDogImxhbWJlcnQiLAogICAgTWVzaFBob25nTWF0ZXJpYWw6ICJwaG9uZyIsCiAgICBNZXNoVG9vbk1hdGVyaWFsOiAidG9vbiIsCiAgICBNZXNoU3RhbmRhcmRNYXRlcmlhbDogInBoeXNpY2FsIiwKICAgIE1lc2hQaHlzaWNhbE1hdGVyaWFsOiAicGh5c2ljYWwiLAogICAgTWVzaE1hdGNhcE1hdGVyaWFsOiAibWF0Y2FwIiwKICAgIExpbmVCYXNpY01hdGVyaWFsOiAiYmFzaWMiLAogICAgTGluZURhc2hlZE1hdGVyaWFsOiAiZGFzaGVkIiwKICAgIFBvaW50c01hdGVyaWFsOiAicG9pbnRzIiwKICAgIFNoYWRvd01hdGVyaWFsOiAic2hhZG93IiwKICAgIFNwcml0ZU1hdGVyaWFsOiAic3ByaXRlIgogIH07CiAgZnVuY3Rpb24gZ2V0TWF4Qm9uZXMob2JqZWN0KSB7CiAgICBjb25zdCBza2VsZXRvbiA9IG9iamVjdC5za2VsZXRvbjsKICAgIGNvbnN0IGJvbmVzID0gc2tlbGV0b24uYm9uZXM7CiAgICBpZiAoZmxvYXRWZXJ0ZXhUZXh0dXJlcykgewogICAgICByZXR1cm4gMTAyNDsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IG5WZXJ0ZXhVbmlmb3JtcyA9IG1heFZlcnRleFVuaWZvcm1zOwogICAgICBjb25zdCBuVmVydGV4TWF0cmljZXMgPSBNYXRoLmZsb29yKChuVmVydGV4VW5pZm9ybXMgLSAyMCkgLyA0KTsKICAgICAgY29uc3QgbWF4Qm9uZXMgPSBNYXRoLm1pbihuVmVydGV4TWF0cmljZXMsIGJvbmVzLmxlbmd0aCk7CiAgICAgIGlmIChtYXhCb25lcyA8IGJvbmVzLmxlbmd0aCkgewogICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogU2tlbGV0b24gaGFzICIgKyBib25lcy5sZW5ndGggKyAiIGJvbmVzLiBUaGlzIEdQVSBzdXBwb3J0cyAiICsgbWF4Qm9uZXMgKyAiLiIpOwogICAgICAgIHJldHVybiAwOwogICAgICB9CiAgICAgIHJldHVybiBtYXhCb25lczsKICAgIH0KICB9CiAgZnVuY3Rpb24gZ2V0UGFyYW1ldGVycyhtYXRlcmlhbCwgbGlnaHRzLCBzaGFkb3dzLCBzY2VuZSwgb2JqZWN0KSB7CiAgICBjb25zdCBmb2cgPSBzY2VuZS5mb2c7CiAgICBjb25zdCBlbnZpcm9ubWVudCA9IG1hdGVyaWFsLmlzTWVzaFN0YW5kYXJkTWF0ZXJpYWwgPyBzY2VuZS5lbnZpcm9ubWVudCA6IG51bGw7CiAgICBjb25zdCBlbnZNYXAgPSAobWF0ZXJpYWwuaXNNZXNoU3RhbmRhcmRNYXRlcmlhbCA/IGN1YmV1dm1hcHMgOiBjdWJlbWFwcykuZ2V0KG1hdGVyaWFsLmVudk1hcCB8fCBlbnZpcm9ubWVudCk7CiAgICBjb25zdCBzaGFkZXJJRCA9IHNoYWRlcklEc1ttYXRlcmlhbC50eXBlXTsKICAgIGNvbnN0IG1heEJvbmVzID0gb2JqZWN0LmlzU2tpbm5lZE1lc2ggPyBnZXRNYXhCb25lcyhvYmplY3QpIDogMDsKICAgIGlmIChtYXRlcmlhbC5wcmVjaXNpb24gIT09IG51bGwpIHsKICAgICAgcHJlY2lzaW9uID0gY2FwYWJpbGl0aWVzLmdldE1heFByZWNpc2lvbihtYXRlcmlhbC5wcmVjaXNpb24pOwogICAgICBpZiAocHJlY2lzaW9uICE9PSBtYXRlcmlhbC5wcmVjaXNpb24pIHsKICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUHJvZ3JhbS5nZXRQYXJhbWV0ZXJzOiIsIG1hdGVyaWFsLnByZWNpc2lvbiwgIm5vdCBzdXBwb3J0ZWQsIHVzaW5nIiwgcHJlY2lzaW9uLCAiaW5zdGVhZC4iKTsKICAgICAgfQogICAgfQogICAgbGV0IHZlcnRleFNoYWRlciwgZnJhZ21lbnRTaGFkZXI7CiAgICBsZXQgY3VzdG9tVmVydGV4U2hhZGVySUQsIGN1c3RvbUZyYWdtZW50U2hhZGVySUQ7CiAgICBpZiAoc2hhZGVySUQpIHsKICAgICAgY29uc3Qgc2hhZGVyID0gU2hhZGVyTGliW3NoYWRlcklEXTsKICAgICAgdmVydGV4U2hhZGVyID0gc2hhZGVyLnZlcnRleFNoYWRlcjsKICAgICAgZnJhZ21lbnRTaGFkZXIgPSBzaGFkZXIuZnJhZ21lbnRTaGFkZXI7CiAgICB9IGVsc2UgewogICAgICB2ZXJ0ZXhTaGFkZXIgPSBtYXRlcmlhbC52ZXJ0ZXhTaGFkZXI7CiAgICAgIGZyYWdtZW50U2hhZGVyID0gbWF0ZXJpYWwuZnJhZ21lbnRTaGFkZXI7CiAgICAgIF9jdXN0b21TaGFkZXJzLnVwZGF0ZShtYXRlcmlhbCk7CiAgICAgIGN1c3RvbVZlcnRleFNoYWRlcklEID0gX2N1c3RvbVNoYWRlcnMuZ2V0VmVydGV4U2hhZGVySUQobWF0ZXJpYWwpOwogICAgICBjdXN0b21GcmFnbWVudFNoYWRlcklEID0gX2N1c3RvbVNoYWRlcnMuZ2V0RnJhZ21lbnRTaGFkZXJJRChtYXRlcmlhbCk7CiAgICB9CiAgICBjb25zdCBjdXJyZW50UmVuZGVyVGFyZ2V0ID0gcmVuZGVyZXIuZ2V0UmVuZGVyVGFyZ2V0KCk7CiAgICBjb25zdCB1c2VBbHBoYVRlc3QgPSBtYXRlcmlhbC5hbHBoYVRlc3QgPiAwOwogICAgY29uc3QgdXNlQ2xlYXJjb2F0ID0gbWF0ZXJpYWwuY2xlYXJjb2F0ID4gMDsKICAgIGNvbnN0IHBhcmFtZXRlcnMgPSB7CiAgICAgIGlzV2ViR0wyLAogICAgICBzaGFkZXJJRCwKICAgICAgc2hhZGVyTmFtZTogbWF0ZXJpYWwudHlwZSwKICAgICAgdmVydGV4U2hhZGVyLAogICAgICBmcmFnbWVudFNoYWRlciwKICAgICAgZGVmaW5lczogbWF0ZXJpYWwuZGVmaW5lcywKICAgICAgY3VzdG9tVmVydGV4U2hhZGVySUQsCiAgICAgIGN1c3RvbUZyYWdtZW50U2hhZGVySUQsCiAgICAgIGlzUmF3U2hhZGVyTWF0ZXJpYWw6IG1hdGVyaWFsLmlzUmF3U2hhZGVyTWF0ZXJpYWwgPT09IHRydWUsCiAgICAgIGdsc2xWZXJzaW9uOiBtYXRlcmlhbC5nbHNsVmVyc2lvbiwKICAgICAgcHJlY2lzaW9uLAogICAgICBpbnN0YW5jaW5nOiBvYmplY3QuaXNJbnN0YW5jZWRNZXNoID09PSB0cnVlLAogICAgICBpbnN0YW5jaW5nQ29sb3I6IG9iamVjdC5pc0luc3RhbmNlZE1lc2ggPT09IHRydWUgJiYgb2JqZWN0Lmluc3RhbmNlQ29sb3IgIT09IG51bGwsCiAgICAgIHN1cHBvcnRzVmVydGV4VGV4dHVyZXM6IHZlcnRleFRleHR1cmVzLAogICAgICBvdXRwdXRFbmNvZGluZzogY3VycmVudFJlbmRlclRhcmdldCA9PT0gbnVsbCA/IHJlbmRlcmVyLm91dHB1dEVuY29kaW5nIDogY3VycmVudFJlbmRlclRhcmdldC5pc1hSUmVuZGVyVGFyZ2V0ID09PSB0cnVlID8gY3VycmVudFJlbmRlclRhcmdldC50ZXh0dXJlLmVuY29kaW5nIDogTGluZWFyRW5jb2RpbmcsCiAgICAgIG1hcDogISFtYXRlcmlhbC5tYXAsCiAgICAgIG1hdGNhcDogISFtYXRlcmlhbC5tYXRjYXAsCiAgICAgIGVudk1hcDogISFlbnZNYXAsCiAgICAgIGVudk1hcE1vZGU6IGVudk1hcCAmJiBlbnZNYXAubWFwcGluZywKICAgICAgZW52TWFwQ3ViZVVWOiAhIWVudk1hcCAmJiAoZW52TWFwLm1hcHBpbmcgPT09IEN1YmVVVlJlZmxlY3Rpb25NYXBwaW5nIHx8IGVudk1hcC5tYXBwaW5nID09PSBDdWJlVVZSZWZyYWN0aW9uTWFwcGluZyksCiAgICAgIGxpZ2h0TWFwOiAhIW1hdGVyaWFsLmxpZ2h0TWFwLAogICAgICBhb01hcDogISFtYXRlcmlhbC5hb01hcCwKICAgICAgZW1pc3NpdmVNYXA6ICEhbWF0ZXJpYWwuZW1pc3NpdmVNYXAsCiAgICAgIGJ1bXBNYXA6ICEhbWF0ZXJpYWwuYnVtcE1hcCwKICAgICAgbm9ybWFsTWFwOiAhIW1hdGVyaWFsLm5vcm1hbE1hcCwKICAgICAgb2JqZWN0U3BhY2VOb3JtYWxNYXA6IG1hdGVyaWFsLm5vcm1hbE1hcFR5cGUgPT09IE9iamVjdFNwYWNlTm9ybWFsTWFwLAogICAgICB0YW5nZW50U3BhY2VOb3JtYWxNYXA6IG1hdGVyaWFsLm5vcm1hbE1hcFR5cGUgPT09IFRhbmdlbnRTcGFjZU5vcm1hbE1hcCwKICAgICAgZGVjb2RlVmlkZW9UZXh0dXJlOiAhIW1hdGVyaWFsLm1hcCAmJiBtYXRlcmlhbC5tYXAuaXNWaWRlb1RleHR1cmUgPT09IHRydWUgJiYgbWF0ZXJpYWwubWFwLmVuY29kaW5nID09PSBzUkdCRW5jb2RpbmcsCiAgICAgIGNsZWFyY29hdDogdXNlQ2xlYXJjb2F0LAogICAgICBjbGVhcmNvYXRNYXA6IHVzZUNsZWFyY29hdCAmJiAhIW1hdGVyaWFsLmNsZWFyY29hdE1hcCwKICAgICAgY2xlYXJjb2F0Um91Z2huZXNzTWFwOiB1c2VDbGVhcmNvYXQgJiYgISFtYXRlcmlhbC5jbGVhcmNvYXRSb3VnaG5lc3NNYXAsCiAgICAgIGNsZWFyY29hdE5vcm1hbE1hcDogdXNlQ2xlYXJjb2F0ICYmICEhbWF0ZXJpYWwuY2xlYXJjb2F0Tm9ybWFsTWFwLAogICAgICBkaXNwbGFjZW1lbnRNYXA6ICEhbWF0ZXJpYWwuZGlzcGxhY2VtZW50TWFwLAogICAgICByb3VnaG5lc3NNYXA6ICEhbWF0ZXJpYWwucm91Z2huZXNzTWFwLAogICAgICBtZXRhbG5lc3NNYXA6ICEhbWF0ZXJpYWwubWV0YWxuZXNzTWFwLAogICAgICBzcGVjdWxhck1hcDogISFtYXRlcmlhbC5zcGVjdWxhck1hcCwKICAgICAgc3BlY3VsYXJJbnRlbnNpdHlNYXA6ICEhbWF0ZXJpYWwuc3BlY3VsYXJJbnRlbnNpdHlNYXAsCiAgICAgIHNwZWN1bGFyQ29sb3JNYXA6ICEhbWF0ZXJpYWwuc3BlY3VsYXJDb2xvck1hcCwKICAgICAgdHJhbnNwYXJlbnQ6IG1hdGVyaWFsLnRyYW5zcGFyZW50LAogICAgICBhbHBoYU1hcDogISFtYXRlcmlhbC5hbHBoYU1hcCwKICAgICAgYWxwaGFUZXN0OiB1c2VBbHBoYVRlc3QsCiAgICAgIGdyYWRpZW50TWFwOiAhIW1hdGVyaWFsLmdyYWRpZW50TWFwLAogICAgICBzaGVlbjogbWF0ZXJpYWwuc2hlZW4gPiAwLAogICAgICBzaGVlbkNvbG9yTWFwOiAhIW1hdGVyaWFsLnNoZWVuQ29sb3JNYXAsCiAgICAgIHNoZWVuUm91Z2huZXNzTWFwOiAhIW1hdGVyaWFsLnNoZWVuUm91Z2huZXNzTWFwLAogICAgICB0cmFuc21pc3Npb246IG1hdGVyaWFsLnRyYW5zbWlzc2lvbiA+IDAsCiAgICAgIHRyYW5zbWlzc2lvbk1hcDogISFtYXRlcmlhbC50cmFuc21pc3Npb25NYXAsCiAgICAgIHRoaWNrbmVzc01hcDogISFtYXRlcmlhbC50aGlja25lc3NNYXAsCiAgICAgIGNvbWJpbmU6IG1hdGVyaWFsLmNvbWJpbmUsCiAgICAgIHZlcnRleFRhbmdlbnRzOiAhIW1hdGVyaWFsLm5vcm1hbE1hcCAmJiAhIW9iamVjdC5nZW9tZXRyeSAmJiAhIW9iamVjdC5nZW9tZXRyeS5hdHRyaWJ1dGVzLnRhbmdlbnQsCiAgICAgIHZlcnRleENvbG9yczogbWF0ZXJpYWwudmVydGV4Q29sb3JzLAogICAgICB2ZXJ0ZXhBbHBoYXM6IG1hdGVyaWFsLnZlcnRleENvbG9ycyA9PT0gdHJ1ZSAmJiAhIW9iamVjdC5nZW9tZXRyeSAmJiAhIW9iamVjdC5nZW9tZXRyeS5hdHRyaWJ1dGVzLmNvbG9yICYmIG9iamVjdC5nZW9tZXRyeS5hdHRyaWJ1dGVzLmNvbG9yLml0ZW1TaXplID09PSA0LAogICAgICB2ZXJ0ZXhVdnM6ICEhbWF0ZXJpYWwubWFwIHx8ICEhbWF0ZXJpYWwuYnVtcE1hcCB8fCAhIW1hdGVyaWFsLm5vcm1hbE1hcCB8fCAhIW1hdGVyaWFsLnNwZWN1bGFyTWFwIHx8ICEhbWF0ZXJpYWwuYWxwaGFNYXAgfHwgISFtYXRlcmlhbC5lbWlzc2l2ZU1hcCB8fCAhIW1hdGVyaWFsLnJvdWdobmVzc01hcCB8fCAhIW1hdGVyaWFsLm1ldGFsbmVzc01hcCB8fCAhIW1hdGVyaWFsLmNsZWFyY29hdE1hcCB8fCAhIW1hdGVyaWFsLmNsZWFyY29hdFJvdWdobmVzc01hcCB8fCAhIW1hdGVyaWFsLmNsZWFyY29hdE5vcm1hbE1hcCB8fCAhIW1hdGVyaWFsLmRpc3BsYWNlbWVudE1hcCB8fCAhIW1hdGVyaWFsLnRyYW5zbWlzc2lvbk1hcCB8fCAhIW1hdGVyaWFsLnRoaWNrbmVzc01hcCB8fCAhIW1hdGVyaWFsLnNwZWN1bGFySW50ZW5zaXR5TWFwIHx8ICEhbWF0ZXJpYWwuc3BlY3VsYXJDb2xvck1hcCB8fCAhIW1hdGVyaWFsLnNoZWVuQ29sb3JNYXAgfHwgISFtYXRlcmlhbC5zaGVlblJvdWdobmVzc01hcCwKICAgICAgdXZzVmVydGV4T25seTogISghIW1hdGVyaWFsLm1hcCB8fCAhIW1hdGVyaWFsLmJ1bXBNYXAgfHwgISFtYXRlcmlhbC5ub3JtYWxNYXAgfHwgISFtYXRlcmlhbC5zcGVjdWxhck1hcCB8fCAhIW1hdGVyaWFsLmFscGhhTWFwIHx8ICEhbWF0ZXJpYWwuZW1pc3NpdmVNYXAgfHwgISFtYXRlcmlhbC5yb3VnaG5lc3NNYXAgfHwgISFtYXRlcmlhbC5tZXRhbG5lc3NNYXAgfHwgISFtYXRlcmlhbC5jbGVhcmNvYXROb3JtYWxNYXAgfHwgbWF0ZXJpYWwudHJhbnNtaXNzaW9uID4gMCB8fCAhIW1hdGVyaWFsLnRyYW5zbWlzc2lvbk1hcCB8fCAhIW1hdGVyaWFsLnRoaWNrbmVzc01hcCB8fCAhIW1hdGVyaWFsLnNwZWN1bGFySW50ZW5zaXR5TWFwIHx8ICEhbWF0ZXJpYWwuc3BlY3VsYXJDb2xvck1hcCB8fCBtYXRlcmlhbC5zaGVlbiA+IDAgfHwgISFtYXRlcmlhbC5zaGVlbkNvbG9yTWFwIHx8ICEhbWF0ZXJpYWwuc2hlZW5Sb3VnaG5lc3NNYXApICYmICEhbWF0ZXJpYWwuZGlzcGxhY2VtZW50TWFwLAogICAgICBmb2c6ICEhZm9nLAogICAgICB1c2VGb2c6IG1hdGVyaWFsLmZvZywKICAgICAgZm9nRXhwMjogZm9nICYmIGZvZy5pc0ZvZ0V4cDIsCiAgICAgIGZsYXRTaGFkaW5nOiAhIW1hdGVyaWFsLmZsYXRTaGFkaW5nLAogICAgICBzaXplQXR0ZW51YXRpb246IG1hdGVyaWFsLnNpemVBdHRlbnVhdGlvbiwKICAgICAgbG9nYXJpdGhtaWNEZXB0aEJ1ZmZlciwKICAgICAgc2tpbm5pbmc6IG9iamVjdC5pc1NraW5uZWRNZXNoID09PSB0cnVlICYmIG1heEJvbmVzID4gMCwKICAgICAgbWF4Qm9uZXMsCiAgICAgIHVzZVZlcnRleFRleHR1cmU6IGZsb2F0VmVydGV4VGV4dHVyZXMsCiAgICAgIG1vcnBoVGFyZ2V0czogISFvYmplY3QuZ2VvbWV0cnkgJiYgISFvYmplY3QuZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzLnBvc2l0aW9uLAogICAgICBtb3JwaE5vcm1hbHM6ICEhb2JqZWN0Lmdlb21ldHJ5ICYmICEhb2JqZWN0Lmdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcy5ub3JtYWwsCiAgICAgIG1vcnBoVGFyZ2V0c0NvdW50OiAhIW9iamVjdC5nZW9tZXRyeSAmJiAhIW9iamVjdC5nZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXMucG9zaXRpb24gPyBvYmplY3QuZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzLnBvc2l0aW9uLmxlbmd0aCA6IDAsCiAgICAgIG51bURpckxpZ2h0czogbGlnaHRzLmRpcmVjdGlvbmFsLmxlbmd0aCwKICAgICAgbnVtUG9pbnRMaWdodHM6IGxpZ2h0cy5wb2ludC5sZW5ndGgsCiAgICAgIG51bVNwb3RMaWdodHM6IGxpZ2h0cy5zcG90Lmxlbmd0aCwKICAgICAgbnVtUmVjdEFyZWFMaWdodHM6IGxpZ2h0cy5yZWN0QXJlYS5sZW5ndGgsCiAgICAgIG51bUhlbWlMaWdodHM6IGxpZ2h0cy5oZW1pLmxlbmd0aCwKICAgICAgbnVtRGlyTGlnaHRTaGFkb3dzOiBsaWdodHMuZGlyZWN0aW9uYWxTaGFkb3dNYXAubGVuZ3RoLAogICAgICBudW1Qb2ludExpZ2h0U2hhZG93czogbGlnaHRzLnBvaW50U2hhZG93TWFwLmxlbmd0aCwKICAgICAgbnVtU3BvdExpZ2h0U2hhZG93czogbGlnaHRzLnNwb3RTaGFkb3dNYXAubGVuZ3RoLAogICAgICBudW1DbGlwcGluZ1BsYW5lczogY2xpcHBpbmcubnVtUGxhbmVzLAogICAgICBudW1DbGlwSW50ZXJzZWN0aW9uOiBjbGlwcGluZy5udW1JbnRlcnNlY3Rpb24sCiAgICAgIGRpdGhlcmluZzogbWF0ZXJpYWwuZGl0aGVyaW5nLAogICAgICBzaGFkb3dNYXBFbmFibGVkOiByZW5kZXJlci5zaGFkb3dNYXAuZW5hYmxlZCAmJiBzaGFkb3dzLmxlbmd0aCA+IDAsCiAgICAgIHNoYWRvd01hcFR5cGU6IHJlbmRlcmVyLnNoYWRvd01hcC50eXBlLAogICAgICB0b25lTWFwcGluZzogbWF0ZXJpYWwudG9uZU1hcHBlZCA/IHJlbmRlcmVyLnRvbmVNYXBwaW5nIDogTm9Ub25lTWFwcGluZywKICAgICAgcGh5c2ljYWxseUNvcnJlY3RMaWdodHM6IHJlbmRlcmVyLnBoeXNpY2FsbHlDb3JyZWN0TGlnaHRzLAogICAgICBwcmVtdWx0aXBsaWVkQWxwaGE6IG1hdGVyaWFsLnByZW11bHRpcGxpZWRBbHBoYSwKICAgICAgZG91YmxlU2lkZWQ6IG1hdGVyaWFsLnNpZGUgPT09IERvdWJsZVNpZGUsCiAgICAgIGZsaXBTaWRlZDogbWF0ZXJpYWwuc2lkZSA9PT0gQmFja1NpZGUsCiAgICAgIGRlcHRoUGFja2luZzogbWF0ZXJpYWwuZGVwdGhQYWNraW5nICE9PSB2b2lkIDAgPyBtYXRlcmlhbC5kZXB0aFBhY2tpbmcgOiBmYWxzZSwKICAgICAgaW5kZXgwQXR0cmlidXRlTmFtZTogbWF0ZXJpYWwuaW5kZXgwQXR0cmlidXRlTmFtZSwKICAgICAgZXh0ZW5zaW9uRGVyaXZhdGl2ZXM6IG1hdGVyaWFsLmV4dGVuc2lvbnMgJiYgbWF0ZXJpYWwuZXh0ZW5zaW9ucy5kZXJpdmF0aXZlcywKICAgICAgZXh0ZW5zaW9uRnJhZ0RlcHRoOiBtYXRlcmlhbC5leHRlbnNpb25zICYmIG1hdGVyaWFsLmV4dGVuc2lvbnMuZnJhZ0RlcHRoLAogICAgICBleHRlbnNpb25EcmF3QnVmZmVyczogbWF0ZXJpYWwuZXh0ZW5zaW9ucyAmJiBtYXRlcmlhbC5leHRlbnNpb25zLmRyYXdCdWZmZXJzLAogICAgICBleHRlbnNpb25TaGFkZXJUZXh0dXJlTE9EOiBtYXRlcmlhbC5leHRlbnNpb25zICYmIG1hdGVyaWFsLmV4dGVuc2lvbnMuc2hhZGVyVGV4dHVyZUxPRCwKICAgICAgcmVuZGVyZXJFeHRlbnNpb25GcmFnRGVwdGg6IGlzV2ViR0wyIHx8IGV4dGVuc2lvbnMuaGFzKCJFWFRfZnJhZ19kZXB0aCIpLAogICAgICByZW5kZXJlckV4dGVuc2lvbkRyYXdCdWZmZXJzOiBpc1dlYkdMMiB8fCBleHRlbnNpb25zLmhhcygiV0VCR0xfZHJhd19idWZmZXJzIiksCiAgICAgIHJlbmRlcmVyRXh0ZW5zaW9uU2hhZGVyVGV4dHVyZUxvZDogaXNXZWJHTDIgfHwgZXh0ZW5zaW9ucy5oYXMoIkVYVF9zaGFkZXJfdGV4dHVyZV9sb2QiKSwKICAgICAgY3VzdG9tUHJvZ3JhbUNhY2hlS2V5OiBtYXRlcmlhbC5jdXN0b21Qcm9ncmFtQ2FjaGVLZXkoKQogICAgfTsKICAgIHJldHVybiBwYXJhbWV0ZXJzOwogIH0KICBmdW5jdGlvbiBnZXRQcm9ncmFtQ2FjaGVLZXkocGFyYW1ldGVycykgewogICAgY29uc3QgYXJyYXkgPSBbXTsKICAgIGlmIChwYXJhbWV0ZXJzLnNoYWRlcklEKSB7CiAgICAgIGFycmF5LnB1c2gocGFyYW1ldGVycy5zaGFkZXJJRCk7CiAgICB9IGVsc2UgewogICAgICBhcnJheS5wdXNoKHBhcmFtZXRlcnMuY3VzdG9tVmVydGV4U2hhZGVySUQpOwogICAgICBhcnJheS5wdXNoKHBhcmFtZXRlcnMuY3VzdG9tRnJhZ21lbnRTaGFkZXJJRCk7CiAgICB9CiAgICBpZiAocGFyYW1ldGVycy5kZWZpbmVzICE9PSB2b2lkIDApIHsKICAgICAgZm9yIChjb25zdCBuYW1lIGluIHBhcmFtZXRlcnMuZGVmaW5lcykgewogICAgICAgIGFycmF5LnB1c2gobmFtZSk7CiAgICAgICAgYXJyYXkucHVzaChwYXJhbWV0ZXJzLmRlZmluZXNbbmFtZV0pOwogICAgICB9CiAgICB9CiAgICBpZiAocGFyYW1ldGVycy5pc1Jhd1NoYWRlck1hdGVyaWFsID09PSBmYWxzZSkgewogICAgICBnZXRQcm9ncmFtQ2FjaGVLZXlQYXJhbWV0ZXJzKGFycmF5LCBwYXJhbWV0ZXJzKTsKICAgICAgZ2V0UHJvZ3JhbUNhY2hlS2V5Qm9vbGVhbnMoYXJyYXksIHBhcmFtZXRlcnMpOwogICAgICBhcnJheS5wdXNoKHJlbmRlcmVyLm91dHB1dEVuY29kaW5nKTsKICAgIH0KICAgIGFycmF5LnB1c2gocGFyYW1ldGVycy5jdXN0b21Qcm9ncmFtQ2FjaGVLZXkpOwogICAgcmV0dXJuIGFycmF5LmpvaW4oKTsKICB9CiAgZnVuY3Rpb24gZ2V0UHJvZ3JhbUNhY2hlS2V5UGFyYW1ldGVycyhhcnJheSwgcGFyYW1ldGVycykgewogICAgYXJyYXkucHVzaChwYXJhbWV0ZXJzLnByZWNpc2lvbik7CiAgICBhcnJheS5wdXNoKHBhcmFtZXRlcnMub3V0cHV0RW5jb2RpbmcpOwogICAgYXJyYXkucHVzaChwYXJhbWV0ZXJzLmVudk1hcE1vZGUpOwogICAgYXJyYXkucHVzaChwYXJhbWV0ZXJzLmNvbWJpbmUpOwogICAgYXJyYXkucHVzaChwYXJhbWV0ZXJzLnZlcnRleFV2cyk7CiAgICBhcnJheS5wdXNoKHBhcmFtZXRlcnMuZm9nRXhwMik7CiAgICBhcnJheS5wdXNoKHBhcmFtZXRlcnMuc2l6ZUF0dGVudWF0aW9uKTsKICAgIGFycmF5LnB1c2gocGFyYW1ldGVycy5tYXhCb25lcyk7CiAgICBhcnJheS5wdXNoKHBhcmFtZXRlcnMubW9ycGhUYXJnZXRzQ291bnQpOwogICAgYXJyYXkucHVzaChwYXJhbWV0ZXJzLm51bURpckxpZ2h0cyk7CiAgICBhcnJheS5wdXNoKHBhcmFtZXRlcnMubnVtUG9pbnRMaWdodHMpOwogICAgYXJyYXkucHVzaChwYXJhbWV0ZXJzLm51bVNwb3RMaWdodHMpOwogICAgYXJyYXkucHVzaChwYXJhbWV0ZXJzLm51bUhlbWlMaWdodHMpOwogICAgYXJyYXkucHVzaChwYXJhbWV0ZXJzLm51bVJlY3RBcmVhTGlnaHRzKTsKICAgIGFycmF5LnB1c2gocGFyYW1ldGVycy5udW1EaXJMaWdodFNoYWRvd3MpOwogICAgYXJyYXkucHVzaChwYXJhbWV0ZXJzLm51bVBvaW50TGlnaHRTaGFkb3dzKTsKICAgIGFycmF5LnB1c2gocGFyYW1ldGVycy5udW1TcG90TGlnaHRTaGFkb3dzKTsKICAgIGFycmF5LnB1c2gocGFyYW1ldGVycy5zaGFkb3dNYXBUeXBlKTsKICAgIGFycmF5LnB1c2gocGFyYW1ldGVycy50b25lTWFwcGluZyk7CiAgICBhcnJheS5wdXNoKHBhcmFtZXRlcnMubnVtQ2xpcHBpbmdQbGFuZXMpOwogICAgYXJyYXkucHVzaChwYXJhbWV0ZXJzLm51bUNsaXBJbnRlcnNlY3Rpb24pOwogIH0KICBmdW5jdGlvbiBnZXRQcm9ncmFtQ2FjaGVLZXlCb29sZWFucyhhcnJheSwgcGFyYW1ldGVycykgewogICAgX3Byb2dyYW1MYXllcnMuZGlzYWJsZUFsbCgpOwogICAgaWYgKHBhcmFtZXRlcnMuaXNXZWJHTDIpCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgwKTsKICAgIGlmIChwYXJhbWV0ZXJzLnN1cHBvcnRzVmVydGV4VGV4dHVyZXMpCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgxKTsKICAgIGlmIChwYXJhbWV0ZXJzLmluc3RhbmNpbmcpCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgyKTsKICAgIGlmIChwYXJhbWV0ZXJzLmluc3RhbmNpbmdDb2xvcikKICAgICAgX3Byb2dyYW1MYXllcnMuZW5hYmxlKDMpOwogICAgaWYgKHBhcmFtZXRlcnMubWFwKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoNCk7CiAgICBpZiAocGFyYW1ldGVycy5tYXRjYXApCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSg1KTsKICAgIGlmIChwYXJhbWV0ZXJzLmVudk1hcCkKICAgICAgX3Byb2dyYW1MYXllcnMuZW5hYmxlKDYpOwogICAgaWYgKHBhcmFtZXRlcnMuZW52TWFwQ3ViZVVWKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoNyk7CiAgICBpZiAocGFyYW1ldGVycy5saWdodE1hcCkKICAgICAgX3Byb2dyYW1MYXllcnMuZW5hYmxlKDgpOwogICAgaWYgKHBhcmFtZXRlcnMuYW9NYXApCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSg5KTsKICAgIGlmIChwYXJhbWV0ZXJzLmVtaXNzaXZlTWFwKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMTApOwogICAgaWYgKHBhcmFtZXRlcnMuYnVtcE1hcCkKICAgICAgX3Byb2dyYW1MYXllcnMuZW5hYmxlKDExKTsKICAgIGlmIChwYXJhbWV0ZXJzLm5vcm1hbE1hcCkKICAgICAgX3Byb2dyYW1MYXllcnMuZW5hYmxlKDEyKTsKICAgIGlmIChwYXJhbWV0ZXJzLm9iamVjdFNwYWNlTm9ybWFsTWFwKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMTMpOwogICAgaWYgKHBhcmFtZXRlcnMudGFuZ2VudFNwYWNlTm9ybWFsTWFwKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMTQpOwogICAgaWYgKHBhcmFtZXRlcnMuY2xlYXJjb2F0KQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMTUpOwogICAgaWYgKHBhcmFtZXRlcnMuY2xlYXJjb2F0TWFwKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMTYpOwogICAgaWYgKHBhcmFtZXRlcnMuY2xlYXJjb2F0Um91Z2huZXNzTWFwKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMTcpOwogICAgaWYgKHBhcmFtZXRlcnMuY2xlYXJjb2F0Tm9ybWFsTWFwKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMTgpOwogICAgaWYgKHBhcmFtZXRlcnMuZGlzcGxhY2VtZW50TWFwKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMTkpOwogICAgaWYgKHBhcmFtZXRlcnMuc3BlY3VsYXJNYXApCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgyMCk7CiAgICBpZiAocGFyYW1ldGVycy5yb3VnaG5lc3NNYXApCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgyMSk7CiAgICBpZiAocGFyYW1ldGVycy5tZXRhbG5lc3NNYXApCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgyMik7CiAgICBpZiAocGFyYW1ldGVycy5ncmFkaWVudE1hcCkKICAgICAgX3Byb2dyYW1MYXllcnMuZW5hYmxlKDIzKTsKICAgIGlmIChwYXJhbWV0ZXJzLmFscGhhTWFwKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMjQpOwogICAgaWYgKHBhcmFtZXRlcnMuYWxwaGFUZXN0KQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMjUpOwogICAgaWYgKHBhcmFtZXRlcnMudmVydGV4Q29sb3JzKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMjYpOwogICAgaWYgKHBhcmFtZXRlcnMudmVydGV4QWxwaGFzKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMjcpOwogICAgaWYgKHBhcmFtZXRlcnMudmVydGV4VXZzKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMjgpOwogICAgaWYgKHBhcmFtZXRlcnMudmVydGV4VGFuZ2VudHMpCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgyOSk7CiAgICBpZiAocGFyYW1ldGVycy51dnNWZXJ0ZXhPbmx5KQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMzApOwogICAgaWYgKHBhcmFtZXRlcnMuZm9nKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMzEpOwogICAgYXJyYXkucHVzaChfcHJvZ3JhbUxheWVycy5tYXNrKTsKICAgIF9wcm9ncmFtTGF5ZXJzLmRpc2FibGVBbGwoKTsKICAgIGlmIChwYXJhbWV0ZXJzLnVzZUZvZykKICAgICAgX3Byb2dyYW1MYXllcnMuZW5hYmxlKDApOwogICAgaWYgKHBhcmFtZXRlcnMuZmxhdFNoYWRpbmcpCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgxKTsKICAgIGlmIChwYXJhbWV0ZXJzLmxvZ2FyaXRobWljRGVwdGhCdWZmZXIpCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgyKTsKICAgIGlmIChwYXJhbWV0ZXJzLnNraW5uaW5nKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMyk7CiAgICBpZiAocGFyYW1ldGVycy51c2VWZXJ0ZXhUZXh0dXJlKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoNCk7CiAgICBpZiAocGFyYW1ldGVycy5tb3JwaFRhcmdldHMpCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSg1KTsKICAgIGlmIChwYXJhbWV0ZXJzLm1vcnBoTm9ybWFscykKICAgICAgX3Byb2dyYW1MYXllcnMuZW5hYmxlKDYpOwogICAgaWYgKHBhcmFtZXRlcnMucHJlbXVsdGlwbGllZEFscGhhKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoNyk7CiAgICBpZiAocGFyYW1ldGVycy5zaGFkb3dNYXBFbmFibGVkKQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoOCk7CiAgICBpZiAocGFyYW1ldGVycy5waHlzaWNhbGx5Q29ycmVjdExpZ2h0cykKICAgICAgX3Byb2dyYW1MYXllcnMuZW5hYmxlKDkpOwogICAgaWYgKHBhcmFtZXRlcnMuZG91YmxlU2lkZWQpCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgxMCk7CiAgICBpZiAocGFyYW1ldGVycy5mbGlwU2lkZWQpCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgxMSk7CiAgICBpZiAocGFyYW1ldGVycy5kZXB0aFBhY2tpbmcpCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgxMik7CiAgICBpZiAocGFyYW1ldGVycy5kaXRoZXJpbmcpCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgxMyk7CiAgICBpZiAocGFyYW1ldGVycy5zcGVjdWxhckludGVuc2l0eU1hcCkKICAgICAgX3Byb2dyYW1MYXllcnMuZW5hYmxlKDE0KTsKICAgIGlmIChwYXJhbWV0ZXJzLnNwZWN1bGFyQ29sb3JNYXApCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgxNSk7CiAgICBpZiAocGFyYW1ldGVycy50cmFuc21pc3Npb24pCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgxNik7CiAgICBpZiAocGFyYW1ldGVycy50cmFuc21pc3Npb25NYXApCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgxNyk7CiAgICBpZiAocGFyYW1ldGVycy50aGlja25lc3NNYXApCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgxOCk7CiAgICBpZiAocGFyYW1ldGVycy5zaGVlbikKICAgICAgX3Byb2dyYW1MYXllcnMuZW5hYmxlKDE5KTsKICAgIGlmIChwYXJhbWV0ZXJzLnNoZWVuQ29sb3JNYXApCiAgICAgIF9wcm9ncmFtTGF5ZXJzLmVuYWJsZSgyMCk7CiAgICBpZiAocGFyYW1ldGVycy5zaGVlblJvdWdobmVzc01hcCkKICAgICAgX3Byb2dyYW1MYXllcnMuZW5hYmxlKDIxKTsKICAgIGlmIChwYXJhbWV0ZXJzLmRlY29kZVZpZGVvVGV4dHVyZSkKICAgICAgX3Byb2dyYW1MYXllcnMuZW5hYmxlKDIyKTsKICAgIGlmIChwYXJhbWV0ZXJzLnRyYW5zcGFyZW50KQogICAgICBfcHJvZ3JhbUxheWVycy5lbmFibGUoMjMpOwogICAgYXJyYXkucHVzaChfcHJvZ3JhbUxheWVycy5tYXNrKTsKICB9CiAgZnVuY3Rpb24gZ2V0VW5pZm9ybXMobWF0ZXJpYWwpIHsKICAgIGNvbnN0IHNoYWRlcklEID0gc2hhZGVySURzW21hdGVyaWFsLnR5cGVdOwogICAgbGV0IHVuaWZvcm1zOwogICAgaWYgKHNoYWRlcklEKSB7CiAgICAgIGNvbnN0IHNoYWRlciA9IFNoYWRlckxpYltzaGFkZXJJRF07CiAgICAgIHVuaWZvcm1zID0gVW5pZm9ybXNVdGlscy5jbG9uZShzaGFkZXIudW5pZm9ybXMpOwogICAgfSBlbHNlIHsKICAgICAgdW5pZm9ybXMgPSBtYXRlcmlhbC51bmlmb3JtczsKICAgIH0KICAgIHJldHVybiB1bmlmb3JtczsKICB9CiAgZnVuY3Rpb24gYWNxdWlyZVByb2dyYW0ocGFyYW1ldGVycywgY2FjaGVLZXkpIHsKICAgIGxldCBwcm9ncmFtOwogICAgZm9yIChsZXQgcCA9IDAsIHBsID0gcHJvZ3JhbXMubGVuZ3RoOyBwIDwgcGw7IHArKykgewogICAgICBjb25zdCBwcmVleGlzdGluZ1Byb2dyYW0gPSBwcm9ncmFtc1twXTsKICAgICAgaWYgKHByZWV4aXN0aW5nUHJvZ3JhbS5jYWNoZUtleSA9PT0gY2FjaGVLZXkpIHsKICAgICAgICBwcm9ncmFtID0gcHJlZXhpc3RpbmdQcm9ncmFtOwogICAgICAgICsrcHJvZ3JhbS51c2VkVGltZXM7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgIGlmIChwcm9ncmFtID09PSB2b2lkIDApIHsKICAgICAgcHJvZ3JhbSA9IG5ldyBXZWJHTFByb2dyYW0ocmVuZGVyZXIsIGNhY2hlS2V5LCBwYXJhbWV0ZXJzLCBiaW5kaW5nU3RhdGVzKTsKICAgICAgcHJvZ3JhbXMucHVzaChwcm9ncmFtKTsKICAgIH0KICAgIHJldHVybiBwcm9ncmFtOwogIH0KICBmdW5jdGlvbiByZWxlYXNlUHJvZ3JhbShwcm9ncmFtKSB7CiAgICBpZiAoLS1wcm9ncmFtLnVzZWRUaW1lcyA9PT0gMCkgewogICAgICBjb25zdCBpID0gcHJvZ3JhbXMuaW5kZXhPZihwcm9ncmFtKTsKICAgICAgcHJvZ3JhbXNbaV0gPSBwcm9ncmFtc1twcm9ncmFtcy5sZW5ndGggLSAxXTsKICAgICAgcHJvZ3JhbXMucG9wKCk7CiAgICAgIHByb2dyYW0uZGVzdHJveSgpOwogICAgfQogIH0KICBmdW5jdGlvbiByZWxlYXNlU2hhZGVyQ2FjaGUobWF0ZXJpYWwpIHsKICAgIF9jdXN0b21TaGFkZXJzLnJlbW92ZShtYXRlcmlhbCk7CiAgfQogIGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICBfY3VzdG9tU2hhZGVycy5kaXNwb3NlKCk7CiAgfQogIHJldHVybiB7CiAgICBnZXRQYXJhbWV0ZXJzLAogICAgZ2V0UHJvZ3JhbUNhY2hlS2V5LAogICAgZ2V0VW5pZm9ybXMsCiAgICBhY3F1aXJlUHJvZ3JhbSwKICAgIHJlbGVhc2VQcm9ncmFtLAogICAgcmVsZWFzZVNoYWRlckNhY2hlLAogICAgcHJvZ3JhbXMsCiAgICBkaXNwb3NlCiAgfTsKfQpmdW5jdGlvbiBXZWJHTFByb3BlcnRpZXMoKSB7CiAgbGV0IHByb3BlcnRpZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKICBmdW5jdGlvbiBnZXQob2JqZWN0KSB7CiAgICBsZXQgbWFwID0gcHJvcGVydGllcy5nZXQob2JqZWN0KTsKICAgIGlmIChtYXAgPT09IHZvaWQgMCkgewogICAgICBtYXAgPSB7fTsKICAgICAgcHJvcGVydGllcy5zZXQob2JqZWN0LCBtYXApOwogICAgfQogICAgcmV0dXJuIG1hcDsKICB9CiAgZnVuY3Rpb24gcmVtb3ZlKG9iamVjdCkgewogICAgcHJvcGVydGllcy5kZWxldGUob2JqZWN0KTsKICB9CiAgZnVuY3Rpb24gdXBkYXRlKG9iamVjdCwga2V5LCB2YWx1ZSkgewogICAgcHJvcGVydGllcy5nZXQob2JqZWN0KVtrZXldID0gdmFsdWU7CiAgfQogIGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICBwcm9wZXJ0aWVzID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CiAgfQogIHJldHVybiB7CiAgICBnZXQsCiAgICByZW1vdmUsCiAgICB1cGRhdGUsCiAgICBkaXNwb3NlCiAgfTsKfQpmdW5jdGlvbiBwYWludGVyU29ydFN0YWJsZShhLCBiKSB7CiAgaWYgKGEuZ3JvdXBPcmRlciAhPT0gYi5ncm91cE9yZGVyKSB7CiAgICByZXR1cm4gYS5ncm91cE9yZGVyIC0gYi5ncm91cE9yZGVyOwogIH0gZWxzZSBpZiAoYS5yZW5kZXJPcmRlciAhPT0gYi5yZW5kZXJPcmRlcikgewogICAgcmV0dXJuIGEucmVuZGVyT3JkZXIgLSBiLnJlbmRlck9yZGVyOwogIH0gZWxzZSBpZiAoYS5tYXRlcmlhbC5pZCAhPT0gYi5tYXRlcmlhbC5pZCkgewogICAgcmV0dXJuIGEubWF0ZXJpYWwuaWQgLSBiLm1hdGVyaWFsLmlkOwogIH0gZWxzZSBpZiAoYS56ICE9PSBiLnopIHsKICAgIHJldHVybiBhLnogLSBiLno7CiAgfSBlbHNlIHsKICAgIHJldHVybiBhLmlkIC0gYi5pZDsKICB9Cn0KZnVuY3Rpb24gcmV2ZXJzZVBhaW50ZXJTb3J0U3RhYmxlKGEsIGIpIHsKICBpZiAoYS5ncm91cE9yZGVyICE9PSBiLmdyb3VwT3JkZXIpIHsKICAgIHJldHVybiBhLmdyb3VwT3JkZXIgLSBiLmdyb3VwT3JkZXI7CiAgfSBlbHNlIGlmIChhLnJlbmRlck9yZGVyICE9PSBiLnJlbmRlck9yZGVyKSB7CiAgICByZXR1cm4gYS5yZW5kZXJPcmRlciAtIGIucmVuZGVyT3JkZXI7CiAgfSBlbHNlIGlmIChhLnogIT09IGIueikgewogICAgcmV0dXJuIGIueiAtIGEuejsKICB9IGVsc2UgewogICAgcmV0dXJuIGEuaWQgLSBiLmlkOwogIH0KfQpmdW5jdGlvbiBXZWJHTFJlbmRlckxpc3QoKSB7CiAgY29uc3QgcmVuZGVySXRlbXMgPSBbXTsKICBsZXQgcmVuZGVySXRlbXNJbmRleCA9IDA7CiAgY29uc3Qgb3BhcXVlID0gW107CiAgY29uc3QgdHJhbnNtaXNzaXZlID0gW107CiAgY29uc3QgdHJhbnNwYXJlbnQgPSBbXTsKICBmdW5jdGlvbiBpbml0KCkgewogICAgcmVuZGVySXRlbXNJbmRleCA9IDA7CiAgICBvcGFxdWUubGVuZ3RoID0gMDsKICAgIHRyYW5zbWlzc2l2ZS5sZW5ndGggPSAwOwogICAgdHJhbnNwYXJlbnQubGVuZ3RoID0gMDsKICB9CiAgZnVuY3Rpb24gZ2V0TmV4dFJlbmRlckl0ZW0ob2JqZWN0LCBnZW9tZXRyeSwgbWF0ZXJpYWwsIGdyb3VwT3JkZXIsIHosIGdyb3VwKSB7CiAgICBsZXQgcmVuZGVySXRlbSA9IHJlbmRlckl0ZW1zW3JlbmRlckl0ZW1zSW5kZXhdOwogICAgaWYgKHJlbmRlckl0ZW0gPT09IHZvaWQgMCkgewogICAgICByZW5kZXJJdGVtID0gewogICAgICAgIGlkOiBvYmplY3QuaWQsCiAgICAgICAgb2JqZWN0LAogICAgICAgIGdlb21ldHJ5LAogICAgICAgIG1hdGVyaWFsLAogICAgICAgIGdyb3VwT3JkZXIsCiAgICAgICAgcmVuZGVyT3JkZXI6IG9iamVjdC5yZW5kZXJPcmRlciwKICAgICAgICB6LAogICAgICAgIGdyb3VwCiAgICAgIH07CiAgICAgIHJlbmRlckl0ZW1zW3JlbmRlckl0ZW1zSW5kZXhdID0gcmVuZGVySXRlbTsKICAgIH0gZWxzZSB7CiAgICAgIHJlbmRlckl0ZW0uaWQgPSBvYmplY3QuaWQ7CiAgICAgIHJlbmRlckl0ZW0ub2JqZWN0ID0gb2JqZWN0OwogICAgICByZW5kZXJJdGVtLmdlb21ldHJ5ID0gZ2VvbWV0cnk7CiAgICAgIHJlbmRlckl0ZW0ubWF0ZXJpYWwgPSBtYXRlcmlhbDsKICAgICAgcmVuZGVySXRlbS5ncm91cE9yZGVyID0gZ3JvdXBPcmRlcjsKICAgICAgcmVuZGVySXRlbS5yZW5kZXJPcmRlciA9IG9iamVjdC5yZW5kZXJPcmRlcjsKICAgICAgcmVuZGVySXRlbS56ID0gejsKICAgICAgcmVuZGVySXRlbS5ncm91cCA9IGdyb3VwOwogICAgfQogICAgcmVuZGVySXRlbXNJbmRleCsrOwogICAgcmV0dXJuIHJlbmRlckl0ZW07CiAgfQogIGZ1bmN0aW9uIHB1c2gob2JqZWN0LCBnZW9tZXRyeSwgbWF0ZXJpYWwsIGdyb3VwT3JkZXIsIHosIGdyb3VwKSB7CiAgICBjb25zdCByZW5kZXJJdGVtID0gZ2V0TmV4dFJlbmRlckl0ZW0ob2JqZWN0LCBnZW9tZXRyeSwgbWF0ZXJpYWwsIGdyb3VwT3JkZXIsIHosIGdyb3VwKTsKICAgIGlmIChtYXRlcmlhbC50cmFuc21pc3Npb24gPiAwKSB7CiAgICAgIHRyYW5zbWlzc2l2ZS5wdXNoKHJlbmRlckl0ZW0pOwogICAgfSBlbHNlIGlmIChtYXRlcmlhbC50cmFuc3BhcmVudCA9PT0gdHJ1ZSkgewogICAgICB0cmFuc3BhcmVudC5wdXNoKHJlbmRlckl0ZW0pOwogICAgfSBlbHNlIHsKICAgICAgb3BhcXVlLnB1c2gocmVuZGVySXRlbSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHVuc2hpZnQob2JqZWN0LCBnZW9tZXRyeSwgbWF0ZXJpYWwsIGdyb3VwT3JkZXIsIHosIGdyb3VwKSB7CiAgICBjb25zdCByZW5kZXJJdGVtID0gZ2V0TmV4dFJlbmRlckl0ZW0ob2JqZWN0LCBnZW9tZXRyeSwgbWF0ZXJpYWwsIGdyb3VwT3JkZXIsIHosIGdyb3VwKTsKICAgIGlmIChtYXRlcmlhbC50cmFuc21pc3Npb24gPiAwKSB7CiAgICAgIHRyYW5zbWlzc2l2ZS51bnNoaWZ0KHJlbmRlckl0ZW0pOwogICAgfSBlbHNlIGlmIChtYXRlcmlhbC50cmFuc3BhcmVudCA9PT0gdHJ1ZSkgewogICAgICB0cmFuc3BhcmVudC51bnNoaWZ0KHJlbmRlckl0ZW0pOwogICAgfSBlbHNlIHsKICAgICAgb3BhcXVlLnVuc2hpZnQocmVuZGVySXRlbSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHNvcnQoY3VzdG9tT3BhcXVlU29ydCwgY3VzdG9tVHJhbnNwYXJlbnRTb3J0KSB7CiAgICBpZiAob3BhcXVlLmxlbmd0aCA+IDEpCiAgICAgIG9wYXF1ZS5zb3J0KGN1c3RvbU9wYXF1ZVNvcnQgfHwgcGFpbnRlclNvcnRTdGFibGUpOwogICAgaWYgKHRyYW5zbWlzc2l2ZS5sZW5ndGggPiAxKQogICAgICB0cmFuc21pc3NpdmUuc29ydChjdXN0b21UcmFuc3BhcmVudFNvcnQgfHwgcmV2ZXJzZVBhaW50ZXJTb3J0U3RhYmxlKTsKICAgIGlmICh0cmFuc3BhcmVudC5sZW5ndGggPiAxKQogICAgICB0cmFuc3BhcmVudC5zb3J0KGN1c3RvbVRyYW5zcGFyZW50U29ydCB8fCByZXZlcnNlUGFpbnRlclNvcnRTdGFibGUpOwogIH0KICBmdW5jdGlvbiBmaW5pc2goKSB7CiAgICBmb3IgKGxldCBpID0gcmVuZGVySXRlbXNJbmRleCwgaWwgPSByZW5kZXJJdGVtcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgIGNvbnN0IHJlbmRlckl0ZW0gPSByZW5kZXJJdGVtc1tpXTsKICAgICAgaWYgKHJlbmRlckl0ZW0uaWQgPT09IG51bGwpCiAgICAgICAgYnJlYWs7CiAgICAgIHJlbmRlckl0ZW0uaWQgPSBudWxsOwogICAgICByZW5kZXJJdGVtLm9iamVjdCA9IG51bGw7CiAgICAgIHJlbmRlckl0ZW0uZ2VvbWV0cnkgPSBudWxsOwogICAgICByZW5kZXJJdGVtLm1hdGVyaWFsID0gbnVsbDsKICAgICAgcmVuZGVySXRlbS5ncm91cCA9IG51bGw7CiAgICB9CiAgfQogIHJldHVybiB7CiAgICBvcGFxdWUsCiAgICB0cmFuc21pc3NpdmUsCiAgICB0cmFuc3BhcmVudCwKICAgIGluaXQsCiAgICBwdXNoLAogICAgdW5zaGlmdCwKICAgIGZpbmlzaCwKICAgIHNvcnQKICB9Owp9CmZ1bmN0aW9uIFdlYkdMUmVuZGVyTGlzdHMoKSB7CiAgbGV0IGxpc3RzID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CiAgZnVuY3Rpb24gZ2V0KHNjZW5lLCByZW5kZXJDYWxsRGVwdGgpIHsKICAgIGxldCBsaXN0OwogICAgaWYgKGxpc3RzLmhhcyhzY2VuZSkgPT09IGZhbHNlKSB7CiAgICAgIGxpc3QgPSBuZXcgV2ViR0xSZW5kZXJMaXN0KCk7CiAgICAgIGxpc3RzLnNldChzY2VuZSwgW2xpc3RdKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChyZW5kZXJDYWxsRGVwdGggPj0gbGlzdHMuZ2V0KHNjZW5lKS5sZW5ndGgpIHsKICAgICAgICBsaXN0ID0gbmV3IFdlYkdMUmVuZGVyTGlzdCgpOwogICAgICAgIGxpc3RzLmdldChzY2VuZSkucHVzaChsaXN0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsaXN0ID0gbGlzdHMuZ2V0KHNjZW5lKVtyZW5kZXJDYWxsRGVwdGhdOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gbGlzdDsKICB9CiAgZnVuY3Rpb24gZGlzcG9zZSgpIHsKICAgIGxpc3RzID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CiAgfQogIHJldHVybiB7CiAgICBnZXQsCiAgICBkaXNwb3NlCiAgfTsKfQpmdW5jdGlvbiBVbmlmb3Jtc0NhY2hlKCkgewogIGNvbnN0IGxpZ2h0cyA9IHt9OwogIHJldHVybiB7CiAgICBnZXQ6IGZ1bmN0aW9uKGxpZ2h0KSB7CiAgICAgIGlmIChsaWdodHNbbGlnaHQuaWRdICE9PSB2b2lkIDApIHsKICAgICAgICByZXR1cm4gbGlnaHRzW2xpZ2h0LmlkXTsKICAgICAgfQogICAgICBsZXQgdW5pZm9ybXM7CiAgICAgIHN3aXRjaCAobGlnaHQudHlwZSkgewogICAgICAgIGNhc2UgIkRpcmVjdGlvbmFsTGlnaHQiOgogICAgICAgICAgdW5pZm9ybXMgPSB7CiAgICAgICAgICAgIGRpcmVjdGlvbjogbmV3IFZlY3RvcjMoKSwKICAgICAgICAgICAgY29sb3I6IG5ldyBDb2xvcigpCiAgICAgICAgICB9OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAiU3BvdExpZ2h0IjoKICAgICAgICAgIHVuaWZvcm1zID0gewogICAgICAgICAgICBwb3NpdGlvbjogbmV3IFZlY3RvcjMoKSwKICAgICAgICAgICAgZGlyZWN0aW9uOiBuZXcgVmVjdG9yMygpLAogICAgICAgICAgICBjb2xvcjogbmV3IENvbG9yKCksCiAgICAgICAgICAgIGRpc3RhbmNlOiAwLAogICAgICAgICAgICBjb25lQ29zOiAwLAogICAgICAgICAgICBwZW51bWJyYUNvczogMCwKICAgICAgICAgICAgZGVjYXk6IDAKICAgICAgICAgIH07CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJQb2ludExpZ2h0IjoKICAgICAgICAgIHVuaWZvcm1zID0gewogICAgICAgICAgICBwb3NpdGlvbjogbmV3IFZlY3RvcjMoKSwKICAgICAgICAgICAgY29sb3I6IG5ldyBDb2xvcigpLAogICAgICAgICAgICBkaXN0YW5jZTogMCwKICAgICAgICAgICAgZGVjYXk6IDAKICAgICAgICAgIH07CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJIZW1pc3BoZXJlTGlnaHQiOgogICAgICAgICAgdW5pZm9ybXMgPSB7CiAgICAgICAgICAgIGRpcmVjdGlvbjogbmV3IFZlY3RvcjMoKSwKICAgICAgICAgICAgc2t5Q29sb3I6IG5ldyBDb2xvcigpLAogICAgICAgICAgICBncm91bmRDb2xvcjogbmV3IENvbG9yKCkKICAgICAgICAgIH07CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJSZWN0QXJlYUxpZ2h0IjoKICAgICAgICAgIHVuaWZvcm1zID0gewogICAgICAgICAgICBjb2xvcjogbmV3IENvbG9yKCksCiAgICAgICAgICAgIHBvc2l0aW9uOiBuZXcgVmVjdG9yMygpLAogICAgICAgICAgICBoYWxmV2lkdGg6IG5ldyBWZWN0b3IzKCksCiAgICAgICAgICAgIGhhbGZIZWlnaHQ6IG5ldyBWZWN0b3IzKCkKICAgICAgICAgIH07CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgICBsaWdodHNbbGlnaHQuaWRdID0gdW5pZm9ybXM7CiAgICAgIHJldHVybiB1bmlmb3JtczsKICAgIH0KICB9Owp9CmZ1bmN0aW9uIFNoYWRvd1VuaWZvcm1zQ2FjaGUoKSB7CiAgY29uc3QgbGlnaHRzID0ge307CiAgcmV0dXJuIHsKICAgIGdldDogZnVuY3Rpb24obGlnaHQpIHsKICAgICAgaWYgKGxpZ2h0c1tsaWdodC5pZF0gIT09IHZvaWQgMCkgewogICAgICAgIHJldHVybiBsaWdodHNbbGlnaHQuaWRdOwogICAgICB9CiAgICAgIGxldCB1bmlmb3JtczsKICAgICAgc3dpdGNoIChsaWdodC50eXBlKSB7CiAgICAgICAgY2FzZSAiRGlyZWN0aW9uYWxMaWdodCI6CiAgICAgICAgICB1bmlmb3JtcyA9IHsKICAgICAgICAgICAgc2hhZG93QmlhczogMCwKICAgICAgICAgICAgc2hhZG93Tm9ybWFsQmlhczogMCwKICAgICAgICAgICAgc2hhZG93UmFkaXVzOiAxLAogICAgICAgICAgICBzaGFkb3dNYXBTaXplOiBuZXcgVmVjdG9yMigpCiAgICAgICAgICB9OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAiU3BvdExpZ2h0IjoKICAgICAgICAgIHVuaWZvcm1zID0gewogICAgICAgICAgICBzaGFkb3dCaWFzOiAwLAogICAgICAgICAgICBzaGFkb3dOb3JtYWxCaWFzOiAwLAogICAgICAgICAgICBzaGFkb3dSYWRpdXM6IDEsCiAgICAgICAgICAgIHNoYWRvd01hcFNpemU6IG5ldyBWZWN0b3IyKCkKICAgICAgICAgIH07CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJQb2ludExpZ2h0IjoKICAgICAgICAgIHVuaWZvcm1zID0gewogICAgICAgICAgICBzaGFkb3dCaWFzOiAwLAogICAgICAgICAgICBzaGFkb3dOb3JtYWxCaWFzOiAwLAogICAgICAgICAgICBzaGFkb3dSYWRpdXM6IDEsCiAgICAgICAgICAgIHNoYWRvd01hcFNpemU6IG5ldyBWZWN0b3IyKCksCiAgICAgICAgICAgIHNoYWRvd0NhbWVyYU5lYXI6IDEsCiAgICAgICAgICAgIHNoYWRvd0NhbWVyYUZhcjogMWUzCiAgICAgICAgICB9OwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgbGlnaHRzW2xpZ2h0LmlkXSA9IHVuaWZvcm1zOwogICAgICByZXR1cm4gdW5pZm9ybXM7CiAgICB9CiAgfTsKfQpsZXQgbmV4dFZlcnNpb24gPSAwOwpmdW5jdGlvbiBzaGFkb3dDYXN0aW5nTGlnaHRzRmlyc3QobGlnaHRBLCBsaWdodEIpIHsKICByZXR1cm4gKGxpZ2h0Qi5jYXN0U2hhZG93ID8gMSA6IDApIC0gKGxpZ2h0QS5jYXN0U2hhZG93ID8gMSA6IDApOwp9CmZ1bmN0aW9uIFdlYkdMTGlnaHRzKGV4dGVuc2lvbnMsIGNhcGFiaWxpdGllcykgewogIGNvbnN0IGNhY2hlID0gbmV3IFVuaWZvcm1zQ2FjaGUoKTsKICBjb25zdCBzaGFkb3dDYWNoZSA9IFNoYWRvd1VuaWZvcm1zQ2FjaGUoKTsKICBjb25zdCBzdGF0ZSA9IHsKICAgIHZlcnNpb246IDAsCiAgICBoYXNoOiB7CiAgICAgIGRpcmVjdGlvbmFsTGVuZ3RoOiAtMSwKICAgICAgcG9pbnRMZW5ndGg6IC0xLAogICAgICBzcG90TGVuZ3RoOiAtMSwKICAgICAgcmVjdEFyZWFMZW5ndGg6IC0xLAogICAgICBoZW1pTGVuZ3RoOiAtMSwKICAgICAgbnVtRGlyZWN0aW9uYWxTaGFkb3dzOiAtMSwKICAgICAgbnVtUG9pbnRTaGFkb3dzOiAtMSwKICAgICAgbnVtU3BvdFNoYWRvd3M6IC0xCiAgICB9LAogICAgYW1iaWVudDogWzAsIDAsIDBdLAogICAgcHJvYmU6IFtdLAogICAgZGlyZWN0aW9uYWw6IFtdLAogICAgZGlyZWN0aW9uYWxTaGFkb3c6IFtdLAogICAgZGlyZWN0aW9uYWxTaGFkb3dNYXA6IFtdLAogICAgZGlyZWN0aW9uYWxTaGFkb3dNYXRyaXg6IFtdLAogICAgc3BvdDogW10sCiAgICBzcG90U2hhZG93OiBbXSwKICAgIHNwb3RTaGFkb3dNYXA6IFtdLAogICAgc3BvdFNoYWRvd01hdHJpeDogW10sCiAgICByZWN0QXJlYTogW10sCiAgICByZWN0QXJlYUxUQzE6IG51bGwsCiAgICByZWN0QXJlYUxUQzI6IG51bGwsCiAgICBwb2ludDogW10sCiAgICBwb2ludFNoYWRvdzogW10sCiAgICBwb2ludFNoYWRvd01hcDogW10sCiAgICBwb2ludFNoYWRvd01hdHJpeDogW10sCiAgICBoZW1pOiBbXQogIH07CiAgZm9yIChsZXQgaSA9IDA7IGkgPCA5OyBpKyspCiAgICBzdGF0ZS5wcm9iZS5wdXNoKG5ldyBWZWN0b3IzKCkpOwogIGNvbnN0IHZlY3RvcjMgPSBuZXcgVmVjdG9yMygpOwogIGNvbnN0IG1hdHJpeDQgPSBuZXcgTWF0cml4NCgpOwogIGNvbnN0IG1hdHJpeDQyID0gbmV3IE1hdHJpeDQoKTsKICBmdW5jdGlvbiBzZXR1cChsaWdodHMsIHBoeXNpY2FsbHlDb3JyZWN0TGlnaHRzKSB7CiAgICBsZXQgciA9IDAsIGcgPSAwLCBiID0gMDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgOTsgaSsrKQogICAgICBzdGF0ZS5wcm9iZVtpXS5zZXQoMCwgMCwgMCk7CiAgICBsZXQgZGlyZWN0aW9uYWxMZW5ndGggPSAwOwogICAgbGV0IHBvaW50TGVuZ3RoID0gMDsKICAgIGxldCBzcG90TGVuZ3RoID0gMDsKICAgIGxldCByZWN0QXJlYUxlbmd0aCA9IDA7CiAgICBsZXQgaGVtaUxlbmd0aCA9IDA7CiAgICBsZXQgbnVtRGlyZWN0aW9uYWxTaGFkb3dzID0gMDsKICAgIGxldCBudW1Qb2ludFNoYWRvd3MgPSAwOwogICAgbGV0IG51bVNwb3RTaGFkb3dzID0gMDsKICAgIGxpZ2h0cy5zb3J0KHNoYWRvd0Nhc3RpbmdMaWdodHNGaXJzdCk7CiAgICBjb25zdCBzY2FsZUZhY3RvciA9IHBoeXNpY2FsbHlDb3JyZWN0TGlnaHRzICE9PSB0cnVlID8gTWF0aC5QSSA6IDE7CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IGxpZ2h0cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgY29uc3QgbGlnaHQgPSBsaWdodHNbaV07CiAgICAgIGNvbnN0IGNvbG9yID0gbGlnaHQuY29sb3I7CiAgICAgIGNvbnN0IGludGVuc2l0eSA9IGxpZ2h0LmludGVuc2l0eTsKICAgICAgY29uc3QgZGlzdGFuY2UgPSBsaWdodC5kaXN0YW5jZTsKICAgICAgY29uc3Qgc2hhZG93TWFwID0gbGlnaHQuc2hhZG93ICYmIGxpZ2h0LnNoYWRvdy5tYXAgPyBsaWdodC5zaGFkb3cubWFwLnRleHR1cmUgOiBudWxsOwogICAgICBpZiAobGlnaHQuaXNBbWJpZW50TGlnaHQpIHsKICAgICAgICByICs9IGNvbG9yLnIgKiBpbnRlbnNpdHkgKiBzY2FsZUZhY3RvcjsKICAgICAgICBnICs9IGNvbG9yLmcgKiBpbnRlbnNpdHkgKiBzY2FsZUZhY3RvcjsKICAgICAgICBiICs9IGNvbG9yLmIgKiBpbnRlbnNpdHkgKiBzY2FsZUZhY3RvcjsKICAgICAgfSBlbHNlIGlmIChsaWdodC5pc0xpZ2h0UHJvYmUpIHsKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDk7IGorKykgewogICAgICAgICAgc3RhdGUucHJvYmVbal0uYWRkU2NhbGVkVmVjdG9yKGxpZ2h0LnNoLmNvZWZmaWNpZW50c1tqXSwgaW50ZW5zaXR5KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAobGlnaHQuaXNEaXJlY3Rpb25hbExpZ2h0KSB7CiAgICAgICAgY29uc3QgdW5pZm9ybXMgPSBjYWNoZS5nZXQobGlnaHQpOwogICAgICAgIHVuaWZvcm1zLmNvbG9yLmNvcHkobGlnaHQuY29sb3IpLm11bHRpcGx5U2NhbGFyKGxpZ2h0LmludGVuc2l0eSAqIHNjYWxlRmFjdG9yKTsKICAgICAgICBpZiAobGlnaHQuY2FzdFNoYWRvdykgewogICAgICAgICAgY29uc3Qgc2hhZG93ID0gbGlnaHQuc2hhZG93OwogICAgICAgICAgY29uc3Qgc2hhZG93VW5pZm9ybXMgPSBzaGFkb3dDYWNoZS5nZXQobGlnaHQpOwogICAgICAgICAgc2hhZG93VW5pZm9ybXMuc2hhZG93QmlhcyA9IHNoYWRvdy5iaWFzOwogICAgICAgICAgc2hhZG93VW5pZm9ybXMuc2hhZG93Tm9ybWFsQmlhcyA9IHNoYWRvdy5ub3JtYWxCaWFzOwogICAgICAgICAgc2hhZG93VW5pZm9ybXMuc2hhZG93UmFkaXVzID0gc2hhZG93LnJhZGl1czsKICAgICAgICAgIHNoYWRvd1VuaWZvcm1zLnNoYWRvd01hcFNpemUgPSBzaGFkb3cubWFwU2l6ZTsKICAgICAgICAgIHN0YXRlLmRpcmVjdGlvbmFsU2hhZG93W2RpcmVjdGlvbmFsTGVuZ3RoXSA9IHNoYWRvd1VuaWZvcm1zOwogICAgICAgICAgc3RhdGUuZGlyZWN0aW9uYWxTaGFkb3dNYXBbZGlyZWN0aW9uYWxMZW5ndGhdID0gc2hhZG93TWFwOwogICAgICAgICAgc3RhdGUuZGlyZWN0aW9uYWxTaGFkb3dNYXRyaXhbZGlyZWN0aW9uYWxMZW5ndGhdID0gbGlnaHQuc2hhZG93Lm1hdHJpeDsKICAgICAgICAgIG51bURpcmVjdGlvbmFsU2hhZG93cysrOwogICAgICAgIH0KICAgICAgICBzdGF0ZS5kaXJlY3Rpb25hbFtkaXJlY3Rpb25hbExlbmd0aF0gPSB1bmlmb3JtczsKICAgICAgICBkaXJlY3Rpb25hbExlbmd0aCsrOwogICAgICB9IGVsc2UgaWYgKGxpZ2h0LmlzU3BvdExpZ2h0KSB7CiAgICAgICAgY29uc3QgdW5pZm9ybXMgPSBjYWNoZS5nZXQobGlnaHQpOwogICAgICAgIHVuaWZvcm1zLnBvc2l0aW9uLnNldEZyb21NYXRyaXhQb3NpdGlvbihsaWdodC5tYXRyaXhXb3JsZCk7CiAgICAgICAgdW5pZm9ybXMuY29sb3IuY29weShjb2xvcikubXVsdGlwbHlTY2FsYXIoaW50ZW5zaXR5ICogc2NhbGVGYWN0b3IpOwogICAgICAgIHVuaWZvcm1zLmRpc3RhbmNlID0gZGlzdGFuY2U7CiAgICAgICAgdW5pZm9ybXMuY29uZUNvcyA9IE1hdGguY29zKGxpZ2h0LmFuZ2xlKTsKICAgICAgICB1bmlmb3Jtcy5wZW51bWJyYUNvcyA9IE1hdGguY29zKGxpZ2h0LmFuZ2xlICogKDEgLSBsaWdodC5wZW51bWJyYSkpOwogICAgICAgIHVuaWZvcm1zLmRlY2F5ID0gbGlnaHQuZGVjYXk7CiAgICAgICAgaWYgKGxpZ2h0LmNhc3RTaGFkb3cpIHsKICAgICAgICAgIGNvbnN0IHNoYWRvdyA9IGxpZ2h0LnNoYWRvdzsKICAgICAgICAgIGNvbnN0IHNoYWRvd1VuaWZvcm1zID0gc2hhZG93Q2FjaGUuZ2V0KGxpZ2h0KTsKICAgICAgICAgIHNoYWRvd1VuaWZvcm1zLnNoYWRvd0JpYXMgPSBzaGFkb3cuYmlhczsKICAgICAgICAgIHNoYWRvd1VuaWZvcm1zLnNoYWRvd05vcm1hbEJpYXMgPSBzaGFkb3cubm9ybWFsQmlhczsKICAgICAgICAgIHNoYWRvd1VuaWZvcm1zLnNoYWRvd1JhZGl1cyA9IHNoYWRvdy5yYWRpdXM7CiAgICAgICAgICBzaGFkb3dVbmlmb3Jtcy5zaGFkb3dNYXBTaXplID0gc2hhZG93Lm1hcFNpemU7CiAgICAgICAgICBzdGF0ZS5zcG90U2hhZG93W3Nwb3RMZW5ndGhdID0gc2hhZG93VW5pZm9ybXM7CiAgICAgICAgICBzdGF0ZS5zcG90U2hhZG93TWFwW3Nwb3RMZW5ndGhdID0gc2hhZG93TWFwOwogICAgICAgICAgc3RhdGUuc3BvdFNoYWRvd01hdHJpeFtzcG90TGVuZ3RoXSA9IGxpZ2h0LnNoYWRvdy5tYXRyaXg7CiAgICAgICAgICBudW1TcG90U2hhZG93cysrOwogICAgICAgIH0KICAgICAgICBzdGF0ZS5zcG90W3Nwb3RMZW5ndGhdID0gdW5pZm9ybXM7CiAgICAgICAgc3BvdExlbmd0aCsrOwogICAgICB9IGVsc2UgaWYgKGxpZ2h0LmlzUmVjdEFyZWFMaWdodCkgewogICAgICAgIGNvbnN0IHVuaWZvcm1zID0gY2FjaGUuZ2V0KGxpZ2h0KTsKICAgICAgICB1bmlmb3Jtcy5jb2xvci5jb3B5KGNvbG9yKS5tdWx0aXBseVNjYWxhcihpbnRlbnNpdHkpOwogICAgICAgIHVuaWZvcm1zLmhhbGZXaWR0aC5zZXQobGlnaHQud2lkdGggKiAwLjUsIDAsIDApOwogICAgICAgIHVuaWZvcm1zLmhhbGZIZWlnaHQuc2V0KDAsIGxpZ2h0LmhlaWdodCAqIDAuNSwgMCk7CiAgICAgICAgc3RhdGUucmVjdEFyZWFbcmVjdEFyZWFMZW5ndGhdID0gdW5pZm9ybXM7CiAgICAgICAgcmVjdEFyZWFMZW5ndGgrKzsKICAgICAgfSBlbHNlIGlmIChsaWdodC5pc1BvaW50TGlnaHQpIHsKICAgICAgICBjb25zdCB1bmlmb3JtcyA9IGNhY2hlLmdldChsaWdodCk7CiAgICAgICAgdW5pZm9ybXMuY29sb3IuY29weShsaWdodC5jb2xvcikubXVsdGlwbHlTY2FsYXIobGlnaHQuaW50ZW5zaXR5ICogc2NhbGVGYWN0b3IpOwogICAgICAgIHVuaWZvcm1zLmRpc3RhbmNlID0gbGlnaHQuZGlzdGFuY2U7CiAgICAgICAgdW5pZm9ybXMuZGVjYXkgPSBsaWdodC5kZWNheTsKICAgICAgICBpZiAobGlnaHQuY2FzdFNoYWRvdykgewogICAgICAgICAgY29uc3Qgc2hhZG93ID0gbGlnaHQuc2hhZG93OwogICAgICAgICAgY29uc3Qgc2hhZG93VW5pZm9ybXMgPSBzaGFkb3dDYWNoZS5nZXQobGlnaHQpOwogICAgICAgICAgc2hhZG93VW5pZm9ybXMuc2hhZG93QmlhcyA9IHNoYWRvdy5iaWFzOwogICAgICAgICAgc2hhZG93VW5pZm9ybXMuc2hhZG93Tm9ybWFsQmlhcyA9IHNoYWRvdy5ub3JtYWxCaWFzOwogICAgICAgICAgc2hhZG93VW5pZm9ybXMuc2hhZG93UmFkaXVzID0gc2hhZG93LnJhZGl1czsKICAgICAgICAgIHNoYWRvd1VuaWZvcm1zLnNoYWRvd01hcFNpemUgPSBzaGFkb3cubWFwU2l6ZTsKICAgICAgICAgIHNoYWRvd1VuaWZvcm1zLnNoYWRvd0NhbWVyYU5lYXIgPSBzaGFkb3cuY2FtZXJhLm5lYXI7CiAgICAgICAgICBzaGFkb3dVbmlmb3Jtcy5zaGFkb3dDYW1lcmFGYXIgPSBzaGFkb3cuY2FtZXJhLmZhcjsKICAgICAgICAgIHN0YXRlLnBvaW50U2hhZG93W3BvaW50TGVuZ3RoXSA9IHNoYWRvd1VuaWZvcm1zOwogICAgICAgICAgc3RhdGUucG9pbnRTaGFkb3dNYXBbcG9pbnRMZW5ndGhdID0gc2hhZG93TWFwOwogICAgICAgICAgc3RhdGUucG9pbnRTaGFkb3dNYXRyaXhbcG9pbnRMZW5ndGhdID0gbGlnaHQuc2hhZG93Lm1hdHJpeDsKICAgICAgICAgIG51bVBvaW50U2hhZG93cysrOwogICAgICAgIH0KICAgICAgICBzdGF0ZS5wb2ludFtwb2ludExlbmd0aF0gPSB1bmlmb3JtczsKICAgICAgICBwb2ludExlbmd0aCsrOwogICAgICB9IGVsc2UgaWYgKGxpZ2h0LmlzSGVtaXNwaGVyZUxpZ2h0KSB7CiAgICAgICAgY29uc3QgdW5pZm9ybXMgPSBjYWNoZS5nZXQobGlnaHQpOwogICAgICAgIHVuaWZvcm1zLnNreUNvbG9yLmNvcHkobGlnaHQuY29sb3IpLm11bHRpcGx5U2NhbGFyKGludGVuc2l0eSAqIHNjYWxlRmFjdG9yKTsKICAgICAgICB1bmlmb3Jtcy5ncm91bmRDb2xvci5jb3B5KGxpZ2h0Lmdyb3VuZENvbG9yKS5tdWx0aXBseVNjYWxhcihpbnRlbnNpdHkgKiBzY2FsZUZhY3Rvcik7CiAgICAgICAgc3RhdGUuaGVtaVtoZW1pTGVuZ3RoXSA9IHVuaWZvcm1zOwogICAgICAgIGhlbWlMZW5ndGgrKzsKICAgICAgfQogICAgfQogICAgaWYgKHJlY3RBcmVhTGVuZ3RoID4gMCkgewogICAgICBpZiAoY2FwYWJpbGl0aWVzLmlzV2ViR0wyKSB7CiAgICAgICAgc3RhdGUucmVjdEFyZWFMVEMxID0gVW5pZm9ybXNMaWIuTFRDX0ZMT0FUXzE7CiAgICAgICAgc3RhdGUucmVjdEFyZWFMVEMyID0gVW5pZm9ybXNMaWIuTFRDX0ZMT0FUXzI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGV4dGVuc2lvbnMuaGFzKCJPRVNfdGV4dHVyZV9mbG9hdF9saW5lYXIiKSA9PT0gdHJ1ZSkgewogICAgICAgICAgc3RhdGUucmVjdEFyZWFMVEMxID0gVW5pZm9ybXNMaWIuTFRDX0ZMT0FUXzE7CiAgICAgICAgICBzdGF0ZS5yZWN0QXJlYUxUQzIgPSBVbmlmb3Jtc0xpYi5MVENfRkxPQVRfMjsKICAgICAgICB9IGVsc2UgaWYgKGV4dGVuc2lvbnMuaGFzKCJPRVNfdGV4dHVyZV9oYWxmX2Zsb2F0X2xpbmVhciIpID09PSB0cnVlKSB7CiAgICAgICAgICBzdGF0ZS5yZWN0QXJlYUxUQzEgPSBVbmlmb3Jtc0xpYi5MVENfSEFMRl8xOwogICAgICAgICAgc3RhdGUucmVjdEFyZWFMVEMyID0gVW5pZm9ybXNMaWIuTFRDX0hBTEZfMjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuV2ViR0xSZW5kZXJlcjogVW5hYmxlIHRvIHVzZSBSZWN0QXJlYUxpZ2h0LiBNaXNzaW5nIFdlYkdMIGV4dGVuc2lvbnMuIik7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBzdGF0ZS5hbWJpZW50WzBdID0gcjsKICAgIHN0YXRlLmFtYmllbnRbMV0gPSBnOwogICAgc3RhdGUuYW1iaWVudFsyXSA9IGI7CiAgICBjb25zdCBoYXNoID0gc3RhdGUuaGFzaDsKICAgIGlmIChoYXNoLmRpcmVjdGlvbmFsTGVuZ3RoICE9PSBkaXJlY3Rpb25hbExlbmd0aCB8fCBoYXNoLnBvaW50TGVuZ3RoICE9PSBwb2ludExlbmd0aCB8fCBoYXNoLnNwb3RMZW5ndGggIT09IHNwb3RMZW5ndGggfHwgaGFzaC5yZWN0QXJlYUxlbmd0aCAhPT0gcmVjdEFyZWFMZW5ndGggfHwgaGFzaC5oZW1pTGVuZ3RoICE9PSBoZW1pTGVuZ3RoIHx8IGhhc2gubnVtRGlyZWN0aW9uYWxTaGFkb3dzICE9PSBudW1EaXJlY3Rpb25hbFNoYWRvd3MgfHwgaGFzaC5udW1Qb2ludFNoYWRvd3MgIT09IG51bVBvaW50U2hhZG93cyB8fCBoYXNoLm51bVNwb3RTaGFkb3dzICE9PSBudW1TcG90U2hhZG93cykgewogICAgICBzdGF0ZS5kaXJlY3Rpb25hbC5sZW5ndGggPSBkaXJlY3Rpb25hbExlbmd0aDsKICAgICAgc3RhdGUuc3BvdC5sZW5ndGggPSBzcG90TGVuZ3RoOwogICAgICBzdGF0ZS5yZWN0QXJlYS5sZW5ndGggPSByZWN0QXJlYUxlbmd0aDsKICAgICAgc3RhdGUucG9pbnQubGVuZ3RoID0gcG9pbnRMZW5ndGg7CiAgICAgIHN0YXRlLmhlbWkubGVuZ3RoID0gaGVtaUxlbmd0aDsKICAgICAgc3RhdGUuZGlyZWN0aW9uYWxTaGFkb3cubGVuZ3RoID0gbnVtRGlyZWN0aW9uYWxTaGFkb3dzOwogICAgICBzdGF0ZS5kaXJlY3Rpb25hbFNoYWRvd01hcC5sZW5ndGggPSBudW1EaXJlY3Rpb25hbFNoYWRvd3M7CiAgICAgIHN0YXRlLnBvaW50U2hhZG93Lmxlbmd0aCA9IG51bVBvaW50U2hhZG93czsKICAgICAgc3RhdGUucG9pbnRTaGFkb3dNYXAubGVuZ3RoID0gbnVtUG9pbnRTaGFkb3dzOwogICAgICBzdGF0ZS5zcG90U2hhZG93Lmxlbmd0aCA9IG51bVNwb3RTaGFkb3dzOwogICAgICBzdGF0ZS5zcG90U2hhZG93TWFwLmxlbmd0aCA9IG51bVNwb3RTaGFkb3dzOwogICAgICBzdGF0ZS5kaXJlY3Rpb25hbFNoYWRvd01hdHJpeC5sZW5ndGggPSBudW1EaXJlY3Rpb25hbFNoYWRvd3M7CiAgICAgIHN0YXRlLnBvaW50U2hhZG93TWF0cml4Lmxlbmd0aCA9IG51bVBvaW50U2hhZG93czsKICAgICAgc3RhdGUuc3BvdFNoYWRvd01hdHJpeC5sZW5ndGggPSBudW1TcG90U2hhZG93czsKICAgICAgaGFzaC5kaXJlY3Rpb25hbExlbmd0aCA9IGRpcmVjdGlvbmFsTGVuZ3RoOwogICAgICBoYXNoLnBvaW50TGVuZ3RoID0gcG9pbnRMZW5ndGg7CiAgICAgIGhhc2guc3BvdExlbmd0aCA9IHNwb3RMZW5ndGg7CiAgICAgIGhhc2gucmVjdEFyZWFMZW5ndGggPSByZWN0QXJlYUxlbmd0aDsKICAgICAgaGFzaC5oZW1pTGVuZ3RoID0gaGVtaUxlbmd0aDsKICAgICAgaGFzaC5udW1EaXJlY3Rpb25hbFNoYWRvd3MgPSBudW1EaXJlY3Rpb25hbFNoYWRvd3M7CiAgICAgIGhhc2gubnVtUG9pbnRTaGFkb3dzID0gbnVtUG9pbnRTaGFkb3dzOwogICAgICBoYXNoLm51bVNwb3RTaGFkb3dzID0gbnVtU3BvdFNoYWRvd3M7CiAgICAgIHN0YXRlLnZlcnNpb24gPSBuZXh0VmVyc2lvbisrOwogICAgfQogIH0KICBmdW5jdGlvbiBzZXR1cFZpZXcobGlnaHRzLCBjYW1lcmEpIHsKICAgIGxldCBkaXJlY3Rpb25hbExlbmd0aCA9IDA7CiAgICBsZXQgcG9pbnRMZW5ndGggPSAwOwogICAgbGV0IHNwb3RMZW5ndGggPSAwOwogICAgbGV0IHJlY3RBcmVhTGVuZ3RoID0gMDsKICAgIGxldCBoZW1pTGVuZ3RoID0gMDsKICAgIGNvbnN0IHZpZXdNYXRyaXggPSBjYW1lcmEubWF0cml4V29ybGRJbnZlcnNlOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSBsaWdodHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIGNvbnN0IGxpZ2h0ID0gbGlnaHRzW2ldOwogICAgICBpZiAobGlnaHQuaXNEaXJlY3Rpb25hbExpZ2h0KSB7CiAgICAgICAgY29uc3QgdW5pZm9ybXMgPSBzdGF0ZS5kaXJlY3Rpb25hbFtkaXJlY3Rpb25hbExlbmd0aF07CiAgICAgICAgdW5pZm9ybXMuZGlyZWN0aW9uLnNldEZyb21NYXRyaXhQb3NpdGlvbihsaWdodC5tYXRyaXhXb3JsZCk7CiAgICAgICAgdmVjdG9yMy5zZXRGcm9tTWF0cml4UG9zaXRpb24obGlnaHQudGFyZ2V0Lm1hdHJpeFdvcmxkKTsKICAgICAgICB1bmlmb3Jtcy5kaXJlY3Rpb24uc3ViKHZlY3RvcjMpOwogICAgICAgIHVuaWZvcm1zLmRpcmVjdGlvbi50cmFuc2Zvcm1EaXJlY3Rpb24odmlld01hdHJpeCk7CiAgICAgICAgZGlyZWN0aW9uYWxMZW5ndGgrKzsKICAgICAgfSBlbHNlIGlmIChsaWdodC5pc1Nwb3RMaWdodCkgewogICAgICAgIGNvbnN0IHVuaWZvcm1zID0gc3RhdGUuc3BvdFtzcG90TGVuZ3RoXTsKICAgICAgICB1bmlmb3Jtcy5wb3NpdGlvbi5zZXRGcm9tTWF0cml4UG9zaXRpb24obGlnaHQubWF0cml4V29ybGQpOwogICAgICAgIHVuaWZvcm1zLnBvc2l0aW9uLmFwcGx5TWF0cml4NCh2aWV3TWF0cml4KTsKICAgICAgICB1bmlmb3Jtcy5kaXJlY3Rpb24uc2V0RnJvbU1hdHJpeFBvc2l0aW9uKGxpZ2h0Lm1hdHJpeFdvcmxkKTsKICAgICAgICB2ZWN0b3IzLnNldEZyb21NYXRyaXhQb3NpdGlvbihsaWdodC50YXJnZXQubWF0cml4V29ybGQpOwogICAgICAgIHVuaWZvcm1zLmRpcmVjdGlvbi5zdWIodmVjdG9yMyk7CiAgICAgICAgdW5pZm9ybXMuZGlyZWN0aW9uLnRyYW5zZm9ybURpcmVjdGlvbih2aWV3TWF0cml4KTsKICAgICAgICBzcG90TGVuZ3RoKys7CiAgICAgIH0gZWxzZSBpZiAobGlnaHQuaXNSZWN0QXJlYUxpZ2h0KSB7CiAgICAgICAgY29uc3QgdW5pZm9ybXMgPSBzdGF0ZS5yZWN0QXJlYVtyZWN0QXJlYUxlbmd0aF07CiAgICAgICAgdW5pZm9ybXMucG9zaXRpb24uc2V0RnJvbU1hdHJpeFBvc2l0aW9uKGxpZ2h0Lm1hdHJpeFdvcmxkKTsKICAgICAgICB1bmlmb3Jtcy5wb3NpdGlvbi5hcHBseU1hdHJpeDQodmlld01hdHJpeCk7CiAgICAgICAgbWF0cml4NDIuaWRlbnRpdHkoKTsKICAgICAgICBtYXRyaXg0LmNvcHkobGlnaHQubWF0cml4V29ybGQpOwogICAgICAgIG1hdHJpeDQucHJlbXVsdGlwbHkodmlld01hdHJpeCk7CiAgICAgICAgbWF0cml4NDIuZXh0cmFjdFJvdGF0aW9uKG1hdHJpeDQpOwogICAgICAgIHVuaWZvcm1zLmhhbGZXaWR0aC5zZXQobGlnaHQud2lkdGggKiAwLjUsIDAsIDApOwogICAgICAgIHVuaWZvcm1zLmhhbGZIZWlnaHQuc2V0KDAsIGxpZ2h0LmhlaWdodCAqIDAuNSwgMCk7CiAgICAgICAgdW5pZm9ybXMuaGFsZldpZHRoLmFwcGx5TWF0cml4NChtYXRyaXg0Mik7CiAgICAgICAgdW5pZm9ybXMuaGFsZkhlaWdodC5hcHBseU1hdHJpeDQobWF0cml4NDIpOwogICAgICAgIHJlY3RBcmVhTGVuZ3RoKys7CiAgICAgIH0gZWxzZSBpZiAobGlnaHQuaXNQb2ludExpZ2h0KSB7CiAgICAgICAgY29uc3QgdW5pZm9ybXMgPSBzdGF0ZS5wb2ludFtwb2ludExlbmd0aF07CiAgICAgICAgdW5pZm9ybXMucG9zaXRpb24uc2V0RnJvbU1hdHJpeFBvc2l0aW9uKGxpZ2h0Lm1hdHJpeFdvcmxkKTsKICAgICAgICB1bmlmb3Jtcy5wb3NpdGlvbi5hcHBseU1hdHJpeDQodmlld01hdHJpeCk7CiAgICAgICAgcG9pbnRMZW5ndGgrKzsKICAgICAgfSBlbHNlIGlmIChsaWdodC5pc0hlbWlzcGhlcmVMaWdodCkgewogICAgICAgIGNvbnN0IHVuaWZvcm1zID0gc3RhdGUuaGVtaVtoZW1pTGVuZ3RoXTsKICAgICAgICB1bmlmb3Jtcy5kaXJlY3Rpb24uc2V0RnJvbU1hdHJpeFBvc2l0aW9uKGxpZ2h0Lm1hdHJpeFdvcmxkKTsKICAgICAgICB1bmlmb3Jtcy5kaXJlY3Rpb24udHJhbnNmb3JtRGlyZWN0aW9uKHZpZXdNYXRyaXgpOwogICAgICAgIHVuaWZvcm1zLmRpcmVjdGlvbi5ub3JtYWxpemUoKTsKICAgICAgICBoZW1pTGVuZ3RoKys7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIHsKICAgIHNldHVwLAogICAgc2V0dXBWaWV3LAogICAgc3RhdGUKICB9Owp9CmZ1bmN0aW9uIFdlYkdMUmVuZGVyU3RhdGUoZXh0ZW5zaW9ucywgY2FwYWJpbGl0aWVzKSB7CiAgY29uc3QgbGlnaHRzID0gbmV3IFdlYkdMTGlnaHRzKGV4dGVuc2lvbnMsIGNhcGFiaWxpdGllcyk7CiAgY29uc3QgbGlnaHRzQXJyYXkgPSBbXTsKICBjb25zdCBzaGFkb3dzQXJyYXkgPSBbXTsKICBmdW5jdGlvbiBpbml0KCkgewogICAgbGlnaHRzQXJyYXkubGVuZ3RoID0gMDsKICAgIHNoYWRvd3NBcnJheS5sZW5ndGggPSAwOwogIH0KICBmdW5jdGlvbiBwdXNoTGlnaHQobGlnaHQpIHsKICAgIGxpZ2h0c0FycmF5LnB1c2gobGlnaHQpOwogIH0KICBmdW5jdGlvbiBwdXNoU2hhZG93KHNoYWRvd0xpZ2h0KSB7CiAgICBzaGFkb3dzQXJyYXkucHVzaChzaGFkb3dMaWdodCk7CiAgfQogIGZ1bmN0aW9uIHNldHVwTGlnaHRzKHBoeXNpY2FsbHlDb3JyZWN0TGlnaHRzKSB7CiAgICBsaWdodHMuc2V0dXAobGlnaHRzQXJyYXksIHBoeXNpY2FsbHlDb3JyZWN0TGlnaHRzKTsKICB9CiAgZnVuY3Rpb24gc2V0dXBMaWdodHNWaWV3KGNhbWVyYSkgewogICAgbGlnaHRzLnNldHVwVmlldyhsaWdodHNBcnJheSwgY2FtZXJhKTsKICB9CiAgY29uc3Qgc3RhdGUgPSB7CiAgICBsaWdodHNBcnJheSwKICAgIHNoYWRvd3NBcnJheSwKICAgIGxpZ2h0cwogIH07CiAgcmV0dXJuIHsKICAgIGluaXQsCiAgICBzdGF0ZSwKICAgIHNldHVwTGlnaHRzLAogICAgc2V0dXBMaWdodHNWaWV3LAogICAgcHVzaExpZ2h0LAogICAgcHVzaFNoYWRvdwogIH07Cn0KZnVuY3Rpb24gV2ViR0xSZW5kZXJTdGF0ZXMoZXh0ZW5zaW9ucywgY2FwYWJpbGl0aWVzKSB7CiAgbGV0IHJlbmRlclN0YXRlcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwogIGZ1bmN0aW9uIGdldChzY2VuZSwgcmVuZGVyQ2FsbERlcHRoID0gMCkgewogICAgbGV0IHJlbmRlclN0YXRlOwogICAgaWYgKHJlbmRlclN0YXRlcy5oYXMoc2NlbmUpID09PSBmYWxzZSkgewogICAgICByZW5kZXJTdGF0ZSA9IG5ldyBXZWJHTFJlbmRlclN0YXRlKGV4dGVuc2lvbnMsIGNhcGFiaWxpdGllcyk7CiAgICAgIHJlbmRlclN0YXRlcy5zZXQoc2NlbmUsIFtyZW5kZXJTdGF0ZV0pOwogICAgfSBlbHNlIHsKICAgICAgaWYgKHJlbmRlckNhbGxEZXB0aCA+PSByZW5kZXJTdGF0ZXMuZ2V0KHNjZW5lKS5sZW5ndGgpIHsKICAgICAgICByZW5kZXJTdGF0ZSA9IG5ldyBXZWJHTFJlbmRlclN0YXRlKGV4dGVuc2lvbnMsIGNhcGFiaWxpdGllcyk7CiAgICAgICAgcmVuZGVyU3RhdGVzLmdldChzY2VuZSkucHVzaChyZW5kZXJTdGF0ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVuZGVyU3RhdGUgPSByZW5kZXJTdGF0ZXMuZ2V0KHNjZW5lKVtyZW5kZXJDYWxsRGVwdGhdOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gcmVuZGVyU3RhdGU7CiAgfQogIGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICByZW5kZXJTdGF0ZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKICB9CiAgcmV0dXJuIHsKICAgIGdldCwKICAgIGRpc3Bvc2UKICB9Owp9CmNsYXNzIE1lc2hEZXB0aE1hdGVyaWFsIGV4dGVuZHMgTWF0ZXJpYWwgewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLnR5cGUgPSAiTWVzaERlcHRoTWF0ZXJpYWwiOwogICAgdGhpcy5kZXB0aFBhY2tpbmcgPSBCYXNpY0RlcHRoUGFja2luZzsKICAgIHRoaXMubWFwID0gbnVsbDsKICAgIHRoaXMuYWxwaGFNYXAgPSBudWxsOwogICAgdGhpcy5kaXNwbGFjZW1lbnRNYXAgPSBudWxsOwogICAgdGhpcy5kaXNwbGFjZW1lbnRTY2FsZSA9IDE7CiAgICB0aGlzLmRpc3BsYWNlbWVudEJpYXMgPSAwOwogICAgdGhpcy53aXJlZnJhbWUgPSBmYWxzZTsKICAgIHRoaXMud2lyZWZyYW1lTGluZXdpZHRoID0gMTsKICAgIHRoaXMuZm9nID0gZmFsc2U7CiAgICB0aGlzLnNldFZhbHVlcyhwYXJhbWV0ZXJzKTsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHN1cGVyLmNvcHkoc291cmNlKTsKICAgIHRoaXMuZGVwdGhQYWNraW5nID0gc291cmNlLmRlcHRoUGFja2luZzsKICAgIHRoaXMubWFwID0gc291cmNlLm1hcDsKICAgIHRoaXMuYWxwaGFNYXAgPSBzb3VyY2UuYWxwaGFNYXA7CiAgICB0aGlzLmRpc3BsYWNlbWVudE1hcCA9IHNvdXJjZS5kaXNwbGFjZW1lbnRNYXA7CiAgICB0aGlzLmRpc3BsYWNlbWVudFNjYWxlID0gc291cmNlLmRpc3BsYWNlbWVudFNjYWxlOwogICAgdGhpcy5kaXNwbGFjZW1lbnRCaWFzID0gc291cmNlLmRpc3BsYWNlbWVudEJpYXM7CiAgICB0aGlzLndpcmVmcmFtZSA9IHNvdXJjZS53aXJlZnJhbWU7CiAgICB0aGlzLndpcmVmcmFtZUxpbmV3aWR0aCA9IHNvdXJjZS53aXJlZnJhbWVMaW5ld2lkdGg7CiAgICByZXR1cm4gdGhpczsKICB9Cn0KTWVzaERlcHRoTWF0ZXJpYWwucHJvdG90eXBlLmlzTWVzaERlcHRoTWF0ZXJpYWwgPSB0cnVlOwpjbGFzcyBNZXNoRGlzdGFuY2VNYXRlcmlhbCBleHRlbmRzIE1hdGVyaWFsIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIk1lc2hEaXN0YW5jZU1hdGVyaWFsIjsKICAgIHRoaXMucmVmZXJlbmNlUG9zaXRpb24gPSBuZXcgVmVjdG9yMygpOwogICAgdGhpcy5uZWFyRGlzdGFuY2UgPSAxOwogICAgdGhpcy5mYXJEaXN0YW5jZSA9IDFlMzsKICAgIHRoaXMubWFwID0gbnVsbDsKICAgIHRoaXMuYWxwaGFNYXAgPSBudWxsOwogICAgdGhpcy5kaXNwbGFjZW1lbnRNYXAgPSBudWxsOwogICAgdGhpcy5kaXNwbGFjZW1lbnRTY2FsZSA9IDE7CiAgICB0aGlzLmRpc3BsYWNlbWVudEJpYXMgPSAwOwogICAgdGhpcy5mb2cgPSBmYWxzZTsKICAgIHRoaXMuc2V0VmFsdWVzKHBhcmFtZXRlcnMpOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy5yZWZlcmVuY2VQb3NpdGlvbi5jb3B5KHNvdXJjZS5yZWZlcmVuY2VQb3NpdGlvbik7CiAgICB0aGlzLm5lYXJEaXN0YW5jZSA9IHNvdXJjZS5uZWFyRGlzdGFuY2U7CiAgICB0aGlzLmZhckRpc3RhbmNlID0gc291cmNlLmZhckRpc3RhbmNlOwogICAgdGhpcy5tYXAgPSBzb3VyY2UubWFwOwogICAgdGhpcy5hbHBoYU1hcCA9IHNvdXJjZS5hbHBoYU1hcDsKICAgIHRoaXMuZGlzcGxhY2VtZW50TWFwID0gc291cmNlLmRpc3BsYWNlbWVudE1hcDsKICAgIHRoaXMuZGlzcGxhY2VtZW50U2NhbGUgPSBzb3VyY2UuZGlzcGxhY2VtZW50U2NhbGU7CiAgICB0aGlzLmRpc3BsYWNlbWVudEJpYXMgPSBzb3VyY2UuZGlzcGxhY2VtZW50QmlhczsKICAgIHJldHVybiB0aGlzOwogIH0KfQpNZXNoRGlzdGFuY2VNYXRlcmlhbC5wcm90b3R5cGUuaXNNZXNoRGlzdGFuY2VNYXRlcmlhbCA9IHRydWU7CmNvbnN0IHZlcnRleCA9ICJ2b2lkIG1haW4oKSB7XG4JZ2xfUG9zaXRpb24gPSB2ZWM0KCBwb3NpdGlvbiwgMS4wICk7XG59IjsKY29uc3QgZnJhZ21lbnQgPSAidW5pZm9ybSBzYW1wbGVyMkQgc2hhZG93X3Bhc3M7XG51bmlmb3JtIHZlYzIgcmVzb2x1dGlvbjtcbnVuaWZvcm0gZmxvYXQgcmFkaXVzO1xuI2luY2x1ZGUgPHBhY2tpbmc+XG52b2lkIG1haW4oKSB7XG4JY29uc3QgZmxvYXQgc2FtcGxlcyA9IGZsb2F0KCBWU01fU0FNUExFUyApO1xuCWZsb2F0IG1lYW4gPSAwLjA7XG4JZmxvYXQgc3F1YXJlZF9tZWFuID0gMC4wO1xuCWZsb2F0IHV2U3RyaWRlID0gc2FtcGxlcyA8PSAxLjAgPyAwLjAgOiAyLjAgLyAoIHNhbXBsZXMgLSAxLjAgKTtcbglmbG9hdCB1dlN0YXJ0ID0gc2FtcGxlcyA8PSAxLjAgPyAwLjAgOiAtIDEuMDtcbglmb3IgKCBmbG9hdCBpID0gMC4wOyBpIDwgc2FtcGxlczsgaSArKyApIHtcbgkJZmxvYXQgdXZPZmZzZXQgPSB1dlN0YXJ0ICsgaSAqIHV2U3RyaWRlO1xuCQkjaWZkZWYgSE9SSVpPTlRBTF9QQVNTXG4JCQl2ZWMyIGRpc3RyaWJ1dGlvbiA9IHVucGFja1JHQkFUbzJIYWxmKCB0ZXh0dXJlMkQoIHNoYWRvd19wYXNzLCAoIGdsX0ZyYWdDb29yZC54eSArIHZlYzIoIHV2T2Zmc2V0LCAwLjAgKSAqIHJhZGl1cyApIC8gcmVzb2x1dGlvbiApICk7XG4JCQltZWFuICs9IGRpc3RyaWJ1dGlvbi54O1xuCQkJc3F1YXJlZF9tZWFuICs9IGRpc3RyaWJ1dGlvbi55ICogZGlzdHJpYnV0aW9uLnkgKyBkaXN0cmlidXRpb24ueCAqIGRpc3RyaWJ1dGlvbi54O1xuCQkjZWxzZVxuCQkJZmxvYXQgZGVwdGggPSB1bnBhY2tSR0JBVG9EZXB0aCggdGV4dHVyZTJEKCBzaGFkb3dfcGFzcywgKCBnbF9GcmFnQ29vcmQueHkgKyB2ZWMyKCAwLjAsIHV2T2Zmc2V0ICkgKiByYWRpdXMgKSAvIHJlc29sdXRpb24gKSApO1xuCQkJbWVhbiArPSBkZXB0aDtcbgkJCXNxdWFyZWRfbWVhbiArPSBkZXB0aCAqIGRlcHRoO1xuCQkjZW5kaWZcbgl9XG4JbWVhbiA9IG1lYW4gLyBzYW1wbGVzO1xuCXNxdWFyZWRfbWVhbiA9IHNxdWFyZWRfbWVhbiAvIHNhbXBsZXM7XG4JZmxvYXQgc3RkX2RldiA9IHNxcnQoIHNxdWFyZWRfbWVhbiAtIG1lYW4gKiBtZWFuICk7XG4JZ2xfRnJhZ0NvbG9yID0gcGFjazJIYWxmVG9SR0JBKCB2ZWMyKCBtZWFuLCBzdGRfZGV2ICkgKTtcbn0iOwpmdW5jdGlvbiBXZWJHTFNoYWRvd01hcChfcmVuZGVyZXIsIF9vYmplY3RzLCBfY2FwYWJpbGl0aWVzKSB7CiAgbGV0IF9mcnVzdHVtID0gbmV3IEZydXN0dW0oKTsKICBjb25zdCBfc2hhZG93TWFwU2l6ZSA9IG5ldyBWZWN0b3IyKCksIF92aWV3cG9ydFNpemUgPSBuZXcgVmVjdG9yMigpLCBfdmlld3BvcnQgPSBuZXcgVmVjdG9yNCgpLCBfZGVwdGhNYXRlcmlhbCA9IG5ldyBNZXNoRGVwdGhNYXRlcmlhbCh7IGRlcHRoUGFja2luZzogUkdCQURlcHRoUGFja2luZyB9KSwgX2Rpc3RhbmNlTWF0ZXJpYWwgPSBuZXcgTWVzaERpc3RhbmNlTWF0ZXJpYWwoKSwgX21hdGVyaWFsQ2FjaGUgPSB7fSwgX21heFRleHR1cmVTaXplID0gX2NhcGFiaWxpdGllcy5tYXhUZXh0dXJlU2l6ZTsKICBjb25zdCBzaGFkb3dTaWRlID0geyAwOiBCYWNrU2lkZSwgMTogRnJvbnRTaWRlLCAyOiBEb3VibGVTaWRlIH07CiAgY29uc3Qgc2hhZG93TWF0ZXJpYWxWZXJ0aWNhbCA9IG5ldyBTaGFkZXJNYXRlcmlhbCh7CiAgICBkZWZpbmVzOiB7CiAgICAgIFZTTV9TQU1QTEVTOiA4CiAgICB9LAogICAgdW5pZm9ybXM6IHsKICAgICAgc2hhZG93X3Bhc3M6IHsgdmFsdWU6IG51bGwgfSwKICAgICAgcmVzb2x1dGlvbjogeyB2YWx1ZTogbmV3IFZlY3RvcjIoKSB9LAogICAgICByYWRpdXM6IHsgdmFsdWU6IDQgfQogICAgfSwKICAgIHZlcnRleFNoYWRlcjogdmVydGV4LAogICAgZnJhZ21lbnRTaGFkZXI6IGZyYWdtZW50CiAgfSk7CiAgY29uc3Qgc2hhZG93TWF0ZXJpYWxIb3Jpem9udGFsID0gc2hhZG93TWF0ZXJpYWxWZXJ0aWNhbC5jbG9uZSgpOwogIHNoYWRvd01hdGVyaWFsSG9yaXpvbnRhbC5kZWZpbmVzLkhPUklaT05UQUxfUEFTUyA9IDE7CiAgY29uc3QgZnVsbFNjcmVlblRyaSA9IG5ldyBCdWZmZXJHZW9tZXRyeSgpOwogIGZ1bGxTY3JlZW5Ucmkuc2V0QXR0cmlidXRlKCJwb3NpdGlvbiIsIG5ldyBCdWZmZXJBdHRyaWJ1dGUobmV3IEZsb2F0MzJBcnJheShbLTEsIC0xLCAwLjUsIDMsIC0xLCAwLjUsIC0xLCAzLCAwLjVdKSwgMykpOwogIGNvbnN0IGZ1bGxTY3JlZW5NZXNoID0gbmV3IE1lc2goZnVsbFNjcmVlblRyaSwgc2hhZG93TWF0ZXJpYWxWZXJ0aWNhbCk7CiAgY29uc3Qgc2NvcGUgPSB0aGlzOwogIHRoaXMuZW5hYmxlZCA9IGZhbHNlOwogIHRoaXMuYXV0b1VwZGF0ZSA9IHRydWU7CiAgdGhpcy5uZWVkc1VwZGF0ZSA9IGZhbHNlOwogIHRoaXMudHlwZSA9IFBDRlNoYWRvd01hcDsKICB0aGlzLnJlbmRlciA9IGZ1bmN0aW9uKGxpZ2h0cywgc2NlbmUsIGNhbWVyYSkgewogICAgaWYgKHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlKQogICAgICByZXR1cm47CiAgICBpZiAoc2NvcGUuYXV0b1VwZGF0ZSA9PT0gZmFsc2UgJiYgc2NvcGUubmVlZHNVcGRhdGUgPT09IGZhbHNlKQogICAgICByZXR1cm47CiAgICBpZiAobGlnaHRzLmxlbmd0aCA9PT0gMCkKICAgICAgcmV0dXJuOwogICAgY29uc3QgY3VycmVudFJlbmRlclRhcmdldCA9IF9yZW5kZXJlci5nZXRSZW5kZXJUYXJnZXQoKTsKICAgIGNvbnN0IGFjdGl2ZUN1YmVGYWNlID0gX3JlbmRlcmVyLmdldEFjdGl2ZUN1YmVGYWNlKCk7CiAgICBjb25zdCBhY3RpdmVNaXBtYXBMZXZlbCA9IF9yZW5kZXJlci5nZXRBY3RpdmVNaXBtYXBMZXZlbCgpOwogICAgY29uc3QgX3N0YXRlID0gX3JlbmRlcmVyLnN0YXRlOwogICAgX3N0YXRlLnNldEJsZW5kaW5nKE5vQmxlbmRpbmcpOwogICAgX3N0YXRlLmJ1ZmZlcnMuY29sb3Iuc2V0Q2xlYXIoMSwgMSwgMSwgMSk7CiAgICBfc3RhdGUuYnVmZmVycy5kZXB0aC5zZXRUZXN0KHRydWUpOwogICAgX3N0YXRlLnNldFNjaXNzb3JUZXN0KGZhbHNlKTsKICAgIGZvciAobGV0IGkgPSAwLCBpbCA9IGxpZ2h0cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgIGNvbnN0IGxpZ2h0ID0gbGlnaHRzW2ldOwogICAgICBjb25zdCBzaGFkb3cgPSBsaWdodC5zaGFkb3c7CiAgICAgIGlmIChzaGFkb3cgPT09IHZvaWQgMCkgewogICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xTaGFkb3dNYXA6IiwgbGlnaHQsICJoYXMgbm8gc2hhZG93LiIpOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIGlmIChzaGFkb3cuYXV0b1VwZGF0ZSA9PT0gZmFsc2UgJiYgc2hhZG93Lm5lZWRzVXBkYXRlID09PSBmYWxzZSkKICAgICAgICBjb250aW51ZTsKICAgICAgX3NoYWRvd01hcFNpemUuY29weShzaGFkb3cubWFwU2l6ZSk7CiAgICAgIGNvbnN0IHNoYWRvd0ZyYW1lRXh0ZW50cyA9IHNoYWRvdy5nZXRGcmFtZUV4dGVudHMoKTsKICAgICAgX3NoYWRvd01hcFNpemUubXVsdGlwbHkoc2hhZG93RnJhbWVFeHRlbnRzKTsKICAgICAgX3ZpZXdwb3J0U2l6ZS5jb3B5KHNoYWRvdy5tYXBTaXplKTsKICAgICAgaWYgKF9zaGFkb3dNYXBTaXplLnggPiBfbWF4VGV4dHVyZVNpemUgfHwgX3NoYWRvd01hcFNpemUueSA+IF9tYXhUZXh0dXJlU2l6ZSkgewogICAgICAgIGlmIChfc2hhZG93TWFwU2l6ZS54ID4gX21heFRleHR1cmVTaXplKSB7CiAgICAgICAgICBfdmlld3BvcnRTaXplLnggPSBNYXRoLmZsb29yKF9tYXhUZXh0dXJlU2l6ZSAvIHNoYWRvd0ZyYW1lRXh0ZW50cy54KTsKICAgICAgICAgIF9zaGFkb3dNYXBTaXplLnggPSBfdmlld3BvcnRTaXplLnggKiBzaGFkb3dGcmFtZUV4dGVudHMueDsKICAgICAgICAgIHNoYWRvdy5tYXBTaXplLnggPSBfdmlld3BvcnRTaXplLng7CiAgICAgICAgfQogICAgICAgIGlmIChfc2hhZG93TWFwU2l6ZS55ID4gX21heFRleHR1cmVTaXplKSB7CiAgICAgICAgICBfdmlld3BvcnRTaXplLnkgPSBNYXRoLmZsb29yKF9tYXhUZXh0dXJlU2l6ZSAvIHNoYWRvd0ZyYW1lRXh0ZW50cy55KTsKICAgICAgICAgIF9zaGFkb3dNYXBTaXplLnkgPSBfdmlld3BvcnRTaXplLnkgKiBzaGFkb3dGcmFtZUV4dGVudHMueTsKICAgICAgICAgIHNoYWRvdy5tYXBTaXplLnkgPSBfdmlld3BvcnRTaXplLnk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChzaGFkb3cubWFwID09PSBudWxsICYmICFzaGFkb3cuaXNQb2ludExpZ2h0U2hhZG93ICYmIHRoaXMudHlwZSA9PT0gVlNNU2hhZG93TWFwKSB7CiAgICAgICAgY29uc3QgcGFycyA9IHsgbWluRmlsdGVyOiBMaW5lYXJGaWx0ZXIsIG1hZ0ZpbHRlcjogTGluZWFyRmlsdGVyLCBmb3JtYXQ6IFJHQkFGb3JtYXQgfTsKICAgICAgICBzaGFkb3cubWFwID0gbmV3IFdlYkdMUmVuZGVyVGFyZ2V0KF9zaGFkb3dNYXBTaXplLngsIF9zaGFkb3dNYXBTaXplLnksIHBhcnMpOwogICAgICAgIHNoYWRvdy5tYXAudGV4dHVyZS5uYW1lID0gbGlnaHQubmFtZSArICIuc2hhZG93TWFwIjsKICAgICAgICBzaGFkb3cubWFwUGFzcyA9IG5ldyBXZWJHTFJlbmRlclRhcmdldChfc2hhZG93TWFwU2l6ZS54LCBfc2hhZG93TWFwU2l6ZS55LCBwYXJzKTsKICAgICAgICBzaGFkb3cuY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICAgICAgfQogICAgICBpZiAoc2hhZG93Lm1hcCA9PT0gbnVsbCkgewogICAgICAgIGNvbnN0IHBhcnMgPSB7IG1pbkZpbHRlcjogTmVhcmVzdEZpbHRlciwgbWFnRmlsdGVyOiBOZWFyZXN0RmlsdGVyLCBmb3JtYXQ6IFJHQkFGb3JtYXQgfTsKICAgICAgICBzaGFkb3cubWFwID0gbmV3IFdlYkdMUmVuZGVyVGFyZ2V0KF9zaGFkb3dNYXBTaXplLngsIF9zaGFkb3dNYXBTaXplLnksIHBhcnMpOwogICAgICAgIHNoYWRvdy5tYXAudGV4dHVyZS5uYW1lID0gbGlnaHQubmFtZSArICIuc2hhZG93TWFwIjsKICAgICAgICBzaGFkb3cuY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICAgICAgfQogICAgICBfcmVuZGVyZXIuc2V0UmVuZGVyVGFyZ2V0KHNoYWRvdy5tYXApOwogICAgICBfcmVuZGVyZXIuY2xlYXIoKTsKICAgICAgY29uc3Qgdmlld3BvcnRDb3VudCA9IHNoYWRvdy5nZXRWaWV3cG9ydENvdW50KCk7CiAgICAgIGZvciAobGV0IHZwID0gMDsgdnAgPCB2aWV3cG9ydENvdW50OyB2cCsrKSB7CiAgICAgICAgY29uc3Qgdmlld3BvcnQgPSBzaGFkb3cuZ2V0Vmlld3BvcnQodnApOwogICAgICAgIF92aWV3cG9ydC5zZXQoX3ZpZXdwb3J0U2l6ZS54ICogdmlld3BvcnQueCwgX3ZpZXdwb3J0U2l6ZS55ICogdmlld3BvcnQueSwgX3ZpZXdwb3J0U2l6ZS54ICogdmlld3BvcnQueiwgX3ZpZXdwb3J0U2l6ZS55ICogdmlld3BvcnQudyk7CiAgICAgICAgX3N0YXRlLnZpZXdwb3J0KF92aWV3cG9ydCk7CiAgICAgICAgc2hhZG93LnVwZGF0ZU1hdHJpY2VzKGxpZ2h0LCB2cCk7CiAgICAgICAgX2ZydXN0dW0gPSBzaGFkb3cuZ2V0RnJ1c3R1bSgpOwogICAgICAgIHJlbmRlck9iamVjdChzY2VuZSwgY2FtZXJhLCBzaGFkb3cuY2FtZXJhLCBsaWdodCwgdGhpcy50eXBlKTsKICAgICAgfQogICAgICBpZiAoIXNoYWRvdy5pc1BvaW50TGlnaHRTaGFkb3cgJiYgdGhpcy50eXBlID09PSBWU01TaGFkb3dNYXApIHsKICAgICAgICBWU01QYXNzKHNoYWRvdywgY2FtZXJhKTsKICAgICAgfQogICAgICBzaGFkb3cubmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgIH0KICAgIHNjb3BlLm5lZWRzVXBkYXRlID0gZmFsc2U7CiAgICBfcmVuZGVyZXIuc2V0UmVuZGVyVGFyZ2V0KGN1cnJlbnRSZW5kZXJUYXJnZXQsIGFjdGl2ZUN1YmVGYWNlLCBhY3RpdmVNaXBtYXBMZXZlbCk7CiAgfTsKICBmdW5jdGlvbiBWU01QYXNzKHNoYWRvdywgY2FtZXJhKSB7CiAgICBjb25zdCBnZW9tZXRyeSA9IF9vYmplY3RzLnVwZGF0ZShmdWxsU2NyZWVuTWVzaCk7CiAgICBpZiAoc2hhZG93TWF0ZXJpYWxWZXJ0aWNhbC5kZWZpbmVzLlZTTV9TQU1QTEVTICE9PSBzaGFkb3cuYmx1clNhbXBsZXMpIHsKICAgICAgc2hhZG93TWF0ZXJpYWxWZXJ0aWNhbC5kZWZpbmVzLlZTTV9TQU1QTEVTID0gc2hhZG93LmJsdXJTYW1wbGVzOwogICAgICBzaGFkb3dNYXRlcmlhbEhvcml6b250YWwuZGVmaW5lcy5WU01fU0FNUExFUyA9IHNoYWRvdy5ibHVyU2FtcGxlczsKICAgICAgc2hhZG93TWF0ZXJpYWxWZXJ0aWNhbC5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIHNoYWRvd01hdGVyaWFsSG9yaXpvbnRhbC5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICB9CiAgICBzaGFkb3dNYXRlcmlhbFZlcnRpY2FsLnVuaWZvcm1zLnNoYWRvd19wYXNzLnZhbHVlID0gc2hhZG93Lm1hcC50ZXh0dXJlOwogICAgc2hhZG93TWF0ZXJpYWxWZXJ0aWNhbC51bmlmb3Jtcy5yZXNvbHV0aW9uLnZhbHVlID0gc2hhZG93Lm1hcFNpemU7CiAgICBzaGFkb3dNYXRlcmlhbFZlcnRpY2FsLnVuaWZvcm1zLnJhZGl1cy52YWx1ZSA9IHNoYWRvdy5yYWRpdXM7CiAgICBfcmVuZGVyZXIuc2V0UmVuZGVyVGFyZ2V0KHNoYWRvdy5tYXBQYXNzKTsKICAgIF9yZW5kZXJlci5jbGVhcigpOwogICAgX3JlbmRlcmVyLnJlbmRlckJ1ZmZlckRpcmVjdChjYW1lcmEsIG51bGwsIGdlb21ldHJ5LCBzaGFkb3dNYXRlcmlhbFZlcnRpY2FsLCBmdWxsU2NyZWVuTWVzaCwgbnVsbCk7CiAgICBzaGFkb3dNYXRlcmlhbEhvcml6b250YWwudW5pZm9ybXMuc2hhZG93X3Bhc3MudmFsdWUgPSBzaGFkb3cubWFwUGFzcy50ZXh0dXJlOwogICAgc2hhZG93TWF0ZXJpYWxIb3Jpem9udGFsLnVuaWZvcm1zLnJlc29sdXRpb24udmFsdWUgPSBzaGFkb3cubWFwU2l6ZTsKICAgIHNoYWRvd01hdGVyaWFsSG9yaXpvbnRhbC51bmlmb3Jtcy5yYWRpdXMudmFsdWUgPSBzaGFkb3cucmFkaXVzOwogICAgX3JlbmRlcmVyLnNldFJlbmRlclRhcmdldChzaGFkb3cubWFwKTsKICAgIF9yZW5kZXJlci5jbGVhcigpOwogICAgX3JlbmRlcmVyLnJlbmRlckJ1ZmZlckRpcmVjdChjYW1lcmEsIG51bGwsIGdlb21ldHJ5LCBzaGFkb3dNYXRlcmlhbEhvcml6b250YWwsIGZ1bGxTY3JlZW5NZXNoLCBudWxsKTsKICB9CiAgZnVuY3Rpb24gZ2V0RGVwdGhNYXRlcmlhbChvYmplY3QsIGdlb21ldHJ5LCBtYXRlcmlhbCwgbGlnaHQsIHNoYWRvd0NhbWVyYU5lYXIsIHNoYWRvd0NhbWVyYUZhciwgdHlwZSkgewogICAgbGV0IHJlc3VsdCA9IG51bGw7CiAgICBjb25zdCBjdXN0b21NYXRlcmlhbCA9IGxpZ2h0LmlzUG9pbnRMaWdodCA9PT0gdHJ1ZSA/IG9iamVjdC5jdXN0b21EaXN0YW5jZU1hdGVyaWFsIDogb2JqZWN0LmN1c3RvbURlcHRoTWF0ZXJpYWw7CiAgICBpZiAoY3VzdG9tTWF0ZXJpYWwgIT09IHZvaWQgMCkgewogICAgICByZXN1bHQgPSBjdXN0b21NYXRlcmlhbDsKICAgIH0gZWxzZSB7CiAgICAgIHJlc3VsdCA9IGxpZ2h0LmlzUG9pbnRMaWdodCA9PT0gdHJ1ZSA/IF9kaXN0YW5jZU1hdGVyaWFsIDogX2RlcHRoTWF0ZXJpYWw7CiAgICB9CiAgICBpZiAoX3JlbmRlcmVyLmxvY2FsQ2xpcHBpbmdFbmFibGVkICYmIG1hdGVyaWFsLmNsaXBTaGFkb3dzID09PSB0cnVlICYmIG1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzLmxlbmd0aCAhPT0gMCB8fCBtYXRlcmlhbC5kaXNwbGFjZW1lbnRNYXAgJiYgbWF0ZXJpYWwuZGlzcGxhY2VtZW50U2NhbGUgIT09IDAgfHwgbWF0ZXJpYWwuYWxwaGFNYXAgJiYgbWF0ZXJpYWwuYWxwaGFUZXN0ID4gMCkgewogICAgICBjb25zdCBrZXlBID0gcmVzdWx0LnV1aWQsIGtleUIgPSBtYXRlcmlhbC51dWlkOwogICAgICBsZXQgbWF0ZXJpYWxzRm9yVmFyaWFudCA9IF9tYXRlcmlhbENhY2hlW2tleUFdOwogICAgICBpZiAobWF0ZXJpYWxzRm9yVmFyaWFudCA9PT0gdm9pZCAwKSB7CiAgICAgICAgbWF0ZXJpYWxzRm9yVmFyaWFudCA9IHt9OwogICAgICAgIF9tYXRlcmlhbENhY2hlW2tleUFdID0gbWF0ZXJpYWxzRm9yVmFyaWFudDsKICAgICAgfQogICAgICBsZXQgY2FjaGVkTWF0ZXJpYWwgPSBtYXRlcmlhbHNGb3JWYXJpYW50W2tleUJdOwogICAgICBpZiAoY2FjaGVkTWF0ZXJpYWwgPT09IHZvaWQgMCkgewogICAgICAgIGNhY2hlZE1hdGVyaWFsID0gcmVzdWx0LmNsb25lKCk7CiAgICAgICAgbWF0ZXJpYWxzRm9yVmFyaWFudFtrZXlCXSA9IGNhY2hlZE1hdGVyaWFsOwogICAgICB9CiAgICAgIHJlc3VsdCA9IGNhY2hlZE1hdGVyaWFsOwogICAgfQogICAgcmVzdWx0LnZpc2libGUgPSBtYXRlcmlhbC52aXNpYmxlOwogICAgcmVzdWx0LndpcmVmcmFtZSA9IG1hdGVyaWFsLndpcmVmcmFtZTsKICAgIGlmICh0eXBlID09PSBWU01TaGFkb3dNYXApIHsKICAgICAgcmVzdWx0LnNpZGUgPSBtYXRlcmlhbC5zaGFkb3dTaWRlICE9PSBudWxsID8gbWF0ZXJpYWwuc2hhZG93U2lkZSA6IG1hdGVyaWFsLnNpZGU7CiAgICB9IGVsc2UgewogICAgICByZXN1bHQuc2lkZSA9IG1hdGVyaWFsLnNoYWRvd1NpZGUgIT09IG51bGwgPyBtYXRlcmlhbC5zaGFkb3dTaWRlIDogc2hhZG93U2lkZVttYXRlcmlhbC5zaWRlXTsKICAgIH0KICAgIHJlc3VsdC5hbHBoYU1hcCA9IG1hdGVyaWFsLmFscGhhTWFwOwogICAgcmVzdWx0LmFscGhhVGVzdCA9IG1hdGVyaWFsLmFscGhhVGVzdDsKICAgIHJlc3VsdC5jbGlwU2hhZG93cyA9IG1hdGVyaWFsLmNsaXBTaGFkb3dzOwogICAgcmVzdWx0LmNsaXBwaW5nUGxhbmVzID0gbWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXM7CiAgICByZXN1bHQuY2xpcEludGVyc2VjdGlvbiA9IG1hdGVyaWFsLmNsaXBJbnRlcnNlY3Rpb247CiAgICByZXN1bHQuZGlzcGxhY2VtZW50TWFwID0gbWF0ZXJpYWwuZGlzcGxhY2VtZW50TWFwOwogICAgcmVzdWx0LmRpc3BsYWNlbWVudFNjYWxlID0gbWF0ZXJpYWwuZGlzcGxhY2VtZW50U2NhbGU7CiAgICByZXN1bHQuZGlzcGxhY2VtZW50QmlhcyA9IG1hdGVyaWFsLmRpc3BsYWNlbWVudEJpYXM7CiAgICByZXN1bHQud2lyZWZyYW1lTGluZXdpZHRoID0gbWF0ZXJpYWwud2lyZWZyYW1lTGluZXdpZHRoOwogICAgcmVzdWx0LmxpbmV3aWR0aCA9IG1hdGVyaWFsLmxpbmV3aWR0aDsKICAgIGlmIChsaWdodC5pc1BvaW50TGlnaHQgPT09IHRydWUgJiYgcmVzdWx0LmlzTWVzaERpc3RhbmNlTWF0ZXJpYWwgPT09IHRydWUpIHsKICAgICAgcmVzdWx0LnJlZmVyZW5jZVBvc2l0aW9uLnNldEZyb21NYXRyaXhQb3NpdGlvbihsaWdodC5tYXRyaXhXb3JsZCk7CiAgICAgIHJlc3VsdC5uZWFyRGlzdGFuY2UgPSBzaGFkb3dDYW1lcmFOZWFyOwogICAgICByZXN1bHQuZmFyRGlzdGFuY2UgPSBzaGFkb3dDYW1lcmFGYXI7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0OwogIH0KICBmdW5jdGlvbiByZW5kZXJPYmplY3Qob2JqZWN0LCBjYW1lcmEsIHNoYWRvd0NhbWVyYSwgbGlnaHQsIHR5cGUpIHsKICAgIGlmIChvYmplY3QudmlzaWJsZSA9PT0gZmFsc2UpCiAgICAgIHJldHVybjsKICAgIGNvbnN0IHZpc2libGUgPSBvYmplY3QubGF5ZXJzLnRlc3QoY2FtZXJhLmxheWVycyk7CiAgICBpZiAodmlzaWJsZSAmJiAob2JqZWN0LmlzTWVzaCB8fCBvYmplY3QuaXNMaW5lIHx8IG9iamVjdC5pc1BvaW50cykpIHsKICAgICAgaWYgKChvYmplY3QuY2FzdFNoYWRvdyB8fCBvYmplY3QucmVjZWl2ZVNoYWRvdyAmJiB0eXBlID09PSBWU01TaGFkb3dNYXApICYmICghb2JqZWN0LmZydXN0dW1DdWxsZWQgfHwgX2ZydXN0dW0uaW50ZXJzZWN0c09iamVjdChvYmplY3QpKSkgewogICAgICAgIG9iamVjdC5tb2RlbFZpZXdNYXRyaXgubXVsdGlwbHlNYXRyaWNlcyhzaGFkb3dDYW1lcmEubWF0cml4V29ybGRJbnZlcnNlLCBvYmplY3QubWF0cml4V29ybGQpOwogICAgICAgIGNvbnN0IGdlb21ldHJ5ID0gX29iamVjdHMudXBkYXRlKG9iamVjdCk7CiAgICAgICAgY29uc3QgbWF0ZXJpYWwgPSBvYmplY3QubWF0ZXJpYWw7CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobWF0ZXJpYWwpKSB7CiAgICAgICAgICBjb25zdCBncm91cHMgPSBnZW9tZXRyeS5ncm91cHM7CiAgICAgICAgICBmb3IgKGxldCBrID0gMCwga2wgPSBncm91cHMubGVuZ3RoOyBrIDwga2w7IGsrKykgewogICAgICAgICAgICBjb25zdCBncm91cCA9IGdyb3Vwc1trXTsKICAgICAgICAgICAgY29uc3QgZ3JvdXBNYXRlcmlhbCA9IG1hdGVyaWFsW2dyb3VwLm1hdGVyaWFsSW5kZXhdOwogICAgICAgICAgICBpZiAoZ3JvdXBNYXRlcmlhbCAmJiBncm91cE1hdGVyaWFsLnZpc2libGUpIHsKICAgICAgICAgICAgICBjb25zdCBkZXB0aE1hdGVyaWFsID0gZ2V0RGVwdGhNYXRlcmlhbChvYmplY3QsIGdlb21ldHJ5LCBncm91cE1hdGVyaWFsLCBsaWdodCwgc2hhZG93Q2FtZXJhLm5lYXIsIHNoYWRvd0NhbWVyYS5mYXIsIHR5cGUpOwogICAgICAgICAgICAgIF9yZW5kZXJlci5yZW5kZXJCdWZmZXJEaXJlY3Qoc2hhZG93Q2FtZXJhLCBudWxsLCBnZW9tZXRyeSwgZGVwdGhNYXRlcmlhbCwgb2JqZWN0LCBncm91cCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKG1hdGVyaWFsLnZpc2libGUpIHsKICAgICAgICAgIGNvbnN0IGRlcHRoTWF0ZXJpYWwgPSBnZXREZXB0aE1hdGVyaWFsKG9iamVjdCwgZ2VvbWV0cnksIG1hdGVyaWFsLCBsaWdodCwgc2hhZG93Q2FtZXJhLm5lYXIsIHNoYWRvd0NhbWVyYS5mYXIsIHR5cGUpOwogICAgICAgICAgX3JlbmRlcmVyLnJlbmRlckJ1ZmZlckRpcmVjdChzaGFkb3dDYW1lcmEsIG51bGwsIGdlb21ldHJ5LCBkZXB0aE1hdGVyaWFsLCBvYmplY3QsIG51bGwpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgY29uc3QgY2hpbGRyZW4gPSBvYmplY3QuY2hpbGRyZW47CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICByZW5kZXJPYmplY3QoY2hpbGRyZW5baV0sIGNhbWVyYSwgc2hhZG93Q2FtZXJhLCBsaWdodCwgdHlwZSk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIFdlYkdMU3RhdGUoZ2wsIGV4dGVuc2lvbnMsIGNhcGFiaWxpdGllcykgewogIGNvbnN0IGlzV2ViR0wyID0gY2FwYWJpbGl0aWVzLmlzV2ViR0wyOwogIGZ1bmN0aW9uIENvbG9yQnVmZmVyKCkgewogICAgbGV0IGxvY2tlZCA9IGZhbHNlOwogICAgY29uc3QgY29sb3IgPSBuZXcgVmVjdG9yNCgpOwogICAgbGV0IGN1cnJlbnRDb2xvck1hc2sgPSBudWxsOwogICAgY29uc3QgY3VycmVudENvbG9yQ2xlYXIgPSBuZXcgVmVjdG9yNCgwLCAwLCAwLCAwKTsKICAgIHJldHVybiB7CiAgICAgIHNldE1hc2s6IGZ1bmN0aW9uKGNvbG9yTWFzaykgewogICAgICAgIGlmIChjdXJyZW50Q29sb3JNYXNrICE9PSBjb2xvck1hc2sgJiYgIWxvY2tlZCkgewogICAgICAgICAgZ2wuY29sb3JNYXNrKGNvbG9yTWFzaywgY29sb3JNYXNrLCBjb2xvck1hc2ssIGNvbG9yTWFzayk7CiAgICAgICAgICBjdXJyZW50Q29sb3JNYXNrID0gY29sb3JNYXNrOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc2V0TG9ja2VkOiBmdW5jdGlvbihsb2NrKSB7CiAgICAgICAgbG9ja2VkID0gbG9jazsKICAgICAgfSwKICAgICAgc2V0Q2xlYXI6IGZ1bmN0aW9uKHIsIGcsIGIsIGEsIHByZW11bHRpcGxpZWRBbHBoYSkgewogICAgICAgIGlmIChwcmVtdWx0aXBsaWVkQWxwaGEgPT09IHRydWUpIHsKICAgICAgICAgIHIgKj0gYTsKICAgICAgICAgIGcgKj0gYTsKICAgICAgICAgIGIgKj0gYTsKICAgICAgICB9CiAgICAgICAgY29sb3Iuc2V0KHIsIGcsIGIsIGEpOwogICAgICAgIGlmIChjdXJyZW50Q29sb3JDbGVhci5lcXVhbHMoY29sb3IpID09PSBmYWxzZSkgewogICAgICAgICAgZ2wuY2xlYXJDb2xvcihyLCBnLCBiLCBhKTsKICAgICAgICAgIGN1cnJlbnRDb2xvckNsZWFyLmNvcHkoY29sb3IpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcmVzZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgIGxvY2tlZCA9IGZhbHNlOwogICAgICAgIGN1cnJlbnRDb2xvck1hc2sgPSBudWxsOwogICAgICAgIGN1cnJlbnRDb2xvckNsZWFyLnNldCgtMSwgMCwgMCwgMCk7CiAgICAgIH0KICAgIH07CiAgfQogIGZ1bmN0aW9uIERlcHRoQnVmZmVyKCkgewogICAgbGV0IGxvY2tlZCA9IGZhbHNlOwogICAgbGV0IGN1cnJlbnREZXB0aE1hc2sgPSBudWxsOwogICAgbGV0IGN1cnJlbnREZXB0aEZ1bmMgPSBudWxsOwogICAgbGV0IGN1cnJlbnREZXB0aENsZWFyID0gbnVsbDsKICAgIHJldHVybiB7CiAgICAgIHNldFRlc3Q6IGZ1bmN0aW9uKGRlcHRoVGVzdCkgewogICAgICAgIGlmIChkZXB0aFRlc3QpIHsKICAgICAgICAgIGVuYWJsZSgyOTI5KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZGlzYWJsZSgyOTI5KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNldE1hc2s6IGZ1bmN0aW9uKGRlcHRoTWFzaykgewogICAgICAgIGlmIChjdXJyZW50RGVwdGhNYXNrICE9PSBkZXB0aE1hc2sgJiYgIWxvY2tlZCkgewogICAgICAgICAgZ2wuZGVwdGhNYXNrKGRlcHRoTWFzayk7CiAgICAgICAgICBjdXJyZW50RGVwdGhNYXNrID0gZGVwdGhNYXNrOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc2V0RnVuYzogZnVuY3Rpb24oZGVwdGhGdW5jKSB7CiAgICAgICAgaWYgKGN1cnJlbnREZXB0aEZ1bmMgIT09IGRlcHRoRnVuYykgewogICAgICAgICAgaWYgKGRlcHRoRnVuYykgewogICAgICAgICAgICBzd2l0Y2ggKGRlcHRoRnVuYykgewogICAgICAgICAgICAgIGNhc2UgTmV2ZXJEZXB0aDoKICAgICAgICAgICAgICAgIGdsLmRlcHRoRnVuYyg1MTIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSBBbHdheXNEZXB0aDoKICAgICAgICAgICAgICAgIGdsLmRlcHRoRnVuYyg1MTkpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSBMZXNzRGVwdGg6CiAgICAgICAgICAgICAgICBnbC5kZXB0aEZ1bmMoNTEzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgTGVzc0VxdWFsRGVwdGg6CiAgICAgICAgICAgICAgICBnbC5kZXB0aEZ1bmMoNTE1KTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgRXF1YWxEZXB0aDoKICAgICAgICAgICAgICAgIGdsLmRlcHRoRnVuYyg1MTQpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSBHcmVhdGVyRXF1YWxEZXB0aDoKICAgICAgICAgICAgICAgIGdsLmRlcHRoRnVuYyg1MTgpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSBHcmVhdGVyRGVwdGg6CiAgICAgICAgICAgICAgICBnbC5kZXB0aEZ1bmMoNTE2KTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgTm90RXF1YWxEZXB0aDoKICAgICAgICAgICAgICAgIGdsLmRlcHRoRnVuYyg1MTcpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIGdsLmRlcHRoRnVuYyg1MTUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBnbC5kZXB0aEZ1bmMoNTE1KTsKICAgICAgICAgIH0KICAgICAgICAgIGN1cnJlbnREZXB0aEZ1bmMgPSBkZXB0aEZ1bmM7CiAgICAgICAgfQogICAgICB9LAogICAgICBzZXRMb2NrZWQ6IGZ1bmN0aW9uKGxvY2spIHsKICAgICAgICBsb2NrZWQgPSBsb2NrOwogICAgICB9LAogICAgICBzZXRDbGVhcjogZnVuY3Rpb24oZGVwdGgpIHsKICAgICAgICBpZiAoY3VycmVudERlcHRoQ2xlYXIgIT09IGRlcHRoKSB7CiAgICAgICAgICBnbC5jbGVhckRlcHRoKGRlcHRoKTsKICAgICAgICAgIGN1cnJlbnREZXB0aENsZWFyID0gZGVwdGg7CiAgICAgICAgfQogICAgICB9LAogICAgICByZXNldDogZnVuY3Rpb24oKSB7CiAgICAgICAgbG9ja2VkID0gZmFsc2U7CiAgICAgICAgY3VycmVudERlcHRoTWFzayA9IG51bGw7CiAgICAgICAgY3VycmVudERlcHRoRnVuYyA9IG51bGw7CiAgICAgICAgY3VycmVudERlcHRoQ2xlYXIgPSBudWxsOwogICAgICB9CiAgICB9OwogIH0KICBmdW5jdGlvbiBTdGVuY2lsQnVmZmVyKCkgewogICAgbGV0IGxvY2tlZCA9IGZhbHNlOwogICAgbGV0IGN1cnJlbnRTdGVuY2lsTWFzayA9IG51bGw7CiAgICBsZXQgY3VycmVudFN0ZW5jaWxGdW5jID0gbnVsbDsKICAgIGxldCBjdXJyZW50U3RlbmNpbFJlZiA9IG51bGw7CiAgICBsZXQgY3VycmVudFN0ZW5jaWxGdW5jTWFzayA9IG51bGw7CiAgICBsZXQgY3VycmVudFN0ZW5jaWxGYWlsID0gbnVsbDsKICAgIGxldCBjdXJyZW50U3RlbmNpbFpGYWlsID0gbnVsbDsKICAgIGxldCBjdXJyZW50U3RlbmNpbFpQYXNzID0gbnVsbDsKICAgIGxldCBjdXJyZW50U3RlbmNpbENsZWFyID0gbnVsbDsKICAgIHJldHVybiB7CiAgICAgIHNldFRlc3Q6IGZ1bmN0aW9uKHN0ZW5jaWxUZXN0KSB7CiAgICAgICAgaWYgKCFsb2NrZWQpIHsKICAgICAgICAgIGlmIChzdGVuY2lsVGVzdCkgewogICAgICAgICAgICBlbmFibGUoMjk2MCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkaXNhYmxlKDI5NjApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgc2V0TWFzazogZnVuY3Rpb24oc3RlbmNpbE1hc2spIHsKICAgICAgICBpZiAoY3VycmVudFN0ZW5jaWxNYXNrICE9PSBzdGVuY2lsTWFzayAmJiAhbG9ja2VkKSB7CiAgICAgICAgICBnbC5zdGVuY2lsTWFzayhzdGVuY2lsTWFzayk7CiAgICAgICAgICBjdXJyZW50U3RlbmNpbE1hc2sgPSBzdGVuY2lsTWFzazsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNldEZ1bmM6IGZ1bmN0aW9uKHN0ZW5jaWxGdW5jLCBzdGVuY2lsUmVmLCBzdGVuY2lsTWFzaykgewogICAgICAgIGlmIChjdXJyZW50U3RlbmNpbEZ1bmMgIT09IHN0ZW5jaWxGdW5jIHx8IGN1cnJlbnRTdGVuY2lsUmVmICE9PSBzdGVuY2lsUmVmIHx8IGN1cnJlbnRTdGVuY2lsRnVuY01hc2sgIT09IHN0ZW5jaWxNYXNrKSB7CiAgICAgICAgICBnbC5zdGVuY2lsRnVuYyhzdGVuY2lsRnVuYywgc3RlbmNpbFJlZiwgc3RlbmNpbE1hc2spOwogICAgICAgICAgY3VycmVudFN0ZW5jaWxGdW5jID0gc3RlbmNpbEZ1bmM7CiAgICAgICAgICBjdXJyZW50U3RlbmNpbFJlZiA9IHN0ZW5jaWxSZWY7CiAgICAgICAgICBjdXJyZW50U3RlbmNpbEZ1bmNNYXNrID0gc3RlbmNpbE1hc2s7CiAgICAgICAgfQogICAgICB9LAogICAgICBzZXRPcDogZnVuY3Rpb24oc3RlbmNpbEZhaWwsIHN0ZW5jaWxaRmFpbCwgc3RlbmNpbFpQYXNzKSB7CiAgICAgICAgaWYgKGN1cnJlbnRTdGVuY2lsRmFpbCAhPT0gc3RlbmNpbEZhaWwgfHwgY3VycmVudFN0ZW5jaWxaRmFpbCAhPT0gc3RlbmNpbFpGYWlsIHx8IGN1cnJlbnRTdGVuY2lsWlBhc3MgIT09IHN0ZW5jaWxaUGFzcykgewogICAgICAgICAgZ2wuc3RlbmNpbE9wKHN0ZW5jaWxGYWlsLCBzdGVuY2lsWkZhaWwsIHN0ZW5jaWxaUGFzcyk7CiAgICAgICAgICBjdXJyZW50U3RlbmNpbEZhaWwgPSBzdGVuY2lsRmFpbDsKICAgICAgICAgIGN1cnJlbnRTdGVuY2lsWkZhaWwgPSBzdGVuY2lsWkZhaWw7CiAgICAgICAgICBjdXJyZW50U3RlbmNpbFpQYXNzID0gc3RlbmNpbFpQYXNzOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc2V0TG9ja2VkOiBmdW5jdGlvbihsb2NrKSB7CiAgICAgICAgbG9ja2VkID0gbG9jazsKICAgICAgfSwKICAgICAgc2V0Q2xlYXI6IGZ1bmN0aW9uKHN0ZW5jaWwpIHsKICAgICAgICBpZiAoY3VycmVudFN0ZW5jaWxDbGVhciAhPT0gc3RlbmNpbCkgewogICAgICAgICAgZ2wuY2xlYXJTdGVuY2lsKHN0ZW5jaWwpOwogICAgICAgICAgY3VycmVudFN0ZW5jaWxDbGVhciA9IHN0ZW5jaWw7CiAgICAgICAgfQogICAgICB9LAogICAgICByZXNldDogZnVuY3Rpb24oKSB7CiAgICAgICAgbG9ja2VkID0gZmFsc2U7CiAgICAgICAgY3VycmVudFN0ZW5jaWxNYXNrID0gbnVsbDsKICAgICAgICBjdXJyZW50U3RlbmNpbEZ1bmMgPSBudWxsOwogICAgICAgIGN1cnJlbnRTdGVuY2lsUmVmID0gbnVsbDsKICAgICAgICBjdXJyZW50U3RlbmNpbEZ1bmNNYXNrID0gbnVsbDsKICAgICAgICBjdXJyZW50U3RlbmNpbEZhaWwgPSBudWxsOwogICAgICAgIGN1cnJlbnRTdGVuY2lsWkZhaWwgPSBudWxsOwogICAgICAgIGN1cnJlbnRTdGVuY2lsWlBhc3MgPSBudWxsOwogICAgICAgIGN1cnJlbnRTdGVuY2lsQ2xlYXIgPSBudWxsOwogICAgICB9CiAgICB9OwogIH0KICBjb25zdCBjb2xvckJ1ZmZlciA9IG5ldyBDb2xvckJ1ZmZlcigpOwogIGNvbnN0IGRlcHRoQnVmZmVyID0gbmV3IERlcHRoQnVmZmVyKCk7CiAgY29uc3Qgc3RlbmNpbEJ1ZmZlciA9IG5ldyBTdGVuY2lsQnVmZmVyKCk7CiAgbGV0IGVuYWJsZWRDYXBhYmlsaXRpZXMgPSB7fTsKICBsZXQgY3VycmVudEJvdW5kRnJhbWVidWZmZXJzID0ge307CiAgbGV0IGN1cnJlbnREcmF3YnVmZmVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwogIGxldCBkZWZhdWx0RHJhd2J1ZmZlcnMgPSBbXTsKICBsZXQgY3VycmVudFByb2dyYW0gPSBudWxsOwogIGxldCBjdXJyZW50QmxlbmRpbmdFbmFibGVkID0gZmFsc2U7CiAgbGV0IGN1cnJlbnRCbGVuZGluZyA9IG51bGw7CiAgbGV0IGN1cnJlbnRCbGVuZEVxdWF0aW9uID0gbnVsbDsKICBsZXQgY3VycmVudEJsZW5kU3JjID0gbnVsbDsKICBsZXQgY3VycmVudEJsZW5kRHN0ID0gbnVsbDsKICBsZXQgY3VycmVudEJsZW5kRXF1YXRpb25BbHBoYSA9IG51bGw7CiAgbGV0IGN1cnJlbnRCbGVuZFNyY0FscGhhID0gbnVsbDsKICBsZXQgY3VycmVudEJsZW5kRHN0QWxwaGEgPSBudWxsOwogIGxldCBjdXJyZW50UHJlbXVsdGlwbGVkQWxwaGEgPSBmYWxzZTsKICBsZXQgY3VycmVudEZsaXBTaWRlZCA9IG51bGw7CiAgbGV0IGN1cnJlbnRDdWxsRmFjZSA9IG51bGw7CiAgbGV0IGN1cnJlbnRMaW5lV2lkdGggPSBudWxsOwogIGxldCBjdXJyZW50UG9seWdvbk9mZnNldEZhY3RvciA9IG51bGw7CiAgbGV0IGN1cnJlbnRQb2x5Z29uT2Zmc2V0VW5pdHMgPSBudWxsOwogIGNvbnN0IG1heFRleHR1cmVzID0gZ2wuZ2V0UGFyYW1ldGVyKDM1NjYxKTsKICBsZXQgbGluZVdpZHRoQXZhaWxhYmxlID0gZmFsc2U7CiAgbGV0IHZlcnNpb24gPSAwOwogIGNvbnN0IGdsVmVyc2lvbiA9IGdsLmdldFBhcmFtZXRlcig3OTM4KTsKICBpZiAoZ2xWZXJzaW9uLmluZGV4T2YoIldlYkdMIikgIT09IC0xKSB7CiAgICB2ZXJzaW9uID0gcGFyc2VGbG9hdCgvXldlYkdMIChcZCkvLmV4ZWMoZ2xWZXJzaW9uKVsxXSk7CiAgICBsaW5lV2lkdGhBdmFpbGFibGUgPSB2ZXJzaW9uID49IDE7CiAgfSBlbHNlIGlmIChnbFZlcnNpb24uaW5kZXhPZigiT3BlbkdMIEVTIikgIT09IC0xKSB7CiAgICB2ZXJzaW9uID0gcGFyc2VGbG9hdCgvXk9wZW5HTCBFUyAoXGQpLy5leGVjKGdsVmVyc2lvbilbMV0pOwogICAgbGluZVdpZHRoQXZhaWxhYmxlID0gdmVyc2lvbiA+PSAyOwogIH0KICBsZXQgY3VycmVudFRleHR1cmVTbG90ID0gbnVsbDsKICBsZXQgY3VycmVudEJvdW5kVGV4dHVyZXMgPSB7fTsKICBjb25zdCBzY2lzc29yUGFyYW0gPSBnbC5nZXRQYXJhbWV0ZXIoMzA4OCk7CiAgY29uc3Qgdmlld3BvcnRQYXJhbSA9IGdsLmdldFBhcmFtZXRlcigyOTc4KTsKICBjb25zdCBjdXJyZW50U2Npc3NvciA9IG5ldyBWZWN0b3I0KCkuZnJvbUFycmF5KHNjaXNzb3JQYXJhbSk7CiAgY29uc3QgY3VycmVudFZpZXdwb3J0ID0gbmV3IFZlY3RvcjQoKS5mcm9tQXJyYXkodmlld3BvcnRQYXJhbSk7CiAgZnVuY3Rpb24gY3JlYXRlVGV4dHVyZSh0eXBlLCB0YXJnZXQsIGNvdW50KSB7CiAgICBjb25zdCBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoNCk7CiAgICBjb25zdCB0ZXh0dXJlID0gZ2wuY3JlYXRlVGV4dHVyZSgpOwogICAgZ2wuYmluZFRleHR1cmUodHlwZSwgdGV4dHVyZSk7CiAgICBnbC50ZXhQYXJhbWV0ZXJpKHR5cGUsIDEwMjQxLCA5NzI4KTsKICAgIGdsLnRleFBhcmFtZXRlcmkodHlwZSwgMTAyNDAsIDk3MjgpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgIGdsLnRleEltYWdlMkQodGFyZ2V0ICsgaSwgMCwgNjQwOCwgMSwgMSwgMCwgNjQwOCwgNTEyMSwgZGF0YSk7CiAgICB9CiAgICByZXR1cm4gdGV4dHVyZTsKICB9CiAgY29uc3QgZW1wdHlUZXh0dXJlcyA9IHt9OwogIGVtcHR5VGV4dHVyZXNbMzU1M10gPSBjcmVhdGVUZXh0dXJlKDM1NTMsIDM1NTMsIDEpOwogIGVtcHR5VGV4dHVyZXNbMzQwNjddID0gY3JlYXRlVGV4dHVyZSgzNDA2NywgMzQwNjksIDYpOwogIGNvbG9yQnVmZmVyLnNldENsZWFyKDAsIDAsIDAsIDEpOwogIGRlcHRoQnVmZmVyLnNldENsZWFyKDEpOwogIHN0ZW5jaWxCdWZmZXIuc2V0Q2xlYXIoMCk7CiAgZW5hYmxlKDI5MjkpOwogIGRlcHRoQnVmZmVyLnNldEZ1bmMoTGVzc0VxdWFsRGVwdGgpOwogIHNldEZsaXBTaWRlZChmYWxzZSk7CiAgc2V0Q3VsbEZhY2UoQ3VsbEZhY2VCYWNrKTsKICBlbmFibGUoMjg4NCk7CiAgc2V0QmxlbmRpbmcoTm9CbGVuZGluZyk7CiAgZnVuY3Rpb24gZW5hYmxlKGlkKSB7CiAgICBpZiAoZW5hYmxlZENhcGFiaWxpdGllc1tpZF0gIT09IHRydWUpIHsKICAgICAgZ2wuZW5hYmxlKGlkKTsKICAgICAgZW5hYmxlZENhcGFiaWxpdGllc1tpZF0gPSB0cnVlOwogICAgfQogIH0KICBmdW5jdGlvbiBkaXNhYmxlKGlkKSB7CiAgICBpZiAoZW5hYmxlZENhcGFiaWxpdGllc1tpZF0gIT09IGZhbHNlKSB7CiAgICAgIGdsLmRpc2FibGUoaWQpOwogICAgICBlbmFibGVkQ2FwYWJpbGl0aWVzW2lkXSA9IGZhbHNlOwogICAgfQogIH0KICBmdW5jdGlvbiBiaW5kRnJhbWVidWZmZXIodGFyZ2V0LCBmcmFtZWJ1ZmZlcikgewogICAgaWYgKGN1cnJlbnRCb3VuZEZyYW1lYnVmZmVyc1t0YXJnZXRdICE9PSBmcmFtZWJ1ZmZlcikgewogICAgICBnbC5iaW5kRnJhbWVidWZmZXIodGFyZ2V0LCBmcmFtZWJ1ZmZlcik7CiAgICAgIGN1cnJlbnRCb3VuZEZyYW1lYnVmZmVyc1t0YXJnZXRdID0gZnJhbWVidWZmZXI7CiAgICAgIGlmIChpc1dlYkdMMikgewogICAgICAgIGlmICh0YXJnZXQgPT09IDM2MDA5KSB7CiAgICAgICAgICBjdXJyZW50Qm91bmRGcmFtZWJ1ZmZlcnNbMzYxNjBdID0gZnJhbWVidWZmZXI7CiAgICAgICAgfQogICAgICAgIGlmICh0YXJnZXQgPT09IDM2MTYwKSB7CiAgICAgICAgICBjdXJyZW50Qm91bmRGcmFtZWJ1ZmZlcnNbMzYwMDldID0gZnJhbWVidWZmZXI7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgcmV0dXJuIGZhbHNlOwogIH0KICBmdW5jdGlvbiBkcmF3QnVmZmVycyhyZW5kZXJUYXJnZXQsIGZyYW1lYnVmZmVyKSB7CiAgICBsZXQgZHJhd0J1ZmZlcnMyID0gZGVmYXVsdERyYXdidWZmZXJzOwogICAgbGV0IG5lZWRzVXBkYXRlID0gZmFsc2U7CiAgICBpZiAocmVuZGVyVGFyZ2V0KSB7CiAgICAgIGRyYXdCdWZmZXJzMiA9IGN1cnJlbnREcmF3YnVmZmVycy5nZXQoZnJhbWVidWZmZXIpOwogICAgICBpZiAoZHJhd0J1ZmZlcnMyID09PSB2b2lkIDApIHsKICAgICAgICBkcmF3QnVmZmVyczIgPSBbXTsKICAgICAgICBjdXJyZW50RHJhd2J1ZmZlcnMuc2V0KGZyYW1lYnVmZmVyLCBkcmF3QnVmZmVyczIpOwogICAgICB9CiAgICAgIGlmIChyZW5kZXJUYXJnZXQuaXNXZWJHTE11bHRpcGxlUmVuZGVyVGFyZ2V0cykgewogICAgICAgIGNvbnN0IHRleHR1cmVzID0gcmVuZGVyVGFyZ2V0LnRleHR1cmU7CiAgICAgICAgaWYgKGRyYXdCdWZmZXJzMi5sZW5ndGggIT09IHRleHR1cmVzLmxlbmd0aCB8fCBkcmF3QnVmZmVyczJbMF0gIT09IDM2MDY0KSB7CiAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSB0ZXh0dXJlcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgICAgICAgIGRyYXdCdWZmZXJzMltpXSA9IDM2MDY0ICsgaTsKICAgICAgICAgIH0KICAgICAgICAgIGRyYXdCdWZmZXJzMi5sZW5ndGggPSB0ZXh0dXJlcy5sZW5ndGg7CiAgICAgICAgICBuZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChkcmF3QnVmZmVyczJbMF0gIT09IDM2MDY0KSB7CiAgICAgICAgICBkcmF3QnVmZmVyczJbMF0gPSAzNjA2NDsKICAgICAgICAgIG5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmIChkcmF3QnVmZmVyczJbMF0gIT09IDEwMjkpIHsKICAgICAgICBkcmF3QnVmZmVyczJbMF0gPSAxMDI5OwogICAgICAgIG5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgfQogICAgfQogICAgaWYgKG5lZWRzVXBkYXRlKSB7CiAgICAgIGlmIChjYXBhYmlsaXRpZXMuaXNXZWJHTDIpIHsKICAgICAgICBnbC5kcmF3QnVmZmVycyhkcmF3QnVmZmVyczIpOwogICAgICB9IGVsc2UgewogICAgICAgIGV4dGVuc2lvbnMuZ2V0KCJXRUJHTF9kcmF3X2J1ZmZlcnMiKS5kcmF3QnVmZmVyc1dFQkdMKGRyYXdCdWZmZXJzMik7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gdXNlUHJvZ3JhbShwcm9ncmFtKSB7CiAgICBpZiAoY3VycmVudFByb2dyYW0gIT09IHByb2dyYW0pIHsKICAgICAgZ2wudXNlUHJvZ3JhbShwcm9ncmFtKTsKICAgICAgY3VycmVudFByb2dyYW0gPSBwcm9ncmFtOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIHJldHVybiBmYWxzZTsKICB9CiAgY29uc3QgZXF1YXRpb25Ub0dMID0gewogICAgW0FkZEVxdWF0aW9uXTogMzI3NzQsCiAgICBbU3VidHJhY3RFcXVhdGlvbl06IDMyNzc4LAogICAgW1JldmVyc2VTdWJ0cmFjdEVxdWF0aW9uXTogMzI3NzkKICB9OwogIGlmIChpc1dlYkdMMikgewogICAgZXF1YXRpb25Ub0dMW01pbkVxdWF0aW9uXSA9IDMyNzc1OwogICAgZXF1YXRpb25Ub0dMW01heEVxdWF0aW9uXSA9IDMyNzc2OwogIH0gZWxzZSB7CiAgICBjb25zdCBleHRlbnNpb24gPSBleHRlbnNpb25zLmdldCgiRVhUX2JsZW5kX21pbm1heCIpOwogICAgaWYgKGV4dGVuc2lvbiAhPT0gbnVsbCkgewogICAgICBlcXVhdGlvblRvR0xbTWluRXF1YXRpb25dID0gZXh0ZW5zaW9uLk1JTl9FWFQ7CiAgICAgIGVxdWF0aW9uVG9HTFtNYXhFcXVhdGlvbl0gPSBleHRlbnNpb24uTUFYX0VYVDsKICAgIH0KICB9CiAgY29uc3QgZmFjdG9yVG9HTCA9IHsKICAgIFtaZXJvRmFjdG9yXTogMCwKICAgIFtPbmVGYWN0b3JdOiAxLAogICAgW1NyY0NvbG9yRmFjdG9yXTogNzY4LAogICAgW1NyY0FscGhhRmFjdG9yXTogNzcwLAogICAgW1NyY0FscGhhU2F0dXJhdGVGYWN0b3JdOiA3NzYsCiAgICBbRHN0Q29sb3JGYWN0b3JdOiA3NzQsCiAgICBbRHN0QWxwaGFGYWN0b3JdOiA3NzIsCiAgICBbT25lTWludXNTcmNDb2xvckZhY3Rvcl06IDc2OSwKICAgIFtPbmVNaW51c1NyY0FscGhhRmFjdG9yXTogNzcxLAogICAgW09uZU1pbnVzRHN0Q29sb3JGYWN0b3JdOiA3NzUsCiAgICBbT25lTWludXNEc3RBbHBoYUZhY3Rvcl06IDc3MwogIH07CiAgZnVuY3Rpb24gc2V0QmxlbmRpbmcoYmxlbmRpbmcsIGJsZW5kRXF1YXRpb24sIGJsZW5kU3JjLCBibGVuZERzdCwgYmxlbmRFcXVhdGlvbkFscGhhLCBibGVuZFNyY0FscGhhLCBibGVuZERzdEFscGhhLCBwcmVtdWx0aXBsaWVkQWxwaGEpIHsKICAgIGlmIChibGVuZGluZyA9PT0gTm9CbGVuZGluZykgewogICAgICBpZiAoY3VycmVudEJsZW5kaW5nRW5hYmxlZCA9PT0gdHJ1ZSkgewogICAgICAgIGRpc2FibGUoMzA0Mik7CiAgICAgICAgY3VycmVudEJsZW5kaW5nRW5hYmxlZCA9IGZhbHNlOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmIChjdXJyZW50QmxlbmRpbmdFbmFibGVkID09PSBmYWxzZSkgewogICAgICBlbmFibGUoMzA0Mik7CiAgICAgIGN1cnJlbnRCbGVuZGluZ0VuYWJsZWQgPSB0cnVlOwogICAgfQogICAgaWYgKGJsZW5kaW5nICE9PSBDdXN0b21CbGVuZGluZykgewogICAgICBpZiAoYmxlbmRpbmcgIT09IGN1cnJlbnRCbGVuZGluZyB8fCBwcmVtdWx0aXBsaWVkQWxwaGEgIT09IGN1cnJlbnRQcmVtdWx0aXBsZWRBbHBoYSkgewogICAgICAgIGlmIChjdXJyZW50QmxlbmRFcXVhdGlvbiAhPT0gQWRkRXF1YXRpb24gfHwgY3VycmVudEJsZW5kRXF1YXRpb25BbHBoYSAhPT0gQWRkRXF1YXRpb24pIHsKICAgICAgICAgIGdsLmJsZW5kRXF1YXRpb24oMzI3NzQpOwogICAgICAgICAgY3VycmVudEJsZW5kRXF1YXRpb24gPSBBZGRFcXVhdGlvbjsKICAgICAgICAgIGN1cnJlbnRCbGVuZEVxdWF0aW9uQWxwaGEgPSBBZGRFcXVhdGlvbjsKICAgICAgICB9CiAgICAgICAgaWYgKHByZW11bHRpcGxpZWRBbHBoYSkgewogICAgICAgICAgc3dpdGNoIChibGVuZGluZykgewogICAgICAgICAgICBjYXNlIE5vcm1hbEJsZW5kaW5nOgogICAgICAgICAgICAgIGdsLmJsZW5kRnVuY1NlcGFyYXRlKDEsIDc3MSwgMSwgNzcxKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBBZGRpdGl2ZUJsZW5kaW5nOgogICAgICAgICAgICAgIGdsLmJsZW5kRnVuYygxLCAxKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBTdWJ0cmFjdGl2ZUJsZW5kaW5nOgogICAgICAgICAgICAgIGdsLmJsZW5kRnVuY1NlcGFyYXRlKDAsIDc2OSwgMCwgMSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgTXVsdGlwbHlCbGVuZGluZzoKICAgICAgICAgICAgICBnbC5ibGVuZEZ1bmNTZXBhcmF0ZSgwLCA3NjgsIDAsIDc3MCk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuV2ViR0xTdGF0ZTogSW52YWxpZCBibGVuZGluZzogIiwgYmxlbmRpbmcpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzd2l0Y2ggKGJsZW5kaW5nKSB7CiAgICAgICAgICAgIGNhc2UgTm9ybWFsQmxlbmRpbmc6CiAgICAgICAgICAgICAgZ2wuYmxlbmRGdW5jU2VwYXJhdGUoNzcwLCA3NzEsIDEsIDc3MSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgQWRkaXRpdmVCbGVuZGluZzoKICAgICAgICAgICAgICBnbC5ibGVuZEZ1bmMoNzcwLCAxKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBTdWJ0cmFjdGl2ZUJsZW5kaW5nOgogICAgICAgICAgICAgIGdsLmJsZW5kRnVuY1NlcGFyYXRlKDAsIDc2OSwgMCwgMSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgTXVsdGlwbHlCbGVuZGluZzoKICAgICAgICAgICAgICBnbC5ibGVuZEZ1bmMoMCwgNzY4KTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5XZWJHTFN0YXRlOiBJbnZhbGlkIGJsZW5kaW5nOiAiLCBibGVuZGluZyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGN1cnJlbnRCbGVuZFNyYyA9IG51bGw7CiAgICAgICAgY3VycmVudEJsZW5kRHN0ID0gbnVsbDsKICAgICAgICBjdXJyZW50QmxlbmRTcmNBbHBoYSA9IG51bGw7CiAgICAgICAgY3VycmVudEJsZW5kRHN0QWxwaGEgPSBudWxsOwogICAgICAgIGN1cnJlbnRCbGVuZGluZyA9IGJsZW5kaW5nOwogICAgICAgIGN1cnJlbnRQcmVtdWx0aXBsZWRBbHBoYSA9IHByZW11bHRpcGxpZWRBbHBoYTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CiAgICBibGVuZEVxdWF0aW9uQWxwaGEgPSBibGVuZEVxdWF0aW9uQWxwaGEgfHwgYmxlbmRFcXVhdGlvbjsKICAgIGJsZW5kU3JjQWxwaGEgPSBibGVuZFNyY0FscGhhIHx8IGJsZW5kU3JjOwogICAgYmxlbmREc3RBbHBoYSA9IGJsZW5kRHN0QWxwaGEgfHwgYmxlbmREc3Q7CiAgICBpZiAoYmxlbmRFcXVhdGlvbiAhPT0gY3VycmVudEJsZW5kRXF1YXRpb24gfHwgYmxlbmRFcXVhdGlvbkFscGhhICE9PSBjdXJyZW50QmxlbmRFcXVhdGlvbkFscGhhKSB7CiAgICAgIGdsLmJsZW5kRXF1YXRpb25TZXBhcmF0ZShlcXVhdGlvblRvR0xbYmxlbmRFcXVhdGlvbl0sIGVxdWF0aW9uVG9HTFtibGVuZEVxdWF0aW9uQWxwaGFdKTsKICAgICAgY3VycmVudEJsZW5kRXF1YXRpb24gPSBibGVuZEVxdWF0aW9uOwogICAgICBjdXJyZW50QmxlbmRFcXVhdGlvbkFscGhhID0gYmxlbmRFcXVhdGlvbkFscGhhOwogICAgfQogICAgaWYgKGJsZW5kU3JjICE9PSBjdXJyZW50QmxlbmRTcmMgfHwgYmxlbmREc3QgIT09IGN1cnJlbnRCbGVuZERzdCB8fCBibGVuZFNyY0FscGhhICE9PSBjdXJyZW50QmxlbmRTcmNBbHBoYSB8fCBibGVuZERzdEFscGhhICE9PSBjdXJyZW50QmxlbmREc3RBbHBoYSkgewogICAgICBnbC5ibGVuZEZ1bmNTZXBhcmF0ZShmYWN0b3JUb0dMW2JsZW5kU3JjXSwgZmFjdG9yVG9HTFtibGVuZERzdF0sIGZhY3RvclRvR0xbYmxlbmRTcmNBbHBoYV0sIGZhY3RvclRvR0xbYmxlbmREc3RBbHBoYV0pOwogICAgICBjdXJyZW50QmxlbmRTcmMgPSBibGVuZFNyYzsKICAgICAgY3VycmVudEJsZW5kRHN0ID0gYmxlbmREc3Q7CiAgICAgIGN1cnJlbnRCbGVuZFNyY0FscGhhID0gYmxlbmRTcmNBbHBoYTsKICAgICAgY3VycmVudEJsZW5kRHN0QWxwaGEgPSBibGVuZERzdEFscGhhOwogICAgfQogICAgY3VycmVudEJsZW5kaW5nID0gYmxlbmRpbmc7CiAgICBjdXJyZW50UHJlbXVsdGlwbGVkQWxwaGEgPSBudWxsOwogIH0KICBmdW5jdGlvbiBzZXRNYXRlcmlhbChtYXRlcmlhbCwgZnJvbnRGYWNlQ1cpIHsKICAgIG1hdGVyaWFsLnNpZGUgPT09IERvdWJsZVNpZGUgPyBkaXNhYmxlKDI4ODQpIDogZW5hYmxlKDI4ODQpOwogICAgbGV0IGZsaXBTaWRlZCA9IG1hdGVyaWFsLnNpZGUgPT09IEJhY2tTaWRlOwogICAgaWYgKGZyb250RmFjZUNXKQogICAgICBmbGlwU2lkZWQgPSAhZmxpcFNpZGVkOwogICAgc2V0RmxpcFNpZGVkKGZsaXBTaWRlZCk7CiAgICBtYXRlcmlhbC5ibGVuZGluZyA9PT0gTm9ybWFsQmxlbmRpbmcgJiYgbWF0ZXJpYWwudHJhbnNwYXJlbnQgPT09IGZhbHNlID8gc2V0QmxlbmRpbmcoTm9CbGVuZGluZykgOiBzZXRCbGVuZGluZyhtYXRlcmlhbC5ibGVuZGluZywgbWF0ZXJpYWwuYmxlbmRFcXVhdGlvbiwgbWF0ZXJpYWwuYmxlbmRTcmMsIG1hdGVyaWFsLmJsZW5kRHN0LCBtYXRlcmlhbC5ibGVuZEVxdWF0aW9uQWxwaGEsIG1hdGVyaWFsLmJsZW5kU3JjQWxwaGEsIG1hdGVyaWFsLmJsZW5kRHN0QWxwaGEsIG1hdGVyaWFsLnByZW11bHRpcGxpZWRBbHBoYSk7CiAgICBkZXB0aEJ1ZmZlci5zZXRGdW5jKG1hdGVyaWFsLmRlcHRoRnVuYyk7CiAgICBkZXB0aEJ1ZmZlci5zZXRUZXN0KG1hdGVyaWFsLmRlcHRoVGVzdCk7CiAgICBkZXB0aEJ1ZmZlci5zZXRNYXNrKG1hdGVyaWFsLmRlcHRoV3JpdGUpOwogICAgY29sb3JCdWZmZXIuc2V0TWFzayhtYXRlcmlhbC5jb2xvcldyaXRlKTsKICAgIGNvbnN0IHN0ZW5jaWxXcml0ZSA9IG1hdGVyaWFsLnN0ZW5jaWxXcml0ZTsKICAgIHN0ZW5jaWxCdWZmZXIuc2V0VGVzdChzdGVuY2lsV3JpdGUpOwogICAgaWYgKHN0ZW5jaWxXcml0ZSkgewogICAgICBzdGVuY2lsQnVmZmVyLnNldE1hc2sobWF0ZXJpYWwuc3RlbmNpbFdyaXRlTWFzayk7CiAgICAgIHN0ZW5jaWxCdWZmZXIuc2V0RnVuYyhtYXRlcmlhbC5zdGVuY2lsRnVuYywgbWF0ZXJpYWwuc3RlbmNpbFJlZiwgbWF0ZXJpYWwuc3RlbmNpbEZ1bmNNYXNrKTsKICAgICAgc3RlbmNpbEJ1ZmZlci5zZXRPcChtYXRlcmlhbC5zdGVuY2lsRmFpbCwgbWF0ZXJpYWwuc3RlbmNpbFpGYWlsLCBtYXRlcmlhbC5zdGVuY2lsWlBhc3MpOwogICAgfQogICAgc2V0UG9seWdvbk9mZnNldChtYXRlcmlhbC5wb2x5Z29uT2Zmc2V0LCBtYXRlcmlhbC5wb2x5Z29uT2Zmc2V0RmFjdG9yLCBtYXRlcmlhbC5wb2x5Z29uT2Zmc2V0VW5pdHMpOwogICAgbWF0ZXJpYWwuYWxwaGFUb0NvdmVyYWdlID09PSB0cnVlID8gZW5hYmxlKDMyOTI2KSA6IGRpc2FibGUoMzI5MjYpOwogIH0KICBmdW5jdGlvbiBzZXRGbGlwU2lkZWQoZmxpcFNpZGVkKSB7CiAgICBpZiAoY3VycmVudEZsaXBTaWRlZCAhPT0gZmxpcFNpZGVkKSB7CiAgICAgIGlmIChmbGlwU2lkZWQpIHsKICAgICAgICBnbC5mcm9udEZhY2UoMjMwNCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZ2wuZnJvbnRGYWNlKDIzMDUpOwogICAgICB9CiAgICAgIGN1cnJlbnRGbGlwU2lkZWQgPSBmbGlwU2lkZWQ7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHNldEN1bGxGYWNlKGN1bGxGYWNlKSB7CiAgICBpZiAoY3VsbEZhY2UgIT09IEN1bGxGYWNlTm9uZSkgewogICAgICBlbmFibGUoMjg4NCk7CiAgICAgIGlmIChjdWxsRmFjZSAhPT0gY3VycmVudEN1bGxGYWNlKSB7CiAgICAgICAgaWYgKGN1bGxGYWNlID09PSBDdWxsRmFjZUJhY2spIHsKICAgICAgICAgIGdsLmN1bGxGYWNlKDEwMjkpOwogICAgICAgIH0gZWxzZSBpZiAoY3VsbEZhY2UgPT09IEN1bGxGYWNlRnJvbnQpIHsKICAgICAgICAgIGdsLmN1bGxGYWNlKDEwMjgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBnbC5jdWxsRmFjZSgxMDMyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGRpc2FibGUoMjg4NCk7CiAgICB9CiAgICBjdXJyZW50Q3VsbEZhY2UgPSBjdWxsRmFjZTsKICB9CiAgZnVuY3Rpb24gc2V0TGluZVdpZHRoKHdpZHRoKSB7CiAgICBpZiAod2lkdGggIT09IGN1cnJlbnRMaW5lV2lkdGgpIHsKICAgICAgaWYgKGxpbmVXaWR0aEF2YWlsYWJsZSkKICAgICAgICBnbC5saW5lV2lkdGgod2lkdGgpOwogICAgICBjdXJyZW50TGluZVdpZHRoID0gd2lkdGg7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHNldFBvbHlnb25PZmZzZXQocG9seWdvbk9mZnNldCwgZmFjdG9yLCB1bml0cykgewogICAgaWYgKHBvbHlnb25PZmZzZXQpIHsKICAgICAgZW5hYmxlKDMyODIzKTsKICAgICAgaWYgKGN1cnJlbnRQb2x5Z29uT2Zmc2V0RmFjdG9yICE9PSBmYWN0b3IgfHwgY3VycmVudFBvbHlnb25PZmZzZXRVbml0cyAhPT0gdW5pdHMpIHsKICAgICAgICBnbC5wb2x5Z29uT2Zmc2V0KGZhY3RvciwgdW5pdHMpOwogICAgICAgIGN1cnJlbnRQb2x5Z29uT2Zmc2V0RmFjdG9yID0gZmFjdG9yOwogICAgICAgIGN1cnJlbnRQb2x5Z29uT2Zmc2V0VW5pdHMgPSB1bml0czsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgZGlzYWJsZSgzMjgyMyk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHNldFNjaXNzb3JUZXN0KHNjaXNzb3JUZXN0KSB7CiAgICBpZiAoc2Npc3NvclRlc3QpIHsKICAgICAgZW5hYmxlKDMwODkpOwogICAgfSBlbHNlIHsKICAgICAgZGlzYWJsZSgzMDg5KTsKICAgIH0KICB9CiAgZnVuY3Rpb24gYWN0aXZlVGV4dHVyZSh3ZWJnbFNsb3QpIHsKICAgIGlmICh3ZWJnbFNsb3QgPT09IHZvaWQgMCkKICAgICAgd2ViZ2xTbG90ID0gMzM5ODQgKyBtYXhUZXh0dXJlcyAtIDE7CiAgICBpZiAoY3VycmVudFRleHR1cmVTbG90ICE9PSB3ZWJnbFNsb3QpIHsKICAgICAgZ2wuYWN0aXZlVGV4dHVyZSh3ZWJnbFNsb3QpOwogICAgICBjdXJyZW50VGV4dHVyZVNsb3QgPSB3ZWJnbFNsb3Q7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGJpbmRUZXh0dXJlKHdlYmdsVHlwZSwgd2ViZ2xUZXh0dXJlKSB7CiAgICBpZiAoY3VycmVudFRleHR1cmVTbG90ID09PSBudWxsKSB7CiAgICAgIGFjdGl2ZVRleHR1cmUoKTsKICAgIH0KICAgIGxldCBib3VuZFRleHR1cmUgPSBjdXJyZW50Qm91bmRUZXh0dXJlc1tjdXJyZW50VGV4dHVyZVNsb3RdOwogICAgaWYgKGJvdW5kVGV4dHVyZSA9PT0gdm9pZCAwKSB7CiAgICAgIGJvdW5kVGV4dHVyZSA9IHsgdHlwZTogdm9pZCAwLCB0ZXh0dXJlOiB2b2lkIDAgfTsKICAgICAgY3VycmVudEJvdW5kVGV4dHVyZXNbY3VycmVudFRleHR1cmVTbG90XSA9IGJvdW5kVGV4dHVyZTsKICAgIH0KICAgIGlmIChib3VuZFRleHR1cmUudHlwZSAhPT0gd2ViZ2xUeXBlIHx8IGJvdW5kVGV4dHVyZS50ZXh0dXJlICE9PSB3ZWJnbFRleHR1cmUpIHsKICAgICAgZ2wuYmluZFRleHR1cmUod2ViZ2xUeXBlLCB3ZWJnbFRleHR1cmUgfHwgZW1wdHlUZXh0dXJlc1t3ZWJnbFR5cGVdKTsKICAgICAgYm91bmRUZXh0dXJlLnR5cGUgPSB3ZWJnbFR5cGU7CiAgICAgIGJvdW5kVGV4dHVyZS50ZXh0dXJlID0gd2ViZ2xUZXh0dXJlOwogICAgfQogIH0KICBmdW5jdGlvbiB1bmJpbmRUZXh0dXJlKCkgewogICAgY29uc3QgYm91bmRUZXh0dXJlID0gY3VycmVudEJvdW5kVGV4dHVyZXNbY3VycmVudFRleHR1cmVTbG90XTsKICAgIGlmIChib3VuZFRleHR1cmUgIT09IHZvaWQgMCAmJiBib3VuZFRleHR1cmUudHlwZSAhPT0gdm9pZCAwKSB7CiAgICAgIGdsLmJpbmRUZXh0dXJlKGJvdW5kVGV4dHVyZS50eXBlLCBudWxsKTsKICAgICAgYm91bmRUZXh0dXJlLnR5cGUgPSB2b2lkIDA7CiAgICAgIGJvdW5kVGV4dHVyZS50ZXh0dXJlID0gdm9pZCAwOwogICAgfQogIH0KICBmdW5jdGlvbiBjb21wcmVzc2VkVGV4SW1hZ2UyRCgpIHsKICAgIHRyeSB7CiAgICAgIGdsLmNvbXByZXNzZWRUZXhJbWFnZTJELmFwcGx5KGdsLCBhcmd1bWVudHMpOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuV2ViR0xTdGF0ZToiLCBlcnJvcik7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHRleFN1YkltYWdlMkQoKSB7CiAgICB0cnkgewogICAgICBnbC50ZXhTdWJJbWFnZTJELmFwcGx5KGdsLCBhcmd1bWVudHMpOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuV2ViR0xTdGF0ZToiLCBlcnJvcik7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHRleFN1YkltYWdlM0QoKSB7CiAgICB0cnkgewogICAgICBnbC50ZXhTdWJJbWFnZTNELmFwcGx5KGdsLCBhcmd1bWVudHMpOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuV2ViR0xTdGF0ZToiLCBlcnJvcik7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGNvbXByZXNzZWRUZXhTdWJJbWFnZTJEKCkgewogICAgdHJ5IHsKICAgICAgZ2wuY29tcHJlc3NlZFRleFN1YkltYWdlMkQuYXBwbHkoZ2wsIGFyZ3VtZW50cyk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5XZWJHTFN0YXRlOiIsIGVycm9yKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gdGV4U3RvcmFnZTJEKCkgewogICAgdHJ5IHsKICAgICAgZ2wudGV4U3RvcmFnZTJELmFwcGx5KGdsLCBhcmd1bWVudHMpOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuV2ViR0xTdGF0ZToiLCBlcnJvcik7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHRleFN0b3JhZ2UzRCgpIHsKICAgIHRyeSB7CiAgICAgIGdsLnRleFN0b3JhZ2UzRC5hcHBseShnbCwgYXJndW1lbnRzKTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLldlYkdMU3RhdGU6IiwgZXJyb3IpOwogICAgfQogIH0KICBmdW5jdGlvbiB0ZXhJbWFnZTJEKCkgewogICAgdHJ5IHsKICAgICAgZ2wudGV4SW1hZ2UyRC5hcHBseShnbCwgYXJndW1lbnRzKTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLldlYkdMU3RhdGU6IiwgZXJyb3IpOwogICAgfQogIH0KICBmdW5jdGlvbiB0ZXhJbWFnZTNEKCkgewogICAgdHJ5IHsKICAgICAgZ2wudGV4SW1hZ2UzRC5hcHBseShnbCwgYXJndW1lbnRzKTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLldlYkdMU3RhdGU6IiwgZXJyb3IpOwogICAgfQogIH0KICBmdW5jdGlvbiBzY2lzc29yKHNjaXNzb3IyKSB7CiAgICBpZiAoY3VycmVudFNjaXNzb3IuZXF1YWxzKHNjaXNzb3IyKSA9PT0gZmFsc2UpIHsKICAgICAgZ2wuc2Npc3NvcihzY2lzc29yMi54LCBzY2lzc29yMi55LCBzY2lzc29yMi56LCBzY2lzc29yMi53KTsKICAgICAgY3VycmVudFNjaXNzb3IuY29weShzY2lzc29yMik7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHZpZXdwb3J0KHZpZXdwb3J0MikgewogICAgaWYgKGN1cnJlbnRWaWV3cG9ydC5lcXVhbHModmlld3BvcnQyKSA9PT0gZmFsc2UpIHsKICAgICAgZ2wudmlld3BvcnQodmlld3BvcnQyLngsIHZpZXdwb3J0Mi55LCB2aWV3cG9ydDIueiwgdmlld3BvcnQyLncpOwogICAgICBjdXJyZW50Vmlld3BvcnQuY29weSh2aWV3cG9ydDIpOwogICAgfQogIH0KICBmdW5jdGlvbiByZXNldCgpIHsKICAgIGdsLmRpc2FibGUoMzA0Mik7CiAgICBnbC5kaXNhYmxlKDI4ODQpOwogICAgZ2wuZGlzYWJsZSgyOTI5KTsKICAgIGdsLmRpc2FibGUoMzI4MjMpOwogICAgZ2wuZGlzYWJsZSgzMDg5KTsKICAgIGdsLmRpc2FibGUoMjk2MCk7CiAgICBnbC5kaXNhYmxlKDMyOTI2KTsKICAgIGdsLmJsZW5kRXF1YXRpb24oMzI3NzQpOwogICAgZ2wuYmxlbmRGdW5jKDEsIDApOwogICAgZ2wuYmxlbmRGdW5jU2VwYXJhdGUoMSwgMCwgMSwgMCk7CiAgICBnbC5jb2xvck1hc2sodHJ1ZSwgdHJ1ZSwgdHJ1ZSwgdHJ1ZSk7CiAgICBnbC5jbGVhckNvbG9yKDAsIDAsIDAsIDApOwogICAgZ2wuZGVwdGhNYXNrKHRydWUpOwogICAgZ2wuZGVwdGhGdW5jKDUxMyk7CiAgICBnbC5jbGVhckRlcHRoKDEpOwogICAgZ2wuc3RlbmNpbE1hc2soNDI5NDk2NzI5NSk7CiAgICBnbC5zdGVuY2lsRnVuYyg1MTksIDAsIDQyOTQ5NjcyOTUpOwogICAgZ2wuc3RlbmNpbE9wKDc2ODAsIDc2ODAsIDc2ODApOwogICAgZ2wuY2xlYXJTdGVuY2lsKDApOwogICAgZ2wuY3VsbEZhY2UoMTAyOSk7CiAgICBnbC5mcm9udEZhY2UoMjMwNSk7CiAgICBnbC5wb2x5Z29uT2Zmc2V0KDAsIDApOwogICAgZ2wuYWN0aXZlVGV4dHVyZSgzMzk4NCk7CiAgICBnbC5iaW5kRnJhbWVidWZmZXIoMzYxNjAsIG51bGwpOwogICAgaWYgKGlzV2ViR0wyID09PSB0cnVlKSB7CiAgICAgIGdsLmJpbmRGcmFtZWJ1ZmZlcigzNjAwOSwgbnVsbCk7CiAgICAgIGdsLmJpbmRGcmFtZWJ1ZmZlcigzNjAwOCwgbnVsbCk7CiAgICB9CiAgICBnbC51c2VQcm9ncmFtKG51bGwpOwogICAgZ2wubGluZVdpZHRoKDEpOwogICAgZ2wuc2Npc3NvcigwLCAwLCBnbC5jYW52YXMud2lkdGgsIGdsLmNhbnZhcy5oZWlnaHQpOwogICAgZ2wudmlld3BvcnQoMCwgMCwgZ2wuY2FudmFzLndpZHRoLCBnbC5jYW52YXMuaGVpZ2h0KTsKICAgIGVuYWJsZWRDYXBhYmlsaXRpZXMgPSB7fTsKICAgIGN1cnJlbnRUZXh0dXJlU2xvdCA9IG51bGw7CiAgICBjdXJyZW50Qm91bmRUZXh0dXJlcyA9IHt9OwogICAgY3VycmVudEJvdW5kRnJhbWVidWZmZXJzID0ge307CiAgICBjdXJyZW50RHJhd2J1ZmZlcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKICAgIGRlZmF1bHREcmF3YnVmZmVycyA9IFtdOwogICAgY3VycmVudFByb2dyYW0gPSBudWxsOwogICAgY3VycmVudEJsZW5kaW5nRW5hYmxlZCA9IGZhbHNlOwogICAgY3VycmVudEJsZW5kaW5nID0gbnVsbDsKICAgIGN1cnJlbnRCbGVuZEVxdWF0aW9uID0gbnVsbDsKICAgIGN1cnJlbnRCbGVuZFNyYyA9IG51bGw7CiAgICBjdXJyZW50QmxlbmREc3QgPSBudWxsOwogICAgY3VycmVudEJsZW5kRXF1YXRpb25BbHBoYSA9IG51bGw7CiAgICBjdXJyZW50QmxlbmRTcmNBbHBoYSA9IG51bGw7CiAgICBjdXJyZW50QmxlbmREc3RBbHBoYSA9IG51bGw7CiAgICBjdXJyZW50UHJlbXVsdGlwbGVkQWxwaGEgPSBmYWxzZTsKICAgIGN1cnJlbnRGbGlwU2lkZWQgPSBudWxsOwogICAgY3VycmVudEN1bGxGYWNlID0gbnVsbDsKICAgIGN1cnJlbnRMaW5lV2lkdGggPSBudWxsOwogICAgY3VycmVudFBvbHlnb25PZmZzZXRGYWN0b3IgPSBudWxsOwogICAgY3VycmVudFBvbHlnb25PZmZzZXRVbml0cyA9IG51bGw7CiAgICBjdXJyZW50U2Npc3Nvci5zZXQoMCwgMCwgZ2wuY2FudmFzLndpZHRoLCBnbC5jYW52YXMuaGVpZ2h0KTsKICAgIGN1cnJlbnRWaWV3cG9ydC5zZXQoMCwgMCwgZ2wuY2FudmFzLndpZHRoLCBnbC5jYW52YXMuaGVpZ2h0KTsKICAgIGNvbG9yQnVmZmVyLnJlc2V0KCk7CiAgICBkZXB0aEJ1ZmZlci5yZXNldCgpOwogICAgc3RlbmNpbEJ1ZmZlci5yZXNldCgpOwogIH0KICByZXR1cm4gewogICAgYnVmZmVyczogewogICAgICBjb2xvcjogY29sb3JCdWZmZXIsCiAgICAgIGRlcHRoOiBkZXB0aEJ1ZmZlciwKICAgICAgc3RlbmNpbDogc3RlbmNpbEJ1ZmZlcgogICAgfSwKICAgIGVuYWJsZSwKICAgIGRpc2FibGUsCiAgICBiaW5kRnJhbWVidWZmZXIsCiAgICBkcmF3QnVmZmVycywKICAgIHVzZVByb2dyYW0sCiAgICBzZXRCbGVuZGluZywKICAgIHNldE1hdGVyaWFsLAogICAgc2V0RmxpcFNpZGVkLAogICAgc2V0Q3VsbEZhY2UsCiAgICBzZXRMaW5lV2lkdGgsCiAgICBzZXRQb2x5Z29uT2Zmc2V0LAogICAgc2V0U2Npc3NvclRlc3QsCiAgICBhY3RpdmVUZXh0dXJlLAogICAgYmluZFRleHR1cmUsCiAgICB1bmJpbmRUZXh0dXJlLAogICAgY29tcHJlc3NlZFRleEltYWdlMkQsCiAgICB0ZXhJbWFnZTJELAogICAgdGV4SW1hZ2UzRCwKICAgIHRleFN0b3JhZ2UyRCwKICAgIHRleFN0b3JhZ2UzRCwKICAgIHRleFN1YkltYWdlMkQsCiAgICB0ZXhTdWJJbWFnZTNELAogICAgY29tcHJlc3NlZFRleFN1YkltYWdlMkQsCiAgICBzY2lzc29yLAogICAgdmlld3BvcnQsCiAgICByZXNldAogIH07Cn0KZnVuY3Rpb24gV2ViR0xUZXh0dXJlcyhfZ2wsIGV4dGVuc2lvbnMsIHN0YXRlLCBwcm9wZXJ0aWVzLCBjYXBhYmlsaXRpZXMsIHV0aWxzLCBpbmZvKSB7CiAgY29uc3QgaXNXZWJHTDIgPSBjYXBhYmlsaXRpZXMuaXNXZWJHTDI7CiAgY29uc3QgbWF4VGV4dHVyZXMgPSBjYXBhYmlsaXRpZXMubWF4VGV4dHVyZXM7CiAgY29uc3QgbWF4Q3ViZW1hcFNpemUgPSBjYXBhYmlsaXRpZXMubWF4Q3ViZW1hcFNpemU7CiAgY29uc3QgbWF4VGV4dHVyZVNpemUgPSBjYXBhYmlsaXRpZXMubWF4VGV4dHVyZVNpemU7CiAgY29uc3QgbWF4U2FtcGxlcyA9IGNhcGFiaWxpdGllcy5tYXhTYW1wbGVzOwogIGNvbnN0IGhhc011bHRpc2FtcGxlZFJlbmRlclRvVGV4dHVyZSA9IGV4dGVuc2lvbnMuaGFzKCJXRUJHTF9tdWx0aXNhbXBsZWRfcmVuZGVyX3RvX3RleHR1cmUiKTsKICBjb25zdCBNdWx0aXNhbXBsZWRSZW5kZXJUb1RleHR1cmVFeHRlbnNpb24gPSBoYXNNdWx0aXNhbXBsZWRSZW5kZXJUb1RleHR1cmUgPyBleHRlbnNpb25zLmdldCgiV0VCR0xfbXVsdGlzYW1wbGVkX3JlbmRlcl90b190ZXh0dXJlIikgOiB2b2lkIDA7CiAgY29uc3QgX3ZpZGVvVGV4dHVyZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKICBsZXQgX2NhbnZhczI7CiAgbGV0IHVzZU9mZnNjcmVlbkNhbnZhcyA9IGZhbHNlOwogIHRyeSB7CiAgICB1c2VPZmZzY3JlZW5DYW52YXMgPSB0eXBlb2YgT2Zmc2NyZWVuQ2FudmFzICE9PSAidW5kZWZpbmVkIiAmJiBuZXcgT2Zmc2NyZWVuQ2FudmFzKDEsIDEpLmdldENvbnRleHQoIjJkIikgIT09IG51bGw7CiAgfSBjYXRjaCAoZXJyKSB7CiAgfQogIGZ1bmN0aW9uIGNyZWF0ZUNhbnZhcyh3aWR0aCwgaGVpZ2h0KSB7CiAgICByZXR1cm4gdXNlT2Zmc2NyZWVuQ2FudmFzID8gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KSA6IGNyZWF0ZUVsZW1lbnROUygiY2FudmFzIik7CiAgfQogIGZ1bmN0aW9uIHJlc2l6ZUltYWdlKGltYWdlLCBuZWVkc1Bvd2VyT2ZUd28sIG5lZWRzTmV3Q2FudmFzLCBtYXhTaXplKSB7CiAgICBsZXQgc2NhbGUgPSAxOwogICAgaWYgKGltYWdlLndpZHRoID4gbWF4U2l6ZSB8fCBpbWFnZS5oZWlnaHQgPiBtYXhTaXplKSB7CiAgICAgIHNjYWxlID0gbWF4U2l6ZSAvIE1hdGgubWF4KGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQpOwogICAgfQogICAgaWYgKHNjYWxlIDwgMSB8fCBuZWVkc1Bvd2VyT2ZUd28gPT09IHRydWUpIHsKICAgICAgaWYgKHR5cGVvZiBIVE1MSW1hZ2VFbGVtZW50ICE9PSAidW5kZWZpbmVkIiAmJiBpbWFnZSBpbnN0YW5jZW9mIEhUTUxJbWFnZUVsZW1lbnQgfHwgdHlwZW9mIEhUTUxDYW52YXNFbGVtZW50ICE9PSAidW5kZWZpbmVkIiAmJiBpbWFnZSBpbnN0YW5jZW9mIEhUTUxDYW52YXNFbGVtZW50IHx8IHR5cGVvZiBJbWFnZUJpdG1hcCAhPT0gInVuZGVmaW5lZCIgJiYgaW1hZ2UgaW5zdGFuY2VvZiBJbWFnZUJpdG1hcCkgewogICAgICAgIGNvbnN0IGZsb29yID0gbmVlZHNQb3dlck9mVHdvID8gZmxvb3JQb3dlck9mVHdvIDogTWF0aC5mbG9vcjsKICAgICAgICBjb25zdCB3aWR0aCA9IGZsb29yKHNjYWxlICogaW1hZ2Uud2lkdGgpOwogICAgICAgIGNvbnN0IGhlaWdodCA9IGZsb29yKHNjYWxlICogaW1hZ2UuaGVpZ2h0KTsKICAgICAgICBpZiAoX2NhbnZhczIgPT09IHZvaWQgMCkKICAgICAgICAgIF9jYW52YXMyID0gY3JlYXRlQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICAgIGNvbnN0IGNhbnZhcyA9IG5lZWRzTmV3Q2FudmFzID8gY3JlYXRlQ2FudmFzKHdpZHRoLCBoZWlnaHQpIDogX2NhbnZhczI7CiAgICAgICAgY2FudmFzLndpZHRoID0gd2lkdGg7CiAgICAgICAgY2FudmFzLmhlaWdodCA9IGhlaWdodDsKICAgICAgICBjb25zdCBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoIjJkIik7CiAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UoaW1hZ2UsIDAsIDAsIHdpZHRoLCBoZWlnaHQpOwogICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogVGV4dHVyZSBoYXMgYmVlbiByZXNpemVkIGZyb20gKCIgKyBpbWFnZS53aWR0aCArICJ4IiArIGltYWdlLmhlaWdodCArICIpIHRvICgiICsgd2lkdGggKyAieCIgKyBoZWlnaHQgKyAiKS4iKTsKICAgICAgICByZXR1cm4gY2FudmFzOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICgiZGF0YSIgaW4gaW1hZ2UpIHsKICAgICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogSW1hZ2UgaW4gRGF0YVRleHR1cmUgaXMgdG9vIGJpZyAoIiArIGltYWdlLndpZHRoICsgIngiICsgaW1hZ2UuaGVpZ2h0ICsgIikuIik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBpbWFnZTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGltYWdlOwogIH0KICBmdW5jdGlvbiBpc1Bvd2VyT2ZUd28kMShpbWFnZSkgewogICAgcmV0dXJuIGlzUG93ZXJPZlR3byhpbWFnZS53aWR0aCkgJiYgaXNQb3dlck9mVHdvKGltYWdlLmhlaWdodCk7CiAgfQogIGZ1bmN0aW9uIHRleHR1cmVOZWVkc1Bvd2VyT2ZUd28odGV4dHVyZSkgewogICAgaWYgKGlzV2ViR0wyKQogICAgICByZXR1cm4gZmFsc2U7CiAgICByZXR1cm4gdGV4dHVyZS53cmFwUyAhPT0gQ2xhbXBUb0VkZ2VXcmFwcGluZyB8fCB0ZXh0dXJlLndyYXBUICE9PSBDbGFtcFRvRWRnZVdyYXBwaW5nIHx8IHRleHR1cmUubWluRmlsdGVyICE9PSBOZWFyZXN0RmlsdGVyICYmIHRleHR1cmUubWluRmlsdGVyICE9PSBMaW5lYXJGaWx0ZXI7CiAgfQogIGZ1bmN0aW9uIHRleHR1cmVOZWVkc0dlbmVyYXRlTWlwbWFwcyh0ZXh0dXJlLCBzdXBwb3J0c01pcHMpIHsKICAgIHJldHVybiB0ZXh0dXJlLmdlbmVyYXRlTWlwbWFwcyAmJiBzdXBwb3J0c01pcHMgJiYgdGV4dHVyZS5taW5GaWx0ZXIgIT09IE5lYXJlc3RGaWx0ZXIgJiYgdGV4dHVyZS5taW5GaWx0ZXIgIT09IExpbmVhckZpbHRlcjsKICB9CiAgZnVuY3Rpb24gZ2VuZXJhdGVNaXBtYXAodGFyZ2V0KSB7CiAgICBfZ2wuZ2VuZXJhdGVNaXBtYXAodGFyZ2V0KTsKICB9CiAgZnVuY3Rpb24gZ2V0SW50ZXJuYWxGb3JtYXQoaW50ZXJuYWxGb3JtYXROYW1lLCBnbEZvcm1hdCwgZ2xUeXBlLCBlbmNvZGluZywgaXNWaWRlb1RleHR1cmUgPSBmYWxzZSkgewogICAgaWYgKGlzV2ViR0wyID09PSBmYWxzZSkKICAgICAgcmV0dXJuIGdsRm9ybWF0OwogICAgaWYgKGludGVybmFsRm9ybWF0TmFtZSAhPT0gbnVsbCkgewogICAgICBpZiAoX2dsW2ludGVybmFsRm9ybWF0TmFtZV0gIT09IHZvaWQgMCkKICAgICAgICByZXR1cm4gX2dsW2ludGVybmFsRm9ybWF0TmFtZV07CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogQXR0ZW1wdCB0byB1c2Ugbm9uLWV4aXN0aW5nIFdlYkdMIGludGVybmFsIGZvcm1hdCAnIiArIGludGVybmFsRm9ybWF0TmFtZSArICInIik7CiAgICB9CiAgICBsZXQgaW50ZXJuYWxGb3JtYXQgPSBnbEZvcm1hdDsKICAgIGlmIChnbEZvcm1hdCA9PT0gNjQwMykgewogICAgICBpZiAoZ2xUeXBlID09PSA1MTI2KQogICAgICAgIGludGVybmFsRm9ybWF0ID0gMzMzMjY7CiAgICAgIGlmIChnbFR5cGUgPT09IDUxMzEpCiAgICAgICAgaW50ZXJuYWxGb3JtYXQgPSAzMzMyNTsKICAgICAgaWYgKGdsVHlwZSA9PT0gNTEyMSkKICAgICAgICBpbnRlcm5hbEZvcm1hdCA9IDMzMzIxOwogICAgfQogICAgaWYgKGdsRm9ybWF0ID09PSAzMzMxOSkgewogICAgICBpZiAoZ2xUeXBlID09PSA1MTI2KQogICAgICAgIGludGVybmFsRm9ybWF0ID0gMzMzMjg7CiAgICAgIGlmIChnbFR5cGUgPT09IDUxMzEpCiAgICAgICAgaW50ZXJuYWxGb3JtYXQgPSAzMzMyNzsKICAgICAgaWYgKGdsVHlwZSA9PT0gNTEyMSkKICAgICAgICBpbnRlcm5hbEZvcm1hdCA9IDMzMzIzOwogICAgfQogICAgaWYgKGdsRm9ybWF0ID09PSA2NDA4KSB7CiAgICAgIGlmIChnbFR5cGUgPT09IDUxMjYpCiAgICAgICAgaW50ZXJuYWxGb3JtYXQgPSAzNDgzNjsKICAgICAgaWYgKGdsVHlwZSA9PT0gNTEzMSkKICAgICAgICBpbnRlcm5hbEZvcm1hdCA9IDM0ODQyOwogICAgICBpZiAoZ2xUeXBlID09PSA1MTIxKQogICAgICAgIGludGVybmFsRm9ybWF0ID0gZW5jb2RpbmcgPT09IHNSR0JFbmNvZGluZyAmJiBpc1ZpZGVvVGV4dHVyZSA9PT0gZmFsc2UgPyAzNTkwNyA6IDMyODU2OwogICAgICBpZiAoZ2xUeXBlID09PSAzMjgxOSkKICAgICAgICBpbnRlcm5hbEZvcm1hdCA9IDMyODU0OwogICAgICBpZiAoZ2xUeXBlID09PSAzMjgyMCkKICAgICAgICBpbnRlcm5hbEZvcm1hdCA9IDMyODU1OwogICAgfQogICAgaWYgKGludGVybmFsRm9ybWF0ID09PSAzMzMyNSB8fCBpbnRlcm5hbEZvcm1hdCA9PT0gMzMzMjYgfHwgaW50ZXJuYWxGb3JtYXQgPT09IDMzMzI3IHx8IGludGVybmFsRm9ybWF0ID09PSAzMzMyOCB8fCBpbnRlcm5hbEZvcm1hdCA9PT0gMzQ4NDIgfHwgaW50ZXJuYWxGb3JtYXQgPT09IDM0ODM2KSB7CiAgICAgIGV4dGVuc2lvbnMuZ2V0KCJFWFRfY29sb3JfYnVmZmVyX2Zsb2F0Iik7CiAgICB9CiAgICByZXR1cm4gaW50ZXJuYWxGb3JtYXQ7CiAgfQogIGZ1bmN0aW9uIGdldE1pcExldmVscyh0ZXh0dXJlLCBpbWFnZSwgc3VwcG9ydHNNaXBzKSB7CiAgICBpZiAodGV4dHVyZU5lZWRzR2VuZXJhdGVNaXBtYXBzKHRleHR1cmUsIHN1cHBvcnRzTWlwcykgPT09IHRydWUgfHwgdGV4dHVyZS5pc0ZyYW1lYnVmZmVyVGV4dHVyZSAmJiB0ZXh0dXJlLm1pbkZpbHRlciAhPT0gTmVhcmVzdEZpbHRlciAmJiB0ZXh0dXJlLm1pbkZpbHRlciAhPT0gTGluZWFyRmlsdGVyKSB7CiAgICAgIHJldHVybiBNYXRoLmxvZzIoTWF0aC5tYXgoaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCkpICsgMTsKICAgIH0gZWxzZSBpZiAodGV4dHVyZS5taXBtYXBzICE9PSB2b2lkIDAgJiYgdGV4dHVyZS5taXBtYXBzLmxlbmd0aCA+IDApIHsKICAgICAgcmV0dXJuIHRleHR1cmUubWlwbWFwcy5sZW5ndGg7CiAgICB9IGVsc2UgaWYgKHRleHR1cmUuaXNDb21wcmVzc2VkVGV4dHVyZSAmJiBBcnJheS5pc0FycmF5KHRleHR1cmUuaW1hZ2UpKSB7CiAgICAgIHJldHVybiBpbWFnZS5taXBtYXBzLmxlbmd0aDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiAxOwogICAgfQogIH0KICBmdW5jdGlvbiBmaWx0ZXJGYWxsYmFjayhmKSB7CiAgICBpZiAoZiA9PT0gTmVhcmVzdEZpbHRlciB8fCBmID09PSBOZWFyZXN0TWlwbWFwTmVhcmVzdEZpbHRlciB8fCBmID09PSBOZWFyZXN0TWlwbWFwTGluZWFyRmlsdGVyKSB7CiAgICAgIHJldHVybiA5NzI4OwogICAgfQogICAgcmV0dXJuIDk3Mjk7CiAgfQogIGZ1bmN0aW9uIG9uVGV4dHVyZURpc3Bvc2UoZXZlbnQpIHsKICAgIGNvbnN0IHRleHR1cmUgPSBldmVudC50YXJnZXQ7CiAgICB0ZXh0dXJlLnJlbW92ZUV2ZW50TGlzdGVuZXIoImRpc3Bvc2UiLCBvblRleHR1cmVEaXNwb3NlKTsKICAgIGRlYWxsb2NhdGVUZXh0dXJlKHRleHR1cmUpOwogICAgaWYgKHRleHR1cmUuaXNWaWRlb1RleHR1cmUpIHsKICAgICAgX3ZpZGVvVGV4dHVyZXMuZGVsZXRlKHRleHR1cmUpOwogICAgfQogICAgaW5mby5tZW1vcnkudGV4dHVyZXMtLTsKICB9CiAgZnVuY3Rpb24gb25SZW5kZXJUYXJnZXREaXNwb3NlKGV2ZW50KSB7CiAgICBjb25zdCByZW5kZXJUYXJnZXQgPSBldmVudC50YXJnZXQ7CiAgICByZW5kZXJUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZGlzcG9zZSIsIG9uUmVuZGVyVGFyZ2V0RGlzcG9zZSk7CiAgICBkZWFsbG9jYXRlUmVuZGVyVGFyZ2V0KHJlbmRlclRhcmdldCk7CiAgfQogIGZ1bmN0aW9uIGRlYWxsb2NhdGVUZXh0dXJlKHRleHR1cmUpIHsKICAgIGNvbnN0IHRleHR1cmVQcm9wZXJ0aWVzID0gcHJvcGVydGllcy5nZXQodGV4dHVyZSk7CiAgICBpZiAodGV4dHVyZVByb3BlcnRpZXMuX193ZWJnbEluaXQgPT09IHZvaWQgMCkKICAgICAgcmV0dXJuOwogICAgX2dsLmRlbGV0ZVRleHR1cmUodGV4dHVyZVByb3BlcnRpZXMuX193ZWJnbFRleHR1cmUpOwogICAgcHJvcGVydGllcy5yZW1vdmUodGV4dHVyZSk7CiAgfQogIGZ1bmN0aW9uIGRlYWxsb2NhdGVSZW5kZXJUYXJnZXQocmVuZGVyVGFyZ2V0KSB7CiAgICBjb25zdCB0ZXh0dXJlID0gcmVuZGVyVGFyZ2V0LnRleHR1cmU7CiAgICBjb25zdCByZW5kZXJUYXJnZXRQcm9wZXJ0aWVzID0gcHJvcGVydGllcy5nZXQocmVuZGVyVGFyZ2V0KTsKICAgIGNvbnN0IHRleHR1cmVQcm9wZXJ0aWVzID0gcHJvcGVydGllcy5nZXQodGV4dHVyZSk7CiAgICBpZiAoIXJlbmRlclRhcmdldCkKICAgICAgcmV0dXJuOwogICAgaWYgKHRleHR1cmVQcm9wZXJ0aWVzLl9fd2ViZ2xUZXh0dXJlICE9PSB2b2lkIDApIHsKICAgICAgX2dsLmRlbGV0ZVRleHR1cmUodGV4dHVyZVByb3BlcnRpZXMuX193ZWJnbFRleHR1cmUpOwogICAgICBpbmZvLm1lbW9yeS50ZXh0dXJlcy0tOwogICAgfQogICAgaWYgKHJlbmRlclRhcmdldC5kZXB0aFRleHR1cmUpIHsKICAgICAgcmVuZGVyVGFyZ2V0LmRlcHRoVGV4dHVyZS5kaXNwb3NlKCk7CiAgICB9CiAgICBpZiAocmVuZGVyVGFyZ2V0LmlzV2ViR0xDdWJlUmVuZGVyVGFyZ2V0KSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNjsgaSsrKSB7CiAgICAgICAgX2dsLmRlbGV0ZUZyYW1lYnVmZmVyKHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbEZyYW1lYnVmZmVyW2ldKTsKICAgICAgICBpZiAocmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX3dlYmdsRGVwdGhidWZmZXIpCiAgICAgICAgICBfZ2wuZGVsZXRlUmVuZGVyYnVmZmVyKHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbERlcHRoYnVmZmVyW2ldKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgX2dsLmRlbGV0ZUZyYW1lYnVmZmVyKHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbEZyYW1lYnVmZmVyKTsKICAgICAgaWYgKHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbERlcHRoYnVmZmVyKQogICAgICAgIF9nbC5kZWxldGVSZW5kZXJidWZmZXIocmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX3dlYmdsRGVwdGhidWZmZXIpOwogICAgICBpZiAocmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX3dlYmdsTXVsdGlzYW1wbGVkRnJhbWVidWZmZXIpCiAgICAgICAgX2dsLmRlbGV0ZUZyYW1lYnVmZmVyKHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbE11bHRpc2FtcGxlZEZyYW1lYnVmZmVyKTsKICAgICAgaWYgKHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbENvbG9yUmVuZGVyYnVmZmVyKQogICAgICAgIF9nbC5kZWxldGVSZW5kZXJidWZmZXIocmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX3dlYmdsQ29sb3JSZW5kZXJidWZmZXIpOwogICAgICBpZiAocmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX3dlYmdsRGVwdGhSZW5kZXJidWZmZXIpCiAgICAgICAgX2dsLmRlbGV0ZVJlbmRlcmJ1ZmZlcihyZW5kZXJUYXJnZXRQcm9wZXJ0aWVzLl9fd2ViZ2xEZXB0aFJlbmRlcmJ1ZmZlcik7CiAgICB9CiAgICBpZiAocmVuZGVyVGFyZ2V0LmlzV2ViR0xNdWx0aXBsZVJlbmRlclRhcmdldHMpIHsKICAgICAgZm9yIChsZXQgaSA9IDAsIGlsID0gdGV4dHVyZS5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgICAgY29uc3QgYXR0YWNobWVudFByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzLmdldCh0ZXh0dXJlW2ldKTsKICAgICAgICBpZiAoYXR0YWNobWVudFByb3BlcnRpZXMuX193ZWJnbFRleHR1cmUpIHsKICAgICAgICAgIF9nbC5kZWxldGVUZXh0dXJlKGF0dGFjaG1lbnRQcm9wZXJ0aWVzLl9fd2ViZ2xUZXh0dXJlKTsKICAgICAgICAgIGluZm8ubWVtb3J5LnRleHR1cmVzLS07CiAgICAgICAgfQogICAgICAgIHByb3BlcnRpZXMucmVtb3ZlKHRleHR1cmVbaV0pOwogICAgICB9CiAgICB9CiAgICBwcm9wZXJ0aWVzLnJlbW92ZSh0ZXh0dXJlKTsKICAgIHByb3BlcnRpZXMucmVtb3ZlKHJlbmRlclRhcmdldCk7CiAgfQogIGxldCB0ZXh0dXJlVW5pdHMgPSAwOwogIGZ1bmN0aW9uIHJlc2V0VGV4dHVyZVVuaXRzKCkgewogICAgdGV4dHVyZVVuaXRzID0gMDsKICB9CiAgZnVuY3Rpb24gYWxsb2NhdGVUZXh0dXJlVW5pdCgpIHsKICAgIGNvbnN0IHRleHR1cmVVbml0ID0gdGV4dHVyZVVuaXRzOwogICAgaWYgKHRleHR1cmVVbml0ID49IG1heFRleHR1cmVzKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xUZXh0dXJlczogVHJ5aW5nIHRvIHVzZSAiICsgdGV4dHVyZVVuaXQgKyAiIHRleHR1cmUgdW5pdHMgd2hpbGUgdGhpcyBHUFUgc3VwcG9ydHMgb25seSAiICsgbWF4VGV4dHVyZXMpOwogICAgfQogICAgdGV4dHVyZVVuaXRzICs9IDE7CiAgICByZXR1cm4gdGV4dHVyZVVuaXQ7CiAgfQogIGZ1bmN0aW9uIHNldFRleHR1cmUyRCh0ZXh0dXJlLCBzbG90KSB7CiAgICBjb25zdCB0ZXh0dXJlUHJvcGVydGllcyA9IHByb3BlcnRpZXMuZ2V0KHRleHR1cmUpOwogICAgaWYgKHRleHR1cmUuaXNWaWRlb1RleHR1cmUpCiAgICAgIHVwZGF0ZVZpZGVvVGV4dHVyZSh0ZXh0dXJlKTsKICAgIGlmICh0ZXh0dXJlLnZlcnNpb24gPiAwICYmIHRleHR1cmVQcm9wZXJ0aWVzLl9fdmVyc2lvbiAhPT0gdGV4dHVyZS52ZXJzaW9uKSB7CiAgICAgIGNvbnN0IGltYWdlID0gdGV4dHVyZS5pbWFnZTsKICAgICAgaWYgKGltYWdlID09PSB2b2lkIDApIHsKICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IFRleHR1cmUgbWFya2VkIGZvciB1cGRhdGUgYnV0IGltYWdlIGlzIHVuZGVmaW5lZCIpOwogICAgICB9IGVsc2UgaWYgKGltYWdlLmNvbXBsZXRlID09PSBmYWxzZSkgewogICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogVGV4dHVyZSBtYXJrZWQgZm9yIHVwZGF0ZSBidXQgaW1hZ2UgaXMgaW5jb21wbGV0ZSIpOwogICAgICB9IGVsc2UgewogICAgICAgIHVwbG9hZFRleHR1cmUodGV4dHVyZVByb3BlcnRpZXMsIHRleHR1cmUsIHNsb3QpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfQogICAgc3RhdGUuYWN0aXZlVGV4dHVyZSgzMzk4NCArIHNsb3QpOwogICAgc3RhdGUuYmluZFRleHR1cmUoMzU1MywgdGV4dHVyZVByb3BlcnRpZXMuX193ZWJnbFRleHR1cmUpOwogIH0KICBmdW5jdGlvbiBzZXRUZXh0dXJlMkRBcnJheSh0ZXh0dXJlLCBzbG90KSB7CiAgICBjb25zdCB0ZXh0dXJlUHJvcGVydGllcyA9IHByb3BlcnRpZXMuZ2V0KHRleHR1cmUpOwogICAgaWYgKHRleHR1cmUudmVyc2lvbiA+IDAgJiYgdGV4dHVyZVByb3BlcnRpZXMuX192ZXJzaW9uICE9PSB0ZXh0dXJlLnZlcnNpb24pIHsKICAgICAgdXBsb2FkVGV4dHVyZSh0ZXh0dXJlUHJvcGVydGllcywgdGV4dHVyZSwgc2xvdCk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHN0YXRlLmFjdGl2ZVRleHR1cmUoMzM5ODQgKyBzbG90KTsKICAgIHN0YXRlLmJpbmRUZXh0dXJlKDM1ODY2LCB0ZXh0dXJlUHJvcGVydGllcy5fX3dlYmdsVGV4dHVyZSk7CiAgfQogIGZ1bmN0aW9uIHNldFRleHR1cmUzRCh0ZXh0dXJlLCBzbG90KSB7CiAgICBjb25zdCB0ZXh0dXJlUHJvcGVydGllcyA9IHByb3BlcnRpZXMuZ2V0KHRleHR1cmUpOwogICAgaWYgKHRleHR1cmUudmVyc2lvbiA+IDAgJiYgdGV4dHVyZVByb3BlcnRpZXMuX192ZXJzaW9uICE9PSB0ZXh0dXJlLnZlcnNpb24pIHsKICAgICAgdXBsb2FkVGV4dHVyZSh0ZXh0dXJlUHJvcGVydGllcywgdGV4dHVyZSwgc2xvdCk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHN0YXRlLmFjdGl2ZVRleHR1cmUoMzM5ODQgKyBzbG90KTsKICAgIHN0YXRlLmJpbmRUZXh0dXJlKDMyODc5LCB0ZXh0dXJlUHJvcGVydGllcy5fX3dlYmdsVGV4dHVyZSk7CiAgfQogIGZ1bmN0aW9uIHNldFRleHR1cmVDdWJlKHRleHR1cmUsIHNsb3QpIHsKICAgIGNvbnN0IHRleHR1cmVQcm9wZXJ0aWVzID0gcHJvcGVydGllcy5nZXQodGV4dHVyZSk7CiAgICBpZiAodGV4dHVyZS52ZXJzaW9uID4gMCAmJiB0ZXh0dXJlUHJvcGVydGllcy5fX3ZlcnNpb24gIT09IHRleHR1cmUudmVyc2lvbikgewogICAgICB1cGxvYWRDdWJlVGV4dHVyZSh0ZXh0dXJlUHJvcGVydGllcywgdGV4dHVyZSwgc2xvdCk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHN0YXRlLmFjdGl2ZVRleHR1cmUoMzM5ODQgKyBzbG90KTsKICAgIHN0YXRlLmJpbmRUZXh0dXJlKDM0MDY3LCB0ZXh0dXJlUHJvcGVydGllcy5fX3dlYmdsVGV4dHVyZSk7CiAgfQogIGNvbnN0IHdyYXBwaW5nVG9HTCA9IHsKICAgIFtSZXBlYXRXcmFwcGluZ106IDEwNDk3LAogICAgW0NsYW1wVG9FZGdlV3JhcHBpbmddOiAzMzA3MSwKICAgIFtNaXJyb3JlZFJlcGVhdFdyYXBwaW5nXTogMzM2NDgKICB9OwogIGNvbnN0IGZpbHRlclRvR0wgPSB7CiAgICBbTmVhcmVzdEZpbHRlcl06IDk3MjgsCiAgICBbTmVhcmVzdE1pcG1hcE5lYXJlc3RGaWx0ZXJdOiA5OTg0LAogICAgW05lYXJlc3RNaXBtYXBMaW5lYXJGaWx0ZXJdOiA5OTg2LAogICAgW0xpbmVhckZpbHRlcl06IDk3MjksCiAgICBbTGluZWFyTWlwbWFwTmVhcmVzdEZpbHRlcl06IDk5ODUsCiAgICBbTGluZWFyTWlwbWFwTGluZWFyRmlsdGVyXTogOTk4NwogIH07CiAgZnVuY3Rpb24gc2V0VGV4dHVyZVBhcmFtZXRlcnModGV4dHVyZVR5cGUsIHRleHR1cmUsIHN1cHBvcnRzTWlwcykgewogICAgaWYgKHN1cHBvcnRzTWlwcykgewogICAgICBfZ2wudGV4UGFyYW1ldGVyaSh0ZXh0dXJlVHlwZSwgMTAyNDIsIHdyYXBwaW5nVG9HTFt0ZXh0dXJlLndyYXBTXSk7CiAgICAgIF9nbC50ZXhQYXJhbWV0ZXJpKHRleHR1cmVUeXBlLCAxMDI0Mywgd3JhcHBpbmdUb0dMW3RleHR1cmUud3JhcFRdKTsKICAgICAgaWYgKHRleHR1cmVUeXBlID09PSAzMjg3OSB8fCB0ZXh0dXJlVHlwZSA9PT0gMzU4NjYpIHsKICAgICAgICBfZ2wudGV4UGFyYW1ldGVyaSh0ZXh0dXJlVHlwZSwgMzI4ODIsIHdyYXBwaW5nVG9HTFt0ZXh0dXJlLndyYXBSXSk7CiAgICAgIH0KICAgICAgX2dsLnRleFBhcmFtZXRlcmkodGV4dHVyZVR5cGUsIDEwMjQwLCBmaWx0ZXJUb0dMW3RleHR1cmUubWFnRmlsdGVyXSk7CiAgICAgIF9nbC50ZXhQYXJhbWV0ZXJpKHRleHR1cmVUeXBlLCAxMDI0MSwgZmlsdGVyVG9HTFt0ZXh0dXJlLm1pbkZpbHRlcl0pOwogICAgfSBlbHNlIHsKICAgICAgX2dsLnRleFBhcmFtZXRlcmkodGV4dHVyZVR5cGUsIDEwMjQyLCAzMzA3MSk7CiAgICAgIF9nbC50ZXhQYXJhbWV0ZXJpKHRleHR1cmVUeXBlLCAxMDI0MywgMzMwNzEpOwogICAgICBpZiAodGV4dHVyZVR5cGUgPT09IDMyODc5IHx8IHRleHR1cmVUeXBlID09PSAzNTg2NikgewogICAgICAgIF9nbC50ZXhQYXJhbWV0ZXJpKHRleHR1cmVUeXBlLCAzMjg4MiwgMzMwNzEpOwogICAgICB9CiAgICAgIGlmICh0ZXh0dXJlLndyYXBTICE9PSBDbGFtcFRvRWRnZVdyYXBwaW5nIHx8IHRleHR1cmUud3JhcFQgIT09IENsYW1wVG9FZGdlV3JhcHBpbmcpIHsKICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IFRleHR1cmUgaXMgbm90IHBvd2VyIG9mIHR3by4gVGV4dHVyZS53cmFwUyBhbmQgVGV4dHVyZS53cmFwVCBzaG91bGQgYmUgc2V0IHRvIFRIUkVFLkNsYW1wVG9FZGdlV3JhcHBpbmcuIik7CiAgICAgIH0KICAgICAgX2dsLnRleFBhcmFtZXRlcmkodGV4dHVyZVR5cGUsIDEwMjQwLCBmaWx0ZXJGYWxsYmFjayh0ZXh0dXJlLm1hZ0ZpbHRlcikpOwogICAgICBfZ2wudGV4UGFyYW1ldGVyaSh0ZXh0dXJlVHlwZSwgMTAyNDEsIGZpbHRlckZhbGxiYWNrKHRleHR1cmUubWluRmlsdGVyKSk7CiAgICAgIGlmICh0ZXh0dXJlLm1pbkZpbHRlciAhPT0gTmVhcmVzdEZpbHRlciAmJiB0ZXh0dXJlLm1pbkZpbHRlciAhPT0gTGluZWFyRmlsdGVyKSB7CiAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiBUZXh0dXJlIGlzIG5vdCBwb3dlciBvZiB0d28uIFRleHR1cmUubWluRmlsdGVyIHNob3VsZCBiZSBzZXQgdG8gVEhSRUUuTmVhcmVzdEZpbHRlciBvciBUSFJFRS5MaW5lYXJGaWx0ZXIuIik7CiAgICAgIH0KICAgIH0KICAgIGlmIChleHRlbnNpb25zLmhhcygiRVhUX3RleHR1cmVfZmlsdGVyX2FuaXNvdHJvcGljIikgPT09IHRydWUpIHsKICAgICAgY29uc3QgZXh0ZW5zaW9uID0gZXh0ZW5zaW9ucy5nZXQoIkVYVF90ZXh0dXJlX2ZpbHRlcl9hbmlzb3Ryb3BpYyIpOwogICAgICBpZiAodGV4dHVyZS50eXBlID09PSBGbG9hdFR5cGUgJiYgZXh0ZW5zaW9ucy5oYXMoIk9FU190ZXh0dXJlX2Zsb2F0X2xpbmVhciIpID09PSBmYWxzZSkKICAgICAgICByZXR1cm47CiAgICAgIGlmIChpc1dlYkdMMiA9PT0gZmFsc2UgJiYgKHRleHR1cmUudHlwZSA9PT0gSGFsZkZsb2F0VHlwZSAmJiBleHRlbnNpb25zLmhhcygiT0VTX3RleHR1cmVfaGFsZl9mbG9hdF9saW5lYXIiKSA9PT0gZmFsc2UpKQogICAgICAgIHJldHVybjsKICAgICAgaWYgKHRleHR1cmUuYW5pc290cm9weSA+IDEgfHwgcHJvcGVydGllcy5nZXQodGV4dHVyZSkuX19jdXJyZW50QW5pc290cm9weSkgewogICAgICAgIF9nbC50ZXhQYXJhbWV0ZXJmKHRleHR1cmVUeXBlLCBleHRlbnNpb24uVEVYVFVSRV9NQVhfQU5JU09UUk9QWV9FWFQsIE1hdGgubWluKHRleHR1cmUuYW5pc290cm9weSwgY2FwYWJpbGl0aWVzLmdldE1heEFuaXNvdHJvcHkoKSkpOwogICAgICAgIHByb3BlcnRpZXMuZ2V0KHRleHR1cmUpLl9fY3VycmVudEFuaXNvdHJvcHkgPSB0ZXh0dXJlLmFuaXNvdHJvcHk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gaW5pdFRleHR1cmUodGV4dHVyZVByb3BlcnRpZXMsIHRleHR1cmUpIHsKICAgIGlmICh0ZXh0dXJlUHJvcGVydGllcy5fX3dlYmdsSW5pdCA9PT0gdm9pZCAwKSB7CiAgICAgIHRleHR1cmVQcm9wZXJ0aWVzLl9fd2ViZ2xJbml0ID0gdHJ1ZTsKICAgICAgdGV4dHVyZS5hZGRFdmVudExpc3RlbmVyKCJkaXNwb3NlIiwgb25UZXh0dXJlRGlzcG9zZSk7CiAgICAgIHRleHR1cmVQcm9wZXJ0aWVzLl9fd2ViZ2xUZXh0dXJlID0gX2dsLmNyZWF0ZVRleHR1cmUoKTsKICAgICAgaW5mby5tZW1vcnkudGV4dHVyZXMrKzsKICAgIH0KICB9CiAgZnVuY3Rpb24gdXBsb2FkVGV4dHVyZSh0ZXh0dXJlUHJvcGVydGllcywgdGV4dHVyZSwgc2xvdCkgewogICAgbGV0IHRleHR1cmVUeXBlID0gMzU1MzsKICAgIGlmICh0ZXh0dXJlLmlzRGF0YVRleHR1cmUyREFycmF5KQogICAgICB0ZXh0dXJlVHlwZSA9IDM1ODY2OwogICAgaWYgKHRleHR1cmUuaXNEYXRhVGV4dHVyZTNEKQogICAgICB0ZXh0dXJlVHlwZSA9IDMyODc5OwogICAgaW5pdFRleHR1cmUodGV4dHVyZVByb3BlcnRpZXMsIHRleHR1cmUpOwogICAgc3RhdGUuYWN0aXZlVGV4dHVyZSgzMzk4NCArIHNsb3QpOwogICAgc3RhdGUuYmluZFRleHR1cmUodGV4dHVyZVR5cGUsIHRleHR1cmVQcm9wZXJ0aWVzLl9fd2ViZ2xUZXh0dXJlKTsKICAgIF9nbC5waXhlbFN0b3JlaSgzNzQ0MCwgdGV4dHVyZS5mbGlwWSk7CiAgICBfZ2wucGl4ZWxTdG9yZWkoMzc0NDEsIHRleHR1cmUucHJlbXVsdGlwbHlBbHBoYSk7CiAgICBfZ2wucGl4ZWxTdG9yZWkoMzMxNywgdGV4dHVyZS51bnBhY2tBbGlnbm1lbnQpOwogICAgX2dsLnBpeGVsU3RvcmVpKDM3NDQzLCAwKTsKICAgIGNvbnN0IG5lZWRzUG93ZXJPZlR3byA9IHRleHR1cmVOZWVkc1Bvd2VyT2ZUd28odGV4dHVyZSkgJiYgaXNQb3dlck9mVHdvJDEodGV4dHVyZS5pbWFnZSkgPT09IGZhbHNlOwogICAgbGV0IGltYWdlID0gcmVzaXplSW1hZ2UodGV4dHVyZS5pbWFnZSwgbmVlZHNQb3dlck9mVHdvLCBmYWxzZSwgbWF4VGV4dHVyZVNpemUpOwogICAgaW1hZ2UgPSB2ZXJpZnlDb2xvclNwYWNlKHRleHR1cmUsIGltYWdlKTsKICAgIGNvbnN0IHN1cHBvcnRzTWlwcyA9IGlzUG93ZXJPZlR3byQxKGltYWdlKSB8fCBpc1dlYkdMMiwgZ2xGb3JtYXQgPSB1dGlscy5jb252ZXJ0KHRleHR1cmUuZm9ybWF0LCB0ZXh0dXJlLmVuY29kaW5nKTsKICAgIGxldCBnbFR5cGUgPSB1dGlscy5jb252ZXJ0KHRleHR1cmUudHlwZSksIGdsSW50ZXJuYWxGb3JtYXQgPSBnZXRJbnRlcm5hbEZvcm1hdCh0ZXh0dXJlLmludGVybmFsRm9ybWF0LCBnbEZvcm1hdCwgZ2xUeXBlLCB0ZXh0dXJlLmVuY29kaW5nLCB0ZXh0dXJlLmlzVmlkZW9UZXh0dXJlKTsKICAgIHNldFRleHR1cmVQYXJhbWV0ZXJzKHRleHR1cmVUeXBlLCB0ZXh0dXJlLCBzdXBwb3J0c01pcHMpOwogICAgbGV0IG1pcG1hcDsKICAgIGNvbnN0IG1pcG1hcHMgPSB0ZXh0dXJlLm1pcG1hcHM7CiAgICBjb25zdCB1c2VUZXhTdG9yYWdlID0gaXNXZWJHTDIgJiYgdGV4dHVyZS5pc1ZpZGVvVGV4dHVyZSAhPT0gdHJ1ZTsKICAgIGNvbnN0IGFsbG9jYXRlTWVtb3J5ID0gdGV4dHVyZVByb3BlcnRpZXMuX192ZXJzaW9uID09PSB2b2lkIDA7CiAgICBjb25zdCBsZXZlbHMgPSBnZXRNaXBMZXZlbHModGV4dHVyZSwgaW1hZ2UsIHN1cHBvcnRzTWlwcyk7CiAgICBpZiAodGV4dHVyZS5pc0RlcHRoVGV4dHVyZSkgewogICAgICBnbEludGVybmFsRm9ybWF0ID0gNjQwMjsKICAgICAgaWYgKGlzV2ViR0wyKSB7CiAgICAgICAgaWYgKHRleHR1cmUudHlwZSA9PT0gRmxvYXRUeXBlKSB7CiAgICAgICAgICBnbEludGVybmFsRm9ybWF0ID0gMzYwMTI7CiAgICAgICAgfSBlbHNlIGlmICh0ZXh0dXJlLnR5cGUgPT09IFVuc2lnbmVkSW50VHlwZSkgewogICAgICAgICAgZ2xJbnRlcm5hbEZvcm1hdCA9IDMzMTkwOwogICAgICAgIH0gZWxzZSBpZiAodGV4dHVyZS50eXBlID09PSBVbnNpZ25lZEludDI0OFR5cGUpIHsKICAgICAgICAgIGdsSW50ZXJuYWxGb3JtYXQgPSAzNTA1NjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZ2xJbnRlcm5hbEZvcm1hdCA9IDMzMTg5OwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGV4dHVyZS50eXBlID09PSBGbG9hdFR5cGUpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIldlYkdMUmVuZGVyZXI6IEZsb2F0aW5nIHBvaW50IGRlcHRoIHRleHR1cmUgcmVxdWlyZXMgV2ViR0wyLiIpOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodGV4dHVyZS5mb3JtYXQgPT09IERlcHRoRm9ybWF0ICYmIGdsSW50ZXJuYWxGb3JtYXQgPT09IDY0MDIpIHsKICAgICAgICBpZiAodGV4dHVyZS50eXBlICE9PSBVbnNpZ25lZFNob3J0VHlwZSAmJiB0ZXh0dXJlLnR5cGUgIT09IFVuc2lnbmVkSW50VHlwZSkgewogICAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiBVc2UgVW5zaWduZWRTaG9ydFR5cGUgb3IgVW5zaWduZWRJbnRUeXBlIGZvciBEZXB0aEZvcm1hdCBEZXB0aFRleHR1cmUuIik7CiAgICAgICAgICB0ZXh0dXJlLnR5cGUgPSBVbnNpZ25lZFNob3J0VHlwZTsKICAgICAgICAgIGdsVHlwZSA9IHV0aWxzLmNvbnZlcnQodGV4dHVyZS50eXBlKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHRleHR1cmUuZm9ybWF0ID09PSBEZXB0aFN0ZW5jaWxGb3JtYXQgJiYgZ2xJbnRlcm5hbEZvcm1hdCA9PT0gNjQwMikgewogICAgICAgIGdsSW50ZXJuYWxGb3JtYXQgPSAzNDA0MTsKICAgICAgICBpZiAodGV4dHVyZS50eXBlICE9PSBVbnNpZ25lZEludDI0OFR5cGUpIHsKICAgICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogVXNlIFVuc2lnbmVkSW50MjQ4VHlwZSBmb3IgRGVwdGhTdGVuY2lsRm9ybWF0IERlcHRoVGV4dHVyZS4iKTsKICAgICAgICAgIHRleHR1cmUudHlwZSA9IFVuc2lnbmVkSW50MjQ4VHlwZTsKICAgICAgICAgIGdsVHlwZSA9IHV0aWxzLmNvbnZlcnQodGV4dHVyZS50eXBlKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHVzZVRleFN0b3JhZ2UgJiYgYWxsb2NhdGVNZW1vcnkpIHsKICAgICAgICBzdGF0ZS50ZXhTdG9yYWdlMkQoMzU1MywgMSwgZ2xJbnRlcm5hbEZvcm1hdCwgaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3RhdGUudGV4SW1hZ2UyRCgzNTUzLCAwLCBnbEludGVybmFsRm9ybWF0LCBpbWFnZS53aWR0aCwgaW1hZ2UuaGVpZ2h0LCAwLCBnbEZvcm1hdCwgZ2xUeXBlLCBudWxsKTsKICAgICAgfQogICAgfSBlbHNlIGlmICh0ZXh0dXJlLmlzRGF0YVRleHR1cmUpIHsKICAgICAgaWYgKG1pcG1hcHMubGVuZ3RoID4gMCAmJiBzdXBwb3J0c01pcHMpIHsKICAgICAgICBpZiAodXNlVGV4U3RvcmFnZSAmJiBhbGxvY2F0ZU1lbW9yeSkgewogICAgICAgICAgc3RhdGUudGV4U3RvcmFnZTJEKDM1NTMsIGxldmVscywgZ2xJbnRlcm5hbEZvcm1hdCwgbWlwbWFwc1swXS53aWR0aCwgbWlwbWFwc1swXS5oZWlnaHQpOwogICAgICAgIH0KICAgICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBtaXBtYXBzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHsKICAgICAgICAgIG1pcG1hcCA9IG1pcG1hcHNbaV07CiAgICAgICAgICBpZiAodXNlVGV4U3RvcmFnZSkgewogICAgICAgICAgICBzdGF0ZS50ZXhTdWJJbWFnZTJEKDM1NTMsIDAsIDAsIDAsIG1pcG1hcC53aWR0aCwgbWlwbWFwLmhlaWdodCwgZ2xGb3JtYXQsIGdsVHlwZSwgbWlwbWFwLmRhdGEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RhdGUudGV4SW1hZ2UyRCgzNTUzLCBpLCBnbEludGVybmFsRm9ybWF0LCBtaXBtYXAud2lkdGgsIG1pcG1hcC5oZWlnaHQsIDAsIGdsRm9ybWF0LCBnbFR5cGUsIG1pcG1hcC5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGV4dHVyZS5nZW5lcmF0ZU1pcG1hcHMgPSBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodXNlVGV4U3RvcmFnZSkgewogICAgICAgICAgaWYgKGFsbG9jYXRlTWVtb3J5KSB7CiAgICAgICAgICAgIHN0YXRlLnRleFN0b3JhZ2UyRCgzNTUzLCBsZXZlbHMsIGdsSW50ZXJuYWxGb3JtYXQsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQpOwogICAgICAgICAgfQogICAgICAgICAgc3RhdGUudGV4U3ViSW1hZ2UyRCgzNTUzLCAwLCAwLCAwLCBpbWFnZS53aWR0aCwgaW1hZ2UuaGVpZ2h0LCBnbEZvcm1hdCwgZ2xUeXBlLCBpbWFnZS5kYXRhKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3RhdGUudGV4SW1hZ2UyRCgzNTUzLCAwLCBnbEludGVybmFsRm9ybWF0LCBpbWFnZS53aWR0aCwgaW1hZ2UuaGVpZ2h0LCAwLCBnbEZvcm1hdCwgZ2xUeXBlLCBpbWFnZS5kYXRhKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodGV4dHVyZS5pc0NvbXByZXNzZWRUZXh0dXJlKSB7CiAgICAgIGlmICh1c2VUZXhTdG9yYWdlICYmIGFsbG9jYXRlTWVtb3J5KSB7CiAgICAgICAgc3RhdGUudGV4U3RvcmFnZTJEKDM1NTMsIGxldmVscywgZ2xJbnRlcm5hbEZvcm1hdCwgbWlwbWFwc1swXS53aWR0aCwgbWlwbWFwc1swXS5oZWlnaHQpOwogICAgICB9CiAgICAgIGZvciAobGV0IGkgPSAwLCBpbCA9IG1pcG1hcHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICAgIG1pcG1hcCA9IG1pcG1hcHNbaV07CiAgICAgICAgaWYgKHRleHR1cmUuZm9ybWF0ICE9PSBSR0JBRm9ybWF0KSB7CiAgICAgICAgICBpZiAoZ2xGb3JtYXQgIT09IG51bGwpIHsKICAgICAgICAgICAgaWYgKHVzZVRleFN0b3JhZ2UpIHsKICAgICAgICAgICAgICBzdGF0ZS5jb21wcmVzc2VkVGV4U3ViSW1hZ2UyRCgzNTUzLCBpLCAwLCAwLCBtaXBtYXAud2lkdGgsIG1pcG1hcC5oZWlnaHQsIGdsRm9ybWF0LCBtaXBtYXAuZGF0YSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgc3RhdGUuY29tcHJlc3NlZFRleEltYWdlMkQoMzU1MywgaSwgZ2xJbnRlcm5hbEZvcm1hdCwgbWlwbWFwLndpZHRoLCBtaXBtYXAuaGVpZ2h0LCAwLCBtaXBtYXAuZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogQXR0ZW1wdCB0byBsb2FkIHVuc3VwcG9ydGVkIGNvbXByZXNzZWQgdGV4dHVyZSBmb3JtYXQgaW4gLnVwbG9hZFRleHR1cmUoKSIpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAodXNlVGV4U3RvcmFnZSkgewogICAgICAgICAgICBzdGF0ZS50ZXhTdWJJbWFnZTJEKDM1NTMsIGksIDAsIDAsIG1pcG1hcC53aWR0aCwgbWlwbWFwLmhlaWdodCwgZ2xGb3JtYXQsIGdsVHlwZSwgbWlwbWFwLmRhdGEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RhdGUudGV4SW1hZ2UyRCgzNTUzLCBpLCBnbEludGVybmFsRm9ybWF0LCBtaXBtYXAud2lkdGgsIG1pcG1hcC5oZWlnaHQsIDAsIGdsRm9ybWF0LCBnbFR5cGUsIG1pcG1hcC5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodGV4dHVyZS5pc0RhdGFUZXh0dXJlMkRBcnJheSkgewogICAgICBpZiAodXNlVGV4U3RvcmFnZSkgewogICAgICAgIGlmIChhbGxvY2F0ZU1lbW9yeSkgewogICAgICAgICAgc3RhdGUudGV4U3RvcmFnZTNEKDM1ODY2LCBsZXZlbHMsIGdsSW50ZXJuYWxGb3JtYXQsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQsIGltYWdlLmRlcHRoKTsKICAgICAgICB9CiAgICAgICAgc3RhdGUudGV4U3ViSW1hZ2UzRCgzNTg2NiwgMCwgMCwgMCwgMCwgaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCwgaW1hZ2UuZGVwdGgsIGdsRm9ybWF0LCBnbFR5cGUsIGltYWdlLmRhdGEpOwogICAgICB9IGVsc2UgewogICAgICAgIHN0YXRlLnRleEltYWdlM0QoMzU4NjYsIDAsIGdsSW50ZXJuYWxGb3JtYXQsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQsIGltYWdlLmRlcHRoLCAwLCBnbEZvcm1hdCwgZ2xUeXBlLCBpbWFnZS5kYXRhKTsKICAgICAgfQogICAgfSBlbHNlIGlmICh0ZXh0dXJlLmlzRGF0YVRleHR1cmUzRCkgewogICAgICBpZiAodXNlVGV4U3RvcmFnZSkgewogICAgICAgIGlmIChhbGxvY2F0ZU1lbW9yeSkgewogICAgICAgICAgc3RhdGUudGV4U3RvcmFnZTNEKDMyODc5LCBsZXZlbHMsIGdsSW50ZXJuYWxGb3JtYXQsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQsIGltYWdlLmRlcHRoKTsKICAgICAgICB9CiAgICAgICAgc3RhdGUudGV4U3ViSW1hZ2UzRCgzMjg3OSwgMCwgMCwgMCwgMCwgaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCwgaW1hZ2UuZGVwdGgsIGdsRm9ybWF0LCBnbFR5cGUsIGltYWdlLmRhdGEpOwogICAgICB9IGVsc2UgewogICAgICAgIHN0YXRlLnRleEltYWdlM0QoMzI4NzksIDAsIGdsSW50ZXJuYWxGb3JtYXQsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQsIGltYWdlLmRlcHRoLCAwLCBnbEZvcm1hdCwgZ2xUeXBlLCBpbWFnZS5kYXRhKTsKICAgICAgfQogICAgfSBlbHNlIGlmICh0ZXh0dXJlLmlzRnJhbWVidWZmZXJUZXh0dXJlKSB7CiAgICAgIGlmICh1c2VUZXhTdG9yYWdlICYmIGFsbG9jYXRlTWVtb3J5KSB7CiAgICAgICAgc3RhdGUudGV4U3RvcmFnZTJEKDM1NTMsIGxldmVscywgZ2xJbnRlcm5hbEZvcm1hdCwgaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3RhdGUudGV4SW1hZ2UyRCgzNTUzLCAwLCBnbEludGVybmFsRm9ybWF0LCBpbWFnZS53aWR0aCwgaW1hZ2UuaGVpZ2h0LCAwLCBnbEZvcm1hdCwgZ2xUeXBlLCBudWxsKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKG1pcG1hcHMubGVuZ3RoID4gMCAmJiBzdXBwb3J0c01pcHMpIHsKICAgICAgICBpZiAodXNlVGV4U3RvcmFnZSAmJiBhbGxvY2F0ZU1lbW9yeSkgewogICAgICAgICAgc3RhdGUudGV4U3RvcmFnZTJEKDM1NTMsIGxldmVscywgZ2xJbnRlcm5hbEZvcm1hdCwgbWlwbWFwc1swXS53aWR0aCwgbWlwbWFwc1swXS5oZWlnaHQpOwogICAgICAgIH0KICAgICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBtaXBtYXBzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHsKICAgICAgICAgIG1pcG1hcCA9IG1pcG1hcHNbaV07CiAgICAgICAgICBpZiAodXNlVGV4U3RvcmFnZSkgewogICAgICAgICAgICBzdGF0ZS50ZXhTdWJJbWFnZTJEKDM1NTMsIGksIDAsIDAsIGdsRm9ybWF0LCBnbFR5cGUsIG1pcG1hcCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdGF0ZS50ZXhJbWFnZTJEKDM1NTMsIGksIGdsSW50ZXJuYWxGb3JtYXQsIGdsRm9ybWF0LCBnbFR5cGUsIG1pcG1hcCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRleHR1cmUuZ2VuZXJhdGVNaXBtYXBzID0gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHVzZVRleFN0b3JhZ2UpIHsKICAgICAgICAgIGlmIChhbGxvY2F0ZU1lbW9yeSkgewogICAgICAgICAgICBzdGF0ZS50ZXhTdG9yYWdlMkQoMzU1MywgbGV2ZWxzLCBnbEludGVybmFsRm9ybWF0LCBpbWFnZS53aWR0aCwgaW1hZ2UuaGVpZ2h0KTsKICAgICAgICAgIH0KICAgICAgICAgIHN0YXRlLnRleFN1YkltYWdlMkQoMzU1MywgMCwgMCwgMCwgZ2xGb3JtYXQsIGdsVHlwZSwgaW1hZ2UpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdGF0ZS50ZXhJbWFnZTJEKDM1NTMsIDAsIGdsSW50ZXJuYWxGb3JtYXQsIGdsRm9ybWF0LCBnbFR5cGUsIGltYWdlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGlmICh0ZXh0dXJlTmVlZHNHZW5lcmF0ZU1pcG1hcHModGV4dHVyZSwgc3VwcG9ydHNNaXBzKSkgewogICAgICBnZW5lcmF0ZU1pcG1hcCh0ZXh0dXJlVHlwZSk7CiAgICB9CiAgICB0ZXh0dXJlUHJvcGVydGllcy5fX3ZlcnNpb24gPSB0ZXh0dXJlLnZlcnNpb247CiAgICBpZiAodGV4dHVyZS5vblVwZGF0ZSkKICAgICAgdGV4dHVyZS5vblVwZGF0ZSh0ZXh0dXJlKTsKICB9CiAgZnVuY3Rpb24gdXBsb2FkQ3ViZVRleHR1cmUodGV4dHVyZVByb3BlcnRpZXMsIHRleHR1cmUsIHNsb3QpIHsKICAgIGlmICh0ZXh0dXJlLmltYWdlLmxlbmd0aCAhPT0gNikKICAgICAgcmV0dXJuOwogICAgaW5pdFRleHR1cmUodGV4dHVyZVByb3BlcnRpZXMsIHRleHR1cmUpOwogICAgc3RhdGUuYWN0aXZlVGV4dHVyZSgzMzk4NCArIHNsb3QpOwogICAgc3RhdGUuYmluZFRleHR1cmUoMzQwNjcsIHRleHR1cmVQcm9wZXJ0aWVzLl9fd2ViZ2xUZXh0dXJlKTsKICAgIF9nbC5waXhlbFN0b3JlaSgzNzQ0MCwgdGV4dHVyZS5mbGlwWSk7CiAgICBfZ2wucGl4ZWxTdG9yZWkoMzc0NDEsIHRleHR1cmUucHJlbXVsdGlwbHlBbHBoYSk7CiAgICBfZ2wucGl4ZWxTdG9yZWkoMzMxNywgdGV4dHVyZS51bnBhY2tBbGlnbm1lbnQpOwogICAgX2dsLnBpeGVsU3RvcmVpKDM3NDQzLCAwKTsKICAgIGNvbnN0IGlzQ29tcHJlc3NlZCA9IHRleHR1cmUgJiYgKHRleHR1cmUuaXNDb21wcmVzc2VkVGV4dHVyZSB8fCB0ZXh0dXJlLmltYWdlWzBdLmlzQ29tcHJlc3NlZFRleHR1cmUpOwogICAgY29uc3QgaXNEYXRhVGV4dHVyZSA9IHRleHR1cmUuaW1hZ2VbMF0gJiYgdGV4dHVyZS5pbWFnZVswXS5pc0RhdGFUZXh0dXJlOwogICAgY29uc3QgY3ViZUltYWdlID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY7IGkrKykgewogICAgICBpZiAoIWlzQ29tcHJlc3NlZCAmJiAhaXNEYXRhVGV4dHVyZSkgewogICAgICAgIGN1YmVJbWFnZVtpXSA9IHJlc2l6ZUltYWdlKHRleHR1cmUuaW1hZ2VbaV0sIGZhbHNlLCB0cnVlLCBtYXhDdWJlbWFwU2l6ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY3ViZUltYWdlW2ldID0gaXNEYXRhVGV4dHVyZSA/IHRleHR1cmUuaW1hZ2VbaV0uaW1hZ2UgOiB0ZXh0dXJlLmltYWdlW2ldOwogICAgICB9CiAgICAgIGN1YmVJbWFnZVtpXSA9IHZlcmlmeUNvbG9yU3BhY2UodGV4dHVyZSwgY3ViZUltYWdlW2ldKTsKICAgIH0KICAgIGNvbnN0IGltYWdlID0gY3ViZUltYWdlWzBdLCBzdXBwb3J0c01pcHMgPSBpc1Bvd2VyT2ZUd28kMShpbWFnZSkgfHwgaXNXZWJHTDIsIGdsRm9ybWF0ID0gdXRpbHMuY29udmVydCh0ZXh0dXJlLmZvcm1hdCwgdGV4dHVyZS5lbmNvZGluZyksIGdsVHlwZSA9IHV0aWxzLmNvbnZlcnQodGV4dHVyZS50eXBlKSwgZ2xJbnRlcm5hbEZvcm1hdCA9IGdldEludGVybmFsRm9ybWF0KHRleHR1cmUuaW50ZXJuYWxGb3JtYXQsIGdsRm9ybWF0LCBnbFR5cGUsIHRleHR1cmUuZW5jb2RpbmcpOwogICAgY29uc3QgdXNlVGV4U3RvcmFnZSA9IGlzV2ViR0wyICYmIHRleHR1cmUuaXNWaWRlb1RleHR1cmUgIT09IHRydWU7CiAgICBjb25zdCBhbGxvY2F0ZU1lbW9yeSA9IHRleHR1cmVQcm9wZXJ0aWVzLl9fdmVyc2lvbiA9PT0gdm9pZCAwOwogICAgbGV0IGxldmVscyA9IGdldE1pcExldmVscyh0ZXh0dXJlLCBpbWFnZSwgc3VwcG9ydHNNaXBzKTsKICAgIHNldFRleHR1cmVQYXJhbWV0ZXJzKDM0MDY3LCB0ZXh0dXJlLCBzdXBwb3J0c01pcHMpOwogICAgbGV0IG1pcG1hcHM7CiAgICBpZiAoaXNDb21wcmVzc2VkKSB7CiAgICAgIGlmICh1c2VUZXhTdG9yYWdlICYmIGFsbG9jYXRlTWVtb3J5KSB7CiAgICAgICAgc3RhdGUudGV4U3RvcmFnZTJEKDM0MDY3LCBsZXZlbHMsIGdsSW50ZXJuYWxGb3JtYXQsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQpOwogICAgICB9CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNjsgaSsrKSB7CiAgICAgICAgbWlwbWFwcyA9IGN1YmVJbWFnZVtpXS5taXBtYXBzOwogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbWlwbWFwcy5sZW5ndGg7IGorKykgewogICAgICAgICAgY29uc3QgbWlwbWFwID0gbWlwbWFwc1tqXTsKICAgICAgICAgIGlmICh0ZXh0dXJlLmZvcm1hdCAhPT0gUkdCQUZvcm1hdCkgewogICAgICAgICAgICBpZiAoZ2xGb3JtYXQgIT09IG51bGwpIHsKICAgICAgICAgICAgICBpZiAodXNlVGV4U3RvcmFnZSkgewogICAgICAgICAgICAgICAgc3RhdGUuY29tcHJlc3NlZFRleFN1YkltYWdlMkQoMzQwNjkgKyBpLCBqLCAwLCAwLCBtaXBtYXAud2lkdGgsIG1pcG1hcC5oZWlnaHQsIGdsRm9ybWF0LCBtaXBtYXAuZGF0YSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHN0YXRlLmNvbXByZXNzZWRUZXhJbWFnZTJEKDM0MDY5ICsgaSwgaiwgZ2xJbnRlcm5hbEZvcm1hdCwgbWlwbWFwLndpZHRoLCBtaXBtYXAuaGVpZ2h0LCAwLCBtaXBtYXAuZGF0YSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogQXR0ZW1wdCB0byBsb2FkIHVuc3VwcG9ydGVkIGNvbXByZXNzZWQgdGV4dHVyZSBmb3JtYXQgaW4gLnNldFRleHR1cmVDdWJlKCkiKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKHVzZVRleFN0b3JhZ2UpIHsKICAgICAgICAgICAgICBzdGF0ZS50ZXhTdWJJbWFnZTJEKDM0MDY5ICsgaSwgaiwgMCwgMCwgbWlwbWFwLndpZHRoLCBtaXBtYXAuaGVpZ2h0LCBnbEZvcm1hdCwgZ2xUeXBlLCBtaXBtYXAuZGF0YSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgc3RhdGUudGV4SW1hZ2UyRCgzNDA2OSArIGksIGosIGdsSW50ZXJuYWxGb3JtYXQsIG1pcG1hcC53aWR0aCwgbWlwbWFwLmhlaWdodCwgMCwgZ2xGb3JtYXQsIGdsVHlwZSwgbWlwbWFwLmRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICBtaXBtYXBzID0gdGV4dHVyZS5taXBtYXBzOwogICAgICBpZiAodXNlVGV4U3RvcmFnZSAmJiBhbGxvY2F0ZU1lbW9yeSkgewogICAgICAgIGlmIChtaXBtYXBzLmxlbmd0aCA+IDApCiAgICAgICAgICBsZXZlbHMrKzsKICAgICAgICBzdGF0ZS50ZXhTdG9yYWdlMkQoMzQwNjcsIGxldmVscywgZ2xJbnRlcm5hbEZvcm1hdCwgY3ViZUltYWdlWzBdLndpZHRoLCBjdWJlSW1hZ2VbMF0uaGVpZ2h0KTsKICAgICAgfQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY7IGkrKykgewogICAgICAgIGlmIChpc0RhdGFUZXh0dXJlKSB7CiAgICAgICAgICBpZiAodXNlVGV4U3RvcmFnZSkgewogICAgICAgICAgICBzdGF0ZS50ZXhTdWJJbWFnZTJEKDM0MDY5ICsgaSwgMCwgMCwgMCwgY3ViZUltYWdlW2ldLndpZHRoLCBjdWJlSW1hZ2VbaV0uaGVpZ2h0LCBnbEZvcm1hdCwgZ2xUeXBlLCBjdWJlSW1hZ2VbaV0uZGF0YSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdGF0ZS50ZXhJbWFnZTJEKDM0MDY5ICsgaSwgMCwgZ2xJbnRlcm5hbEZvcm1hdCwgY3ViZUltYWdlW2ldLndpZHRoLCBjdWJlSW1hZ2VbaV0uaGVpZ2h0LCAwLCBnbEZvcm1hdCwgZ2xUeXBlLCBjdWJlSW1hZ2VbaV0uZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IG1pcG1hcHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgY29uc3QgbWlwbWFwID0gbWlwbWFwc1tqXTsKICAgICAgICAgICAgY29uc3QgbWlwbWFwSW1hZ2UgPSBtaXBtYXAuaW1hZ2VbaV0uaW1hZ2U7CiAgICAgICAgICAgIGlmICh1c2VUZXhTdG9yYWdlKSB7CiAgICAgICAgICAgICAgc3RhdGUudGV4U3ViSW1hZ2UyRCgzNDA2OSArIGksIGogKyAxLCAwLCAwLCBtaXBtYXBJbWFnZS53aWR0aCwgbWlwbWFwSW1hZ2UuaGVpZ2h0LCBnbEZvcm1hdCwgZ2xUeXBlLCBtaXBtYXBJbWFnZS5kYXRhKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzdGF0ZS50ZXhJbWFnZTJEKDM0MDY5ICsgaSwgaiArIDEsIGdsSW50ZXJuYWxGb3JtYXQsIG1pcG1hcEltYWdlLndpZHRoLCBtaXBtYXBJbWFnZS5oZWlnaHQsIDAsIGdsRm9ybWF0LCBnbFR5cGUsIG1pcG1hcEltYWdlLmRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICh1c2VUZXhTdG9yYWdlKSB7CiAgICAgICAgICAgIHN0YXRlLnRleFN1YkltYWdlMkQoMzQwNjkgKyBpLCAwLCAwLCAwLCBnbEZvcm1hdCwgZ2xUeXBlLCBjdWJlSW1hZ2VbaV0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RhdGUudGV4SW1hZ2UyRCgzNDA2OSArIGksIDAsIGdsSW50ZXJuYWxGb3JtYXQsIGdsRm9ybWF0LCBnbFR5cGUsIGN1YmVJbWFnZVtpXSk7CiAgICAgICAgICB9CiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IG1pcG1hcHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgY29uc3QgbWlwbWFwID0gbWlwbWFwc1tqXTsKICAgICAgICAgICAgaWYgKHVzZVRleFN0b3JhZ2UpIHsKICAgICAgICAgICAgICBzdGF0ZS50ZXhTdWJJbWFnZTJEKDM0MDY5ICsgaSwgaiArIDEsIDAsIDAsIGdsRm9ybWF0LCBnbFR5cGUsIG1pcG1hcC5pbWFnZVtpXSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgc3RhdGUudGV4SW1hZ2UyRCgzNDA2OSArIGksIGogKyAxLCBnbEludGVybmFsRm9ybWF0LCBnbEZvcm1hdCwgZ2xUeXBlLCBtaXBtYXAuaW1hZ2VbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAodGV4dHVyZU5lZWRzR2VuZXJhdGVNaXBtYXBzKHRleHR1cmUsIHN1cHBvcnRzTWlwcykpIHsKICAgICAgZ2VuZXJhdGVNaXBtYXAoMzQwNjcpOwogICAgfQogICAgdGV4dHVyZVByb3BlcnRpZXMuX192ZXJzaW9uID0gdGV4dHVyZS52ZXJzaW9uOwogICAgaWYgKHRleHR1cmUub25VcGRhdGUpCiAgICAgIHRleHR1cmUub25VcGRhdGUodGV4dHVyZSk7CiAgfQogIGZ1bmN0aW9uIHNldHVwRnJhbWVCdWZmZXJUZXh0dXJlKGZyYW1lYnVmZmVyLCByZW5kZXJUYXJnZXQsIHRleHR1cmUsIGF0dGFjaG1lbnQsIHRleHR1cmVUYXJnZXQpIHsKICAgIGNvbnN0IGdsRm9ybWF0ID0gdXRpbHMuY29udmVydCh0ZXh0dXJlLmZvcm1hdCwgdGV4dHVyZS5lbmNvZGluZyk7CiAgICBjb25zdCBnbFR5cGUgPSB1dGlscy5jb252ZXJ0KHRleHR1cmUudHlwZSk7CiAgICBjb25zdCBnbEludGVybmFsRm9ybWF0ID0gZ2V0SW50ZXJuYWxGb3JtYXQodGV4dHVyZS5pbnRlcm5hbEZvcm1hdCwgZ2xGb3JtYXQsIGdsVHlwZSwgdGV4dHVyZS5lbmNvZGluZyk7CiAgICBjb25zdCByZW5kZXJUYXJnZXRQcm9wZXJ0aWVzID0gcHJvcGVydGllcy5nZXQocmVuZGVyVGFyZ2V0KTsKICAgIGlmICghcmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX2hhc0V4dGVybmFsVGV4dHVyZXMpIHsKICAgICAgaWYgKHRleHR1cmVUYXJnZXQgPT09IDMyODc5IHx8IHRleHR1cmVUYXJnZXQgPT09IDM1ODY2KSB7CiAgICAgICAgc3RhdGUudGV4SW1hZ2UzRCh0ZXh0dXJlVGFyZ2V0LCAwLCBnbEludGVybmFsRm9ybWF0LCByZW5kZXJUYXJnZXQud2lkdGgsIHJlbmRlclRhcmdldC5oZWlnaHQsIHJlbmRlclRhcmdldC5kZXB0aCwgMCwgZ2xGb3JtYXQsIGdsVHlwZSwgbnVsbCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3RhdGUudGV4SW1hZ2UyRCh0ZXh0dXJlVGFyZ2V0LCAwLCBnbEludGVybmFsRm9ybWF0LCByZW5kZXJUYXJnZXQud2lkdGgsIHJlbmRlclRhcmdldC5oZWlnaHQsIDAsIGdsRm9ybWF0LCBnbFR5cGUsIG51bGwpOwogICAgICB9CiAgICB9CiAgICBzdGF0ZS5iaW5kRnJhbWVidWZmZXIoMzYxNjAsIGZyYW1lYnVmZmVyKTsKICAgIGlmIChyZW5kZXJUYXJnZXQudXNlUmVuZGVyVG9UZXh0dXJlKSB7CiAgICAgIE11bHRpc2FtcGxlZFJlbmRlclRvVGV4dHVyZUV4dGVuc2lvbi5mcmFtZWJ1ZmZlclRleHR1cmUyRE11bHRpc2FtcGxlRVhUKDM2MTYwLCBhdHRhY2htZW50LCB0ZXh0dXJlVGFyZ2V0LCBwcm9wZXJ0aWVzLmdldCh0ZXh0dXJlKS5fX3dlYmdsVGV4dHVyZSwgMCwgZ2V0UmVuZGVyVGFyZ2V0U2FtcGxlcyhyZW5kZXJUYXJnZXQpKTsKICAgIH0gZWxzZSB7CiAgICAgIF9nbC5mcmFtZWJ1ZmZlclRleHR1cmUyRCgzNjE2MCwgYXR0YWNobWVudCwgdGV4dHVyZVRhcmdldCwgcHJvcGVydGllcy5nZXQodGV4dHVyZSkuX193ZWJnbFRleHR1cmUsIDApOwogICAgfQogICAgc3RhdGUuYmluZEZyYW1lYnVmZmVyKDM2MTYwLCBudWxsKTsKICB9CiAgZnVuY3Rpb24gc2V0dXBSZW5kZXJCdWZmZXJTdG9yYWdlKHJlbmRlcmJ1ZmZlciwgcmVuZGVyVGFyZ2V0LCBpc011bHRpc2FtcGxlKSB7CiAgICBfZ2wuYmluZFJlbmRlcmJ1ZmZlcigzNjE2MSwgcmVuZGVyYnVmZmVyKTsKICAgIGlmIChyZW5kZXJUYXJnZXQuZGVwdGhCdWZmZXIgJiYgIXJlbmRlclRhcmdldC5zdGVuY2lsQnVmZmVyKSB7CiAgICAgIGxldCBnbEludGVybmFsRm9ybWF0ID0gMzMxODk7CiAgICAgIGlmIChpc011bHRpc2FtcGxlIHx8IHJlbmRlclRhcmdldC51c2VSZW5kZXJUb1RleHR1cmUpIHsKICAgICAgICBjb25zdCBkZXB0aFRleHR1cmUgPSByZW5kZXJUYXJnZXQuZGVwdGhUZXh0dXJlOwogICAgICAgIGlmIChkZXB0aFRleHR1cmUgJiYgZGVwdGhUZXh0dXJlLmlzRGVwdGhUZXh0dXJlKSB7CiAgICAgICAgICBpZiAoZGVwdGhUZXh0dXJlLnR5cGUgPT09IEZsb2F0VHlwZSkgewogICAgICAgICAgICBnbEludGVybmFsRm9ybWF0ID0gMzYwMTI7CiAgICAgICAgICB9IGVsc2UgaWYgKGRlcHRoVGV4dHVyZS50eXBlID09PSBVbnNpZ25lZEludFR5cGUpIHsKICAgICAgICAgICAgZ2xJbnRlcm5hbEZvcm1hdCA9IDMzMTkwOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb25zdCBzYW1wbGVzID0gZ2V0UmVuZGVyVGFyZ2V0U2FtcGxlcyhyZW5kZXJUYXJnZXQpOwogICAgICAgIGlmIChyZW5kZXJUYXJnZXQudXNlUmVuZGVyVG9UZXh0dXJlKSB7CiAgICAgICAgICBNdWx0aXNhbXBsZWRSZW5kZXJUb1RleHR1cmVFeHRlbnNpb24ucmVuZGVyYnVmZmVyU3RvcmFnZU11bHRpc2FtcGxlRVhUKDM2MTYxLCBzYW1wbGVzLCBnbEludGVybmFsRm9ybWF0LCByZW5kZXJUYXJnZXQud2lkdGgsIHJlbmRlclRhcmdldC5oZWlnaHQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfZ2wucmVuZGVyYnVmZmVyU3RvcmFnZU11bHRpc2FtcGxlKDM2MTYxLCBzYW1wbGVzLCBnbEludGVybmFsRm9ybWF0LCByZW5kZXJUYXJnZXQud2lkdGgsIHJlbmRlclRhcmdldC5oZWlnaHQpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBfZ2wucmVuZGVyYnVmZmVyU3RvcmFnZSgzNjE2MSwgZ2xJbnRlcm5hbEZvcm1hdCwgcmVuZGVyVGFyZ2V0LndpZHRoLCByZW5kZXJUYXJnZXQuaGVpZ2h0KTsKICAgICAgfQogICAgICBfZ2wuZnJhbWVidWZmZXJSZW5kZXJidWZmZXIoMzYxNjAsIDM2MDk2LCAzNjE2MSwgcmVuZGVyYnVmZmVyKTsKICAgIH0gZWxzZSBpZiAocmVuZGVyVGFyZ2V0LmRlcHRoQnVmZmVyICYmIHJlbmRlclRhcmdldC5zdGVuY2lsQnVmZmVyKSB7CiAgICAgIGNvbnN0IHNhbXBsZXMgPSBnZXRSZW5kZXJUYXJnZXRTYW1wbGVzKHJlbmRlclRhcmdldCk7CiAgICAgIGlmIChpc011bHRpc2FtcGxlICYmIHJlbmRlclRhcmdldC51c2VSZW5kZXJidWZmZXIpIHsKICAgICAgICBfZ2wucmVuZGVyYnVmZmVyU3RvcmFnZU11bHRpc2FtcGxlKDM2MTYxLCBzYW1wbGVzLCAzNTA1NiwgcmVuZGVyVGFyZ2V0LndpZHRoLCByZW5kZXJUYXJnZXQuaGVpZ2h0KTsKICAgICAgfSBlbHNlIGlmIChyZW5kZXJUYXJnZXQudXNlUmVuZGVyVG9UZXh0dXJlKSB7CiAgICAgICAgTXVsdGlzYW1wbGVkUmVuZGVyVG9UZXh0dXJlRXh0ZW5zaW9uLnJlbmRlcmJ1ZmZlclN0b3JhZ2VNdWx0aXNhbXBsZUVYVCgzNjE2MSwgc2FtcGxlcywgMzUwNTYsIHJlbmRlclRhcmdldC53aWR0aCwgcmVuZGVyVGFyZ2V0LmhlaWdodCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX2dsLnJlbmRlcmJ1ZmZlclN0b3JhZ2UoMzYxNjEsIDM0MDQxLCByZW5kZXJUYXJnZXQud2lkdGgsIHJlbmRlclRhcmdldC5oZWlnaHQpOwogICAgICB9CiAgICAgIF9nbC5mcmFtZWJ1ZmZlclJlbmRlcmJ1ZmZlcigzNjE2MCwgMzMzMDYsIDM2MTYxLCByZW5kZXJidWZmZXIpOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgdGV4dHVyZSA9IHJlbmRlclRhcmdldC5pc1dlYkdMTXVsdGlwbGVSZW5kZXJUYXJnZXRzID09PSB0cnVlID8gcmVuZGVyVGFyZ2V0LnRleHR1cmVbMF0gOiByZW5kZXJUYXJnZXQudGV4dHVyZTsKICAgICAgY29uc3QgZ2xGb3JtYXQgPSB1dGlscy5jb252ZXJ0KHRleHR1cmUuZm9ybWF0LCB0ZXh0dXJlLmVuY29kaW5nKTsKICAgICAgY29uc3QgZ2xUeXBlID0gdXRpbHMuY29udmVydCh0ZXh0dXJlLnR5cGUpOwogICAgICBjb25zdCBnbEludGVybmFsRm9ybWF0ID0gZ2V0SW50ZXJuYWxGb3JtYXQodGV4dHVyZS5pbnRlcm5hbEZvcm1hdCwgZ2xGb3JtYXQsIGdsVHlwZSwgdGV4dHVyZS5lbmNvZGluZyk7CiAgICAgIGNvbnN0IHNhbXBsZXMgPSBnZXRSZW5kZXJUYXJnZXRTYW1wbGVzKHJlbmRlclRhcmdldCk7CiAgICAgIGlmIChpc011bHRpc2FtcGxlICYmIHJlbmRlclRhcmdldC51c2VSZW5kZXJidWZmZXIpIHsKICAgICAgICBfZ2wucmVuZGVyYnVmZmVyU3RvcmFnZU11bHRpc2FtcGxlKDM2MTYxLCBzYW1wbGVzLCBnbEludGVybmFsRm9ybWF0LCByZW5kZXJUYXJnZXQud2lkdGgsIHJlbmRlclRhcmdldC5oZWlnaHQpOwogICAgICB9IGVsc2UgaWYgKHJlbmRlclRhcmdldC51c2VSZW5kZXJUb1RleHR1cmUpIHsKICAgICAgICBNdWx0aXNhbXBsZWRSZW5kZXJUb1RleHR1cmVFeHRlbnNpb24ucmVuZGVyYnVmZmVyU3RvcmFnZU11bHRpc2FtcGxlRVhUKDM2MTYxLCBzYW1wbGVzLCBnbEludGVybmFsRm9ybWF0LCByZW5kZXJUYXJnZXQud2lkdGgsIHJlbmRlclRhcmdldC5oZWlnaHQpOwogICAgICB9IGVsc2UgewogICAgICAgIF9nbC5yZW5kZXJidWZmZXJTdG9yYWdlKDM2MTYxLCBnbEludGVybmFsRm9ybWF0LCByZW5kZXJUYXJnZXQud2lkdGgsIHJlbmRlclRhcmdldC5oZWlnaHQpOwogICAgICB9CiAgICB9CiAgICBfZ2wuYmluZFJlbmRlcmJ1ZmZlcigzNjE2MSwgbnVsbCk7CiAgfQogIGZ1bmN0aW9uIHNldHVwRGVwdGhUZXh0dXJlKGZyYW1lYnVmZmVyLCByZW5kZXJUYXJnZXQpIHsKICAgIGNvbnN0IGlzQ3ViZSA9IHJlbmRlclRhcmdldCAmJiByZW5kZXJUYXJnZXQuaXNXZWJHTEN1YmVSZW5kZXJUYXJnZXQ7CiAgICBpZiAoaXNDdWJlKQogICAgICB0aHJvdyBuZXcgRXJyb3IoIkRlcHRoIFRleHR1cmUgd2l0aCBjdWJlIHJlbmRlciB0YXJnZXRzIGlzIG5vdCBzdXBwb3J0ZWQiKTsKICAgIHN0YXRlLmJpbmRGcmFtZWJ1ZmZlcigzNjE2MCwgZnJhbWVidWZmZXIpOwogICAgaWYgKCEocmVuZGVyVGFyZ2V0LmRlcHRoVGV4dHVyZSAmJiByZW5kZXJUYXJnZXQuZGVwdGhUZXh0dXJlLmlzRGVwdGhUZXh0dXJlKSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoInJlbmRlclRhcmdldC5kZXB0aFRleHR1cmUgbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiBUSFJFRS5EZXB0aFRleHR1cmUiKTsKICAgIH0KICAgIGlmICghcHJvcGVydGllcy5nZXQocmVuZGVyVGFyZ2V0LmRlcHRoVGV4dHVyZSkuX193ZWJnbFRleHR1cmUgfHwgcmVuZGVyVGFyZ2V0LmRlcHRoVGV4dHVyZS5pbWFnZS53aWR0aCAhPT0gcmVuZGVyVGFyZ2V0LndpZHRoIHx8IHJlbmRlclRhcmdldC5kZXB0aFRleHR1cmUuaW1hZ2UuaGVpZ2h0ICE9PSByZW5kZXJUYXJnZXQuaGVpZ2h0KSB7CiAgICAgIHJlbmRlclRhcmdldC5kZXB0aFRleHR1cmUuaW1hZ2Uud2lkdGggPSByZW5kZXJUYXJnZXQud2lkdGg7CiAgICAgIHJlbmRlclRhcmdldC5kZXB0aFRleHR1cmUuaW1hZ2UuaGVpZ2h0ID0gcmVuZGVyVGFyZ2V0LmhlaWdodDsKICAgICAgcmVuZGVyVGFyZ2V0LmRlcHRoVGV4dHVyZS5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICB9CiAgICBzZXRUZXh0dXJlMkQocmVuZGVyVGFyZ2V0LmRlcHRoVGV4dHVyZSwgMCk7CiAgICBjb25zdCB3ZWJnbERlcHRoVGV4dHVyZSA9IHByb3BlcnRpZXMuZ2V0KHJlbmRlclRhcmdldC5kZXB0aFRleHR1cmUpLl9fd2ViZ2xUZXh0dXJlOwogICAgY29uc3Qgc2FtcGxlcyA9IGdldFJlbmRlclRhcmdldFNhbXBsZXMocmVuZGVyVGFyZ2V0KTsKICAgIGlmIChyZW5kZXJUYXJnZXQuZGVwdGhUZXh0dXJlLmZvcm1hdCA9PT0gRGVwdGhGb3JtYXQpIHsKICAgICAgaWYgKHJlbmRlclRhcmdldC51c2VSZW5kZXJUb1RleHR1cmUpIHsKICAgICAgICBNdWx0aXNhbXBsZWRSZW5kZXJUb1RleHR1cmVFeHRlbnNpb24uZnJhbWVidWZmZXJUZXh0dXJlMkRNdWx0aXNhbXBsZUVYVCgzNjE2MCwgMzYwOTYsIDM1NTMsIHdlYmdsRGVwdGhUZXh0dXJlLCAwLCBzYW1wbGVzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfZ2wuZnJhbWVidWZmZXJUZXh0dXJlMkQoMzYxNjAsIDM2MDk2LCAzNTUzLCB3ZWJnbERlcHRoVGV4dHVyZSwgMCk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAocmVuZGVyVGFyZ2V0LmRlcHRoVGV4dHVyZS5mb3JtYXQgPT09IERlcHRoU3RlbmNpbEZvcm1hdCkgewogICAgICBpZiAocmVuZGVyVGFyZ2V0LnVzZVJlbmRlclRvVGV4dHVyZSkgewogICAgICAgIE11bHRpc2FtcGxlZFJlbmRlclRvVGV4dHVyZUV4dGVuc2lvbi5mcmFtZWJ1ZmZlclRleHR1cmUyRE11bHRpc2FtcGxlRVhUKDM2MTYwLCAzMzMwNiwgMzU1Mywgd2ViZ2xEZXB0aFRleHR1cmUsIDAsIHNhbXBsZXMpOwogICAgICB9IGVsc2UgewogICAgICAgIF9nbC5mcmFtZWJ1ZmZlclRleHR1cmUyRCgzNjE2MCwgMzMzMDYsIDM1NTMsIHdlYmdsRGVwdGhUZXh0dXJlLCAwKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmtub3duIGRlcHRoVGV4dHVyZSBmb3JtYXQiKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gc2V0dXBEZXB0aFJlbmRlcmJ1ZmZlcihyZW5kZXJUYXJnZXQpIHsKICAgIGNvbnN0IHJlbmRlclRhcmdldFByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzLmdldChyZW5kZXJUYXJnZXQpOwogICAgY29uc3QgaXNDdWJlID0gcmVuZGVyVGFyZ2V0LmlzV2ViR0xDdWJlUmVuZGVyVGFyZ2V0ID09PSB0cnVlOwogICAgaWYgKHJlbmRlclRhcmdldC5kZXB0aFRleHR1cmUgJiYgIXJlbmRlclRhcmdldFByb3BlcnRpZXMuX19hdXRvQWxsb2NhdGVEZXB0aEJ1ZmZlcikgewogICAgICBpZiAoaXNDdWJlKQogICAgICAgIHRocm93IG5ldyBFcnJvcigidGFyZ2V0LmRlcHRoVGV4dHVyZSBub3Qgc3VwcG9ydGVkIGluIEN1YmUgcmVuZGVyIHRhcmdldHMiKTsKICAgICAgc2V0dXBEZXB0aFRleHR1cmUocmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX3dlYmdsRnJhbWVidWZmZXIsIHJlbmRlclRhcmdldCk7CiAgICB9IGVsc2UgewogICAgICBpZiAoaXNDdWJlKSB7CiAgICAgICAgcmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX3dlYmdsRGVwdGhidWZmZXIgPSBbXTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY7IGkrKykgewogICAgICAgICAgc3RhdGUuYmluZEZyYW1lYnVmZmVyKDM2MTYwLCByZW5kZXJUYXJnZXRQcm9wZXJ0aWVzLl9fd2ViZ2xGcmFtZWJ1ZmZlcltpXSk7CiAgICAgICAgICByZW5kZXJUYXJnZXRQcm9wZXJ0aWVzLl9fd2ViZ2xEZXB0aGJ1ZmZlcltpXSA9IF9nbC5jcmVhdGVSZW5kZXJidWZmZXIoKTsKICAgICAgICAgIHNldHVwUmVuZGVyQnVmZmVyU3RvcmFnZShyZW5kZXJUYXJnZXRQcm9wZXJ0aWVzLl9fd2ViZ2xEZXB0aGJ1ZmZlcltpXSwgcmVuZGVyVGFyZ2V0LCBmYWxzZSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHN0YXRlLmJpbmRGcmFtZWJ1ZmZlcigzNjE2MCwgcmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX3dlYmdsRnJhbWVidWZmZXIpOwogICAgICAgIHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbERlcHRoYnVmZmVyID0gX2dsLmNyZWF0ZVJlbmRlcmJ1ZmZlcigpOwogICAgICAgIHNldHVwUmVuZGVyQnVmZmVyU3RvcmFnZShyZW5kZXJUYXJnZXRQcm9wZXJ0aWVzLl9fd2ViZ2xEZXB0aGJ1ZmZlciwgcmVuZGVyVGFyZ2V0LCBmYWxzZSk7CiAgICAgIH0KICAgIH0KICAgIHN0YXRlLmJpbmRGcmFtZWJ1ZmZlcigzNjE2MCwgbnVsbCk7CiAgfQogIGZ1bmN0aW9uIHJlYmluZFRleHR1cmVzKHJlbmRlclRhcmdldCwgY29sb3JUZXh0dXJlLCBkZXB0aFRleHR1cmUpIHsKICAgIGNvbnN0IHJlbmRlclRhcmdldFByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzLmdldChyZW5kZXJUYXJnZXQpOwogICAgaWYgKGNvbG9yVGV4dHVyZSAhPT0gdm9pZCAwKSB7CiAgICAgIHNldHVwRnJhbWVCdWZmZXJUZXh0dXJlKHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbEZyYW1lYnVmZmVyLCByZW5kZXJUYXJnZXQsIHJlbmRlclRhcmdldC50ZXh0dXJlLCAzNjA2NCwgMzU1Myk7CiAgICB9CiAgICBpZiAoZGVwdGhUZXh0dXJlICE9PSB2b2lkIDApIHsKICAgICAgc2V0dXBEZXB0aFJlbmRlcmJ1ZmZlcihyZW5kZXJUYXJnZXQpOwogICAgfQogIH0KICBmdW5jdGlvbiBzZXR1cFJlbmRlclRhcmdldChyZW5kZXJUYXJnZXQpIHsKICAgIGNvbnN0IHRleHR1cmUgPSByZW5kZXJUYXJnZXQudGV4dHVyZTsKICAgIGNvbnN0IHJlbmRlclRhcmdldFByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzLmdldChyZW5kZXJUYXJnZXQpOwogICAgY29uc3QgdGV4dHVyZVByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzLmdldCh0ZXh0dXJlKTsKICAgIHJlbmRlclRhcmdldC5hZGRFdmVudExpc3RlbmVyKCJkaXNwb3NlIiwgb25SZW5kZXJUYXJnZXREaXNwb3NlKTsKICAgIGlmIChyZW5kZXJUYXJnZXQuaXNXZWJHTE11bHRpcGxlUmVuZGVyVGFyZ2V0cyAhPT0gdHJ1ZSkgewogICAgICBpZiAodGV4dHVyZVByb3BlcnRpZXMuX193ZWJnbFRleHR1cmUgPT09IHZvaWQgMCkgewogICAgICAgIHRleHR1cmVQcm9wZXJ0aWVzLl9fd2ViZ2xUZXh0dXJlID0gX2dsLmNyZWF0ZVRleHR1cmUoKTsKICAgICAgfQogICAgICB0ZXh0dXJlUHJvcGVydGllcy5fX3ZlcnNpb24gPSB0ZXh0dXJlLnZlcnNpb247CiAgICAgIGluZm8ubWVtb3J5LnRleHR1cmVzKys7CiAgICB9CiAgICBjb25zdCBpc0N1YmUgPSByZW5kZXJUYXJnZXQuaXNXZWJHTEN1YmVSZW5kZXJUYXJnZXQgPT09IHRydWU7CiAgICBjb25zdCBpc011bHRpcGxlUmVuZGVyVGFyZ2V0cyA9IHJlbmRlclRhcmdldC5pc1dlYkdMTXVsdGlwbGVSZW5kZXJUYXJnZXRzID09PSB0cnVlOwogICAgY29uc3QgaXNSZW5kZXJUYXJnZXQzRCA9IHRleHR1cmUuaXNEYXRhVGV4dHVyZTNEIHx8IHRleHR1cmUuaXNEYXRhVGV4dHVyZTJEQXJyYXk7CiAgICBjb25zdCBzdXBwb3J0c01pcHMgPSBpc1Bvd2VyT2ZUd28kMShyZW5kZXJUYXJnZXQpIHx8IGlzV2ViR0wyOwogICAgaWYgKGlzQ3ViZSkgewogICAgICByZW5kZXJUYXJnZXRQcm9wZXJ0aWVzLl9fd2ViZ2xGcmFtZWJ1ZmZlciA9IFtdOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY7IGkrKykgewogICAgICAgIHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbEZyYW1lYnVmZmVyW2ldID0gX2dsLmNyZWF0ZUZyYW1lYnVmZmVyKCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbEZyYW1lYnVmZmVyID0gX2dsLmNyZWF0ZUZyYW1lYnVmZmVyKCk7CiAgICAgIGlmIChpc011bHRpcGxlUmVuZGVyVGFyZ2V0cykgewogICAgICAgIGlmIChjYXBhYmlsaXRpZXMuZHJhd0J1ZmZlcnMpIHsKICAgICAgICAgIGNvbnN0IHRleHR1cmVzID0gcmVuZGVyVGFyZ2V0LnRleHR1cmU7CiAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSB0ZXh0dXJlcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IGF0dGFjaG1lbnRQcm9wZXJ0aWVzID0gcHJvcGVydGllcy5nZXQodGV4dHVyZXNbaV0pOwogICAgICAgICAgICBpZiAoYXR0YWNobWVudFByb3BlcnRpZXMuX193ZWJnbFRleHR1cmUgPT09IHZvaWQgMCkgewogICAgICAgICAgICAgIGF0dGFjaG1lbnRQcm9wZXJ0aWVzLl9fd2ViZ2xUZXh0dXJlID0gX2dsLmNyZWF0ZVRleHR1cmUoKTsKICAgICAgICAgICAgICBpbmZvLm1lbW9yeS50ZXh0dXJlcysrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogV2ViR0xNdWx0aXBsZVJlbmRlclRhcmdldHMgY2FuIG9ubHkgYmUgdXNlZCB3aXRoIFdlYkdMMiBvciBXRUJHTF9kcmF3X2J1ZmZlcnMgZXh0ZW5zaW9uLiIpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChyZW5kZXJUYXJnZXQudXNlUmVuZGVyYnVmZmVyKSB7CiAgICAgICAgaWYgKGlzV2ViR0wyKSB7CiAgICAgICAgICByZW5kZXJUYXJnZXRQcm9wZXJ0aWVzLl9fd2ViZ2xNdWx0aXNhbXBsZWRGcmFtZWJ1ZmZlciA9IF9nbC5jcmVhdGVGcmFtZWJ1ZmZlcigpOwogICAgICAgICAgcmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX3dlYmdsQ29sb3JSZW5kZXJidWZmZXIgPSBfZ2wuY3JlYXRlUmVuZGVyYnVmZmVyKCk7CiAgICAgICAgICBfZ2wuYmluZFJlbmRlcmJ1ZmZlcigzNjE2MSwgcmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX3dlYmdsQ29sb3JSZW5kZXJidWZmZXIpOwogICAgICAgICAgY29uc3QgZ2xGb3JtYXQgPSB1dGlscy5jb252ZXJ0KHRleHR1cmUuZm9ybWF0LCB0ZXh0dXJlLmVuY29kaW5nKTsKICAgICAgICAgIGNvbnN0IGdsVHlwZSA9IHV0aWxzLmNvbnZlcnQodGV4dHVyZS50eXBlKTsKICAgICAgICAgIGNvbnN0IGdsSW50ZXJuYWxGb3JtYXQgPSBnZXRJbnRlcm5hbEZvcm1hdCh0ZXh0dXJlLmludGVybmFsRm9ybWF0LCBnbEZvcm1hdCwgZ2xUeXBlLCB0ZXh0dXJlLmVuY29kaW5nKTsKICAgICAgICAgIGNvbnN0IHNhbXBsZXMgPSBnZXRSZW5kZXJUYXJnZXRTYW1wbGVzKHJlbmRlclRhcmdldCk7CiAgICAgICAgICBfZ2wucmVuZGVyYnVmZmVyU3RvcmFnZU11bHRpc2FtcGxlKDM2MTYxLCBzYW1wbGVzLCBnbEludGVybmFsRm9ybWF0LCByZW5kZXJUYXJnZXQud2lkdGgsIHJlbmRlclRhcmdldC5oZWlnaHQpOwogICAgICAgICAgc3RhdGUuYmluZEZyYW1lYnVmZmVyKDM2MTYwLCByZW5kZXJUYXJnZXRQcm9wZXJ0aWVzLl9fd2ViZ2xNdWx0aXNhbXBsZWRGcmFtZWJ1ZmZlcik7CiAgICAgICAgICBfZ2wuZnJhbWVidWZmZXJSZW5kZXJidWZmZXIoMzYxNjAsIDM2MDY0LCAzNjE2MSwgcmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX3dlYmdsQ29sb3JSZW5kZXJidWZmZXIpOwogICAgICAgICAgX2dsLmJpbmRSZW5kZXJidWZmZXIoMzYxNjEsIG51bGwpOwogICAgICAgICAgaWYgKHJlbmRlclRhcmdldC5kZXB0aEJ1ZmZlcikgewogICAgICAgICAgICByZW5kZXJUYXJnZXRQcm9wZXJ0aWVzLl9fd2ViZ2xEZXB0aFJlbmRlcmJ1ZmZlciA9IF9nbC5jcmVhdGVSZW5kZXJidWZmZXIoKTsKICAgICAgICAgICAgc2V0dXBSZW5kZXJCdWZmZXJTdG9yYWdlKHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbERlcHRoUmVuZGVyYnVmZmVyLCByZW5kZXJUYXJnZXQsIHRydWUpOwogICAgICAgICAgfQogICAgICAgICAgc3RhdGUuYmluZEZyYW1lYnVmZmVyKDM2MTYwLCBudWxsKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiBXZWJHTE11bHRpc2FtcGxlUmVuZGVyVGFyZ2V0IGNhbiBvbmx5IGJlIHVzZWQgd2l0aCBXZWJHTDIuIik7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAoaXNDdWJlKSB7CiAgICAgIHN0YXRlLmJpbmRUZXh0dXJlKDM0MDY3LCB0ZXh0dXJlUHJvcGVydGllcy5fX3dlYmdsVGV4dHVyZSk7CiAgICAgIHNldFRleHR1cmVQYXJhbWV0ZXJzKDM0MDY3LCB0ZXh0dXJlLCBzdXBwb3J0c01pcHMpOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY7IGkrKykgewogICAgICAgIHNldHVwRnJhbWVCdWZmZXJUZXh0dXJlKHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbEZyYW1lYnVmZmVyW2ldLCByZW5kZXJUYXJnZXQsIHRleHR1cmUsIDM2MDY0LCAzNDA2OSArIGkpOwogICAgICB9CiAgICAgIGlmICh0ZXh0dXJlTmVlZHNHZW5lcmF0ZU1pcG1hcHModGV4dHVyZSwgc3VwcG9ydHNNaXBzKSkgewogICAgICAgIGdlbmVyYXRlTWlwbWFwKDM0MDY3KTsKICAgICAgfQogICAgICBzdGF0ZS51bmJpbmRUZXh0dXJlKCk7CiAgICB9IGVsc2UgaWYgKGlzTXVsdGlwbGVSZW5kZXJUYXJnZXRzKSB7CiAgICAgIGNvbnN0IHRleHR1cmVzID0gcmVuZGVyVGFyZ2V0LnRleHR1cmU7CiAgICAgIGZvciAobGV0IGkgPSAwLCBpbCA9IHRleHR1cmVzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHsKICAgICAgICBjb25zdCBhdHRhY2htZW50ID0gdGV4dHVyZXNbaV07CiAgICAgICAgY29uc3QgYXR0YWNobWVudFByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzLmdldChhdHRhY2htZW50KTsKICAgICAgICBzdGF0ZS5iaW5kVGV4dHVyZSgzNTUzLCBhdHRhY2htZW50UHJvcGVydGllcy5fX3dlYmdsVGV4dHVyZSk7CiAgICAgICAgc2V0VGV4dHVyZVBhcmFtZXRlcnMoMzU1MywgYXR0YWNobWVudCwgc3VwcG9ydHNNaXBzKTsKICAgICAgICBzZXR1cEZyYW1lQnVmZmVyVGV4dHVyZShyZW5kZXJUYXJnZXRQcm9wZXJ0aWVzLl9fd2ViZ2xGcmFtZWJ1ZmZlciwgcmVuZGVyVGFyZ2V0LCBhdHRhY2htZW50LCAzNjA2NCArIGksIDM1NTMpOwogICAgICAgIGlmICh0ZXh0dXJlTmVlZHNHZW5lcmF0ZU1pcG1hcHMoYXR0YWNobWVudCwgc3VwcG9ydHNNaXBzKSkgewogICAgICAgICAgZ2VuZXJhdGVNaXBtYXAoMzU1Myk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHN0YXRlLnVuYmluZFRleHR1cmUoKTsKICAgIH0gZWxzZSB7CiAgICAgIGxldCBnbFRleHR1cmVUeXBlID0gMzU1MzsKICAgICAgaWYgKGlzUmVuZGVyVGFyZ2V0M0QpIHsKICAgICAgICBpZiAoaXNXZWJHTDIpIHsKICAgICAgICAgIGNvbnN0IGlzVGV4dHVyZTNEID0gdGV4dHVyZS5pc0RhdGFUZXh0dXJlM0Q7CiAgICAgICAgICBnbFRleHR1cmVUeXBlID0gaXNUZXh0dXJlM0QgPyAzMjg3OSA6IDM1ODY2OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkRhdGFUZXh0dXJlM0QgYW5kIFRIUkVFLkRhdGFUZXh0dXJlMkRBcnJheSBvbmx5IHN1cHBvcnRlZCB3aXRoIFdlYkdMMi4iKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgc3RhdGUuYmluZFRleHR1cmUoZ2xUZXh0dXJlVHlwZSwgdGV4dHVyZVByb3BlcnRpZXMuX193ZWJnbFRleHR1cmUpOwogICAgICBzZXRUZXh0dXJlUGFyYW1ldGVycyhnbFRleHR1cmVUeXBlLCB0ZXh0dXJlLCBzdXBwb3J0c01pcHMpOwogICAgICBzZXR1cEZyYW1lQnVmZmVyVGV4dHVyZShyZW5kZXJUYXJnZXRQcm9wZXJ0aWVzLl9fd2ViZ2xGcmFtZWJ1ZmZlciwgcmVuZGVyVGFyZ2V0LCB0ZXh0dXJlLCAzNjA2NCwgZ2xUZXh0dXJlVHlwZSk7CiAgICAgIGlmICh0ZXh0dXJlTmVlZHNHZW5lcmF0ZU1pcG1hcHModGV4dHVyZSwgc3VwcG9ydHNNaXBzKSkgewogICAgICAgIGdlbmVyYXRlTWlwbWFwKGdsVGV4dHVyZVR5cGUpOwogICAgICB9CiAgICAgIHN0YXRlLnVuYmluZFRleHR1cmUoKTsKICAgIH0KICAgIGlmIChyZW5kZXJUYXJnZXQuZGVwdGhCdWZmZXIpIHsKICAgICAgc2V0dXBEZXB0aFJlbmRlcmJ1ZmZlcihyZW5kZXJUYXJnZXQpOwogICAgfQogIH0KICBmdW5jdGlvbiB1cGRhdGVSZW5kZXJUYXJnZXRNaXBtYXAocmVuZGVyVGFyZ2V0KSB7CiAgICBjb25zdCBzdXBwb3J0c01pcHMgPSBpc1Bvd2VyT2ZUd28kMShyZW5kZXJUYXJnZXQpIHx8IGlzV2ViR0wyOwogICAgY29uc3QgdGV4dHVyZXMgPSByZW5kZXJUYXJnZXQuaXNXZWJHTE11bHRpcGxlUmVuZGVyVGFyZ2V0cyA9PT0gdHJ1ZSA/IHJlbmRlclRhcmdldC50ZXh0dXJlIDogW3JlbmRlclRhcmdldC50ZXh0dXJlXTsKICAgIGZvciAobGV0IGkgPSAwLCBpbCA9IHRleHR1cmVzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHsKICAgICAgY29uc3QgdGV4dHVyZSA9IHRleHR1cmVzW2ldOwogICAgICBpZiAodGV4dHVyZU5lZWRzR2VuZXJhdGVNaXBtYXBzKHRleHR1cmUsIHN1cHBvcnRzTWlwcykpIHsKICAgICAgICBjb25zdCB0YXJnZXQgPSByZW5kZXJUYXJnZXQuaXNXZWJHTEN1YmVSZW5kZXJUYXJnZXQgPyAzNDA2NyA6IDM1NTM7CiAgICAgICAgY29uc3Qgd2ViZ2xUZXh0dXJlID0gcHJvcGVydGllcy5nZXQodGV4dHVyZSkuX193ZWJnbFRleHR1cmU7CiAgICAgICAgc3RhdGUuYmluZFRleHR1cmUodGFyZ2V0LCB3ZWJnbFRleHR1cmUpOwogICAgICAgIGdlbmVyYXRlTWlwbWFwKHRhcmdldCk7CiAgICAgICAgc3RhdGUudW5iaW5kVGV4dHVyZSgpOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIHVwZGF0ZU11bHRpc2FtcGxlUmVuZGVyVGFyZ2V0KHJlbmRlclRhcmdldCkgewogICAgaWYgKHJlbmRlclRhcmdldC51c2VSZW5kZXJidWZmZXIpIHsKICAgICAgaWYgKGlzV2ViR0wyKSB7CiAgICAgICAgY29uc3Qgd2lkdGggPSByZW5kZXJUYXJnZXQud2lkdGg7CiAgICAgICAgY29uc3QgaGVpZ2h0ID0gcmVuZGVyVGFyZ2V0LmhlaWdodDsKICAgICAgICBsZXQgbWFzayA9IDE2Mzg0OwogICAgICAgIGNvbnN0IGludmFsaWRhdGlvbkFycmF5ID0gWzM2MDY0XTsKICAgICAgICBjb25zdCBkZXB0aFN0eWxlID0gcmVuZGVyVGFyZ2V0LnN0ZW5jaWxCdWZmZXIgPyAzMzMwNiA6IDM2MDk2OwogICAgICAgIGlmIChyZW5kZXJUYXJnZXQuZGVwdGhCdWZmZXIpIHsKICAgICAgICAgIGludmFsaWRhdGlvbkFycmF5LnB1c2goZGVwdGhTdHlsZSk7CiAgICAgICAgfQogICAgICAgIGlmICghcmVuZGVyVGFyZ2V0Lmlnbm9yZURlcHRoRm9yTXVsdGlzYW1wbGVDb3B5KSB7CiAgICAgICAgICBpZiAocmVuZGVyVGFyZ2V0LmRlcHRoQnVmZmVyKQogICAgICAgICAgICBtYXNrIHw9IDI1NjsKICAgICAgICAgIGlmIChyZW5kZXJUYXJnZXQuc3RlbmNpbEJ1ZmZlcikKICAgICAgICAgICAgbWFzayB8PSAxMDI0OwogICAgICAgIH0KICAgICAgICBjb25zdCByZW5kZXJUYXJnZXRQcm9wZXJ0aWVzID0gcHJvcGVydGllcy5nZXQocmVuZGVyVGFyZ2V0KTsKICAgICAgICBzdGF0ZS5iaW5kRnJhbWVidWZmZXIoMzYwMDgsIHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbE11bHRpc2FtcGxlZEZyYW1lYnVmZmVyKTsKICAgICAgICBzdGF0ZS5iaW5kRnJhbWVidWZmZXIoMzYwMDksIHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbEZyYW1lYnVmZmVyKTsKICAgICAgICBpZiAocmVuZGVyVGFyZ2V0Lmlnbm9yZURlcHRoRm9yTXVsdGlzYW1wbGVDb3B5KSB7CiAgICAgICAgICBfZ2wuaW52YWxpZGF0ZUZyYW1lYnVmZmVyKDM2MDA4LCBbZGVwdGhTdHlsZV0pOwogICAgICAgICAgX2dsLmludmFsaWRhdGVGcmFtZWJ1ZmZlcigzNjAwOSwgW2RlcHRoU3R5bGVdKTsKICAgICAgICB9CiAgICAgICAgX2dsLmJsaXRGcmFtZWJ1ZmZlcigwLCAwLCB3aWR0aCwgaGVpZ2h0LCAwLCAwLCB3aWR0aCwgaGVpZ2h0LCBtYXNrLCA5NzI4KTsKICAgICAgICBfZ2wuaW52YWxpZGF0ZUZyYW1lYnVmZmVyKDM2MDA4LCBpbnZhbGlkYXRpb25BcnJheSk7CiAgICAgICAgc3RhdGUuYmluZEZyYW1lYnVmZmVyKDM2MDA4LCBudWxsKTsKICAgICAgICBzdGF0ZS5iaW5kRnJhbWVidWZmZXIoMzYwMDksIHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbE11bHRpc2FtcGxlZEZyYW1lYnVmZmVyKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IFdlYkdMTXVsdGlzYW1wbGVSZW5kZXJUYXJnZXQgY2FuIG9ubHkgYmUgdXNlZCB3aXRoIFdlYkdMMi4iKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBnZXRSZW5kZXJUYXJnZXRTYW1wbGVzKHJlbmRlclRhcmdldCkgewogICAgcmV0dXJuIGlzV2ViR0wyICYmIChyZW5kZXJUYXJnZXQudXNlUmVuZGVyYnVmZmVyIHx8IHJlbmRlclRhcmdldC51c2VSZW5kZXJUb1RleHR1cmUpID8gTWF0aC5taW4obWF4U2FtcGxlcywgcmVuZGVyVGFyZ2V0LnNhbXBsZXMpIDogMDsKICB9CiAgZnVuY3Rpb24gdXBkYXRlVmlkZW9UZXh0dXJlKHRleHR1cmUpIHsKICAgIGNvbnN0IGZyYW1lID0gaW5mby5yZW5kZXIuZnJhbWU7CiAgICBpZiAoX3ZpZGVvVGV4dHVyZXMuZ2V0KHRleHR1cmUpICE9PSBmcmFtZSkgewogICAgICBfdmlkZW9UZXh0dXJlcy5zZXQodGV4dHVyZSwgZnJhbWUpOwogICAgICB0ZXh0dXJlLnVwZGF0ZSgpOwogICAgfQogIH0KICBmdW5jdGlvbiB2ZXJpZnlDb2xvclNwYWNlKHRleHR1cmUsIGltYWdlKSB7CiAgICBjb25zdCBlbmNvZGluZyA9IHRleHR1cmUuZW5jb2Rpbmc7CiAgICBjb25zdCBmb3JtYXQgPSB0ZXh0dXJlLmZvcm1hdDsKICAgIGNvbnN0IHR5cGUgPSB0ZXh0dXJlLnR5cGU7CiAgICBpZiAodGV4dHVyZS5pc0NvbXByZXNzZWRUZXh0dXJlID09PSB0cnVlIHx8IHRleHR1cmUuaXNWaWRlb1RleHR1cmUgPT09IHRydWUgfHwgdGV4dHVyZS5mb3JtYXQgPT09IF9TUkdCQUZvcm1hdCkKICAgICAgcmV0dXJuIGltYWdlOwogICAgaWYgKGVuY29kaW5nICE9PSBMaW5lYXJFbmNvZGluZykgewogICAgICBpZiAoZW5jb2RpbmcgPT09IHNSR0JFbmNvZGluZykgewogICAgICAgIGlmIChpc1dlYkdMMiA9PT0gZmFsc2UpIHsKICAgICAgICAgIGlmIChleHRlbnNpb25zLmhhcygiRVhUX3NSR0IiKSA9PT0gdHJ1ZSAmJiBmb3JtYXQgPT09IFJHQkFGb3JtYXQpIHsKICAgICAgICAgICAgdGV4dHVyZS5mb3JtYXQgPSBfU1JHQkFGb3JtYXQ7CiAgICAgICAgICAgIHRleHR1cmUubWluRmlsdGVyID0gTGluZWFyRmlsdGVyOwogICAgICAgICAgICB0ZXh0dXJlLmdlbmVyYXRlTWlwbWFwcyA9IGZhbHNlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaW1hZ2UgPSBJbWFnZVV0aWxzLnNSR0JUb0xpbmVhcihpbWFnZSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChmb3JtYXQgIT09IFJHQkFGb3JtYXQgfHwgdHlwZSAhPT0gVW5zaWduZWRCeXRlVHlwZSkgewogICAgICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMVGV4dHVyZXM6IHNSR0IgZW5jb2RlZCB0ZXh0dXJlcyBoYXZlIHRvIHVzZSBSR0JBRm9ybWF0IGFuZCBVbnNpZ25lZEJ5dGVUeXBlLiIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5XZWJHTFRleHR1cmVzOiBVbnN1cHBvcnRlZCB0ZXh0dXJlIGVuY29kaW5nOiIsIGVuY29kaW5nKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGltYWdlOwogIH0KICBsZXQgd2FybmVkVGV4dHVyZTJEID0gZmFsc2U7CiAgbGV0IHdhcm5lZFRleHR1cmVDdWJlID0gZmFsc2U7CiAgZnVuY3Rpb24gc2FmZVNldFRleHR1cmUyRCh0ZXh0dXJlLCBzbG90KSB7CiAgICBpZiAodGV4dHVyZSAmJiB0ZXh0dXJlLmlzV2ViR0xSZW5kZXJUYXJnZXQpIHsKICAgICAgaWYgKHdhcm5lZFRleHR1cmUyRCA9PT0gZmFsc2UpIHsKICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMVGV4dHVyZXMuc2FmZVNldFRleHR1cmUyRDogZG9uJ3QgdXNlIHJlbmRlciB0YXJnZXRzIGFzIHRleHR1cmVzLiBVc2UgdGhlaXIgLnRleHR1cmUgcHJvcGVydHkgaW5zdGVhZC4iKTsKICAgICAgICB3YXJuZWRUZXh0dXJlMkQgPSB0cnVlOwogICAgICB9CiAgICAgIHRleHR1cmUgPSB0ZXh0dXJlLnRleHR1cmU7CiAgICB9CiAgICBzZXRUZXh0dXJlMkQodGV4dHVyZSwgc2xvdCk7CiAgfQogIGZ1bmN0aW9uIHNhZmVTZXRUZXh0dXJlQ3ViZSh0ZXh0dXJlLCBzbG90KSB7CiAgICBpZiAodGV4dHVyZSAmJiB0ZXh0dXJlLmlzV2ViR0xDdWJlUmVuZGVyVGFyZ2V0KSB7CiAgICAgIGlmICh3YXJuZWRUZXh0dXJlQ3ViZSA9PT0gZmFsc2UpIHsKICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMVGV4dHVyZXMuc2FmZVNldFRleHR1cmVDdWJlOiBkb24ndCB1c2UgY3ViZSByZW5kZXIgdGFyZ2V0cyBhcyB0ZXh0dXJlcy4gVXNlIHRoZWlyIC50ZXh0dXJlIHByb3BlcnR5IGluc3RlYWQuIik7CiAgICAgICAgd2FybmVkVGV4dHVyZUN1YmUgPSB0cnVlOwogICAgICB9CiAgICAgIHRleHR1cmUgPSB0ZXh0dXJlLnRleHR1cmU7CiAgICB9CiAgICBzZXRUZXh0dXJlQ3ViZSh0ZXh0dXJlLCBzbG90KTsKICB9CiAgdGhpcy5hbGxvY2F0ZVRleHR1cmVVbml0ID0gYWxsb2NhdGVUZXh0dXJlVW5pdDsKICB0aGlzLnJlc2V0VGV4dHVyZVVuaXRzID0gcmVzZXRUZXh0dXJlVW5pdHM7CiAgdGhpcy5zZXRUZXh0dXJlMkQgPSBzZXRUZXh0dXJlMkQ7CiAgdGhpcy5zZXRUZXh0dXJlMkRBcnJheSA9IHNldFRleHR1cmUyREFycmF5OwogIHRoaXMuc2V0VGV4dHVyZTNEID0gc2V0VGV4dHVyZTNEOwogIHRoaXMuc2V0VGV4dHVyZUN1YmUgPSBzZXRUZXh0dXJlQ3ViZTsKICB0aGlzLnJlYmluZFRleHR1cmVzID0gcmViaW5kVGV4dHVyZXM7CiAgdGhpcy5zZXR1cFJlbmRlclRhcmdldCA9IHNldHVwUmVuZGVyVGFyZ2V0OwogIHRoaXMudXBkYXRlUmVuZGVyVGFyZ2V0TWlwbWFwID0gdXBkYXRlUmVuZGVyVGFyZ2V0TWlwbWFwOwogIHRoaXMudXBkYXRlTXVsdGlzYW1wbGVSZW5kZXJUYXJnZXQgPSB1cGRhdGVNdWx0aXNhbXBsZVJlbmRlclRhcmdldDsKICB0aGlzLnNldHVwRGVwdGhSZW5kZXJidWZmZXIgPSBzZXR1cERlcHRoUmVuZGVyYnVmZmVyOwogIHRoaXMuc2V0dXBGcmFtZUJ1ZmZlclRleHR1cmUgPSBzZXR1cEZyYW1lQnVmZmVyVGV4dHVyZTsKICB0aGlzLnNhZmVTZXRUZXh0dXJlMkQgPSBzYWZlU2V0VGV4dHVyZTJEOwogIHRoaXMuc2FmZVNldFRleHR1cmVDdWJlID0gc2FmZVNldFRleHR1cmVDdWJlOwp9CmZ1bmN0aW9uIFdlYkdMVXRpbHMoZ2wsIGV4dGVuc2lvbnMsIGNhcGFiaWxpdGllcykgewogIGNvbnN0IGlzV2ViR0wyID0gY2FwYWJpbGl0aWVzLmlzV2ViR0wyOwogIGZ1bmN0aW9uIGNvbnZlcnQocCwgZW5jb2RpbmcgPSBudWxsKSB7CiAgICBsZXQgZXh0ZW5zaW9uOwogICAgaWYgKHAgPT09IFVuc2lnbmVkQnl0ZVR5cGUpCiAgICAgIHJldHVybiA1MTIxOwogICAgaWYgKHAgPT09IFVuc2lnbmVkU2hvcnQ0NDQ0VHlwZSkKICAgICAgcmV0dXJuIDMyODE5OwogICAgaWYgKHAgPT09IFVuc2lnbmVkU2hvcnQ1NTUxVHlwZSkKICAgICAgcmV0dXJuIDMyODIwOwogICAgaWYgKHAgPT09IEJ5dGVUeXBlKQogICAgICByZXR1cm4gNTEyMDsKICAgIGlmIChwID09PSBTaG9ydFR5cGUpCiAgICAgIHJldHVybiA1MTIyOwogICAgaWYgKHAgPT09IFVuc2lnbmVkU2hvcnRUeXBlKQogICAgICByZXR1cm4gNTEyMzsKICAgIGlmIChwID09PSBJbnRUeXBlKQogICAgICByZXR1cm4gNTEyNDsKICAgIGlmIChwID09PSBVbnNpZ25lZEludFR5cGUpCiAgICAgIHJldHVybiA1MTI1OwogICAgaWYgKHAgPT09IEZsb2F0VHlwZSkKICAgICAgcmV0dXJuIDUxMjY7CiAgICBpZiAocCA9PT0gSGFsZkZsb2F0VHlwZSkgewogICAgICBpZiAoaXNXZWJHTDIpCiAgICAgICAgcmV0dXJuIDUxMzE7CiAgICAgIGV4dGVuc2lvbiA9IGV4dGVuc2lvbnMuZ2V0KCJPRVNfdGV4dHVyZV9oYWxmX2Zsb2F0Iik7CiAgICAgIGlmIChleHRlbnNpb24gIT09IG51bGwpIHsKICAgICAgICByZXR1cm4gZXh0ZW5zaW9uLkhBTEZfRkxPQVRfT0VTOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9CiAgICBpZiAocCA9PT0gQWxwaGFGb3JtYXQpCiAgICAgIHJldHVybiA2NDA2OwogICAgaWYgKHAgPT09IFJHQkFGb3JtYXQpCiAgICAgIHJldHVybiA2NDA4OwogICAgaWYgKHAgPT09IEx1bWluYW5jZUZvcm1hdCkKICAgICAgcmV0dXJuIDY0MDk7CiAgICBpZiAocCA9PT0gTHVtaW5hbmNlQWxwaGFGb3JtYXQpCiAgICAgIHJldHVybiA2NDEwOwogICAgaWYgKHAgPT09IERlcHRoRm9ybWF0KQogICAgICByZXR1cm4gNjQwMjsKICAgIGlmIChwID09PSBEZXB0aFN0ZW5jaWxGb3JtYXQpCiAgICAgIHJldHVybiAzNDA0MTsKICAgIGlmIChwID09PSBSZWRGb3JtYXQpCiAgICAgIHJldHVybiA2NDAzOwogICAgaWYgKHAgPT09IFJHQkZvcm1hdCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IFRIUkVFLlJHQkZvcm1hdCBoYXMgYmVlbiByZW1vdmVkLiBVc2UgVEhSRUUuUkdCQUZvcm1hdCBpbnN0ZWFkLiBodHRwczovL2dpdGh1Yi5jb20vbXJkb29iL3RocmVlLmpzL3B1bGwvMjMyMjgiKTsKICAgICAgcmV0dXJuIDY0MDg7CiAgICB9CiAgICBpZiAocCA9PT0gX1NSR0JBRm9ybWF0KSB7CiAgICAgIGV4dGVuc2lvbiA9IGV4dGVuc2lvbnMuZ2V0KCJFWFRfc1JHQiIpOwogICAgICBpZiAoZXh0ZW5zaW9uICE9PSBudWxsKSB7CiAgICAgICAgcmV0dXJuIGV4dGVuc2lvbi5TUkdCX0FMUEhBX0VYVDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfQogICAgaWYgKHAgPT09IFJlZEludGVnZXJGb3JtYXQpCiAgICAgIHJldHVybiAzNjI0NDsKICAgIGlmIChwID09PSBSR0Zvcm1hdCkKICAgICAgcmV0dXJuIDMzMzE5OwogICAgaWYgKHAgPT09IFJHSW50ZWdlckZvcm1hdCkKICAgICAgcmV0dXJuIDMzMzIwOwogICAgaWYgKHAgPT09IFJHQkFJbnRlZ2VyRm9ybWF0KQogICAgICByZXR1cm4gMzYyNDk7CiAgICBpZiAocCA9PT0gUkdCX1MzVENfRFhUMV9Gb3JtYXQgfHwgcCA9PT0gUkdCQV9TM1RDX0RYVDFfRm9ybWF0IHx8IHAgPT09IFJHQkFfUzNUQ19EWFQzX0Zvcm1hdCB8fCBwID09PSBSR0JBX1MzVENfRFhUNV9Gb3JtYXQpIHsKICAgICAgaWYgKGVuY29kaW5nID09PSBzUkdCRW5jb2RpbmcpIHsKICAgICAgICBleHRlbnNpb24gPSBleHRlbnNpb25zLmdldCgiV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX3MzdGNfc3JnYiIpOwogICAgICAgIGlmIChleHRlbnNpb24gIT09IG51bGwpIHsKICAgICAgICAgIGlmIChwID09PSBSR0JfUzNUQ19EWFQxX0Zvcm1hdCkKICAgICAgICAgICAgcmV0dXJuIGV4dGVuc2lvbi5DT01QUkVTU0VEX1NSR0JfUzNUQ19EWFQxX0VYVDsKICAgICAgICAgIGlmIChwID09PSBSR0JBX1MzVENfRFhUMV9Gb3JtYXQpCiAgICAgICAgICAgIHJldHVybiBleHRlbnNpb24uQ09NUFJFU1NFRF9TUkdCX0FMUEhBX1MzVENfRFhUMV9FWFQ7CiAgICAgICAgICBpZiAocCA9PT0gUkdCQV9TM1RDX0RYVDNfRm9ybWF0KQogICAgICAgICAgICByZXR1cm4gZXh0ZW5zaW9uLkNPTVBSRVNTRURfU1JHQl9BTFBIQV9TM1RDX0RYVDNfRVhUOwogICAgICAgICAgaWYgKHAgPT09IFJHQkFfUzNUQ19EWFQ1X0Zvcm1hdCkKICAgICAgICAgICAgcmV0dXJuIGV4dGVuc2lvbi5DT01QUkVTU0VEX1NSR0JfQUxQSEFfUzNUQ19EWFQ1X0VYVDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGV4dGVuc2lvbiA9IGV4dGVuc2lvbnMuZ2V0KCJXRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfczN0YyIpOwogICAgICAgIGlmIChleHRlbnNpb24gIT09IG51bGwpIHsKICAgICAgICAgIGlmIChwID09PSBSR0JfUzNUQ19EWFQxX0Zvcm1hdCkKICAgICAgICAgICAgcmV0dXJuIGV4dGVuc2lvbi5DT01QUkVTU0VEX1JHQl9TM1RDX0RYVDFfRVhUOwogICAgICAgICAgaWYgKHAgPT09IFJHQkFfUzNUQ19EWFQxX0Zvcm1hdCkKICAgICAgICAgICAgcmV0dXJuIGV4dGVuc2lvbi5DT01QUkVTU0VEX1JHQkFfUzNUQ19EWFQxX0VYVDsKICAgICAgICAgIGlmIChwID09PSBSR0JBX1MzVENfRFhUM19Gb3JtYXQpCiAgICAgICAgICAgIHJldHVybiBleHRlbnNpb24uQ09NUFJFU1NFRF9SR0JBX1MzVENfRFhUM19FWFQ7CiAgICAgICAgICBpZiAocCA9PT0gUkdCQV9TM1RDX0RYVDVfRm9ybWF0KQogICAgICAgICAgICByZXR1cm4gZXh0ZW5zaW9uLkNPTVBSRVNTRURfUkdCQV9TM1RDX0RYVDVfRVhUOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGlmIChwID09PSBSR0JfUFZSVENfNEJQUFYxX0Zvcm1hdCB8fCBwID09PSBSR0JfUFZSVENfMkJQUFYxX0Zvcm1hdCB8fCBwID09PSBSR0JBX1BWUlRDXzRCUFBWMV9Gb3JtYXQgfHwgcCA9PT0gUkdCQV9QVlJUQ18yQlBQVjFfRm9ybWF0KSB7CiAgICAgIGV4dGVuc2lvbiA9IGV4dGVuc2lvbnMuZ2V0KCJXRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfcHZydGMiKTsKICAgICAgaWYgKGV4dGVuc2lvbiAhPT0gbnVsbCkgewogICAgICAgIGlmIChwID09PSBSR0JfUFZSVENfNEJQUFYxX0Zvcm1hdCkKICAgICAgICAgIHJldHVybiBleHRlbnNpb24uQ09NUFJFU1NFRF9SR0JfUFZSVENfNEJQUFYxX0lNRzsKICAgICAgICBpZiAocCA9PT0gUkdCX1BWUlRDXzJCUFBWMV9Gb3JtYXQpCiAgICAgICAgICByZXR1cm4gZXh0ZW5zaW9uLkNPTVBSRVNTRURfUkdCX1BWUlRDXzJCUFBWMV9JTUc7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfUFZSVENfNEJQUFYxX0Zvcm1hdCkKICAgICAgICAgIHJldHVybiBleHRlbnNpb24uQ09NUFJFU1NFRF9SR0JBX1BWUlRDXzRCUFBWMV9JTUc7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfUFZSVENfMkJQUFYxX0Zvcm1hdCkKICAgICAgICAgIHJldHVybiBleHRlbnNpb24uQ09NUFJFU1NFRF9SR0JBX1BWUlRDXzJCUFBWMV9JTUc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0KICAgIGlmIChwID09PSBSR0JfRVRDMV9Gb3JtYXQpIHsKICAgICAgZXh0ZW5zaW9uID0gZXh0ZW5zaW9ucy5nZXQoIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9ldGMxIik7CiAgICAgIGlmIChleHRlbnNpb24gIT09IG51bGwpIHsKICAgICAgICByZXR1cm4gZXh0ZW5zaW9uLkNPTVBSRVNTRURfUkdCX0VUQzFfV0VCR0w7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0KICAgIGlmIChwID09PSBSR0JfRVRDMl9Gb3JtYXQgfHwgcCA9PT0gUkdCQV9FVEMyX0VBQ19Gb3JtYXQpIHsKICAgICAgZXh0ZW5zaW9uID0gZXh0ZW5zaW9ucy5nZXQoIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9ldGMiKTsKICAgICAgaWYgKGV4dGVuc2lvbiAhPT0gbnVsbCkgewogICAgICAgIGlmIChwID09PSBSR0JfRVRDMl9Gb3JtYXQpCiAgICAgICAgICByZXR1cm4gZW5jb2RpbmcgPT09IHNSR0JFbmNvZGluZyA/IGV4dGVuc2lvbi5DT01QUkVTU0VEX1NSR0I4X0VUQzIgOiBleHRlbnNpb24uQ09NUFJFU1NFRF9SR0I4X0VUQzI7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfRVRDMl9FQUNfRm9ybWF0KQogICAgICAgICAgcmV0dXJuIGVuY29kaW5nID09PSBzUkdCRW5jb2RpbmcgPyBleHRlbnNpb24uQ09NUFJFU1NFRF9TUkdCOF9BTFBIQThfRVRDMl9FQUMgOiBleHRlbnNpb24uQ09NUFJFU1NFRF9SR0JBOF9FVEMyX0VBQzsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfQogICAgaWYgKHAgPT09IFJHQkFfQVNUQ180eDRfRm9ybWF0IHx8IHAgPT09IFJHQkFfQVNUQ181eDRfRm9ybWF0IHx8IHAgPT09IFJHQkFfQVNUQ181eDVfRm9ybWF0IHx8IHAgPT09IFJHQkFfQVNUQ182eDVfRm9ybWF0IHx8IHAgPT09IFJHQkFfQVNUQ182eDZfRm9ybWF0IHx8IHAgPT09IFJHQkFfQVNUQ184eDVfRm9ybWF0IHx8IHAgPT09IFJHQkFfQVNUQ184eDZfRm9ybWF0IHx8IHAgPT09IFJHQkFfQVNUQ184eDhfRm9ybWF0IHx8IHAgPT09IFJHQkFfQVNUQ18xMHg1X0Zvcm1hdCB8fCBwID09PSBSR0JBX0FTVENfMTB4Nl9Gb3JtYXQgfHwgcCA9PT0gUkdCQV9BU1RDXzEweDhfRm9ybWF0IHx8IHAgPT09IFJHQkFfQVNUQ18xMHgxMF9Gb3JtYXQgfHwgcCA9PT0gUkdCQV9BU1RDXzEyeDEwX0Zvcm1hdCB8fCBwID09PSBSR0JBX0FTVENfMTJ4MTJfRm9ybWF0KSB7CiAgICAgIGV4dGVuc2lvbiA9IGV4dGVuc2lvbnMuZ2V0KCJXRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfYXN0YyIpOwogICAgICBpZiAoZXh0ZW5zaW9uICE9PSBudWxsKSB7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfQVNUQ180eDRfRm9ybWF0KQogICAgICAgICAgcmV0dXJuIGVuY29kaW5nID09PSBzUkdCRW5jb2RpbmcgPyBleHRlbnNpb24uQ09NUFJFU1NFRF9TUkdCOF9BTFBIQThfQVNUQ180eDRfS0hSIDogZXh0ZW5zaW9uLkNPTVBSRVNTRURfUkdCQV9BU1RDXzR4NF9LSFI7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfQVNUQ181eDRfRm9ybWF0KQogICAgICAgICAgcmV0dXJuIGVuY29kaW5nID09PSBzUkdCRW5jb2RpbmcgPyBleHRlbnNpb24uQ09NUFJFU1NFRF9TUkdCOF9BTFBIQThfQVNUQ181eDRfS0hSIDogZXh0ZW5zaW9uLkNPTVBSRVNTRURfUkdCQV9BU1RDXzV4NF9LSFI7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfQVNUQ181eDVfRm9ybWF0KQogICAgICAgICAgcmV0dXJuIGVuY29kaW5nID09PSBzUkdCRW5jb2RpbmcgPyBleHRlbnNpb24uQ09NUFJFU1NFRF9TUkdCOF9BTFBIQThfQVNUQ181eDVfS0hSIDogZXh0ZW5zaW9uLkNPTVBSRVNTRURfUkdCQV9BU1RDXzV4NV9LSFI7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfQVNUQ182eDVfRm9ybWF0KQogICAgICAgICAgcmV0dXJuIGVuY29kaW5nID09PSBzUkdCRW5jb2RpbmcgPyBleHRlbnNpb24uQ09NUFJFU1NFRF9TUkdCOF9BTFBIQThfQVNUQ182eDVfS0hSIDogZXh0ZW5zaW9uLkNPTVBSRVNTRURfUkdCQV9BU1RDXzZ4NV9LSFI7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfQVNUQ182eDZfRm9ybWF0KQogICAgICAgICAgcmV0dXJuIGVuY29kaW5nID09PSBzUkdCRW5jb2RpbmcgPyBleHRlbnNpb24uQ09NUFJFU1NFRF9TUkdCOF9BTFBIQThfQVNUQ182eDZfS0hSIDogZXh0ZW5zaW9uLkNPTVBSRVNTRURfUkdCQV9BU1RDXzZ4Nl9LSFI7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfQVNUQ184eDVfRm9ybWF0KQogICAgICAgICAgcmV0dXJuIGVuY29kaW5nID09PSBzUkdCRW5jb2RpbmcgPyBleHRlbnNpb24uQ09NUFJFU1NFRF9TUkdCOF9BTFBIQThfQVNUQ184eDVfS0hSIDogZXh0ZW5zaW9uLkNPTVBSRVNTRURfUkdCQV9BU1RDXzh4NV9LSFI7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfQVNUQ184eDZfRm9ybWF0KQogICAgICAgICAgcmV0dXJuIGVuY29kaW5nID09PSBzUkdCRW5jb2RpbmcgPyBleHRlbnNpb24uQ09NUFJFU1NFRF9TUkdCOF9BTFBIQThfQVNUQ184eDZfS0hSIDogZXh0ZW5zaW9uLkNPTVBSRVNTRURfUkdCQV9BU1RDXzh4Nl9LSFI7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfQVNUQ184eDhfRm9ybWF0KQogICAgICAgICAgcmV0dXJuIGVuY29kaW5nID09PSBzUkdCRW5jb2RpbmcgPyBleHRlbnNpb24uQ09NUFJFU1NFRF9TUkdCOF9BTFBIQThfQVNUQ184eDhfS0hSIDogZXh0ZW5zaW9uLkNPTVBSRVNTRURfUkdCQV9BU1RDXzh4OF9LSFI7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfQVNUQ18xMHg1X0Zvcm1hdCkKICAgICAgICAgIHJldHVybiBlbmNvZGluZyA9PT0gc1JHQkVuY29kaW5nID8gZXh0ZW5zaW9uLkNPTVBSRVNTRURfU1JHQjhfQUxQSEE4X0FTVENfMTB4NV9LSFIgOiBleHRlbnNpb24uQ09NUFJFU1NFRF9SR0JBX0FTVENfMTB4NV9LSFI7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfQVNUQ18xMHg2X0Zvcm1hdCkKICAgICAgICAgIHJldHVybiBlbmNvZGluZyA9PT0gc1JHQkVuY29kaW5nID8gZXh0ZW5zaW9uLkNPTVBSRVNTRURfU1JHQjhfQUxQSEE4X0FTVENfMTB4Nl9LSFIgOiBleHRlbnNpb24uQ09NUFJFU1NFRF9SR0JBX0FTVENfMTB4Nl9LSFI7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfQVNUQ18xMHg4X0Zvcm1hdCkKICAgICAgICAgIHJldHVybiBlbmNvZGluZyA9PT0gc1JHQkVuY29kaW5nID8gZXh0ZW5zaW9uLkNPTVBSRVNTRURfU1JHQjhfQUxQSEE4X0FTVENfMTB4OF9LSFIgOiBleHRlbnNpb24uQ09NUFJFU1NFRF9SR0JBX0FTVENfMTB4OF9LSFI7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfQVNUQ18xMHgxMF9Gb3JtYXQpCiAgICAgICAgICByZXR1cm4gZW5jb2RpbmcgPT09IHNSR0JFbmNvZGluZyA/IGV4dGVuc2lvbi5DT01QUkVTU0VEX1NSR0I4X0FMUEhBOF9BU1RDXzEweDEwX0tIUiA6IGV4dGVuc2lvbi5DT01QUkVTU0VEX1JHQkFfQVNUQ18xMHgxMF9LSFI7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfQVNUQ18xMngxMF9Gb3JtYXQpCiAgICAgICAgICByZXR1cm4gZW5jb2RpbmcgPT09IHNSR0JFbmNvZGluZyA/IGV4dGVuc2lvbi5DT01QUkVTU0VEX1NSR0I4X0FMUEhBOF9BU1RDXzEyeDEwX0tIUiA6IGV4dGVuc2lvbi5DT01QUkVTU0VEX1JHQkFfQVNUQ18xMngxMF9LSFI7CiAgICAgICAgaWYgKHAgPT09IFJHQkFfQVNUQ18xMngxMl9Gb3JtYXQpCiAgICAgICAgICByZXR1cm4gZW5jb2RpbmcgPT09IHNSR0JFbmNvZGluZyA/IGV4dGVuc2lvbi5DT01QUkVTU0VEX1NSR0I4X0FMUEhBOF9BU1RDXzEyeDEyX0tIUiA6IGV4dGVuc2lvbi5DT01QUkVTU0VEX1JHQkFfQVNUQ18xMngxMl9LSFI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0KICAgIGlmIChwID09PSBSR0JBX0JQVENfRm9ybWF0KSB7CiAgICAgIGV4dGVuc2lvbiA9IGV4dGVuc2lvbnMuZ2V0KCJFWFRfdGV4dHVyZV9jb21wcmVzc2lvbl9icHRjIik7CiAgICAgIGlmIChleHRlbnNpb24gIT09IG51bGwpIHsKICAgICAgICBpZiAocCA9PT0gUkdCQV9CUFRDX0Zvcm1hdCkKICAgICAgICAgIHJldHVybiBlbmNvZGluZyA9PT0gc1JHQkVuY29kaW5nID8gZXh0ZW5zaW9uLkNPTVBSRVNTRURfU1JHQl9BTFBIQV9CUFRDX1VOT1JNX0VYVCA6IGV4dGVuc2lvbi5DT01QUkVTU0VEX1JHQkFfQlBUQ19VTk9STV9FWFQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0KICAgIGlmIChwID09PSBVbnNpZ25lZEludDI0OFR5cGUpIHsKICAgICAgaWYgKGlzV2ViR0wyKQogICAgICAgIHJldHVybiAzNDA0MjsKICAgICAgZXh0ZW5zaW9uID0gZXh0ZW5zaW9ucy5nZXQoIldFQkdMX2RlcHRoX3RleHR1cmUiKTsKICAgICAgaWYgKGV4dGVuc2lvbiAhPT0gbnVsbCkgewogICAgICAgIHJldHVybiBleHRlbnNpb24uVU5TSUdORURfSU5UXzI0XzhfV0VCR0w7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIHsgY29udmVydCB9Owp9CmNsYXNzIEFycmF5Q2FtZXJhIGV4dGVuZHMgUGVyc3BlY3RpdmVDYW1lcmEgewogIGNvbnN0cnVjdG9yKGFycmF5ID0gW10pIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLmNhbWVyYXMgPSBhcnJheTsKICB9Cn0KQXJyYXlDYW1lcmEucHJvdG90eXBlLmlzQXJyYXlDYW1lcmEgPSB0cnVlOwpjbGFzcyBHcm91cCBleHRlbmRzIE9iamVjdDNEIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLnR5cGUgPSAiR3JvdXAiOwogIH0KfQpHcm91cC5wcm90b3R5cGUuaXNHcm91cCA9IHRydWU7CmNvbnN0IF9tb3ZlRXZlbnQgPSB7IHR5cGU6ICJtb3ZlIiB9OwpjbGFzcyBXZWJYUkNvbnRyb2xsZXIgewogIGNvbnN0cnVjdG9yKCkgewogICAgdGhpcy5fdGFyZ2V0UmF5ID0gbnVsbDsKICAgIHRoaXMuX2dyaXAgPSBudWxsOwogICAgdGhpcy5faGFuZCA9IG51bGw7CiAgfQogIGdldEhhbmRTcGFjZSgpIHsKICAgIGlmICh0aGlzLl9oYW5kID09PSBudWxsKSB7CiAgICAgIHRoaXMuX2hhbmQgPSBuZXcgR3JvdXAoKTsKICAgICAgdGhpcy5faGFuZC5tYXRyaXhBdXRvVXBkYXRlID0gZmFsc2U7CiAgICAgIHRoaXMuX2hhbmQudmlzaWJsZSA9IGZhbHNlOwogICAgICB0aGlzLl9oYW5kLmpvaW50cyA9IHt9OwogICAgICB0aGlzLl9oYW5kLmlucHV0U3RhdGUgPSB7IHBpbmNoaW5nOiBmYWxzZSB9OwogICAgfQogICAgcmV0dXJuIHRoaXMuX2hhbmQ7CiAgfQogIGdldFRhcmdldFJheVNwYWNlKCkgewogICAgaWYgKHRoaXMuX3RhcmdldFJheSA9PT0gbnVsbCkgewogICAgICB0aGlzLl90YXJnZXRSYXkgPSBuZXcgR3JvdXAoKTsKICAgICAgdGhpcy5fdGFyZ2V0UmF5Lm1hdHJpeEF1dG9VcGRhdGUgPSBmYWxzZTsKICAgICAgdGhpcy5fdGFyZ2V0UmF5LnZpc2libGUgPSBmYWxzZTsKICAgICAgdGhpcy5fdGFyZ2V0UmF5Lmhhc0xpbmVhclZlbG9jaXR5ID0gZmFsc2U7CiAgICAgIHRoaXMuX3RhcmdldFJheS5saW5lYXJWZWxvY2l0eSA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIHRoaXMuX3RhcmdldFJheS5oYXNBbmd1bGFyVmVsb2NpdHkgPSBmYWxzZTsKICAgICAgdGhpcy5fdGFyZ2V0UmF5LmFuZ3VsYXJWZWxvY2l0eSA9IG5ldyBWZWN0b3IzKCk7CiAgICB9CiAgICByZXR1cm4gdGhpcy5fdGFyZ2V0UmF5OwogIH0KICBnZXRHcmlwU3BhY2UoKSB7CiAgICBpZiAodGhpcy5fZ3JpcCA9PT0gbnVsbCkgewogICAgICB0aGlzLl9ncmlwID0gbmV3IEdyb3VwKCk7CiAgICAgIHRoaXMuX2dyaXAubWF0cml4QXV0b1VwZGF0ZSA9IGZhbHNlOwogICAgICB0aGlzLl9ncmlwLnZpc2libGUgPSBmYWxzZTsKICAgICAgdGhpcy5fZ3JpcC5oYXNMaW5lYXJWZWxvY2l0eSA9IGZhbHNlOwogICAgICB0aGlzLl9ncmlwLmxpbmVhclZlbG9jaXR5ID0gbmV3IFZlY3RvcjMoKTsKICAgICAgdGhpcy5fZ3JpcC5oYXNBbmd1bGFyVmVsb2NpdHkgPSBmYWxzZTsKICAgICAgdGhpcy5fZ3JpcC5hbmd1bGFyVmVsb2NpdHkgPSBuZXcgVmVjdG9yMygpOwogICAgfQogICAgcmV0dXJuIHRoaXMuX2dyaXA7CiAgfQogIGRpc3BhdGNoRXZlbnQoZXZlbnQpIHsKICAgIGlmICh0aGlzLl90YXJnZXRSYXkgIT09IG51bGwpIHsKICAgICAgdGhpcy5fdGFyZ2V0UmF5LmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgfQogICAgaWYgKHRoaXMuX2dyaXAgIT09IG51bGwpIHsKICAgICAgdGhpcy5fZ3JpcC5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgIH0KICAgIGlmICh0aGlzLl9oYW5kICE9PSBudWxsKSB7CiAgICAgIHRoaXMuX2hhbmQuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9CiAgZGlzY29ubmVjdChpbnB1dFNvdXJjZSkgewogICAgdGhpcy5kaXNwYXRjaEV2ZW50KHsgdHlwZTogImRpc2Nvbm5lY3RlZCIsIGRhdGE6IGlucHV0U291cmNlIH0pOwogICAgaWYgKHRoaXMuX3RhcmdldFJheSAhPT0gbnVsbCkgewogICAgICB0aGlzLl90YXJnZXRSYXkudmlzaWJsZSA9IGZhbHNlOwogICAgfQogICAgaWYgKHRoaXMuX2dyaXAgIT09IG51bGwpIHsKICAgICAgdGhpcy5fZ3JpcC52aXNpYmxlID0gZmFsc2U7CiAgICB9CiAgICBpZiAodGhpcy5faGFuZCAhPT0gbnVsbCkgewogICAgICB0aGlzLl9oYW5kLnZpc2libGUgPSBmYWxzZTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICB1cGRhdGUoaW5wdXRTb3VyY2UsIGZyYW1lLCByZWZlcmVuY2VTcGFjZSkgewogICAgbGV0IGlucHV0UG9zZSA9IG51bGw7CiAgICBsZXQgZ3JpcFBvc2UgPSBudWxsOwogICAgbGV0IGhhbmRQb3NlID0gbnVsbDsKICAgIGNvbnN0IHRhcmdldFJheSA9IHRoaXMuX3RhcmdldFJheTsKICAgIGNvbnN0IGdyaXAgPSB0aGlzLl9ncmlwOwogICAgY29uc3QgaGFuZCA9IHRoaXMuX2hhbmQ7CiAgICBpZiAoaW5wdXRTb3VyY2UgJiYgZnJhbWUuc2Vzc2lvbi52aXNpYmlsaXR5U3RhdGUgIT09ICJ2aXNpYmxlLWJsdXJyZWQiKSB7CiAgICAgIGlmICh0YXJnZXRSYXkgIT09IG51bGwpIHsKICAgICAgICBpbnB1dFBvc2UgPSBmcmFtZS5nZXRQb3NlKGlucHV0U291cmNlLnRhcmdldFJheVNwYWNlLCByZWZlcmVuY2VTcGFjZSk7CiAgICAgICAgaWYgKGlucHV0UG9zZSAhPT0gbnVsbCkgewogICAgICAgICAgdGFyZ2V0UmF5Lm1hdHJpeC5mcm9tQXJyYXkoaW5wdXRQb3NlLnRyYW5zZm9ybS5tYXRyaXgpOwogICAgICAgICAgdGFyZ2V0UmF5Lm1hdHJpeC5kZWNvbXBvc2UodGFyZ2V0UmF5LnBvc2l0aW9uLCB0YXJnZXRSYXkucm90YXRpb24sIHRhcmdldFJheS5zY2FsZSk7CiAgICAgICAgICBpZiAoaW5wdXRQb3NlLmxpbmVhclZlbG9jaXR5KSB7CiAgICAgICAgICAgIHRhcmdldFJheS5oYXNMaW5lYXJWZWxvY2l0eSA9IHRydWU7CiAgICAgICAgICAgIHRhcmdldFJheS5saW5lYXJWZWxvY2l0eS5jb3B5KGlucHV0UG9zZS5saW5lYXJWZWxvY2l0eSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0YXJnZXRSYXkuaGFzTGluZWFyVmVsb2NpdHkgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChpbnB1dFBvc2UuYW5ndWxhclZlbG9jaXR5KSB7CiAgICAgICAgICAgIHRhcmdldFJheS5oYXNBbmd1bGFyVmVsb2NpdHkgPSB0cnVlOwogICAgICAgICAgICB0YXJnZXRSYXkuYW5ndWxhclZlbG9jaXR5LmNvcHkoaW5wdXRQb3NlLmFuZ3VsYXJWZWxvY2l0eSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0YXJnZXRSYXkuaGFzQW5ndWxhclZlbG9jaXR5ID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoX21vdmVFdmVudCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChoYW5kICYmIGlucHV0U291cmNlLmhhbmQpIHsKICAgICAgICBoYW5kUG9zZSA9IHRydWU7CiAgICAgICAgZm9yIChjb25zdCBpbnB1dGpvaW50IG9mIGlucHV0U291cmNlLmhhbmQudmFsdWVzKCkpIHsKICAgICAgICAgIGNvbnN0IGpvaW50UG9zZSA9IGZyYW1lLmdldEpvaW50UG9zZShpbnB1dGpvaW50LCByZWZlcmVuY2VTcGFjZSk7CiAgICAgICAgICBpZiAoaGFuZC5qb2ludHNbaW5wdXRqb2ludC5qb2ludE5hbWVdID09PSB2b2lkIDApIHsKICAgICAgICAgICAgY29uc3Qgam9pbnQyID0gbmV3IEdyb3VwKCk7CiAgICAgICAgICAgIGpvaW50Mi5tYXRyaXhBdXRvVXBkYXRlID0gZmFsc2U7CiAgICAgICAgICAgIGpvaW50Mi52aXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgIGhhbmQuam9pbnRzW2lucHV0am9pbnQuam9pbnROYW1lXSA9IGpvaW50MjsKICAgICAgICAgICAgaGFuZC5hZGQoam9pbnQyKTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IGpvaW50ID0gaGFuZC5qb2ludHNbaW5wdXRqb2ludC5qb2ludE5hbWVdOwogICAgICAgICAgaWYgKGpvaW50UG9zZSAhPT0gbnVsbCkgewogICAgICAgICAgICBqb2ludC5tYXRyaXguZnJvbUFycmF5KGpvaW50UG9zZS50cmFuc2Zvcm0ubWF0cml4KTsKICAgICAgICAgICAgam9pbnQubWF0cml4LmRlY29tcG9zZShqb2ludC5wb3NpdGlvbiwgam9pbnQucm90YXRpb24sIGpvaW50LnNjYWxlKTsKICAgICAgICAgICAgam9pbnQuam9pbnRSYWRpdXMgPSBqb2ludFBvc2UucmFkaXVzOwogICAgICAgICAgfQogICAgICAgICAgam9pbnQudmlzaWJsZSA9IGpvaW50UG9zZSAhPT0gbnVsbDsKICAgICAgICB9CiAgICAgICAgY29uc3QgaW5kZXhUaXAgPSBoYW5kLmpvaW50c1siaW5kZXgtZmluZ2VyLXRpcCJdOwogICAgICAgIGNvbnN0IHRodW1iVGlwID0gaGFuZC5qb2ludHNbInRodW1iLXRpcCJdOwogICAgICAgIGNvbnN0IGRpc3RhbmNlID0gaW5kZXhUaXAucG9zaXRpb24uZGlzdGFuY2VUbyh0aHVtYlRpcC5wb3NpdGlvbik7CiAgICAgICAgY29uc3QgZGlzdGFuY2VUb1BpbmNoID0gMC4wMjsKICAgICAgICBjb25zdCB0aHJlc2hvbGQgPSA1ZS0zOwogICAgICAgIGlmIChoYW5kLmlucHV0U3RhdGUucGluY2hpbmcgJiYgZGlzdGFuY2UgPiBkaXN0YW5jZVRvUGluY2ggKyB0aHJlc2hvbGQpIHsKICAgICAgICAgIGhhbmQuaW5wdXRTdGF0ZS5waW5jaGluZyA9IGZhbHNlOwogICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KHsKICAgICAgICAgICAgdHlwZTogInBpbmNoZW5kIiwKICAgICAgICAgICAgaGFuZGVkbmVzczogaW5wdXRTb3VyY2UuaGFuZGVkbmVzcywKICAgICAgICAgICAgdGFyZ2V0OiB0aGlzCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgaWYgKCFoYW5kLmlucHV0U3RhdGUucGluY2hpbmcgJiYgZGlzdGFuY2UgPD0gZGlzdGFuY2VUb1BpbmNoIC0gdGhyZXNob2xkKSB7CiAgICAgICAgICBoYW5kLmlucHV0U3RhdGUucGluY2hpbmcgPSB0cnVlOwogICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KHsKICAgICAgICAgICAgdHlwZTogInBpbmNoc3RhcnQiLAogICAgICAgICAgICBoYW5kZWRuZXNzOiBpbnB1dFNvdXJjZS5oYW5kZWRuZXNzLAogICAgICAgICAgICB0YXJnZXQ6IHRoaXMKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoZ3JpcCAhPT0gbnVsbCAmJiBpbnB1dFNvdXJjZS5ncmlwU3BhY2UpIHsKICAgICAgICAgIGdyaXBQb3NlID0gZnJhbWUuZ2V0UG9zZShpbnB1dFNvdXJjZS5ncmlwU3BhY2UsIHJlZmVyZW5jZVNwYWNlKTsKICAgICAgICAgIGlmIChncmlwUG9zZSAhPT0gbnVsbCkgewogICAgICAgICAgICBncmlwLm1hdHJpeC5mcm9tQXJyYXkoZ3JpcFBvc2UudHJhbnNmb3JtLm1hdHJpeCk7CiAgICAgICAgICAgIGdyaXAubWF0cml4LmRlY29tcG9zZShncmlwLnBvc2l0aW9uLCBncmlwLnJvdGF0aW9uLCBncmlwLnNjYWxlKTsKICAgICAgICAgICAgaWYgKGdyaXBQb3NlLmxpbmVhclZlbG9jaXR5KSB7CiAgICAgICAgICAgICAgZ3JpcC5oYXNMaW5lYXJWZWxvY2l0eSA9IHRydWU7CiAgICAgICAgICAgICAgZ3JpcC5saW5lYXJWZWxvY2l0eS5jb3B5KGdyaXBQb3NlLmxpbmVhclZlbG9jaXR5KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBncmlwLmhhc0xpbmVhclZlbG9jaXR5ID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGdyaXBQb3NlLmFuZ3VsYXJWZWxvY2l0eSkgewogICAgICAgICAgICAgIGdyaXAuaGFzQW5ndWxhclZlbG9jaXR5ID0gdHJ1ZTsKICAgICAgICAgICAgICBncmlwLmFuZ3VsYXJWZWxvY2l0eS5jb3B5KGdyaXBQb3NlLmFuZ3VsYXJWZWxvY2l0eSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZ3JpcC5oYXNBbmd1bGFyVmVsb2NpdHkgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgaWYgKHRhcmdldFJheSAhPT0gbnVsbCkgewogICAgICB0YXJnZXRSYXkudmlzaWJsZSA9IGlucHV0UG9zZSAhPT0gbnVsbDsKICAgIH0KICAgIGlmIChncmlwICE9PSBudWxsKSB7CiAgICAgIGdyaXAudmlzaWJsZSA9IGdyaXBQb3NlICE9PSBudWxsOwogICAgfQogICAgaWYgKGhhbmQgIT09IG51bGwpIHsKICAgICAgaGFuZC52aXNpYmxlID0gaGFuZFBvc2UgIT09IG51bGw7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9Cn0KY2xhc3MgRGVwdGhUZXh0dXJlIGV4dGVuZHMgVGV4dHVyZSB7CiAgY29uc3RydWN0b3Iod2lkdGgsIGhlaWdodCwgdHlwZSwgbWFwcGluZywgd3JhcFMsIHdyYXBULCBtYWdGaWx0ZXIsIG1pbkZpbHRlciwgYW5pc290cm9weSwgZm9ybWF0KSB7CiAgICBmb3JtYXQgPSBmb3JtYXQgIT09IHZvaWQgMCA/IGZvcm1hdCA6IERlcHRoRm9ybWF0OwogICAgaWYgKGZvcm1hdCAhPT0gRGVwdGhGb3JtYXQgJiYgZm9ybWF0ICE9PSBEZXB0aFN0ZW5jaWxGb3JtYXQpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJEZXB0aFRleHR1cmUgZm9ybWF0IG11c3QgYmUgZWl0aGVyIFRIUkVFLkRlcHRoRm9ybWF0IG9yIFRIUkVFLkRlcHRoU3RlbmNpbEZvcm1hdCIpOwogICAgfQogICAgaWYgKHR5cGUgPT09IHZvaWQgMCAmJiBmb3JtYXQgPT09IERlcHRoRm9ybWF0KQogICAgICB0eXBlID0gVW5zaWduZWRTaG9ydFR5cGU7CiAgICBpZiAodHlwZSA9PT0gdm9pZCAwICYmIGZvcm1hdCA9PT0gRGVwdGhTdGVuY2lsRm9ybWF0KQogICAgICB0eXBlID0gVW5zaWduZWRJbnQyNDhUeXBlOwogICAgc3VwZXIobnVsbCwgbWFwcGluZywgd3JhcFMsIHdyYXBULCBtYWdGaWx0ZXIsIG1pbkZpbHRlciwgZm9ybWF0LCB0eXBlLCBhbmlzb3Ryb3B5KTsKICAgIHRoaXMuaW1hZ2UgPSB7IHdpZHRoLCBoZWlnaHQgfTsKICAgIHRoaXMubWFnRmlsdGVyID0gbWFnRmlsdGVyICE9PSB2b2lkIDAgPyBtYWdGaWx0ZXIgOiBOZWFyZXN0RmlsdGVyOwogICAgdGhpcy5taW5GaWx0ZXIgPSBtaW5GaWx0ZXIgIT09IHZvaWQgMCA/IG1pbkZpbHRlciA6IE5lYXJlc3RGaWx0ZXI7CiAgICB0aGlzLmZsaXBZID0gZmFsc2U7CiAgICB0aGlzLmdlbmVyYXRlTWlwbWFwcyA9IGZhbHNlOwogIH0KfQpEZXB0aFRleHR1cmUucHJvdG90eXBlLmlzRGVwdGhUZXh0dXJlID0gdHJ1ZTsKY2xhc3MgV2ViWFJNYW5hZ2VyIGV4dGVuZHMgRXZlbnREaXNwYXRjaGVyIHsKICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgZ2wpIHsKICAgIHN1cGVyKCk7CiAgICBjb25zdCBzY29wZSA9IHRoaXM7CiAgICBsZXQgc2Vzc2lvbiA9IG51bGw7CiAgICBsZXQgZnJhbWVidWZmZXJTY2FsZUZhY3RvciA9IDE7CiAgICBsZXQgcmVmZXJlbmNlU3BhY2UgPSBudWxsOwogICAgbGV0IHJlZmVyZW5jZVNwYWNlVHlwZSA9ICJsb2NhbC1mbG9vciI7CiAgICBjb25zdCBoYXNNdWx0aXNhbXBsZWRSZW5kZXJUb1RleHR1cmUgPSByZW5kZXJlci5leHRlbnNpb25zLmhhcygiV0VCR0xfbXVsdGlzYW1wbGVkX3JlbmRlcl90b190ZXh0dXJlIik7CiAgICBsZXQgcG9zZSA9IG51bGw7CiAgICBsZXQgZ2xCaW5kaW5nID0gbnVsbDsKICAgIGxldCBnbFByb2pMYXllciA9IG51bGw7CiAgICBsZXQgZ2xCYXNlTGF5ZXIgPSBudWxsOwogICAgbGV0IGlzTXVsdGlzYW1wbGUgPSBmYWxzZTsKICAgIGxldCB4ckZyYW1lID0gbnVsbDsKICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBnbC5nZXRDb250ZXh0QXR0cmlidXRlcygpOwogICAgbGV0IGluaXRpYWxSZW5kZXJUYXJnZXQgPSBudWxsOwogICAgbGV0IG5ld1JlbmRlclRhcmdldCA9IG51bGw7CiAgICBjb25zdCBjb250cm9sbGVycyA9IFtdOwogICAgY29uc3QgaW5wdXRTb3VyY2VzTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgIGNvbnN0IGNhbWVyYUwgPSBuZXcgUGVyc3BlY3RpdmVDYW1lcmEoKTsKICAgIGNhbWVyYUwubGF5ZXJzLmVuYWJsZSgxKTsKICAgIGNhbWVyYUwudmlld3BvcnQgPSBuZXcgVmVjdG9yNCgpOwogICAgY29uc3QgY2FtZXJhUiA9IG5ldyBQZXJzcGVjdGl2ZUNhbWVyYSgpOwogICAgY2FtZXJhUi5sYXllcnMuZW5hYmxlKDIpOwogICAgY2FtZXJhUi52aWV3cG9ydCA9IG5ldyBWZWN0b3I0KCk7CiAgICBjb25zdCBjYW1lcmFzID0gW2NhbWVyYUwsIGNhbWVyYVJdOwogICAgY29uc3QgY2FtZXJhVlIgPSBuZXcgQXJyYXlDYW1lcmEoKTsKICAgIGNhbWVyYVZSLmxheWVycy5lbmFibGUoMSk7CiAgICBjYW1lcmFWUi5sYXllcnMuZW5hYmxlKDIpOwogICAgbGV0IF9jdXJyZW50RGVwdGhOZWFyID0gbnVsbDsKICAgIGxldCBfY3VycmVudERlcHRoRmFyID0gbnVsbDsKICAgIHRoaXMuY2FtZXJhQXV0b1VwZGF0ZSA9IHRydWU7CiAgICB0aGlzLmVuYWJsZWQgPSBmYWxzZTsKICAgIHRoaXMuaXNQcmVzZW50aW5nID0gZmFsc2U7CiAgICB0aGlzLmdldENvbnRyb2xsZXIgPSBmdW5jdGlvbihpbmRleCkgewogICAgICBsZXQgY29udHJvbGxlciA9IGNvbnRyb2xsZXJzW2luZGV4XTsKICAgICAgaWYgKGNvbnRyb2xsZXIgPT09IHZvaWQgMCkgewogICAgICAgIGNvbnRyb2xsZXIgPSBuZXcgV2ViWFJDb250cm9sbGVyKCk7CiAgICAgICAgY29udHJvbGxlcnNbaW5kZXhdID0gY29udHJvbGxlcjsKICAgICAgfQogICAgICByZXR1cm4gY29udHJvbGxlci5nZXRUYXJnZXRSYXlTcGFjZSgpOwogICAgfTsKICAgIHRoaXMuZ2V0Q29udHJvbGxlckdyaXAgPSBmdW5jdGlvbihpbmRleCkgewogICAgICBsZXQgY29udHJvbGxlciA9IGNvbnRyb2xsZXJzW2luZGV4XTsKICAgICAgaWYgKGNvbnRyb2xsZXIgPT09IHZvaWQgMCkgewogICAgICAgIGNvbnRyb2xsZXIgPSBuZXcgV2ViWFJDb250cm9sbGVyKCk7CiAgICAgICAgY29udHJvbGxlcnNbaW5kZXhdID0gY29udHJvbGxlcjsKICAgICAgfQogICAgICByZXR1cm4gY29udHJvbGxlci5nZXRHcmlwU3BhY2UoKTsKICAgIH07CiAgICB0aGlzLmdldEhhbmQgPSBmdW5jdGlvbihpbmRleCkgewogICAgICBsZXQgY29udHJvbGxlciA9IGNvbnRyb2xsZXJzW2luZGV4XTsKICAgICAgaWYgKGNvbnRyb2xsZXIgPT09IHZvaWQgMCkgewogICAgICAgIGNvbnRyb2xsZXIgPSBuZXcgV2ViWFJDb250cm9sbGVyKCk7CiAgICAgICAgY29udHJvbGxlcnNbaW5kZXhdID0gY29udHJvbGxlcjsKICAgICAgfQogICAgICByZXR1cm4gY29udHJvbGxlci5nZXRIYW5kU3BhY2UoKTsKICAgIH07CiAgICBmdW5jdGlvbiBvblNlc3Npb25FdmVudChldmVudCkgewogICAgICBjb25zdCBjb250cm9sbGVyID0gaW5wdXRTb3VyY2VzTWFwLmdldChldmVudC5pbnB1dFNvdXJjZSk7CiAgICAgIGlmIChjb250cm9sbGVyKSB7CiAgICAgICAgY29udHJvbGxlci5kaXNwYXRjaEV2ZW50KHsgdHlwZTogZXZlbnQudHlwZSwgZGF0YTogZXZlbnQuaW5wdXRTb3VyY2UgfSk7CiAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIG9uU2Vzc2lvbkVuZCgpIHsKICAgICAgaW5wdXRTb3VyY2VzTWFwLmZvckVhY2goZnVuY3Rpb24oY29udHJvbGxlciwgaW5wdXRTb3VyY2UpIHsKICAgICAgICBjb250cm9sbGVyLmRpc2Nvbm5lY3QoaW5wdXRTb3VyY2UpOwogICAgICB9KTsKICAgICAgaW5wdXRTb3VyY2VzTWFwLmNsZWFyKCk7CiAgICAgIF9jdXJyZW50RGVwdGhOZWFyID0gbnVsbDsKICAgICAgX2N1cnJlbnREZXB0aEZhciA9IG51bGw7CiAgICAgIHJlbmRlcmVyLnNldFJlbmRlclRhcmdldChpbml0aWFsUmVuZGVyVGFyZ2V0KTsKICAgICAgZ2xCYXNlTGF5ZXIgPSBudWxsOwogICAgICBnbFByb2pMYXllciA9IG51bGw7CiAgICAgIGdsQmluZGluZyA9IG51bGw7CiAgICAgIHNlc3Npb24gPSBudWxsOwogICAgICBuZXdSZW5kZXJUYXJnZXQgPSBudWxsOwogICAgICBhbmltYXRpb24uc3RvcCgpOwogICAgICBzY29wZS5pc1ByZXNlbnRpbmcgPSBmYWxzZTsKICAgICAgc2NvcGUuZGlzcGF0Y2hFdmVudCh7IHR5cGU6ICJzZXNzaW9uZW5kIiB9KTsKICAgIH0KICAgIHRoaXMuc2V0RnJhbWVidWZmZXJTY2FsZUZhY3RvciA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGZyYW1lYnVmZmVyU2NhbGVGYWN0b3IgPSB2YWx1ZTsKICAgICAgaWYgKHNjb3BlLmlzUHJlc2VudGluZyA9PT0gdHJ1ZSkgewogICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViWFJNYW5hZ2VyOiBDYW5ub3QgY2hhbmdlIGZyYW1lYnVmZmVyIHNjYWxlIHdoaWxlIHByZXNlbnRpbmcuIik7CiAgICAgIH0KICAgIH07CiAgICB0aGlzLnNldFJlZmVyZW5jZVNwYWNlVHlwZSA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIHJlZmVyZW5jZVNwYWNlVHlwZSA9IHZhbHVlOwogICAgICBpZiAoc2NvcGUuaXNQcmVzZW50aW5nID09PSB0cnVlKSB7CiAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJYUk1hbmFnZXI6IENhbm5vdCBjaGFuZ2UgcmVmZXJlbmNlIHNwYWNlIHR5cGUgd2hpbGUgcHJlc2VudGluZy4iKTsKICAgICAgfQogICAgfTsKICAgIHRoaXMuZ2V0UmVmZXJlbmNlU3BhY2UgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHJlZmVyZW5jZVNwYWNlOwogICAgfTsKICAgIHRoaXMuZ2V0QmFzZUxheWVyID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBnbFByb2pMYXllciAhPT0gbnVsbCA/IGdsUHJvakxheWVyIDogZ2xCYXNlTGF5ZXI7CiAgICB9OwogICAgdGhpcy5nZXRCaW5kaW5nID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBnbEJpbmRpbmc7CiAgICB9OwogICAgdGhpcy5nZXRGcmFtZSA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4geHJGcmFtZTsKICAgIH07CiAgICB0aGlzLmdldFNlc3Npb24gPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHNlc3Npb247CiAgICB9OwogICAgdGhpcy5zZXRTZXNzaW9uID0gZnVuY3Rpb24odmFsdWUpIHsKICAgICAgcmV0dXJuIF9fYXN5bmModGhpcywgbnVsbCwgZnVuY3Rpb24qICgpIHsKICAgICAgICBzZXNzaW9uID0gdmFsdWU7CiAgICAgICAgaWYgKHNlc3Npb24gIT09IG51bGwpIHsKICAgICAgICAgIGluaXRpYWxSZW5kZXJUYXJnZXQgPSByZW5kZXJlci5nZXRSZW5kZXJUYXJnZXQoKTsKICAgICAgICAgIHNlc3Npb24uYWRkRXZlbnRMaXN0ZW5lcigic2VsZWN0Iiwgb25TZXNzaW9uRXZlbnQpOwogICAgICAgICAgc2Vzc2lvbi5hZGRFdmVudExpc3RlbmVyKCJzZWxlY3RzdGFydCIsIG9uU2Vzc2lvbkV2ZW50KTsKICAgICAgICAgIHNlc3Npb24uYWRkRXZlbnRMaXN0ZW5lcigic2VsZWN0ZW5kIiwgb25TZXNzaW9uRXZlbnQpOwogICAgICAgICAgc2Vzc2lvbi5hZGRFdmVudExpc3RlbmVyKCJzcXVlZXplIiwgb25TZXNzaW9uRXZlbnQpOwogICAgICAgICAgc2Vzc2lvbi5hZGRFdmVudExpc3RlbmVyKCJzcXVlZXplc3RhcnQiLCBvblNlc3Npb25FdmVudCk7CiAgICAgICAgICBzZXNzaW9uLmFkZEV2ZW50TGlzdGVuZXIoInNxdWVlemVlbmQiLCBvblNlc3Npb25FdmVudCk7CiAgICAgICAgICBzZXNzaW9uLmFkZEV2ZW50TGlzdGVuZXIoImVuZCIsIG9uU2Vzc2lvbkVuZCk7CiAgICAgICAgICBzZXNzaW9uLmFkZEV2ZW50TGlzdGVuZXIoImlucHV0c291cmNlc2NoYW5nZSIsIG9uSW5wdXRTb3VyY2VzQ2hhbmdlKTsKICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLnhyQ29tcGF0aWJsZSAhPT0gdHJ1ZSkgewogICAgICAgICAgICB5aWVsZCBnbC5tYWtlWFJDb21wYXRpYmxlKCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoc2Vzc2lvbi5yZW5kZXJTdGF0ZS5sYXllcnMgPT09IHZvaWQgMCB8fCByZW5kZXJlci5jYXBhYmlsaXRpZXMuaXNXZWJHTDIgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIGNvbnN0IGxheWVySW5pdCA9IHsKICAgICAgICAgICAgICBhbnRpYWxpYXM6IHNlc3Npb24ucmVuZGVyU3RhdGUubGF5ZXJzID09PSB2b2lkIDAgPyBhdHRyaWJ1dGVzLmFudGlhbGlhcyA6IHRydWUsCiAgICAgICAgICAgICAgYWxwaGE6IGF0dHJpYnV0ZXMuYWxwaGEsCiAgICAgICAgICAgICAgZGVwdGg6IGF0dHJpYnV0ZXMuZGVwdGgsCiAgICAgICAgICAgICAgc3RlbmNpbDogYXR0cmlidXRlcy5zdGVuY2lsLAogICAgICAgICAgICAgIGZyYW1lYnVmZmVyU2NhbGVGYWN0b3IKICAgICAgICAgICAgfTsKICAgICAgICAgICAgZ2xCYXNlTGF5ZXIgPSBuZXcgWFJXZWJHTExheWVyKHNlc3Npb24sIGdsLCBsYXllckluaXQpOwogICAgICAgICAgICBzZXNzaW9uLnVwZGF0ZVJlbmRlclN0YXRlKHsgYmFzZUxheWVyOiBnbEJhc2VMYXllciB9KTsKICAgICAgICAgICAgbmV3UmVuZGVyVGFyZ2V0ID0gbmV3IFdlYkdMUmVuZGVyVGFyZ2V0KGdsQmFzZUxheWVyLmZyYW1lYnVmZmVyV2lkdGgsIGdsQmFzZUxheWVyLmZyYW1lYnVmZmVySGVpZ2h0LCB7CiAgICAgICAgICAgICAgZm9ybWF0OiBSR0JBRm9ybWF0LAogICAgICAgICAgICAgIHR5cGU6IFVuc2lnbmVkQnl0ZVR5cGUsCiAgICAgICAgICAgICAgZW5jb2Rpbmc6IHJlbmRlcmVyLm91dHB1dEVuY29kaW5nCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaXNNdWx0aXNhbXBsZSA9IGF0dHJpYnV0ZXMuYW50aWFsaWFzOwogICAgICAgICAgICBsZXQgZGVwdGhGb3JtYXQgPSBudWxsOwogICAgICAgICAgICBsZXQgZGVwdGhUeXBlID0gbnVsbDsKICAgICAgICAgICAgbGV0IGdsRGVwdGhGb3JtYXQgPSBudWxsOwogICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5kZXB0aCkgewogICAgICAgICAgICAgIGdsRGVwdGhGb3JtYXQgPSBhdHRyaWJ1dGVzLnN0ZW5jaWwgPyAzNTA1NiA6IDMzMTkwOwogICAgICAgICAgICAgIGRlcHRoRm9ybWF0ID0gYXR0cmlidXRlcy5zdGVuY2lsID8gRGVwdGhTdGVuY2lsRm9ybWF0IDogRGVwdGhGb3JtYXQ7CiAgICAgICAgICAgICAgZGVwdGhUeXBlID0gYXR0cmlidXRlcy5zdGVuY2lsID8gVW5zaWduZWRJbnQyNDhUeXBlIDogVW5zaWduZWRTaG9ydFR5cGU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgcHJvamVjdGlvbmxheWVySW5pdCA9IHsKICAgICAgICAgICAgICBjb2xvckZvcm1hdDogcmVuZGVyZXIub3V0cHV0RW5jb2RpbmcgPT09IHNSR0JFbmNvZGluZyA/IDM1OTA3IDogMzI4NTYsCiAgICAgICAgICAgICAgZGVwdGhGb3JtYXQ6IGdsRGVwdGhGb3JtYXQsCiAgICAgICAgICAgICAgc2NhbGVGYWN0b3I6IGZyYW1lYnVmZmVyU2NhbGVGYWN0b3IKICAgICAgICAgICAgfTsKICAgICAgICAgICAgZ2xCaW5kaW5nID0gbmV3IFhSV2ViR0xCaW5kaW5nKHNlc3Npb24sIGdsKTsKICAgICAgICAgICAgZ2xQcm9qTGF5ZXIgPSBnbEJpbmRpbmcuY3JlYXRlUHJvamVjdGlvbkxheWVyKHByb2plY3Rpb25sYXllckluaXQpOwogICAgICAgICAgICBzZXNzaW9uLnVwZGF0ZVJlbmRlclN0YXRlKHsgbGF5ZXJzOiBbZ2xQcm9qTGF5ZXJdIH0pOwogICAgICAgICAgICBpZiAoaXNNdWx0aXNhbXBsZSkgewogICAgICAgICAgICAgIG5ld1JlbmRlclRhcmdldCA9IG5ldyBXZWJHTE11bHRpc2FtcGxlUmVuZGVyVGFyZ2V0KGdsUHJvakxheWVyLnRleHR1cmVXaWR0aCwgZ2xQcm9qTGF5ZXIudGV4dHVyZUhlaWdodCwgewogICAgICAgICAgICAgICAgZm9ybWF0OiBSR0JBRm9ybWF0LAogICAgICAgICAgICAgICAgdHlwZTogVW5zaWduZWRCeXRlVHlwZSwKICAgICAgICAgICAgICAgIGRlcHRoVGV4dHVyZTogbmV3IERlcHRoVGV4dHVyZShnbFByb2pMYXllci50ZXh0dXJlV2lkdGgsIGdsUHJvakxheWVyLnRleHR1cmVIZWlnaHQsIGRlcHRoVHlwZSwgdm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZGVwdGhGb3JtYXQpLAogICAgICAgICAgICAgICAgc3RlbmNpbEJ1ZmZlcjogYXR0cmlidXRlcy5zdGVuY2lsLAogICAgICAgICAgICAgICAgaWdub3JlRGVwdGg6IGdsUHJvakxheWVyLmlnbm9yZURlcHRoVmFsdWVzLAogICAgICAgICAgICAgICAgdXNlUmVuZGVyVG9UZXh0dXJlOiBoYXNNdWx0aXNhbXBsZWRSZW5kZXJUb1RleHR1cmUsCiAgICAgICAgICAgICAgICBlbmNvZGluZzogcmVuZGVyZXIub3V0cHV0RW5jb2RpbmcKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBuZXdSZW5kZXJUYXJnZXQgPSBuZXcgV2ViR0xSZW5kZXJUYXJnZXQoZ2xQcm9qTGF5ZXIudGV4dHVyZVdpZHRoLCBnbFByb2pMYXllci50ZXh0dXJlSGVpZ2h0LCB7CiAgICAgICAgICAgICAgICBmb3JtYXQ6IFJHQkFGb3JtYXQsCiAgICAgICAgICAgICAgICB0eXBlOiBVbnNpZ25lZEJ5dGVUeXBlLAogICAgICAgICAgICAgICAgZGVwdGhUZXh0dXJlOiBuZXcgRGVwdGhUZXh0dXJlKGdsUHJvakxheWVyLnRleHR1cmVXaWR0aCwgZ2xQcm9qTGF5ZXIudGV4dHVyZUhlaWdodCwgZGVwdGhUeXBlLCB2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBkZXB0aEZvcm1hdCksCiAgICAgICAgICAgICAgICBzdGVuY2lsQnVmZmVyOiBhdHRyaWJ1dGVzLnN0ZW5jaWwsCiAgICAgICAgICAgICAgICBpZ25vcmVEZXB0aDogZ2xQcm9qTGF5ZXIuaWdub3JlRGVwdGhWYWx1ZXMsCiAgICAgICAgICAgICAgICBlbmNvZGluZzogcmVuZGVyZXIub3V0cHV0RW5jb2RpbmcKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgbmV3UmVuZGVyVGFyZ2V0LmlzWFJSZW5kZXJUYXJnZXQgPSB0cnVlOwogICAgICAgICAgdGhpcy5zZXRGb3ZlYXRpb24oMSk7CiAgICAgICAgICByZWZlcmVuY2VTcGFjZSA9IHlpZWxkIHNlc3Npb24ucmVxdWVzdFJlZmVyZW5jZVNwYWNlKHJlZmVyZW5jZVNwYWNlVHlwZSk7CiAgICAgICAgICBhbmltYXRpb24uc2V0Q29udGV4dChzZXNzaW9uKTsKICAgICAgICAgIGFuaW1hdGlvbi5zdGFydCgpOwogICAgICAgICAgc2NvcGUuaXNQcmVzZW50aW5nID0gdHJ1ZTsKICAgICAgICAgIHNjb3BlLmRpc3BhdGNoRXZlbnQoeyB0eXBlOiAic2Vzc2lvbnN0YXJ0IiB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKICAgIGZ1bmN0aW9uIG9uSW5wdXRTb3VyY2VzQ2hhbmdlKGV2ZW50KSB7CiAgICAgIGNvbnN0IGlucHV0U291cmNlcyA9IHNlc3Npb24uaW5wdXRTb3VyY2VzOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbnRyb2xsZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaW5wdXRTb3VyY2VzTWFwLnNldChpbnB1dFNvdXJjZXNbaV0sIGNvbnRyb2xsZXJzW2ldKTsKICAgICAgfQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV2ZW50LnJlbW92ZWQubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBpbnB1dFNvdXJjZSA9IGV2ZW50LnJlbW92ZWRbaV07CiAgICAgICAgY29uc3QgY29udHJvbGxlciA9IGlucHV0U291cmNlc01hcC5nZXQoaW5wdXRTb3VyY2UpOwogICAgICAgIGlmIChjb250cm9sbGVyKSB7CiAgICAgICAgICBjb250cm9sbGVyLmRpc3BhdGNoRXZlbnQoeyB0eXBlOiAiZGlzY29ubmVjdGVkIiwgZGF0YTogaW5wdXRTb3VyY2UgfSk7CiAgICAgICAgICBpbnB1dFNvdXJjZXNNYXAuZGVsZXRlKGlucHV0U291cmNlKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBldmVudC5hZGRlZC5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGlucHV0U291cmNlID0gZXZlbnQuYWRkZWRbaV07CiAgICAgICAgY29uc3QgY29udHJvbGxlciA9IGlucHV0U291cmNlc01hcC5nZXQoaW5wdXRTb3VyY2UpOwogICAgICAgIGlmIChjb250cm9sbGVyKSB7CiAgICAgICAgICBjb250cm9sbGVyLmRpc3BhdGNoRXZlbnQoeyB0eXBlOiAiY29ubmVjdGVkIiwgZGF0YTogaW5wdXRTb3VyY2UgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBjb25zdCBjYW1lcmFMUG9zID0gbmV3IFZlY3RvcjMoKTsKICAgIGNvbnN0IGNhbWVyYVJQb3MgPSBuZXcgVmVjdG9yMygpOwogICAgZnVuY3Rpb24gc2V0UHJvamVjdGlvbkZyb21VbmlvbihjYW1lcmEsIGNhbWVyYUwyLCBjYW1lcmFSMikgewogICAgICBjYW1lcmFMUG9zLnNldEZyb21NYXRyaXhQb3NpdGlvbihjYW1lcmFMMi5tYXRyaXhXb3JsZCk7CiAgICAgIGNhbWVyYVJQb3Muc2V0RnJvbU1hdHJpeFBvc2l0aW9uKGNhbWVyYVIyLm1hdHJpeFdvcmxkKTsKICAgICAgY29uc3QgaXBkID0gY2FtZXJhTFBvcy5kaXN0YW5jZVRvKGNhbWVyYVJQb3MpOwogICAgICBjb25zdCBwcm9qTCA9IGNhbWVyYUwyLnByb2plY3Rpb25NYXRyaXguZWxlbWVudHM7CiAgICAgIGNvbnN0IHByb2pSID0gY2FtZXJhUjIucHJvamVjdGlvbk1hdHJpeC5lbGVtZW50czsKICAgICAgY29uc3QgbmVhciA9IHByb2pMWzE0XSAvIChwcm9qTFsxMF0gLSAxKTsKICAgICAgY29uc3QgZmFyID0gcHJvakxbMTRdIC8gKHByb2pMWzEwXSArIDEpOwogICAgICBjb25zdCB0b3BGb3YgPSAocHJvakxbOV0gKyAxKSAvIHByb2pMWzVdOwogICAgICBjb25zdCBib3R0b21Gb3YgPSAocHJvakxbOV0gLSAxKSAvIHByb2pMWzVdOwogICAgICBjb25zdCBsZWZ0Rm92ID0gKHByb2pMWzhdIC0gMSkgLyBwcm9qTFswXTsKICAgICAgY29uc3QgcmlnaHRGb3YgPSAocHJvalJbOF0gKyAxKSAvIHByb2pSWzBdOwogICAgICBjb25zdCBsZWZ0ID0gbmVhciAqIGxlZnRGb3Y7CiAgICAgIGNvbnN0IHJpZ2h0ID0gbmVhciAqIHJpZ2h0Rm92OwogICAgICBjb25zdCB6T2Zmc2V0ID0gaXBkIC8gKC1sZWZ0Rm92ICsgcmlnaHRGb3YpOwogICAgICBjb25zdCB4T2Zmc2V0ID0gek9mZnNldCAqIC1sZWZ0Rm92OwogICAgICBjYW1lcmFMMi5tYXRyaXhXb3JsZC5kZWNvbXBvc2UoY2FtZXJhLnBvc2l0aW9uLCBjYW1lcmEucXVhdGVybmlvbiwgY2FtZXJhLnNjYWxlKTsKICAgICAgY2FtZXJhLnRyYW5zbGF0ZVgoeE9mZnNldCk7CiAgICAgIGNhbWVyYS50cmFuc2xhdGVaKHpPZmZzZXQpOwogICAgICBjYW1lcmEubWF0cml4V29ybGQuY29tcG9zZShjYW1lcmEucG9zaXRpb24sIGNhbWVyYS5xdWF0ZXJuaW9uLCBjYW1lcmEuc2NhbGUpOwogICAgICBjYW1lcmEubWF0cml4V29ybGRJbnZlcnNlLmNvcHkoY2FtZXJhLm1hdHJpeFdvcmxkKS5pbnZlcnQoKTsKICAgICAgY29uc3QgbmVhcjIgPSBuZWFyICsgek9mZnNldDsKICAgICAgY29uc3QgZmFyMiA9IGZhciArIHpPZmZzZXQ7CiAgICAgIGNvbnN0IGxlZnQyID0gbGVmdCAtIHhPZmZzZXQ7CiAgICAgIGNvbnN0IHJpZ2h0MiA9IHJpZ2h0ICsgKGlwZCAtIHhPZmZzZXQpOwogICAgICBjb25zdCB0b3AyID0gdG9wRm92ICogZmFyIC8gZmFyMiAqIG5lYXIyOwogICAgICBjb25zdCBib3R0b20yID0gYm90dG9tRm92ICogZmFyIC8gZmFyMiAqIG5lYXIyOwogICAgICBjYW1lcmEucHJvamVjdGlvbk1hdHJpeC5tYWtlUGVyc3BlY3RpdmUobGVmdDIsIHJpZ2h0MiwgdG9wMiwgYm90dG9tMiwgbmVhcjIsIGZhcjIpOwogICAgfQogICAgZnVuY3Rpb24gdXBkYXRlQ2FtZXJhKGNhbWVyYSwgcGFyZW50KSB7CiAgICAgIGlmIChwYXJlbnQgPT09IG51bGwpIHsKICAgICAgICBjYW1lcmEubWF0cml4V29ybGQuY29weShjYW1lcmEubWF0cml4KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjYW1lcmEubWF0cml4V29ybGQubXVsdGlwbHlNYXRyaWNlcyhwYXJlbnQubWF0cml4V29ybGQsIGNhbWVyYS5tYXRyaXgpOwogICAgICB9CiAgICAgIGNhbWVyYS5tYXRyaXhXb3JsZEludmVyc2UuY29weShjYW1lcmEubWF0cml4V29ybGQpLmludmVydCgpOwogICAgfQogICAgdGhpcy51cGRhdGVDYW1lcmEgPSBmdW5jdGlvbihjYW1lcmEpIHsKICAgICAgaWYgKHNlc3Npb24gPT09IG51bGwpCiAgICAgICAgcmV0dXJuOwogICAgICBjYW1lcmFWUi5uZWFyID0gY2FtZXJhUi5uZWFyID0gY2FtZXJhTC5uZWFyID0gY2FtZXJhLm5lYXI7CiAgICAgIGNhbWVyYVZSLmZhciA9IGNhbWVyYVIuZmFyID0gY2FtZXJhTC5mYXIgPSBjYW1lcmEuZmFyOwogICAgICBpZiAoX2N1cnJlbnREZXB0aE5lYXIgIT09IGNhbWVyYVZSLm5lYXIgfHwgX2N1cnJlbnREZXB0aEZhciAhPT0gY2FtZXJhVlIuZmFyKSB7CiAgICAgICAgc2Vzc2lvbi51cGRhdGVSZW5kZXJTdGF0ZSh7CiAgICAgICAgICBkZXB0aE5lYXI6IGNhbWVyYVZSLm5lYXIsCiAgICAgICAgICBkZXB0aEZhcjogY2FtZXJhVlIuZmFyCiAgICAgICAgfSk7CiAgICAgICAgX2N1cnJlbnREZXB0aE5lYXIgPSBjYW1lcmFWUi5uZWFyOwogICAgICAgIF9jdXJyZW50RGVwdGhGYXIgPSBjYW1lcmFWUi5mYXI7CiAgICAgIH0KICAgICAgY29uc3QgcGFyZW50ID0gY2FtZXJhLnBhcmVudDsKICAgICAgY29uc3QgY2FtZXJhczIgPSBjYW1lcmFWUi5jYW1lcmFzOwogICAgICB1cGRhdGVDYW1lcmEoY2FtZXJhVlIsIHBhcmVudCk7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2FtZXJhczIubGVuZ3RoOyBpKyspIHsKICAgICAgICB1cGRhdGVDYW1lcmEoY2FtZXJhczJbaV0sIHBhcmVudCk7CiAgICAgIH0KICAgICAgY2FtZXJhVlIubWF0cml4V29ybGQuZGVjb21wb3NlKGNhbWVyYVZSLnBvc2l0aW9uLCBjYW1lcmFWUi5xdWF0ZXJuaW9uLCBjYW1lcmFWUi5zY2FsZSk7CiAgICAgIGNhbWVyYS5wb3NpdGlvbi5jb3B5KGNhbWVyYVZSLnBvc2l0aW9uKTsKICAgICAgY2FtZXJhLnF1YXRlcm5pb24uY29weShjYW1lcmFWUi5xdWF0ZXJuaW9uKTsKICAgICAgY2FtZXJhLnNjYWxlLmNvcHkoY2FtZXJhVlIuc2NhbGUpOwogICAgICBjYW1lcmEubWF0cml4LmNvcHkoY2FtZXJhVlIubWF0cml4KTsKICAgICAgY2FtZXJhLm1hdHJpeFdvcmxkLmNvcHkoY2FtZXJhVlIubWF0cml4V29ybGQpOwogICAgICBjb25zdCBjaGlsZHJlbiA9IGNhbWVyYS5jaGlsZHJlbjsKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBjaGlsZHJlbltpXS51cGRhdGVNYXRyaXhXb3JsZCh0cnVlKTsKICAgICAgfQogICAgICBpZiAoY2FtZXJhczIubGVuZ3RoID09PSAyKSB7CiAgICAgICAgc2V0UHJvamVjdGlvbkZyb21VbmlvbihjYW1lcmFWUiwgY2FtZXJhTCwgY2FtZXJhUik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FtZXJhVlIucHJvamVjdGlvbk1hdHJpeC5jb3B5KGNhbWVyYUwucHJvamVjdGlvbk1hdHJpeCk7CiAgICAgIH0KICAgIH07CiAgICB0aGlzLmdldENhbWVyYSA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gY2FtZXJhVlI7CiAgICB9OwogICAgdGhpcy5nZXRGb3ZlYXRpb24gPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKGdsUHJvakxheWVyICE9PSBudWxsKSB7CiAgICAgICAgcmV0dXJuIGdsUHJvakxheWVyLmZpeGVkRm92ZWF0aW9uOwogICAgICB9CiAgICAgIGlmIChnbEJhc2VMYXllciAhPT0gbnVsbCkgewogICAgICAgIHJldHVybiBnbEJhc2VMYXllci5maXhlZEZvdmVhdGlvbjsKICAgICAgfQogICAgICByZXR1cm4gdm9pZCAwOwogICAgfTsKICAgIHRoaXMuc2V0Rm92ZWF0aW9uID0gZnVuY3Rpb24oZm92ZWF0aW9uKSB7CiAgICAgIGlmIChnbFByb2pMYXllciAhPT0gbnVsbCkgewogICAgICAgIGdsUHJvakxheWVyLmZpeGVkRm92ZWF0aW9uID0gZm92ZWF0aW9uOwogICAgICB9CiAgICAgIGlmIChnbEJhc2VMYXllciAhPT0gbnVsbCAmJiBnbEJhc2VMYXllci5maXhlZEZvdmVhdGlvbiAhPT0gdm9pZCAwKSB7CiAgICAgICAgZ2xCYXNlTGF5ZXIuZml4ZWRGb3ZlYXRpb24gPSBmb3ZlYXRpb247CiAgICAgIH0KICAgIH07CiAgICBsZXQgb25BbmltYXRpb25GcmFtZUNhbGxiYWNrID0gbnVsbDsKICAgIGZ1bmN0aW9uIG9uQW5pbWF0aW9uRnJhbWUodGltZSwgZnJhbWUpIHsKICAgICAgcG9zZSA9IGZyYW1lLmdldFZpZXdlclBvc2UocmVmZXJlbmNlU3BhY2UpOwogICAgICB4ckZyYW1lID0gZnJhbWU7CiAgICAgIGlmIChwb3NlICE9PSBudWxsKSB7CiAgICAgICAgY29uc3Qgdmlld3MgPSBwb3NlLnZpZXdzOwogICAgICAgIGlmIChnbEJhc2VMYXllciAhPT0gbnVsbCkgewogICAgICAgICAgcmVuZGVyZXIuc2V0UmVuZGVyVGFyZ2V0RnJhbWVidWZmZXIobmV3UmVuZGVyVGFyZ2V0LCBnbEJhc2VMYXllci5mcmFtZWJ1ZmZlcik7CiAgICAgICAgICByZW5kZXJlci5zZXRSZW5kZXJUYXJnZXQobmV3UmVuZGVyVGFyZ2V0KTsKICAgICAgICB9CiAgICAgICAgbGV0IGNhbWVyYVZSTmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgICAgICBpZiAodmlld3MubGVuZ3RoICE9PSBjYW1lcmFWUi5jYW1lcmFzLmxlbmd0aCkgewogICAgICAgICAgY2FtZXJhVlIuY2FtZXJhcy5sZW5ndGggPSAwOwogICAgICAgICAgY2FtZXJhVlJOZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgICAgfQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmlld3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHZpZXcgPSB2aWV3c1tpXTsKICAgICAgICAgIGxldCB2aWV3cG9ydCA9IG51bGw7CiAgICAgICAgICBpZiAoZ2xCYXNlTGF5ZXIgIT09IG51bGwpIHsKICAgICAgICAgICAgdmlld3BvcnQgPSBnbEJhc2VMYXllci5nZXRWaWV3cG9ydCh2aWV3KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IGdsU3ViSW1hZ2UgPSBnbEJpbmRpbmcuZ2V0Vmlld1N1YkltYWdlKGdsUHJvakxheWVyLCB2aWV3KTsKICAgICAgICAgICAgdmlld3BvcnQgPSBnbFN1YkltYWdlLnZpZXdwb3J0OwogICAgICAgICAgICBpZiAoaSA9PT0gMCkgewogICAgICAgICAgICAgIHJlbmRlcmVyLnNldFJlbmRlclRhcmdldFRleHR1cmVzKG5ld1JlbmRlclRhcmdldCwgZ2xTdWJJbWFnZS5jb2xvclRleHR1cmUsIGdsUHJvakxheWVyLmlnbm9yZURlcHRoVmFsdWVzID8gdm9pZCAwIDogZ2xTdWJJbWFnZS5kZXB0aFN0ZW5jaWxUZXh0dXJlKTsKICAgICAgICAgICAgICByZW5kZXJlci5zZXRSZW5kZXJUYXJnZXQobmV3UmVuZGVyVGFyZ2V0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgY29uc3QgY2FtZXJhID0gY2FtZXJhc1tpXTsKICAgICAgICAgIGNhbWVyYS5tYXRyaXguZnJvbUFycmF5KHZpZXcudHJhbnNmb3JtLm1hdHJpeCk7CiAgICAgICAgICBjYW1lcmEucHJvamVjdGlvbk1hdHJpeC5mcm9tQXJyYXkodmlldy5wcm9qZWN0aW9uTWF0cml4KTsKICAgICAgICAgIGNhbWVyYS52aWV3cG9ydC5zZXQodmlld3BvcnQueCwgdmlld3BvcnQueSwgdmlld3BvcnQud2lkdGgsIHZpZXdwb3J0LmhlaWdodCk7CiAgICAgICAgICBpZiAoaSA9PT0gMCkgewogICAgICAgICAgICBjYW1lcmFWUi5tYXRyaXguY29weShjYW1lcmEubWF0cml4KTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChjYW1lcmFWUk5lZWRzVXBkYXRlID09PSB0cnVlKSB7CiAgICAgICAgICAgIGNhbWVyYVZSLmNhbWVyYXMucHVzaChjYW1lcmEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBjb25zdCBpbnB1dFNvdXJjZXMgPSBzZXNzaW9uLmlucHV0U291cmNlczsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb250cm9sbGVycy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBjb250cm9sbGVyc1tpXTsKICAgICAgICBjb25zdCBpbnB1dFNvdXJjZSA9IGlucHV0U291cmNlc1tpXTsKICAgICAgICBjb250cm9sbGVyLnVwZGF0ZShpbnB1dFNvdXJjZSwgZnJhbWUsIHJlZmVyZW5jZVNwYWNlKTsKICAgICAgfQogICAgICBpZiAob25BbmltYXRpb25GcmFtZUNhbGxiYWNrKQogICAgICAgIG9uQW5pbWF0aW9uRnJhbWVDYWxsYmFjayh0aW1lLCBmcmFtZSk7CiAgICAgIHhyRnJhbWUgPSBudWxsOwogICAgfQogICAgY29uc3QgYW5pbWF0aW9uID0gbmV3IFdlYkdMQW5pbWF0aW9uKCk7CiAgICBhbmltYXRpb24uc2V0QW5pbWF0aW9uTG9vcChvbkFuaW1hdGlvbkZyYW1lKTsKICAgIHRoaXMuc2V0QW5pbWF0aW9uTG9vcCA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7CiAgICAgIG9uQW5pbWF0aW9uRnJhbWVDYWxsYmFjayA9IGNhbGxiYWNrOwogICAgfTsKICAgIHRoaXMuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgewogICAgfTsKICB9Cn0KZnVuY3Rpb24gV2ViR0xNYXRlcmlhbHMocHJvcGVydGllcykgewogIGZ1bmN0aW9uIHJlZnJlc2hGb2dVbmlmb3Jtcyh1bmlmb3JtcywgZm9nKSB7CiAgICB1bmlmb3Jtcy5mb2dDb2xvci52YWx1ZS5jb3B5KGZvZy5jb2xvcik7CiAgICBpZiAoZm9nLmlzRm9nKSB7CiAgICAgIHVuaWZvcm1zLmZvZ05lYXIudmFsdWUgPSBmb2cubmVhcjsKICAgICAgdW5pZm9ybXMuZm9nRmFyLnZhbHVlID0gZm9nLmZhcjsKICAgIH0gZWxzZSBpZiAoZm9nLmlzRm9nRXhwMikgewogICAgICB1bmlmb3Jtcy5mb2dEZW5zaXR5LnZhbHVlID0gZm9nLmRlbnNpdHk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlZnJlc2hNYXRlcmlhbFVuaWZvcm1zKHVuaWZvcm1zLCBtYXRlcmlhbCwgcGl4ZWxSYXRpbywgaGVpZ2h0LCB0cmFuc21pc3Npb25SZW5kZXJUYXJnZXQpIHsKICAgIGlmIChtYXRlcmlhbC5pc01lc2hCYXNpY01hdGVyaWFsKSB7CiAgICAgIHJlZnJlc2hVbmlmb3Jtc0NvbW1vbih1bmlmb3JtcywgbWF0ZXJpYWwpOwogICAgfSBlbHNlIGlmIChtYXRlcmlhbC5pc01lc2hMYW1iZXJ0TWF0ZXJpYWwpIHsKICAgICAgcmVmcmVzaFVuaWZvcm1zQ29tbW9uKHVuaWZvcm1zLCBtYXRlcmlhbCk7CiAgICAgIHJlZnJlc2hVbmlmb3Jtc0xhbWJlcnQodW5pZm9ybXMsIG1hdGVyaWFsKTsKICAgIH0gZWxzZSBpZiAobWF0ZXJpYWwuaXNNZXNoVG9vbk1hdGVyaWFsKSB7CiAgICAgIHJlZnJlc2hVbmlmb3Jtc0NvbW1vbih1bmlmb3JtcywgbWF0ZXJpYWwpOwogICAgICByZWZyZXNoVW5pZm9ybXNUb29uKHVuaWZvcm1zLCBtYXRlcmlhbCk7CiAgICB9IGVsc2UgaWYgKG1hdGVyaWFsLmlzTWVzaFBob25nTWF0ZXJpYWwpIHsKICAgICAgcmVmcmVzaFVuaWZvcm1zQ29tbW9uKHVuaWZvcm1zLCBtYXRlcmlhbCk7CiAgICAgIHJlZnJlc2hVbmlmb3Jtc1Bob25nKHVuaWZvcm1zLCBtYXRlcmlhbCk7CiAgICB9IGVsc2UgaWYgKG1hdGVyaWFsLmlzTWVzaFN0YW5kYXJkTWF0ZXJpYWwpIHsKICAgICAgcmVmcmVzaFVuaWZvcm1zQ29tbW9uKHVuaWZvcm1zLCBtYXRlcmlhbCk7CiAgICAgIGlmIChtYXRlcmlhbC5pc01lc2hQaHlzaWNhbE1hdGVyaWFsKSB7CiAgICAgICAgcmVmcmVzaFVuaWZvcm1zUGh5c2ljYWwodW5pZm9ybXMsIG1hdGVyaWFsLCB0cmFuc21pc3Npb25SZW5kZXJUYXJnZXQpOwogICAgICB9IGVsc2UgewogICAgICAgIHJlZnJlc2hVbmlmb3Jtc1N0YW5kYXJkKHVuaWZvcm1zLCBtYXRlcmlhbCk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAobWF0ZXJpYWwuaXNNZXNoTWF0Y2FwTWF0ZXJpYWwpIHsKICAgICAgcmVmcmVzaFVuaWZvcm1zQ29tbW9uKHVuaWZvcm1zLCBtYXRlcmlhbCk7CiAgICAgIHJlZnJlc2hVbmlmb3Jtc01hdGNhcCh1bmlmb3JtcywgbWF0ZXJpYWwpOwogICAgfSBlbHNlIGlmIChtYXRlcmlhbC5pc01lc2hEZXB0aE1hdGVyaWFsKSB7CiAgICAgIHJlZnJlc2hVbmlmb3Jtc0NvbW1vbih1bmlmb3JtcywgbWF0ZXJpYWwpOwogICAgICByZWZyZXNoVW5pZm9ybXNEZXB0aCh1bmlmb3JtcywgbWF0ZXJpYWwpOwogICAgfSBlbHNlIGlmIChtYXRlcmlhbC5pc01lc2hEaXN0YW5jZU1hdGVyaWFsKSB7CiAgICAgIHJlZnJlc2hVbmlmb3Jtc0NvbW1vbih1bmlmb3JtcywgbWF0ZXJpYWwpOwogICAgICByZWZyZXNoVW5pZm9ybXNEaXN0YW5jZSh1bmlmb3JtcywgbWF0ZXJpYWwpOwogICAgfSBlbHNlIGlmIChtYXRlcmlhbC5pc01lc2hOb3JtYWxNYXRlcmlhbCkgewogICAgICByZWZyZXNoVW5pZm9ybXNDb21tb24odW5pZm9ybXMsIG1hdGVyaWFsKTsKICAgICAgcmVmcmVzaFVuaWZvcm1zTm9ybWFsKHVuaWZvcm1zLCBtYXRlcmlhbCk7CiAgICB9IGVsc2UgaWYgKG1hdGVyaWFsLmlzTGluZUJhc2ljTWF0ZXJpYWwpIHsKICAgICAgcmVmcmVzaFVuaWZvcm1zTGluZSh1bmlmb3JtcywgbWF0ZXJpYWwpOwogICAgICBpZiAobWF0ZXJpYWwuaXNMaW5lRGFzaGVkTWF0ZXJpYWwpIHsKICAgICAgICByZWZyZXNoVW5pZm9ybXNEYXNoKHVuaWZvcm1zLCBtYXRlcmlhbCk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAobWF0ZXJpYWwuaXNQb2ludHNNYXRlcmlhbCkgewogICAgICByZWZyZXNoVW5pZm9ybXNQb2ludHModW5pZm9ybXMsIG1hdGVyaWFsLCBwaXhlbFJhdGlvLCBoZWlnaHQpOwogICAgfSBlbHNlIGlmIChtYXRlcmlhbC5pc1Nwcml0ZU1hdGVyaWFsKSB7CiAgICAgIHJlZnJlc2hVbmlmb3Jtc1Nwcml0ZXModW5pZm9ybXMsIG1hdGVyaWFsKTsKICAgIH0gZWxzZSBpZiAobWF0ZXJpYWwuaXNTaGFkb3dNYXRlcmlhbCkgewogICAgICB1bmlmb3Jtcy5jb2xvci52YWx1ZS5jb3B5KG1hdGVyaWFsLmNvbG9yKTsKICAgICAgdW5pZm9ybXMub3BhY2l0eS52YWx1ZSA9IG1hdGVyaWFsLm9wYWNpdHk7CiAgICB9IGVsc2UgaWYgKG1hdGVyaWFsLmlzU2hhZGVyTWF0ZXJpYWwpIHsKICAgICAgbWF0ZXJpYWwudW5pZm9ybXNOZWVkVXBkYXRlID0gZmFsc2U7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlZnJlc2hVbmlmb3Jtc0NvbW1vbih1bmlmb3JtcywgbWF0ZXJpYWwpIHsKICAgIHVuaWZvcm1zLm9wYWNpdHkudmFsdWUgPSBtYXRlcmlhbC5vcGFjaXR5OwogICAgaWYgKG1hdGVyaWFsLmNvbG9yKSB7CiAgICAgIHVuaWZvcm1zLmRpZmZ1c2UudmFsdWUuY29weShtYXRlcmlhbC5jb2xvcik7CiAgICB9CiAgICBpZiAobWF0ZXJpYWwuZW1pc3NpdmUpIHsKICAgICAgdW5pZm9ybXMuZW1pc3NpdmUudmFsdWUuY29weShtYXRlcmlhbC5lbWlzc2l2ZSkubXVsdGlwbHlTY2FsYXIobWF0ZXJpYWwuZW1pc3NpdmVJbnRlbnNpdHkpOwogICAgfQogICAgaWYgKG1hdGVyaWFsLm1hcCkgewogICAgICB1bmlmb3Jtcy5tYXAudmFsdWUgPSBtYXRlcmlhbC5tYXA7CiAgICB9CiAgICBpZiAobWF0ZXJpYWwuYWxwaGFNYXApIHsKICAgICAgdW5pZm9ybXMuYWxwaGFNYXAudmFsdWUgPSBtYXRlcmlhbC5hbHBoYU1hcDsKICAgIH0KICAgIGlmIChtYXRlcmlhbC5zcGVjdWxhck1hcCkgewogICAgICB1bmlmb3Jtcy5zcGVjdWxhck1hcC52YWx1ZSA9IG1hdGVyaWFsLnNwZWN1bGFyTWFwOwogICAgfQogICAgaWYgKG1hdGVyaWFsLmFscGhhVGVzdCA+IDApIHsKICAgICAgdW5pZm9ybXMuYWxwaGFUZXN0LnZhbHVlID0gbWF0ZXJpYWwuYWxwaGFUZXN0OwogICAgfQogICAgY29uc3QgZW52TWFwID0gcHJvcGVydGllcy5nZXQobWF0ZXJpYWwpLmVudk1hcDsKICAgIGlmIChlbnZNYXApIHsKICAgICAgdW5pZm9ybXMuZW52TWFwLnZhbHVlID0gZW52TWFwOwogICAgICB1bmlmb3Jtcy5mbGlwRW52TWFwLnZhbHVlID0gZW52TWFwLmlzQ3ViZVRleHR1cmUgJiYgZW52TWFwLmlzUmVuZGVyVGFyZ2V0VGV4dHVyZSA9PT0gZmFsc2UgPyAtMSA6IDE7CiAgICAgIHVuaWZvcm1zLnJlZmxlY3Rpdml0eS52YWx1ZSA9IG1hdGVyaWFsLnJlZmxlY3Rpdml0eTsKICAgICAgdW5pZm9ybXMuaW9yLnZhbHVlID0gbWF0ZXJpYWwuaW9yOwogICAgICB1bmlmb3Jtcy5yZWZyYWN0aW9uUmF0aW8udmFsdWUgPSBtYXRlcmlhbC5yZWZyYWN0aW9uUmF0aW87CiAgICB9CiAgICBpZiAobWF0ZXJpYWwubGlnaHRNYXApIHsKICAgICAgdW5pZm9ybXMubGlnaHRNYXAudmFsdWUgPSBtYXRlcmlhbC5saWdodE1hcDsKICAgICAgdW5pZm9ybXMubGlnaHRNYXBJbnRlbnNpdHkudmFsdWUgPSBtYXRlcmlhbC5saWdodE1hcEludGVuc2l0eTsKICAgIH0KICAgIGlmIChtYXRlcmlhbC5hb01hcCkgewogICAgICB1bmlmb3Jtcy5hb01hcC52YWx1ZSA9IG1hdGVyaWFsLmFvTWFwOwogICAgICB1bmlmb3Jtcy5hb01hcEludGVuc2l0eS52YWx1ZSA9IG1hdGVyaWFsLmFvTWFwSW50ZW5zaXR5OwogICAgfQogICAgbGV0IHV2U2NhbGVNYXA7CiAgICBpZiAobWF0ZXJpYWwubWFwKSB7CiAgICAgIHV2U2NhbGVNYXAgPSBtYXRlcmlhbC5tYXA7CiAgICB9IGVsc2UgaWYgKG1hdGVyaWFsLnNwZWN1bGFyTWFwKSB7CiAgICAgIHV2U2NhbGVNYXAgPSBtYXRlcmlhbC5zcGVjdWxhck1hcDsKICAgIH0gZWxzZSBpZiAobWF0ZXJpYWwuZGlzcGxhY2VtZW50TWFwKSB7CiAgICAgIHV2U2NhbGVNYXAgPSBtYXRlcmlhbC5kaXNwbGFjZW1lbnRNYXA7CiAgICB9IGVsc2UgaWYgKG1hdGVyaWFsLm5vcm1hbE1hcCkgewogICAgICB1dlNjYWxlTWFwID0gbWF0ZXJpYWwubm9ybWFsTWFwOwogICAgfSBlbHNlIGlmIChtYXRlcmlhbC5idW1wTWFwKSB7CiAgICAgIHV2U2NhbGVNYXAgPSBtYXRlcmlhbC5idW1wTWFwOwogICAgfSBlbHNlIGlmIChtYXRlcmlhbC5yb3VnaG5lc3NNYXApIHsKICAgICAgdXZTY2FsZU1hcCA9IG1hdGVyaWFsLnJvdWdobmVzc01hcDsKICAgIH0gZWxzZSBpZiAobWF0ZXJpYWwubWV0YWxuZXNzTWFwKSB7CiAgICAgIHV2U2NhbGVNYXAgPSBtYXRlcmlhbC5tZXRhbG5lc3NNYXA7CiAgICB9IGVsc2UgaWYgKG1hdGVyaWFsLmFscGhhTWFwKSB7CiAgICAgIHV2U2NhbGVNYXAgPSBtYXRlcmlhbC5hbHBoYU1hcDsKICAgIH0gZWxzZSBpZiAobWF0ZXJpYWwuZW1pc3NpdmVNYXApIHsKICAgICAgdXZTY2FsZU1hcCA9IG1hdGVyaWFsLmVtaXNzaXZlTWFwOwogICAgfSBlbHNlIGlmIChtYXRlcmlhbC5jbGVhcmNvYXRNYXApIHsKICAgICAgdXZTY2FsZU1hcCA9IG1hdGVyaWFsLmNsZWFyY29hdE1hcDsKICAgIH0gZWxzZSBpZiAobWF0ZXJpYWwuY2xlYXJjb2F0Tm9ybWFsTWFwKSB7CiAgICAgIHV2U2NhbGVNYXAgPSBtYXRlcmlhbC5jbGVhcmNvYXROb3JtYWxNYXA7CiAgICB9IGVsc2UgaWYgKG1hdGVyaWFsLmNsZWFyY29hdFJvdWdobmVzc01hcCkgewogICAgICB1dlNjYWxlTWFwID0gbWF0ZXJpYWwuY2xlYXJjb2F0Um91Z2huZXNzTWFwOwogICAgfSBlbHNlIGlmIChtYXRlcmlhbC5zcGVjdWxhckludGVuc2l0eU1hcCkgewogICAgICB1dlNjYWxlTWFwID0gbWF0ZXJpYWwuc3BlY3VsYXJJbnRlbnNpdHlNYXA7CiAgICB9IGVsc2UgaWYgKG1hdGVyaWFsLnNwZWN1bGFyQ29sb3JNYXApIHsKICAgICAgdXZTY2FsZU1hcCA9IG1hdGVyaWFsLnNwZWN1bGFyQ29sb3JNYXA7CiAgICB9IGVsc2UgaWYgKG1hdGVyaWFsLnRyYW5zbWlzc2lvbk1hcCkgewogICAgICB1dlNjYWxlTWFwID0gbWF0ZXJpYWwudHJhbnNtaXNzaW9uTWFwOwogICAgfSBlbHNlIGlmIChtYXRlcmlhbC50aGlja25lc3NNYXApIHsKICAgICAgdXZTY2FsZU1hcCA9IG1hdGVyaWFsLnRoaWNrbmVzc01hcDsKICAgIH0gZWxzZSBpZiAobWF0ZXJpYWwuc2hlZW5Db2xvck1hcCkgewogICAgICB1dlNjYWxlTWFwID0gbWF0ZXJpYWwuc2hlZW5Db2xvck1hcDsKICAgIH0gZWxzZSBpZiAobWF0ZXJpYWwuc2hlZW5Sb3VnaG5lc3NNYXApIHsKICAgICAgdXZTY2FsZU1hcCA9IG1hdGVyaWFsLnNoZWVuUm91Z2huZXNzTWFwOwogICAgfQogICAgaWYgKHV2U2NhbGVNYXAgIT09IHZvaWQgMCkgewogICAgICBpZiAodXZTY2FsZU1hcC5pc1dlYkdMUmVuZGVyVGFyZ2V0KSB7CiAgICAgICAgdXZTY2FsZU1hcCA9IHV2U2NhbGVNYXAudGV4dHVyZTsKICAgICAgfQogICAgICBpZiAodXZTY2FsZU1hcC5tYXRyaXhBdXRvVXBkYXRlID09PSB0cnVlKSB7CiAgICAgICAgdXZTY2FsZU1hcC51cGRhdGVNYXRyaXgoKTsKICAgICAgfQogICAgICB1bmlmb3Jtcy51dlRyYW5zZm9ybS52YWx1ZS5jb3B5KHV2U2NhbGVNYXAubWF0cml4KTsKICAgIH0KICAgIGxldCB1djJTY2FsZU1hcDsKICAgIGlmIChtYXRlcmlhbC5hb01hcCkgewogICAgICB1djJTY2FsZU1hcCA9IG1hdGVyaWFsLmFvTWFwOwogICAgfSBlbHNlIGlmIChtYXRlcmlhbC5saWdodE1hcCkgewogICAgICB1djJTY2FsZU1hcCA9IG1hdGVyaWFsLmxpZ2h0TWFwOwogICAgfQogICAgaWYgKHV2MlNjYWxlTWFwICE9PSB2b2lkIDApIHsKICAgICAgaWYgKHV2MlNjYWxlTWFwLmlzV2ViR0xSZW5kZXJUYXJnZXQpIHsKICAgICAgICB1djJTY2FsZU1hcCA9IHV2MlNjYWxlTWFwLnRleHR1cmU7CiAgICAgIH0KICAgICAgaWYgKHV2MlNjYWxlTWFwLm1hdHJpeEF1dG9VcGRhdGUgPT09IHRydWUpIHsKICAgICAgICB1djJTY2FsZU1hcC51cGRhdGVNYXRyaXgoKTsKICAgICAgfQogICAgICB1bmlmb3Jtcy51djJUcmFuc2Zvcm0udmFsdWUuY29weSh1djJTY2FsZU1hcC5tYXRyaXgpOwogICAgfQogIH0KICBmdW5jdGlvbiByZWZyZXNoVW5pZm9ybXNMaW5lKHVuaWZvcm1zLCBtYXRlcmlhbCkgewogICAgdW5pZm9ybXMuZGlmZnVzZS52YWx1ZS5jb3B5KG1hdGVyaWFsLmNvbG9yKTsKICAgIHVuaWZvcm1zLm9wYWNpdHkudmFsdWUgPSBtYXRlcmlhbC5vcGFjaXR5OwogIH0KICBmdW5jdGlvbiByZWZyZXNoVW5pZm9ybXNEYXNoKHVuaWZvcm1zLCBtYXRlcmlhbCkgewogICAgdW5pZm9ybXMuZGFzaFNpemUudmFsdWUgPSBtYXRlcmlhbC5kYXNoU2l6ZTsKICAgIHVuaWZvcm1zLnRvdGFsU2l6ZS52YWx1ZSA9IG1hdGVyaWFsLmRhc2hTaXplICsgbWF0ZXJpYWwuZ2FwU2l6ZTsKICAgIHVuaWZvcm1zLnNjYWxlLnZhbHVlID0gbWF0ZXJpYWwuc2NhbGU7CiAgfQogIGZ1bmN0aW9uIHJlZnJlc2hVbmlmb3Jtc1BvaW50cyh1bmlmb3JtcywgbWF0ZXJpYWwsIHBpeGVsUmF0aW8sIGhlaWdodCkgewogICAgdW5pZm9ybXMuZGlmZnVzZS52YWx1ZS5jb3B5KG1hdGVyaWFsLmNvbG9yKTsKICAgIHVuaWZvcm1zLm9wYWNpdHkudmFsdWUgPSBtYXRlcmlhbC5vcGFjaXR5OwogICAgdW5pZm9ybXMuc2l6ZS52YWx1ZSA9IG1hdGVyaWFsLnNpemUgKiBwaXhlbFJhdGlvOwogICAgdW5pZm9ybXMuc2NhbGUudmFsdWUgPSBoZWlnaHQgKiAwLjU7CiAgICBpZiAobWF0ZXJpYWwubWFwKSB7CiAgICAgIHVuaWZvcm1zLm1hcC52YWx1ZSA9IG1hdGVyaWFsLm1hcDsKICAgIH0KICAgIGlmIChtYXRlcmlhbC5hbHBoYU1hcCkgewogICAgICB1bmlmb3Jtcy5hbHBoYU1hcC52YWx1ZSA9IG1hdGVyaWFsLmFscGhhTWFwOwogICAgfQogICAgaWYgKG1hdGVyaWFsLmFscGhhVGVzdCA+IDApIHsKICAgICAgdW5pZm9ybXMuYWxwaGFUZXN0LnZhbHVlID0gbWF0ZXJpYWwuYWxwaGFUZXN0OwogICAgfQogICAgbGV0IHV2U2NhbGVNYXA7CiAgICBpZiAobWF0ZXJpYWwubWFwKSB7CiAgICAgIHV2U2NhbGVNYXAgPSBtYXRlcmlhbC5tYXA7CiAgICB9IGVsc2UgaWYgKG1hdGVyaWFsLmFscGhhTWFwKSB7CiAgICAgIHV2U2NhbGVNYXAgPSBtYXRlcmlhbC5hbHBoYU1hcDsKICAgIH0KICAgIGlmICh1dlNjYWxlTWFwICE9PSB2b2lkIDApIHsKICAgICAgaWYgKHV2U2NhbGVNYXAubWF0cml4QXV0b1VwZGF0ZSA9PT0gdHJ1ZSkgewogICAgICAgIHV2U2NhbGVNYXAudXBkYXRlTWF0cml4KCk7CiAgICAgIH0KICAgICAgdW5pZm9ybXMudXZUcmFuc2Zvcm0udmFsdWUuY29weSh1dlNjYWxlTWFwLm1hdHJpeCk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlZnJlc2hVbmlmb3Jtc1Nwcml0ZXModW5pZm9ybXMsIG1hdGVyaWFsKSB7CiAgICB1bmlmb3Jtcy5kaWZmdXNlLnZhbHVlLmNvcHkobWF0ZXJpYWwuY29sb3IpOwogICAgdW5pZm9ybXMub3BhY2l0eS52YWx1ZSA9IG1hdGVyaWFsLm9wYWNpdHk7CiAgICB1bmlmb3Jtcy5yb3RhdGlvbi52YWx1ZSA9IG1hdGVyaWFsLnJvdGF0aW9uOwogICAgaWYgKG1hdGVyaWFsLm1hcCkgewogICAgICB1bmlmb3Jtcy5tYXAudmFsdWUgPSBtYXRlcmlhbC5tYXA7CiAgICB9CiAgICBpZiAobWF0ZXJpYWwuYWxwaGFNYXApIHsKICAgICAgdW5pZm9ybXMuYWxwaGFNYXAudmFsdWUgPSBtYXRlcmlhbC5hbHBoYU1hcDsKICAgIH0KICAgIGlmIChtYXRlcmlhbC5hbHBoYVRlc3QgPiAwKSB7CiAgICAgIHVuaWZvcm1zLmFscGhhVGVzdC52YWx1ZSA9IG1hdGVyaWFsLmFscGhhVGVzdDsKICAgIH0KICAgIGxldCB1dlNjYWxlTWFwOwogICAgaWYgKG1hdGVyaWFsLm1hcCkgewogICAgICB1dlNjYWxlTWFwID0gbWF0ZXJpYWwubWFwOwogICAgfSBlbHNlIGlmIChtYXRlcmlhbC5hbHBoYU1hcCkgewogICAgICB1dlNjYWxlTWFwID0gbWF0ZXJpYWwuYWxwaGFNYXA7CiAgICB9CiAgICBpZiAodXZTY2FsZU1hcCAhPT0gdm9pZCAwKSB7CiAgICAgIGlmICh1dlNjYWxlTWFwLm1hdHJpeEF1dG9VcGRhdGUgPT09IHRydWUpIHsKICAgICAgICB1dlNjYWxlTWFwLnVwZGF0ZU1hdHJpeCgpOwogICAgICB9CiAgICAgIHVuaWZvcm1zLnV2VHJhbnNmb3JtLnZhbHVlLmNvcHkodXZTY2FsZU1hcC5tYXRyaXgpOwogICAgfQogIH0KICBmdW5jdGlvbiByZWZyZXNoVW5pZm9ybXNMYW1iZXJ0KHVuaWZvcm1zLCBtYXRlcmlhbCkgewogICAgaWYgKG1hdGVyaWFsLmVtaXNzaXZlTWFwKSB7CiAgICAgIHVuaWZvcm1zLmVtaXNzaXZlTWFwLnZhbHVlID0gbWF0ZXJpYWwuZW1pc3NpdmVNYXA7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlZnJlc2hVbmlmb3Jtc1Bob25nKHVuaWZvcm1zLCBtYXRlcmlhbCkgewogICAgdW5pZm9ybXMuc3BlY3VsYXIudmFsdWUuY29weShtYXRlcmlhbC5zcGVjdWxhcik7CiAgICB1bmlmb3Jtcy5zaGluaW5lc3MudmFsdWUgPSBNYXRoLm1heChtYXRlcmlhbC5zaGluaW5lc3MsIDFlLTQpOwogICAgaWYgKG1hdGVyaWFsLmVtaXNzaXZlTWFwKSB7CiAgICAgIHVuaWZvcm1zLmVtaXNzaXZlTWFwLnZhbHVlID0gbWF0ZXJpYWwuZW1pc3NpdmVNYXA7CiAgICB9CiAgICBpZiAobWF0ZXJpYWwuYnVtcE1hcCkgewogICAgICB1bmlmb3Jtcy5idW1wTWFwLnZhbHVlID0gbWF0ZXJpYWwuYnVtcE1hcDsKICAgICAgdW5pZm9ybXMuYnVtcFNjYWxlLnZhbHVlID0gbWF0ZXJpYWwuYnVtcFNjYWxlOwogICAgICBpZiAobWF0ZXJpYWwuc2lkZSA9PT0gQmFja1NpZGUpCiAgICAgICAgdW5pZm9ybXMuYnVtcFNjYWxlLnZhbHVlICo9IC0xOwogICAgfQogICAgaWYgKG1hdGVyaWFsLm5vcm1hbE1hcCkgewogICAgICB1bmlmb3Jtcy5ub3JtYWxNYXAudmFsdWUgPSBtYXRlcmlhbC5ub3JtYWxNYXA7CiAgICAgIHVuaWZvcm1zLm5vcm1hbFNjYWxlLnZhbHVlLmNvcHkobWF0ZXJpYWwubm9ybWFsU2NhbGUpOwogICAgICBpZiAobWF0ZXJpYWwuc2lkZSA9PT0gQmFja1NpZGUpCiAgICAgICAgdW5pZm9ybXMubm9ybWFsU2NhbGUudmFsdWUubmVnYXRlKCk7CiAgICB9CiAgICBpZiAobWF0ZXJpYWwuZGlzcGxhY2VtZW50TWFwKSB7CiAgICAgIHVuaWZvcm1zLmRpc3BsYWNlbWVudE1hcC52YWx1ZSA9IG1hdGVyaWFsLmRpc3BsYWNlbWVudE1hcDsKICAgICAgdW5pZm9ybXMuZGlzcGxhY2VtZW50U2NhbGUudmFsdWUgPSBtYXRlcmlhbC5kaXNwbGFjZW1lbnRTY2FsZTsKICAgICAgdW5pZm9ybXMuZGlzcGxhY2VtZW50Qmlhcy52YWx1ZSA9IG1hdGVyaWFsLmRpc3BsYWNlbWVudEJpYXM7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlZnJlc2hVbmlmb3Jtc1Rvb24odW5pZm9ybXMsIG1hdGVyaWFsKSB7CiAgICBpZiAobWF0ZXJpYWwuZ3JhZGllbnRNYXApIHsKICAgICAgdW5pZm9ybXMuZ3JhZGllbnRNYXAudmFsdWUgPSBtYXRlcmlhbC5ncmFkaWVudE1hcDsKICAgIH0KICAgIGlmIChtYXRlcmlhbC5lbWlzc2l2ZU1hcCkgewogICAgICB1bmlmb3Jtcy5lbWlzc2l2ZU1hcC52YWx1ZSA9IG1hdGVyaWFsLmVtaXNzaXZlTWFwOwogICAgfQogICAgaWYgKG1hdGVyaWFsLmJ1bXBNYXApIHsKICAgICAgdW5pZm9ybXMuYnVtcE1hcC52YWx1ZSA9IG1hdGVyaWFsLmJ1bXBNYXA7CiAgICAgIHVuaWZvcm1zLmJ1bXBTY2FsZS52YWx1ZSA9IG1hdGVyaWFsLmJ1bXBTY2FsZTsKICAgICAgaWYgKG1hdGVyaWFsLnNpZGUgPT09IEJhY2tTaWRlKQogICAgICAgIHVuaWZvcm1zLmJ1bXBTY2FsZS52YWx1ZSAqPSAtMTsKICAgIH0KICAgIGlmIChtYXRlcmlhbC5ub3JtYWxNYXApIHsKICAgICAgdW5pZm9ybXMubm9ybWFsTWFwLnZhbHVlID0gbWF0ZXJpYWwubm9ybWFsTWFwOwogICAgICB1bmlmb3Jtcy5ub3JtYWxTY2FsZS52YWx1ZS5jb3B5KG1hdGVyaWFsLm5vcm1hbFNjYWxlKTsKICAgICAgaWYgKG1hdGVyaWFsLnNpZGUgPT09IEJhY2tTaWRlKQogICAgICAgIHVuaWZvcm1zLm5vcm1hbFNjYWxlLnZhbHVlLm5lZ2F0ZSgpOwogICAgfQogICAgaWYgKG1hdGVyaWFsLmRpc3BsYWNlbWVudE1hcCkgewogICAgICB1bmlmb3Jtcy5kaXNwbGFjZW1lbnRNYXAudmFsdWUgPSBtYXRlcmlhbC5kaXNwbGFjZW1lbnRNYXA7CiAgICAgIHVuaWZvcm1zLmRpc3BsYWNlbWVudFNjYWxlLnZhbHVlID0gbWF0ZXJpYWwuZGlzcGxhY2VtZW50U2NhbGU7CiAgICAgIHVuaWZvcm1zLmRpc3BsYWNlbWVudEJpYXMudmFsdWUgPSBtYXRlcmlhbC5kaXNwbGFjZW1lbnRCaWFzOwogICAgfQogIH0KICBmdW5jdGlvbiByZWZyZXNoVW5pZm9ybXNTdGFuZGFyZCh1bmlmb3JtcywgbWF0ZXJpYWwpIHsKICAgIHVuaWZvcm1zLnJvdWdobmVzcy52YWx1ZSA9IG1hdGVyaWFsLnJvdWdobmVzczsKICAgIHVuaWZvcm1zLm1ldGFsbmVzcy52YWx1ZSA9IG1hdGVyaWFsLm1ldGFsbmVzczsKICAgIGlmIChtYXRlcmlhbC5yb3VnaG5lc3NNYXApIHsKICAgICAgdW5pZm9ybXMucm91Z2huZXNzTWFwLnZhbHVlID0gbWF0ZXJpYWwucm91Z2huZXNzTWFwOwogICAgfQogICAgaWYgKG1hdGVyaWFsLm1ldGFsbmVzc01hcCkgewogICAgICB1bmlmb3Jtcy5tZXRhbG5lc3NNYXAudmFsdWUgPSBtYXRlcmlhbC5tZXRhbG5lc3NNYXA7CiAgICB9CiAgICBpZiAobWF0ZXJpYWwuZW1pc3NpdmVNYXApIHsKICAgICAgdW5pZm9ybXMuZW1pc3NpdmVNYXAudmFsdWUgPSBtYXRlcmlhbC5lbWlzc2l2ZU1hcDsKICAgIH0KICAgIGlmIChtYXRlcmlhbC5idW1wTWFwKSB7CiAgICAgIHVuaWZvcm1zLmJ1bXBNYXAudmFsdWUgPSBtYXRlcmlhbC5idW1wTWFwOwogICAgICB1bmlmb3Jtcy5idW1wU2NhbGUudmFsdWUgPSBtYXRlcmlhbC5idW1wU2NhbGU7CiAgICAgIGlmIChtYXRlcmlhbC5zaWRlID09PSBCYWNrU2lkZSkKICAgICAgICB1bmlmb3Jtcy5idW1wU2NhbGUudmFsdWUgKj0gLTE7CiAgICB9CiAgICBpZiAobWF0ZXJpYWwubm9ybWFsTWFwKSB7CiAgICAgIHVuaWZvcm1zLm5vcm1hbE1hcC52YWx1ZSA9IG1hdGVyaWFsLm5vcm1hbE1hcDsKICAgICAgdW5pZm9ybXMubm9ybWFsU2NhbGUudmFsdWUuY29weShtYXRlcmlhbC5ub3JtYWxTY2FsZSk7CiAgICAgIGlmIChtYXRlcmlhbC5zaWRlID09PSBCYWNrU2lkZSkKICAgICAgICB1bmlmb3Jtcy5ub3JtYWxTY2FsZS52YWx1ZS5uZWdhdGUoKTsKICAgIH0KICAgIGlmIChtYXRlcmlhbC5kaXNwbGFjZW1lbnRNYXApIHsKICAgICAgdW5pZm9ybXMuZGlzcGxhY2VtZW50TWFwLnZhbHVlID0gbWF0ZXJpYWwuZGlzcGxhY2VtZW50TWFwOwogICAgICB1bmlmb3Jtcy5kaXNwbGFjZW1lbnRTY2FsZS52YWx1ZSA9IG1hdGVyaWFsLmRpc3BsYWNlbWVudFNjYWxlOwogICAgICB1bmlmb3Jtcy5kaXNwbGFjZW1lbnRCaWFzLnZhbHVlID0gbWF0ZXJpYWwuZGlzcGxhY2VtZW50QmlhczsKICAgIH0KICAgIGNvbnN0IGVudk1hcCA9IHByb3BlcnRpZXMuZ2V0KG1hdGVyaWFsKS5lbnZNYXA7CiAgICBpZiAoZW52TWFwKSB7CiAgICAgIHVuaWZvcm1zLmVudk1hcEludGVuc2l0eS52YWx1ZSA9IG1hdGVyaWFsLmVudk1hcEludGVuc2l0eTsKICAgIH0KICB9CiAgZnVuY3Rpb24gcmVmcmVzaFVuaWZvcm1zUGh5c2ljYWwodW5pZm9ybXMsIG1hdGVyaWFsLCB0cmFuc21pc3Npb25SZW5kZXJUYXJnZXQpIHsKICAgIHJlZnJlc2hVbmlmb3Jtc1N0YW5kYXJkKHVuaWZvcm1zLCBtYXRlcmlhbCk7CiAgICB1bmlmb3Jtcy5pb3IudmFsdWUgPSBtYXRlcmlhbC5pb3I7CiAgICBpZiAobWF0ZXJpYWwuc2hlZW4gPiAwKSB7CiAgICAgIHVuaWZvcm1zLnNoZWVuQ29sb3IudmFsdWUuY29weShtYXRlcmlhbC5zaGVlbkNvbG9yKS5tdWx0aXBseVNjYWxhcihtYXRlcmlhbC5zaGVlbik7CiAgICAgIHVuaWZvcm1zLnNoZWVuUm91Z2huZXNzLnZhbHVlID0gbWF0ZXJpYWwuc2hlZW5Sb3VnaG5lc3M7CiAgICAgIGlmIChtYXRlcmlhbC5zaGVlbkNvbG9yTWFwKSB7CiAgICAgICAgdW5pZm9ybXMuc2hlZW5Db2xvck1hcC52YWx1ZSA9IG1hdGVyaWFsLnNoZWVuQ29sb3JNYXA7CiAgICAgIH0KICAgICAgaWYgKG1hdGVyaWFsLnNoZWVuUm91Z2huZXNzTWFwKSB7CiAgICAgICAgdW5pZm9ybXMuc2hlZW5Sb3VnaG5lc3NNYXAudmFsdWUgPSBtYXRlcmlhbC5zaGVlblJvdWdobmVzc01hcDsKICAgICAgfQogICAgfQogICAgaWYgKG1hdGVyaWFsLmNsZWFyY29hdCA+IDApIHsKICAgICAgdW5pZm9ybXMuY2xlYXJjb2F0LnZhbHVlID0gbWF0ZXJpYWwuY2xlYXJjb2F0OwogICAgICB1bmlmb3Jtcy5jbGVhcmNvYXRSb3VnaG5lc3MudmFsdWUgPSBtYXRlcmlhbC5jbGVhcmNvYXRSb3VnaG5lc3M7CiAgICAgIGlmIChtYXRlcmlhbC5jbGVhcmNvYXRNYXApIHsKICAgICAgICB1bmlmb3Jtcy5jbGVhcmNvYXRNYXAudmFsdWUgPSBtYXRlcmlhbC5jbGVhcmNvYXRNYXA7CiAgICAgIH0KICAgICAgaWYgKG1hdGVyaWFsLmNsZWFyY29hdFJvdWdobmVzc01hcCkgewogICAgICAgIHVuaWZvcm1zLmNsZWFyY29hdFJvdWdobmVzc01hcC52YWx1ZSA9IG1hdGVyaWFsLmNsZWFyY29hdFJvdWdobmVzc01hcDsKICAgICAgfQogICAgICBpZiAobWF0ZXJpYWwuY2xlYXJjb2F0Tm9ybWFsTWFwKSB7CiAgICAgICAgdW5pZm9ybXMuY2xlYXJjb2F0Tm9ybWFsU2NhbGUudmFsdWUuY29weShtYXRlcmlhbC5jbGVhcmNvYXROb3JtYWxTY2FsZSk7CiAgICAgICAgdW5pZm9ybXMuY2xlYXJjb2F0Tm9ybWFsTWFwLnZhbHVlID0gbWF0ZXJpYWwuY2xlYXJjb2F0Tm9ybWFsTWFwOwogICAgICAgIGlmIChtYXRlcmlhbC5zaWRlID09PSBCYWNrU2lkZSkgewogICAgICAgICAgdW5pZm9ybXMuY2xlYXJjb2F0Tm9ybWFsU2NhbGUudmFsdWUubmVnYXRlKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAobWF0ZXJpYWwudHJhbnNtaXNzaW9uID4gMCkgewogICAgICB1bmlmb3Jtcy50cmFuc21pc3Npb24udmFsdWUgPSBtYXRlcmlhbC50cmFuc21pc3Npb247CiAgICAgIHVuaWZvcm1zLnRyYW5zbWlzc2lvblNhbXBsZXJNYXAudmFsdWUgPSB0cmFuc21pc3Npb25SZW5kZXJUYXJnZXQudGV4dHVyZTsKICAgICAgdW5pZm9ybXMudHJhbnNtaXNzaW9uU2FtcGxlclNpemUudmFsdWUuc2V0KHRyYW5zbWlzc2lvblJlbmRlclRhcmdldC53aWR0aCwgdHJhbnNtaXNzaW9uUmVuZGVyVGFyZ2V0LmhlaWdodCk7CiAgICAgIGlmIChtYXRlcmlhbC50cmFuc21pc3Npb25NYXApIHsKICAgICAgICB1bmlmb3Jtcy50cmFuc21pc3Npb25NYXAudmFsdWUgPSBtYXRlcmlhbC50cmFuc21pc3Npb25NYXA7CiAgICAgIH0KICAgICAgdW5pZm9ybXMudGhpY2tuZXNzLnZhbHVlID0gbWF0ZXJpYWwudGhpY2tuZXNzOwogICAgICBpZiAobWF0ZXJpYWwudGhpY2tuZXNzTWFwKSB7CiAgICAgICAgdW5pZm9ybXMudGhpY2tuZXNzTWFwLnZhbHVlID0gbWF0ZXJpYWwudGhpY2tuZXNzTWFwOwogICAgICB9CiAgICAgIHVuaWZvcm1zLmF0dGVudWF0aW9uRGlzdGFuY2UudmFsdWUgPSBtYXRlcmlhbC5hdHRlbnVhdGlvbkRpc3RhbmNlOwogICAgICB1bmlmb3Jtcy5hdHRlbnVhdGlvbkNvbG9yLnZhbHVlLmNvcHkobWF0ZXJpYWwuYXR0ZW51YXRpb25Db2xvcik7CiAgICB9CiAgICB1bmlmb3Jtcy5zcGVjdWxhckludGVuc2l0eS52YWx1ZSA9IG1hdGVyaWFsLnNwZWN1bGFySW50ZW5zaXR5OwogICAgdW5pZm9ybXMuc3BlY3VsYXJDb2xvci52YWx1ZS5jb3B5KG1hdGVyaWFsLnNwZWN1bGFyQ29sb3IpOwogICAgaWYgKG1hdGVyaWFsLnNwZWN1bGFySW50ZW5zaXR5TWFwKSB7CiAgICAgIHVuaWZvcm1zLnNwZWN1bGFySW50ZW5zaXR5TWFwLnZhbHVlID0gbWF0ZXJpYWwuc3BlY3VsYXJJbnRlbnNpdHlNYXA7CiAgICB9CiAgICBpZiAobWF0ZXJpYWwuc3BlY3VsYXJDb2xvck1hcCkgewogICAgICB1bmlmb3Jtcy5zcGVjdWxhckNvbG9yTWFwLnZhbHVlID0gbWF0ZXJpYWwuc3BlY3VsYXJDb2xvck1hcDsKICAgIH0KICB9CiAgZnVuY3Rpb24gcmVmcmVzaFVuaWZvcm1zTWF0Y2FwKHVuaWZvcm1zLCBtYXRlcmlhbCkgewogICAgaWYgKG1hdGVyaWFsLm1hdGNhcCkgewogICAgICB1bmlmb3Jtcy5tYXRjYXAudmFsdWUgPSBtYXRlcmlhbC5tYXRjYXA7CiAgICB9CiAgICBpZiAobWF0ZXJpYWwuYnVtcE1hcCkgewogICAgICB1bmlmb3Jtcy5idW1wTWFwLnZhbHVlID0gbWF0ZXJpYWwuYnVtcE1hcDsKICAgICAgdW5pZm9ybXMuYnVtcFNjYWxlLnZhbHVlID0gbWF0ZXJpYWwuYnVtcFNjYWxlOwogICAgICBpZiAobWF0ZXJpYWwuc2lkZSA9PT0gQmFja1NpZGUpCiAgICAgICAgdW5pZm9ybXMuYnVtcFNjYWxlLnZhbHVlICo9IC0xOwogICAgfQogICAgaWYgKG1hdGVyaWFsLm5vcm1hbE1hcCkgewogICAgICB1bmlmb3Jtcy5ub3JtYWxNYXAudmFsdWUgPSBtYXRlcmlhbC5ub3JtYWxNYXA7CiAgICAgIHVuaWZvcm1zLm5vcm1hbFNjYWxlLnZhbHVlLmNvcHkobWF0ZXJpYWwubm9ybWFsU2NhbGUpOwogICAgICBpZiAobWF0ZXJpYWwuc2lkZSA9PT0gQmFja1NpZGUpCiAgICAgICAgdW5pZm9ybXMubm9ybWFsU2NhbGUudmFsdWUubmVnYXRlKCk7CiAgICB9CiAgICBpZiAobWF0ZXJpYWwuZGlzcGxhY2VtZW50TWFwKSB7CiAgICAgIHVuaWZvcm1zLmRpc3BsYWNlbWVudE1hcC52YWx1ZSA9IG1hdGVyaWFsLmRpc3BsYWNlbWVudE1hcDsKICAgICAgdW5pZm9ybXMuZGlzcGxhY2VtZW50U2NhbGUudmFsdWUgPSBtYXRlcmlhbC5kaXNwbGFjZW1lbnRTY2FsZTsKICAgICAgdW5pZm9ybXMuZGlzcGxhY2VtZW50Qmlhcy52YWx1ZSA9IG1hdGVyaWFsLmRpc3BsYWNlbWVudEJpYXM7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlZnJlc2hVbmlmb3Jtc0RlcHRoKHVuaWZvcm1zLCBtYXRlcmlhbCkgewogICAgaWYgKG1hdGVyaWFsLmRpc3BsYWNlbWVudE1hcCkgewogICAgICB1bmlmb3Jtcy5kaXNwbGFjZW1lbnRNYXAudmFsdWUgPSBtYXRlcmlhbC5kaXNwbGFjZW1lbnRNYXA7CiAgICAgIHVuaWZvcm1zLmRpc3BsYWNlbWVudFNjYWxlLnZhbHVlID0gbWF0ZXJpYWwuZGlzcGxhY2VtZW50U2NhbGU7CiAgICAgIHVuaWZvcm1zLmRpc3BsYWNlbWVudEJpYXMudmFsdWUgPSBtYXRlcmlhbC5kaXNwbGFjZW1lbnRCaWFzOwogICAgfQogIH0KICBmdW5jdGlvbiByZWZyZXNoVW5pZm9ybXNEaXN0YW5jZSh1bmlmb3JtcywgbWF0ZXJpYWwpIHsKICAgIGlmIChtYXRlcmlhbC5kaXNwbGFjZW1lbnRNYXApIHsKICAgICAgdW5pZm9ybXMuZGlzcGxhY2VtZW50TWFwLnZhbHVlID0gbWF0ZXJpYWwuZGlzcGxhY2VtZW50TWFwOwogICAgICB1bmlmb3Jtcy5kaXNwbGFjZW1lbnRTY2FsZS52YWx1ZSA9IG1hdGVyaWFsLmRpc3BsYWNlbWVudFNjYWxlOwogICAgICB1bmlmb3Jtcy5kaXNwbGFjZW1lbnRCaWFzLnZhbHVlID0gbWF0ZXJpYWwuZGlzcGxhY2VtZW50QmlhczsKICAgIH0KICAgIHVuaWZvcm1zLnJlZmVyZW5jZVBvc2l0aW9uLnZhbHVlLmNvcHkobWF0ZXJpYWwucmVmZXJlbmNlUG9zaXRpb24pOwogICAgdW5pZm9ybXMubmVhckRpc3RhbmNlLnZhbHVlID0gbWF0ZXJpYWwubmVhckRpc3RhbmNlOwogICAgdW5pZm9ybXMuZmFyRGlzdGFuY2UudmFsdWUgPSBtYXRlcmlhbC5mYXJEaXN0YW5jZTsKICB9CiAgZnVuY3Rpb24gcmVmcmVzaFVuaWZvcm1zTm9ybWFsKHVuaWZvcm1zLCBtYXRlcmlhbCkgewogICAgaWYgKG1hdGVyaWFsLmJ1bXBNYXApIHsKICAgICAgdW5pZm9ybXMuYnVtcE1hcC52YWx1ZSA9IG1hdGVyaWFsLmJ1bXBNYXA7CiAgICAgIHVuaWZvcm1zLmJ1bXBTY2FsZS52YWx1ZSA9IG1hdGVyaWFsLmJ1bXBTY2FsZTsKICAgICAgaWYgKG1hdGVyaWFsLnNpZGUgPT09IEJhY2tTaWRlKQogICAgICAgIHVuaWZvcm1zLmJ1bXBTY2FsZS52YWx1ZSAqPSAtMTsKICAgIH0KICAgIGlmIChtYXRlcmlhbC5ub3JtYWxNYXApIHsKICAgICAgdW5pZm9ybXMubm9ybWFsTWFwLnZhbHVlID0gbWF0ZXJpYWwubm9ybWFsTWFwOwogICAgICB1bmlmb3Jtcy5ub3JtYWxTY2FsZS52YWx1ZS5jb3B5KG1hdGVyaWFsLm5vcm1hbFNjYWxlKTsKICAgICAgaWYgKG1hdGVyaWFsLnNpZGUgPT09IEJhY2tTaWRlKQogICAgICAgIHVuaWZvcm1zLm5vcm1hbFNjYWxlLnZhbHVlLm5lZ2F0ZSgpOwogICAgfQogICAgaWYgKG1hdGVyaWFsLmRpc3BsYWNlbWVudE1hcCkgewogICAgICB1bmlmb3Jtcy5kaXNwbGFjZW1lbnRNYXAudmFsdWUgPSBtYXRlcmlhbC5kaXNwbGFjZW1lbnRNYXA7CiAgICAgIHVuaWZvcm1zLmRpc3BsYWNlbWVudFNjYWxlLnZhbHVlID0gbWF0ZXJpYWwuZGlzcGxhY2VtZW50U2NhbGU7CiAgICAgIHVuaWZvcm1zLmRpc3BsYWNlbWVudEJpYXMudmFsdWUgPSBtYXRlcmlhbC5kaXNwbGFjZW1lbnRCaWFzOwogICAgfQogIH0KICByZXR1cm4gewogICAgcmVmcmVzaEZvZ1VuaWZvcm1zLAogICAgcmVmcmVzaE1hdGVyaWFsVW5pZm9ybXMKICB9Owp9CmZ1bmN0aW9uIGNyZWF0ZUNhbnZhc0VsZW1lbnQoKSB7CiAgY29uc3QgY2FudmFzID0gY3JlYXRlRWxlbWVudE5TKCJjYW52YXMiKTsKICBjYW52YXMuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgcmV0dXJuIGNhbnZhczsKfQpmdW5jdGlvbiBXZWJHTFJlbmRlcmVyKHBhcmFtZXRlcnMgPSB7fSkgewogIGNvbnN0IF9jYW52YXMyID0gcGFyYW1ldGVycy5jYW52YXMgIT09IHZvaWQgMCA/IHBhcmFtZXRlcnMuY2FudmFzIDogY3JlYXRlQ2FudmFzRWxlbWVudCgpLCBfY29udGV4dDIgPSBwYXJhbWV0ZXJzLmNvbnRleHQgIT09IHZvaWQgMCA/IHBhcmFtZXRlcnMuY29udGV4dCA6IG51bGwsIF9hbHBoYSA9IHBhcmFtZXRlcnMuYWxwaGEgIT09IHZvaWQgMCA/IHBhcmFtZXRlcnMuYWxwaGEgOiBmYWxzZSwgX2RlcHRoID0gcGFyYW1ldGVycy5kZXB0aCAhPT0gdm9pZCAwID8gcGFyYW1ldGVycy5kZXB0aCA6IHRydWUsIF9zdGVuY2lsID0gcGFyYW1ldGVycy5zdGVuY2lsICE9PSB2b2lkIDAgPyBwYXJhbWV0ZXJzLnN0ZW5jaWwgOiB0cnVlLCBfYW50aWFsaWFzID0gcGFyYW1ldGVycy5hbnRpYWxpYXMgIT09IHZvaWQgMCA/IHBhcmFtZXRlcnMuYW50aWFsaWFzIDogZmFsc2UsIF9wcmVtdWx0aXBsaWVkQWxwaGEgPSBwYXJhbWV0ZXJzLnByZW11bHRpcGxpZWRBbHBoYSAhPT0gdm9pZCAwID8gcGFyYW1ldGVycy5wcmVtdWx0aXBsaWVkQWxwaGEgOiB0cnVlLCBfcHJlc2VydmVEcmF3aW5nQnVmZmVyID0gcGFyYW1ldGVycy5wcmVzZXJ2ZURyYXdpbmdCdWZmZXIgIT09IHZvaWQgMCA/IHBhcmFtZXRlcnMucHJlc2VydmVEcmF3aW5nQnVmZmVyIDogZmFsc2UsIF9wb3dlclByZWZlcmVuY2UgPSBwYXJhbWV0ZXJzLnBvd2VyUHJlZmVyZW5jZSAhPT0gdm9pZCAwID8gcGFyYW1ldGVycy5wb3dlclByZWZlcmVuY2UgOiAiZGVmYXVsdCIsIF9mYWlsSWZNYWpvclBlcmZvcm1hbmNlQ2F2ZWF0ID0gcGFyYW1ldGVycy5mYWlsSWZNYWpvclBlcmZvcm1hbmNlQ2F2ZWF0ICE9PSB2b2lkIDAgPyBwYXJhbWV0ZXJzLmZhaWxJZk1ham9yUGVyZm9ybWFuY2VDYXZlYXQgOiBmYWxzZTsKICBsZXQgY3VycmVudFJlbmRlckxpc3QgPSBudWxsOwogIGxldCBjdXJyZW50UmVuZGVyU3RhdGUgPSBudWxsOwogIGNvbnN0IHJlbmRlckxpc3RTdGFjayA9IFtdOwogIGNvbnN0IHJlbmRlclN0YXRlU3RhY2sgPSBbXTsKICB0aGlzLmRvbUVsZW1lbnQgPSBfY2FudmFzMjsKICB0aGlzLmRlYnVnID0gewogICAgY2hlY2tTaGFkZXJFcnJvcnM6IHRydWUKICB9OwogIHRoaXMuYXV0b0NsZWFyID0gdHJ1ZTsKICB0aGlzLmF1dG9DbGVhckNvbG9yID0gdHJ1ZTsKICB0aGlzLmF1dG9DbGVhckRlcHRoID0gdHJ1ZTsKICB0aGlzLmF1dG9DbGVhclN0ZW5jaWwgPSB0cnVlOwogIHRoaXMuc29ydE9iamVjdHMgPSB0cnVlOwogIHRoaXMuY2xpcHBpbmdQbGFuZXMgPSBbXTsKICB0aGlzLmxvY2FsQ2xpcHBpbmdFbmFibGVkID0gZmFsc2U7CiAgdGhpcy5vdXRwdXRFbmNvZGluZyA9IExpbmVhckVuY29kaW5nOwogIHRoaXMucGh5c2ljYWxseUNvcnJlY3RMaWdodHMgPSBmYWxzZTsKICB0aGlzLnRvbmVNYXBwaW5nID0gTm9Ub25lTWFwcGluZzsKICB0aGlzLnRvbmVNYXBwaW5nRXhwb3N1cmUgPSAxOwogIGNvbnN0IF90aGlzID0gdGhpczsKICBsZXQgX2lzQ29udGV4dExvc3QgPSBmYWxzZTsKICBsZXQgX2N1cnJlbnRBY3RpdmVDdWJlRmFjZSA9IDA7CiAgbGV0IF9jdXJyZW50QWN0aXZlTWlwbWFwTGV2ZWwgPSAwOwogIGxldCBfY3VycmVudFJlbmRlclRhcmdldCA9IG51bGw7CiAgbGV0IF9jdXJyZW50TWF0ZXJpYWxJZCA9IC0xOwogIGxldCBfY3VycmVudENhbWVyYSA9IG51bGw7CiAgY29uc3QgX2N1cnJlbnRWaWV3cG9ydCA9IG5ldyBWZWN0b3I0KCk7CiAgY29uc3QgX2N1cnJlbnRTY2lzc29yID0gbmV3IFZlY3RvcjQoKTsKICBsZXQgX2N1cnJlbnRTY2lzc29yVGVzdCA9IG51bGw7CiAgbGV0IF93aWR0aCA9IF9jYW52YXMyLndpZHRoOwogIGxldCBfaGVpZ2h0ID0gX2NhbnZhczIuaGVpZ2h0OwogIGxldCBfcGl4ZWxSYXRpbyA9IDE7CiAgbGV0IF9vcGFxdWVTb3J0ID0gbnVsbDsKICBsZXQgX3RyYW5zcGFyZW50U29ydCA9IG51bGw7CiAgY29uc3QgX3ZpZXdwb3J0ID0gbmV3IFZlY3RvcjQoMCwgMCwgX3dpZHRoLCBfaGVpZ2h0KTsKICBjb25zdCBfc2Npc3NvciA9IG5ldyBWZWN0b3I0KDAsIDAsIF93aWR0aCwgX2hlaWdodCk7CiAgbGV0IF9zY2lzc29yVGVzdCA9IGZhbHNlOwogIGNvbnN0IF9mcnVzdHVtID0gbmV3IEZydXN0dW0oKTsKICBsZXQgX2NsaXBwaW5nRW5hYmxlZCA9IGZhbHNlOwogIGxldCBfbG9jYWxDbGlwcGluZ0VuYWJsZWQgPSBmYWxzZTsKICBsZXQgX3RyYW5zbWlzc2lvblJlbmRlclRhcmdldCA9IG51bGw7CiAgY29uc3QgX3Byb2pTY3JlZW5NYXRyaXgyID0gbmV3IE1hdHJpeDQoKTsKICBjb25zdCBfdmVjdG9yMyA9IG5ldyBWZWN0b3IzKCk7CiAgY29uc3QgX2VtcHR5U2NlbmUgPSB7IGJhY2tncm91bmQ6IG51bGwsIGZvZzogbnVsbCwgZW52aXJvbm1lbnQ6IG51bGwsIG92ZXJyaWRlTWF0ZXJpYWw6IG51bGwsIGlzU2NlbmU6IHRydWUgfTsKICBmdW5jdGlvbiBnZXRUYXJnZXRQaXhlbFJhdGlvKCkgewogICAgcmV0dXJuIF9jdXJyZW50UmVuZGVyVGFyZ2V0ID09PSBudWxsID8gX3BpeGVsUmF0aW8gOiAxOwogIH0KICBsZXQgX2dsID0gX2NvbnRleHQyOwogIGZ1bmN0aW9uIGdldENvbnRleHQoY29udGV4dE5hbWVzLCBjb250ZXh0QXR0cmlidXRlcykgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb250ZXh0TmFtZXMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgY29udGV4dE5hbWUgPSBjb250ZXh0TmFtZXNbaV07CiAgICAgIGNvbnN0IGNvbnRleHQgPSBfY2FudmFzMi5nZXRDb250ZXh0KGNvbnRleHROYW1lLCBjb250ZXh0QXR0cmlidXRlcyk7CiAgICAgIGlmIChjb250ZXh0ICE9PSBudWxsKQogICAgICAgIHJldHVybiBjb250ZXh0OwogICAgfQogICAgcmV0dXJuIG51bGw7CiAgfQogIHRyeSB7CiAgICBjb25zdCBjb250ZXh0QXR0cmlidXRlcyA9IHsKICAgICAgYWxwaGE6IHRydWUsCiAgICAgIGRlcHRoOiBfZGVwdGgsCiAgICAgIHN0ZW5jaWw6IF9zdGVuY2lsLAogICAgICBhbnRpYWxpYXM6IF9hbnRpYWxpYXMsCiAgICAgIHByZW11bHRpcGxpZWRBbHBoYTogX3ByZW11bHRpcGxpZWRBbHBoYSwKICAgICAgcHJlc2VydmVEcmF3aW5nQnVmZmVyOiBfcHJlc2VydmVEcmF3aW5nQnVmZmVyLAogICAgICBwb3dlclByZWZlcmVuY2U6IF9wb3dlclByZWZlcmVuY2UsCiAgICAgIGZhaWxJZk1ham9yUGVyZm9ybWFuY2VDYXZlYXQ6IF9mYWlsSWZNYWpvclBlcmZvcm1hbmNlQ2F2ZWF0CiAgICB9OwogICAgaWYgKCJzZXRBdHRyaWJ1dGUiIGluIF9jYW52YXMyKQogICAgICBfY2FudmFzMi5zZXRBdHRyaWJ1dGUoImRhdGEtZW5naW5lIiwgYHRocmVlLmpzIHIke1JFVklTSU9OfWApOwogICAgX2NhbnZhczIuYWRkRXZlbnRMaXN0ZW5lcigid2ViZ2xjb250ZXh0bG9zdCIsIG9uQ29udGV4dExvc3QsIGZhbHNlKTsKICAgIF9jYW52YXMyLmFkZEV2ZW50TGlzdGVuZXIoIndlYmdsY29udGV4dHJlc3RvcmVkIiwgb25Db250ZXh0UmVzdG9yZSwgZmFsc2UpOwogICAgaWYgKF9nbCA9PT0gbnVsbCkgewogICAgICBjb25zdCBjb250ZXh0TmFtZXMgPSBbIndlYmdsMiIsICJ3ZWJnbCIsICJleHBlcmltZW50YWwtd2ViZ2wiXTsKICAgICAgaWYgKF90aGlzLmlzV2ViR0wxUmVuZGVyZXIgPT09IHRydWUpIHsKICAgICAgICBjb250ZXh0TmFtZXMuc2hpZnQoKTsKICAgICAgfQogICAgICBfZ2wgPSBnZXRDb250ZXh0KGNvbnRleHROYW1lcywgY29udGV4dEF0dHJpYnV0ZXMpOwogICAgICBpZiAoX2dsID09PSBudWxsKSB7CiAgICAgICAgaWYgKGdldENvbnRleHQoY29udGV4dE5hbWVzKSkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJFcnJvciBjcmVhdGluZyBXZWJHTCBjb250ZXh0IHdpdGggeW91ciBzZWxlY3RlZCBhdHRyaWJ1dGVzLiIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkVycm9yIGNyZWF0aW5nIFdlYkdMIGNvbnRleHQuIik7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAoX2dsLmdldFNoYWRlclByZWNpc2lvbkZvcm1hdCA9PT0gdm9pZCAwKSB7CiAgICAgIF9nbC5nZXRTaGFkZXJQcmVjaXNpb25Gb3JtYXQgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4geyAicmFuZ2VNaW4iOiAxLCAicmFuZ2VNYXgiOiAxLCAicHJlY2lzaW9uIjogMSB9OwogICAgICB9OwogICAgfQogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAiICsgZXJyb3IubWVzc2FnZSk7CiAgICB0aHJvdyBlcnJvcjsKICB9CiAgbGV0IGV4dGVuc2lvbnMsIGNhcGFiaWxpdGllcywgc3RhdGUsIGluZm87CiAgbGV0IHByb3BlcnRpZXMsIHRleHR1cmVzLCBjdWJlbWFwcywgY3ViZXV2bWFwcywgYXR0cmlidXRlcywgZ2VvbWV0cmllcywgb2JqZWN0czsKICBsZXQgcHJvZ3JhbUNhY2hlLCBtYXRlcmlhbHMsIHJlbmRlckxpc3RzLCByZW5kZXJTdGF0ZXMsIGNsaXBwaW5nLCBzaGFkb3dNYXA7CiAgbGV0IGJhY2tncm91bmQsIG1vcnBodGFyZ2V0cywgYnVmZmVyUmVuZGVyZXIsIGluZGV4ZWRCdWZmZXJSZW5kZXJlcjsKICBsZXQgdXRpbHMsIGJpbmRpbmdTdGF0ZXM7CiAgZnVuY3Rpb24gaW5pdEdMQ29udGV4dCgpIHsKICAgIGV4dGVuc2lvbnMgPSBuZXcgV2ViR0xFeHRlbnNpb25zKF9nbCk7CiAgICBjYXBhYmlsaXRpZXMgPSBuZXcgV2ViR0xDYXBhYmlsaXRpZXMoX2dsLCBleHRlbnNpb25zLCBwYXJhbWV0ZXJzKTsKICAgIGV4dGVuc2lvbnMuaW5pdChjYXBhYmlsaXRpZXMpOwogICAgdXRpbHMgPSBuZXcgV2ViR0xVdGlscyhfZ2wsIGV4dGVuc2lvbnMsIGNhcGFiaWxpdGllcyk7CiAgICBzdGF0ZSA9IG5ldyBXZWJHTFN0YXRlKF9nbCwgZXh0ZW5zaW9ucywgY2FwYWJpbGl0aWVzKTsKICAgIGluZm8gPSBuZXcgV2ViR0xJbmZvKF9nbCk7CiAgICBwcm9wZXJ0aWVzID0gbmV3IFdlYkdMUHJvcGVydGllcygpOwogICAgdGV4dHVyZXMgPSBuZXcgV2ViR0xUZXh0dXJlcyhfZ2wsIGV4dGVuc2lvbnMsIHN0YXRlLCBwcm9wZXJ0aWVzLCBjYXBhYmlsaXRpZXMsIHV0aWxzLCBpbmZvKTsKICAgIGN1YmVtYXBzID0gbmV3IFdlYkdMQ3ViZU1hcHMoX3RoaXMpOwogICAgY3ViZXV2bWFwcyA9IG5ldyBXZWJHTEN1YmVVVk1hcHMoX3RoaXMpOwogICAgYXR0cmlidXRlcyA9IG5ldyBXZWJHTEF0dHJpYnV0ZXMoX2dsLCBjYXBhYmlsaXRpZXMpOwogICAgYmluZGluZ1N0YXRlcyA9IG5ldyBXZWJHTEJpbmRpbmdTdGF0ZXMoX2dsLCBleHRlbnNpb25zLCBhdHRyaWJ1dGVzLCBjYXBhYmlsaXRpZXMpOwogICAgZ2VvbWV0cmllcyA9IG5ldyBXZWJHTEdlb21ldHJpZXMoX2dsLCBhdHRyaWJ1dGVzLCBpbmZvLCBiaW5kaW5nU3RhdGVzKTsKICAgIG9iamVjdHMgPSBuZXcgV2ViR0xPYmplY3RzKF9nbCwgZ2VvbWV0cmllcywgYXR0cmlidXRlcywgaW5mbyk7CiAgICBtb3JwaHRhcmdldHMgPSBuZXcgV2ViR0xNb3JwaHRhcmdldHMoX2dsLCBjYXBhYmlsaXRpZXMsIHRleHR1cmVzKTsKICAgIGNsaXBwaW5nID0gbmV3IFdlYkdMQ2xpcHBpbmcocHJvcGVydGllcyk7CiAgICBwcm9ncmFtQ2FjaGUgPSBuZXcgV2ViR0xQcm9ncmFtcyhfdGhpcywgY3ViZW1hcHMsIGN1YmV1dm1hcHMsIGV4dGVuc2lvbnMsIGNhcGFiaWxpdGllcywgYmluZGluZ1N0YXRlcywgY2xpcHBpbmcpOwogICAgbWF0ZXJpYWxzID0gbmV3IFdlYkdMTWF0ZXJpYWxzKHByb3BlcnRpZXMpOwogICAgcmVuZGVyTGlzdHMgPSBuZXcgV2ViR0xSZW5kZXJMaXN0cygpOwogICAgcmVuZGVyU3RhdGVzID0gbmV3IFdlYkdMUmVuZGVyU3RhdGVzKGV4dGVuc2lvbnMsIGNhcGFiaWxpdGllcyk7CiAgICBiYWNrZ3JvdW5kID0gbmV3IFdlYkdMQmFja2dyb3VuZChfdGhpcywgY3ViZW1hcHMsIHN0YXRlLCBvYmplY3RzLCBfYWxwaGEsIF9wcmVtdWx0aXBsaWVkQWxwaGEpOwogICAgc2hhZG93TWFwID0gbmV3IFdlYkdMU2hhZG93TWFwKF90aGlzLCBvYmplY3RzLCBjYXBhYmlsaXRpZXMpOwogICAgYnVmZmVyUmVuZGVyZXIgPSBuZXcgV2ViR0xCdWZmZXJSZW5kZXJlcihfZ2wsIGV4dGVuc2lvbnMsIGluZm8sIGNhcGFiaWxpdGllcyk7CiAgICBpbmRleGVkQnVmZmVyUmVuZGVyZXIgPSBuZXcgV2ViR0xJbmRleGVkQnVmZmVyUmVuZGVyZXIoX2dsLCBleHRlbnNpb25zLCBpbmZvLCBjYXBhYmlsaXRpZXMpOwogICAgaW5mby5wcm9ncmFtcyA9IHByb2dyYW1DYWNoZS5wcm9ncmFtczsKICAgIF90aGlzLmNhcGFiaWxpdGllcyA9IGNhcGFiaWxpdGllczsKICAgIF90aGlzLmV4dGVuc2lvbnMgPSBleHRlbnNpb25zOwogICAgX3RoaXMucHJvcGVydGllcyA9IHByb3BlcnRpZXM7CiAgICBfdGhpcy5yZW5kZXJMaXN0cyA9IHJlbmRlckxpc3RzOwogICAgX3RoaXMuc2hhZG93TWFwID0gc2hhZG93TWFwOwogICAgX3RoaXMuc3RhdGUgPSBzdGF0ZTsKICAgIF90aGlzLmluZm8gPSBpbmZvOwogIH0KICBpbml0R0xDb250ZXh0KCk7CiAgY29uc3QgeHIgPSBuZXcgV2ViWFJNYW5hZ2VyKF90aGlzLCBfZ2wpOwogIHRoaXMueHIgPSB4cjsKICB0aGlzLmdldENvbnRleHQgPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiBfZ2w7CiAgfTsKICB0aGlzLmdldENvbnRleHRBdHRyaWJ1dGVzID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gX2dsLmdldENvbnRleHRBdHRyaWJ1dGVzKCk7CiAgfTsKICB0aGlzLmZvcmNlQ29udGV4dExvc3MgPSBmdW5jdGlvbigpIHsKICAgIGNvbnN0IGV4dGVuc2lvbiA9IGV4dGVuc2lvbnMuZ2V0KCJXRUJHTF9sb3NlX2NvbnRleHQiKTsKICAgIGlmIChleHRlbnNpb24pCiAgICAgIGV4dGVuc2lvbi5sb3NlQ29udGV4dCgpOwogIH07CiAgdGhpcy5mb3JjZUNvbnRleHRSZXN0b3JlID0gZnVuY3Rpb24oKSB7CiAgICBjb25zdCBleHRlbnNpb24gPSBleHRlbnNpb25zLmdldCgiV0VCR0xfbG9zZV9jb250ZXh0Iik7CiAgICBpZiAoZXh0ZW5zaW9uKQogICAgICBleHRlbnNpb24ucmVzdG9yZUNvbnRleHQoKTsKICB9OwogIHRoaXMuZ2V0UGl4ZWxSYXRpbyA9IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIF9waXhlbFJhdGlvOwogIH07CiAgdGhpcy5zZXRQaXhlbFJhdGlvID0gZnVuY3Rpb24odmFsdWUpIHsKICAgIGlmICh2YWx1ZSA9PT0gdm9pZCAwKQogICAgICByZXR1cm47CiAgICBfcGl4ZWxSYXRpbyA9IHZhbHVlOwogICAgdGhpcy5zZXRTaXplKF93aWR0aCwgX2hlaWdodCwgZmFsc2UpOwogIH07CiAgdGhpcy5nZXRTaXplID0gZnVuY3Rpb24odGFyZ2V0KSB7CiAgICByZXR1cm4gdGFyZ2V0LnNldChfd2lkdGgsIF9oZWlnaHQpOwogIH07CiAgdGhpcy5zZXRTaXplID0gZnVuY3Rpb24od2lkdGgsIGhlaWdodCwgdXBkYXRlU3R5bGUpIHsKICAgIGlmICh4ci5pc1ByZXNlbnRpbmcpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiBDYW4ndCBjaGFuZ2Ugc2l6ZSB3aGlsZSBWUiBkZXZpY2UgaXMgcHJlc2VudGluZy4iKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgX3dpZHRoID0gd2lkdGg7CiAgICBfaGVpZ2h0ID0gaGVpZ2h0OwogICAgX2NhbnZhczIud2lkdGggPSBNYXRoLmZsb29yKHdpZHRoICogX3BpeGVsUmF0aW8pOwogICAgX2NhbnZhczIuaGVpZ2h0ID0gTWF0aC5mbG9vcihoZWlnaHQgKiBfcGl4ZWxSYXRpbyk7CiAgICBpZiAodXBkYXRlU3R5bGUgIT09IGZhbHNlKSB7CiAgICAgIF9jYW52YXMyLnN0eWxlLndpZHRoID0gd2lkdGggKyAicHgiOwogICAgICBfY2FudmFzMi5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyAicHgiOwogICAgfQogICAgdGhpcy5zZXRWaWV3cG9ydCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICB9OwogIHRoaXMuZ2V0RHJhd2luZ0J1ZmZlclNpemUgPSBmdW5jdGlvbih0YXJnZXQpIHsKICAgIHJldHVybiB0YXJnZXQuc2V0KF93aWR0aCAqIF9waXhlbFJhdGlvLCBfaGVpZ2h0ICogX3BpeGVsUmF0aW8pLmZsb29yKCk7CiAgfTsKICB0aGlzLnNldERyYXdpbmdCdWZmZXJTaXplID0gZnVuY3Rpb24od2lkdGgsIGhlaWdodCwgcGl4ZWxSYXRpbykgewogICAgX3dpZHRoID0gd2lkdGg7CiAgICBfaGVpZ2h0ID0gaGVpZ2h0OwogICAgX3BpeGVsUmF0aW8gPSBwaXhlbFJhdGlvOwogICAgX2NhbnZhczIud2lkdGggPSBNYXRoLmZsb29yKHdpZHRoICogcGl4ZWxSYXRpbyk7CiAgICBfY2FudmFzMi5oZWlnaHQgPSBNYXRoLmZsb29yKGhlaWdodCAqIHBpeGVsUmF0aW8pOwogICAgdGhpcy5zZXRWaWV3cG9ydCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICB9OwogIHRoaXMuZ2V0Q3VycmVudFZpZXdwb3J0ID0gZnVuY3Rpb24odGFyZ2V0KSB7CiAgICByZXR1cm4gdGFyZ2V0LmNvcHkoX2N1cnJlbnRWaWV3cG9ydCk7CiAgfTsKICB0aGlzLmdldFZpZXdwb3J0ID0gZnVuY3Rpb24odGFyZ2V0KSB7CiAgICByZXR1cm4gdGFyZ2V0LmNvcHkoX3ZpZXdwb3J0KTsKICB9OwogIHRoaXMuc2V0Vmlld3BvcnQgPSBmdW5jdGlvbih4LCB5LCB3aWR0aCwgaGVpZ2h0KSB7CiAgICBpZiAoeC5pc1ZlY3RvcjQpIHsKICAgICAgX3ZpZXdwb3J0LnNldCh4LngsIHgueSwgeC56LCB4LncpOwogICAgfSBlbHNlIHsKICAgICAgX3ZpZXdwb3J0LnNldCh4LCB5LCB3aWR0aCwgaGVpZ2h0KTsKICAgIH0KICAgIHN0YXRlLnZpZXdwb3J0KF9jdXJyZW50Vmlld3BvcnQuY29weShfdmlld3BvcnQpLm11bHRpcGx5U2NhbGFyKF9waXhlbFJhdGlvKS5mbG9vcigpKTsKICB9OwogIHRoaXMuZ2V0U2Npc3NvciA9IGZ1bmN0aW9uKHRhcmdldCkgewogICAgcmV0dXJuIHRhcmdldC5jb3B5KF9zY2lzc29yKTsKICB9OwogIHRoaXMuc2V0U2Npc3NvciA9IGZ1bmN0aW9uKHgsIHksIHdpZHRoLCBoZWlnaHQpIHsKICAgIGlmICh4LmlzVmVjdG9yNCkgewogICAgICBfc2Npc3Nvci5zZXQoeC54LCB4LnksIHgueiwgeC53KTsKICAgIH0gZWxzZSB7CiAgICAgIF9zY2lzc29yLnNldCh4LCB5LCB3aWR0aCwgaGVpZ2h0KTsKICAgIH0KICAgIHN0YXRlLnNjaXNzb3IoX2N1cnJlbnRTY2lzc29yLmNvcHkoX3NjaXNzb3IpLm11bHRpcGx5U2NhbGFyKF9waXhlbFJhdGlvKS5mbG9vcigpKTsKICB9OwogIHRoaXMuZ2V0U2Npc3NvclRlc3QgPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiBfc2Npc3NvclRlc3Q7CiAgfTsKICB0aGlzLnNldFNjaXNzb3JUZXN0ID0gZnVuY3Rpb24oYm9vbGVhbikgewogICAgc3RhdGUuc2V0U2Npc3NvclRlc3QoX3NjaXNzb3JUZXN0ID0gYm9vbGVhbik7CiAgfTsKICB0aGlzLnNldE9wYXF1ZVNvcnQgPSBmdW5jdGlvbihtZXRob2QpIHsKICAgIF9vcGFxdWVTb3J0ID0gbWV0aG9kOwogIH07CiAgdGhpcy5zZXRUcmFuc3BhcmVudFNvcnQgPSBmdW5jdGlvbihtZXRob2QpIHsKICAgIF90cmFuc3BhcmVudFNvcnQgPSBtZXRob2Q7CiAgfTsKICB0aGlzLmdldENsZWFyQ29sb3IgPSBmdW5jdGlvbih0YXJnZXQpIHsKICAgIHJldHVybiB0YXJnZXQuY29weShiYWNrZ3JvdW5kLmdldENsZWFyQ29sb3IoKSk7CiAgfTsKICB0aGlzLnNldENsZWFyQ29sb3IgPSBmdW5jdGlvbigpIHsKICAgIGJhY2tncm91bmQuc2V0Q2xlYXJDb2xvci5hcHBseShiYWNrZ3JvdW5kLCBhcmd1bWVudHMpOwogIH07CiAgdGhpcy5nZXRDbGVhckFscGhhID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gYmFja2dyb3VuZC5nZXRDbGVhckFscGhhKCk7CiAgfTsKICB0aGlzLnNldENsZWFyQWxwaGEgPSBmdW5jdGlvbigpIHsKICAgIGJhY2tncm91bmQuc2V0Q2xlYXJBbHBoYS5hcHBseShiYWNrZ3JvdW5kLCBhcmd1bWVudHMpOwogIH07CiAgdGhpcy5jbGVhciA9IGZ1bmN0aW9uKGNvbG9yLCBkZXB0aCwgc3RlbmNpbCkgewogICAgbGV0IGJpdHMgPSAwOwogICAgaWYgKGNvbG9yID09PSB2b2lkIDAgfHwgY29sb3IpCiAgICAgIGJpdHMgfD0gMTYzODQ7CiAgICBpZiAoZGVwdGggPT09IHZvaWQgMCB8fCBkZXB0aCkKICAgICAgYml0cyB8PSAyNTY7CiAgICBpZiAoc3RlbmNpbCA9PT0gdm9pZCAwIHx8IHN0ZW5jaWwpCiAgICAgIGJpdHMgfD0gMTAyNDsKICAgIF9nbC5jbGVhcihiaXRzKTsKICB9OwogIHRoaXMuY2xlYXJDb2xvciA9IGZ1bmN0aW9uKCkgewogICAgdGhpcy5jbGVhcih0cnVlLCBmYWxzZSwgZmFsc2UpOwogIH07CiAgdGhpcy5jbGVhckRlcHRoID0gZnVuY3Rpb24oKSB7CiAgICB0aGlzLmNsZWFyKGZhbHNlLCB0cnVlLCBmYWxzZSk7CiAgfTsKICB0aGlzLmNsZWFyU3RlbmNpbCA9IGZ1bmN0aW9uKCkgewogICAgdGhpcy5jbGVhcihmYWxzZSwgZmFsc2UsIHRydWUpOwogIH07CiAgdGhpcy5kaXNwb3NlID0gZnVuY3Rpb24oKSB7CiAgICBfY2FudmFzMi5yZW1vdmVFdmVudExpc3RlbmVyKCJ3ZWJnbGNvbnRleHRsb3N0Iiwgb25Db250ZXh0TG9zdCwgZmFsc2UpOwogICAgX2NhbnZhczIucmVtb3ZlRXZlbnRMaXN0ZW5lcigid2ViZ2xjb250ZXh0cmVzdG9yZWQiLCBvbkNvbnRleHRSZXN0b3JlLCBmYWxzZSk7CiAgICByZW5kZXJMaXN0cy5kaXNwb3NlKCk7CiAgICByZW5kZXJTdGF0ZXMuZGlzcG9zZSgpOwogICAgcHJvcGVydGllcy5kaXNwb3NlKCk7CiAgICBjdWJlbWFwcy5kaXNwb3NlKCk7CiAgICBjdWJldXZtYXBzLmRpc3Bvc2UoKTsKICAgIG9iamVjdHMuZGlzcG9zZSgpOwogICAgYmluZGluZ1N0YXRlcy5kaXNwb3NlKCk7CiAgICBwcm9ncmFtQ2FjaGUuZGlzcG9zZSgpOwogICAgeHIuZGlzcG9zZSgpOwogICAgeHIucmVtb3ZlRXZlbnRMaXN0ZW5lcigic2Vzc2lvbnN0YXJ0Iiwgb25YUlNlc3Npb25TdGFydCk7CiAgICB4ci5yZW1vdmVFdmVudExpc3RlbmVyKCJzZXNzaW9uZW5kIiwgb25YUlNlc3Npb25FbmQpOwogICAgaWYgKF90cmFuc21pc3Npb25SZW5kZXJUYXJnZXQpIHsKICAgICAgX3RyYW5zbWlzc2lvblJlbmRlclRhcmdldC5kaXNwb3NlKCk7CiAgICAgIF90cmFuc21pc3Npb25SZW5kZXJUYXJnZXQgPSBudWxsOwogICAgfQogICAgYW5pbWF0aW9uLnN0b3AoKTsKICB9OwogIGZ1bmN0aW9uIG9uQ29udGV4dExvc3QoZXZlbnQpIHsKICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICBjb25zb2xlLmxvZygiVEhSRUUuV2ViR0xSZW5kZXJlcjogQ29udGV4dCBMb3N0LiIpOwogICAgX2lzQ29udGV4dExvc3QgPSB0cnVlOwogIH0KICBmdW5jdGlvbiBvbkNvbnRleHRSZXN0b3JlKCkgewogICAgY29uc29sZS5sb2coIlRIUkVFLldlYkdMUmVuZGVyZXI6IENvbnRleHQgUmVzdG9yZWQuIik7CiAgICBfaXNDb250ZXh0TG9zdCA9IGZhbHNlOwogICAgY29uc3QgaW5mb0F1dG9SZXNldCA9IGluZm8uYXV0b1Jlc2V0OwogICAgY29uc3Qgc2hhZG93TWFwRW5hYmxlZCA9IHNoYWRvd01hcC5lbmFibGVkOwogICAgY29uc3Qgc2hhZG93TWFwQXV0b1VwZGF0ZSA9IHNoYWRvd01hcC5hdXRvVXBkYXRlOwogICAgY29uc3Qgc2hhZG93TWFwTmVlZHNVcGRhdGUgPSBzaGFkb3dNYXAubmVlZHNVcGRhdGU7CiAgICBjb25zdCBzaGFkb3dNYXBUeXBlID0gc2hhZG93TWFwLnR5cGU7CiAgICBpbml0R0xDb250ZXh0KCk7CiAgICBpbmZvLmF1dG9SZXNldCA9IGluZm9BdXRvUmVzZXQ7CiAgICBzaGFkb3dNYXAuZW5hYmxlZCA9IHNoYWRvd01hcEVuYWJsZWQ7CiAgICBzaGFkb3dNYXAuYXV0b1VwZGF0ZSA9IHNoYWRvd01hcEF1dG9VcGRhdGU7CiAgICBzaGFkb3dNYXAubmVlZHNVcGRhdGUgPSBzaGFkb3dNYXBOZWVkc1VwZGF0ZTsKICAgIHNoYWRvd01hcC50eXBlID0gc2hhZG93TWFwVHlwZTsKICB9CiAgZnVuY3Rpb24gb25NYXRlcmlhbERpc3Bvc2UoZXZlbnQpIHsKICAgIGNvbnN0IG1hdGVyaWFsID0gZXZlbnQudGFyZ2V0OwogICAgbWF0ZXJpYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZGlzcG9zZSIsIG9uTWF0ZXJpYWxEaXNwb3NlKTsKICAgIGRlYWxsb2NhdGVNYXRlcmlhbChtYXRlcmlhbCk7CiAgfQogIGZ1bmN0aW9uIGRlYWxsb2NhdGVNYXRlcmlhbChtYXRlcmlhbCkgewogICAgcmVsZWFzZU1hdGVyaWFsUHJvZ3JhbVJlZmVyZW5jZXMobWF0ZXJpYWwpOwogICAgcHJvcGVydGllcy5yZW1vdmUobWF0ZXJpYWwpOwogIH0KICBmdW5jdGlvbiByZWxlYXNlTWF0ZXJpYWxQcm9ncmFtUmVmZXJlbmNlcyhtYXRlcmlhbCkgewogICAgY29uc3QgcHJvZ3JhbXMgPSBwcm9wZXJ0aWVzLmdldChtYXRlcmlhbCkucHJvZ3JhbXM7CiAgICBpZiAocHJvZ3JhbXMgIT09IHZvaWQgMCkgewogICAgICBwcm9ncmFtcy5mb3JFYWNoKGZ1bmN0aW9uKHByb2dyYW0pIHsKICAgICAgICBwcm9ncmFtQ2FjaGUucmVsZWFzZVByb2dyYW0ocHJvZ3JhbSk7CiAgICAgIH0pOwogICAgICBpZiAobWF0ZXJpYWwuaXNTaGFkZXJNYXRlcmlhbCkgewogICAgICAgIHByb2dyYW1DYWNoZS5yZWxlYXNlU2hhZGVyQ2FjaGUobWF0ZXJpYWwpOwogICAgICB9CiAgICB9CiAgfQogIHRoaXMucmVuZGVyQnVmZmVyRGlyZWN0ID0gZnVuY3Rpb24oY2FtZXJhLCBzY2VuZSwgZ2VvbWV0cnksIG1hdGVyaWFsLCBvYmplY3QsIGdyb3VwKSB7CiAgICBpZiAoc2NlbmUgPT09IG51bGwpCiAgICAgIHNjZW5lID0gX2VtcHR5U2NlbmU7CiAgICBjb25zdCBmcm9udEZhY2VDVyA9IG9iamVjdC5pc01lc2ggJiYgb2JqZWN0Lm1hdHJpeFdvcmxkLmRldGVybWluYW50KCkgPCAwOwogICAgY29uc3QgcHJvZ3JhbSA9IHNldFByb2dyYW0oY2FtZXJhLCBzY2VuZSwgZ2VvbWV0cnksIG1hdGVyaWFsLCBvYmplY3QpOwogICAgc3RhdGUuc2V0TWF0ZXJpYWwobWF0ZXJpYWwsIGZyb250RmFjZUNXKTsKICAgIGxldCBpbmRleCA9IGdlb21ldHJ5LmluZGV4OwogICAgY29uc3QgcG9zaXRpb24gPSBnZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uOwogICAgaWYgKGluZGV4ID09PSBudWxsKSB7CiAgICAgIGlmIChwb3NpdGlvbiA9PT0gdm9pZCAwIHx8IHBvc2l0aW9uLmNvdW50ID09PSAwKQogICAgICAgIHJldHVybjsKICAgIH0gZWxzZSBpZiAoaW5kZXguY291bnQgPT09IDApIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgbGV0IHJhbmdlRmFjdG9yID0gMTsKICAgIGlmIChtYXRlcmlhbC53aXJlZnJhbWUgPT09IHRydWUpIHsKICAgICAgaW5kZXggPSBnZW9tZXRyaWVzLmdldFdpcmVmcmFtZUF0dHJpYnV0ZShnZW9tZXRyeSk7CiAgICAgIHJhbmdlRmFjdG9yID0gMjsKICAgIH0KICAgIGJpbmRpbmdTdGF0ZXMuc2V0dXAob2JqZWN0LCBtYXRlcmlhbCwgcHJvZ3JhbSwgZ2VvbWV0cnksIGluZGV4KTsKICAgIGxldCBhdHRyaWJ1dGU7CiAgICBsZXQgcmVuZGVyZXIgPSBidWZmZXJSZW5kZXJlcjsKICAgIGlmIChpbmRleCAhPT0gbnVsbCkgewogICAgICBhdHRyaWJ1dGUgPSBhdHRyaWJ1dGVzLmdldChpbmRleCk7CiAgICAgIHJlbmRlcmVyID0gaW5kZXhlZEJ1ZmZlclJlbmRlcmVyOwogICAgICByZW5kZXJlci5zZXRJbmRleChhdHRyaWJ1dGUpOwogICAgfQogICAgY29uc3QgZGF0YUNvdW50ID0gaW5kZXggIT09IG51bGwgPyBpbmRleC5jb3VudCA6IHBvc2l0aW9uLmNvdW50OwogICAgY29uc3QgcmFuZ2VTdGFydCA9IGdlb21ldHJ5LmRyYXdSYW5nZS5zdGFydCAqIHJhbmdlRmFjdG9yOwogICAgY29uc3QgcmFuZ2VDb3VudCA9IGdlb21ldHJ5LmRyYXdSYW5nZS5jb3VudCAqIHJhbmdlRmFjdG9yOwogICAgY29uc3QgZ3JvdXBTdGFydCA9IGdyb3VwICE9PSBudWxsID8gZ3JvdXAuc3RhcnQgKiByYW5nZUZhY3RvciA6IDA7CiAgICBjb25zdCBncm91cENvdW50ID0gZ3JvdXAgIT09IG51bGwgPyBncm91cC5jb3VudCAqIHJhbmdlRmFjdG9yIDogSW5maW5pdHk7CiAgICBjb25zdCBkcmF3U3RhcnQgPSBNYXRoLm1heChyYW5nZVN0YXJ0LCBncm91cFN0YXJ0KTsKICAgIGNvbnN0IGRyYXdFbmQgPSBNYXRoLm1pbihkYXRhQ291bnQsIHJhbmdlU3RhcnQgKyByYW5nZUNvdW50LCBncm91cFN0YXJ0ICsgZ3JvdXBDb3VudCkgLSAxOwogICAgY29uc3QgZHJhd0NvdW50ID0gTWF0aC5tYXgoMCwgZHJhd0VuZCAtIGRyYXdTdGFydCArIDEpOwogICAgaWYgKGRyYXdDb3VudCA9PT0gMCkKICAgICAgcmV0dXJuOwogICAgaWYgKG9iamVjdC5pc01lc2gpIHsKICAgICAgaWYgKG1hdGVyaWFsLndpcmVmcmFtZSA9PT0gdHJ1ZSkgewogICAgICAgIHN0YXRlLnNldExpbmVXaWR0aChtYXRlcmlhbC53aXJlZnJhbWVMaW5ld2lkdGggKiBnZXRUYXJnZXRQaXhlbFJhdGlvKCkpOwogICAgICAgIHJlbmRlcmVyLnNldE1vZGUoMSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVuZGVyZXIuc2V0TW9kZSg0KTsKICAgICAgfQogICAgfSBlbHNlIGlmIChvYmplY3QuaXNMaW5lKSB7CiAgICAgIGxldCBsaW5lV2lkdGggPSBtYXRlcmlhbC5saW5ld2lkdGg7CiAgICAgIGlmIChsaW5lV2lkdGggPT09IHZvaWQgMCkKICAgICAgICBsaW5lV2lkdGggPSAxOwogICAgICBzdGF0ZS5zZXRMaW5lV2lkdGgobGluZVdpZHRoICogZ2V0VGFyZ2V0UGl4ZWxSYXRpbygpKTsKICAgICAgaWYgKG9iamVjdC5pc0xpbmVTZWdtZW50cykgewogICAgICAgIHJlbmRlcmVyLnNldE1vZGUoMSk7CiAgICAgIH0gZWxzZSBpZiAob2JqZWN0LmlzTGluZUxvb3ApIHsKICAgICAgICByZW5kZXJlci5zZXRNb2RlKDIpOwogICAgICB9IGVsc2UgewogICAgICAgIHJlbmRlcmVyLnNldE1vZGUoMyk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAob2JqZWN0LmlzUG9pbnRzKSB7CiAgICAgIHJlbmRlcmVyLnNldE1vZGUoMCk7CiAgICB9IGVsc2UgaWYgKG9iamVjdC5pc1Nwcml0ZSkgewogICAgICByZW5kZXJlci5zZXRNb2RlKDQpOwogICAgfQogICAgaWYgKG9iamVjdC5pc0luc3RhbmNlZE1lc2gpIHsKICAgICAgcmVuZGVyZXIucmVuZGVySW5zdGFuY2VzKGRyYXdTdGFydCwgZHJhd0NvdW50LCBvYmplY3QuY291bnQpOwogICAgfSBlbHNlIGlmIChnZW9tZXRyeS5pc0luc3RhbmNlZEJ1ZmZlckdlb21ldHJ5KSB7CiAgICAgIGNvbnN0IGluc3RhbmNlQ291bnQgPSBNYXRoLm1pbihnZW9tZXRyeS5pbnN0YW5jZUNvdW50LCBnZW9tZXRyeS5fbWF4SW5zdGFuY2VDb3VudCk7CiAgICAgIHJlbmRlcmVyLnJlbmRlckluc3RhbmNlcyhkcmF3U3RhcnQsIGRyYXdDb3VudCwgaW5zdGFuY2VDb3VudCk7CiAgICB9IGVsc2UgewogICAgICByZW5kZXJlci5yZW5kZXIoZHJhd1N0YXJ0LCBkcmF3Q291bnQpOwogICAgfQogIH07CiAgdGhpcy5jb21waWxlID0gZnVuY3Rpb24oc2NlbmUsIGNhbWVyYSkgewogICAgY3VycmVudFJlbmRlclN0YXRlID0gcmVuZGVyU3RhdGVzLmdldChzY2VuZSk7CiAgICBjdXJyZW50UmVuZGVyU3RhdGUuaW5pdCgpOwogICAgcmVuZGVyU3RhdGVTdGFjay5wdXNoKGN1cnJlbnRSZW5kZXJTdGF0ZSk7CiAgICBzY2VuZS50cmF2ZXJzZVZpc2libGUoZnVuY3Rpb24ob2JqZWN0KSB7CiAgICAgIGlmIChvYmplY3QuaXNMaWdodCAmJiBvYmplY3QubGF5ZXJzLnRlc3QoY2FtZXJhLmxheWVycykpIHsKICAgICAgICBjdXJyZW50UmVuZGVyU3RhdGUucHVzaExpZ2h0KG9iamVjdCk7CiAgICAgICAgaWYgKG9iamVjdC5jYXN0U2hhZG93KSB7CiAgICAgICAgICBjdXJyZW50UmVuZGVyU3RhdGUucHVzaFNoYWRvdyhvYmplY3QpOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgICBjdXJyZW50UmVuZGVyU3RhdGUuc2V0dXBMaWdodHMoX3RoaXMucGh5c2ljYWxseUNvcnJlY3RMaWdodHMpOwogICAgc2NlbmUudHJhdmVyc2UoZnVuY3Rpb24ob2JqZWN0KSB7CiAgICAgIGNvbnN0IG1hdGVyaWFsID0gb2JqZWN0Lm1hdGVyaWFsOwogICAgICBpZiAobWF0ZXJpYWwpIHsKICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShtYXRlcmlhbCkpIHsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWF0ZXJpYWwubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgY29uc3QgbWF0ZXJpYWwyID0gbWF0ZXJpYWxbaV07CiAgICAgICAgICAgIGdldFByb2dyYW0obWF0ZXJpYWwyLCBzY2VuZSwgb2JqZWN0KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgZ2V0UHJvZ3JhbShtYXRlcmlhbCwgc2NlbmUsIG9iamVjdCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIHJlbmRlclN0YXRlU3RhY2sucG9wKCk7CiAgICBjdXJyZW50UmVuZGVyU3RhdGUgPSBudWxsOwogIH07CiAgbGV0IG9uQW5pbWF0aW9uRnJhbWVDYWxsYmFjayA9IG51bGw7CiAgZnVuY3Rpb24gb25BbmltYXRpb25GcmFtZSh0aW1lKSB7CiAgICBpZiAob25BbmltYXRpb25GcmFtZUNhbGxiYWNrKQogICAgICBvbkFuaW1hdGlvbkZyYW1lQ2FsbGJhY2sodGltZSk7CiAgfQogIGZ1bmN0aW9uIG9uWFJTZXNzaW9uU3RhcnQoKSB7CiAgICBhbmltYXRpb24uc3RvcCgpOwogIH0KICBmdW5jdGlvbiBvblhSU2Vzc2lvbkVuZCgpIHsKICAgIGFuaW1hdGlvbi5zdGFydCgpOwogIH0KICBjb25zdCBhbmltYXRpb24gPSBuZXcgV2ViR0xBbmltYXRpb24oKTsKICBhbmltYXRpb24uc2V0QW5pbWF0aW9uTG9vcChvbkFuaW1hdGlvbkZyYW1lKTsKICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIpCiAgICBhbmltYXRpb24uc2V0Q29udGV4dCh3aW5kb3cpOwogIHRoaXMuc2V0QW5pbWF0aW9uTG9vcCA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7CiAgICBvbkFuaW1hdGlvbkZyYW1lQ2FsbGJhY2sgPSBjYWxsYmFjazsKICAgIHhyLnNldEFuaW1hdGlvbkxvb3AoY2FsbGJhY2spOwogICAgY2FsbGJhY2sgPT09IG51bGwgPyBhbmltYXRpb24uc3RvcCgpIDogYW5pbWF0aW9uLnN0YXJ0KCk7CiAgfTsKICB4ci5hZGRFdmVudExpc3RlbmVyKCJzZXNzaW9uc3RhcnQiLCBvblhSU2Vzc2lvblN0YXJ0KTsKICB4ci5hZGRFdmVudExpc3RlbmVyKCJzZXNzaW9uZW5kIiwgb25YUlNlc3Npb25FbmQpOwogIHRoaXMucmVuZGVyID0gZnVuY3Rpb24oc2NlbmUsIGNhbWVyYSkgewogICAgaWYgKGNhbWVyYSAhPT0gdm9pZCAwICYmIGNhbWVyYS5pc0NhbWVyYSAhPT0gdHJ1ZSkgewogICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5XZWJHTFJlbmRlcmVyLnJlbmRlcjogY2FtZXJhIGlzIG5vdCBhbiBpbnN0YW5jZSBvZiBUSFJFRS5DYW1lcmEuIik7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmIChfaXNDb250ZXh0TG9zdCA9PT0gdHJ1ZSkKICAgICAgcmV0dXJuOwogICAgaWYgKHNjZW5lLmF1dG9VcGRhdGUgPT09IHRydWUpCiAgICAgIHNjZW5lLnVwZGF0ZU1hdHJpeFdvcmxkKCk7CiAgICBpZiAoY2FtZXJhLnBhcmVudCA9PT0gbnVsbCkKICAgICAgY2FtZXJhLnVwZGF0ZU1hdHJpeFdvcmxkKCk7CiAgICBpZiAoeHIuZW5hYmxlZCA9PT0gdHJ1ZSAmJiB4ci5pc1ByZXNlbnRpbmcgPT09IHRydWUpIHsKICAgICAgaWYgKHhyLmNhbWVyYUF1dG9VcGRhdGUgPT09IHRydWUpCiAgICAgICAgeHIudXBkYXRlQ2FtZXJhKGNhbWVyYSk7CiAgICAgIGNhbWVyYSA9IHhyLmdldENhbWVyYSgpOwogICAgfQogICAgaWYgKHNjZW5lLmlzU2NlbmUgPT09IHRydWUpCiAgICAgIHNjZW5lLm9uQmVmb3JlUmVuZGVyKF90aGlzLCBzY2VuZSwgY2FtZXJhLCBfY3VycmVudFJlbmRlclRhcmdldCk7CiAgICBjdXJyZW50UmVuZGVyU3RhdGUgPSByZW5kZXJTdGF0ZXMuZ2V0KHNjZW5lLCByZW5kZXJTdGF0ZVN0YWNrLmxlbmd0aCk7CiAgICBjdXJyZW50UmVuZGVyU3RhdGUuaW5pdCgpOwogICAgcmVuZGVyU3RhdGVTdGFjay5wdXNoKGN1cnJlbnRSZW5kZXJTdGF0ZSk7CiAgICBfcHJvalNjcmVlbk1hdHJpeDIubXVsdGlwbHlNYXRyaWNlcyhjYW1lcmEucHJvamVjdGlvbk1hdHJpeCwgY2FtZXJhLm1hdHJpeFdvcmxkSW52ZXJzZSk7CiAgICBfZnJ1c3R1bS5zZXRGcm9tUHJvamVjdGlvbk1hdHJpeChfcHJvalNjcmVlbk1hdHJpeDIpOwogICAgX2xvY2FsQ2xpcHBpbmdFbmFibGVkID0gdGhpcy5sb2NhbENsaXBwaW5nRW5hYmxlZDsKICAgIF9jbGlwcGluZ0VuYWJsZWQgPSBjbGlwcGluZy5pbml0KHRoaXMuY2xpcHBpbmdQbGFuZXMsIF9sb2NhbENsaXBwaW5nRW5hYmxlZCwgY2FtZXJhKTsKICAgIGN1cnJlbnRSZW5kZXJMaXN0ID0gcmVuZGVyTGlzdHMuZ2V0KHNjZW5lLCByZW5kZXJMaXN0U3RhY2subGVuZ3RoKTsKICAgIGN1cnJlbnRSZW5kZXJMaXN0LmluaXQoKTsKICAgIHJlbmRlckxpc3RTdGFjay5wdXNoKGN1cnJlbnRSZW5kZXJMaXN0KTsKICAgIHByb2plY3RPYmplY3Qoc2NlbmUsIGNhbWVyYSwgMCwgX3RoaXMuc29ydE9iamVjdHMpOwogICAgY3VycmVudFJlbmRlckxpc3QuZmluaXNoKCk7CiAgICBpZiAoX3RoaXMuc29ydE9iamVjdHMgPT09IHRydWUpIHsKICAgICAgY3VycmVudFJlbmRlckxpc3Quc29ydChfb3BhcXVlU29ydCwgX3RyYW5zcGFyZW50U29ydCk7CiAgICB9CiAgICBpZiAoX2NsaXBwaW5nRW5hYmxlZCA9PT0gdHJ1ZSkKICAgICAgY2xpcHBpbmcuYmVnaW5TaGFkb3dzKCk7CiAgICBjb25zdCBzaGFkb3dzQXJyYXkgPSBjdXJyZW50UmVuZGVyU3RhdGUuc3RhdGUuc2hhZG93c0FycmF5OwogICAgc2hhZG93TWFwLnJlbmRlcihzaGFkb3dzQXJyYXksIHNjZW5lLCBjYW1lcmEpOwogICAgaWYgKF9jbGlwcGluZ0VuYWJsZWQgPT09IHRydWUpCiAgICAgIGNsaXBwaW5nLmVuZFNoYWRvd3MoKTsKICAgIGlmICh0aGlzLmluZm8uYXV0b1Jlc2V0ID09PSB0cnVlKQogICAgICB0aGlzLmluZm8ucmVzZXQoKTsKICAgIGJhY2tncm91bmQucmVuZGVyKGN1cnJlbnRSZW5kZXJMaXN0LCBzY2VuZSk7CiAgICBjdXJyZW50UmVuZGVyU3RhdGUuc2V0dXBMaWdodHMoX3RoaXMucGh5c2ljYWxseUNvcnJlY3RMaWdodHMpOwogICAgaWYgKGNhbWVyYS5pc0FycmF5Q2FtZXJhKSB7CiAgICAgIGNvbnN0IGNhbWVyYXMgPSBjYW1lcmEuY2FtZXJhczsKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBjYW1lcmFzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGNvbnN0IGNhbWVyYTIgPSBjYW1lcmFzW2ldOwogICAgICAgIHJlbmRlclNjZW5lKGN1cnJlbnRSZW5kZXJMaXN0LCBzY2VuZSwgY2FtZXJhMiwgY2FtZXJhMi52aWV3cG9ydCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHJlbmRlclNjZW5lKGN1cnJlbnRSZW5kZXJMaXN0LCBzY2VuZSwgY2FtZXJhKTsKICAgIH0KICAgIGlmIChfY3VycmVudFJlbmRlclRhcmdldCAhPT0gbnVsbCkgewogICAgICB0ZXh0dXJlcy51cGRhdGVNdWx0aXNhbXBsZVJlbmRlclRhcmdldChfY3VycmVudFJlbmRlclRhcmdldCk7CiAgICAgIHRleHR1cmVzLnVwZGF0ZVJlbmRlclRhcmdldE1pcG1hcChfY3VycmVudFJlbmRlclRhcmdldCk7CiAgICB9CiAgICBpZiAoc2NlbmUuaXNTY2VuZSA9PT0gdHJ1ZSkKICAgICAgc2NlbmUub25BZnRlclJlbmRlcihfdGhpcywgc2NlbmUsIGNhbWVyYSk7CiAgICBzdGF0ZS5idWZmZXJzLmRlcHRoLnNldFRlc3QodHJ1ZSk7CiAgICBzdGF0ZS5idWZmZXJzLmRlcHRoLnNldE1hc2sodHJ1ZSk7CiAgICBzdGF0ZS5idWZmZXJzLmNvbG9yLnNldE1hc2sodHJ1ZSk7CiAgICBzdGF0ZS5zZXRQb2x5Z29uT2Zmc2V0KGZhbHNlKTsKICAgIGJpbmRpbmdTdGF0ZXMucmVzZXREZWZhdWx0U3RhdGUoKTsKICAgIF9jdXJyZW50TWF0ZXJpYWxJZCA9IC0xOwogICAgX2N1cnJlbnRDYW1lcmEgPSBudWxsOwogICAgcmVuZGVyU3RhdGVTdGFjay5wb3AoKTsKICAgIGlmIChyZW5kZXJTdGF0ZVN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgY3VycmVudFJlbmRlclN0YXRlID0gcmVuZGVyU3RhdGVTdGFja1tyZW5kZXJTdGF0ZVN0YWNrLmxlbmd0aCAtIDFdOwogICAgfSBlbHNlIHsKICAgICAgY3VycmVudFJlbmRlclN0YXRlID0gbnVsbDsKICAgIH0KICAgIHJlbmRlckxpc3RTdGFjay5wb3AoKTsKICAgIGlmIChyZW5kZXJMaXN0U3RhY2subGVuZ3RoID4gMCkgewogICAgICBjdXJyZW50UmVuZGVyTGlzdCA9IHJlbmRlckxpc3RTdGFja1tyZW5kZXJMaXN0U3RhY2subGVuZ3RoIC0gMV07CiAgICB9IGVsc2UgewogICAgICBjdXJyZW50UmVuZGVyTGlzdCA9IG51bGw7CiAgICB9CiAgfTsKICBmdW5jdGlvbiBwcm9qZWN0T2JqZWN0KG9iamVjdCwgY2FtZXJhLCBncm91cE9yZGVyLCBzb3J0T2JqZWN0cykgewogICAgaWYgKG9iamVjdC52aXNpYmxlID09PSBmYWxzZSkKICAgICAgcmV0dXJuOwogICAgY29uc3QgdmlzaWJsZSA9IG9iamVjdC5sYXllcnMudGVzdChjYW1lcmEubGF5ZXJzKTsKICAgIGlmICh2aXNpYmxlKSB7CiAgICAgIGlmIChvYmplY3QuaXNHcm91cCkgewogICAgICAgIGdyb3VwT3JkZXIgPSBvYmplY3QucmVuZGVyT3JkZXI7CiAgICAgIH0gZWxzZSBpZiAob2JqZWN0LmlzTE9EKSB7CiAgICAgICAgaWYgKG9iamVjdC5hdXRvVXBkYXRlID09PSB0cnVlKQogICAgICAgICAgb2JqZWN0LnVwZGF0ZShjYW1lcmEpOwogICAgICB9IGVsc2UgaWYgKG9iamVjdC5pc0xpZ2h0KSB7CiAgICAgICAgY3VycmVudFJlbmRlclN0YXRlLnB1c2hMaWdodChvYmplY3QpOwogICAgICAgIGlmIChvYmplY3QuY2FzdFNoYWRvdykgewogICAgICAgICAgY3VycmVudFJlbmRlclN0YXRlLnB1c2hTaGFkb3cob2JqZWN0KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAob2JqZWN0LmlzU3ByaXRlKSB7CiAgICAgICAgaWYgKCFvYmplY3QuZnJ1c3R1bUN1bGxlZCB8fCBfZnJ1c3R1bS5pbnRlcnNlY3RzU3ByaXRlKG9iamVjdCkpIHsKICAgICAgICAgIGlmIChzb3J0T2JqZWN0cykgewogICAgICAgICAgICBfdmVjdG9yMy5zZXRGcm9tTWF0cml4UG9zaXRpb24ob2JqZWN0Lm1hdHJpeFdvcmxkKS5hcHBseU1hdHJpeDQoX3Byb2pTY3JlZW5NYXRyaXgyKTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IGdlb21ldHJ5ID0gb2JqZWN0cy51cGRhdGUob2JqZWN0KTsKICAgICAgICAgIGNvbnN0IG1hdGVyaWFsID0gb2JqZWN0Lm1hdGVyaWFsOwogICAgICAgICAgaWYgKG1hdGVyaWFsLnZpc2libGUpIHsKICAgICAgICAgICAgY3VycmVudFJlbmRlckxpc3QucHVzaChvYmplY3QsIGdlb21ldHJ5LCBtYXRlcmlhbCwgZ3JvdXBPcmRlciwgX3ZlY3RvcjMueiwgbnVsbCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKG9iamVjdC5pc01lc2ggfHwgb2JqZWN0LmlzTGluZSB8fCBvYmplY3QuaXNQb2ludHMpIHsKICAgICAgICBpZiAob2JqZWN0LmlzU2tpbm5lZE1lc2gpIHsKICAgICAgICAgIGlmIChvYmplY3Quc2tlbGV0b24uZnJhbWUgIT09IGluZm8ucmVuZGVyLmZyYW1lKSB7CiAgICAgICAgICAgIG9iamVjdC5za2VsZXRvbi51cGRhdGUoKTsKICAgICAgICAgICAgb2JqZWN0LnNrZWxldG9uLmZyYW1lID0gaW5mby5yZW5kZXIuZnJhbWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICghb2JqZWN0LmZydXN0dW1DdWxsZWQgfHwgX2ZydXN0dW0uaW50ZXJzZWN0c09iamVjdChvYmplY3QpKSB7CiAgICAgICAgICBpZiAoc29ydE9iamVjdHMpIHsKICAgICAgICAgICAgX3ZlY3RvcjMuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKG9iamVjdC5tYXRyaXhXb3JsZCkuYXBwbHlNYXRyaXg0KF9wcm9qU2NyZWVuTWF0cml4Mik7CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCBnZW9tZXRyeSA9IG9iamVjdHMudXBkYXRlKG9iamVjdCk7CiAgICAgICAgICBjb25zdCBtYXRlcmlhbCA9IG9iamVjdC5tYXRlcmlhbDsKICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KG1hdGVyaWFsKSkgewogICAgICAgICAgICBjb25zdCBncm91cHMgPSBnZW9tZXRyeS5ncm91cHM7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gZ3JvdXBzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gZ3JvdXBzW2ldOwogICAgICAgICAgICAgIGNvbnN0IGdyb3VwTWF0ZXJpYWwgPSBtYXRlcmlhbFtncm91cC5tYXRlcmlhbEluZGV4XTsKICAgICAgICAgICAgICBpZiAoZ3JvdXBNYXRlcmlhbCAmJiBncm91cE1hdGVyaWFsLnZpc2libGUpIHsKICAgICAgICAgICAgICAgIGN1cnJlbnRSZW5kZXJMaXN0LnB1c2gob2JqZWN0LCBnZW9tZXRyeSwgZ3JvdXBNYXRlcmlhbCwgZ3JvdXBPcmRlciwgX3ZlY3RvcjMueiwgZ3JvdXApOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChtYXRlcmlhbC52aXNpYmxlKSB7CiAgICAgICAgICAgIGN1cnJlbnRSZW5kZXJMaXN0LnB1c2gob2JqZWN0LCBnZW9tZXRyeSwgbWF0ZXJpYWwsIGdyb3VwT3JkZXIsIF92ZWN0b3IzLnosIG51bGwpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgY29uc3QgY2hpbGRyZW4gPSBvYmplY3QuY2hpbGRyZW47CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBwcm9qZWN0T2JqZWN0KGNoaWxkcmVuW2ldLCBjYW1lcmEsIGdyb3VwT3JkZXIsIHNvcnRPYmplY3RzKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gcmVuZGVyU2NlbmUoY3VycmVudFJlbmRlckxpc3QyLCBzY2VuZSwgY2FtZXJhLCB2aWV3cG9ydCkgewogICAgY29uc3Qgb3BhcXVlT2JqZWN0cyA9IGN1cnJlbnRSZW5kZXJMaXN0Mi5vcGFxdWU7CiAgICBjb25zdCB0cmFuc21pc3NpdmVPYmplY3RzID0gY3VycmVudFJlbmRlckxpc3QyLnRyYW5zbWlzc2l2ZTsKICAgIGNvbnN0IHRyYW5zcGFyZW50T2JqZWN0cyA9IGN1cnJlbnRSZW5kZXJMaXN0Mi50cmFuc3BhcmVudDsKICAgIGN1cnJlbnRSZW5kZXJTdGF0ZS5zZXR1cExpZ2h0c1ZpZXcoY2FtZXJhKTsKICAgIGlmICh0cmFuc21pc3NpdmVPYmplY3RzLmxlbmd0aCA+IDApCiAgICAgIHJlbmRlclRyYW5zbWlzc2lvblBhc3Mob3BhcXVlT2JqZWN0cywgc2NlbmUsIGNhbWVyYSk7CiAgICBpZiAodmlld3BvcnQpCiAgICAgIHN0YXRlLnZpZXdwb3J0KF9jdXJyZW50Vmlld3BvcnQuY29weSh2aWV3cG9ydCkpOwogICAgaWYgKG9wYXF1ZU9iamVjdHMubGVuZ3RoID4gMCkKICAgICAgcmVuZGVyT2JqZWN0cyhvcGFxdWVPYmplY3RzLCBzY2VuZSwgY2FtZXJhKTsKICAgIGlmICh0cmFuc21pc3NpdmVPYmplY3RzLmxlbmd0aCA+IDApCiAgICAgIHJlbmRlck9iamVjdHModHJhbnNtaXNzaXZlT2JqZWN0cywgc2NlbmUsIGNhbWVyYSk7CiAgICBpZiAodHJhbnNwYXJlbnRPYmplY3RzLmxlbmd0aCA+IDApCiAgICAgIHJlbmRlck9iamVjdHModHJhbnNwYXJlbnRPYmplY3RzLCBzY2VuZSwgY2FtZXJhKTsKICB9CiAgZnVuY3Rpb24gcmVuZGVyVHJhbnNtaXNzaW9uUGFzcyhvcGFxdWVPYmplY3RzLCBzY2VuZSwgY2FtZXJhKSB7CiAgICBpZiAoX3RyYW5zbWlzc2lvblJlbmRlclRhcmdldCA9PT0gbnVsbCkgewogICAgICBjb25zdCBuZWVkc0FudGlhbGlhcyA9IF9hbnRpYWxpYXMgPT09IHRydWUgJiYgY2FwYWJpbGl0aWVzLmlzV2ViR0wyID09PSB0cnVlOwogICAgICBjb25zdCByZW5kZXJUYXJnZXRUeXBlID0gbmVlZHNBbnRpYWxpYXMgPyBXZWJHTE11bHRpc2FtcGxlUmVuZGVyVGFyZ2V0IDogV2ViR0xSZW5kZXJUYXJnZXQ7CiAgICAgIF90cmFuc21pc3Npb25SZW5kZXJUYXJnZXQgPSBuZXcgcmVuZGVyVGFyZ2V0VHlwZSgxMDI0LCAxMDI0LCB7CiAgICAgICAgZ2VuZXJhdGVNaXBtYXBzOiB0cnVlLAogICAgICAgIHR5cGU6IHV0aWxzLmNvbnZlcnQoSGFsZkZsb2F0VHlwZSkgIT09IG51bGwgPyBIYWxmRmxvYXRUeXBlIDogVW5zaWduZWRCeXRlVHlwZSwKICAgICAgICBtaW5GaWx0ZXI6IExpbmVhck1pcG1hcExpbmVhckZpbHRlciwKICAgICAgICBtYWdGaWx0ZXI6IE5lYXJlc3RGaWx0ZXIsCiAgICAgICAgd3JhcFM6IENsYW1wVG9FZGdlV3JhcHBpbmcsCiAgICAgICAgd3JhcFQ6IENsYW1wVG9FZGdlV3JhcHBpbmcsCiAgICAgICAgdXNlUmVuZGVyVG9UZXh0dXJlOiBleHRlbnNpb25zLmhhcygiV0VCR0xfbXVsdGlzYW1wbGVkX3JlbmRlcl90b190ZXh0dXJlIikKICAgICAgfSk7CiAgICB9CiAgICBjb25zdCBjdXJyZW50UmVuZGVyVGFyZ2V0ID0gX3RoaXMuZ2V0UmVuZGVyVGFyZ2V0KCk7CiAgICBfdGhpcy5zZXRSZW5kZXJUYXJnZXQoX3RyYW5zbWlzc2lvblJlbmRlclRhcmdldCk7CiAgICBfdGhpcy5jbGVhcigpOwogICAgY29uc3QgY3VycmVudFRvbmVNYXBwaW5nID0gX3RoaXMudG9uZU1hcHBpbmc7CiAgICBfdGhpcy50b25lTWFwcGluZyA9IE5vVG9uZU1hcHBpbmc7CiAgICByZW5kZXJPYmplY3RzKG9wYXF1ZU9iamVjdHMsIHNjZW5lLCBjYW1lcmEpOwogICAgX3RoaXMudG9uZU1hcHBpbmcgPSBjdXJyZW50VG9uZU1hcHBpbmc7CiAgICB0ZXh0dXJlcy51cGRhdGVNdWx0aXNhbXBsZVJlbmRlclRhcmdldChfdHJhbnNtaXNzaW9uUmVuZGVyVGFyZ2V0KTsKICAgIHRleHR1cmVzLnVwZGF0ZVJlbmRlclRhcmdldE1pcG1hcChfdHJhbnNtaXNzaW9uUmVuZGVyVGFyZ2V0KTsKICAgIF90aGlzLnNldFJlbmRlclRhcmdldChjdXJyZW50UmVuZGVyVGFyZ2V0KTsKICB9CiAgZnVuY3Rpb24gcmVuZGVyT2JqZWN0cyhyZW5kZXJMaXN0LCBzY2VuZSwgY2FtZXJhKSB7CiAgICBjb25zdCBvdmVycmlkZU1hdGVyaWFsID0gc2NlbmUuaXNTY2VuZSA9PT0gdHJ1ZSA/IHNjZW5lLm92ZXJyaWRlTWF0ZXJpYWwgOiBudWxsOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSByZW5kZXJMaXN0Lmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBjb25zdCByZW5kZXJJdGVtID0gcmVuZGVyTGlzdFtpXTsKICAgICAgY29uc3Qgb2JqZWN0ID0gcmVuZGVySXRlbS5vYmplY3Q7CiAgICAgIGNvbnN0IGdlb21ldHJ5ID0gcmVuZGVySXRlbS5nZW9tZXRyeTsKICAgICAgY29uc3QgbWF0ZXJpYWwgPSBvdmVycmlkZU1hdGVyaWFsID09PSBudWxsID8gcmVuZGVySXRlbS5tYXRlcmlhbCA6IG92ZXJyaWRlTWF0ZXJpYWw7CiAgICAgIGNvbnN0IGdyb3VwID0gcmVuZGVySXRlbS5ncm91cDsKICAgICAgaWYgKG9iamVjdC5sYXllcnMudGVzdChjYW1lcmEubGF5ZXJzKSkgewogICAgICAgIHJlbmRlck9iamVjdChvYmplY3QsIHNjZW5lLCBjYW1lcmEsIGdlb21ldHJ5LCBtYXRlcmlhbCwgZ3JvdXApOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlbmRlck9iamVjdChvYmplY3QsIHNjZW5lLCBjYW1lcmEsIGdlb21ldHJ5LCBtYXRlcmlhbCwgZ3JvdXApIHsKICAgIG9iamVjdC5vbkJlZm9yZVJlbmRlcihfdGhpcywgc2NlbmUsIGNhbWVyYSwgZ2VvbWV0cnksIG1hdGVyaWFsLCBncm91cCk7CiAgICBvYmplY3QubW9kZWxWaWV3TWF0cml4Lm11bHRpcGx5TWF0cmljZXMoY2FtZXJhLm1hdHJpeFdvcmxkSW52ZXJzZSwgb2JqZWN0Lm1hdHJpeFdvcmxkKTsKICAgIG9iamVjdC5ub3JtYWxNYXRyaXguZ2V0Tm9ybWFsTWF0cml4KG9iamVjdC5tb2RlbFZpZXdNYXRyaXgpOwogICAgbWF0ZXJpYWwub25CZWZvcmVSZW5kZXIoX3RoaXMsIHNjZW5lLCBjYW1lcmEsIGdlb21ldHJ5LCBvYmplY3QsIGdyb3VwKTsKICAgIGlmIChtYXRlcmlhbC50cmFuc3BhcmVudCA9PT0gdHJ1ZSAmJiBtYXRlcmlhbC5zaWRlID09PSBEb3VibGVTaWRlKSB7CiAgICAgIG1hdGVyaWFsLnNpZGUgPSBCYWNrU2lkZTsKICAgICAgbWF0ZXJpYWwubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICBfdGhpcy5yZW5kZXJCdWZmZXJEaXJlY3QoY2FtZXJhLCBzY2VuZSwgZ2VvbWV0cnksIG1hdGVyaWFsLCBvYmplY3QsIGdyb3VwKTsKICAgICAgbWF0ZXJpYWwuc2lkZSA9IEZyb250U2lkZTsKICAgICAgbWF0ZXJpYWwubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICBfdGhpcy5yZW5kZXJCdWZmZXJEaXJlY3QoY2FtZXJhLCBzY2VuZSwgZ2VvbWV0cnksIG1hdGVyaWFsLCBvYmplY3QsIGdyb3VwKTsKICAgICAgbWF0ZXJpYWwuc2lkZSA9IERvdWJsZVNpZGU7CiAgICB9IGVsc2UgewogICAgICBfdGhpcy5yZW5kZXJCdWZmZXJEaXJlY3QoY2FtZXJhLCBzY2VuZSwgZ2VvbWV0cnksIG1hdGVyaWFsLCBvYmplY3QsIGdyb3VwKTsKICAgIH0KICAgIG9iamVjdC5vbkFmdGVyUmVuZGVyKF90aGlzLCBzY2VuZSwgY2FtZXJhLCBnZW9tZXRyeSwgbWF0ZXJpYWwsIGdyb3VwKTsKICB9CiAgZnVuY3Rpb24gZ2V0UHJvZ3JhbShtYXRlcmlhbCwgc2NlbmUsIG9iamVjdCkgewogICAgaWYgKHNjZW5lLmlzU2NlbmUgIT09IHRydWUpCiAgICAgIHNjZW5lID0gX2VtcHR5U2NlbmU7CiAgICBjb25zdCBtYXRlcmlhbFByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzLmdldChtYXRlcmlhbCk7CiAgICBjb25zdCBsaWdodHMgPSBjdXJyZW50UmVuZGVyU3RhdGUuc3RhdGUubGlnaHRzOwogICAgY29uc3Qgc2hhZG93c0FycmF5ID0gY3VycmVudFJlbmRlclN0YXRlLnN0YXRlLnNoYWRvd3NBcnJheTsKICAgIGNvbnN0IGxpZ2h0c1N0YXRlVmVyc2lvbiA9IGxpZ2h0cy5zdGF0ZS52ZXJzaW9uOwogICAgY29uc3QgcGFyYW1ldGVyczIgPSBwcm9ncmFtQ2FjaGUuZ2V0UGFyYW1ldGVycyhtYXRlcmlhbCwgbGlnaHRzLnN0YXRlLCBzaGFkb3dzQXJyYXksIHNjZW5lLCBvYmplY3QpOwogICAgY29uc3QgcHJvZ3JhbUNhY2hlS2V5ID0gcHJvZ3JhbUNhY2hlLmdldFByb2dyYW1DYWNoZUtleShwYXJhbWV0ZXJzMik7CiAgICBsZXQgcHJvZ3JhbXMgPSBtYXRlcmlhbFByb3BlcnRpZXMucHJvZ3JhbXM7CiAgICBtYXRlcmlhbFByb3BlcnRpZXMuZW52aXJvbm1lbnQgPSBtYXRlcmlhbC5pc01lc2hTdGFuZGFyZE1hdGVyaWFsID8gc2NlbmUuZW52aXJvbm1lbnQgOiBudWxsOwogICAgbWF0ZXJpYWxQcm9wZXJ0aWVzLmZvZyA9IHNjZW5lLmZvZzsKICAgIG1hdGVyaWFsUHJvcGVydGllcy5lbnZNYXAgPSAobWF0ZXJpYWwuaXNNZXNoU3RhbmRhcmRNYXRlcmlhbCA/IGN1YmV1dm1hcHMgOiBjdWJlbWFwcykuZ2V0KG1hdGVyaWFsLmVudk1hcCB8fCBtYXRlcmlhbFByb3BlcnRpZXMuZW52aXJvbm1lbnQpOwogICAgaWYgKHByb2dyYW1zID09PSB2b2lkIDApIHsKICAgICAgbWF0ZXJpYWwuYWRkRXZlbnRMaXN0ZW5lcigiZGlzcG9zZSIsIG9uTWF0ZXJpYWxEaXNwb3NlKTsKICAgICAgcHJvZ3JhbXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogICAgICBtYXRlcmlhbFByb3BlcnRpZXMucHJvZ3JhbXMgPSBwcm9ncmFtczsKICAgIH0KICAgIGxldCBwcm9ncmFtID0gcHJvZ3JhbXMuZ2V0KHByb2dyYW1DYWNoZUtleSk7CiAgICBpZiAocHJvZ3JhbSAhPT0gdm9pZCAwKSB7CiAgICAgIGlmIChtYXRlcmlhbFByb3BlcnRpZXMuY3VycmVudFByb2dyYW0gPT09IHByb2dyYW0gJiYgbWF0ZXJpYWxQcm9wZXJ0aWVzLmxpZ2h0c1N0YXRlVmVyc2lvbiA9PT0gbGlnaHRzU3RhdGVWZXJzaW9uKSB7CiAgICAgICAgdXBkYXRlQ29tbW9uTWF0ZXJpYWxQcm9wZXJ0aWVzKG1hdGVyaWFsLCBwYXJhbWV0ZXJzMik7CiAgICAgICAgcmV0dXJuIHByb2dyYW07CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHBhcmFtZXRlcnMyLnVuaWZvcm1zID0gcHJvZ3JhbUNhY2hlLmdldFVuaWZvcm1zKG1hdGVyaWFsKTsKICAgICAgbWF0ZXJpYWwub25CdWlsZChvYmplY3QsIHBhcmFtZXRlcnMyLCBfdGhpcyk7CiAgICAgIG1hdGVyaWFsLm9uQmVmb3JlQ29tcGlsZShwYXJhbWV0ZXJzMiwgX3RoaXMpOwogICAgICBwcm9ncmFtID0gcHJvZ3JhbUNhY2hlLmFjcXVpcmVQcm9ncmFtKHBhcmFtZXRlcnMyLCBwcm9ncmFtQ2FjaGVLZXkpOwogICAgICBwcm9ncmFtcy5zZXQocHJvZ3JhbUNhY2hlS2V5LCBwcm9ncmFtKTsKICAgICAgbWF0ZXJpYWxQcm9wZXJ0aWVzLnVuaWZvcm1zID0gcGFyYW1ldGVyczIudW5pZm9ybXM7CiAgICB9CiAgICBjb25zdCB1bmlmb3JtcyA9IG1hdGVyaWFsUHJvcGVydGllcy51bmlmb3JtczsKICAgIGlmICghbWF0ZXJpYWwuaXNTaGFkZXJNYXRlcmlhbCAmJiAhbWF0ZXJpYWwuaXNSYXdTaGFkZXJNYXRlcmlhbCB8fCBtYXRlcmlhbC5jbGlwcGluZyA9PT0gdHJ1ZSkgewogICAgICB1bmlmb3Jtcy5jbGlwcGluZ1BsYW5lcyA9IGNsaXBwaW5nLnVuaWZvcm07CiAgICB9CiAgICB1cGRhdGVDb21tb25NYXRlcmlhbFByb3BlcnRpZXMobWF0ZXJpYWwsIHBhcmFtZXRlcnMyKTsKICAgIG1hdGVyaWFsUHJvcGVydGllcy5uZWVkc0xpZ2h0cyA9IG1hdGVyaWFsTmVlZHNMaWdodHMobWF0ZXJpYWwpOwogICAgbWF0ZXJpYWxQcm9wZXJ0aWVzLmxpZ2h0c1N0YXRlVmVyc2lvbiA9IGxpZ2h0c1N0YXRlVmVyc2lvbjsKICAgIGlmIChtYXRlcmlhbFByb3BlcnRpZXMubmVlZHNMaWdodHMpIHsKICAgICAgdW5pZm9ybXMuYW1iaWVudExpZ2h0Q29sb3IudmFsdWUgPSBsaWdodHMuc3RhdGUuYW1iaWVudDsKICAgICAgdW5pZm9ybXMubGlnaHRQcm9iZS52YWx1ZSA9IGxpZ2h0cy5zdGF0ZS5wcm9iZTsKICAgICAgdW5pZm9ybXMuZGlyZWN0aW9uYWxMaWdodHMudmFsdWUgPSBsaWdodHMuc3RhdGUuZGlyZWN0aW9uYWw7CiAgICAgIHVuaWZvcm1zLmRpcmVjdGlvbmFsTGlnaHRTaGFkb3dzLnZhbHVlID0gbGlnaHRzLnN0YXRlLmRpcmVjdGlvbmFsU2hhZG93OwogICAgICB1bmlmb3Jtcy5zcG90TGlnaHRzLnZhbHVlID0gbGlnaHRzLnN0YXRlLnNwb3Q7CiAgICAgIHVuaWZvcm1zLnNwb3RMaWdodFNoYWRvd3MudmFsdWUgPSBsaWdodHMuc3RhdGUuc3BvdFNoYWRvdzsKICAgICAgdW5pZm9ybXMucmVjdEFyZWFMaWdodHMudmFsdWUgPSBsaWdodHMuc3RhdGUucmVjdEFyZWE7CiAgICAgIHVuaWZvcm1zLmx0Y18xLnZhbHVlID0gbGlnaHRzLnN0YXRlLnJlY3RBcmVhTFRDMTsKICAgICAgdW5pZm9ybXMubHRjXzIudmFsdWUgPSBsaWdodHMuc3RhdGUucmVjdEFyZWFMVEMyOwogICAgICB1bmlmb3Jtcy5wb2ludExpZ2h0cy52YWx1ZSA9IGxpZ2h0cy5zdGF0ZS5wb2ludDsKICAgICAgdW5pZm9ybXMucG9pbnRMaWdodFNoYWRvd3MudmFsdWUgPSBsaWdodHMuc3RhdGUucG9pbnRTaGFkb3c7CiAgICAgIHVuaWZvcm1zLmhlbWlzcGhlcmVMaWdodHMudmFsdWUgPSBsaWdodHMuc3RhdGUuaGVtaTsKICAgICAgdW5pZm9ybXMuZGlyZWN0aW9uYWxTaGFkb3dNYXAudmFsdWUgPSBsaWdodHMuc3RhdGUuZGlyZWN0aW9uYWxTaGFkb3dNYXA7CiAgICAgIHVuaWZvcm1zLmRpcmVjdGlvbmFsU2hhZG93TWF0cml4LnZhbHVlID0gbGlnaHRzLnN0YXRlLmRpcmVjdGlvbmFsU2hhZG93TWF0cml4OwogICAgICB1bmlmb3Jtcy5zcG90U2hhZG93TWFwLnZhbHVlID0gbGlnaHRzLnN0YXRlLnNwb3RTaGFkb3dNYXA7CiAgICAgIHVuaWZvcm1zLnNwb3RTaGFkb3dNYXRyaXgudmFsdWUgPSBsaWdodHMuc3RhdGUuc3BvdFNoYWRvd01hdHJpeDsKICAgICAgdW5pZm9ybXMucG9pbnRTaGFkb3dNYXAudmFsdWUgPSBsaWdodHMuc3RhdGUucG9pbnRTaGFkb3dNYXA7CiAgICAgIHVuaWZvcm1zLnBvaW50U2hhZG93TWF0cml4LnZhbHVlID0gbGlnaHRzLnN0YXRlLnBvaW50U2hhZG93TWF0cml4OwogICAgfQogICAgY29uc3QgcHJvZ1VuaWZvcm1zID0gcHJvZ3JhbS5nZXRVbmlmb3JtcygpOwogICAgY29uc3QgdW5pZm9ybXNMaXN0ID0gV2ViR0xVbmlmb3Jtcy5zZXFXaXRoVmFsdWUocHJvZ1VuaWZvcm1zLnNlcSwgdW5pZm9ybXMpOwogICAgbWF0ZXJpYWxQcm9wZXJ0aWVzLmN1cnJlbnRQcm9ncmFtID0gcHJvZ3JhbTsKICAgIG1hdGVyaWFsUHJvcGVydGllcy51bmlmb3Jtc0xpc3QgPSB1bmlmb3Jtc0xpc3Q7CiAgICByZXR1cm4gcHJvZ3JhbTsKICB9CiAgZnVuY3Rpb24gdXBkYXRlQ29tbW9uTWF0ZXJpYWxQcm9wZXJ0aWVzKG1hdGVyaWFsLCBwYXJhbWV0ZXJzMikgewogICAgY29uc3QgbWF0ZXJpYWxQcm9wZXJ0aWVzID0gcHJvcGVydGllcy5nZXQobWF0ZXJpYWwpOwogICAgbWF0ZXJpYWxQcm9wZXJ0aWVzLm91dHB1dEVuY29kaW5nID0gcGFyYW1ldGVyczIub3V0cHV0RW5jb2Rpbmc7CiAgICBtYXRlcmlhbFByb3BlcnRpZXMuaW5zdGFuY2luZyA9IHBhcmFtZXRlcnMyLmluc3RhbmNpbmc7CiAgICBtYXRlcmlhbFByb3BlcnRpZXMuc2tpbm5pbmcgPSBwYXJhbWV0ZXJzMi5za2lubmluZzsKICAgIG1hdGVyaWFsUHJvcGVydGllcy5tb3JwaFRhcmdldHMgPSBwYXJhbWV0ZXJzMi5tb3JwaFRhcmdldHM7CiAgICBtYXRlcmlhbFByb3BlcnRpZXMubW9ycGhOb3JtYWxzID0gcGFyYW1ldGVyczIubW9ycGhOb3JtYWxzOwogICAgbWF0ZXJpYWxQcm9wZXJ0aWVzLm1vcnBoVGFyZ2V0c0NvdW50ID0gcGFyYW1ldGVyczIubW9ycGhUYXJnZXRzQ291bnQ7CiAgICBtYXRlcmlhbFByb3BlcnRpZXMubnVtQ2xpcHBpbmdQbGFuZXMgPSBwYXJhbWV0ZXJzMi5udW1DbGlwcGluZ1BsYW5lczsKICAgIG1hdGVyaWFsUHJvcGVydGllcy5udW1JbnRlcnNlY3Rpb24gPSBwYXJhbWV0ZXJzMi5udW1DbGlwSW50ZXJzZWN0aW9uOwogICAgbWF0ZXJpYWxQcm9wZXJ0aWVzLnZlcnRleEFscGhhcyA9IHBhcmFtZXRlcnMyLnZlcnRleEFscGhhczsKICAgIG1hdGVyaWFsUHJvcGVydGllcy52ZXJ0ZXhUYW5nZW50cyA9IHBhcmFtZXRlcnMyLnZlcnRleFRhbmdlbnRzOwogICAgbWF0ZXJpYWxQcm9wZXJ0aWVzLnRvbmVNYXBwaW5nID0gcGFyYW1ldGVyczIudG9uZU1hcHBpbmc7CiAgfQogIGZ1bmN0aW9uIHNldFByb2dyYW0oY2FtZXJhLCBzY2VuZSwgZ2VvbWV0cnksIG1hdGVyaWFsLCBvYmplY3QpIHsKICAgIGlmIChzY2VuZS5pc1NjZW5lICE9PSB0cnVlKQogICAgICBzY2VuZSA9IF9lbXB0eVNjZW5lOwogICAgdGV4dHVyZXMucmVzZXRUZXh0dXJlVW5pdHMoKTsKICAgIGNvbnN0IGZvZyA9IHNjZW5lLmZvZzsKICAgIGNvbnN0IGVudmlyb25tZW50ID0gbWF0ZXJpYWwuaXNNZXNoU3RhbmRhcmRNYXRlcmlhbCA/IHNjZW5lLmVudmlyb25tZW50IDogbnVsbDsKICAgIGNvbnN0IGVuY29kaW5nID0gX2N1cnJlbnRSZW5kZXJUYXJnZXQgPT09IG51bGwgPyBfdGhpcy5vdXRwdXRFbmNvZGluZyA6IF9jdXJyZW50UmVuZGVyVGFyZ2V0LmlzWFJSZW5kZXJUYXJnZXQgPT09IHRydWUgPyBfY3VycmVudFJlbmRlclRhcmdldC50ZXh0dXJlLmVuY29kaW5nIDogTGluZWFyRW5jb2Rpbmc7CiAgICBjb25zdCBlbnZNYXAgPSAobWF0ZXJpYWwuaXNNZXNoU3RhbmRhcmRNYXRlcmlhbCA/IGN1YmV1dm1hcHMgOiBjdWJlbWFwcykuZ2V0KG1hdGVyaWFsLmVudk1hcCB8fCBlbnZpcm9ubWVudCk7CiAgICBjb25zdCB2ZXJ0ZXhBbHBoYXMgPSBtYXRlcmlhbC52ZXJ0ZXhDb2xvcnMgPT09IHRydWUgJiYgISFnZW9tZXRyeS5hdHRyaWJ1dGVzLmNvbG9yICYmIGdlb21ldHJ5LmF0dHJpYnV0ZXMuY29sb3IuaXRlbVNpemUgPT09IDQ7CiAgICBjb25zdCB2ZXJ0ZXhUYW5nZW50cyA9ICEhbWF0ZXJpYWwubm9ybWFsTWFwICYmICEhZ2VvbWV0cnkuYXR0cmlidXRlcy50YW5nZW50OwogICAgY29uc3QgbW9ycGhUYXJnZXRzID0gISFnZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXMucG9zaXRpb247CiAgICBjb25zdCBtb3JwaE5vcm1hbHMgPSAhIWdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcy5ub3JtYWw7CiAgICBjb25zdCBtb3JwaFRhcmdldHNDb3VudCA9ICEhZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzLnBvc2l0aW9uID8gZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzLnBvc2l0aW9uLmxlbmd0aCA6IDA7CiAgICBjb25zdCB0b25lTWFwcGluZyA9IG1hdGVyaWFsLnRvbmVNYXBwZWQgPyBfdGhpcy50b25lTWFwcGluZyA6IE5vVG9uZU1hcHBpbmc7CiAgICBjb25zdCBtYXRlcmlhbFByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzLmdldChtYXRlcmlhbCk7CiAgICBjb25zdCBsaWdodHMgPSBjdXJyZW50UmVuZGVyU3RhdGUuc3RhdGUubGlnaHRzOwogICAgaWYgKF9jbGlwcGluZ0VuYWJsZWQgPT09IHRydWUpIHsKICAgICAgaWYgKF9sb2NhbENsaXBwaW5nRW5hYmxlZCA9PT0gdHJ1ZSB8fCBjYW1lcmEgIT09IF9jdXJyZW50Q2FtZXJhKSB7CiAgICAgICAgY29uc3QgdXNlQ2FjaGUgPSBjYW1lcmEgPT09IF9jdXJyZW50Q2FtZXJhICYmIG1hdGVyaWFsLmlkID09PSBfY3VycmVudE1hdGVyaWFsSWQ7CiAgICAgICAgY2xpcHBpbmcuc2V0U3RhdGUobWF0ZXJpYWwsIGNhbWVyYSwgdXNlQ2FjaGUpOwogICAgICB9CiAgICB9CiAgICBsZXQgbmVlZHNQcm9ncmFtQ2hhbmdlID0gZmFsc2U7CiAgICBpZiAobWF0ZXJpYWwudmVyc2lvbiA9PT0gbWF0ZXJpYWxQcm9wZXJ0aWVzLl9fdmVyc2lvbikgewogICAgICBpZiAobWF0ZXJpYWxQcm9wZXJ0aWVzLm5lZWRzTGlnaHRzICYmIG1hdGVyaWFsUHJvcGVydGllcy5saWdodHNTdGF0ZVZlcnNpb24gIT09IGxpZ2h0cy5zdGF0ZS52ZXJzaW9uKSB7CiAgICAgICAgbmVlZHNQcm9ncmFtQ2hhbmdlID0gdHJ1ZTsKICAgICAgfSBlbHNlIGlmIChtYXRlcmlhbFByb3BlcnRpZXMub3V0cHV0RW5jb2RpbmcgIT09IGVuY29kaW5nKSB7CiAgICAgICAgbmVlZHNQcm9ncmFtQ2hhbmdlID0gdHJ1ZTsKICAgICAgfSBlbHNlIGlmIChvYmplY3QuaXNJbnN0YW5jZWRNZXNoICYmIG1hdGVyaWFsUHJvcGVydGllcy5pbnN0YW5jaW5nID09PSBmYWxzZSkgewogICAgICAgIG5lZWRzUHJvZ3JhbUNoYW5nZSA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAoIW9iamVjdC5pc0luc3RhbmNlZE1lc2ggJiYgbWF0ZXJpYWxQcm9wZXJ0aWVzLmluc3RhbmNpbmcgPT09IHRydWUpIHsKICAgICAgICBuZWVkc1Byb2dyYW1DaGFuZ2UgPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKG9iamVjdC5pc1NraW5uZWRNZXNoICYmIG1hdGVyaWFsUHJvcGVydGllcy5za2lubmluZyA9PT0gZmFsc2UpIHsKICAgICAgICBuZWVkc1Byb2dyYW1DaGFuZ2UgPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKCFvYmplY3QuaXNTa2lubmVkTWVzaCAmJiBtYXRlcmlhbFByb3BlcnRpZXMuc2tpbm5pbmcgPT09IHRydWUpIHsKICAgICAgICBuZWVkc1Byb2dyYW1DaGFuZ2UgPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKG1hdGVyaWFsUHJvcGVydGllcy5lbnZNYXAgIT09IGVudk1hcCkgewogICAgICAgIG5lZWRzUHJvZ3JhbUNoYW5nZSA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAobWF0ZXJpYWwuZm9nICYmIG1hdGVyaWFsUHJvcGVydGllcy5mb2cgIT09IGZvZykgewogICAgICAgIG5lZWRzUHJvZ3JhbUNoYW5nZSA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAobWF0ZXJpYWxQcm9wZXJ0aWVzLm51bUNsaXBwaW5nUGxhbmVzICE9PSB2b2lkIDAgJiYgKG1hdGVyaWFsUHJvcGVydGllcy5udW1DbGlwcGluZ1BsYW5lcyAhPT0gY2xpcHBpbmcubnVtUGxhbmVzIHx8IG1hdGVyaWFsUHJvcGVydGllcy5udW1JbnRlcnNlY3Rpb24gIT09IGNsaXBwaW5nLm51bUludGVyc2VjdGlvbikpIHsKICAgICAgICBuZWVkc1Byb2dyYW1DaGFuZ2UgPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKG1hdGVyaWFsUHJvcGVydGllcy52ZXJ0ZXhBbHBoYXMgIT09IHZlcnRleEFscGhhcykgewogICAgICAgIG5lZWRzUHJvZ3JhbUNoYW5nZSA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAobWF0ZXJpYWxQcm9wZXJ0aWVzLnZlcnRleFRhbmdlbnRzICE9PSB2ZXJ0ZXhUYW5nZW50cykgewogICAgICAgIG5lZWRzUHJvZ3JhbUNoYW5nZSA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAobWF0ZXJpYWxQcm9wZXJ0aWVzLm1vcnBoVGFyZ2V0cyAhPT0gbW9ycGhUYXJnZXRzKSB7CiAgICAgICAgbmVlZHNQcm9ncmFtQ2hhbmdlID0gdHJ1ZTsKICAgICAgfSBlbHNlIGlmIChtYXRlcmlhbFByb3BlcnRpZXMubW9ycGhOb3JtYWxzICE9PSBtb3JwaE5vcm1hbHMpIHsKICAgICAgICBuZWVkc1Byb2dyYW1DaGFuZ2UgPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKG1hdGVyaWFsUHJvcGVydGllcy50b25lTWFwcGluZyAhPT0gdG9uZU1hcHBpbmcpIHsKICAgICAgICBuZWVkc1Byb2dyYW1DaGFuZ2UgPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKGNhcGFiaWxpdGllcy5pc1dlYkdMMiA9PT0gdHJ1ZSAmJiBtYXRlcmlhbFByb3BlcnRpZXMubW9ycGhUYXJnZXRzQ291bnQgIT09IG1vcnBoVGFyZ2V0c0NvdW50KSB7CiAgICAgICAgbmVlZHNQcm9ncmFtQ2hhbmdlID0gdHJ1ZTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgbmVlZHNQcm9ncmFtQ2hhbmdlID0gdHJ1ZTsKICAgICAgbWF0ZXJpYWxQcm9wZXJ0aWVzLl9fdmVyc2lvbiA9IG1hdGVyaWFsLnZlcnNpb247CiAgICB9CiAgICBsZXQgcHJvZ3JhbSA9IG1hdGVyaWFsUHJvcGVydGllcy5jdXJyZW50UHJvZ3JhbTsKICAgIGlmIChuZWVkc1Byb2dyYW1DaGFuZ2UgPT09IHRydWUpIHsKICAgICAgcHJvZ3JhbSA9IGdldFByb2dyYW0obWF0ZXJpYWwsIHNjZW5lLCBvYmplY3QpOwogICAgfQogICAgbGV0IHJlZnJlc2hQcm9ncmFtID0gZmFsc2U7CiAgICBsZXQgcmVmcmVzaE1hdGVyaWFsID0gZmFsc2U7CiAgICBsZXQgcmVmcmVzaExpZ2h0cyA9IGZhbHNlOwogICAgY29uc3QgcF91bmlmb3JtcyA9IHByb2dyYW0uZ2V0VW5pZm9ybXMoKSwgbV91bmlmb3JtcyA9IG1hdGVyaWFsUHJvcGVydGllcy51bmlmb3JtczsKICAgIGlmIChzdGF0ZS51c2VQcm9ncmFtKHByb2dyYW0ucHJvZ3JhbSkpIHsKICAgICAgcmVmcmVzaFByb2dyYW0gPSB0cnVlOwogICAgICByZWZyZXNoTWF0ZXJpYWwgPSB0cnVlOwogICAgICByZWZyZXNoTGlnaHRzID0gdHJ1ZTsKICAgIH0KICAgIGlmIChtYXRlcmlhbC5pZCAhPT0gX2N1cnJlbnRNYXRlcmlhbElkKSB7CiAgICAgIF9jdXJyZW50TWF0ZXJpYWxJZCA9IG1hdGVyaWFsLmlkOwogICAgICByZWZyZXNoTWF0ZXJpYWwgPSB0cnVlOwogICAgfQogICAgaWYgKHJlZnJlc2hQcm9ncmFtIHx8IF9jdXJyZW50Q2FtZXJhICE9PSBjYW1lcmEpIHsKICAgICAgcF91bmlmb3Jtcy5zZXRWYWx1ZShfZ2wsICJwcm9qZWN0aW9uTWF0cml4IiwgY2FtZXJhLnByb2plY3Rpb25NYXRyaXgpOwogICAgICBpZiAoY2FwYWJpbGl0aWVzLmxvZ2FyaXRobWljRGVwdGhCdWZmZXIpIHsKICAgICAgICBwX3VuaWZvcm1zLnNldFZhbHVlKF9nbCwgImxvZ0RlcHRoQnVmRkMiLCAyIC8gKE1hdGgubG9nKGNhbWVyYS5mYXIgKyAxKSAvIE1hdGguTE4yKSk7CiAgICAgIH0KICAgICAgaWYgKF9jdXJyZW50Q2FtZXJhICE9PSBjYW1lcmEpIHsKICAgICAgICBfY3VycmVudENhbWVyYSA9IGNhbWVyYTsKICAgICAgICByZWZyZXNoTWF0ZXJpYWwgPSB0cnVlOwogICAgICAgIHJlZnJlc2hMaWdodHMgPSB0cnVlOwogICAgICB9CiAgICAgIGlmIChtYXRlcmlhbC5pc1NoYWRlck1hdGVyaWFsIHx8IG1hdGVyaWFsLmlzTWVzaFBob25nTWF0ZXJpYWwgfHwgbWF0ZXJpYWwuaXNNZXNoVG9vbk1hdGVyaWFsIHx8IG1hdGVyaWFsLmlzTWVzaFN0YW5kYXJkTWF0ZXJpYWwgfHwgbWF0ZXJpYWwuZW52TWFwKSB7CiAgICAgICAgY29uc3QgdUNhbVBvcyA9IHBfdW5pZm9ybXMubWFwLmNhbWVyYVBvc2l0aW9uOwogICAgICAgIGlmICh1Q2FtUG9zICE9PSB2b2lkIDApIHsKICAgICAgICAgIHVDYW1Qb3Muc2V0VmFsdWUoX2dsLCBfdmVjdG9yMy5zZXRGcm9tTWF0cml4UG9zaXRpb24oY2FtZXJhLm1hdHJpeFdvcmxkKSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChtYXRlcmlhbC5pc01lc2hQaG9uZ01hdGVyaWFsIHx8IG1hdGVyaWFsLmlzTWVzaFRvb25NYXRlcmlhbCB8fCBtYXRlcmlhbC5pc01lc2hMYW1iZXJ0TWF0ZXJpYWwgfHwgbWF0ZXJpYWwuaXNNZXNoQmFzaWNNYXRlcmlhbCB8fCBtYXRlcmlhbC5pc01lc2hTdGFuZGFyZE1hdGVyaWFsIHx8IG1hdGVyaWFsLmlzU2hhZGVyTWF0ZXJpYWwpIHsKICAgICAgICBwX3VuaWZvcm1zLnNldFZhbHVlKF9nbCwgImlzT3J0aG9ncmFwaGljIiwgY2FtZXJhLmlzT3J0aG9ncmFwaGljQ2FtZXJhID09PSB0cnVlKTsKICAgICAgfQogICAgICBpZiAobWF0ZXJpYWwuaXNNZXNoUGhvbmdNYXRlcmlhbCB8fCBtYXRlcmlhbC5pc01lc2hUb29uTWF0ZXJpYWwgfHwgbWF0ZXJpYWwuaXNNZXNoTGFtYmVydE1hdGVyaWFsIHx8IG1hdGVyaWFsLmlzTWVzaEJhc2ljTWF0ZXJpYWwgfHwgbWF0ZXJpYWwuaXNNZXNoU3RhbmRhcmRNYXRlcmlhbCB8fCBtYXRlcmlhbC5pc1NoYWRlck1hdGVyaWFsIHx8IG1hdGVyaWFsLmlzU2hhZG93TWF0ZXJpYWwgfHwgb2JqZWN0LmlzU2tpbm5lZE1lc2gpIHsKICAgICAgICBwX3VuaWZvcm1zLnNldFZhbHVlKF9nbCwgInZpZXdNYXRyaXgiLCBjYW1lcmEubWF0cml4V29ybGRJbnZlcnNlKTsKICAgICAgfQogICAgfQogICAgaWYgKG9iamVjdC5pc1NraW5uZWRNZXNoKSB7CiAgICAgIHBfdW5pZm9ybXMuc2V0T3B0aW9uYWwoX2dsLCBvYmplY3QsICJiaW5kTWF0cml4Iik7CiAgICAgIHBfdW5pZm9ybXMuc2V0T3B0aW9uYWwoX2dsLCBvYmplY3QsICJiaW5kTWF0cml4SW52ZXJzZSIpOwogICAgICBjb25zdCBza2VsZXRvbiA9IG9iamVjdC5za2VsZXRvbjsKICAgICAgaWYgKHNrZWxldG9uKSB7CiAgICAgICAgaWYgKGNhcGFiaWxpdGllcy5mbG9hdFZlcnRleFRleHR1cmVzKSB7CiAgICAgICAgICBpZiAoc2tlbGV0b24uYm9uZVRleHR1cmUgPT09IG51bGwpCiAgICAgICAgICAgIHNrZWxldG9uLmNvbXB1dGVCb25lVGV4dHVyZSgpOwogICAgICAgICAgcF91bmlmb3Jtcy5zZXRWYWx1ZShfZ2wsICJib25lVGV4dHVyZSIsIHNrZWxldG9uLmJvbmVUZXh0dXJlLCB0ZXh0dXJlcyk7CiAgICAgICAgICBwX3VuaWZvcm1zLnNldFZhbHVlKF9nbCwgImJvbmVUZXh0dXJlU2l6ZSIsIHNrZWxldG9uLmJvbmVUZXh0dXJlU2l6ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHBfdW5pZm9ybXMuc2V0T3B0aW9uYWwoX2dsLCBza2VsZXRvbiwgImJvbmVNYXRyaWNlcyIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgaWYgKCEhZ2VvbWV0cnkgJiYgKGdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcy5wb3NpdGlvbiAhPT0gdm9pZCAwIHx8IGdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcy5ub3JtYWwgIT09IHZvaWQgMCkpIHsKICAgICAgbW9ycGh0YXJnZXRzLnVwZGF0ZShvYmplY3QsIGdlb21ldHJ5LCBtYXRlcmlhbCwgcHJvZ3JhbSk7CiAgICB9CiAgICBpZiAocmVmcmVzaE1hdGVyaWFsIHx8IG1hdGVyaWFsUHJvcGVydGllcy5yZWNlaXZlU2hhZG93ICE9PSBvYmplY3QucmVjZWl2ZVNoYWRvdykgewogICAgICBtYXRlcmlhbFByb3BlcnRpZXMucmVjZWl2ZVNoYWRvdyA9IG9iamVjdC5yZWNlaXZlU2hhZG93OwogICAgICBwX3VuaWZvcm1zLnNldFZhbHVlKF9nbCwgInJlY2VpdmVTaGFkb3ciLCBvYmplY3QucmVjZWl2ZVNoYWRvdyk7CiAgICB9CiAgICBpZiAocmVmcmVzaE1hdGVyaWFsKSB7CiAgICAgIHBfdW5pZm9ybXMuc2V0VmFsdWUoX2dsLCAidG9uZU1hcHBpbmdFeHBvc3VyZSIsIF90aGlzLnRvbmVNYXBwaW5nRXhwb3N1cmUpOwogICAgICBpZiAobWF0ZXJpYWxQcm9wZXJ0aWVzLm5lZWRzTGlnaHRzKSB7CiAgICAgICAgbWFya1VuaWZvcm1zTGlnaHRzTmVlZHNVcGRhdGUobV91bmlmb3JtcywgcmVmcmVzaExpZ2h0cyk7CiAgICAgIH0KICAgICAgaWYgKGZvZyAmJiBtYXRlcmlhbC5mb2cpIHsKICAgICAgICBtYXRlcmlhbHMucmVmcmVzaEZvZ1VuaWZvcm1zKG1fdW5pZm9ybXMsIGZvZyk7CiAgICAgIH0KICAgICAgbWF0ZXJpYWxzLnJlZnJlc2hNYXRlcmlhbFVuaWZvcm1zKG1fdW5pZm9ybXMsIG1hdGVyaWFsLCBfcGl4ZWxSYXRpbywgX2hlaWdodCwgX3RyYW5zbWlzc2lvblJlbmRlclRhcmdldCk7CiAgICAgIFdlYkdMVW5pZm9ybXMudXBsb2FkKF9nbCwgbWF0ZXJpYWxQcm9wZXJ0aWVzLnVuaWZvcm1zTGlzdCwgbV91bmlmb3JtcywgdGV4dHVyZXMpOwogICAgfQogICAgaWYgKG1hdGVyaWFsLmlzU2hhZGVyTWF0ZXJpYWwgJiYgbWF0ZXJpYWwudW5pZm9ybXNOZWVkVXBkYXRlID09PSB0cnVlKSB7CiAgICAgIFdlYkdMVW5pZm9ybXMudXBsb2FkKF9nbCwgbWF0ZXJpYWxQcm9wZXJ0aWVzLnVuaWZvcm1zTGlzdCwgbV91bmlmb3JtcywgdGV4dHVyZXMpOwogICAgICBtYXRlcmlhbC51bmlmb3Jtc05lZWRVcGRhdGUgPSBmYWxzZTsKICAgIH0KICAgIGlmIChtYXRlcmlhbC5pc1Nwcml0ZU1hdGVyaWFsKSB7CiAgICAgIHBfdW5pZm9ybXMuc2V0VmFsdWUoX2dsLCAiY2VudGVyIiwgb2JqZWN0LmNlbnRlcik7CiAgICB9CiAgICBwX3VuaWZvcm1zLnNldFZhbHVlKF9nbCwgIm1vZGVsVmlld01hdHJpeCIsIG9iamVjdC5tb2RlbFZpZXdNYXRyaXgpOwogICAgcF91bmlmb3Jtcy5zZXRWYWx1ZShfZ2wsICJub3JtYWxNYXRyaXgiLCBvYmplY3Qubm9ybWFsTWF0cml4KTsKICAgIHBfdW5pZm9ybXMuc2V0VmFsdWUoX2dsLCAibW9kZWxNYXRyaXgiLCBvYmplY3QubWF0cml4V29ybGQpOwogICAgcmV0dXJuIHByb2dyYW07CiAgfQogIGZ1bmN0aW9uIG1hcmtVbmlmb3Jtc0xpZ2h0c05lZWRzVXBkYXRlKHVuaWZvcm1zLCB2YWx1ZSkgewogICAgdW5pZm9ybXMuYW1iaWVudExpZ2h0Q29sb3IubmVlZHNVcGRhdGUgPSB2YWx1ZTsKICAgIHVuaWZvcm1zLmxpZ2h0UHJvYmUubmVlZHNVcGRhdGUgPSB2YWx1ZTsKICAgIHVuaWZvcm1zLmRpcmVjdGlvbmFsTGlnaHRzLm5lZWRzVXBkYXRlID0gdmFsdWU7CiAgICB1bmlmb3Jtcy5kaXJlY3Rpb25hbExpZ2h0U2hhZG93cy5uZWVkc1VwZGF0ZSA9IHZhbHVlOwogICAgdW5pZm9ybXMucG9pbnRMaWdodHMubmVlZHNVcGRhdGUgPSB2YWx1ZTsKICAgIHVuaWZvcm1zLnBvaW50TGlnaHRTaGFkb3dzLm5lZWRzVXBkYXRlID0gdmFsdWU7CiAgICB1bmlmb3Jtcy5zcG90TGlnaHRzLm5lZWRzVXBkYXRlID0gdmFsdWU7CiAgICB1bmlmb3Jtcy5zcG90TGlnaHRTaGFkb3dzLm5lZWRzVXBkYXRlID0gdmFsdWU7CiAgICB1bmlmb3Jtcy5yZWN0QXJlYUxpZ2h0cy5uZWVkc1VwZGF0ZSA9IHZhbHVlOwogICAgdW5pZm9ybXMuaGVtaXNwaGVyZUxpZ2h0cy5uZWVkc1VwZGF0ZSA9IHZhbHVlOwogIH0KICBmdW5jdGlvbiBtYXRlcmlhbE5lZWRzTGlnaHRzKG1hdGVyaWFsKSB7CiAgICByZXR1cm4gbWF0ZXJpYWwuaXNNZXNoTGFtYmVydE1hdGVyaWFsIHx8IG1hdGVyaWFsLmlzTWVzaFRvb25NYXRlcmlhbCB8fCBtYXRlcmlhbC5pc01lc2hQaG9uZ01hdGVyaWFsIHx8IG1hdGVyaWFsLmlzTWVzaFN0YW5kYXJkTWF0ZXJpYWwgfHwgbWF0ZXJpYWwuaXNTaGFkb3dNYXRlcmlhbCB8fCBtYXRlcmlhbC5pc1NoYWRlck1hdGVyaWFsICYmIG1hdGVyaWFsLmxpZ2h0cyA9PT0gdHJ1ZTsKICB9CiAgdGhpcy5nZXRBY3RpdmVDdWJlRmFjZSA9IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIF9jdXJyZW50QWN0aXZlQ3ViZUZhY2U7CiAgfTsKICB0aGlzLmdldEFjdGl2ZU1pcG1hcExldmVsID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gX2N1cnJlbnRBY3RpdmVNaXBtYXBMZXZlbDsKICB9OwogIHRoaXMuZ2V0UmVuZGVyVGFyZ2V0ID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gX2N1cnJlbnRSZW5kZXJUYXJnZXQ7CiAgfTsKICB0aGlzLnNldFJlbmRlclRhcmdldFRleHR1cmVzID0gZnVuY3Rpb24ocmVuZGVyVGFyZ2V0LCBjb2xvclRleHR1cmUsIGRlcHRoVGV4dHVyZSkgewogICAgcHJvcGVydGllcy5nZXQocmVuZGVyVGFyZ2V0LnRleHR1cmUpLl9fd2ViZ2xUZXh0dXJlID0gY29sb3JUZXh0dXJlOwogICAgcHJvcGVydGllcy5nZXQocmVuZGVyVGFyZ2V0LmRlcHRoVGV4dHVyZSkuX193ZWJnbFRleHR1cmUgPSBkZXB0aFRleHR1cmU7CiAgICBjb25zdCByZW5kZXJUYXJnZXRQcm9wZXJ0aWVzID0gcHJvcGVydGllcy5nZXQocmVuZGVyVGFyZ2V0KTsKICAgIHJlbmRlclRhcmdldFByb3BlcnRpZXMuX19oYXNFeHRlcm5hbFRleHR1cmVzID0gdHJ1ZTsKICAgIGlmIChyZW5kZXJUYXJnZXRQcm9wZXJ0aWVzLl9faGFzRXh0ZXJuYWxUZXh0dXJlcykgewogICAgICByZW5kZXJUYXJnZXRQcm9wZXJ0aWVzLl9fYXV0b0FsbG9jYXRlRGVwdGhCdWZmZXIgPSBkZXB0aFRleHR1cmUgPT09IHZvaWQgMDsKICAgICAgaWYgKCFyZW5kZXJUYXJnZXRQcm9wZXJ0aWVzLl9fYXV0b0FsbG9jYXRlRGVwdGhCdWZmZXIpIHsKICAgICAgICBpZiAocmVuZGVyVGFyZ2V0LnVzZVJlbmRlclRvVGV4dHVyZSkgewogICAgICAgICAgY29uc29sZS53YXJuKCJyZW5kZXItdG8tdGV4dHVyZSBleHRlbnNpb24gd2FzIGRpc2FibGVkIGJlY2F1c2UgYW4gZXh0ZXJuYWwgdGV4dHVyZSB3YXMgcHJvdmlkZWQiKTsKICAgICAgICAgIHJlbmRlclRhcmdldC51c2VSZW5kZXJUb1RleHR1cmUgPSBmYWxzZTsKICAgICAgICAgIHJlbmRlclRhcmdldC51c2VSZW5kZXJidWZmZXIgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH07CiAgdGhpcy5zZXRSZW5kZXJUYXJnZXRGcmFtZWJ1ZmZlciA9IGZ1bmN0aW9uKHJlbmRlclRhcmdldCwgZGVmYXVsdEZyYW1lYnVmZmVyKSB7CiAgICBjb25zdCByZW5kZXJUYXJnZXRQcm9wZXJ0aWVzID0gcHJvcGVydGllcy5nZXQocmVuZGVyVGFyZ2V0KTsKICAgIHJlbmRlclRhcmdldFByb3BlcnRpZXMuX193ZWJnbEZyYW1lYnVmZmVyID0gZGVmYXVsdEZyYW1lYnVmZmVyOwogICAgcmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX3VzZURlZmF1bHRGcmFtZWJ1ZmZlciA9IGRlZmF1bHRGcmFtZWJ1ZmZlciA9PT0gdm9pZCAwOwogIH07CiAgdGhpcy5zZXRSZW5kZXJUYXJnZXQgPSBmdW5jdGlvbihyZW5kZXJUYXJnZXQsIGFjdGl2ZUN1YmVGYWNlID0gMCwgYWN0aXZlTWlwbWFwTGV2ZWwgPSAwKSB7CiAgICBfY3VycmVudFJlbmRlclRhcmdldCA9IHJlbmRlclRhcmdldDsKICAgIF9jdXJyZW50QWN0aXZlQ3ViZUZhY2UgPSBhY3RpdmVDdWJlRmFjZTsKICAgIF9jdXJyZW50QWN0aXZlTWlwbWFwTGV2ZWwgPSBhY3RpdmVNaXBtYXBMZXZlbDsKICAgIGxldCB1c2VEZWZhdWx0RnJhbWVidWZmZXIgPSB0cnVlOwogICAgaWYgKHJlbmRlclRhcmdldCkgewogICAgICBjb25zdCByZW5kZXJUYXJnZXRQcm9wZXJ0aWVzID0gcHJvcGVydGllcy5nZXQocmVuZGVyVGFyZ2V0KTsKICAgICAgaWYgKHJlbmRlclRhcmdldFByb3BlcnRpZXMuX191c2VEZWZhdWx0RnJhbWVidWZmZXIgIT09IHZvaWQgMCkgewogICAgICAgIHN0YXRlLmJpbmRGcmFtZWJ1ZmZlcigzNjE2MCwgbnVsbCk7CiAgICAgICAgdXNlRGVmYXVsdEZyYW1lYnVmZmVyID0gZmFsc2U7CiAgICAgIH0gZWxzZSBpZiAocmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX3dlYmdsRnJhbWVidWZmZXIgPT09IHZvaWQgMCkgewogICAgICAgIHRleHR1cmVzLnNldHVwUmVuZGVyVGFyZ2V0KHJlbmRlclRhcmdldCk7CiAgICAgIH0gZWxzZSBpZiAocmVuZGVyVGFyZ2V0UHJvcGVydGllcy5fX2hhc0V4dGVybmFsVGV4dHVyZXMpIHsKICAgICAgICB0ZXh0dXJlcy5yZWJpbmRUZXh0dXJlcyhyZW5kZXJUYXJnZXQsIHByb3BlcnRpZXMuZ2V0KHJlbmRlclRhcmdldC50ZXh0dXJlKS5fX3dlYmdsVGV4dHVyZSwgcHJvcGVydGllcy5nZXQocmVuZGVyVGFyZ2V0LmRlcHRoVGV4dHVyZSkuX193ZWJnbFRleHR1cmUpOwogICAgICB9CiAgICB9CiAgICBsZXQgZnJhbWVidWZmZXIgPSBudWxsOwogICAgbGV0IGlzQ3ViZSA9IGZhbHNlOwogICAgbGV0IGlzUmVuZGVyVGFyZ2V0M0QgPSBmYWxzZTsKICAgIGlmIChyZW5kZXJUYXJnZXQpIHsKICAgICAgY29uc3QgdGV4dHVyZSA9IHJlbmRlclRhcmdldC50ZXh0dXJlOwogICAgICBpZiAodGV4dHVyZS5pc0RhdGFUZXh0dXJlM0QgfHwgdGV4dHVyZS5pc0RhdGFUZXh0dXJlMkRBcnJheSkgewogICAgICAgIGlzUmVuZGVyVGFyZ2V0M0QgPSB0cnVlOwogICAgICB9CiAgICAgIGNvbnN0IF9fd2ViZ2xGcmFtZWJ1ZmZlciA9IHByb3BlcnRpZXMuZ2V0KHJlbmRlclRhcmdldCkuX193ZWJnbEZyYW1lYnVmZmVyOwogICAgICBpZiAocmVuZGVyVGFyZ2V0LmlzV2ViR0xDdWJlUmVuZGVyVGFyZ2V0KSB7CiAgICAgICAgZnJhbWVidWZmZXIgPSBfX3dlYmdsRnJhbWVidWZmZXJbYWN0aXZlQ3ViZUZhY2VdOwogICAgICAgIGlzQ3ViZSA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAocmVuZGVyVGFyZ2V0LnVzZVJlbmRlcmJ1ZmZlcikgewogICAgICAgIGZyYW1lYnVmZmVyID0gcHJvcGVydGllcy5nZXQocmVuZGVyVGFyZ2V0KS5fX3dlYmdsTXVsdGlzYW1wbGVkRnJhbWVidWZmZXI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZnJhbWVidWZmZXIgPSBfX3dlYmdsRnJhbWVidWZmZXI7CiAgICAgIH0KICAgICAgX2N1cnJlbnRWaWV3cG9ydC5jb3B5KHJlbmRlclRhcmdldC52aWV3cG9ydCk7CiAgICAgIF9jdXJyZW50U2Npc3Nvci5jb3B5KHJlbmRlclRhcmdldC5zY2lzc29yKTsKICAgICAgX2N1cnJlbnRTY2lzc29yVGVzdCA9IHJlbmRlclRhcmdldC5zY2lzc29yVGVzdDsKICAgIH0gZWxzZSB7CiAgICAgIF9jdXJyZW50Vmlld3BvcnQuY29weShfdmlld3BvcnQpLm11bHRpcGx5U2NhbGFyKF9waXhlbFJhdGlvKS5mbG9vcigpOwogICAgICBfY3VycmVudFNjaXNzb3IuY29weShfc2Npc3NvcikubXVsdGlwbHlTY2FsYXIoX3BpeGVsUmF0aW8pLmZsb29yKCk7CiAgICAgIF9jdXJyZW50U2Npc3NvclRlc3QgPSBfc2Npc3NvclRlc3Q7CiAgICB9CiAgICBjb25zdCBmcmFtZWJ1ZmZlckJvdW5kID0gc3RhdGUuYmluZEZyYW1lYnVmZmVyKDM2MTYwLCBmcmFtZWJ1ZmZlcik7CiAgICBpZiAoZnJhbWVidWZmZXJCb3VuZCAmJiBjYXBhYmlsaXRpZXMuZHJhd0J1ZmZlcnMgJiYgdXNlRGVmYXVsdEZyYW1lYnVmZmVyKSB7CiAgICAgIHN0YXRlLmRyYXdCdWZmZXJzKHJlbmRlclRhcmdldCwgZnJhbWVidWZmZXIpOwogICAgfQogICAgc3RhdGUudmlld3BvcnQoX2N1cnJlbnRWaWV3cG9ydCk7CiAgICBzdGF0ZS5zY2lzc29yKF9jdXJyZW50U2Npc3Nvcik7CiAgICBzdGF0ZS5zZXRTY2lzc29yVGVzdChfY3VycmVudFNjaXNzb3JUZXN0KTsKICAgIGlmIChpc0N1YmUpIHsKICAgICAgY29uc3QgdGV4dHVyZVByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzLmdldChyZW5kZXJUYXJnZXQudGV4dHVyZSk7CiAgICAgIF9nbC5mcmFtZWJ1ZmZlclRleHR1cmUyRCgzNjE2MCwgMzYwNjQsIDM0MDY5ICsgYWN0aXZlQ3ViZUZhY2UsIHRleHR1cmVQcm9wZXJ0aWVzLl9fd2ViZ2xUZXh0dXJlLCBhY3RpdmVNaXBtYXBMZXZlbCk7CiAgICB9IGVsc2UgaWYgKGlzUmVuZGVyVGFyZ2V0M0QpIHsKICAgICAgY29uc3QgdGV4dHVyZVByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzLmdldChyZW5kZXJUYXJnZXQudGV4dHVyZSk7CiAgICAgIGNvbnN0IGxheWVyID0gYWN0aXZlQ3ViZUZhY2UgfHwgMDsKICAgICAgX2dsLmZyYW1lYnVmZmVyVGV4dHVyZUxheWVyKDM2MTYwLCAzNjA2NCwgdGV4dHVyZVByb3BlcnRpZXMuX193ZWJnbFRleHR1cmUsIGFjdGl2ZU1pcG1hcExldmVsIHx8IDAsIGxheWVyKTsKICAgIH0KICAgIF9jdXJyZW50TWF0ZXJpYWxJZCA9IC0xOwogIH07CiAgdGhpcy5yZWFkUmVuZGVyVGFyZ2V0UGl4ZWxzID0gZnVuY3Rpb24ocmVuZGVyVGFyZ2V0LCB4LCB5LCB3aWR0aCwgaGVpZ2h0LCBidWZmZXIsIGFjdGl2ZUN1YmVGYWNlSW5kZXgpIHsKICAgIGlmICghKHJlbmRlclRhcmdldCAmJiByZW5kZXJUYXJnZXQuaXNXZWJHTFJlbmRlclRhcmdldCkpIHsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuV2ViR0xSZW5kZXJlci5yZWFkUmVuZGVyVGFyZ2V0UGl4ZWxzOiByZW5kZXJUYXJnZXQgaXMgbm90IFRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0LiIpOwogICAgICByZXR1cm47CiAgICB9CiAgICBsZXQgZnJhbWVidWZmZXIgPSBwcm9wZXJ0aWVzLmdldChyZW5kZXJUYXJnZXQpLl9fd2ViZ2xGcmFtZWJ1ZmZlcjsKICAgIGlmIChyZW5kZXJUYXJnZXQuaXNXZWJHTEN1YmVSZW5kZXJUYXJnZXQgJiYgYWN0aXZlQ3ViZUZhY2VJbmRleCAhPT0gdm9pZCAwKSB7CiAgICAgIGZyYW1lYnVmZmVyID0gZnJhbWVidWZmZXJbYWN0aXZlQ3ViZUZhY2VJbmRleF07CiAgICB9CiAgICBpZiAoZnJhbWVidWZmZXIpIHsKICAgICAgc3RhdGUuYmluZEZyYW1lYnVmZmVyKDM2MTYwLCBmcmFtZWJ1ZmZlcik7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgdGV4dHVyZSA9IHJlbmRlclRhcmdldC50ZXh0dXJlOwogICAgICAgIGNvbnN0IHRleHR1cmVGb3JtYXQgPSB0ZXh0dXJlLmZvcm1hdDsKICAgICAgICBjb25zdCB0ZXh0dXJlVHlwZSA9IHRleHR1cmUudHlwZTsKICAgICAgICBpZiAodGV4dHVyZUZvcm1hdCAhPT0gUkdCQUZvcm1hdCAmJiB1dGlscy5jb252ZXJ0KHRleHR1cmVGb3JtYXQpICE9PSBfZ2wuZ2V0UGFyYW1ldGVyKDM1NzM5KSkgewogICAgICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuV2ViR0xSZW5kZXJlci5yZWFkUmVuZGVyVGFyZ2V0UGl4ZWxzOiByZW5kZXJUYXJnZXQgaXMgbm90IGluIFJHQkEgb3IgaW1wbGVtZW50YXRpb24gZGVmaW5lZCBmb3JtYXQuIik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnN0IGhhbGZGbG9hdFN1cHBvcnRlZEJ5RXh0ID0gdGV4dHVyZVR5cGUgPT09IEhhbGZGbG9hdFR5cGUgJiYgKGV4dGVuc2lvbnMuaGFzKCJFWFRfY29sb3JfYnVmZmVyX2hhbGZfZmxvYXQiKSB8fCBjYXBhYmlsaXRpZXMuaXNXZWJHTDIgJiYgZXh0ZW5zaW9ucy5oYXMoIkVYVF9jb2xvcl9idWZmZXJfZmxvYXQiKSk7CiAgICAgICAgaWYgKHRleHR1cmVUeXBlICE9PSBVbnNpZ25lZEJ5dGVUeXBlICYmIHV0aWxzLmNvbnZlcnQodGV4dHVyZVR5cGUpICE9PSBfZ2wuZ2V0UGFyYW1ldGVyKDM1NzM4KSAmJiAhKHRleHR1cmVUeXBlID09PSBGbG9hdFR5cGUgJiYgKGNhcGFiaWxpdGllcy5pc1dlYkdMMiB8fCBleHRlbnNpb25zLmhhcygiT0VTX3RleHR1cmVfZmxvYXQiKSB8fCBleHRlbnNpb25zLmhhcygiV0VCR0xfY29sb3JfYnVmZmVyX2Zsb2F0IikpKSAmJiAhaGFsZkZsb2F0U3VwcG9ydGVkQnlFeHQpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLldlYkdMUmVuZGVyZXIucmVhZFJlbmRlclRhcmdldFBpeGVsczogcmVuZGVyVGFyZ2V0IGlzIG5vdCBpbiBVbnNpZ25lZEJ5dGVUeXBlIG9yIGltcGxlbWVudGF0aW9uIGRlZmluZWQgdHlwZS4iKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKF9nbC5jaGVja0ZyYW1lYnVmZmVyU3RhdHVzKDM2MTYwKSA9PT0gMzYwNTMpIHsKICAgICAgICAgIGlmICh4ID49IDAgJiYgeCA8PSByZW5kZXJUYXJnZXQud2lkdGggLSB3aWR0aCAmJiAoeSA+PSAwICYmIHkgPD0gcmVuZGVyVGFyZ2V0LmhlaWdodCAtIGhlaWdodCkpIHsKICAgICAgICAgICAgX2dsLnJlYWRQaXhlbHMoeCwgeSwgd2lkdGgsIGhlaWdodCwgdXRpbHMuY29udmVydCh0ZXh0dXJlRm9ybWF0KSwgdXRpbHMuY29udmVydCh0ZXh0dXJlVHlwZSksIGJ1ZmZlcik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLldlYkdMUmVuZGVyZXIucmVhZFJlbmRlclRhcmdldFBpeGVsczogcmVhZFBpeGVscyBmcm9tIHJlbmRlclRhcmdldCBmYWlsZWQuIEZyYW1lYnVmZmVyIG5vdCBjb21wbGV0ZS4iKTsKICAgICAgICB9CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgY29uc3QgZnJhbWVidWZmZXIyID0gX2N1cnJlbnRSZW5kZXJUYXJnZXQgIT09IG51bGwgPyBwcm9wZXJ0aWVzLmdldChfY3VycmVudFJlbmRlclRhcmdldCkuX193ZWJnbEZyYW1lYnVmZmVyIDogbnVsbDsKICAgICAgICBzdGF0ZS5iaW5kRnJhbWVidWZmZXIoMzYxNjAsIGZyYW1lYnVmZmVyMik7CiAgICAgIH0KICAgIH0KICB9OwogIHRoaXMuY29weUZyYW1lYnVmZmVyVG9UZXh0dXJlID0gZnVuY3Rpb24ocG9zaXRpb24sIHRleHR1cmUsIGxldmVsID0gMCkgewogICAgaWYgKHRleHR1cmUuaXNGcmFtZWJ1ZmZlclRleHR1cmUgIT09IHRydWUpIHsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuV2ViR0xSZW5kZXJlcjogY29weUZyYW1lYnVmZmVyVG9UZXh0dXJlKCkgY2FuIG9ubHkgYmUgdXNlZCB3aXRoIEZyYW1lYnVmZmVyVGV4dHVyZS4iKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3QgbGV2ZWxTY2FsZSA9IE1hdGgucG93KDIsIC1sZXZlbCk7CiAgICBjb25zdCB3aWR0aCA9IE1hdGguZmxvb3IodGV4dHVyZS5pbWFnZS53aWR0aCAqIGxldmVsU2NhbGUpOwogICAgY29uc3QgaGVpZ2h0ID0gTWF0aC5mbG9vcih0ZXh0dXJlLmltYWdlLmhlaWdodCAqIGxldmVsU2NhbGUpOwogICAgdGV4dHVyZXMuc2V0VGV4dHVyZTJEKHRleHR1cmUsIDApOwogICAgX2dsLmNvcHlUZXhTdWJJbWFnZTJEKDM1NTMsIGxldmVsLCAwLCAwLCBwb3NpdGlvbi54LCBwb3NpdGlvbi55LCB3aWR0aCwgaGVpZ2h0KTsKICAgIHN0YXRlLnVuYmluZFRleHR1cmUoKTsKICB9OwogIHRoaXMuY29weVRleHR1cmVUb1RleHR1cmUgPSBmdW5jdGlvbihwb3NpdGlvbiwgc3JjVGV4dHVyZSwgZHN0VGV4dHVyZSwgbGV2ZWwgPSAwKSB7CiAgICBjb25zdCB3aWR0aCA9IHNyY1RleHR1cmUuaW1hZ2Uud2lkdGg7CiAgICBjb25zdCBoZWlnaHQgPSBzcmNUZXh0dXJlLmltYWdlLmhlaWdodDsKICAgIGNvbnN0IGdsRm9ybWF0ID0gdXRpbHMuY29udmVydChkc3RUZXh0dXJlLmZvcm1hdCk7CiAgICBjb25zdCBnbFR5cGUgPSB1dGlscy5jb252ZXJ0KGRzdFRleHR1cmUudHlwZSk7CiAgICB0ZXh0dXJlcy5zZXRUZXh0dXJlMkQoZHN0VGV4dHVyZSwgMCk7CiAgICBfZ2wucGl4ZWxTdG9yZWkoMzc0NDAsIGRzdFRleHR1cmUuZmxpcFkpOwogICAgX2dsLnBpeGVsU3RvcmVpKDM3NDQxLCBkc3RUZXh0dXJlLnByZW11bHRpcGx5QWxwaGEpOwogICAgX2dsLnBpeGVsU3RvcmVpKDMzMTcsIGRzdFRleHR1cmUudW5wYWNrQWxpZ25tZW50KTsKICAgIGlmIChzcmNUZXh0dXJlLmlzRGF0YVRleHR1cmUpIHsKICAgICAgX2dsLnRleFN1YkltYWdlMkQoMzU1MywgbGV2ZWwsIHBvc2l0aW9uLngsIHBvc2l0aW9uLnksIHdpZHRoLCBoZWlnaHQsIGdsRm9ybWF0LCBnbFR5cGUsIHNyY1RleHR1cmUuaW1hZ2UuZGF0YSk7CiAgICB9IGVsc2UgewogICAgICBpZiAoc3JjVGV4dHVyZS5pc0NvbXByZXNzZWRUZXh0dXJlKSB7CiAgICAgICAgX2dsLmNvbXByZXNzZWRUZXhTdWJJbWFnZTJEKDM1NTMsIGxldmVsLCBwb3NpdGlvbi54LCBwb3NpdGlvbi55LCBzcmNUZXh0dXJlLm1pcG1hcHNbMF0ud2lkdGgsIHNyY1RleHR1cmUubWlwbWFwc1swXS5oZWlnaHQsIGdsRm9ybWF0LCBzcmNUZXh0dXJlLm1pcG1hcHNbMF0uZGF0YSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX2dsLnRleFN1YkltYWdlMkQoMzU1MywgbGV2ZWwsIHBvc2l0aW9uLngsIHBvc2l0aW9uLnksIGdsRm9ybWF0LCBnbFR5cGUsIHNyY1RleHR1cmUuaW1hZ2UpOwogICAgICB9CiAgICB9CiAgICBpZiAobGV2ZWwgPT09IDAgJiYgZHN0VGV4dHVyZS5nZW5lcmF0ZU1pcG1hcHMpCiAgICAgIF9nbC5nZW5lcmF0ZU1pcG1hcCgzNTUzKTsKICAgIHN0YXRlLnVuYmluZFRleHR1cmUoKTsKICB9OwogIHRoaXMuY29weVRleHR1cmVUb1RleHR1cmUzRCA9IGZ1bmN0aW9uKHNvdXJjZUJveCwgcG9zaXRpb24sIHNyY1RleHR1cmUsIGRzdFRleHR1cmUsIGxldmVsID0gMCkgewogICAgaWYgKF90aGlzLmlzV2ViR0wxUmVuZGVyZXIpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyLmNvcHlUZXh0dXJlVG9UZXh0dXJlM0Q6IGNhbiBvbmx5IGJlIHVzZWQgd2l0aCBXZWJHTDIuIik7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGNvbnN0IHdpZHRoID0gc291cmNlQm94Lm1heC54IC0gc291cmNlQm94Lm1pbi54ICsgMTsKICAgIGNvbnN0IGhlaWdodCA9IHNvdXJjZUJveC5tYXgueSAtIHNvdXJjZUJveC5taW4ueSArIDE7CiAgICBjb25zdCBkZXB0aCA9IHNvdXJjZUJveC5tYXgueiAtIHNvdXJjZUJveC5taW4ueiArIDE7CiAgICBjb25zdCBnbEZvcm1hdCA9IHV0aWxzLmNvbnZlcnQoZHN0VGV4dHVyZS5mb3JtYXQpOwogICAgY29uc3QgZ2xUeXBlID0gdXRpbHMuY29udmVydChkc3RUZXh0dXJlLnR5cGUpOwogICAgbGV0IGdsVGFyZ2V0OwogICAgaWYgKGRzdFRleHR1cmUuaXNEYXRhVGV4dHVyZTNEKSB7CiAgICAgIHRleHR1cmVzLnNldFRleHR1cmUzRChkc3RUZXh0dXJlLCAwKTsKICAgICAgZ2xUYXJnZXQgPSAzMjg3OTsKICAgIH0gZWxzZSBpZiAoZHN0VGV4dHVyZS5pc0RhdGFUZXh0dXJlMkRBcnJheSkgewogICAgICB0ZXh0dXJlcy5zZXRUZXh0dXJlMkRBcnJheShkc3RUZXh0dXJlLCAwKTsKICAgICAgZ2xUYXJnZXQgPSAzNTg2NjsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlci5jb3B5VGV4dHVyZVRvVGV4dHVyZTNEOiBvbmx5IHN1cHBvcnRzIFRIUkVFLkRhdGFUZXh0dXJlM0QgYW5kIFRIUkVFLkRhdGFUZXh0dXJlMkRBcnJheS4iKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgX2dsLnBpeGVsU3RvcmVpKDM3NDQwLCBkc3RUZXh0dXJlLmZsaXBZKTsKICAgIF9nbC5waXhlbFN0b3JlaSgzNzQ0MSwgZHN0VGV4dHVyZS5wcmVtdWx0aXBseUFscGhhKTsKICAgIF9nbC5waXhlbFN0b3JlaSgzMzE3LCBkc3RUZXh0dXJlLnVucGFja0FsaWdubWVudCk7CiAgICBjb25zdCB1bnBhY2tSb3dMZW4gPSBfZ2wuZ2V0UGFyYW1ldGVyKDMzMTQpOwogICAgY29uc3QgdW5wYWNrSW1hZ2VIZWlnaHQgPSBfZ2wuZ2V0UGFyYW1ldGVyKDMyODc4KTsKICAgIGNvbnN0IHVucGFja1NraXBQaXhlbHMgPSBfZ2wuZ2V0UGFyYW1ldGVyKDMzMTYpOwogICAgY29uc3QgdW5wYWNrU2tpcFJvd3MgPSBfZ2wuZ2V0UGFyYW1ldGVyKDMzMTUpOwogICAgY29uc3QgdW5wYWNrU2tpcEltYWdlcyA9IF9nbC5nZXRQYXJhbWV0ZXIoMzI4NzcpOwogICAgY29uc3QgaW1hZ2UgPSBzcmNUZXh0dXJlLmlzQ29tcHJlc3NlZFRleHR1cmUgPyBzcmNUZXh0dXJlLm1pcG1hcHNbMF0gOiBzcmNUZXh0dXJlLmltYWdlOwogICAgX2dsLnBpeGVsU3RvcmVpKDMzMTQsIGltYWdlLndpZHRoKTsKICAgIF9nbC5waXhlbFN0b3JlaSgzMjg3OCwgaW1hZ2UuaGVpZ2h0KTsKICAgIF9nbC5waXhlbFN0b3JlaSgzMzE2LCBzb3VyY2VCb3gubWluLngpOwogICAgX2dsLnBpeGVsU3RvcmVpKDMzMTUsIHNvdXJjZUJveC5taW4ueSk7CiAgICBfZ2wucGl4ZWxTdG9yZWkoMzI4NzcsIHNvdXJjZUJveC5taW4ueik7CiAgICBpZiAoc3JjVGV4dHVyZS5pc0RhdGFUZXh0dXJlIHx8IHNyY1RleHR1cmUuaXNEYXRhVGV4dHVyZTNEKSB7CiAgICAgIF9nbC50ZXhTdWJJbWFnZTNEKGdsVGFyZ2V0LCBsZXZlbCwgcG9zaXRpb24ueCwgcG9zaXRpb24ueSwgcG9zaXRpb24ueiwgd2lkdGgsIGhlaWdodCwgZGVwdGgsIGdsRm9ybWF0LCBnbFR5cGUsIGltYWdlLmRhdGEpOwogICAgfSBlbHNlIHsKICAgICAgaWYgKHNyY1RleHR1cmUuaXNDb21wcmVzc2VkVGV4dHVyZSkgewogICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlci5jb3B5VGV4dHVyZVRvVGV4dHVyZTNEOiB1bnRlc3RlZCBzdXBwb3J0IGZvciBjb21wcmVzc2VkIHNyY1RleHR1cmUuIik7CiAgICAgICAgX2dsLmNvbXByZXNzZWRUZXhTdWJJbWFnZTNEKGdsVGFyZ2V0LCBsZXZlbCwgcG9zaXRpb24ueCwgcG9zaXRpb24ueSwgcG9zaXRpb24ueiwgd2lkdGgsIGhlaWdodCwgZGVwdGgsIGdsRm9ybWF0LCBpbWFnZS5kYXRhKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfZ2wudGV4U3ViSW1hZ2UzRChnbFRhcmdldCwgbGV2ZWwsIHBvc2l0aW9uLngsIHBvc2l0aW9uLnksIHBvc2l0aW9uLnosIHdpZHRoLCBoZWlnaHQsIGRlcHRoLCBnbEZvcm1hdCwgZ2xUeXBlLCBpbWFnZSk7CiAgICAgIH0KICAgIH0KICAgIF9nbC5waXhlbFN0b3JlaSgzMzE0LCB1bnBhY2tSb3dMZW4pOwogICAgX2dsLnBpeGVsU3RvcmVpKDMyODc4LCB1bnBhY2tJbWFnZUhlaWdodCk7CiAgICBfZ2wucGl4ZWxTdG9yZWkoMzMxNiwgdW5wYWNrU2tpcFBpeGVscyk7CiAgICBfZ2wucGl4ZWxTdG9yZWkoMzMxNSwgdW5wYWNrU2tpcFJvd3MpOwogICAgX2dsLnBpeGVsU3RvcmVpKDMyODc3LCB1bnBhY2tTa2lwSW1hZ2VzKTsKICAgIGlmIChsZXZlbCA9PT0gMCAmJiBkc3RUZXh0dXJlLmdlbmVyYXRlTWlwbWFwcykKICAgICAgX2dsLmdlbmVyYXRlTWlwbWFwKGdsVGFyZ2V0KTsKICAgIHN0YXRlLnVuYmluZFRleHR1cmUoKTsKICB9OwogIHRoaXMuaW5pdFRleHR1cmUgPSBmdW5jdGlvbih0ZXh0dXJlKSB7CiAgICB0ZXh0dXJlcy5zZXRUZXh0dXJlMkQodGV4dHVyZSwgMCk7CiAgICBzdGF0ZS51bmJpbmRUZXh0dXJlKCk7CiAgfTsKICB0aGlzLnJlc2V0U3RhdGUgPSBmdW5jdGlvbigpIHsKICAgIF9jdXJyZW50QWN0aXZlQ3ViZUZhY2UgPSAwOwogICAgX2N1cnJlbnRBY3RpdmVNaXBtYXBMZXZlbCA9IDA7CiAgICBfY3VycmVudFJlbmRlclRhcmdldCA9IG51bGw7CiAgICBzdGF0ZS5yZXNldCgpOwogICAgYmluZGluZ1N0YXRlcy5yZXNldCgpOwogIH07CiAgaWYgKHR5cGVvZiBfX1RIUkVFX0RFVlRPT0xTX18gIT09ICJ1bmRlZmluZWQiKSB7CiAgICBfX1RIUkVFX0RFVlRPT0xTX18uZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoIm9ic2VydmUiLCB7IGRldGFpbDogdGhpcyB9KSk7CiAgfQp9CldlYkdMUmVuZGVyZXIucHJvdG90eXBlLmlzV2ViR0xSZW5kZXJlciA9IHRydWU7CmNsYXNzIFdlYkdMMVJlbmRlcmVyIGV4dGVuZHMgV2ViR0xSZW5kZXJlciB7Cn0KV2ViR0wxUmVuZGVyZXIucHJvdG90eXBlLmlzV2ViR0wxUmVuZGVyZXIgPSB0cnVlOwpjbGFzcyBGb2dFeHAyIHsKICBjb25zdHJ1Y3Rvcihjb2xvciwgZGVuc2l0eSA9IDI1ZS01KSB7CiAgICB0aGlzLm5hbWUgPSAiIjsKICAgIHRoaXMuY29sb3IgPSBuZXcgQ29sb3IoY29sb3IpOwogICAgdGhpcy5kZW5zaXR5ID0gZGVuc2l0eTsKICB9CiAgY2xvbmUoKSB7CiAgICByZXR1cm4gbmV3IEZvZ0V4cDIodGhpcy5jb2xvciwgdGhpcy5kZW5zaXR5KTsKICB9CiAgdG9KU09OKCkgewogICAgcmV0dXJuIHsKICAgICAgdHlwZTogIkZvZ0V4cDIiLAogICAgICBjb2xvcjogdGhpcy5jb2xvci5nZXRIZXgoKSwKICAgICAgZGVuc2l0eTogdGhpcy5kZW5zaXR5CiAgICB9OwogIH0KfQpGb2dFeHAyLnByb3RvdHlwZS5pc0ZvZ0V4cDIgPSB0cnVlOwpjbGFzcyBGb2cgewogIGNvbnN0cnVjdG9yKGNvbG9yLCBuZWFyID0gMSwgZmFyID0gMWUzKSB7CiAgICB0aGlzLm5hbWUgPSAiIjsKICAgIHRoaXMuY29sb3IgPSBuZXcgQ29sb3IoY29sb3IpOwogICAgdGhpcy5uZWFyID0gbmVhcjsKICAgIHRoaXMuZmFyID0gZmFyOwogIH0KICBjbG9uZSgpIHsKICAgIHJldHVybiBuZXcgRm9nKHRoaXMuY29sb3IsIHRoaXMubmVhciwgdGhpcy5mYXIpOwogIH0KICB0b0pTT04oKSB7CiAgICByZXR1cm4gewogICAgICB0eXBlOiAiRm9nIiwKICAgICAgY29sb3I6IHRoaXMuY29sb3IuZ2V0SGV4KCksCiAgICAgIG5lYXI6IHRoaXMubmVhciwKICAgICAgZmFyOiB0aGlzLmZhcgogICAgfTsKICB9Cn0KRm9nLnByb3RvdHlwZS5pc0ZvZyA9IHRydWU7CmNsYXNzIFNjZW5lIGV4dGVuZHMgT2JqZWN0M0QgewogIGNvbnN0cnVjdG9yKCkgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJTY2VuZSI7CiAgICB0aGlzLmJhY2tncm91bmQgPSBudWxsOwogICAgdGhpcy5lbnZpcm9ubWVudCA9IG51bGw7CiAgICB0aGlzLmZvZyA9IG51bGw7CiAgICB0aGlzLm92ZXJyaWRlTWF0ZXJpYWwgPSBudWxsOwogICAgdGhpcy5hdXRvVXBkYXRlID0gdHJ1ZTsKICAgIGlmICh0eXBlb2YgX19USFJFRV9ERVZUT09MU19fICE9PSAidW5kZWZpbmVkIikgewogICAgICBfX1RIUkVFX0RFVlRPT0xTX18uZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoIm9ic2VydmUiLCB7IGRldGFpbDogdGhpcyB9KSk7CiAgICB9CiAgfQogIGNvcHkoc291cmNlLCByZWN1cnNpdmUpIHsKICAgIHN1cGVyLmNvcHkoc291cmNlLCByZWN1cnNpdmUpOwogICAgaWYgKHNvdXJjZS5iYWNrZ3JvdW5kICE9PSBudWxsKQogICAgICB0aGlzLmJhY2tncm91bmQgPSBzb3VyY2UuYmFja2dyb3VuZC5jbG9uZSgpOwogICAgaWYgKHNvdXJjZS5lbnZpcm9ubWVudCAhPT0gbnVsbCkKICAgICAgdGhpcy5lbnZpcm9ubWVudCA9IHNvdXJjZS5lbnZpcm9ubWVudC5jbG9uZSgpOwogICAgaWYgKHNvdXJjZS5mb2cgIT09IG51bGwpCiAgICAgIHRoaXMuZm9nID0gc291cmNlLmZvZy5jbG9uZSgpOwogICAgaWYgKHNvdXJjZS5vdmVycmlkZU1hdGVyaWFsICE9PSBudWxsKQogICAgICB0aGlzLm92ZXJyaWRlTWF0ZXJpYWwgPSBzb3VyY2Uub3ZlcnJpZGVNYXRlcmlhbC5jbG9uZSgpOwogICAgdGhpcy5hdXRvVXBkYXRlID0gc291cmNlLmF1dG9VcGRhdGU7CiAgICB0aGlzLm1hdHJpeEF1dG9VcGRhdGUgPSBzb3VyY2UubWF0cml4QXV0b1VwZGF0ZTsKICAgIHJldHVybiB0aGlzOwogIH0KICB0b0pTT04obWV0YSkgewogICAgY29uc3QgZGF0YSA9IHN1cGVyLnRvSlNPTihtZXRhKTsKICAgIGlmICh0aGlzLmZvZyAhPT0gbnVsbCkKICAgICAgZGF0YS5vYmplY3QuZm9nID0gdGhpcy5mb2cudG9KU09OKCk7CiAgICByZXR1cm4gZGF0YTsKICB9Cn0KU2NlbmUucHJvdG90eXBlLmlzU2NlbmUgPSB0cnVlOwpjbGFzcyBJbnRlcmxlYXZlZEJ1ZmZlciB7CiAgY29uc3RydWN0b3IoYXJyYXksIHN0cmlkZSkgewogICAgdGhpcy5hcnJheSA9IGFycmF5OwogICAgdGhpcy5zdHJpZGUgPSBzdHJpZGU7CiAgICB0aGlzLmNvdW50ID0gYXJyYXkgIT09IHZvaWQgMCA/IGFycmF5Lmxlbmd0aCAvIHN0cmlkZSA6IDA7CiAgICB0aGlzLnVzYWdlID0gU3RhdGljRHJhd1VzYWdlOwogICAgdGhpcy51cGRhdGVSYW5nZSA9IHsgb2Zmc2V0OiAwLCBjb3VudDogLTEgfTsKICAgIHRoaXMudmVyc2lvbiA9IDA7CiAgICB0aGlzLnV1aWQgPSBnZW5lcmF0ZVVVSUQoKTsKICB9CiAgb25VcGxvYWRDYWxsYmFjaygpIHsKICB9CiAgc2V0IG5lZWRzVXBkYXRlKHZhbHVlKSB7CiAgICBpZiAodmFsdWUgPT09IHRydWUpCiAgICAgIHRoaXMudmVyc2lvbisrOwogIH0KICBzZXRVc2FnZSh2YWx1ZSkgewogICAgdGhpcy51c2FnZSA9IHZhbHVlOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICB0aGlzLmFycmF5ID0gbmV3IHNvdXJjZS5hcnJheS5jb25zdHJ1Y3Rvcihzb3VyY2UuYXJyYXkpOwogICAgdGhpcy5jb3VudCA9IHNvdXJjZS5jb3VudDsKICAgIHRoaXMuc3RyaWRlID0gc291cmNlLnN0cmlkZTsKICAgIHRoaXMudXNhZ2UgPSBzb3VyY2UudXNhZ2U7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY29weUF0KGluZGV4MSwgYXR0cmlidXRlLCBpbmRleDIpIHsKICAgIGluZGV4MSAqPSB0aGlzLnN0cmlkZTsKICAgIGluZGV4MiAqPSBhdHRyaWJ1dGUuc3RyaWRlOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSB0aGlzLnN0cmlkZTsgaSA8IGw7IGkrKykgewogICAgICB0aGlzLmFycmF5W2luZGV4MSArIGldID0gYXR0cmlidXRlLmFycmF5W2luZGV4MiArIGldOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldCh2YWx1ZSwgb2Zmc2V0ID0gMCkgewogICAgdGhpcy5hcnJheS5zZXQodmFsdWUsIG9mZnNldCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xvbmUoZGF0YSkgewogICAgaWYgKGRhdGEuYXJyYXlCdWZmZXJzID09PSB2b2lkIDApIHsKICAgICAgZGF0YS5hcnJheUJ1ZmZlcnMgPSB7fTsKICAgIH0KICAgIGlmICh0aGlzLmFycmF5LmJ1ZmZlci5fdXVpZCA9PT0gdm9pZCAwKSB7CiAgICAgIHRoaXMuYXJyYXkuYnVmZmVyLl91dWlkID0gZ2VuZXJhdGVVVUlEKCk7CiAgICB9CiAgICBpZiAoZGF0YS5hcnJheUJ1ZmZlcnNbdGhpcy5hcnJheS5idWZmZXIuX3V1aWRdID09PSB2b2lkIDApIHsKICAgICAgZGF0YS5hcnJheUJ1ZmZlcnNbdGhpcy5hcnJheS5idWZmZXIuX3V1aWRdID0gdGhpcy5hcnJheS5zbGljZSgwKS5idWZmZXI7CiAgICB9CiAgICBjb25zdCBhcnJheSA9IG5ldyB0aGlzLmFycmF5LmNvbnN0cnVjdG9yKGRhdGEuYXJyYXlCdWZmZXJzW3RoaXMuYXJyYXkuYnVmZmVyLl91dWlkXSk7CiAgICBjb25zdCBpYiA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKGFycmF5LCB0aGlzLnN0cmlkZSk7CiAgICBpYi5zZXRVc2FnZSh0aGlzLnVzYWdlKTsKICAgIHJldHVybiBpYjsKICB9CiAgb25VcGxvYWQoY2FsbGJhY2spIHsKICAgIHRoaXMub25VcGxvYWRDYWxsYmFjayA9IGNhbGxiYWNrOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRvSlNPTihkYXRhKSB7CiAgICBpZiAoZGF0YS5hcnJheUJ1ZmZlcnMgPT09IHZvaWQgMCkgewogICAgICBkYXRhLmFycmF5QnVmZmVycyA9IHt9OwogICAgfQogICAgaWYgKHRoaXMuYXJyYXkuYnVmZmVyLl91dWlkID09PSB2b2lkIDApIHsKICAgICAgdGhpcy5hcnJheS5idWZmZXIuX3V1aWQgPSBnZW5lcmF0ZVVVSUQoKTsKICAgIH0KICAgIGlmIChkYXRhLmFycmF5QnVmZmVyc1t0aGlzLmFycmF5LmJ1ZmZlci5fdXVpZF0gPT09IHZvaWQgMCkgewogICAgICBkYXRhLmFycmF5QnVmZmVyc1t0aGlzLmFycmF5LmJ1ZmZlci5fdXVpZF0gPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChuZXcgVWludDMyQXJyYXkodGhpcy5hcnJheS5idWZmZXIpKTsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIHV1aWQ6IHRoaXMudXVpZCwKICAgICAgYnVmZmVyOiB0aGlzLmFycmF5LmJ1ZmZlci5fdXVpZCwKICAgICAgdHlwZTogdGhpcy5hcnJheS5jb25zdHJ1Y3Rvci5uYW1lLAogICAgICBzdHJpZGU6IHRoaXMuc3RyaWRlCiAgICB9OwogIH0KfQpJbnRlcmxlYXZlZEJ1ZmZlci5wcm90b3R5cGUuaXNJbnRlcmxlYXZlZEJ1ZmZlciA9IHRydWU7CmNvbnN0IF92ZWN0b3IkNiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjbGFzcyBJbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZSB7CiAgY29uc3RydWN0b3IoaW50ZXJsZWF2ZWRCdWZmZXIsIGl0ZW1TaXplLCBvZmZzZXQsIG5vcm1hbGl6ZWQgPSBmYWxzZSkgewogICAgdGhpcy5uYW1lID0gIiI7CiAgICB0aGlzLmRhdGEgPSBpbnRlcmxlYXZlZEJ1ZmZlcjsKICAgIHRoaXMuaXRlbVNpemUgPSBpdGVtU2l6ZTsKICAgIHRoaXMub2Zmc2V0ID0gb2Zmc2V0OwogICAgdGhpcy5ub3JtYWxpemVkID0gbm9ybWFsaXplZCA9PT0gdHJ1ZTsKICB9CiAgZ2V0IGNvdW50KCkgewogICAgcmV0dXJuIHRoaXMuZGF0YS5jb3VudDsKICB9CiAgZ2V0IGFycmF5KCkgewogICAgcmV0dXJuIHRoaXMuZGF0YS5hcnJheTsKICB9CiAgc2V0IG5lZWRzVXBkYXRlKHZhbHVlKSB7CiAgICB0aGlzLmRhdGEubmVlZHNVcGRhdGUgPSB2YWx1ZTsKICB9CiAgYXBwbHlNYXRyaXg0KG0pIHsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5kYXRhLmNvdW50OyBpIDwgbDsgaSsrKSB7CiAgICAgIF92ZWN0b3IkNi54ID0gdGhpcy5nZXRYKGkpOwogICAgICBfdmVjdG9yJDYueSA9IHRoaXMuZ2V0WShpKTsKICAgICAgX3ZlY3RvciQ2LnogPSB0aGlzLmdldFooaSk7CiAgICAgIF92ZWN0b3IkNi5hcHBseU1hdHJpeDQobSk7CiAgICAgIHRoaXMuc2V0WFlaKGksIF92ZWN0b3IkNi54LCBfdmVjdG9yJDYueSwgX3ZlY3RvciQ2LnopOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGFwcGx5Tm9ybWFsTWF0cml4KG0pIHsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5jb3VudDsgaSA8IGw7IGkrKykgewogICAgICBfdmVjdG9yJDYueCA9IHRoaXMuZ2V0WChpKTsKICAgICAgX3ZlY3RvciQ2LnkgPSB0aGlzLmdldFkoaSk7CiAgICAgIF92ZWN0b3IkNi56ID0gdGhpcy5nZXRaKGkpOwogICAgICBfdmVjdG9yJDYuYXBwbHlOb3JtYWxNYXRyaXgobSk7CiAgICAgIHRoaXMuc2V0WFlaKGksIF92ZWN0b3IkNi54LCBfdmVjdG9yJDYueSwgX3ZlY3RvciQ2LnopOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRyYW5zZm9ybURpcmVjdGlvbihtKSB7CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IHRoaXMuY291bnQ7IGkgPCBsOyBpKyspIHsKICAgICAgX3ZlY3RvciQ2LnggPSB0aGlzLmdldFgoaSk7CiAgICAgIF92ZWN0b3IkNi55ID0gdGhpcy5nZXRZKGkpOwogICAgICBfdmVjdG9yJDYueiA9IHRoaXMuZ2V0WihpKTsKICAgICAgX3ZlY3RvciQ2LnRyYW5zZm9ybURpcmVjdGlvbihtKTsKICAgICAgdGhpcy5zZXRYWVooaSwgX3ZlY3RvciQ2LngsIF92ZWN0b3IkNi55LCBfdmVjdG9yJDYueik7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0WChpbmRleCwgeCkgewogICAgdGhpcy5kYXRhLmFycmF5W2luZGV4ICogdGhpcy5kYXRhLnN0cmlkZSArIHRoaXMub2Zmc2V0XSA9IHg7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0WShpbmRleCwgeSkgewogICAgdGhpcy5kYXRhLmFycmF5W2luZGV4ICogdGhpcy5kYXRhLnN0cmlkZSArIHRoaXMub2Zmc2V0ICsgMV0gPSB5OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldFooaW5kZXgsIHopIHsKICAgIHRoaXMuZGF0YS5hcnJheVtpbmRleCAqIHRoaXMuZGF0YS5zdHJpZGUgKyB0aGlzLm9mZnNldCArIDJdID0gejsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRXKGluZGV4LCB3KSB7CiAgICB0aGlzLmRhdGEuYXJyYXlbaW5kZXggKiB0aGlzLmRhdGEuc3RyaWRlICsgdGhpcy5vZmZzZXQgKyAzXSA9IHc7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZ2V0WChpbmRleCkgewogICAgcmV0dXJuIHRoaXMuZGF0YS5hcnJheVtpbmRleCAqIHRoaXMuZGF0YS5zdHJpZGUgKyB0aGlzLm9mZnNldF07CiAgfQogIGdldFkoaW5kZXgpIHsKICAgIHJldHVybiB0aGlzLmRhdGEuYXJyYXlbaW5kZXggKiB0aGlzLmRhdGEuc3RyaWRlICsgdGhpcy5vZmZzZXQgKyAxXTsKICB9CiAgZ2V0WihpbmRleCkgewogICAgcmV0dXJuIHRoaXMuZGF0YS5hcnJheVtpbmRleCAqIHRoaXMuZGF0YS5zdHJpZGUgKyB0aGlzLm9mZnNldCArIDJdOwogIH0KICBnZXRXKGluZGV4KSB7CiAgICByZXR1cm4gdGhpcy5kYXRhLmFycmF5W2luZGV4ICogdGhpcy5kYXRhLnN0cmlkZSArIHRoaXMub2Zmc2V0ICsgM107CiAgfQogIHNldFhZKGluZGV4LCB4LCB5KSB7CiAgICBpbmRleCA9IGluZGV4ICogdGhpcy5kYXRhLnN0cmlkZSArIHRoaXMub2Zmc2V0OwogICAgdGhpcy5kYXRhLmFycmF5W2luZGV4ICsgMF0gPSB4OwogICAgdGhpcy5kYXRhLmFycmF5W2luZGV4ICsgMV0gPSB5OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldFhZWihpbmRleCwgeCwgeSwgeikgewogICAgaW5kZXggPSBpbmRleCAqIHRoaXMuZGF0YS5zdHJpZGUgKyB0aGlzLm9mZnNldDsKICAgIHRoaXMuZGF0YS5hcnJheVtpbmRleCArIDBdID0geDsKICAgIHRoaXMuZGF0YS5hcnJheVtpbmRleCArIDFdID0geTsKICAgIHRoaXMuZGF0YS5hcnJheVtpbmRleCArIDJdID0gejsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRYWVpXKGluZGV4LCB4LCB5LCB6LCB3KSB7CiAgICBpbmRleCA9IGluZGV4ICogdGhpcy5kYXRhLnN0cmlkZSArIHRoaXMub2Zmc2V0OwogICAgdGhpcy5kYXRhLmFycmF5W2luZGV4ICsgMF0gPSB4OwogICAgdGhpcy5kYXRhLmFycmF5W2luZGV4ICsgMV0gPSB5OwogICAgdGhpcy5kYXRhLmFycmF5W2luZGV4ICsgMl0gPSB6OwogICAgdGhpcy5kYXRhLmFycmF5W2luZGV4ICsgM10gPSB3OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNsb25lKGRhdGEpIHsKICAgIGlmIChkYXRhID09PSB2b2lkIDApIHsKICAgICAgY29uc29sZS5sb2coIlRIUkVFLkludGVybGVhdmVkQnVmZmVyQXR0cmlidXRlLmNsb25lKCk6IENsb25pbmcgYW4gaW50ZXJsYXZlZCBidWZmZXIgYXR0cmlidXRlIHdpbGwgZGVpbnRlcmxlYXZlIGJ1ZmZlciBkYXRhLiIpOwogICAgICBjb25zdCBhcnJheSA9IFtdOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IGluZGV4ID0gaSAqIHRoaXMuZGF0YS5zdHJpZGUgKyB0aGlzLm9mZnNldDsKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuaXRlbVNpemU7IGorKykgewogICAgICAgICAgYXJyYXkucHVzaCh0aGlzLmRhdGEuYXJyYXlbaW5kZXggKyBqXSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBuZXcgQnVmZmVyQXR0cmlidXRlKG5ldyB0aGlzLmFycmF5LmNvbnN0cnVjdG9yKGFycmF5KSwgdGhpcy5pdGVtU2l6ZSwgdGhpcy5ub3JtYWxpemVkKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChkYXRhLmludGVybGVhdmVkQnVmZmVycyA9PT0gdm9pZCAwKSB7CiAgICAgICAgZGF0YS5pbnRlcmxlYXZlZEJ1ZmZlcnMgPSB7fTsKICAgICAgfQogICAgICBpZiAoZGF0YS5pbnRlcmxlYXZlZEJ1ZmZlcnNbdGhpcy5kYXRhLnV1aWRdID09PSB2b2lkIDApIHsKICAgICAgICBkYXRhLmludGVybGVhdmVkQnVmZmVyc1t0aGlzLmRhdGEudXVpZF0gPSB0aGlzLmRhdGEuY2xvbmUoZGF0YSk7CiAgICAgIH0KICAgICAgcmV0dXJuIG5ldyBJbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZShkYXRhLmludGVybGVhdmVkQnVmZmVyc1t0aGlzLmRhdGEudXVpZF0sIHRoaXMuaXRlbVNpemUsIHRoaXMub2Zmc2V0LCB0aGlzLm5vcm1hbGl6ZWQpOwogICAgfQogIH0KICB0b0pTT04oZGF0YSkgewogICAgaWYgKGRhdGEgPT09IHZvaWQgMCkgewogICAgICBjb25zb2xlLmxvZygiVEhSRUUuSW50ZXJsZWF2ZWRCdWZmZXJBdHRyaWJ1dGUudG9KU09OKCk6IFNlcmlhbGl6aW5nIGFuIGludGVybGF2ZWQgYnVmZmVyIGF0dHJpYnV0ZSB3aWxsIGRlaW50ZXJsZWF2ZSBidWZmZXIgZGF0YS4iKTsKICAgICAgY29uc3QgYXJyYXkgPSBbXTsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBpbmRleCA9IGkgKiB0aGlzLmRhdGEuc3RyaWRlICsgdGhpcy5vZmZzZXQ7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLml0ZW1TaXplOyBqKyspIHsKICAgICAgICAgIGFycmF5LnB1c2godGhpcy5kYXRhLmFycmF5W2luZGV4ICsgal0pOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gewogICAgICAgIGl0ZW1TaXplOiB0aGlzLml0ZW1TaXplLAogICAgICAgIHR5cGU6IHRoaXMuYXJyYXkuY29uc3RydWN0b3IubmFtZSwKICAgICAgICBhcnJheSwKICAgICAgICBub3JtYWxpemVkOiB0aGlzLm5vcm1hbGl6ZWQKICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChkYXRhLmludGVybGVhdmVkQnVmZmVycyA9PT0gdm9pZCAwKSB7CiAgICAgICAgZGF0YS5pbnRlcmxlYXZlZEJ1ZmZlcnMgPSB7fTsKICAgICAgfQogICAgICBpZiAoZGF0YS5pbnRlcmxlYXZlZEJ1ZmZlcnNbdGhpcy5kYXRhLnV1aWRdID09PSB2b2lkIDApIHsKICAgICAgICBkYXRhLmludGVybGVhdmVkQnVmZmVyc1t0aGlzLmRhdGEudXVpZF0gPSB0aGlzLmRhdGEudG9KU09OKGRhdGEpOwogICAgICB9CiAgICAgIHJldHVybiB7CiAgICAgICAgaXNJbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZTogdHJ1ZSwKICAgICAgICBpdGVtU2l6ZTogdGhpcy5pdGVtU2l6ZSwKICAgICAgICBkYXRhOiB0aGlzLmRhdGEudXVpZCwKICAgICAgICBvZmZzZXQ6IHRoaXMub2Zmc2V0LAogICAgICAgIG5vcm1hbGl6ZWQ6IHRoaXMubm9ybWFsaXplZAogICAgICB9OwogICAgfQogIH0KfQpJbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZS5wcm90b3R5cGUuaXNJbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZSA9IHRydWU7CmNsYXNzIFNwcml0ZU1hdGVyaWFsIGV4dGVuZHMgTWF0ZXJpYWwgewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLnR5cGUgPSAiU3ByaXRlTWF0ZXJpYWwiOwogICAgdGhpcy5jb2xvciA9IG5ldyBDb2xvcigxNjc3NzIxNSk7CiAgICB0aGlzLm1hcCA9IG51bGw7CiAgICB0aGlzLmFscGhhTWFwID0gbnVsbDsKICAgIHRoaXMucm90YXRpb24gPSAwOwogICAgdGhpcy5zaXplQXR0ZW51YXRpb24gPSB0cnVlOwogICAgdGhpcy50cmFuc3BhcmVudCA9IHRydWU7CiAgICB0aGlzLnNldFZhbHVlcyhwYXJhbWV0ZXJzKTsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHN1cGVyLmNvcHkoc291cmNlKTsKICAgIHRoaXMuY29sb3IuY29weShzb3VyY2UuY29sb3IpOwogICAgdGhpcy5tYXAgPSBzb3VyY2UubWFwOwogICAgdGhpcy5hbHBoYU1hcCA9IHNvdXJjZS5hbHBoYU1hcDsKICAgIHRoaXMucm90YXRpb24gPSBzb3VyY2Uucm90YXRpb247CiAgICB0aGlzLnNpemVBdHRlbnVhdGlvbiA9IHNvdXJjZS5zaXplQXR0ZW51YXRpb247CiAgICByZXR1cm4gdGhpczsKICB9Cn0KU3ByaXRlTWF0ZXJpYWwucHJvdG90eXBlLmlzU3ByaXRlTWF0ZXJpYWwgPSB0cnVlOwpsZXQgX2dlb21ldHJ5Owpjb25zdCBfaW50ZXJzZWN0UG9pbnQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3dvcmxkU2NhbGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX212UG9zaXRpb24gPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX2FsaWduZWRQb3NpdGlvbiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMigpOwpjb25zdCBfcm90YXRlZFBvc2l0aW9uID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IyKCk7CmNvbnN0IF92aWV3V29ybGRNYXRyaXggPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hdHJpeDQoKTsKY29uc3QgX3ZBID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF92QiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfdkMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3V2QSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMigpOwpjb25zdCBfdXZCID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IyKCk7CmNvbnN0IF91dkMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjIoKTsKY2xhc3MgU3ByaXRlIGV4dGVuZHMgT2JqZWN0M0QgewogIGNvbnN0cnVjdG9yKG1hdGVyaWFsKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIlNwcml0ZSI7CiAgICBpZiAoX2dlb21ldHJ5ID09PSB2b2lkIDApIHsKICAgICAgX2dlb21ldHJ5ID0gbmV3IEJ1ZmZlckdlb21ldHJ5KCk7CiAgICAgIGNvbnN0IGZsb2F0MzJBcnJheSA9IG5ldyBGbG9hdDMyQXJyYXkoWwogICAgICAgIC0wLjUsCiAgICAgICAgLTAuNSwKICAgICAgICAwLAogICAgICAgIDAsCiAgICAgICAgMCwKICAgICAgICAwLjUsCiAgICAgICAgLTAuNSwKICAgICAgICAwLAogICAgICAgIDEsCiAgICAgICAgMCwKICAgICAgICAwLjUsCiAgICAgICAgMC41LAogICAgICAgIDAsCiAgICAgICAgMSwKICAgICAgICAxLAogICAgICAgIC0wLjUsCiAgICAgICAgMC41LAogICAgICAgIDAsCiAgICAgICAgMCwKICAgICAgICAxCiAgICAgIF0pOwogICAgICBjb25zdCBpbnRlcmxlYXZlZEJ1ZmZlciA9IG5ldyBJbnRlcmxlYXZlZEJ1ZmZlcihmbG9hdDMyQXJyYXksIDUpOwogICAgICBfZ2VvbWV0cnkuc2V0SW5kZXgoWzAsIDEsIDIsIDAsIDIsIDNdKTsKICAgICAgX2dlb21ldHJ5LnNldEF0dHJpYnV0ZSgicG9zaXRpb24iLCBuZXcgSW50ZXJsZWF2ZWRCdWZmZXJBdHRyaWJ1dGUoaW50ZXJsZWF2ZWRCdWZmZXIsIDMsIDAsIGZhbHNlKSk7CiAgICAgIF9nZW9tZXRyeS5zZXRBdHRyaWJ1dGUoInV2IiwgbmV3IEludGVybGVhdmVkQnVmZmVyQXR0cmlidXRlKGludGVybGVhdmVkQnVmZmVyLCAyLCAzLCBmYWxzZSkpOwogICAgfQogICAgdGhpcy5nZW9tZXRyeSA9IF9nZW9tZXRyeTsKICAgIHRoaXMubWF0ZXJpYWwgPSBtYXRlcmlhbCAhPT0gdm9pZCAwID8gbWF0ZXJpYWwgOiBuZXcgU3ByaXRlTWF0ZXJpYWwoKTsKICAgIHRoaXMuY2VudGVyID0gbmV3IFZlY3RvcjIoMC41LCAwLjUpOwogIH0KICByYXljYXN0KHJheWNhc3RlciwgaW50ZXJzZWN0czIpIHsKICAgIGlmIChyYXljYXN0ZXIuY2FtZXJhID09PSBudWxsKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoJ1RIUkVFLlNwcml0ZTogIlJheWNhc3Rlci5jYW1lcmEiIG5lZWRzIHRvIGJlIHNldCBpbiBvcmRlciB0byByYXljYXN0IGFnYWluc3Qgc3ByaXRlcy4nKTsKICAgIH0KICAgIF93b3JsZFNjYWxlLnNldEZyb21NYXRyaXhTY2FsZSh0aGlzLm1hdHJpeFdvcmxkKTsKICAgIF92aWV3V29ybGRNYXRyaXguY29weShyYXljYXN0ZXIuY2FtZXJhLm1hdHJpeFdvcmxkKTsKICAgIHRoaXMubW9kZWxWaWV3TWF0cml4Lm11bHRpcGx5TWF0cmljZXMocmF5Y2FzdGVyLmNhbWVyYS5tYXRyaXhXb3JsZEludmVyc2UsIHRoaXMubWF0cml4V29ybGQpOwogICAgX212UG9zaXRpb24uc2V0RnJvbU1hdHJpeFBvc2l0aW9uKHRoaXMubW9kZWxWaWV3TWF0cml4KTsKICAgIGlmIChyYXljYXN0ZXIuY2FtZXJhLmlzUGVyc3BlY3RpdmVDYW1lcmEgJiYgdGhpcy5tYXRlcmlhbC5zaXplQXR0ZW51YXRpb24gPT09IGZhbHNlKSB7CiAgICAgIF93b3JsZFNjYWxlLm11bHRpcGx5U2NhbGFyKC1fbXZQb3NpdGlvbi56KTsKICAgIH0KICAgIGNvbnN0IHJvdGF0aW9uID0gdGhpcy5tYXRlcmlhbC5yb3RhdGlvbjsKICAgIGxldCBzaW4sIGNvczsKICAgIGlmIChyb3RhdGlvbiAhPT0gMCkgewogICAgICBjb3MgPSBNYXRoLmNvcyhyb3RhdGlvbik7CiAgICAgIHNpbiA9IE1hdGguc2luKHJvdGF0aW9uKTsKICAgIH0KICAgIGNvbnN0IGNlbnRlciA9IHRoaXMuY2VudGVyOwogICAgdHJhbnNmb3JtVmVydGV4KF92QS5zZXQoLTAuNSwgLTAuNSwgMCksIF9tdlBvc2l0aW9uLCBjZW50ZXIsIF93b3JsZFNjYWxlLCBzaW4sIGNvcyk7CiAgICB0cmFuc2Zvcm1WZXJ0ZXgoX3ZCLnNldCgwLjUsIC0wLjUsIDApLCBfbXZQb3NpdGlvbiwgY2VudGVyLCBfd29ybGRTY2FsZSwgc2luLCBjb3MpOwogICAgdHJhbnNmb3JtVmVydGV4KF92Qy5zZXQoMC41LCAwLjUsIDApLCBfbXZQb3NpdGlvbiwgY2VudGVyLCBfd29ybGRTY2FsZSwgc2luLCBjb3MpOwogICAgX3V2QS5zZXQoMCwgMCk7CiAgICBfdXZCLnNldCgxLCAwKTsKICAgIF91dkMuc2V0KDEsIDEpOwogICAgbGV0IGludGVyc2VjdCA9IHJheWNhc3Rlci5yYXkuaW50ZXJzZWN0VHJpYW5nbGUoX3ZBLCBfdkIsIF92QywgZmFsc2UsIF9pbnRlcnNlY3RQb2ludCk7CiAgICBpZiAoaW50ZXJzZWN0ID09PSBudWxsKSB7CiAgICAgIHRyYW5zZm9ybVZlcnRleChfdkIuc2V0KC0wLjUsIDAuNSwgMCksIF9tdlBvc2l0aW9uLCBjZW50ZXIsIF93b3JsZFNjYWxlLCBzaW4sIGNvcyk7CiAgICAgIF91dkIuc2V0KDAsIDEpOwogICAgICBpbnRlcnNlY3QgPSByYXljYXN0ZXIucmF5LmludGVyc2VjdFRyaWFuZ2xlKF92QSwgX3ZDLCBfdkIsIGZhbHNlLCBfaW50ZXJzZWN0UG9pbnQpOwogICAgICBpZiAoaW50ZXJzZWN0ID09PSBudWxsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CiAgICBjb25zdCBkaXN0YW5jZSA9IHJheWNhc3Rlci5yYXkub3JpZ2luLmRpc3RhbmNlVG8oX2ludGVyc2VjdFBvaW50KTsKICAgIGlmIChkaXN0YW5jZSA8IHJheWNhc3Rlci5uZWFyIHx8IGRpc3RhbmNlID4gcmF5Y2FzdGVyLmZhcikKICAgICAgcmV0dXJuOwogICAgaW50ZXJzZWN0czIucHVzaCh7CiAgICAgIGRpc3RhbmNlLAogICAgICBwb2ludDogX2ludGVyc2VjdFBvaW50LmNsb25lKCksCiAgICAgIHV2OiBUcmlhbmdsZS5nZXRVVihfaW50ZXJzZWN0UG9pbnQsIF92QSwgX3ZCLCBfdkMsIF91dkEsIF91dkIsIF91dkMsIG5ldyBWZWN0b3IyKCkpLAogICAgICBmYWNlOiBudWxsLAogICAgICBvYmplY3Q6IHRoaXMKICAgIH0pOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgaWYgKHNvdXJjZS5jZW50ZXIgIT09IHZvaWQgMCkKICAgICAgdGhpcy5jZW50ZXIuY29weShzb3VyY2UuY2VudGVyKTsKICAgIHRoaXMubWF0ZXJpYWwgPSBzb3VyY2UubWF0ZXJpYWw7CiAgICByZXR1cm4gdGhpczsKICB9Cn0KU3ByaXRlLnByb3RvdHlwZS5pc1Nwcml0ZSA9IHRydWU7CmZ1bmN0aW9uIHRyYW5zZm9ybVZlcnRleCh2ZXJ0ZXhQb3NpdGlvbiwgbXZQb3NpdGlvbiwgY2VudGVyLCBzY2FsZSwgc2luLCBjb3MpIHsKICBfYWxpZ25lZFBvc2l0aW9uLnN1YlZlY3RvcnModmVydGV4UG9zaXRpb24sIGNlbnRlcikuYWRkU2NhbGFyKDAuNSkubXVsdGlwbHkoc2NhbGUpOwogIGlmIChzaW4gIT09IHZvaWQgMCkgewogICAgX3JvdGF0ZWRQb3NpdGlvbi54ID0gY29zICogX2FsaWduZWRQb3NpdGlvbi54IC0gc2luICogX2FsaWduZWRQb3NpdGlvbi55OwogICAgX3JvdGF0ZWRQb3NpdGlvbi55ID0gc2luICogX2FsaWduZWRQb3NpdGlvbi54ICsgY29zICogX2FsaWduZWRQb3NpdGlvbi55OwogIH0gZWxzZSB7CiAgICBfcm90YXRlZFBvc2l0aW9uLmNvcHkoX2FsaWduZWRQb3NpdGlvbik7CiAgfQogIHZlcnRleFBvc2l0aW9uLmNvcHkobXZQb3NpdGlvbik7CiAgdmVydGV4UG9zaXRpb24ueCArPSBfcm90YXRlZFBvc2l0aW9uLng7CiAgdmVydGV4UG9zaXRpb24ueSArPSBfcm90YXRlZFBvc2l0aW9uLnk7CiAgdmVydGV4UG9zaXRpb24uYXBwbHlNYXRyaXg0KF92aWV3V29ybGRNYXRyaXgpOwp9CmNvbnN0IF92MSQyID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF92MiQxID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNsYXNzIExPRCBleHRlbmRzIE9iamVjdDNEIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLl9jdXJyZW50TGV2ZWwgPSAwOwogICAgdGhpcy50eXBlID0gIkxPRCI7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLCB7CiAgICAgIGxldmVsczogewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IFtdCiAgICAgIH0sCiAgICAgIGlzTE9EOiB7CiAgICAgICAgdmFsdWU6IHRydWUKICAgICAgfQogICAgfSk7CiAgICB0aGlzLmF1dG9VcGRhdGUgPSB0cnVlOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UsIGZhbHNlKTsKICAgIGNvbnN0IGxldmVscyA9IHNvdXJjZS5sZXZlbHM7CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IGxldmVscy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgY29uc3QgbGV2ZWwgPSBsZXZlbHNbaV07CiAgICAgIHRoaXMuYWRkTGV2ZWwobGV2ZWwub2JqZWN0LmNsb25lKCksIGxldmVsLmRpc3RhbmNlKTsKICAgIH0KICAgIHRoaXMuYXV0b1VwZGF0ZSA9IHNvdXJjZS5hdXRvVXBkYXRlOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGFkZExldmVsKG9iamVjdCwgZGlzdGFuY2UgPSAwKSB7CiAgICBkaXN0YW5jZSA9IE1hdGguYWJzKGRpc3RhbmNlKTsKICAgIGNvbnN0IGxldmVscyA9IHRoaXMubGV2ZWxzOwogICAgbGV0IGw7CiAgICBmb3IgKGwgPSAwOyBsIDwgbGV2ZWxzLmxlbmd0aDsgbCsrKSB7CiAgICAgIGlmIChkaXN0YW5jZSA8IGxldmVsc1tsXS5kaXN0YW5jZSkgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgICBsZXZlbHMuc3BsaWNlKGwsIDAsIHsgZGlzdGFuY2UsIG9iamVjdCB9KTsKICAgIHRoaXMuYWRkKG9iamVjdCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZ2V0Q3VycmVudExldmVsKCkgewogICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRMZXZlbDsKICB9CiAgZ2V0T2JqZWN0Rm9yRGlzdGFuY2UoZGlzdGFuY2UpIHsKICAgIGNvbnN0IGxldmVscyA9IHRoaXMubGV2ZWxzOwogICAgaWYgKGxldmVscy5sZW5ndGggPiAwKSB7CiAgICAgIGxldCBpLCBsOwogICAgICBmb3IgKGkgPSAxLCBsID0gbGV2ZWxzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGlmIChkaXN0YW5jZSA8IGxldmVsc1tpXS5kaXN0YW5jZSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBsZXZlbHNbaSAtIDFdLm9iamVjdDsKICAgIH0KICAgIHJldHVybiBudWxsOwogIH0KICByYXljYXN0KHJheWNhc3RlciwgaW50ZXJzZWN0czIpIHsKICAgIGNvbnN0IGxldmVscyA9IHRoaXMubGV2ZWxzOwogICAgaWYgKGxldmVscy5sZW5ndGggPiAwKSB7CiAgICAgIF92MSQyLnNldEZyb21NYXRyaXhQb3NpdGlvbih0aGlzLm1hdHJpeFdvcmxkKTsKICAgICAgY29uc3QgZGlzdGFuY2UgPSByYXljYXN0ZXIucmF5Lm9yaWdpbi5kaXN0YW5jZVRvKF92MSQyKTsKICAgICAgdGhpcy5nZXRPYmplY3RGb3JEaXN0YW5jZShkaXN0YW5jZSkucmF5Y2FzdChyYXljYXN0ZXIsIGludGVyc2VjdHMyKTsKICAgIH0KICB9CiAgdXBkYXRlKGNhbWVyYSkgewogICAgY29uc3QgbGV2ZWxzID0gdGhpcy5sZXZlbHM7CiAgICBpZiAobGV2ZWxzLmxlbmd0aCA+IDEpIHsKICAgICAgX3YxJDIuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKGNhbWVyYS5tYXRyaXhXb3JsZCk7CiAgICAgIF92MiQxLnNldEZyb21NYXRyaXhQb3NpdGlvbih0aGlzLm1hdHJpeFdvcmxkKTsKICAgICAgY29uc3QgZGlzdGFuY2UgPSBfdjEkMi5kaXN0YW5jZVRvKF92MiQxKSAvIGNhbWVyYS56b29tOwogICAgICBsZXZlbHNbMF0ub2JqZWN0LnZpc2libGUgPSB0cnVlOwogICAgICBsZXQgaSwgbDsKICAgICAgZm9yIChpID0gMSwgbCA9IGxldmVscy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBpZiAoZGlzdGFuY2UgPj0gbGV2ZWxzW2ldLmRpc3RhbmNlKSB7CiAgICAgICAgICBsZXZlbHNbaSAtIDFdLm9iamVjdC52aXNpYmxlID0gZmFsc2U7CiAgICAgICAgICBsZXZlbHNbaV0ub2JqZWN0LnZpc2libGUgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5fY3VycmVudExldmVsID0gaSAtIDE7CiAgICAgIGZvciAoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgbGV2ZWxzW2ldLm9iamVjdC52aXNpYmxlID0gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9CiAgdG9KU09OKG1ldGEpIHsKICAgIGNvbnN0IGRhdGEgPSBzdXBlci50b0pTT04obWV0YSk7CiAgICBpZiAodGhpcy5hdXRvVXBkYXRlID09PSBmYWxzZSkKICAgICAgZGF0YS5vYmplY3QuYXV0b1VwZGF0ZSA9IGZhbHNlOwogICAgZGF0YS5vYmplY3QubGV2ZWxzID0gW107CiAgICBjb25zdCBsZXZlbHMgPSB0aGlzLmxldmVsczsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gbGV2ZWxzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBjb25zdCBsZXZlbCA9IGxldmVsc1tpXTsKICAgICAgZGF0YS5vYmplY3QubGV2ZWxzLnB1c2goewogICAgICAgIG9iamVjdDogbGV2ZWwub2JqZWN0LnV1aWQsCiAgICAgICAgZGlzdGFuY2U6IGxldmVsLmRpc3RhbmNlCiAgICAgIH0pOwogICAgfQogICAgcmV0dXJuIGRhdGE7CiAgfQp9CmNvbnN0IF9iYXNlUG9zaXRpb24gPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3NraW5JbmRleCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yNCgpOwpjb25zdCBfc2tpbldlaWdodCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yNCgpOwpjb25zdCBfdmVjdG9yJDUgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX21hdHJpeCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWF0cml4NCgpOwpjbGFzcyBTa2lubmVkTWVzaCBleHRlbmRzIE1lc2ggewogIGNvbnN0cnVjdG9yKGdlb21ldHJ5LCBtYXRlcmlhbCkgewogICAgc3VwZXIoZ2VvbWV0cnksIG1hdGVyaWFsKTsKICAgIHRoaXMudHlwZSA9ICJTa2lubmVkTWVzaCI7CiAgICB0aGlzLmJpbmRNb2RlID0gImF0dGFjaGVkIjsKICAgIHRoaXMuYmluZE1hdHJpeCA9IG5ldyBNYXRyaXg0KCk7CiAgICB0aGlzLmJpbmRNYXRyaXhJbnZlcnNlID0gbmV3IE1hdHJpeDQoKTsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHN1cGVyLmNvcHkoc291cmNlKTsKICAgIHRoaXMuYmluZE1vZGUgPSBzb3VyY2UuYmluZE1vZGU7CiAgICB0aGlzLmJpbmRNYXRyaXguY29weShzb3VyY2UuYmluZE1hdHJpeCk7CiAgICB0aGlzLmJpbmRNYXRyaXhJbnZlcnNlLmNvcHkoc291cmNlLmJpbmRNYXRyaXhJbnZlcnNlKTsKICAgIHRoaXMuc2tlbGV0b24gPSBzb3VyY2Uuc2tlbGV0b247CiAgICByZXR1cm4gdGhpczsKICB9CiAgYmluZChza2VsZXRvbiwgYmluZE1hdHJpeCkgewogICAgdGhpcy5za2VsZXRvbiA9IHNrZWxldG9uOwogICAgaWYgKGJpbmRNYXRyaXggPT09IHZvaWQgMCkgewogICAgICB0aGlzLnVwZGF0ZU1hdHJpeFdvcmxkKHRydWUpOwogICAgICB0aGlzLnNrZWxldG9uLmNhbGN1bGF0ZUludmVyc2VzKCk7CiAgICAgIGJpbmRNYXRyaXggPSB0aGlzLm1hdHJpeFdvcmxkOwogICAgfQogICAgdGhpcy5iaW5kTWF0cml4LmNvcHkoYmluZE1hdHJpeCk7CiAgICB0aGlzLmJpbmRNYXRyaXhJbnZlcnNlLmNvcHkoYmluZE1hdHJpeCkuaW52ZXJ0KCk7CiAgfQogIHBvc2UoKSB7CiAgICB0aGlzLnNrZWxldG9uLnBvc2UoKTsKICB9CiAgbm9ybWFsaXplU2tpbldlaWdodHMoKSB7CiAgICBjb25zdCB2ZWN0b3IgPSBuZXcgVmVjdG9yNCgpOwogICAgY29uc3Qgc2tpbldlaWdodCA9IHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5za2luV2VpZ2h0OwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSBza2luV2VpZ2h0LmNvdW50OyBpIDwgbDsgaSsrKSB7CiAgICAgIHZlY3Rvci54ID0gc2tpbldlaWdodC5nZXRYKGkpOwogICAgICB2ZWN0b3IueSA9IHNraW5XZWlnaHQuZ2V0WShpKTsKICAgICAgdmVjdG9yLnogPSBza2luV2VpZ2h0LmdldFooaSk7CiAgICAgIHZlY3Rvci53ID0gc2tpbldlaWdodC5nZXRXKGkpOwogICAgICBjb25zdCBzY2FsZSA9IDEgLyB2ZWN0b3IubWFuaGF0dGFuTGVuZ3RoKCk7CiAgICAgIGlmIChzY2FsZSAhPT0gSW5maW5pdHkpIHsKICAgICAgICB2ZWN0b3IubXVsdGlwbHlTY2FsYXIoc2NhbGUpOwogICAgICB9IGVsc2UgewogICAgICAgIHZlY3Rvci5zZXQoMSwgMCwgMCwgMCk7CiAgICAgIH0KICAgICAgc2tpbldlaWdodC5zZXRYWVpXKGksIHZlY3Rvci54LCB2ZWN0b3IueSwgdmVjdG9yLnosIHZlY3Rvci53KTsKICAgIH0KICB9CiAgdXBkYXRlTWF0cml4V29ybGQoZm9yY2UpIHsKICAgIHN1cGVyLnVwZGF0ZU1hdHJpeFdvcmxkKGZvcmNlKTsKICAgIGlmICh0aGlzLmJpbmRNb2RlID09PSAiYXR0YWNoZWQiKSB7CiAgICAgIHRoaXMuYmluZE1hdHJpeEludmVyc2UuY29weSh0aGlzLm1hdHJpeFdvcmxkKS5pbnZlcnQoKTsKICAgIH0gZWxzZSBpZiAodGhpcy5iaW5kTW9kZSA9PT0gImRldGFjaGVkIikgewogICAgICB0aGlzLmJpbmRNYXRyaXhJbnZlcnNlLmNvcHkodGhpcy5iaW5kTWF0cml4KS5pbnZlcnQoKTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuU2tpbm5lZE1lc2g6IFVucmVjb2duaXplZCBiaW5kTW9kZTogIiArIHRoaXMuYmluZE1vZGUpOwogICAgfQogIH0KICBib25lVHJhbnNmb3JtKGluZGV4LCB0YXJnZXQpIHsKICAgIGNvbnN0IHNrZWxldG9uID0gdGhpcy5za2VsZXRvbjsKICAgIGNvbnN0IGdlb21ldHJ5ID0gdGhpcy5nZW9tZXRyeTsKICAgIF9za2luSW5kZXguZnJvbUJ1ZmZlckF0dHJpYnV0ZShnZW9tZXRyeS5hdHRyaWJ1dGVzLnNraW5JbmRleCwgaW5kZXgpOwogICAgX3NraW5XZWlnaHQuZnJvbUJ1ZmZlckF0dHJpYnV0ZShnZW9tZXRyeS5hdHRyaWJ1dGVzLnNraW5XZWlnaHQsIGluZGV4KTsKICAgIF9iYXNlUG9zaXRpb24uY29weSh0YXJnZXQpLmFwcGx5TWF0cml4NCh0aGlzLmJpbmRNYXRyaXgpOwogICAgdGFyZ2V0LnNldCgwLCAwLCAwKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNDsgaSsrKSB7CiAgICAgIGNvbnN0IHdlaWdodCA9IF9za2luV2VpZ2h0LmdldENvbXBvbmVudChpKTsKICAgICAgaWYgKHdlaWdodCAhPT0gMCkgewogICAgICAgIGNvbnN0IGJvbmVJbmRleCA9IF9za2luSW5kZXguZ2V0Q29tcG9uZW50KGkpOwogICAgICAgIF9tYXRyaXgubXVsdGlwbHlNYXRyaWNlcyhza2VsZXRvbi5ib25lc1tib25lSW5kZXhdLm1hdHJpeFdvcmxkLCBza2VsZXRvbi5ib25lSW52ZXJzZXNbYm9uZUluZGV4XSk7CiAgICAgICAgdGFyZ2V0LmFkZFNjYWxlZFZlY3RvcihfdmVjdG9yJDUuY29weShfYmFzZVBvc2l0aW9uKS5hcHBseU1hdHJpeDQoX21hdHJpeCksIHdlaWdodCk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0YXJnZXQuYXBwbHlNYXRyaXg0KHRoaXMuYmluZE1hdHJpeEludmVyc2UpOwogIH0KfQpTa2lubmVkTWVzaC5wcm90b3R5cGUuaXNTa2lubmVkTWVzaCA9IHRydWU7CmNsYXNzIEJvbmUgZXh0ZW5kcyBPYmplY3QzRCB7CiAgY29uc3RydWN0b3IoKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkJvbmUiOwogIH0KfQpCb25lLnByb3RvdHlwZS5pc0JvbmUgPSB0cnVlOwpjbGFzcyBEYXRhVGV4dHVyZSBleHRlbmRzIFRleHR1cmUgewogIGNvbnN0cnVjdG9yKGRhdGEgPSBudWxsLCB3aWR0aCA9IDEsIGhlaWdodCA9IDEsIGZvcm1hdCwgdHlwZSwgbWFwcGluZywgd3JhcFMsIHdyYXBULCBtYWdGaWx0ZXIgPSBOZWFyZXN0RmlsdGVyLCBtaW5GaWx0ZXIgPSBOZWFyZXN0RmlsdGVyLCBhbmlzb3Ryb3B5LCBlbmNvZGluZykgewogICAgc3VwZXIobnVsbCwgbWFwcGluZywgd3JhcFMsIHdyYXBULCBtYWdGaWx0ZXIsIG1pbkZpbHRlciwgZm9ybWF0LCB0eXBlLCBhbmlzb3Ryb3B5LCBlbmNvZGluZyk7CiAgICB0aGlzLmltYWdlID0geyBkYXRhLCB3aWR0aCwgaGVpZ2h0IH07CiAgICB0aGlzLm1hZ0ZpbHRlciA9IG1hZ0ZpbHRlcjsKICAgIHRoaXMubWluRmlsdGVyID0gbWluRmlsdGVyOwogICAgdGhpcy5nZW5lcmF0ZU1pcG1hcHMgPSBmYWxzZTsKICAgIHRoaXMuZmxpcFkgPSBmYWxzZTsKICAgIHRoaXMudW5wYWNrQWxpZ25tZW50ID0gMTsKICB9Cn0KRGF0YVRleHR1cmUucHJvdG90eXBlLmlzRGF0YVRleHR1cmUgPSB0cnVlOwpjb25zdCBfb2Zmc2V0TWF0cml4ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXRyaXg0KCk7CmNvbnN0IF9pZGVudGl0eU1hdHJpeCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWF0cml4NCgpOwpjbGFzcyBTa2VsZXRvbiB7CiAgY29uc3RydWN0b3IoYm9uZXMgPSBbXSwgYm9uZUludmVyc2VzID0gW10pIHsKICAgIHRoaXMudXVpZCA9IGdlbmVyYXRlVVVJRCgpOwogICAgdGhpcy5ib25lcyA9IGJvbmVzLnNsaWNlKDApOwogICAgdGhpcy5ib25lSW52ZXJzZXMgPSBib25lSW52ZXJzZXM7CiAgICB0aGlzLmJvbmVNYXRyaWNlcyA9IG51bGw7CiAgICB0aGlzLmJvbmVUZXh0dXJlID0gbnVsbDsKICAgIHRoaXMuYm9uZVRleHR1cmVTaXplID0gMDsKICAgIHRoaXMuZnJhbWUgPSAtMTsKICAgIHRoaXMuaW5pdCgpOwogIH0KICBpbml0KCkgewogICAgY29uc3QgYm9uZXMgPSB0aGlzLmJvbmVzOwogICAgY29uc3QgYm9uZUludmVyc2VzID0gdGhpcy5ib25lSW52ZXJzZXM7CiAgICB0aGlzLmJvbmVNYXRyaWNlcyA9IG5ldyBGbG9hdDMyQXJyYXkoYm9uZXMubGVuZ3RoICogMTYpOwogICAgaWYgKGJvbmVJbnZlcnNlcy5sZW5ndGggPT09IDApIHsKICAgICAgdGhpcy5jYWxjdWxhdGVJbnZlcnNlcygpOwogICAgfSBlbHNlIHsKICAgICAgaWYgKGJvbmVzLmxlbmd0aCAhPT0gYm9uZUludmVyc2VzLmxlbmd0aCkgewogICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuU2tlbGV0b246IE51bWJlciBvZiBpbnZlcnNlIGJvbmUgbWF0cmljZXMgZG9lcyBub3QgbWF0Y2ggYW1vdW50IG9mIGJvbmVzLiIpOwogICAgICAgIHRoaXMuYm9uZUludmVyc2VzID0gW107CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlsID0gdGhpcy5ib25lcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgICAgICB0aGlzLmJvbmVJbnZlcnNlcy5wdXNoKG5ldyBNYXRyaXg0KCkpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICBjYWxjdWxhdGVJbnZlcnNlcygpIHsKICAgIHRoaXMuYm9uZUludmVyc2VzLmxlbmd0aCA9IDA7CiAgICBmb3IgKGxldCBpID0gMCwgaWwgPSB0aGlzLmJvbmVzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHsKICAgICAgY29uc3QgaW52ZXJzZSA9IG5ldyBNYXRyaXg0KCk7CiAgICAgIGlmICh0aGlzLmJvbmVzW2ldKSB7CiAgICAgICAgaW52ZXJzZS5jb3B5KHRoaXMuYm9uZXNbaV0ubWF0cml4V29ybGQpLmludmVydCgpOwogICAgICB9CiAgICAgIHRoaXMuYm9uZUludmVyc2VzLnB1c2goaW52ZXJzZSk7CiAgICB9CiAgfQogIHBvc2UoKSB7CiAgICBmb3IgKGxldCBpID0gMCwgaWwgPSB0aGlzLmJvbmVzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHsKICAgICAgY29uc3QgYm9uZSA9IHRoaXMuYm9uZXNbaV07CiAgICAgIGlmIChib25lKSB7CiAgICAgICAgYm9uZS5tYXRyaXhXb3JsZC5jb3B5KHRoaXMuYm9uZUludmVyc2VzW2ldKS5pbnZlcnQoKTsKICAgICAgfQogICAgfQogICAgZm9yIChsZXQgaSA9IDAsIGlsID0gdGhpcy5ib25lcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgIGNvbnN0IGJvbmUgPSB0aGlzLmJvbmVzW2ldOwogICAgICBpZiAoYm9uZSkgewogICAgICAgIGlmIChib25lLnBhcmVudCAmJiBib25lLnBhcmVudC5pc0JvbmUpIHsKICAgICAgICAgIGJvbmUubWF0cml4LmNvcHkoYm9uZS5wYXJlbnQubWF0cml4V29ybGQpLmludmVydCgpOwogICAgICAgICAgYm9uZS5tYXRyaXgubXVsdGlwbHkoYm9uZS5tYXRyaXhXb3JsZCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGJvbmUubWF0cml4LmNvcHkoYm9uZS5tYXRyaXhXb3JsZCk7CiAgICAgICAgfQogICAgICAgIGJvbmUubWF0cml4LmRlY29tcG9zZShib25lLnBvc2l0aW9uLCBib25lLnF1YXRlcm5pb24sIGJvbmUuc2NhbGUpOwogICAgICB9CiAgICB9CiAgfQogIHVwZGF0ZSgpIHsKICAgIGNvbnN0IGJvbmVzID0gdGhpcy5ib25lczsKICAgIGNvbnN0IGJvbmVJbnZlcnNlcyA9IHRoaXMuYm9uZUludmVyc2VzOwogICAgY29uc3QgYm9uZU1hdHJpY2VzID0gdGhpcy5ib25lTWF0cmljZXM7CiAgICBjb25zdCBib25lVGV4dHVyZSA9IHRoaXMuYm9uZVRleHR1cmU7CiAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBib25lcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgIGNvbnN0IG1hdHJpeCA9IGJvbmVzW2ldID8gYm9uZXNbaV0ubWF0cml4V29ybGQgOiBfaWRlbnRpdHlNYXRyaXg7CiAgICAgIF9vZmZzZXRNYXRyaXgubXVsdGlwbHlNYXRyaWNlcyhtYXRyaXgsIGJvbmVJbnZlcnNlc1tpXSk7CiAgICAgIF9vZmZzZXRNYXRyaXgudG9BcnJheShib25lTWF0cmljZXMsIGkgKiAxNik7CiAgICB9CiAgICBpZiAoYm9uZVRleHR1cmUgIT09IG51bGwpIHsKICAgICAgYm9uZVRleHR1cmUubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgfQogIH0KICBjbG9uZSgpIHsKICAgIHJldHVybiBuZXcgU2tlbGV0b24odGhpcy5ib25lcywgdGhpcy5ib25lSW52ZXJzZXMpOwogIH0KICBjb21wdXRlQm9uZVRleHR1cmUoKSB7CiAgICBsZXQgc2l6ZSA9IE1hdGguc3FydCh0aGlzLmJvbmVzLmxlbmd0aCAqIDQpOwogICAgc2l6ZSA9IGNlaWxQb3dlck9mVHdvKHNpemUpOwogICAgc2l6ZSA9IE1hdGgubWF4KHNpemUsIDQpOwogICAgY29uc3QgYm9uZU1hdHJpY2VzID0gbmV3IEZsb2F0MzJBcnJheShzaXplICogc2l6ZSAqIDQpOwogICAgYm9uZU1hdHJpY2VzLnNldCh0aGlzLmJvbmVNYXRyaWNlcyk7CiAgICBjb25zdCBib25lVGV4dHVyZSA9IG5ldyBEYXRhVGV4dHVyZShib25lTWF0cmljZXMsIHNpemUsIHNpemUsIFJHQkFGb3JtYXQsIEZsb2F0VHlwZSk7CiAgICBib25lVGV4dHVyZS5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICB0aGlzLmJvbmVNYXRyaWNlcyA9IGJvbmVNYXRyaWNlczsKICAgIHRoaXMuYm9uZVRleHR1cmUgPSBib25lVGV4dHVyZTsKICAgIHRoaXMuYm9uZVRleHR1cmVTaXplID0gc2l6ZTsKICAgIHJldHVybiB0aGlzOwogIH0KICBnZXRCb25lQnlOYW1lKG5hbWUpIHsKICAgIGZvciAobGV0IGkgPSAwLCBpbCA9IHRoaXMuYm9uZXMubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICBjb25zdCBib25lID0gdGhpcy5ib25lc1tpXTsKICAgICAgaWYgKGJvbmUubmFtZSA9PT0gbmFtZSkgewogICAgICAgIHJldHVybiBib25lOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gdm9pZCAwOwogIH0KICBkaXNwb3NlKCkgewogICAgaWYgKHRoaXMuYm9uZVRleHR1cmUgIT09IG51bGwpIHsKICAgICAgdGhpcy5ib25lVGV4dHVyZS5kaXNwb3NlKCk7CiAgICAgIHRoaXMuYm9uZVRleHR1cmUgPSBudWxsOwogICAgfQogIH0KICBmcm9tSlNPTihqc29uLCBib25lcykgewogICAgdGhpcy51dWlkID0ganNvbi51dWlkOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSBqc29uLmJvbmVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBjb25zdCB1dWlkID0ganNvbi5ib25lc1tpXTsKICAgICAgbGV0IGJvbmUgPSBib25lc1t1dWlkXTsKICAgICAgaWYgKGJvbmUgPT09IHZvaWQgMCkgewogICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuU2tlbGV0b246IE5vIGJvbmUgZm91bmQgd2l0aCBVVUlEOiIsIHV1aWQpOwogICAgICAgIGJvbmUgPSBuZXcgQm9uZSgpOwogICAgICB9CiAgICAgIHRoaXMuYm9uZXMucHVzaChib25lKTsKICAgICAgdGhpcy5ib25lSW52ZXJzZXMucHVzaChuZXcgTWF0cml4NCgpLmZyb21BcnJheShqc29uLmJvbmVJbnZlcnNlc1tpXSkpOwogICAgfQogICAgdGhpcy5pbml0KCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgdG9KU09OKCkgewogICAgY29uc3QgZGF0YSA9IHsKICAgICAgbWV0YWRhdGE6IHsKICAgICAgICB2ZXJzaW9uOiA0LjUsCiAgICAgICAgdHlwZTogIlNrZWxldG9uIiwKICAgICAgICBnZW5lcmF0b3I6ICJTa2VsZXRvbi50b0pTT04iCiAgICAgIH0sCiAgICAgIGJvbmVzOiBbXSwKICAgICAgYm9uZUludmVyc2VzOiBbXQogICAgfTsKICAgIGRhdGEudXVpZCA9IHRoaXMudXVpZDsKICAgIGNvbnN0IGJvbmVzID0gdGhpcy5ib25lczsKICAgIGNvbnN0IGJvbmVJbnZlcnNlcyA9IHRoaXMuYm9uZUludmVyc2VzOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSBib25lcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgY29uc3QgYm9uZSA9IGJvbmVzW2ldOwogICAgICBkYXRhLmJvbmVzLnB1c2goYm9uZS51dWlkKTsKICAgICAgY29uc3QgYm9uZUludmVyc2UgPSBib25lSW52ZXJzZXNbaV07CiAgICAgIGRhdGEuYm9uZUludmVyc2VzLnB1c2goYm9uZUludmVyc2UudG9BcnJheSgpKTsKICAgIH0KICAgIHJldHVybiBkYXRhOwogIH0KfQpjbGFzcyBJbnN0YW5jZWRCdWZmZXJBdHRyaWJ1dGUgZXh0ZW5kcyBCdWZmZXJBdHRyaWJ1dGUgewogIGNvbnN0cnVjdG9yKGFycmF5LCBpdGVtU2l6ZSwgbm9ybWFsaXplZCwgbWVzaFBlckF0dHJpYnV0ZSA9IDEpIHsKICAgIGlmICh0eXBlb2Ygbm9ybWFsaXplZCA9PT0gIm51bWJlciIpIHsKICAgICAgbWVzaFBlckF0dHJpYnV0ZSA9IG5vcm1hbGl6ZWQ7CiAgICAgIG5vcm1hbGl6ZWQgPSBmYWxzZTsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuSW5zdGFuY2VkQnVmZmVyQXR0cmlidXRlOiBUaGUgY29uc3RydWN0b3Igbm93IGV4cGVjdHMgbm9ybWFsaXplZCBhcyB0aGUgdGhpcmQgYXJndW1lbnQuIik7CiAgICB9CiAgICBzdXBlcihhcnJheSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpOwogICAgdGhpcy5tZXNoUGVyQXR0cmlidXRlID0gbWVzaFBlckF0dHJpYnV0ZTsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHN1cGVyLmNvcHkoc291cmNlKTsKICAgIHRoaXMubWVzaFBlckF0dHJpYnV0ZSA9IHNvdXJjZS5tZXNoUGVyQXR0cmlidXRlOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRvSlNPTigpIHsKICAgIGNvbnN0IGRhdGEgPSBzdXBlci50b0pTT04oKTsKICAgIGRhdGEubWVzaFBlckF0dHJpYnV0ZSA9IHRoaXMubWVzaFBlckF0dHJpYnV0ZTsKICAgIGRhdGEuaXNJbnN0YW5jZWRCdWZmZXJBdHRyaWJ1dGUgPSB0cnVlOwogICAgcmV0dXJuIGRhdGE7CiAgfQp9Ckluc3RhbmNlZEJ1ZmZlckF0dHJpYnV0ZS5wcm90b3R5cGUuaXNJbnN0YW5jZWRCdWZmZXJBdHRyaWJ1dGUgPSB0cnVlOwpjb25zdCBfaW5zdGFuY2VMb2NhbE1hdHJpeCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWF0cml4NCgpOwpjb25zdCBfaW5zdGFuY2VXb3JsZE1hdHJpeCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWF0cml4NCgpOwpjb25zdCBfaW5zdGFuY2VJbnRlcnNlY3RzID0gW107CmNvbnN0IF9tZXNoID0gLyogQF9fUFVSRV9fICovIG5ldyBNZXNoKCk7CmNsYXNzIEluc3RhbmNlZE1lc2ggZXh0ZW5kcyBNZXNoIHsKICBjb25zdHJ1Y3RvcihnZW9tZXRyeSwgbWF0ZXJpYWwsIGNvdW50KSB7CiAgICBzdXBlcihnZW9tZXRyeSwgbWF0ZXJpYWwpOwogICAgdGhpcy5pbnN0YW5jZU1hdHJpeCA9IG5ldyBJbnN0YW5jZWRCdWZmZXJBdHRyaWJ1dGUobmV3IEZsb2F0MzJBcnJheShjb3VudCAqIDE2KSwgMTYpOwogICAgdGhpcy5pbnN0YW5jZUNvbG9yID0gbnVsbDsKICAgIHRoaXMuY291bnQgPSBjb3VudDsKICAgIHRoaXMuZnJ1c3R1bUN1bGxlZCA9IGZhbHNlOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy5pbnN0YW5jZU1hdHJpeC5jb3B5KHNvdXJjZS5pbnN0YW5jZU1hdHJpeCk7CiAgICBpZiAoc291cmNlLmluc3RhbmNlQ29sb3IgIT09IG51bGwpCiAgICAgIHRoaXMuaW5zdGFuY2VDb2xvciA9IHNvdXJjZS5pbnN0YW5jZUNvbG9yLmNsb25lKCk7CiAgICB0aGlzLmNvdW50ID0gc291cmNlLmNvdW50OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGdldENvbG9yQXQoaW5kZXgsIGNvbG9yKSB7CiAgICBjb2xvci5mcm9tQXJyYXkodGhpcy5pbnN0YW5jZUNvbG9yLmFycmF5LCBpbmRleCAqIDMpOwogIH0KICBnZXRNYXRyaXhBdChpbmRleCwgbWF0cml4KSB7CiAgICBtYXRyaXguZnJvbUFycmF5KHRoaXMuaW5zdGFuY2VNYXRyaXguYXJyYXksIGluZGV4ICogMTYpOwogIH0KICByYXljYXN0KHJheWNhc3RlciwgaW50ZXJzZWN0czIpIHsKICAgIGNvbnN0IG1hdHJpeFdvcmxkID0gdGhpcy5tYXRyaXhXb3JsZDsKICAgIGNvbnN0IHJheWNhc3RUaW1lcyA9IHRoaXMuY291bnQ7CiAgICBfbWVzaC5nZW9tZXRyeSA9IHRoaXMuZ2VvbWV0cnk7CiAgICBfbWVzaC5tYXRlcmlhbCA9IHRoaXMubWF0ZXJpYWw7CiAgICBpZiAoX21lc2gubWF0ZXJpYWwgPT09IHZvaWQgMCkKICAgICAgcmV0dXJuOwogICAgZm9yIChsZXQgaW5zdGFuY2VJZCA9IDA7IGluc3RhbmNlSWQgPCByYXljYXN0VGltZXM7IGluc3RhbmNlSWQrKykgewogICAgICB0aGlzLmdldE1hdHJpeEF0KGluc3RhbmNlSWQsIF9pbnN0YW5jZUxvY2FsTWF0cml4KTsKICAgICAgX2luc3RhbmNlV29ybGRNYXRyaXgubXVsdGlwbHlNYXRyaWNlcyhtYXRyaXhXb3JsZCwgX2luc3RhbmNlTG9jYWxNYXRyaXgpOwogICAgICBfbWVzaC5tYXRyaXhXb3JsZCA9IF9pbnN0YW5jZVdvcmxkTWF0cml4OwogICAgICBfbWVzaC5yYXljYXN0KHJheWNhc3RlciwgX2luc3RhbmNlSW50ZXJzZWN0cyk7CiAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gX2luc3RhbmNlSW50ZXJzZWN0cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBjb25zdCBpbnRlcnNlY3QgPSBfaW5zdGFuY2VJbnRlcnNlY3RzW2ldOwogICAgICAgIGludGVyc2VjdC5pbnN0YW5jZUlkID0gaW5zdGFuY2VJZDsKICAgICAgICBpbnRlcnNlY3Qub2JqZWN0ID0gdGhpczsKICAgICAgICBpbnRlcnNlY3RzMi5wdXNoKGludGVyc2VjdCk7CiAgICAgIH0KICAgICAgX2luc3RhbmNlSW50ZXJzZWN0cy5sZW5ndGggPSAwOwogICAgfQogIH0KICBzZXRDb2xvckF0KGluZGV4LCBjb2xvcikgewogICAgaWYgKHRoaXMuaW5zdGFuY2VDb2xvciA9PT0gbnVsbCkgewogICAgICB0aGlzLmluc3RhbmNlQ29sb3IgPSBuZXcgSW5zdGFuY2VkQnVmZmVyQXR0cmlidXRlKG5ldyBGbG9hdDMyQXJyYXkodGhpcy5pbnN0YW5jZU1hdHJpeC5jb3VudCAqIDMpLCAzKTsKICAgIH0KICAgIGNvbG9yLnRvQXJyYXkodGhpcy5pbnN0YW5jZUNvbG9yLmFycmF5LCBpbmRleCAqIDMpOwogIH0KICBzZXRNYXRyaXhBdChpbmRleCwgbWF0cml4KSB7CiAgICBtYXRyaXgudG9BcnJheSh0aGlzLmluc3RhbmNlTWF0cml4LmFycmF5LCBpbmRleCAqIDE2KTsKICB9CiAgdXBkYXRlTW9ycGhUYXJnZXRzKCkgewogIH0KICBkaXNwb3NlKCkgewogICAgdGhpcy5kaXNwYXRjaEV2ZW50KHsgdHlwZTogImRpc3Bvc2UiIH0pOwogIH0KfQpJbnN0YW5jZWRNZXNoLnByb3RvdHlwZS5pc0luc3RhbmNlZE1lc2ggPSB0cnVlOwpjbGFzcyBMaW5lQmFzaWNNYXRlcmlhbCBleHRlbmRzIE1hdGVyaWFsIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkxpbmVCYXNpY01hdGVyaWFsIjsKICAgIHRoaXMuY29sb3IgPSBuZXcgQ29sb3IoMTY3NzcyMTUpOwogICAgdGhpcy5saW5ld2lkdGggPSAxOwogICAgdGhpcy5saW5lY2FwID0gInJvdW5kIjsKICAgIHRoaXMubGluZWpvaW4gPSAicm91bmQiOwogICAgdGhpcy5zZXRWYWx1ZXMocGFyYW1ldGVycyk7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLmNvbG9yLmNvcHkoc291cmNlLmNvbG9yKTsKICAgIHRoaXMubGluZXdpZHRoID0gc291cmNlLmxpbmV3aWR0aDsKICAgIHRoaXMubGluZWNhcCA9IHNvdXJjZS5saW5lY2FwOwogICAgdGhpcy5saW5lam9pbiA9IHNvdXJjZS5saW5lam9pbjsKICAgIHJldHVybiB0aGlzOwogIH0KfQpMaW5lQmFzaWNNYXRlcmlhbC5wcm90b3R5cGUuaXNMaW5lQmFzaWNNYXRlcmlhbCA9IHRydWU7CmNvbnN0IF9zdGFydCQxID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF9lbmQkMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfaW52ZXJzZU1hdHJpeCQxID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXRyaXg0KCk7CmNvbnN0IF9yYXkkMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgUmF5KCk7CmNvbnN0IF9zcGhlcmUkMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU3BoZXJlKCk7CmNsYXNzIExpbmUgZXh0ZW5kcyBPYmplY3QzRCB7CiAgY29uc3RydWN0b3IoZ2VvbWV0cnkgPSBuZXcgQnVmZmVyR2VvbWV0cnkoKSwgbWF0ZXJpYWwgPSBuZXcgTGluZUJhc2ljTWF0ZXJpYWwoKSkgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJMaW5lIjsKICAgIHRoaXMuZ2VvbWV0cnkgPSBnZW9tZXRyeTsKICAgIHRoaXMubWF0ZXJpYWwgPSBtYXRlcmlhbDsKICAgIHRoaXMudXBkYXRlTW9ycGhUYXJnZXRzKCk7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLm1hdGVyaWFsID0gc291cmNlLm1hdGVyaWFsOwogICAgdGhpcy5nZW9tZXRyeSA9IHNvdXJjZS5nZW9tZXRyeTsKICAgIHJldHVybiB0aGlzOwogIH0KICBjb21wdXRlTGluZURpc3RhbmNlcygpIHsKICAgIGNvbnN0IGdlb21ldHJ5ID0gdGhpcy5nZW9tZXRyeTsKICAgIGlmIChnZW9tZXRyeS5pc0J1ZmZlckdlb21ldHJ5KSB7CiAgICAgIGlmIChnZW9tZXRyeS5pbmRleCA9PT0gbnVsbCkgewogICAgICAgIGNvbnN0IHBvc2l0aW9uQXR0cmlidXRlID0gZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbjsKICAgICAgICBjb25zdCBsaW5lRGlzdGFuY2VzID0gWzBdOwogICAgICAgIGZvciAobGV0IGkgPSAxLCBsID0gcG9zaXRpb25BdHRyaWJ1dGUuY291bnQ7IGkgPCBsOyBpKyspIHsKICAgICAgICAgIF9zdGFydCQxLmZyb21CdWZmZXJBdHRyaWJ1dGUocG9zaXRpb25BdHRyaWJ1dGUsIGkgLSAxKTsKICAgICAgICAgIF9lbmQkMS5mcm9tQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9uQXR0cmlidXRlLCBpKTsKICAgICAgICAgIGxpbmVEaXN0YW5jZXNbaV0gPSBsaW5lRGlzdGFuY2VzW2kgLSAxXTsKICAgICAgICAgIGxpbmVEaXN0YW5jZXNbaV0gKz0gX3N0YXJ0JDEuZGlzdGFuY2VUbyhfZW5kJDEpOwogICAgICAgIH0KICAgICAgICBnZW9tZXRyeS5zZXRBdHRyaWJ1dGUoImxpbmVEaXN0YW5jZSIsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKGxpbmVEaXN0YW5jZXMsIDEpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkxpbmUuY29tcHV0ZUxpbmVEaXN0YW5jZXMoKTogQ29tcHV0YXRpb24gb25seSBwb3NzaWJsZSB3aXRoIG5vbi1pbmRleGVkIEJ1ZmZlckdlb21ldHJ5LiIpOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGdlb21ldHJ5LmlzR2VvbWV0cnkpIHsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuTGluZS5jb21wdXRlTGluZURpc3RhbmNlcygpIG5vIGxvbmdlciBzdXBwb3J0cyBUSFJFRS5HZW9tZXRyeS4gVXNlIFRIUkVFLkJ1ZmZlckdlb21ldHJ5IGluc3RlYWQuIik7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9CiAgcmF5Y2FzdChyYXljYXN0ZXIsIGludGVyc2VjdHMyKSB7CiAgICBjb25zdCBnZW9tZXRyeSA9IHRoaXMuZ2VvbWV0cnk7CiAgICBjb25zdCBtYXRyaXhXb3JsZCA9IHRoaXMubWF0cml4V29ybGQ7CiAgICBjb25zdCB0aHJlc2hvbGQgPSByYXljYXN0ZXIucGFyYW1zLkxpbmUudGhyZXNob2xkOwogICAgY29uc3QgZHJhd1JhbmdlID0gZ2VvbWV0cnkuZHJhd1JhbmdlOwogICAgaWYgKGdlb21ldHJ5LmJvdW5kaW5nU3BoZXJlID09PSBudWxsKQogICAgICBnZW9tZXRyeS5jb21wdXRlQm91bmRpbmdTcGhlcmUoKTsKICAgIF9zcGhlcmUkMS5jb3B5KGdlb21ldHJ5LmJvdW5kaW5nU3BoZXJlKTsKICAgIF9zcGhlcmUkMS5hcHBseU1hdHJpeDQobWF0cml4V29ybGQpOwogICAgX3NwaGVyZSQxLnJhZGl1cyArPSB0aHJlc2hvbGQ7CiAgICBpZiAocmF5Y2FzdGVyLnJheS5pbnRlcnNlY3RzU3BoZXJlKF9zcGhlcmUkMSkgPT09IGZhbHNlKQogICAgICByZXR1cm47CiAgICBfaW52ZXJzZU1hdHJpeCQxLmNvcHkobWF0cml4V29ybGQpLmludmVydCgpOwogICAgX3JheSQxLmNvcHkocmF5Y2FzdGVyLnJheSkuYXBwbHlNYXRyaXg0KF9pbnZlcnNlTWF0cml4JDEpOwogICAgY29uc3QgbG9jYWxUaHJlc2hvbGQgPSB0aHJlc2hvbGQgLyAoKHRoaXMuc2NhbGUueCArIHRoaXMuc2NhbGUueSArIHRoaXMuc2NhbGUueikgLyAzKTsKICAgIGNvbnN0IGxvY2FsVGhyZXNob2xkU3EgPSBsb2NhbFRocmVzaG9sZCAqIGxvY2FsVGhyZXNob2xkOwogICAgY29uc3QgdlN0YXJ0ID0gbmV3IFZlY3RvcjMoKTsKICAgIGNvbnN0IHZFbmQgPSBuZXcgVmVjdG9yMygpOwogICAgY29uc3QgaW50ZXJTZWdtZW50ID0gbmV3IFZlY3RvcjMoKTsKICAgIGNvbnN0IGludGVyUmF5ID0gbmV3IFZlY3RvcjMoKTsKICAgIGNvbnN0IHN0ZXAgPSB0aGlzLmlzTGluZVNlZ21lbnRzID8gMiA6IDE7CiAgICBpZiAoZ2VvbWV0cnkuaXNCdWZmZXJHZW9tZXRyeSkgewogICAgICBjb25zdCBpbmRleCA9IGdlb21ldHJ5LmluZGV4OwogICAgICBjb25zdCBhdHRyaWJ1dGVzID0gZ2VvbWV0cnkuYXR0cmlidXRlczsKICAgICAgY29uc3QgcG9zaXRpb25BdHRyaWJ1dGUgPSBhdHRyaWJ1dGVzLnBvc2l0aW9uOwogICAgICBpZiAoaW5kZXggIT09IG51bGwpIHsKICAgICAgICBjb25zdCBzdGFydCA9IE1hdGgubWF4KDAsIGRyYXdSYW5nZS5zdGFydCk7CiAgICAgICAgY29uc3QgZW5kID0gTWF0aC5taW4oaW5kZXguY291bnQsIGRyYXdSYW5nZS5zdGFydCArIGRyYXdSYW5nZS5jb3VudCk7CiAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0LCBsID0gZW5kIC0gMTsgaSA8IGw7IGkgKz0gc3RlcCkgewogICAgICAgICAgY29uc3QgYSA9IGluZGV4LmdldFgoaSk7CiAgICAgICAgICBjb25zdCBiID0gaW5kZXguZ2V0WChpICsgMSk7CiAgICAgICAgICB2U3RhcnQuZnJvbUJ1ZmZlckF0dHJpYnV0ZShwb3NpdGlvbkF0dHJpYnV0ZSwgYSk7CiAgICAgICAgICB2RW5kLmZyb21CdWZmZXJBdHRyaWJ1dGUocG9zaXRpb25BdHRyaWJ1dGUsIGIpOwogICAgICAgICAgY29uc3QgZGlzdFNxID0gX3JheSQxLmRpc3RhbmNlU3FUb1NlZ21lbnQodlN0YXJ0LCB2RW5kLCBpbnRlclJheSwgaW50ZXJTZWdtZW50KTsKICAgICAgICAgIGlmIChkaXN0U3EgPiBsb2NhbFRocmVzaG9sZFNxKQogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIGludGVyUmF5LmFwcGx5TWF0cml4NCh0aGlzLm1hdHJpeFdvcmxkKTsKICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gcmF5Y2FzdGVyLnJheS5vcmlnaW4uZGlzdGFuY2VUbyhpbnRlclJheSk7CiAgICAgICAgICBpZiAoZGlzdGFuY2UgPCByYXljYXN0ZXIubmVhciB8fCBkaXN0YW5jZSA+IHJheWNhc3Rlci5mYXIpCiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgaW50ZXJzZWN0czIucHVzaCh7CiAgICAgICAgICAgIGRpc3RhbmNlLAogICAgICAgICAgICBwb2ludDogaW50ZXJTZWdtZW50LmNsb25lKCkuYXBwbHlNYXRyaXg0KHRoaXMubWF0cml4V29ybGQpLAogICAgICAgICAgICBpbmRleDogaSwKICAgICAgICAgICAgZmFjZTogbnVsbCwKICAgICAgICAgICAgZmFjZUluZGV4OiBudWxsLAogICAgICAgICAgICBvYmplY3Q6IHRoaXMKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBzdGFydCA9IE1hdGgubWF4KDAsIGRyYXdSYW5nZS5zdGFydCk7CiAgICAgICAgY29uc3QgZW5kID0gTWF0aC5taW4ocG9zaXRpb25BdHRyaWJ1dGUuY291bnQsIGRyYXdSYW5nZS5zdGFydCArIGRyYXdSYW5nZS5jb3VudCk7CiAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0LCBsID0gZW5kIC0gMTsgaSA8IGw7IGkgKz0gc3RlcCkgewogICAgICAgICAgdlN0YXJ0LmZyb21CdWZmZXJBdHRyaWJ1dGUocG9zaXRpb25BdHRyaWJ1dGUsIGkpOwogICAgICAgICAgdkVuZC5mcm9tQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9uQXR0cmlidXRlLCBpICsgMSk7CiAgICAgICAgICBjb25zdCBkaXN0U3EgPSBfcmF5JDEuZGlzdGFuY2VTcVRvU2VnbWVudCh2U3RhcnQsIHZFbmQsIGludGVyUmF5LCBpbnRlclNlZ21lbnQpOwogICAgICAgICAgaWYgKGRpc3RTcSA+IGxvY2FsVGhyZXNob2xkU3EpCiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgaW50ZXJSYXkuYXBwbHlNYXRyaXg0KHRoaXMubWF0cml4V29ybGQpOwogICAgICAgICAgY29uc3QgZGlzdGFuY2UgPSByYXljYXN0ZXIucmF5Lm9yaWdpbi5kaXN0YW5jZVRvKGludGVyUmF5KTsKICAgICAgICAgIGlmIChkaXN0YW5jZSA8IHJheWNhc3Rlci5uZWFyIHx8IGRpc3RhbmNlID4gcmF5Y2FzdGVyLmZhcikKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICBpbnRlcnNlY3RzMi5wdXNoKHsKICAgICAgICAgICAgZGlzdGFuY2UsCiAgICAgICAgICAgIHBvaW50OiBpbnRlclNlZ21lbnQuY2xvbmUoKS5hcHBseU1hdHJpeDQodGhpcy5tYXRyaXhXb3JsZCksCiAgICAgICAgICAgIGluZGV4OiBpLAogICAgICAgICAgICBmYWNlOiBudWxsLAogICAgICAgICAgICBmYWNlSW5kZXg6IG51bGwsCiAgICAgICAgICAgIG9iamVjdDogdGhpcwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKGdlb21ldHJ5LmlzR2VvbWV0cnkpIHsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuTGluZS5yYXljYXN0KCkgbm8gbG9uZ2VyIHN1cHBvcnRzIFRIUkVFLkdlb21ldHJ5LiBVc2UgVEhSRUUuQnVmZmVyR2VvbWV0cnkgaW5zdGVhZC4iKTsKICAgIH0KICB9CiAgdXBkYXRlTW9ycGhUYXJnZXRzKCkgewogICAgY29uc3QgZ2VvbWV0cnkgPSB0aGlzLmdlb21ldHJ5OwogICAgaWYgKGdlb21ldHJ5LmlzQnVmZmVyR2VvbWV0cnkpIHsKICAgICAgY29uc3QgbW9ycGhBdHRyaWJ1dGVzID0gZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzOwogICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMobW9ycGhBdHRyaWJ1dGVzKTsKICAgICAgaWYgKGtleXMubGVuZ3RoID4gMCkgewogICAgICAgIGNvbnN0IG1vcnBoQXR0cmlidXRlID0gbW9ycGhBdHRyaWJ1dGVzW2tleXNbMF1dOwogICAgICAgIGlmIChtb3JwaEF0dHJpYnV0ZSAhPT0gdm9pZCAwKSB7CiAgICAgICAgICB0aGlzLm1vcnBoVGFyZ2V0SW5mbHVlbmNlcyA9IFtdOwogICAgICAgICAgdGhpcy5tb3JwaFRhcmdldERpY3Rpb25hcnkgPSB7fTsKICAgICAgICAgIGZvciAobGV0IG0gPSAwLCBtbCA9IG1vcnBoQXR0cmlidXRlLmxlbmd0aDsgbSA8IG1sOyBtKyspIHsKICAgICAgICAgICAgY29uc3QgbmFtZSA9IG1vcnBoQXR0cmlidXRlW21dLm5hbWUgfHwgU3RyaW5nKG0pOwogICAgICAgICAgICB0aGlzLm1vcnBoVGFyZ2V0SW5mbHVlbmNlcy5wdXNoKDApOwogICAgICAgICAgICB0aGlzLm1vcnBoVGFyZ2V0RGljdGlvbmFyeVtuYW1lXSA9IG07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICBjb25zdCBtb3JwaFRhcmdldHMgPSBnZW9tZXRyeS5tb3JwaFRhcmdldHM7CiAgICAgIGlmIChtb3JwaFRhcmdldHMgIT09IHZvaWQgMCAmJiBtb3JwaFRhcmdldHMubGVuZ3RoID4gMCkgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLkxpbmUudXBkYXRlTW9ycGhUYXJnZXRzKCkgZG9lcyBub3Qgc3VwcG9ydCBUSFJFRS5HZW9tZXRyeS4gVXNlIFRIUkVFLkJ1ZmZlckdlb21ldHJ5IGluc3RlYWQuIik7CiAgICAgIH0KICAgIH0KICB9Cn0KTGluZS5wcm90b3R5cGUuaXNMaW5lID0gdHJ1ZTsKY29uc3QgX3N0YXJ0ID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF9lbmQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY2xhc3MgTGluZVNlZ21lbnRzIGV4dGVuZHMgTGluZSB7CiAgY29uc3RydWN0b3IoZ2VvbWV0cnksIG1hdGVyaWFsKSB7CiAgICBzdXBlcihnZW9tZXRyeSwgbWF0ZXJpYWwpOwogICAgdGhpcy50eXBlID0gIkxpbmVTZWdtZW50cyI7CiAgfQogIGNvbXB1dGVMaW5lRGlzdGFuY2VzKCkgewogICAgY29uc3QgZ2VvbWV0cnkgPSB0aGlzLmdlb21ldHJ5OwogICAgaWYgKGdlb21ldHJ5LmlzQnVmZmVyR2VvbWV0cnkpIHsKICAgICAgaWYgKGdlb21ldHJ5LmluZGV4ID09PSBudWxsKSB7CiAgICAgICAgY29uc3QgcG9zaXRpb25BdHRyaWJ1dGUgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uOwogICAgICAgIGNvbnN0IGxpbmVEaXN0YW5jZXMgPSBbXTsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHBvc2l0aW9uQXR0cmlidXRlLmNvdW50OyBpIDwgbDsgaSArPSAyKSB7CiAgICAgICAgICBfc3RhcnQuZnJvbUJ1ZmZlckF0dHJpYnV0ZShwb3NpdGlvbkF0dHJpYnV0ZSwgaSk7CiAgICAgICAgICBfZW5kLmZyb21CdWZmZXJBdHRyaWJ1dGUocG9zaXRpb25BdHRyaWJ1dGUsIGkgKyAxKTsKICAgICAgICAgIGxpbmVEaXN0YW5jZXNbaV0gPSBpID09PSAwID8gMCA6IGxpbmVEaXN0YW5jZXNbaSAtIDFdOwogICAgICAgICAgbGluZURpc3RhbmNlc1tpICsgMV0gPSBsaW5lRGlzdGFuY2VzW2ldICsgX3N0YXJ0LmRpc3RhbmNlVG8oX2VuZCk7CiAgICAgICAgfQogICAgICAgIGdlb21ldHJ5LnNldEF0dHJpYnV0ZSgibGluZURpc3RhbmNlIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUobGluZURpc3RhbmNlcywgMSkpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuTGluZVNlZ21lbnRzLmNvbXB1dGVMaW5lRGlzdGFuY2VzKCk6IENvbXB1dGF0aW9uIG9ubHkgcG9zc2libGUgd2l0aCBub24taW5kZXhlZCBCdWZmZXJHZW9tZXRyeS4iKTsKICAgICAgfQogICAgfSBlbHNlIGlmIChnZW9tZXRyeS5pc0dlb21ldHJ5KSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLkxpbmVTZWdtZW50cy5jb21wdXRlTGluZURpc3RhbmNlcygpIG5vIGxvbmdlciBzdXBwb3J0cyBUSFJFRS5HZW9tZXRyeS4gVXNlIFRIUkVFLkJ1ZmZlckdlb21ldHJ5IGluc3RlYWQuIik7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9Cn0KTGluZVNlZ21lbnRzLnByb3RvdHlwZS5pc0xpbmVTZWdtZW50cyA9IHRydWU7CmNsYXNzIExpbmVMb29wIGV4dGVuZHMgTGluZSB7CiAgY29uc3RydWN0b3IoZ2VvbWV0cnksIG1hdGVyaWFsKSB7CiAgICBzdXBlcihnZW9tZXRyeSwgbWF0ZXJpYWwpOwogICAgdGhpcy50eXBlID0gIkxpbmVMb29wIjsKICB9Cn0KTGluZUxvb3AucHJvdG90eXBlLmlzTGluZUxvb3AgPSB0cnVlOwpjbGFzcyBQb2ludHNNYXRlcmlhbCBleHRlbmRzIE1hdGVyaWFsIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIlBvaW50c01hdGVyaWFsIjsKICAgIHRoaXMuY29sb3IgPSBuZXcgQ29sb3IoMTY3NzcyMTUpOwogICAgdGhpcy5tYXAgPSBudWxsOwogICAgdGhpcy5hbHBoYU1hcCA9IG51bGw7CiAgICB0aGlzLnNpemUgPSAxOwogICAgdGhpcy5zaXplQXR0ZW51YXRpb24gPSB0cnVlOwogICAgdGhpcy5zZXRWYWx1ZXMocGFyYW1ldGVycyk7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLmNvbG9yLmNvcHkoc291cmNlLmNvbG9yKTsKICAgIHRoaXMubWFwID0gc291cmNlLm1hcDsKICAgIHRoaXMuYWxwaGFNYXAgPSBzb3VyY2UuYWxwaGFNYXA7CiAgICB0aGlzLnNpemUgPSBzb3VyY2Uuc2l6ZTsKICAgIHRoaXMuc2l6ZUF0dGVudWF0aW9uID0gc291cmNlLnNpemVBdHRlbnVhdGlvbjsKICAgIHJldHVybiB0aGlzOwogIH0KfQpQb2ludHNNYXRlcmlhbC5wcm90b3R5cGUuaXNQb2ludHNNYXRlcmlhbCA9IHRydWU7CmNvbnN0IF9pbnZlcnNlTWF0cml4ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXRyaXg0KCk7CmNvbnN0IF9yYXkgPSAvKiBAX19QVVJFX18gKi8gbmV3IFJheSgpOwpjb25zdCBfc3BoZXJlID0gLyogQF9fUFVSRV9fICovIG5ldyBTcGhlcmUoKTsKY29uc3QgX3Bvc2l0aW9uJDIgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY2xhc3MgUG9pbnRzIGV4dGVuZHMgT2JqZWN0M0QgewogIGNvbnN0cnVjdG9yKGdlb21ldHJ5ID0gbmV3IEJ1ZmZlckdlb21ldHJ5KCksIG1hdGVyaWFsID0gbmV3IFBvaW50c01hdGVyaWFsKCkpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLnR5cGUgPSAiUG9pbnRzIjsKICAgIHRoaXMuZ2VvbWV0cnkgPSBnZW9tZXRyeTsKICAgIHRoaXMubWF0ZXJpYWwgPSBtYXRlcmlhbDsKICAgIHRoaXMudXBkYXRlTW9ycGhUYXJnZXRzKCk7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLm1hdGVyaWFsID0gc291cmNlLm1hdGVyaWFsOwogICAgdGhpcy5nZW9tZXRyeSA9IHNvdXJjZS5nZW9tZXRyeTsKICAgIHJldHVybiB0aGlzOwogIH0KICByYXljYXN0KHJheWNhc3RlciwgaW50ZXJzZWN0czIpIHsKICAgIGNvbnN0IGdlb21ldHJ5ID0gdGhpcy5nZW9tZXRyeTsKICAgIGNvbnN0IG1hdHJpeFdvcmxkID0gdGhpcy5tYXRyaXhXb3JsZDsKICAgIGNvbnN0IHRocmVzaG9sZCA9IHJheWNhc3Rlci5wYXJhbXMuUG9pbnRzLnRocmVzaG9sZDsKICAgIGNvbnN0IGRyYXdSYW5nZSA9IGdlb21ldHJ5LmRyYXdSYW5nZTsKICAgIGlmIChnZW9tZXRyeS5ib3VuZGluZ1NwaGVyZSA9PT0gbnVsbCkKICAgICAgZ2VvbWV0cnkuY29tcHV0ZUJvdW5kaW5nU3BoZXJlKCk7CiAgICBfc3BoZXJlLmNvcHkoZ2VvbWV0cnkuYm91bmRpbmdTcGhlcmUpOwogICAgX3NwaGVyZS5hcHBseU1hdHJpeDQobWF0cml4V29ybGQpOwogICAgX3NwaGVyZS5yYWRpdXMgKz0gdGhyZXNob2xkOwogICAgaWYgKHJheWNhc3Rlci5yYXkuaW50ZXJzZWN0c1NwaGVyZShfc3BoZXJlKSA9PT0gZmFsc2UpCiAgICAgIHJldHVybjsKICAgIF9pbnZlcnNlTWF0cml4LmNvcHkobWF0cml4V29ybGQpLmludmVydCgpOwogICAgX3JheS5jb3B5KHJheWNhc3Rlci5yYXkpLmFwcGx5TWF0cml4NChfaW52ZXJzZU1hdHJpeCk7CiAgICBjb25zdCBsb2NhbFRocmVzaG9sZCA9IHRocmVzaG9sZCAvICgodGhpcy5zY2FsZS54ICsgdGhpcy5zY2FsZS55ICsgdGhpcy5zY2FsZS56KSAvIDMpOwogICAgY29uc3QgbG9jYWxUaHJlc2hvbGRTcSA9IGxvY2FsVGhyZXNob2xkICogbG9jYWxUaHJlc2hvbGQ7CiAgICBpZiAoZ2VvbWV0cnkuaXNCdWZmZXJHZW9tZXRyeSkgewogICAgICBjb25zdCBpbmRleCA9IGdlb21ldHJ5LmluZGV4OwogICAgICBjb25zdCBhdHRyaWJ1dGVzID0gZ2VvbWV0cnkuYXR0cmlidXRlczsKICAgICAgY29uc3QgcG9zaXRpb25BdHRyaWJ1dGUgPSBhdHRyaWJ1dGVzLnBvc2l0aW9uOwogICAgICBpZiAoaW5kZXggIT09IG51bGwpIHsKICAgICAgICBjb25zdCBzdGFydCA9IE1hdGgubWF4KDAsIGRyYXdSYW5nZS5zdGFydCk7CiAgICAgICAgY29uc3QgZW5kID0gTWF0aC5taW4oaW5kZXguY291bnQsIGRyYXdSYW5nZS5zdGFydCArIGRyYXdSYW5nZS5jb3VudCk7CiAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0LCBpbCA9IGVuZDsgaSA8IGlsOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGEgPSBpbmRleC5nZXRYKGkpOwogICAgICAgICAgX3Bvc2l0aW9uJDIuZnJvbUJ1ZmZlckF0dHJpYnV0ZShwb3NpdGlvbkF0dHJpYnV0ZSwgYSk7CiAgICAgICAgICB0ZXN0UG9pbnQoX3Bvc2l0aW9uJDIsIGEsIGxvY2FsVGhyZXNob2xkU3EsIG1hdHJpeFdvcmxkLCByYXljYXN0ZXIsIGludGVyc2VjdHMyLCB0aGlzKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3Qgc3RhcnQgPSBNYXRoLm1heCgwLCBkcmF3UmFuZ2Uuc3RhcnQpOwogICAgICAgIGNvbnN0IGVuZCA9IE1hdGgubWluKHBvc2l0aW9uQXR0cmlidXRlLmNvdW50LCBkcmF3UmFuZ2Uuc3RhcnQgKyBkcmF3UmFuZ2UuY291bnQpOwogICAgICAgIGZvciAobGV0IGkgPSBzdGFydCwgbCA9IGVuZDsgaSA8IGw7IGkrKykgewogICAgICAgICAgX3Bvc2l0aW9uJDIuZnJvbUJ1ZmZlckF0dHJpYnV0ZShwb3NpdGlvbkF0dHJpYnV0ZSwgaSk7CiAgICAgICAgICB0ZXN0UG9pbnQoX3Bvc2l0aW9uJDIsIGksIGxvY2FsVGhyZXNob2xkU3EsIG1hdHJpeFdvcmxkLCByYXljYXN0ZXIsIGludGVyc2VjdHMyLCB0aGlzKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLlBvaW50cy5yYXljYXN0KCkgbm8gbG9uZ2VyIHN1cHBvcnRzIFRIUkVFLkdlb21ldHJ5LiBVc2UgVEhSRUUuQnVmZmVyR2VvbWV0cnkgaW5zdGVhZC4iKTsKICAgIH0KICB9CiAgdXBkYXRlTW9ycGhUYXJnZXRzKCkgewogICAgY29uc3QgZ2VvbWV0cnkgPSB0aGlzLmdlb21ldHJ5OwogICAgaWYgKGdlb21ldHJ5LmlzQnVmZmVyR2VvbWV0cnkpIHsKICAgICAgY29uc3QgbW9ycGhBdHRyaWJ1dGVzID0gZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzOwogICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMobW9ycGhBdHRyaWJ1dGVzKTsKICAgICAgaWYgKGtleXMubGVuZ3RoID4gMCkgewogICAgICAgIGNvbnN0IG1vcnBoQXR0cmlidXRlID0gbW9ycGhBdHRyaWJ1dGVzW2tleXNbMF1dOwogICAgICAgIGlmIChtb3JwaEF0dHJpYnV0ZSAhPT0gdm9pZCAwKSB7CiAgICAgICAgICB0aGlzLm1vcnBoVGFyZ2V0SW5mbHVlbmNlcyA9IFtdOwogICAgICAgICAgdGhpcy5tb3JwaFRhcmdldERpY3Rpb25hcnkgPSB7fTsKICAgICAgICAgIGZvciAobGV0IG0gPSAwLCBtbCA9IG1vcnBoQXR0cmlidXRlLmxlbmd0aDsgbSA8IG1sOyBtKyspIHsKICAgICAgICAgICAgY29uc3QgbmFtZSA9IG1vcnBoQXR0cmlidXRlW21dLm5hbWUgfHwgU3RyaW5nKG0pOwogICAgICAgICAgICB0aGlzLm1vcnBoVGFyZ2V0SW5mbHVlbmNlcy5wdXNoKDApOwogICAgICAgICAgICB0aGlzLm1vcnBoVGFyZ2V0RGljdGlvbmFyeVtuYW1lXSA9IG07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICBjb25zdCBtb3JwaFRhcmdldHMgPSBnZW9tZXRyeS5tb3JwaFRhcmdldHM7CiAgICAgIGlmIChtb3JwaFRhcmdldHMgIT09IHZvaWQgMCAmJiBtb3JwaFRhcmdldHMubGVuZ3RoID4gMCkgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLlBvaW50cy51cGRhdGVNb3JwaFRhcmdldHMoKSBkb2VzIG5vdCBzdXBwb3J0IFRIUkVFLkdlb21ldHJ5LiBVc2UgVEhSRUUuQnVmZmVyR2VvbWV0cnkgaW5zdGVhZC4iKTsKICAgICAgfQogICAgfQogIH0KfQpQb2ludHMucHJvdG90eXBlLmlzUG9pbnRzID0gdHJ1ZTsKZnVuY3Rpb24gdGVzdFBvaW50KHBvaW50LCBpbmRleCwgbG9jYWxUaHJlc2hvbGRTcSwgbWF0cml4V29ybGQsIHJheWNhc3RlciwgaW50ZXJzZWN0czIsIG9iamVjdCkgewogIGNvbnN0IHJheVBvaW50RGlzdGFuY2VTcSA9IF9yYXkuZGlzdGFuY2VTcVRvUG9pbnQocG9pbnQpOwogIGlmIChyYXlQb2ludERpc3RhbmNlU3EgPCBsb2NhbFRocmVzaG9sZFNxKSB7CiAgICBjb25zdCBpbnRlcnNlY3RQb2ludCA9IG5ldyBWZWN0b3IzKCk7CiAgICBfcmF5LmNsb3Nlc3RQb2ludFRvUG9pbnQocG9pbnQsIGludGVyc2VjdFBvaW50KTsKICAgIGludGVyc2VjdFBvaW50LmFwcGx5TWF0cml4NChtYXRyaXhXb3JsZCk7CiAgICBjb25zdCBkaXN0YW5jZSA9IHJheWNhc3Rlci5yYXkub3JpZ2luLmRpc3RhbmNlVG8oaW50ZXJzZWN0UG9pbnQpOwogICAgaWYgKGRpc3RhbmNlIDwgcmF5Y2FzdGVyLm5lYXIgfHwgZGlzdGFuY2UgPiByYXljYXN0ZXIuZmFyKQogICAgICByZXR1cm47CiAgICBpbnRlcnNlY3RzMi5wdXNoKHsKICAgICAgZGlzdGFuY2UsCiAgICAgIGRpc3RhbmNlVG9SYXk6IE1hdGguc3FydChyYXlQb2ludERpc3RhbmNlU3EpLAogICAgICBwb2ludDogaW50ZXJzZWN0UG9pbnQsCiAgICAgIGluZGV4LAogICAgICBmYWNlOiBudWxsLAogICAgICBvYmplY3QKICAgIH0pOwogIH0KfQpjbGFzcyBWaWRlb1RleHR1cmUgZXh0ZW5kcyBUZXh0dXJlIHsKICBjb25zdHJ1Y3Rvcih2aWRlbywgbWFwcGluZywgd3JhcFMsIHdyYXBULCBtYWdGaWx0ZXIsIG1pbkZpbHRlciwgZm9ybWF0LCB0eXBlLCBhbmlzb3Ryb3B5KSB7CiAgICBzdXBlcih2aWRlbywgbWFwcGluZywgd3JhcFMsIHdyYXBULCBtYWdGaWx0ZXIsIG1pbkZpbHRlciwgZm9ybWF0LCB0eXBlLCBhbmlzb3Ryb3B5KTsKICAgIHRoaXMubWluRmlsdGVyID0gbWluRmlsdGVyICE9PSB2b2lkIDAgPyBtaW5GaWx0ZXIgOiBMaW5lYXJGaWx0ZXI7CiAgICB0aGlzLm1hZ0ZpbHRlciA9IG1hZ0ZpbHRlciAhPT0gdm9pZCAwID8gbWFnRmlsdGVyIDogTGluZWFyRmlsdGVyOwogICAgdGhpcy5nZW5lcmF0ZU1pcG1hcHMgPSBmYWxzZTsKICAgIGNvbnN0IHNjb3BlID0gdGhpczsKICAgIGZ1bmN0aW9uIHVwZGF0ZVZpZGVvKCkgewogICAgICBzY29wZS5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIHZpZGVvLnJlcXVlc3RWaWRlb0ZyYW1lQ2FsbGJhY2sodXBkYXRlVmlkZW8pOwogICAgfQogICAgaWYgKCJyZXF1ZXN0VmlkZW9GcmFtZUNhbGxiYWNrIiBpbiB2aWRlbykgewogICAgICB2aWRlby5yZXF1ZXN0VmlkZW9GcmFtZUNhbGxiYWNrKHVwZGF0ZVZpZGVvKTsKICAgIH0KICB9CiAgY2xvbmUoKSB7CiAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5pbWFnZSkuY29weSh0aGlzKTsKICB9CiAgdXBkYXRlKCkgewogICAgY29uc3QgdmlkZW8gPSB0aGlzLmltYWdlOwogICAgY29uc3QgaGFzVmlkZW9GcmFtZUNhbGxiYWNrID0gInJlcXVlc3RWaWRlb0ZyYW1lQ2FsbGJhY2siIGluIHZpZGVvOwogICAgaWYgKGhhc1ZpZGVvRnJhbWVDYWxsYmFjayA9PT0gZmFsc2UgJiYgdmlkZW8ucmVhZHlTdGF0ZSA+PSB2aWRlby5IQVZFX0NVUlJFTlRfREFUQSkgewogICAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgIH0KICB9Cn0KVmlkZW9UZXh0dXJlLnByb3RvdHlwZS5pc1ZpZGVvVGV4dHVyZSA9IHRydWU7CmNsYXNzIEZyYW1lYnVmZmVyVGV4dHVyZSBleHRlbmRzIFRleHR1cmUgewogIGNvbnN0cnVjdG9yKHdpZHRoLCBoZWlnaHQsIGZvcm1hdCkgewogICAgc3VwZXIoeyB3aWR0aCwgaGVpZ2h0IH0pOwogICAgdGhpcy5mb3JtYXQgPSBmb3JtYXQ7CiAgICB0aGlzLm1hZ0ZpbHRlciA9IE5lYXJlc3RGaWx0ZXI7CiAgICB0aGlzLm1pbkZpbHRlciA9IE5lYXJlc3RGaWx0ZXI7CiAgICB0aGlzLmdlbmVyYXRlTWlwbWFwcyA9IGZhbHNlOwogICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgfQp9CkZyYW1lYnVmZmVyVGV4dHVyZS5wcm90b3R5cGUuaXNGcmFtZWJ1ZmZlclRleHR1cmUgPSB0cnVlOwpjbGFzcyBDb21wcmVzc2VkVGV4dHVyZSBleHRlbmRzIFRleHR1cmUgewogIGNvbnN0cnVjdG9yKG1pcG1hcHMsIHdpZHRoLCBoZWlnaHQsIGZvcm1hdCwgdHlwZSwgbWFwcGluZywgd3JhcFMsIHdyYXBULCBtYWdGaWx0ZXIsIG1pbkZpbHRlciwgYW5pc290cm9weSwgZW5jb2RpbmcpIHsKICAgIHN1cGVyKG51bGwsIG1hcHBpbmcsIHdyYXBTLCB3cmFwVCwgbWFnRmlsdGVyLCBtaW5GaWx0ZXIsIGZvcm1hdCwgdHlwZSwgYW5pc290cm9weSwgZW5jb2RpbmcpOwogICAgdGhpcy5pbWFnZSA9IHsgd2lkdGgsIGhlaWdodCB9OwogICAgdGhpcy5taXBtYXBzID0gbWlwbWFwczsKICAgIHRoaXMuZmxpcFkgPSBmYWxzZTsKICAgIHRoaXMuZ2VuZXJhdGVNaXBtYXBzID0gZmFsc2U7CiAgfQp9CkNvbXByZXNzZWRUZXh0dXJlLnByb3RvdHlwZS5pc0NvbXByZXNzZWRUZXh0dXJlID0gdHJ1ZTsKY2xhc3MgQ2FudmFzVGV4dHVyZSBleHRlbmRzIFRleHR1cmUgewogIGNvbnN0cnVjdG9yKGNhbnZhcywgbWFwcGluZywgd3JhcFMsIHdyYXBULCBtYWdGaWx0ZXIsIG1pbkZpbHRlciwgZm9ybWF0LCB0eXBlLCBhbmlzb3Ryb3B5KSB7CiAgICBzdXBlcihjYW52YXMsIG1hcHBpbmcsIHdyYXBTLCB3cmFwVCwgbWFnRmlsdGVyLCBtaW5GaWx0ZXIsIGZvcm1hdCwgdHlwZSwgYW5pc290cm9weSk7CiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTsKICB9Cn0KQ2FudmFzVGV4dHVyZS5wcm90b3R5cGUuaXNDYW52YXNUZXh0dXJlID0gdHJ1ZTsKY2xhc3MgQ2lyY2xlR2VvbWV0cnkgZXh0ZW5kcyBCdWZmZXJHZW9tZXRyeSB7CiAgY29uc3RydWN0b3IocmFkaXVzID0gMSwgc2VnbWVudHMgPSA4LCB0aGV0YVN0YXJ0ID0gMCwgdGhldGFMZW5ndGggPSBNYXRoLlBJICogMikgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJDaXJjbGVHZW9tZXRyeSI7CiAgICB0aGlzLnBhcmFtZXRlcnMgPSB7CiAgICAgIHJhZGl1cywKICAgICAgc2VnbWVudHMsCiAgICAgIHRoZXRhU3RhcnQsCiAgICAgIHRoZXRhTGVuZ3RoCiAgICB9OwogICAgc2VnbWVudHMgPSBNYXRoLm1heCgzLCBzZWdtZW50cyk7CiAgICBjb25zdCBpbmRpY2VzID0gW107CiAgICBjb25zdCB2ZXJ0aWNlcyA9IFtdOwogICAgY29uc3Qgbm9ybWFscyA9IFtdOwogICAgY29uc3QgdXZzID0gW107CiAgICBjb25zdCB2ZXJ0ZXgyID0gbmV3IFZlY3RvcjMoKTsKICAgIGNvbnN0IHV2ID0gbmV3IFZlY3RvcjIoKTsKICAgIHZlcnRpY2VzLnB1c2goMCwgMCwgMCk7CiAgICBub3JtYWxzLnB1c2goMCwgMCwgMSk7CiAgICB1dnMucHVzaCgwLjUsIDAuNSk7CiAgICBmb3IgKGxldCBzID0gMCwgaSA9IDM7IHMgPD0gc2VnbWVudHM7IHMrKywgaSArPSAzKSB7CiAgICAgIGNvbnN0IHNlZ21lbnQgPSB0aGV0YVN0YXJ0ICsgcyAvIHNlZ21lbnRzICogdGhldGFMZW5ndGg7CiAgICAgIHZlcnRleDIueCA9IHJhZGl1cyAqIE1hdGguY29zKHNlZ21lbnQpOwogICAgICB2ZXJ0ZXgyLnkgPSByYWRpdXMgKiBNYXRoLnNpbihzZWdtZW50KTsKICAgICAgdmVydGljZXMucHVzaCh2ZXJ0ZXgyLngsIHZlcnRleDIueSwgdmVydGV4Mi56KTsKICAgICAgbm9ybWFscy5wdXNoKDAsIDAsIDEpOwogICAgICB1di54ID0gKHZlcnRpY2VzW2ldIC8gcmFkaXVzICsgMSkgLyAyOwogICAgICB1di55ID0gKHZlcnRpY2VzW2kgKyAxXSAvIHJhZGl1cyArIDEpIC8gMjsKICAgICAgdXZzLnB1c2godXYueCwgdXYueSk7CiAgICB9CiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBzZWdtZW50czsgaSsrKSB7CiAgICAgIGluZGljZXMucHVzaChpLCBpICsgMSwgMCk7CiAgICB9CiAgICB0aGlzLnNldEluZGV4KGluZGljZXMpOwogICAgdGhpcy5zZXRBdHRyaWJ1dGUoInBvc2l0aW9uIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUodmVydGljZXMsIDMpKTsKICAgIHRoaXMuc2V0QXR0cmlidXRlKCJub3JtYWwiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShub3JtYWxzLCAzKSk7CiAgICB0aGlzLnNldEF0dHJpYnV0ZSgidXYiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh1dnMsIDIpKTsKICB9CiAgc3RhdGljIGZyb21KU09OKGRhdGEpIHsKICAgIHJldHVybiBuZXcgQ2lyY2xlR2VvbWV0cnkoZGF0YS5yYWRpdXMsIGRhdGEuc2VnbWVudHMsIGRhdGEudGhldGFTdGFydCwgZGF0YS50aGV0YUxlbmd0aCk7CiAgfQp9CmNsYXNzIEN5bGluZGVyR2VvbWV0cnkgZXh0ZW5kcyBCdWZmZXJHZW9tZXRyeSB7CiAgY29uc3RydWN0b3IocmFkaXVzVG9wID0gMSwgcmFkaXVzQm90dG9tID0gMSwgaGVpZ2h0ID0gMSwgcmFkaWFsU2VnbWVudHMgPSA4LCBoZWlnaHRTZWdtZW50cyA9IDEsIG9wZW5FbmRlZCA9IGZhbHNlLCB0aGV0YVN0YXJ0ID0gMCwgdGhldGFMZW5ndGggPSBNYXRoLlBJICogMikgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJDeWxpbmRlckdlb21ldHJ5IjsKICAgIHRoaXMucGFyYW1ldGVycyA9IHsKICAgICAgcmFkaXVzVG9wLAogICAgICByYWRpdXNCb3R0b20sCiAgICAgIGhlaWdodCwKICAgICAgcmFkaWFsU2VnbWVudHMsCiAgICAgIGhlaWdodFNlZ21lbnRzLAogICAgICBvcGVuRW5kZWQsCiAgICAgIHRoZXRhU3RhcnQsCiAgICAgIHRoZXRhTGVuZ3RoCiAgICB9OwogICAgY29uc3Qgc2NvcGUgPSB0aGlzOwogICAgcmFkaWFsU2VnbWVudHMgPSBNYXRoLmZsb29yKHJhZGlhbFNlZ21lbnRzKTsKICAgIGhlaWdodFNlZ21lbnRzID0gTWF0aC5mbG9vcihoZWlnaHRTZWdtZW50cyk7CiAgICBjb25zdCBpbmRpY2VzID0gW107CiAgICBjb25zdCB2ZXJ0aWNlcyA9IFtdOwogICAgY29uc3Qgbm9ybWFscyA9IFtdOwogICAgY29uc3QgdXZzID0gW107CiAgICBsZXQgaW5kZXggPSAwOwogICAgY29uc3QgaW5kZXhBcnJheSA9IFtdOwogICAgY29uc3QgaGFsZkhlaWdodCA9IGhlaWdodCAvIDI7CiAgICBsZXQgZ3JvdXBTdGFydCA9IDA7CiAgICBnZW5lcmF0ZVRvcnNvKCk7CiAgICBpZiAob3BlbkVuZGVkID09PSBmYWxzZSkgewogICAgICBpZiAocmFkaXVzVG9wID4gMCkKICAgICAgICBnZW5lcmF0ZUNhcCh0cnVlKTsKICAgICAgaWYgKHJhZGl1c0JvdHRvbSA+IDApCiAgICAgICAgZ2VuZXJhdGVDYXAoZmFsc2UpOwogICAgfQogICAgdGhpcy5zZXRJbmRleChpbmRpY2VzKTsKICAgIHRoaXMuc2V0QXR0cmlidXRlKCJwb3NpdGlvbiIsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKHZlcnRpY2VzLCAzKSk7CiAgICB0aGlzLnNldEF0dHJpYnV0ZSgibm9ybWFsIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUobm9ybWFscywgMykpOwogICAgdGhpcy5zZXRBdHRyaWJ1dGUoInV2IiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUodXZzLCAyKSk7CiAgICBmdW5jdGlvbiBnZW5lcmF0ZVRvcnNvKCkgewogICAgICBjb25zdCBub3JtYWwgPSBuZXcgVmVjdG9yMygpOwogICAgICBjb25zdCB2ZXJ0ZXgyID0gbmV3IFZlY3RvcjMoKTsKICAgICAgbGV0IGdyb3VwQ291bnQgPSAwOwogICAgICBjb25zdCBzbG9wZSA9IChyYWRpdXNCb3R0b20gLSByYWRpdXNUb3ApIC8gaGVpZ2h0OwogICAgICBmb3IgKGxldCB5ID0gMDsgeSA8PSBoZWlnaHRTZWdtZW50czsgeSsrKSB7CiAgICAgICAgY29uc3QgaW5kZXhSb3cgPSBbXTsKICAgICAgICBjb25zdCB2ID0geSAvIGhlaWdodFNlZ21lbnRzOwogICAgICAgIGNvbnN0IHJhZGl1cyA9IHYgKiAocmFkaXVzQm90dG9tIC0gcmFkaXVzVG9wKSArIHJhZGl1c1RvcDsKICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8PSByYWRpYWxTZWdtZW50czsgeCsrKSB7CiAgICAgICAgICBjb25zdCB1ID0geCAvIHJhZGlhbFNlZ21lbnRzOwogICAgICAgICAgY29uc3QgdGhldGEgPSB1ICogdGhldGFMZW5ndGggKyB0aGV0YVN0YXJ0OwogICAgICAgICAgY29uc3Qgc2luVGhldGEgPSBNYXRoLnNpbih0aGV0YSk7CiAgICAgICAgICBjb25zdCBjb3NUaGV0YSA9IE1hdGguY29zKHRoZXRhKTsKICAgICAgICAgIHZlcnRleDIueCA9IHJhZGl1cyAqIHNpblRoZXRhOwogICAgICAgICAgdmVydGV4Mi55ID0gLXYgKiBoZWlnaHQgKyBoYWxmSGVpZ2h0OwogICAgICAgICAgdmVydGV4Mi56ID0gcmFkaXVzICogY29zVGhldGE7CiAgICAgICAgICB2ZXJ0aWNlcy5wdXNoKHZlcnRleDIueCwgdmVydGV4Mi55LCB2ZXJ0ZXgyLnopOwogICAgICAgICAgbm9ybWFsLnNldChzaW5UaGV0YSwgc2xvcGUsIGNvc1RoZXRhKS5ub3JtYWxpemUoKTsKICAgICAgICAgIG5vcm1hbHMucHVzaChub3JtYWwueCwgbm9ybWFsLnksIG5vcm1hbC56KTsKICAgICAgICAgIHV2cy5wdXNoKHUsIDEgLSB2KTsKICAgICAgICAgIGluZGV4Um93LnB1c2goaW5kZXgrKyk7CiAgICAgICAgfQogICAgICAgIGluZGV4QXJyYXkucHVzaChpbmRleFJvdyk7CiAgICAgIH0KICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCByYWRpYWxTZWdtZW50czsgeCsrKSB7CiAgICAgICAgZm9yIChsZXQgeSA9IDA7IHkgPCBoZWlnaHRTZWdtZW50czsgeSsrKSB7CiAgICAgICAgICBjb25zdCBhID0gaW5kZXhBcnJheVt5XVt4XTsKICAgICAgICAgIGNvbnN0IGIgPSBpbmRleEFycmF5W3kgKyAxXVt4XTsKICAgICAgICAgIGNvbnN0IGMgPSBpbmRleEFycmF5W3kgKyAxXVt4ICsgMV07CiAgICAgICAgICBjb25zdCBkID0gaW5kZXhBcnJheVt5XVt4ICsgMV07CiAgICAgICAgICBpbmRpY2VzLnB1c2goYSwgYiwgZCk7CiAgICAgICAgICBpbmRpY2VzLnB1c2goYiwgYywgZCk7CiAgICAgICAgICBncm91cENvdW50ICs9IDY7CiAgICAgICAgfQogICAgICB9CiAgICAgIHNjb3BlLmFkZEdyb3VwKGdyb3VwU3RhcnQsIGdyb3VwQ291bnQsIDApOwogICAgICBncm91cFN0YXJ0ICs9IGdyb3VwQ291bnQ7CiAgICB9CiAgICBmdW5jdGlvbiBnZW5lcmF0ZUNhcCh0b3ApIHsKICAgICAgY29uc3QgY2VudGVySW5kZXhTdGFydCA9IGluZGV4OwogICAgICBjb25zdCB1diA9IG5ldyBWZWN0b3IyKCk7CiAgICAgIGNvbnN0IHZlcnRleDIgPSBuZXcgVmVjdG9yMygpOwogICAgICBsZXQgZ3JvdXBDb3VudCA9IDA7CiAgICAgIGNvbnN0IHJhZGl1cyA9IHRvcCA9PT0gdHJ1ZSA/IHJhZGl1c1RvcCA6IHJhZGl1c0JvdHRvbTsKICAgICAgY29uc3Qgc2lnbjIgPSB0b3AgPT09IHRydWUgPyAxIDogLTE7CiAgICAgIGZvciAobGV0IHggPSAxOyB4IDw9IHJhZGlhbFNlZ21lbnRzOyB4KyspIHsKICAgICAgICB2ZXJ0aWNlcy5wdXNoKDAsIGhhbGZIZWlnaHQgKiBzaWduMiwgMCk7CiAgICAgICAgbm9ybWFscy5wdXNoKDAsIHNpZ24yLCAwKTsKICAgICAgICB1dnMucHVzaCgwLjUsIDAuNSk7CiAgICAgICAgaW5kZXgrKzsKICAgICAgfQogICAgICBjb25zdCBjZW50ZXJJbmRleEVuZCA9IGluZGV4OwogICAgICBmb3IgKGxldCB4ID0gMDsgeCA8PSByYWRpYWxTZWdtZW50czsgeCsrKSB7CiAgICAgICAgY29uc3QgdSA9IHggLyByYWRpYWxTZWdtZW50czsKICAgICAgICBjb25zdCB0aGV0YSA9IHUgKiB0aGV0YUxlbmd0aCArIHRoZXRhU3RhcnQ7CiAgICAgICAgY29uc3QgY29zVGhldGEgPSBNYXRoLmNvcyh0aGV0YSk7CiAgICAgICAgY29uc3Qgc2luVGhldGEgPSBNYXRoLnNpbih0aGV0YSk7CiAgICAgICAgdmVydGV4Mi54ID0gcmFkaXVzICogc2luVGhldGE7CiAgICAgICAgdmVydGV4Mi55ID0gaGFsZkhlaWdodCAqIHNpZ24yOwogICAgICAgIHZlcnRleDIueiA9IHJhZGl1cyAqIGNvc1RoZXRhOwogICAgICAgIHZlcnRpY2VzLnB1c2godmVydGV4Mi54LCB2ZXJ0ZXgyLnksIHZlcnRleDIueik7CiAgICAgICAgbm9ybWFscy5wdXNoKDAsIHNpZ24yLCAwKTsKICAgICAgICB1di54ID0gY29zVGhldGEgKiAwLjUgKyAwLjU7CiAgICAgICAgdXYueSA9IHNpblRoZXRhICogMC41ICogc2lnbjIgKyAwLjU7CiAgICAgICAgdXZzLnB1c2godXYueCwgdXYueSk7CiAgICAgICAgaW5kZXgrKzsKICAgICAgfQogICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHJhZGlhbFNlZ21lbnRzOyB4KyspIHsKICAgICAgICBjb25zdCBjID0gY2VudGVySW5kZXhTdGFydCArIHg7CiAgICAgICAgY29uc3QgaSA9IGNlbnRlckluZGV4RW5kICsgeDsKICAgICAgICBpZiAodG9wID09PSB0cnVlKSB7CiAgICAgICAgICBpbmRpY2VzLnB1c2goaSwgaSArIDEsIGMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpbmRpY2VzLnB1c2goaSArIDEsIGksIGMpOwogICAgICAgIH0KICAgICAgICBncm91cENvdW50ICs9IDM7CiAgICAgIH0KICAgICAgc2NvcGUuYWRkR3JvdXAoZ3JvdXBTdGFydCwgZ3JvdXBDb3VudCwgdG9wID09PSB0cnVlID8gMSA6IDIpOwogICAgICBncm91cFN0YXJ0ICs9IGdyb3VwQ291bnQ7CiAgICB9CiAgfQogIHN0YXRpYyBmcm9tSlNPTihkYXRhKSB7CiAgICByZXR1cm4gbmV3IEN5bGluZGVyR2VvbWV0cnkoZGF0YS5yYWRpdXNUb3AsIGRhdGEucmFkaXVzQm90dG9tLCBkYXRhLmhlaWdodCwgZGF0YS5yYWRpYWxTZWdtZW50cywgZGF0YS5oZWlnaHRTZWdtZW50cywgZGF0YS5vcGVuRW5kZWQsIGRhdGEudGhldGFTdGFydCwgZGF0YS50aGV0YUxlbmd0aCk7CiAgfQp9CmNsYXNzIENvbmVHZW9tZXRyeSBleHRlbmRzIEN5bGluZGVyR2VvbWV0cnkgewogIGNvbnN0cnVjdG9yKHJhZGl1cyA9IDEsIGhlaWdodCA9IDEsIHJhZGlhbFNlZ21lbnRzID0gOCwgaGVpZ2h0U2VnbWVudHMgPSAxLCBvcGVuRW5kZWQgPSBmYWxzZSwgdGhldGFTdGFydCA9IDAsIHRoZXRhTGVuZ3RoID0gTWF0aC5QSSAqIDIpIHsKICAgIHN1cGVyKDAsIHJhZGl1cywgaGVpZ2h0LCByYWRpYWxTZWdtZW50cywgaGVpZ2h0U2VnbWVudHMsIG9wZW5FbmRlZCwgdGhldGFTdGFydCwgdGhldGFMZW5ndGgpOwogICAgdGhpcy50eXBlID0gIkNvbmVHZW9tZXRyeSI7CiAgICB0aGlzLnBhcmFtZXRlcnMgPSB7CiAgICAgIHJhZGl1cywKICAgICAgaGVpZ2h0LAogICAgICByYWRpYWxTZWdtZW50cywKICAgICAgaGVpZ2h0U2VnbWVudHMsCiAgICAgIG9wZW5FbmRlZCwKICAgICAgdGhldGFTdGFydCwKICAgICAgdGhldGFMZW5ndGgKICAgIH07CiAgfQogIHN0YXRpYyBmcm9tSlNPTihkYXRhKSB7CiAgICByZXR1cm4gbmV3IENvbmVHZW9tZXRyeShkYXRhLnJhZGl1cywgZGF0YS5oZWlnaHQsIGRhdGEucmFkaWFsU2VnbWVudHMsIGRhdGEuaGVpZ2h0U2VnbWVudHMsIGRhdGEub3BlbkVuZGVkLCBkYXRhLnRoZXRhU3RhcnQsIGRhdGEudGhldGFMZW5ndGgpOwogIH0KfQpjbGFzcyBQb2x5aGVkcm9uR2VvbWV0cnkgZXh0ZW5kcyBCdWZmZXJHZW9tZXRyeSB7CiAgY29uc3RydWN0b3IodmVydGljZXMgPSBbXSwgaW5kaWNlcyA9IFtdLCByYWRpdXMgPSAxLCBkZXRhaWwgPSAwKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIlBvbHloZWRyb25HZW9tZXRyeSI7CiAgICB0aGlzLnBhcmFtZXRlcnMgPSB7CiAgICAgIHZlcnRpY2VzLAogICAgICBpbmRpY2VzLAogICAgICByYWRpdXMsCiAgICAgIGRldGFpbAogICAgfTsKICAgIGNvbnN0IHZlcnRleEJ1ZmZlciA9IFtdOwogICAgY29uc3QgdXZCdWZmZXIgPSBbXTsKICAgIHN1YmRpdmlkZShkZXRhaWwpOwogICAgYXBwbHlSYWRpdXMocmFkaXVzKTsKICAgIGdlbmVyYXRlVVZzKCk7CiAgICB0aGlzLnNldEF0dHJpYnV0ZSgicG9zaXRpb24iLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh2ZXJ0ZXhCdWZmZXIsIDMpKTsKICAgIHRoaXMuc2V0QXR0cmlidXRlKCJub3JtYWwiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh2ZXJ0ZXhCdWZmZXIuc2xpY2UoKSwgMykpOwogICAgdGhpcy5zZXRBdHRyaWJ1dGUoInV2IiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUodXZCdWZmZXIsIDIpKTsKICAgIGlmIChkZXRhaWwgPT09IDApIHsKICAgICAgdGhpcy5jb21wdXRlVmVydGV4Tm9ybWFscygpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5ub3JtYWxpemVOb3JtYWxzKCk7CiAgICB9CiAgICBmdW5jdGlvbiBzdWJkaXZpZGUoZGV0YWlsMikgewogICAgICBjb25zdCBhID0gbmV3IFZlY3RvcjMoKTsKICAgICAgY29uc3QgYiA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIGNvbnN0IGMgPSBuZXcgVmVjdG9yMygpOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGluZGljZXMubGVuZ3RoOyBpICs9IDMpIHsKICAgICAgICBnZXRWZXJ0ZXhCeUluZGV4KGluZGljZXNbaSArIDBdLCBhKTsKICAgICAgICBnZXRWZXJ0ZXhCeUluZGV4KGluZGljZXNbaSArIDFdLCBiKTsKICAgICAgICBnZXRWZXJ0ZXhCeUluZGV4KGluZGljZXNbaSArIDJdLCBjKTsKICAgICAgICBzdWJkaXZpZGVGYWNlKGEsIGIsIGMsIGRldGFpbDIpOwogICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBzdWJkaXZpZGVGYWNlKGEsIGIsIGMsIGRldGFpbDIpIHsKICAgICAgY29uc3QgY29scyA9IGRldGFpbDIgKyAxOwogICAgICBjb25zdCB2ID0gW107CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IGNvbHM7IGkrKykgewogICAgICAgIHZbaV0gPSBbXTsKICAgICAgICBjb25zdCBhaiA9IGEuY2xvbmUoKS5sZXJwKGMsIGkgLyBjb2xzKTsKICAgICAgICBjb25zdCBiaiA9IGIuY2xvbmUoKS5sZXJwKGMsIGkgLyBjb2xzKTsKICAgICAgICBjb25zdCByb3dzID0gY29scyAtIGk7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPD0gcm93czsgaisrKSB7CiAgICAgICAgICBpZiAoaiA9PT0gMCAmJiBpID09PSBjb2xzKSB7CiAgICAgICAgICAgIHZbaV1bal0gPSBhajsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZbaV1bal0gPSBhai5jbG9uZSgpLmxlcnAoYmosIGogLyByb3dzKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb2xzOyBpKyspIHsKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDIgKiAoY29scyAtIGkpIC0gMTsgaisrKSB7CiAgICAgICAgICBjb25zdCBrID0gTWF0aC5mbG9vcihqIC8gMik7CiAgICAgICAgICBpZiAoaiAlIDIgPT09IDApIHsKICAgICAgICAgICAgcHVzaFZlcnRleCh2W2ldW2sgKyAxXSk7CiAgICAgICAgICAgIHB1c2hWZXJ0ZXgodltpICsgMV1ba10pOwogICAgICAgICAgICBwdXNoVmVydGV4KHZbaV1ba10pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcHVzaFZlcnRleCh2W2ldW2sgKyAxXSk7CiAgICAgICAgICAgIHB1c2hWZXJ0ZXgodltpICsgMV1bayArIDFdKTsKICAgICAgICAgICAgcHVzaFZlcnRleCh2W2kgKyAxXVtrXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBhcHBseVJhZGl1cyhyYWRpdXMyKSB7CiAgICAgIGNvbnN0IHZlcnRleDIgPSBuZXcgVmVjdG9yMygpOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZlcnRleEJ1ZmZlci5sZW5ndGg7IGkgKz0gMykgewogICAgICAgIHZlcnRleDIueCA9IHZlcnRleEJ1ZmZlcltpICsgMF07CiAgICAgICAgdmVydGV4Mi55ID0gdmVydGV4QnVmZmVyW2kgKyAxXTsKICAgICAgICB2ZXJ0ZXgyLnogPSB2ZXJ0ZXhCdWZmZXJbaSArIDJdOwogICAgICAgIHZlcnRleDIubm9ybWFsaXplKCkubXVsdGlwbHlTY2FsYXIocmFkaXVzMik7CiAgICAgICAgdmVydGV4QnVmZmVyW2kgKyAwXSA9IHZlcnRleDIueDsKICAgICAgICB2ZXJ0ZXhCdWZmZXJbaSArIDFdID0gdmVydGV4Mi55OwogICAgICAgIHZlcnRleEJ1ZmZlcltpICsgMl0gPSB2ZXJ0ZXgyLno7CiAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIGdlbmVyYXRlVVZzKCkgewogICAgICBjb25zdCB2ZXJ0ZXgyID0gbmV3IFZlY3RvcjMoKTsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2ZXJ0ZXhCdWZmZXIubGVuZ3RoOyBpICs9IDMpIHsKICAgICAgICB2ZXJ0ZXgyLnggPSB2ZXJ0ZXhCdWZmZXJbaSArIDBdOwogICAgICAgIHZlcnRleDIueSA9IHZlcnRleEJ1ZmZlcltpICsgMV07CiAgICAgICAgdmVydGV4Mi56ID0gdmVydGV4QnVmZmVyW2kgKyAyXTsKICAgICAgICBjb25zdCB1ID0gYXppbXV0aCh2ZXJ0ZXgyKSAvIDIgLyBNYXRoLlBJICsgMC41OwogICAgICAgIGNvbnN0IHYgPSBpbmNsaW5hdGlvbih2ZXJ0ZXgyKSAvIE1hdGguUEkgKyAwLjU7CiAgICAgICAgdXZCdWZmZXIucHVzaCh1LCAxIC0gdik7CiAgICAgIH0KICAgICAgY29ycmVjdFVWcygpOwogICAgICBjb3JyZWN0U2VhbSgpOwogICAgfQogICAgZnVuY3Rpb24gY29ycmVjdFNlYW0oKSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXZCdWZmZXIubGVuZ3RoOyBpICs9IDYpIHsKICAgICAgICBjb25zdCB4MCA9IHV2QnVmZmVyW2kgKyAwXTsKICAgICAgICBjb25zdCB4MSA9IHV2QnVmZmVyW2kgKyAyXTsKICAgICAgICBjb25zdCB4MiA9IHV2QnVmZmVyW2kgKyA0XTsKICAgICAgICBjb25zdCBtYXggPSBNYXRoLm1heCh4MCwgeDEsIHgyKTsKICAgICAgICBjb25zdCBtaW4gPSBNYXRoLm1pbih4MCwgeDEsIHgyKTsKICAgICAgICBpZiAobWF4ID4gMC45ICYmIG1pbiA8IDAuMSkgewogICAgICAgICAgaWYgKHgwIDwgMC4yKQogICAgICAgICAgICB1dkJ1ZmZlcltpICsgMF0gKz0gMTsKICAgICAgICAgIGlmICh4MSA8IDAuMikKICAgICAgICAgICAgdXZCdWZmZXJbaSArIDJdICs9IDE7CiAgICAgICAgICBpZiAoeDIgPCAwLjIpCiAgICAgICAgICAgIHV2QnVmZmVyW2kgKyA0XSArPSAxOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgZnVuY3Rpb24gcHVzaFZlcnRleCh2ZXJ0ZXgyKSB7CiAgICAgIHZlcnRleEJ1ZmZlci5wdXNoKHZlcnRleDIueCwgdmVydGV4Mi55LCB2ZXJ0ZXgyLnopOwogICAgfQogICAgZnVuY3Rpb24gZ2V0VmVydGV4QnlJbmRleChpbmRleCwgdmVydGV4MikgewogICAgICBjb25zdCBzdHJpZGUgPSBpbmRleCAqIDM7CiAgICAgIHZlcnRleDIueCA9IHZlcnRpY2VzW3N0cmlkZSArIDBdOwogICAgICB2ZXJ0ZXgyLnkgPSB2ZXJ0aWNlc1tzdHJpZGUgKyAxXTsKICAgICAgdmVydGV4Mi56ID0gdmVydGljZXNbc3RyaWRlICsgMl07CiAgICB9CiAgICBmdW5jdGlvbiBjb3JyZWN0VVZzKCkgewogICAgICBjb25zdCBhID0gbmV3IFZlY3RvcjMoKTsKICAgICAgY29uc3QgYiA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIGNvbnN0IGMgPSBuZXcgVmVjdG9yMygpOwogICAgICBjb25zdCBjZW50cm9pZCA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIGNvbnN0IHV2QSA9IG5ldyBWZWN0b3IyKCk7CiAgICAgIGNvbnN0IHV2QiA9IG5ldyBWZWN0b3IyKCk7CiAgICAgIGNvbnN0IHV2QyA9IG5ldyBWZWN0b3IyKCk7CiAgICAgIGZvciAobGV0IGkgPSAwLCBqID0gMDsgaSA8IHZlcnRleEJ1ZmZlci5sZW5ndGg7IGkgKz0gOSwgaiArPSA2KSB7CiAgICAgICAgYS5zZXQodmVydGV4QnVmZmVyW2kgKyAwXSwgdmVydGV4QnVmZmVyW2kgKyAxXSwgdmVydGV4QnVmZmVyW2kgKyAyXSk7CiAgICAgICAgYi5zZXQodmVydGV4QnVmZmVyW2kgKyAzXSwgdmVydGV4QnVmZmVyW2kgKyA0XSwgdmVydGV4QnVmZmVyW2kgKyA1XSk7CiAgICAgICAgYy5zZXQodmVydGV4QnVmZmVyW2kgKyA2XSwgdmVydGV4QnVmZmVyW2kgKyA3XSwgdmVydGV4QnVmZmVyW2kgKyA4XSk7CiAgICAgICAgdXZBLnNldCh1dkJ1ZmZlcltqICsgMF0sIHV2QnVmZmVyW2ogKyAxXSk7CiAgICAgICAgdXZCLnNldCh1dkJ1ZmZlcltqICsgMl0sIHV2QnVmZmVyW2ogKyAzXSk7CiAgICAgICAgdXZDLnNldCh1dkJ1ZmZlcltqICsgNF0sIHV2QnVmZmVyW2ogKyA1XSk7CiAgICAgICAgY2VudHJvaWQuY29weShhKS5hZGQoYikuYWRkKGMpLmRpdmlkZVNjYWxhcigzKTsKICAgICAgICBjb25zdCBhemkgPSBhemltdXRoKGNlbnRyb2lkKTsKICAgICAgICBjb3JyZWN0VVYodXZBLCBqICsgMCwgYSwgYXppKTsKICAgICAgICBjb3JyZWN0VVYodXZCLCBqICsgMiwgYiwgYXppKTsKICAgICAgICBjb3JyZWN0VVYodXZDLCBqICsgNCwgYywgYXppKTsKICAgICAgfQogICAgfQogICAgZnVuY3Rpb24gY29ycmVjdFVWKHV2LCBzdHJpZGUsIHZlY3RvciwgYXppbXV0aDIpIHsKICAgICAgaWYgKGF6aW11dGgyIDwgMCAmJiB1di54ID09PSAxKSB7CiAgICAgICAgdXZCdWZmZXJbc3RyaWRlXSA9IHV2LnggLSAxOwogICAgICB9CiAgICAgIGlmICh2ZWN0b3IueCA9PT0gMCAmJiB2ZWN0b3IueiA9PT0gMCkgewogICAgICAgIHV2QnVmZmVyW3N0cmlkZV0gPSBhemltdXRoMiAvIDIgLyBNYXRoLlBJICsgMC41OwogICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBhemltdXRoKHZlY3RvcikgewogICAgICByZXR1cm4gTWF0aC5hdGFuMih2ZWN0b3IueiwgLXZlY3Rvci54KTsKICAgIH0KICAgIGZ1bmN0aW9uIGluY2xpbmF0aW9uKHZlY3RvcikgewogICAgICByZXR1cm4gTWF0aC5hdGFuMigtdmVjdG9yLnksIE1hdGguc3FydCh2ZWN0b3IueCAqIHZlY3Rvci54ICsgdmVjdG9yLnogKiB2ZWN0b3IueikpOwogICAgfQogIH0KICBzdGF0aWMgZnJvbUpTT04oZGF0YSkgewogICAgcmV0dXJuIG5ldyBQb2x5aGVkcm9uR2VvbWV0cnkoZGF0YS52ZXJ0aWNlcywgZGF0YS5pbmRpY2VzLCBkYXRhLnJhZGl1cywgZGF0YS5kZXRhaWxzKTsKICB9Cn0KY2xhc3MgRG9kZWNhaGVkcm9uR2VvbWV0cnkgZXh0ZW5kcyBQb2x5aGVkcm9uR2VvbWV0cnkgewogIGNvbnN0cnVjdG9yKHJhZGl1cyA9IDEsIGRldGFpbCA9IDApIHsKICAgIGNvbnN0IHQgPSAoMSArIE1hdGguc3FydCg1KSkgLyAyOwogICAgY29uc3QgciA9IDEgLyB0OwogICAgY29uc3QgdmVydGljZXMgPSBbCiAgICAgIC0xLAogICAgICAtMSwKICAgICAgLTEsCiAgICAgIC0xLAogICAgICAtMSwKICAgICAgMSwKICAgICAgLTEsCiAgICAgIDEsCiAgICAgIC0xLAogICAgICAtMSwKICAgICAgMSwKICAgICAgMSwKICAgICAgMSwKICAgICAgLTEsCiAgICAgIC0xLAogICAgICAxLAogICAgICAtMSwKICAgICAgMSwKICAgICAgMSwKICAgICAgMSwKICAgICAgLTEsCiAgICAgIDEsCiAgICAgIDEsCiAgICAgIDEsCiAgICAgIDAsCiAgICAgIC1yLAogICAgICAtdCwKICAgICAgMCwKICAgICAgLXIsCiAgICAgIHQsCiAgICAgIDAsCiAgICAgIHIsCiAgICAgIC10LAogICAgICAwLAogICAgICByLAogICAgICB0LAogICAgICAtciwKICAgICAgLXQsCiAgICAgIDAsCiAgICAgIC1yLAogICAgICB0LAogICAgICAwLAogICAgICByLAogICAgICAtdCwKICAgICAgMCwKICAgICAgciwKICAgICAgdCwKICAgICAgMCwKICAgICAgLXQsCiAgICAgIDAsCiAgICAgIC1yLAogICAgICB0LAogICAgICAwLAogICAgICAtciwKICAgICAgLXQsCiAgICAgIDAsCiAgICAgIHIsCiAgICAgIHQsCiAgICAgIDAsCiAgICAgIHIKICAgIF07CiAgICBjb25zdCBpbmRpY2VzID0gWwogICAgICAzLAogICAgICAxMSwKICAgICAgNywKICAgICAgMywKICAgICAgNywKICAgICAgMTUsCiAgICAgIDMsCiAgICAgIDE1LAogICAgICAxMywKICAgICAgNywKICAgICAgMTksCiAgICAgIDE3LAogICAgICA3LAogICAgICAxNywKICAgICAgNiwKICAgICAgNywKICAgICAgNiwKICAgICAgMTUsCiAgICAgIDE3LAogICAgICA0LAogICAgICA4LAogICAgICAxNywKICAgICAgOCwKICAgICAgMTAsCiAgICAgIDE3LAogICAgICAxMCwKICAgICAgNiwKICAgICAgOCwKICAgICAgMCwKICAgICAgMTYsCiAgICAgIDgsCiAgICAgIDE2LAogICAgICAyLAogICAgICA4LAogICAgICAyLAogICAgICAxMCwKICAgICAgMCwKICAgICAgMTIsCiAgICAgIDEsCiAgICAgIDAsCiAgICAgIDEsCiAgICAgIDE4LAogICAgICAwLAogICAgICAxOCwKICAgICAgMTYsCiAgICAgIDYsCiAgICAgIDEwLAogICAgICAyLAogICAgICA2LAogICAgICAyLAogICAgICAxMywKICAgICAgNiwKICAgICAgMTMsCiAgICAgIDE1LAogICAgICAyLAogICAgICAxNiwKICAgICAgMTgsCiAgICAgIDIsCiAgICAgIDE4LAogICAgICAzLAogICAgICAyLAogICAgICAzLAogICAgICAxMywKICAgICAgMTgsCiAgICAgIDEsCiAgICAgIDksCiAgICAgIDE4LAogICAgICA5LAogICAgICAxMSwKICAgICAgMTgsCiAgICAgIDExLAogICAgICAzLAogICAgICA0LAogICAgICAxNCwKICAgICAgMTIsCiAgICAgIDQsCiAgICAgIDEyLAogICAgICAwLAogICAgICA0LAogICAgICAwLAogICAgICA4LAogICAgICAxMSwKICAgICAgOSwKICAgICAgNSwKICAgICAgMTEsCiAgICAgIDUsCiAgICAgIDE5LAogICAgICAxMSwKICAgICAgMTksCiAgICAgIDcsCiAgICAgIDE5LAogICAgICA1LAogICAgICAxNCwKICAgICAgMTksCiAgICAgIDE0LAogICAgICA0LAogICAgICAxOSwKICAgICAgNCwKICAgICAgMTcsCiAgICAgIDEsCiAgICAgIDEyLAogICAgICAxNCwKICAgICAgMSwKICAgICAgMTQsCiAgICAgIDUsCiAgICAgIDEsCiAgICAgIDUsCiAgICAgIDkKICAgIF07CiAgICBzdXBlcih2ZXJ0aWNlcywgaW5kaWNlcywgcmFkaXVzLCBkZXRhaWwpOwogICAgdGhpcy50eXBlID0gIkRvZGVjYWhlZHJvbkdlb21ldHJ5IjsKICAgIHRoaXMucGFyYW1ldGVycyA9IHsKICAgICAgcmFkaXVzLAogICAgICBkZXRhaWwKICAgIH07CiAgfQogIHN0YXRpYyBmcm9tSlNPTihkYXRhKSB7CiAgICByZXR1cm4gbmV3IERvZGVjYWhlZHJvbkdlb21ldHJ5KGRhdGEucmFkaXVzLCBkYXRhLmRldGFpbCk7CiAgfQp9CmNvbnN0IF92MCA9IG5ldyBWZWN0b3IzKCk7CmNvbnN0IF92MSQxID0gbmV3IFZlY3RvcjMoKTsKY29uc3QgX25vcm1hbCA9IG5ldyBWZWN0b3IzKCk7CmNvbnN0IF90cmlhbmdsZSA9IG5ldyBUcmlhbmdsZSgpOwpjbGFzcyBFZGdlc0dlb21ldHJ5IGV4dGVuZHMgQnVmZmVyR2VvbWV0cnkgewogIGNvbnN0cnVjdG9yKGdlb21ldHJ5ID0gbnVsbCwgdGhyZXNob2xkQW5nbGUgPSAxKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkVkZ2VzR2VvbWV0cnkiOwogICAgdGhpcy5wYXJhbWV0ZXJzID0gewogICAgICBnZW9tZXRyeSwKICAgICAgdGhyZXNob2xkQW5nbGUKICAgIH07CiAgICBpZiAoZ2VvbWV0cnkgIT09IG51bGwpIHsKICAgICAgY29uc3QgcHJlY2lzaW9uUG9pbnRzID0gNDsKICAgICAgY29uc3QgcHJlY2lzaW9uID0gTWF0aC5wb3coMTAsIHByZWNpc2lvblBvaW50cyk7CiAgICAgIGNvbnN0IHRocmVzaG9sZERvdCA9IE1hdGguY29zKERFRzJSQUQgKiB0aHJlc2hvbGRBbmdsZSk7CiAgICAgIGNvbnN0IGluZGV4QXR0ciA9IGdlb21ldHJ5LmdldEluZGV4KCk7CiAgICAgIGNvbnN0IHBvc2l0aW9uQXR0ciA9IGdlb21ldHJ5LmdldEF0dHJpYnV0ZSgicG9zaXRpb24iKTsKICAgICAgY29uc3QgaW5kZXhDb3VudCA9IGluZGV4QXR0ciA/IGluZGV4QXR0ci5jb3VudCA6IHBvc2l0aW9uQXR0ci5jb3VudDsKICAgICAgY29uc3QgaW5kZXhBcnIgPSBbMCwgMCwgMF07CiAgICAgIGNvbnN0IHZlcnRLZXlzID0gWyJhIiwgImIiLCAiYyJdOwogICAgICBjb25zdCBoYXNoZXMgPSBuZXcgQXJyYXkoMyk7CiAgICAgIGNvbnN0IGVkZ2VEYXRhID0ge307CiAgICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5kZXhDb3VudDsgaSArPSAzKSB7CiAgICAgICAgaWYgKGluZGV4QXR0cikgewogICAgICAgICAgaW5kZXhBcnJbMF0gPSBpbmRleEF0dHIuZ2V0WChpKTsKICAgICAgICAgIGluZGV4QXJyWzFdID0gaW5kZXhBdHRyLmdldFgoaSArIDEpOwogICAgICAgICAgaW5kZXhBcnJbMl0gPSBpbmRleEF0dHIuZ2V0WChpICsgMik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGluZGV4QXJyWzBdID0gaTsKICAgICAgICAgIGluZGV4QXJyWzFdID0gaSArIDE7CiAgICAgICAgICBpbmRleEFyclsyXSA9IGkgKyAyOwogICAgICAgIH0KICAgICAgICBjb25zdCB7IGEsIGIsIGMgfSA9IF90cmlhbmdsZTsKICAgICAgICBhLmZyb21CdWZmZXJBdHRyaWJ1dGUocG9zaXRpb25BdHRyLCBpbmRleEFyclswXSk7CiAgICAgICAgYi5mcm9tQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9uQXR0ciwgaW5kZXhBcnJbMV0pOwogICAgICAgIGMuZnJvbUJ1ZmZlckF0dHJpYnV0ZShwb3NpdGlvbkF0dHIsIGluZGV4QXJyWzJdKTsKICAgICAgICBfdHJpYW5nbGUuZ2V0Tm9ybWFsKF9ub3JtYWwpOwogICAgICAgIGhhc2hlc1swXSA9IGAke01hdGgucm91bmQoYS54ICogcHJlY2lzaW9uKX0sJHtNYXRoLnJvdW5kKGEueSAqIHByZWNpc2lvbil9LCR7TWF0aC5yb3VuZChhLnogKiBwcmVjaXNpb24pfWA7CiAgICAgICAgaGFzaGVzWzFdID0gYCR7TWF0aC5yb3VuZChiLnggKiBwcmVjaXNpb24pfSwke01hdGgucm91bmQoYi55ICogcHJlY2lzaW9uKX0sJHtNYXRoLnJvdW5kKGIueiAqIHByZWNpc2lvbil9YDsKICAgICAgICBoYXNoZXNbMl0gPSBgJHtNYXRoLnJvdW5kKGMueCAqIHByZWNpc2lvbil9LCR7TWF0aC5yb3VuZChjLnkgKiBwcmVjaXNpb24pfSwke01hdGgucm91bmQoYy56ICogcHJlY2lzaW9uKX1gOwogICAgICAgIGlmIChoYXNoZXNbMF0gPT09IGhhc2hlc1sxXSB8fCBoYXNoZXNbMV0gPT09IGhhc2hlc1syXSB8fCBoYXNoZXNbMl0gPT09IGhhc2hlc1swXSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMzsgaisrKSB7CiAgICAgICAgICBjb25zdCBqTmV4dCA9IChqICsgMSkgJSAzOwogICAgICAgICAgY29uc3QgdmVjSGFzaDAgPSBoYXNoZXNbal07CiAgICAgICAgICBjb25zdCB2ZWNIYXNoMSA9IGhhc2hlc1tqTmV4dF07CiAgICAgICAgICBjb25zdCB2MCA9IF90cmlhbmdsZVt2ZXJ0S2V5c1tqXV07CiAgICAgICAgICBjb25zdCB2MSA9IF90cmlhbmdsZVt2ZXJ0S2V5c1tqTmV4dF1dOwogICAgICAgICAgY29uc3QgaGFzaCA9IGAke3ZlY0hhc2gwfV8ke3ZlY0hhc2gxfWA7CiAgICAgICAgICBjb25zdCByZXZlcnNlSGFzaCA9IGAke3ZlY0hhc2gxfV8ke3ZlY0hhc2gwfWA7CiAgICAgICAgICBpZiAocmV2ZXJzZUhhc2ggaW4gZWRnZURhdGEgJiYgZWRnZURhdGFbcmV2ZXJzZUhhc2hdKSB7CiAgICAgICAgICAgIGlmIChfbm9ybWFsLmRvdChlZGdlRGF0YVtyZXZlcnNlSGFzaF0ubm9ybWFsKSA8PSB0aHJlc2hvbGREb3QpIHsKICAgICAgICAgICAgICB2ZXJ0aWNlcy5wdXNoKHYwLngsIHYwLnksIHYwLnopOwogICAgICAgICAgICAgIHZlcnRpY2VzLnB1c2godjEueCwgdjEueSwgdjEueik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWRnZURhdGFbcmV2ZXJzZUhhc2hdID0gbnVsbDsKICAgICAgICAgIH0gZWxzZSBpZiAoIShoYXNoIGluIGVkZ2VEYXRhKSkgewogICAgICAgICAgICBlZGdlRGF0YVtoYXNoXSA9IHsKICAgICAgICAgICAgICBpbmRleDA6IGluZGV4QXJyW2pdLAogICAgICAgICAgICAgIGluZGV4MTogaW5kZXhBcnJbak5leHRdLAogICAgICAgICAgICAgIG5vcm1hbDogX25vcm1hbC5jbG9uZSgpCiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGZvciAoY29uc3Qga2V5IGluIGVkZ2VEYXRhKSB7CiAgICAgICAgaWYgKGVkZ2VEYXRhW2tleV0pIHsKICAgICAgICAgIGNvbnN0IHsgaW5kZXgwLCBpbmRleDEgfSA9IGVkZ2VEYXRhW2tleV07CiAgICAgICAgICBfdjAuZnJvbUJ1ZmZlckF0dHJpYnV0ZShwb3NpdGlvbkF0dHIsIGluZGV4MCk7CiAgICAgICAgICBfdjEkMS5mcm9tQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9uQXR0ciwgaW5kZXgxKTsKICAgICAgICAgIHZlcnRpY2VzLnB1c2goX3YwLngsIF92MC55LCBfdjAueik7CiAgICAgICAgICB2ZXJ0aWNlcy5wdXNoKF92MSQxLngsIF92MSQxLnksIF92MSQxLnopOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnNldEF0dHJpYnV0ZSgicG9zaXRpb24iLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh2ZXJ0aWNlcywgMykpOwogICAgfQogIH0KfQpjbGFzcyBDdXJ2ZSB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLnR5cGUgPSAiQ3VydmUiOwogICAgdGhpcy5hcmNMZW5ndGhEaXZpc2lvbnMgPSAyMDA7CiAgfQogIGdldFBvaW50KCkgewogICAgY29uc29sZS53YXJuKCJUSFJFRS5DdXJ2ZTogLmdldFBvaW50KCkgbm90IGltcGxlbWVudGVkLiIpOwogICAgcmV0dXJuIG51bGw7CiAgfQogIGdldFBvaW50QXQodSwgb3B0aW9uYWxUYXJnZXQpIHsKICAgIGNvbnN0IHQgPSB0aGlzLmdldFV0b1RtYXBwaW5nKHUpOwogICAgcmV0dXJuIHRoaXMuZ2V0UG9pbnQodCwgb3B0aW9uYWxUYXJnZXQpOwogIH0KICBnZXRQb2ludHMoZGl2aXNpb25zID0gNSkgewogICAgY29uc3QgcG9pbnRzID0gW107CiAgICBmb3IgKGxldCBkID0gMDsgZCA8PSBkaXZpc2lvbnM7IGQrKykgewogICAgICBwb2ludHMucHVzaCh0aGlzLmdldFBvaW50KGQgLyBkaXZpc2lvbnMpKTsKICAgIH0KICAgIHJldHVybiBwb2ludHM7CiAgfQogIGdldFNwYWNlZFBvaW50cyhkaXZpc2lvbnMgPSA1KSB7CiAgICBjb25zdCBwb2ludHMgPSBbXTsKICAgIGZvciAobGV0IGQgPSAwOyBkIDw9IGRpdmlzaW9uczsgZCsrKSB7CiAgICAgIHBvaW50cy5wdXNoKHRoaXMuZ2V0UG9pbnRBdChkIC8gZGl2aXNpb25zKSk7CiAgICB9CiAgICByZXR1cm4gcG9pbnRzOwogIH0KICBnZXRMZW5ndGgoKSB7CiAgICBjb25zdCBsZW5ndGhzID0gdGhpcy5nZXRMZW5ndGhzKCk7CiAgICByZXR1cm4gbGVuZ3Roc1tsZW5ndGhzLmxlbmd0aCAtIDFdOwogIH0KICBnZXRMZW5ndGhzKGRpdmlzaW9ucyA9IHRoaXMuYXJjTGVuZ3RoRGl2aXNpb25zKSB7CiAgICBpZiAodGhpcy5jYWNoZUFyY0xlbmd0aHMgJiYgdGhpcy5jYWNoZUFyY0xlbmd0aHMubGVuZ3RoID09PSBkaXZpc2lvbnMgKyAxICYmICF0aGlzLm5lZWRzVXBkYXRlKSB7CiAgICAgIHJldHVybiB0aGlzLmNhY2hlQXJjTGVuZ3RoczsKICAgIH0KICAgIHRoaXMubmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgIGNvbnN0IGNhY2hlID0gW107CiAgICBsZXQgY3VycmVudCwgbGFzdCA9IHRoaXMuZ2V0UG9pbnQoMCk7CiAgICBsZXQgc3VtID0gMDsKICAgIGNhY2hlLnB1c2goMCk7CiAgICBmb3IgKGxldCBwID0gMTsgcCA8PSBkaXZpc2lvbnM7IHArKykgewogICAgICBjdXJyZW50ID0gdGhpcy5nZXRQb2ludChwIC8gZGl2aXNpb25zKTsKICAgICAgc3VtICs9IGN1cnJlbnQuZGlzdGFuY2VUbyhsYXN0KTsKICAgICAgY2FjaGUucHVzaChzdW0pOwogICAgICBsYXN0ID0gY3VycmVudDsKICAgIH0KICAgIHRoaXMuY2FjaGVBcmNMZW5ndGhzID0gY2FjaGU7CiAgICByZXR1cm4gY2FjaGU7CiAgfQogIHVwZGF0ZUFyY0xlbmd0aHMoKSB7CiAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgIHRoaXMuZ2V0TGVuZ3RocygpOwogIH0KICBnZXRVdG9UbWFwcGluZyh1LCBkaXN0YW5jZSkgewogICAgY29uc3QgYXJjTGVuZ3RocyA9IHRoaXMuZ2V0TGVuZ3RocygpOwogICAgbGV0IGkgPSAwOwogICAgY29uc3QgaWwgPSBhcmNMZW5ndGhzLmxlbmd0aDsKICAgIGxldCB0YXJnZXRBcmNMZW5ndGg7CiAgICBpZiAoZGlzdGFuY2UpIHsKICAgICAgdGFyZ2V0QXJjTGVuZ3RoID0gZGlzdGFuY2U7CiAgICB9IGVsc2UgewogICAgICB0YXJnZXRBcmNMZW5ndGggPSB1ICogYXJjTGVuZ3Roc1tpbCAtIDFdOwogICAgfQogICAgbGV0IGxvdyA9IDAsIGhpZ2ggPSBpbCAtIDEsIGNvbXBhcmlzb247CiAgICB3aGlsZSAobG93IDw9IGhpZ2gpIHsKICAgICAgaSA9IE1hdGguZmxvb3IobG93ICsgKGhpZ2ggLSBsb3cpIC8gMik7CiAgICAgIGNvbXBhcmlzb24gPSBhcmNMZW5ndGhzW2ldIC0gdGFyZ2V0QXJjTGVuZ3RoOwogICAgICBpZiAoY29tcGFyaXNvbiA8IDApIHsKICAgICAgICBsb3cgPSBpICsgMTsKICAgICAgfSBlbHNlIGlmIChjb21wYXJpc29uID4gMCkgewogICAgICAgIGhpZ2ggPSBpIC0gMTsKICAgICAgfSBlbHNlIHsKICAgICAgICBoaWdoID0gaTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgaSA9IGhpZ2g7CiAgICBpZiAoYXJjTGVuZ3Roc1tpXSA9PT0gdGFyZ2V0QXJjTGVuZ3RoKSB7CiAgICAgIHJldHVybiBpIC8gKGlsIC0gMSk7CiAgICB9CiAgICBjb25zdCBsZW5ndGhCZWZvcmUgPSBhcmNMZW5ndGhzW2ldOwogICAgY29uc3QgbGVuZ3RoQWZ0ZXIgPSBhcmNMZW5ndGhzW2kgKyAxXTsKICAgIGNvbnN0IHNlZ21lbnRMZW5ndGggPSBsZW5ndGhBZnRlciAtIGxlbmd0aEJlZm9yZTsKICAgIGNvbnN0IHNlZ21lbnRGcmFjdGlvbiA9ICh0YXJnZXRBcmNMZW5ndGggLSBsZW5ndGhCZWZvcmUpIC8gc2VnbWVudExlbmd0aDsKICAgIGNvbnN0IHQgPSAoaSArIHNlZ21lbnRGcmFjdGlvbikgLyAoaWwgLSAxKTsKICAgIHJldHVybiB0OwogIH0KICBnZXRUYW5nZW50KHQsIG9wdGlvbmFsVGFyZ2V0KSB7CiAgICBjb25zdCBkZWx0YSA9IDFlLTQ7CiAgICBsZXQgdDEgPSB0IC0gZGVsdGE7CiAgICBsZXQgdDIgPSB0ICsgZGVsdGE7CiAgICBpZiAodDEgPCAwKQogICAgICB0MSA9IDA7CiAgICBpZiAodDIgPiAxKQogICAgICB0MiA9IDE7CiAgICBjb25zdCBwdDEgPSB0aGlzLmdldFBvaW50KHQxKTsKICAgIGNvbnN0IHB0MiA9IHRoaXMuZ2V0UG9pbnQodDIpOwogICAgY29uc3QgdGFuZ2VudCA9IG9wdGlvbmFsVGFyZ2V0IHx8IChwdDEuaXNWZWN0b3IyID8gbmV3IFZlY3RvcjIoKSA6IG5ldyBWZWN0b3IzKCkpOwogICAgdGFuZ2VudC5jb3B5KHB0Mikuc3ViKHB0MSkubm9ybWFsaXplKCk7CiAgICByZXR1cm4gdGFuZ2VudDsKICB9CiAgZ2V0VGFuZ2VudEF0KHUsIG9wdGlvbmFsVGFyZ2V0KSB7CiAgICBjb25zdCB0ID0gdGhpcy5nZXRVdG9UbWFwcGluZyh1KTsKICAgIHJldHVybiB0aGlzLmdldFRhbmdlbnQodCwgb3B0aW9uYWxUYXJnZXQpOwogIH0KICBjb21wdXRlRnJlbmV0RnJhbWVzKHNlZ21lbnRzLCBjbG9zZWQpIHsKICAgIGNvbnN0IG5vcm1hbCA9IG5ldyBWZWN0b3IzKCk7CiAgICBjb25zdCB0YW5nZW50cyA9IFtdOwogICAgY29uc3Qgbm9ybWFscyA9IFtdOwogICAgY29uc3QgYmlub3JtYWxzID0gW107CiAgICBjb25zdCB2ZWMgPSBuZXcgVmVjdG9yMygpOwogICAgY29uc3QgbWF0ID0gbmV3IE1hdHJpeDQoKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IHNlZ21lbnRzOyBpKyspIHsKICAgICAgY29uc3QgdSA9IGkgLyBzZWdtZW50czsKICAgICAgdGFuZ2VudHNbaV0gPSB0aGlzLmdldFRhbmdlbnRBdCh1LCBuZXcgVmVjdG9yMygpKTsKICAgIH0KICAgIG5vcm1hbHNbMF0gPSBuZXcgVmVjdG9yMygpOwogICAgYmlub3JtYWxzWzBdID0gbmV3IFZlY3RvcjMoKTsKICAgIGxldCBtaW4gPSBOdW1iZXIuTUFYX1ZBTFVFOwogICAgY29uc3QgdHggPSBNYXRoLmFicyh0YW5nZW50c1swXS54KTsKICAgIGNvbnN0IHR5ID0gTWF0aC5hYnModGFuZ2VudHNbMF0ueSk7CiAgICBjb25zdCB0eiA9IE1hdGguYWJzKHRhbmdlbnRzWzBdLnopOwogICAgaWYgKHR4IDw9IG1pbikgewogICAgICBtaW4gPSB0eDsKICAgICAgbm9ybWFsLnNldCgxLCAwLCAwKTsKICAgIH0KICAgIGlmICh0eSA8PSBtaW4pIHsKICAgICAgbWluID0gdHk7CiAgICAgIG5vcm1hbC5zZXQoMCwgMSwgMCk7CiAgICB9CiAgICBpZiAodHogPD0gbWluKSB7CiAgICAgIG5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICB9CiAgICB2ZWMuY3Jvc3NWZWN0b3JzKHRhbmdlbnRzWzBdLCBub3JtYWwpLm5vcm1hbGl6ZSgpOwogICAgbm9ybWFsc1swXS5jcm9zc1ZlY3RvcnModGFuZ2VudHNbMF0sIHZlYyk7CiAgICBiaW5vcm1hbHNbMF0uY3Jvc3NWZWN0b3JzKHRhbmdlbnRzWzBdLCBub3JtYWxzWzBdKTsKICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHNlZ21lbnRzOyBpKyspIHsKICAgICAgbm9ybWFsc1tpXSA9IG5vcm1hbHNbaSAtIDFdLmNsb25lKCk7CiAgICAgIGJpbm9ybWFsc1tpXSA9IGJpbm9ybWFsc1tpIC0gMV0uY2xvbmUoKTsKICAgICAgdmVjLmNyb3NzVmVjdG9ycyh0YW5nZW50c1tpIC0gMV0sIHRhbmdlbnRzW2ldKTsKICAgICAgaWYgKHZlYy5sZW5ndGgoKSA+IE51bWJlci5FUFNJTE9OKSB7CiAgICAgICAgdmVjLm5vcm1hbGl6ZSgpOwogICAgICAgIGNvbnN0IHRoZXRhID0gTWF0aC5hY29zKGNsYW1wKHRhbmdlbnRzW2kgLSAxXS5kb3QodGFuZ2VudHNbaV0pLCAtMSwgMSkpOwogICAgICAgIG5vcm1hbHNbaV0uYXBwbHlNYXRyaXg0KG1hdC5tYWtlUm90YXRpb25BeGlzKHZlYywgdGhldGEpKTsKICAgICAgfQogICAgICBiaW5vcm1hbHNbaV0uY3Jvc3NWZWN0b3JzKHRhbmdlbnRzW2ldLCBub3JtYWxzW2ldKTsKICAgIH0KICAgIGlmIChjbG9zZWQgPT09IHRydWUpIHsKICAgICAgbGV0IHRoZXRhID0gTWF0aC5hY29zKGNsYW1wKG5vcm1hbHNbMF0uZG90KG5vcm1hbHNbc2VnbWVudHNdKSwgLTEsIDEpKTsKICAgICAgdGhldGEgLz0gc2VnbWVudHM7CiAgICAgIGlmICh0YW5nZW50c1swXS5kb3QodmVjLmNyb3NzVmVjdG9ycyhub3JtYWxzWzBdLCBub3JtYWxzW3NlZ21lbnRzXSkpID4gMCkgewogICAgICAgIHRoZXRhID0gLXRoZXRhOwogICAgICB9CiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHNlZ21lbnRzOyBpKyspIHsKICAgICAgICBub3JtYWxzW2ldLmFwcGx5TWF0cml4NChtYXQubWFrZVJvdGF0aW9uQXhpcyh0YW5nZW50c1tpXSwgdGhldGEgKiBpKSk7CiAgICAgICAgYmlub3JtYWxzW2ldLmNyb3NzVmVjdG9ycyh0YW5nZW50c1tpXSwgbm9ybWFsc1tpXSk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB7CiAgICAgIHRhbmdlbnRzLAogICAgICBub3JtYWxzLAogICAgICBiaW5vcm1hbHMKICAgIH07CiAgfQogIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKCkuY29weSh0aGlzKTsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHRoaXMuYXJjTGVuZ3RoRGl2aXNpb25zID0gc291cmNlLmFyY0xlbmd0aERpdmlzaW9uczsKICAgIHJldHVybiB0aGlzOwogIH0KICB0b0pTT04oKSB7CiAgICBjb25zdCBkYXRhID0gewogICAgICBtZXRhZGF0YTogewogICAgICAgIHZlcnNpb246IDQuNSwKICAgICAgICB0eXBlOiAiQ3VydmUiLAogICAgICAgIGdlbmVyYXRvcjogIkN1cnZlLnRvSlNPTiIKICAgICAgfQogICAgfTsKICAgIGRhdGEuYXJjTGVuZ3RoRGl2aXNpb25zID0gdGhpcy5hcmNMZW5ndGhEaXZpc2lvbnM7CiAgICBkYXRhLnR5cGUgPSB0aGlzLnR5cGU7CiAgICByZXR1cm4gZGF0YTsKICB9CiAgZnJvbUpTT04oanNvbikgewogICAgdGhpcy5hcmNMZW5ndGhEaXZpc2lvbnMgPSBqc29uLmFyY0xlbmd0aERpdmlzaW9uczsKICAgIHJldHVybiB0aGlzOwogIH0KfQpjbGFzcyBFbGxpcHNlQ3VydmUgZXh0ZW5kcyBDdXJ2ZSB7CiAgY29uc3RydWN0b3IoYVggPSAwLCBhWSA9IDAsIHhSYWRpdXMgPSAxLCB5UmFkaXVzID0gMSwgYVN0YXJ0QW5nbGUgPSAwLCBhRW5kQW5nbGUgPSBNYXRoLlBJICogMiwgYUNsb2Nrd2lzZSA9IGZhbHNlLCBhUm90YXRpb24gPSAwKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkVsbGlwc2VDdXJ2ZSI7CiAgICB0aGlzLmFYID0gYVg7CiAgICB0aGlzLmFZID0gYVk7CiAgICB0aGlzLnhSYWRpdXMgPSB4UmFkaXVzOwogICAgdGhpcy55UmFkaXVzID0geVJhZGl1czsKICAgIHRoaXMuYVN0YXJ0QW5nbGUgPSBhU3RhcnRBbmdsZTsKICAgIHRoaXMuYUVuZEFuZ2xlID0gYUVuZEFuZ2xlOwogICAgdGhpcy5hQ2xvY2t3aXNlID0gYUNsb2Nrd2lzZTsKICAgIHRoaXMuYVJvdGF0aW9uID0gYVJvdGF0aW9uOwogIH0KICBnZXRQb2ludCh0LCBvcHRpb25hbFRhcmdldCkgewogICAgY29uc3QgcG9pbnQgPSBvcHRpb25hbFRhcmdldCB8fCBuZXcgVmVjdG9yMigpOwogICAgY29uc3QgdHdvUGkgPSBNYXRoLlBJICogMjsKICAgIGxldCBkZWx0YUFuZ2xlID0gdGhpcy5hRW5kQW5nbGUgLSB0aGlzLmFTdGFydEFuZ2xlOwogICAgY29uc3Qgc2FtZVBvaW50cyA9IE1hdGguYWJzKGRlbHRhQW5nbGUpIDwgTnVtYmVyLkVQU0lMT047CiAgICB3aGlsZSAoZGVsdGFBbmdsZSA8IDApCiAgICAgIGRlbHRhQW5nbGUgKz0gdHdvUGk7CiAgICB3aGlsZSAoZGVsdGFBbmdsZSA+IHR3b1BpKQogICAgICBkZWx0YUFuZ2xlIC09IHR3b1BpOwogICAgaWYgKGRlbHRhQW5nbGUgPCBOdW1iZXIuRVBTSUxPTikgewogICAgICBpZiAoc2FtZVBvaW50cykgewogICAgICAgIGRlbHRhQW5nbGUgPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIGRlbHRhQW5nbGUgPSB0d29QaTsKICAgICAgfQogICAgfQogICAgaWYgKHRoaXMuYUNsb2Nrd2lzZSA9PT0gdHJ1ZSAmJiAhc2FtZVBvaW50cykgewogICAgICBpZiAoZGVsdGFBbmdsZSA9PT0gdHdvUGkpIHsKICAgICAgICBkZWx0YUFuZ2xlID0gLXR3b1BpOwogICAgICB9IGVsc2UgewogICAgICAgIGRlbHRhQW5nbGUgPSBkZWx0YUFuZ2xlIC0gdHdvUGk7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IGFuZ2xlID0gdGhpcy5hU3RhcnRBbmdsZSArIHQgKiBkZWx0YUFuZ2xlOwogICAgbGV0IHggPSB0aGlzLmFYICsgdGhpcy54UmFkaXVzICogTWF0aC5jb3MoYW5nbGUpOwogICAgbGV0IHkgPSB0aGlzLmFZICsgdGhpcy55UmFkaXVzICogTWF0aC5zaW4oYW5nbGUpOwogICAgaWYgKHRoaXMuYVJvdGF0aW9uICE9PSAwKSB7CiAgICAgIGNvbnN0IGNvcyA9IE1hdGguY29zKHRoaXMuYVJvdGF0aW9uKTsKICAgICAgY29uc3Qgc2luID0gTWF0aC5zaW4odGhpcy5hUm90YXRpb24pOwogICAgICBjb25zdCB0eCA9IHggLSB0aGlzLmFYOwogICAgICBjb25zdCB0eSA9IHkgLSB0aGlzLmFZOwogICAgICB4ID0gdHggKiBjb3MgLSB0eSAqIHNpbiArIHRoaXMuYVg7CiAgICAgIHkgPSB0eCAqIHNpbiArIHR5ICogY29zICsgdGhpcy5hWTsKICAgIH0KICAgIHJldHVybiBwb2ludC5zZXQoeCwgeSk7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLmFYID0gc291cmNlLmFYOwogICAgdGhpcy5hWSA9IHNvdXJjZS5hWTsKICAgIHRoaXMueFJhZGl1cyA9IHNvdXJjZS54UmFkaXVzOwogICAgdGhpcy55UmFkaXVzID0gc291cmNlLnlSYWRpdXM7CiAgICB0aGlzLmFTdGFydEFuZ2xlID0gc291cmNlLmFTdGFydEFuZ2xlOwogICAgdGhpcy5hRW5kQW5nbGUgPSBzb3VyY2UuYUVuZEFuZ2xlOwogICAgdGhpcy5hQ2xvY2t3aXNlID0gc291cmNlLmFDbG9ja3dpc2U7CiAgICB0aGlzLmFSb3RhdGlvbiA9IHNvdXJjZS5hUm90YXRpb247CiAgICByZXR1cm4gdGhpczsKICB9CiAgdG9KU09OKCkgewogICAgY29uc3QgZGF0YSA9IHN1cGVyLnRvSlNPTigpOwogICAgZGF0YS5hWCA9IHRoaXMuYVg7CiAgICBkYXRhLmFZID0gdGhpcy5hWTsKICAgIGRhdGEueFJhZGl1cyA9IHRoaXMueFJhZGl1czsKICAgIGRhdGEueVJhZGl1cyA9IHRoaXMueVJhZGl1czsKICAgIGRhdGEuYVN0YXJ0QW5nbGUgPSB0aGlzLmFTdGFydEFuZ2xlOwogICAgZGF0YS5hRW5kQW5nbGUgPSB0aGlzLmFFbmRBbmdsZTsKICAgIGRhdGEuYUNsb2Nrd2lzZSA9IHRoaXMuYUNsb2Nrd2lzZTsKICAgIGRhdGEuYVJvdGF0aW9uID0gdGhpcy5hUm90YXRpb247CiAgICByZXR1cm4gZGF0YTsKICB9CiAgZnJvbUpTT04oanNvbikgewogICAgc3VwZXIuZnJvbUpTT04oanNvbik7CiAgICB0aGlzLmFYID0ganNvbi5hWDsKICAgIHRoaXMuYVkgPSBqc29uLmFZOwogICAgdGhpcy54UmFkaXVzID0ganNvbi54UmFkaXVzOwogICAgdGhpcy55UmFkaXVzID0ganNvbi55UmFkaXVzOwogICAgdGhpcy5hU3RhcnRBbmdsZSA9IGpzb24uYVN0YXJ0QW5nbGU7CiAgICB0aGlzLmFFbmRBbmdsZSA9IGpzb24uYUVuZEFuZ2xlOwogICAgdGhpcy5hQ2xvY2t3aXNlID0ganNvbi5hQ2xvY2t3aXNlOwogICAgdGhpcy5hUm90YXRpb24gPSBqc29uLmFSb3RhdGlvbjsKICAgIHJldHVybiB0aGlzOwogIH0KfQpFbGxpcHNlQ3VydmUucHJvdG90eXBlLmlzRWxsaXBzZUN1cnZlID0gdHJ1ZTsKY2xhc3MgQXJjQ3VydmUgZXh0ZW5kcyBFbGxpcHNlQ3VydmUgewogIGNvbnN0cnVjdG9yKGFYLCBhWSwgYVJhZGl1cywgYVN0YXJ0QW5nbGUsIGFFbmRBbmdsZSwgYUNsb2Nrd2lzZSkgewogICAgc3VwZXIoYVgsIGFZLCBhUmFkaXVzLCBhUmFkaXVzLCBhU3RhcnRBbmdsZSwgYUVuZEFuZ2xlLCBhQ2xvY2t3aXNlKTsKICAgIHRoaXMudHlwZSA9ICJBcmNDdXJ2ZSI7CiAgfQp9CkFyY0N1cnZlLnByb3RvdHlwZS5pc0FyY0N1cnZlID0gdHJ1ZTsKZnVuY3Rpb24gQ3ViaWNQb2x5KCkgewogIGxldCBjMCA9IDAsIGMxID0gMCwgYzIgPSAwLCBjMyA9IDA7CiAgZnVuY3Rpb24gaW5pdCh4MCwgeDEsIHQwLCB0MSkgewogICAgYzAgPSB4MDsKICAgIGMxID0gdDA7CiAgICBjMiA9IC0zICogeDAgKyAzICogeDEgLSAyICogdDAgLSB0MTsKICAgIGMzID0gMiAqIHgwIC0gMiAqIHgxICsgdDAgKyB0MTsKICB9CiAgcmV0dXJuIHsKICAgIGluaXRDYXRtdWxsUm9tOiBmdW5jdGlvbih4MCwgeDEsIHgyLCB4MywgdGVuc2lvbikgewogICAgICBpbml0KHgxLCB4MiwgdGVuc2lvbiAqICh4MiAtIHgwKSwgdGVuc2lvbiAqICh4MyAtIHgxKSk7CiAgICB9LAogICAgaW5pdE5vbnVuaWZvcm1DYXRtdWxsUm9tOiBmdW5jdGlvbih4MCwgeDEsIHgyLCB4MywgZHQwLCBkdDEsIGR0MikgewogICAgICBsZXQgdDEgPSAoeDEgLSB4MCkgLyBkdDAgLSAoeDIgLSB4MCkgLyAoZHQwICsgZHQxKSArICh4MiAtIHgxKSAvIGR0MTsKICAgICAgbGV0IHQyID0gKHgyIC0geDEpIC8gZHQxIC0gKHgzIC0geDEpIC8gKGR0MSArIGR0MikgKyAoeDMgLSB4MikgLyBkdDI7CiAgICAgIHQxICo9IGR0MTsKICAgICAgdDIgKj0gZHQxOwogICAgICBpbml0KHgxLCB4MiwgdDEsIHQyKTsKICAgIH0sCiAgICBjYWxjOiBmdW5jdGlvbih0KSB7CiAgICAgIGNvbnN0IHQyID0gdCAqIHQ7CiAgICAgIGNvbnN0IHQzID0gdDIgKiB0OwogICAgICByZXR1cm4gYzAgKyBjMSAqIHQgKyBjMiAqIHQyICsgYzMgKiB0MzsKICAgIH0KICB9Owp9CmNvbnN0IHRtcCA9IG5ldyBWZWN0b3IzKCk7CmNvbnN0IHB4ID0gbmV3IEN1YmljUG9seSgpLCBweSA9IG5ldyBDdWJpY1BvbHkoKSwgcHogPSBuZXcgQ3ViaWNQb2x5KCk7CmNsYXNzIENhdG11bGxSb21DdXJ2ZTMgZXh0ZW5kcyBDdXJ2ZSB7CiAgY29uc3RydWN0b3IocG9pbnRzID0gW10sIGNsb3NlZCA9IGZhbHNlLCBjdXJ2ZVR5cGUgPSAiY2VudHJpcGV0YWwiLCB0ZW5zaW9uID0gMC41KSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkNhdG11bGxSb21DdXJ2ZTMiOwogICAgdGhpcy5wb2ludHMgPSBwb2ludHM7CiAgICB0aGlzLmNsb3NlZCA9IGNsb3NlZDsKICAgIHRoaXMuY3VydmVUeXBlID0gY3VydmVUeXBlOwogICAgdGhpcy50ZW5zaW9uID0gdGVuc2lvbjsKICB9CiAgZ2V0UG9pbnQodCwgb3B0aW9uYWxUYXJnZXQgPSBuZXcgVmVjdG9yMygpKSB7CiAgICBjb25zdCBwb2ludCA9IG9wdGlvbmFsVGFyZ2V0OwogICAgY29uc3QgcG9pbnRzID0gdGhpcy5wb2ludHM7CiAgICBjb25zdCBsID0gcG9pbnRzLmxlbmd0aDsKICAgIGNvbnN0IHAgPSAobCAtICh0aGlzLmNsb3NlZCA/IDAgOiAxKSkgKiB0OwogICAgbGV0IGludFBvaW50ID0gTWF0aC5mbG9vcihwKTsKICAgIGxldCB3ZWlnaHQgPSBwIC0gaW50UG9pbnQ7CiAgICBpZiAodGhpcy5jbG9zZWQpIHsKICAgICAgaW50UG9pbnQgKz0gaW50UG9pbnQgPiAwID8gMCA6IChNYXRoLmZsb29yKE1hdGguYWJzKGludFBvaW50KSAvIGwpICsgMSkgKiBsOwogICAgfSBlbHNlIGlmICh3ZWlnaHQgPT09IDAgJiYgaW50UG9pbnQgPT09IGwgLSAxKSB7CiAgICAgIGludFBvaW50ID0gbCAtIDI7CiAgICAgIHdlaWdodCA9IDE7CiAgICB9CiAgICBsZXQgcDAsIHAzOwogICAgaWYgKHRoaXMuY2xvc2VkIHx8IGludFBvaW50ID4gMCkgewogICAgICBwMCA9IHBvaW50c1soaW50UG9pbnQgLSAxKSAlIGxdOwogICAgfSBlbHNlIHsKICAgICAgdG1wLnN1YlZlY3RvcnMocG9pbnRzWzBdLCBwb2ludHNbMV0pLmFkZChwb2ludHNbMF0pOwogICAgICBwMCA9IHRtcDsKICAgIH0KICAgIGNvbnN0IHAxID0gcG9pbnRzW2ludFBvaW50ICUgbF07CiAgICBjb25zdCBwMiA9IHBvaW50c1soaW50UG9pbnQgKyAxKSAlIGxdOwogICAgaWYgKHRoaXMuY2xvc2VkIHx8IGludFBvaW50ICsgMiA8IGwpIHsKICAgICAgcDMgPSBwb2ludHNbKGludFBvaW50ICsgMikgJSBsXTsKICAgIH0gZWxzZSB7CiAgICAgIHRtcC5zdWJWZWN0b3JzKHBvaW50c1tsIC0gMV0sIHBvaW50c1tsIC0gMl0pLmFkZChwb2ludHNbbCAtIDFdKTsKICAgICAgcDMgPSB0bXA7CiAgICB9CiAgICBpZiAodGhpcy5jdXJ2ZVR5cGUgPT09ICJjZW50cmlwZXRhbCIgfHwgdGhpcy5jdXJ2ZVR5cGUgPT09ICJjaG9yZGFsIikgewogICAgICBjb25zdCBwb3cgPSB0aGlzLmN1cnZlVHlwZSA9PT0gImNob3JkYWwiID8gMC41IDogMC4yNTsKICAgICAgbGV0IGR0MCA9IE1hdGgucG93KHAwLmRpc3RhbmNlVG9TcXVhcmVkKHAxKSwgcG93KTsKICAgICAgbGV0IGR0MSA9IE1hdGgucG93KHAxLmRpc3RhbmNlVG9TcXVhcmVkKHAyKSwgcG93KTsKICAgICAgbGV0IGR0MiA9IE1hdGgucG93KHAyLmRpc3RhbmNlVG9TcXVhcmVkKHAzKSwgcG93KTsKICAgICAgaWYgKGR0MSA8IDFlLTQpCiAgICAgICAgZHQxID0gMTsKICAgICAgaWYgKGR0MCA8IDFlLTQpCiAgICAgICAgZHQwID0gZHQxOwogICAgICBpZiAoZHQyIDwgMWUtNCkKICAgICAgICBkdDIgPSBkdDE7CiAgICAgIHB4LmluaXROb251bmlmb3JtQ2F0bXVsbFJvbShwMC54LCBwMS54LCBwMi54LCBwMy54LCBkdDAsIGR0MSwgZHQyKTsKICAgICAgcHkuaW5pdE5vbnVuaWZvcm1DYXRtdWxsUm9tKHAwLnksIHAxLnksIHAyLnksIHAzLnksIGR0MCwgZHQxLCBkdDIpOwogICAgICBwei5pbml0Tm9udW5pZm9ybUNhdG11bGxSb20ocDAueiwgcDEueiwgcDIueiwgcDMueiwgZHQwLCBkdDEsIGR0Mik7CiAgICB9IGVsc2UgaWYgKHRoaXMuY3VydmVUeXBlID09PSAiY2F0bXVsbHJvbSIpIHsKICAgICAgcHguaW5pdENhdG11bGxSb20ocDAueCwgcDEueCwgcDIueCwgcDMueCwgdGhpcy50ZW5zaW9uKTsKICAgICAgcHkuaW5pdENhdG11bGxSb20ocDAueSwgcDEueSwgcDIueSwgcDMueSwgdGhpcy50ZW5zaW9uKTsKICAgICAgcHouaW5pdENhdG11bGxSb20ocDAueiwgcDEueiwgcDIueiwgcDMueiwgdGhpcy50ZW5zaW9uKTsKICAgIH0KICAgIHBvaW50LnNldChweC5jYWxjKHdlaWdodCksIHB5LmNhbGMod2VpZ2h0KSwgcHouY2FsYyh3ZWlnaHQpKTsKICAgIHJldHVybiBwb2ludDsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHN1cGVyLmNvcHkoc291cmNlKTsKICAgIHRoaXMucG9pbnRzID0gW107CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IHNvdXJjZS5wb2ludHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIGNvbnN0IHBvaW50ID0gc291cmNlLnBvaW50c1tpXTsKICAgICAgdGhpcy5wb2ludHMucHVzaChwb2ludC5jbG9uZSgpKTsKICAgIH0KICAgIHRoaXMuY2xvc2VkID0gc291cmNlLmNsb3NlZDsKICAgIHRoaXMuY3VydmVUeXBlID0gc291cmNlLmN1cnZlVHlwZTsKICAgIHRoaXMudGVuc2lvbiA9IHNvdXJjZS50ZW5zaW9uOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRvSlNPTigpIHsKICAgIGNvbnN0IGRhdGEgPSBzdXBlci50b0pTT04oKTsKICAgIGRhdGEucG9pbnRzID0gW107CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IHRoaXMucG9pbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBjb25zdCBwb2ludCA9IHRoaXMucG9pbnRzW2ldOwogICAgICBkYXRhLnBvaW50cy5wdXNoKHBvaW50LnRvQXJyYXkoKSk7CiAgICB9CiAgICBkYXRhLmNsb3NlZCA9IHRoaXMuY2xvc2VkOwogICAgZGF0YS5jdXJ2ZVR5cGUgPSB0aGlzLmN1cnZlVHlwZTsKICAgIGRhdGEudGVuc2lvbiA9IHRoaXMudGVuc2lvbjsKICAgIHJldHVybiBkYXRhOwogIH0KICBmcm9tSlNPTihqc29uKSB7CiAgICBzdXBlci5mcm9tSlNPTihqc29uKTsKICAgIHRoaXMucG9pbnRzID0gW107CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IGpzb24ucG9pbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBjb25zdCBwb2ludCA9IGpzb24ucG9pbnRzW2ldOwogICAgICB0aGlzLnBvaW50cy5wdXNoKG5ldyBWZWN0b3IzKCkuZnJvbUFycmF5KHBvaW50KSk7CiAgICB9CiAgICB0aGlzLmNsb3NlZCA9IGpzb24uY2xvc2VkOwogICAgdGhpcy5jdXJ2ZVR5cGUgPSBqc29uLmN1cnZlVHlwZTsKICAgIHRoaXMudGVuc2lvbiA9IGpzb24udGVuc2lvbjsKICAgIHJldHVybiB0aGlzOwogIH0KfQpDYXRtdWxsUm9tQ3VydmUzLnByb3RvdHlwZS5pc0NhdG11bGxSb21DdXJ2ZTMgPSB0cnVlOwpmdW5jdGlvbiBDYXRtdWxsUm9tKHQsIHAwLCBwMSwgcDIsIHAzKSB7CiAgY29uc3QgdjAgPSAocDIgLSBwMCkgKiAwLjU7CiAgY29uc3QgdjEgPSAocDMgLSBwMSkgKiAwLjU7CiAgY29uc3QgdDIgPSB0ICogdDsKICBjb25zdCB0MyA9IHQgKiB0MjsKICByZXR1cm4gKDIgKiBwMSAtIDIgKiBwMiArIHYwICsgdjEpICogdDMgKyAoLTMgKiBwMSArIDMgKiBwMiAtIDIgKiB2MCAtIHYxKSAqIHQyICsgdjAgKiB0ICsgcDE7Cn0KZnVuY3Rpb24gUXVhZHJhdGljQmV6aWVyUDAodCwgcCkgewogIGNvbnN0IGsgPSAxIC0gdDsKICByZXR1cm4gayAqIGsgKiBwOwp9CmZ1bmN0aW9uIFF1YWRyYXRpY0JlemllclAxKHQsIHApIHsKICByZXR1cm4gMiAqICgxIC0gdCkgKiB0ICogcDsKfQpmdW5jdGlvbiBRdWFkcmF0aWNCZXppZXJQMih0LCBwKSB7CiAgcmV0dXJuIHQgKiB0ICogcDsKfQpmdW5jdGlvbiBRdWFkcmF0aWNCZXppZXIodCwgcDAsIHAxLCBwMikgewogIHJldHVybiBRdWFkcmF0aWNCZXppZXJQMCh0LCBwMCkgKyBRdWFkcmF0aWNCZXppZXJQMSh0LCBwMSkgKyBRdWFkcmF0aWNCZXppZXJQMih0LCBwMik7Cn0KZnVuY3Rpb24gQ3ViaWNCZXppZXJQMCh0LCBwKSB7CiAgY29uc3QgayA9IDEgLSB0OwogIHJldHVybiBrICogayAqIGsgKiBwOwp9CmZ1bmN0aW9uIEN1YmljQmV6aWVyUDEodCwgcCkgewogIGNvbnN0IGsgPSAxIC0gdDsKICByZXR1cm4gMyAqIGsgKiBrICogdCAqIHA7Cn0KZnVuY3Rpb24gQ3ViaWNCZXppZXJQMih0LCBwKSB7CiAgcmV0dXJuIDMgKiAoMSAtIHQpICogdCAqIHQgKiBwOwp9CmZ1bmN0aW9uIEN1YmljQmV6aWVyUDModCwgcCkgewogIHJldHVybiB0ICogdCAqIHQgKiBwOwp9CmZ1bmN0aW9uIEN1YmljQmV6aWVyKHQsIHAwLCBwMSwgcDIsIHAzKSB7CiAgcmV0dXJuIEN1YmljQmV6aWVyUDAodCwgcDApICsgQ3ViaWNCZXppZXJQMSh0LCBwMSkgKyBDdWJpY0JlemllclAyKHQsIHAyKSArIEN1YmljQmV6aWVyUDModCwgcDMpOwp9CmNsYXNzIEN1YmljQmV6aWVyQ3VydmUgZXh0ZW5kcyBDdXJ2ZSB7CiAgY29uc3RydWN0b3IodjAgPSBuZXcgVmVjdG9yMigpLCB2MSA9IG5ldyBWZWN0b3IyKCksIHYyID0gbmV3IFZlY3RvcjIoKSwgdjMgPSBuZXcgVmVjdG9yMigpKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkN1YmljQmV6aWVyQ3VydmUiOwogICAgdGhpcy52MCA9IHYwOwogICAgdGhpcy52MSA9IHYxOwogICAgdGhpcy52MiA9IHYyOwogICAgdGhpcy52MyA9IHYzOwogIH0KICBnZXRQb2ludCh0LCBvcHRpb25hbFRhcmdldCA9IG5ldyBWZWN0b3IyKCkpIHsKICAgIGNvbnN0IHBvaW50ID0gb3B0aW9uYWxUYXJnZXQ7CiAgICBjb25zdCB2MCA9IHRoaXMudjAsIHYxID0gdGhpcy52MSwgdjIgPSB0aGlzLnYyLCB2MyA9IHRoaXMudjM7CiAgICBwb2ludC5zZXQoQ3ViaWNCZXppZXIodCwgdjAueCwgdjEueCwgdjIueCwgdjMueCksIEN1YmljQmV6aWVyKHQsIHYwLnksIHYxLnksIHYyLnksIHYzLnkpKTsKICAgIHJldHVybiBwb2ludDsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHN1cGVyLmNvcHkoc291cmNlKTsKICAgIHRoaXMudjAuY29weShzb3VyY2UudjApOwogICAgdGhpcy52MS5jb3B5KHNvdXJjZS52MSk7CiAgICB0aGlzLnYyLmNvcHkoc291cmNlLnYyKTsKICAgIHRoaXMudjMuY29weShzb3VyY2UudjMpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRvSlNPTigpIHsKICAgIGNvbnN0IGRhdGEgPSBzdXBlci50b0pTT04oKTsKICAgIGRhdGEudjAgPSB0aGlzLnYwLnRvQXJyYXkoKTsKICAgIGRhdGEudjEgPSB0aGlzLnYxLnRvQXJyYXkoKTsKICAgIGRhdGEudjIgPSB0aGlzLnYyLnRvQXJyYXkoKTsKICAgIGRhdGEudjMgPSB0aGlzLnYzLnRvQXJyYXkoKTsKICAgIHJldHVybiBkYXRhOwogIH0KICBmcm9tSlNPTihqc29uKSB7CiAgICBzdXBlci5mcm9tSlNPTihqc29uKTsKICAgIHRoaXMudjAuZnJvbUFycmF5KGpzb24udjApOwogICAgdGhpcy52MS5mcm9tQXJyYXkoanNvbi52MSk7CiAgICB0aGlzLnYyLmZyb21BcnJheShqc29uLnYyKTsKICAgIHRoaXMudjMuZnJvbUFycmF5KGpzb24udjMpOwogICAgcmV0dXJuIHRoaXM7CiAgfQp9CkN1YmljQmV6aWVyQ3VydmUucHJvdG90eXBlLmlzQ3ViaWNCZXppZXJDdXJ2ZSA9IHRydWU7CmNsYXNzIEN1YmljQmV6aWVyQ3VydmUzIGV4dGVuZHMgQ3VydmUgewogIGNvbnN0cnVjdG9yKHYwID0gbmV3IFZlY3RvcjMoKSwgdjEgPSBuZXcgVmVjdG9yMygpLCB2MiA9IG5ldyBWZWN0b3IzKCksIHYzID0gbmV3IFZlY3RvcjMoKSkgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJDdWJpY0JlemllckN1cnZlMyI7CiAgICB0aGlzLnYwID0gdjA7CiAgICB0aGlzLnYxID0gdjE7CiAgICB0aGlzLnYyID0gdjI7CiAgICB0aGlzLnYzID0gdjM7CiAgfQogIGdldFBvaW50KHQsIG9wdGlvbmFsVGFyZ2V0ID0gbmV3IFZlY3RvcjMoKSkgewogICAgY29uc3QgcG9pbnQgPSBvcHRpb25hbFRhcmdldDsKICAgIGNvbnN0IHYwID0gdGhpcy52MCwgdjEgPSB0aGlzLnYxLCB2MiA9IHRoaXMudjIsIHYzID0gdGhpcy52MzsKICAgIHBvaW50LnNldChDdWJpY0Jlemllcih0LCB2MC54LCB2MS54LCB2Mi54LCB2My54KSwgQ3ViaWNCZXppZXIodCwgdjAueSwgdjEueSwgdjIueSwgdjMueSksIEN1YmljQmV6aWVyKHQsIHYwLnosIHYxLnosIHYyLnosIHYzLnopKTsKICAgIHJldHVybiBwb2ludDsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHN1cGVyLmNvcHkoc291cmNlKTsKICAgIHRoaXMudjAuY29weShzb3VyY2UudjApOwogICAgdGhpcy52MS5jb3B5KHNvdXJjZS52MSk7CiAgICB0aGlzLnYyLmNvcHkoc291cmNlLnYyKTsKICAgIHRoaXMudjMuY29weShzb3VyY2UudjMpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRvSlNPTigpIHsKICAgIGNvbnN0IGRhdGEgPSBzdXBlci50b0pTT04oKTsKICAgIGRhdGEudjAgPSB0aGlzLnYwLnRvQXJyYXkoKTsKICAgIGRhdGEudjEgPSB0aGlzLnYxLnRvQXJyYXkoKTsKICAgIGRhdGEudjIgPSB0aGlzLnYyLnRvQXJyYXkoKTsKICAgIGRhdGEudjMgPSB0aGlzLnYzLnRvQXJyYXkoKTsKICAgIHJldHVybiBkYXRhOwogIH0KICBmcm9tSlNPTihqc29uKSB7CiAgICBzdXBlci5mcm9tSlNPTihqc29uKTsKICAgIHRoaXMudjAuZnJvbUFycmF5KGpzb24udjApOwogICAgdGhpcy52MS5mcm9tQXJyYXkoanNvbi52MSk7CiAgICB0aGlzLnYyLmZyb21BcnJheShqc29uLnYyKTsKICAgIHRoaXMudjMuZnJvbUFycmF5KGpzb24udjMpOwogICAgcmV0dXJuIHRoaXM7CiAgfQp9CkN1YmljQmV6aWVyQ3VydmUzLnByb3RvdHlwZS5pc0N1YmljQmV6aWVyQ3VydmUzID0gdHJ1ZTsKY2xhc3MgTGluZUN1cnZlIGV4dGVuZHMgQ3VydmUgewogIGNvbnN0cnVjdG9yKHYxID0gbmV3IFZlY3RvcjIoKSwgdjIgPSBuZXcgVmVjdG9yMigpKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkxpbmVDdXJ2ZSI7CiAgICB0aGlzLnYxID0gdjE7CiAgICB0aGlzLnYyID0gdjI7CiAgfQogIGdldFBvaW50KHQsIG9wdGlvbmFsVGFyZ2V0ID0gbmV3IFZlY3RvcjIoKSkgewogICAgY29uc3QgcG9pbnQgPSBvcHRpb25hbFRhcmdldDsKICAgIGlmICh0ID09PSAxKSB7CiAgICAgIHBvaW50LmNvcHkodGhpcy52Mik7CiAgICB9IGVsc2UgewogICAgICBwb2ludC5jb3B5KHRoaXMudjIpLnN1Yih0aGlzLnYxKTsKICAgICAgcG9pbnQubXVsdGlwbHlTY2FsYXIodCkuYWRkKHRoaXMudjEpOwogICAgfQogICAgcmV0dXJuIHBvaW50OwogIH0KICBnZXRQb2ludEF0KHUsIG9wdGlvbmFsVGFyZ2V0KSB7CiAgICByZXR1cm4gdGhpcy5nZXRQb2ludCh1LCBvcHRpb25hbFRhcmdldCk7CiAgfQogIGdldFRhbmdlbnQodCwgb3B0aW9uYWxUYXJnZXQpIHsKICAgIGNvbnN0IHRhbmdlbnQgPSBvcHRpb25hbFRhcmdldCB8fCBuZXcgVmVjdG9yMigpOwogICAgdGFuZ2VudC5jb3B5KHRoaXMudjIpLnN1Yih0aGlzLnYxKS5ub3JtYWxpemUoKTsKICAgIHJldHVybiB0YW5nZW50OwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy52MS5jb3B5KHNvdXJjZS52MSk7CiAgICB0aGlzLnYyLmNvcHkoc291cmNlLnYyKTsKICAgIHJldHVybiB0aGlzOwogIH0KICB0b0pTT04oKSB7CiAgICBjb25zdCBkYXRhID0gc3VwZXIudG9KU09OKCk7CiAgICBkYXRhLnYxID0gdGhpcy52MS50b0FycmF5KCk7CiAgICBkYXRhLnYyID0gdGhpcy52Mi50b0FycmF5KCk7CiAgICByZXR1cm4gZGF0YTsKICB9CiAgZnJvbUpTT04oanNvbikgewogICAgc3VwZXIuZnJvbUpTT04oanNvbik7CiAgICB0aGlzLnYxLmZyb21BcnJheShqc29uLnYxKTsKICAgIHRoaXMudjIuZnJvbUFycmF5KGpzb24udjIpOwogICAgcmV0dXJuIHRoaXM7CiAgfQp9CkxpbmVDdXJ2ZS5wcm90b3R5cGUuaXNMaW5lQ3VydmUgPSB0cnVlOwpjbGFzcyBMaW5lQ3VydmUzIGV4dGVuZHMgQ3VydmUgewogIGNvbnN0cnVjdG9yKHYxID0gbmV3IFZlY3RvcjMoKSwgdjIgPSBuZXcgVmVjdG9yMygpKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkxpbmVDdXJ2ZTMiOwogICAgdGhpcy5pc0xpbmVDdXJ2ZTMgPSB0cnVlOwogICAgdGhpcy52MSA9IHYxOwogICAgdGhpcy52MiA9IHYyOwogIH0KICBnZXRQb2ludCh0LCBvcHRpb25hbFRhcmdldCA9IG5ldyBWZWN0b3IzKCkpIHsKICAgIGNvbnN0IHBvaW50ID0gb3B0aW9uYWxUYXJnZXQ7CiAgICBpZiAodCA9PT0gMSkgewogICAgICBwb2ludC5jb3B5KHRoaXMudjIpOwogICAgfSBlbHNlIHsKICAgICAgcG9pbnQuY29weSh0aGlzLnYyKS5zdWIodGhpcy52MSk7CiAgICAgIHBvaW50Lm11bHRpcGx5U2NhbGFyKHQpLmFkZCh0aGlzLnYxKTsKICAgIH0KICAgIHJldHVybiBwb2ludDsKICB9CiAgZ2V0UG9pbnRBdCh1LCBvcHRpb25hbFRhcmdldCkgewogICAgcmV0dXJuIHRoaXMuZ2V0UG9pbnQodSwgb3B0aW9uYWxUYXJnZXQpOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy52MS5jb3B5KHNvdXJjZS52MSk7CiAgICB0aGlzLnYyLmNvcHkoc291cmNlLnYyKTsKICAgIHJldHVybiB0aGlzOwogIH0KICB0b0pTT04oKSB7CiAgICBjb25zdCBkYXRhID0gc3VwZXIudG9KU09OKCk7CiAgICBkYXRhLnYxID0gdGhpcy52MS50b0FycmF5KCk7CiAgICBkYXRhLnYyID0gdGhpcy52Mi50b0FycmF5KCk7CiAgICByZXR1cm4gZGF0YTsKICB9CiAgZnJvbUpTT04oanNvbikgewogICAgc3VwZXIuZnJvbUpTT04oanNvbik7CiAgICB0aGlzLnYxLmZyb21BcnJheShqc29uLnYxKTsKICAgIHRoaXMudjIuZnJvbUFycmF5KGpzb24udjIpOwogICAgcmV0dXJuIHRoaXM7CiAgfQp9CmNsYXNzIFF1YWRyYXRpY0JlemllckN1cnZlIGV4dGVuZHMgQ3VydmUgewogIGNvbnN0cnVjdG9yKHYwID0gbmV3IFZlY3RvcjIoKSwgdjEgPSBuZXcgVmVjdG9yMigpLCB2MiA9IG5ldyBWZWN0b3IyKCkpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLnR5cGUgPSAiUXVhZHJhdGljQmV6aWVyQ3VydmUiOwogICAgdGhpcy52MCA9IHYwOwogICAgdGhpcy52MSA9IHYxOwogICAgdGhpcy52MiA9IHYyOwogIH0KICBnZXRQb2ludCh0LCBvcHRpb25hbFRhcmdldCA9IG5ldyBWZWN0b3IyKCkpIHsKICAgIGNvbnN0IHBvaW50ID0gb3B0aW9uYWxUYXJnZXQ7CiAgICBjb25zdCB2MCA9IHRoaXMudjAsIHYxID0gdGhpcy52MSwgdjIgPSB0aGlzLnYyOwogICAgcG9pbnQuc2V0KFF1YWRyYXRpY0Jlemllcih0LCB2MC54LCB2MS54LCB2Mi54KSwgUXVhZHJhdGljQmV6aWVyKHQsIHYwLnksIHYxLnksIHYyLnkpKTsKICAgIHJldHVybiBwb2ludDsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHN1cGVyLmNvcHkoc291cmNlKTsKICAgIHRoaXMudjAuY29weShzb3VyY2UudjApOwogICAgdGhpcy52MS5jb3B5KHNvdXJjZS52MSk7CiAgICB0aGlzLnYyLmNvcHkoc291cmNlLnYyKTsKICAgIHJldHVybiB0aGlzOwogIH0KICB0b0pTT04oKSB7CiAgICBjb25zdCBkYXRhID0gc3VwZXIudG9KU09OKCk7CiAgICBkYXRhLnYwID0gdGhpcy52MC50b0FycmF5KCk7CiAgICBkYXRhLnYxID0gdGhpcy52MS50b0FycmF5KCk7CiAgICBkYXRhLnYyID0gdGhpcy52Mi50b0FycmF5KCk7CiAgICByZXR1cm4gZGF0YTsKICB9CiAgZnJvbUpTT04oanNvbikgewogICAgc3VwZXIuZnJvbUpTT04oanNvbik7CiAgICB0aGlzLnYwLmZyb21BcnJheShqc29uLnYwKTsKICAgIHRoaXMudjEuZnJvbUFycmF5KGpzb24udjEpOwogICAgdGhpcy52Mi5mcm9tQXJyYXkoanNvbi52Mik7CiAgICByZXR1cm4gdGhpczsKICB9Cn0KUXVhZHJhdGljQmV6aWVyQ3VydmUucHJvdG90eXBlLmlzUXVhZHJhdGljQmV6aWVyQ3VydmUgPSB0cnVlOwpjbGFzcyBRdWFkcmF0aWNCZXppZXJDdXJ2ZTMgZXh0ZW5kcyBDdXJ2ZSB7CiAgY29uc3RydWN0b3IodjAgPSBuZXcgVmVjdG9yMygpLCB2MSA9IG5ldyBWZWN0b3IzKCksIHYyID0gbmV3IFZlY3RvcjMoKSkgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJRdWFkcmF0aWNCZXppZXJDdXJ2ZTMiOwogICAgdGhpcy52MCA9IHYwOwogICAgdGhpcy52MSA9IHYxOwogICAgdGhpcy52MiA9IHYyOwogIH0KICBnZXRQb2ludCh0LCBvcHRpb25hbFRhcmdldCA9IG5ldyBWZWN0b3IzKCkpIHsKICAgIGNvbnN0IHBvaW50ID0gb3B0aW9uYWxUYXJnZXQ7CiAgICBjb25zdCB2MCA9IHRoaXMudjAsIHYxID0gdGhpcy52MSwgdjIgPSB0aGlzLnYyOwogICAgcG9pbnQuc2V0KFF1YWRyYXRpY0Jlemllcih0LCB2MC54LCB2MS54LCB2Mi54KSwgUXVhZHJhdGljQmV6aWVyKHQsIHYwLnksIHYxLnksIHYyLnkpLCBRdWFkcmF0aWNCZXppZXIodCwgdjAueiwgdjEueiwgdjIueikpOwogICAgcmV0dXJuIHBvaW50OwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy52MC5jb3B5KHNvdXJjZS52MCk7CiAgICB0aGlzLnYxLmNvcHkoc291cmNlLnYxKTsKICAgIHRoaXMudjIuY29weShzb3VyY2UudjIpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRvSlNPTigpIHsKICAgIGNvbnN0IGRhdGEgPSBzdXBlci50b0pTT04oKTsKICAgIGRhdGEudjAgPSB0aGlzLnYwLnRvQXJyYXkoKTsKICAgIGRhdGEudjEgPSB0aGlzLnYxLnRvQXJyYXkoKTsKICAgIGRhdGEudjIgPSB0aGlzLnYyLnRvQXJyYXkoKTsKICAgIHJldHVybiBkYXRhOwogIH0KICBmcm9tSlNPTihqc29uKSB7CiAgICBzdXBlci5mcm9tSlNPTihqc29uKTsKICAgIHRoaXMudjAuZnJvbUFycmF5KGpzb24udjApOwogICAgdGhpcy52MS5mcm9tQXJyYXkoanNvbi52MSk7CiAgICB0aGlzLnYyLmZyb21BcnJheShqc29uLnYyKTsKICAgIHJldHVybiB0aGlzOwogIH0KfQpRdWFkcmF0aWNCZXppZXJDdXJ2ZTMucHJvdG90eXBlLmlzUXVhZHJhdGljQmV6aWVyQ3VydmUzID0gdHJ1ZTsKY2xhc3MgU3BsaW5lQ3VydmUgZXh0ZW5kcyBDdXJ2ZSB7CiAgY29uc3RydWN0b3IocG9pbnRzID0gW10pIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLnR5cGUgPSAiU3BsaW5lQ3VydmUiOwogICAgdGhpcy5wb2ludHMgPSBwb2ludHM7CiAgfQogIGdldFBvaW50KHQsIG9wdGlvbmFsVGFyZ2V0ID0gbmV3IFZlY3RvcjIoKSkgewogICAgY29uc3QgcG9pbnQgPSBvcHRpb25hbFRhcmdldDsKICAgIGNvbnN0IHBvaW50cyA9IHRoaXMucG9pbnRzOwogICAgY29uc3QgcCA9IChwb2ludHMubGVuZ3RoIC0gMSkgKiB0OwogICAgY29uc3QgaW50UG9pbnQgPSBNYXRoLmZsb29yKHApOwogICAgY29uc3Qgd2VpZ2h0ID0gcCAtIGludFBvaW50OwogICAgY29uc3QgcDAgPSBwb2ludHNbaW50UG9pbnQgPT09IDAgPyBpbnRQb2ludCA6IGludFBvaW50IC0gMV07CiAgICBjb25zdCBwMSA9IHBvaW50c1tpbnRQb2ludF07CiAgICBjb25zdCBwMiA9IHBvaW50c1tpbnRQb2ludCA+IHBvaW50cy5sZW5ndGggLSAyID8gcG9pbnRzLmxlbmd0aCAtIDEgOiBpbnRQb2ludCArIDFdOwogICAgY29uc3QgcDMgPSBwb2ludHNbaW50UG9pbnQgPiBwb2ludHMubGVuZ3RoIC0gMyA/IHBvaW50cy5sZW5ndGggLSAxIDogaW50UG9pbnQgKyAyXTsKICAgIHBvaW50LnNldChDYXRtdWxsUm9tKHdlaWdodCwgcDAueCwgcDEueCwgcDIueCwgcDMueCksIENhdG11bGxSb20od2VpZ2h0LCBwMC55LCBwMS55LCBwMi55LCBwMy55KSk7CiAgICByZXR1cm4gcG9pbnQ7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLnBvaW50cyA9IFtdOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSBzb3VyY2UucG9pbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBjb25zdCBwb2ludCA9IHNvdXJjZS5wb2ludHNbaV07CiAgICAgIHRoaXMucG9pbnRzLnB1c2gocG9pbnQuY2xvbmUoKSk7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9CiAgdG9KU09OKCkgewogICAgY29uc3QgZGF0YSA9IHN1cGVyLnRvSlNPTigpOwogICAgZGF0YS5wb2ludHMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5wb2ludHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIGNvbnN0IHBvaW50ID0gdGhpcy5wb2ludHNbaV07CiAgICAgIGRhdGEucG9pbnRzLnB1c2gocG9pbnQudG9BcnJheSgpKTsKICAgIH0KICAgIHJldHVybiBkYXRhOwogIH0KICBmcm9tSlNPTihqc29uKSB7CiAgICBzdXBlci5mcm9tSlNPTihqc29uKTsKICAgIHRoaXMucG9pbnRzID0gW107CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IGpzb24ucG9pbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBjb25zdCBwb2ludCA9IGpzb24ucG9pbnRzW2ldOwogICAgICB0aGlzLnBvaW50cy5wdXNoKG5ldyBWZWN0b3IyKCkuZnJvbUFycmF5KHBvaW50KSk7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9Cn0KU3BsaW5lQ3VydmUucHJvdG90eXBlLmlzU3BsaW5lQ3VydmUgPSB0cnVlOwp2YXIgQ3VydmVzID0gLyogQF9fUFVSRV9fICovIE9iamVjdC5mcmVlemUoewogIF9fcHJvdG9fXzogbnVsbCwKICBBcmNDdXJ2ZSwKICBDYXRtdWxsUm9tQ3VydmUzLAogIEN1YmljQmV6aWVyQ3VydmUsCiAgQ3ViaWNCZXppZXJDdXJ2ZTMsCiAgRWxsaXBzZUN1cnZlLAogIExpbmVDdXJ2ZSwKICBMaW5lQ3VydmUzLAogIFF1YWRyYXRpY0JlemllckN1cnZlLAogIFF1YWRyYXRpY0JlemllckN1cnZlMywKICBTcGxpbmVDdXJ2ZQp9KTsKY2xhc3MgQ3VydmVQYXRoIGV4dGVuZHMgQ3VydmUgewogIGNvbnN0cnVjdG9yKCkgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJDdXJ2ZVBhdGgiOwogICAgdGhpcy5jdXJ2ZXMgPSBbXTsKICAgIHRoaXMuYXV0b0Nsb3NlID0gZmFsc2U7CiAgfQogIGFkZChjdXJ2ZSkgewogICAgdGhpcy5jdXJ2ZXMucHVzaChjdXJ2ZSk7CiAgfQogIGNsb3NlUGF0aCgpIHsKICAgIGNvbnN0IHN0YXJ0UG9pbnQgPSB0aGlzLmN1cnZlc1swXS5nZXRQb2ludCgwKTsKICAgIGNvbnN0IGVuZFBvaW50ID0gdGhpcy5jdXJ2ZXNbdGhpcy5jdXJ2ZXMubGVuZ3RoIC0gMV0uZ2V0UG9pbnQoMSk7CiAgICBpZiAoIXN0YXJ0UG9pbnQuZXF1YWxzKGVuZFBvaW50KSkgewogICAgICB0aGlzLmN1cnZlcy5wdXNoKG5ldyBMaW5lQ3VydmUoZW5kUG9pbnQsIHN0YXJ0UG9pbnQpKTsKICAgIH0KICB9CiAgZ2V0UG9pbnQodCwgb3B0aW9uYWxUYXJnZXQpIHsKICAgIGNvbnN0IGQgPSB0ICogdGhpcy5nZXRMZW5ndGgoKTsKICAgIGNvbnN0IGN1cnZlTGVuZ3RocyA9IHRoaXMuZ2V0Q3VydmVMZW5ndGhzKCk7CiAgICBsZXQgaSA9IDA7CiAgICB3aGlsZSAoaSA8IGN1cnZlTGVuZ3Rocy5sZW5ndGgpIHsKICAgICAgaWYgKGN1cnZlTGVuZ3Roc1tpXSA+PSBkKSB7CiAgICAgICAgY29uc3QgZGlmZiA9IGN1cnZlTGVuZ3Roc1tpXSAtIGQ7CiAgICAgICAgY29uc3QgY3VydmUgPSB0aGlzLmN1cnZlc1tpXTsKICAgICAgICBjb25zdCBzZWdtZW50TGVuZ3RoID0gY3VydmUuZ2V0TGVuZ3RoKCk7CiAgICAgICAgY29uc3QgdSA9IHNlZ21lbnRMZW5ndGggPT09IDAgPyAwIDogMSAtIGRpZmYgLyBzZWdtZW50TGVuZ3RoOwogICAgICAgIHJldHVybiBjdXJ2ZS5nZXRQb2ludEF0KHUsIG9wdGlvbmFsVGFyZ2V0KTsKICAgICAgfQogICAgICBpKys7CiAgICB9CiAgICByZXR1cm4gbnVsbDsKICB9CiAgZ2V0TGVuZ3RoKCkgewogICAgY29uc3QgbGVucyA9IHRoaXMuZ2V0Q3VydmVMZW5ndGhzKCk7CiAgICByZXR1cm4gbGVuc1tsZW5zLmxlbmd0aCAtIDFdOwogIH0KICB1cGRhdGVBcmNMZW5ndGhzKCkgewogICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICB0aGlzLmNhY2hlTGVuZ3RocyA9IG51bGw7CiAgICB0aGlzLmdldEN1cnZlTGVuZ3RocygpOwogIH0KICBnZXRDdXJ2ZUxlbmd0aHMoKSB7CiAgICBpZiAodGhpcy5jYWNoZUxlbmd0aHMgJiYgdGhpcy5jYWNoZUxlbmd0aHMubGVuZ3RoID09PSB0aGlzLmN1cnZlcy5sZW5ndGgpIHsKICAgICAgcmV0dXJuIHRoaXMuY2FjaGVMZW5ndGhzOwogICAgfQogICAgY29uc3QgbGVuZ3RocyA9IFtdOwogICAgbGV0IHN1bXMgPSAwOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSB0aGlzLmN1cnZlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgc3VtcyArPSB0aGlzLmN1cnZlc1tpXS5nZXRMZW5ndGgoKTsKICAgICAgbGVuZ3Rocy5wdXNoKHN1bXMpOwogICAgfQogICAgdGhpcy5jYWNoZUxlbmd0aHMgPSBsZW5ndGhzOwogICAgcmV0dXJuIGxlbmd0aHM7CiAgfQogIGdldFNwYWNlZFBvaW50cyhkaXZpc2lvbnMgPSA0MCkgewogICAgY29uc3QgcG9pbnRzID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBkaXZpc2lvbnM7IGkrKykgewogICAgICBwb2ludHMucHVzaCh0aGlzLmdldFBvaW50KGkgLyBkaXZpc2lvbnMpKTsKICAgIH0KICAgIGlmICh0aGlzLmF1dG9DbG9zZSkgewogICAgICBwb2ludHMucHVzaChwb2ludHNbMF0pOwogICAgfQogICAgcmV0dXJuIHBvaW50czsKICB9CiAgZ2V0UG9pbnRzKGRpdmlzaW9ucyA9IDEyKSB7CiAgICBjb25zdCBwb2ludHMgPSBbXTsKICAgIGxldCBsYXN0OwogICAgZm9yIChsZXQgaSA9IDAsIGN1cnZlcyA9IHRoaXMuY3VydmVzOyBpIDwgY3VydmVzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGN1cnZlID0gY3VydmVzW2ldOwogICAgICBjb25zdCByZXNvbHV0aW9uID0gY3VydmUgJiYgY3VydmUuaXNFbGxpcHNlQ3VydmUgPyBkaXZpc2lvbnMgKiAyIDogY3VydmUgJiYgKGN1cnZlLmlzTGluZUN1cnZlIHx8IGN1cnZlLmlzTGluZUN1cnZlMykgPyAxIDogY3VydmUgJiYgY3VydmUuaXNTcGxpbmVDdXJ2ZSA/IGRpdmlzaW9ucyAqIGN1cnZlLnBvaW50cy5sZW5ndGggOiBkaXZpc2lvbnM7CiAgICAgIGNvbnN0IHB0cyA9IGN1cnZlLmdldFBvaW50cyhyZXNvbHV0aW9uKTsKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBwdHMubGVuZ3RoOyBqKyspIHsKICAgICAgICBjb25zdCBwb2ludCA9IHB0c1tqXTsKICAgICAgICBpZiAobGFzdCAmJiBsYXN0LmVxdWFscyhwb2ludCkpCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICBwb2ludHMucHVzaChwb2ludCk7CiAgICAgICAgbGFzdCA9IHBvaW50OwogICAgICB9CiAgICB9CiAgICBpZiAodGhpcy5hdXRvQ2xvc2UgJiYgcG9pbnRzLmxlbmd0aCA+IDEgJiYgIXBvaW50c1twb2ludHMubGVuZ3RoIC0gMV0uZXF1YWxzKHBvaW50c1swXSkpIHsKICAgICAgcG9pbnRzLnB1c2gocG9pbnRzWzBdKTsKICAgIH0KICAgIHJldHVybiBwb2ludHM7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLmN1cnZlcyA9IFtdOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSBzb3VyY2UuY3VydmVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBjb25zdCBjdXJ2ZSA9IHNvdXJjZS5jdXJ2ZXNbaV07CiAgICAgIHRoaXMuY3VydmVzLnB1c2goY3VydmUuY2xvbmUoKSk7CiAgICB9CiAgICB0aGlzLmF1dG9DbG9zZSA9IHNvdXJjZS5hdXRvQ2xvc2U7CiAgICByZXR1cm4gdGhpczsKICB9CiAgdG9KU09OKCkgewogICAgY29uc3QgZGF0YSA9IHN1cGVyLnRvSlNPTigpOwogICAgZGF0YS5hdXRvQ2xvc2UgPSB0aGlzLmF1dG9DbG9zZTsKICAgIGRhdGEuY3VydmVzID0gW107CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IHRoaXMuY3VydmVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBjb25zdCBjdXJ2ZSA9IHRoaXMuY3VydmVzW2ldOwogICAgICBkYXRhLmN1cnZlcy5wdXNoKGN1cnZlLnRvSlNPTigpKTsKICAgIH0KICAgIHJldHVybiBkYXRhOwogIH0KICBmcm9tSlNPTihqc29uKSB7CiAgICBzdXBlci5mcm9tSlNPTihqc29uKTsKICAgIHRoaXMuYXV0b0Nsb3NlID0ganNvbi5hdXRvQ2xvc2U7CiAgICB0aGlzLmN1cnZlcyA9IFtdOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSBqc29uLmN1cnZlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgY29uc3QgY3VydmUgPSBqc29uLmN1cnZlc1tpXTsKICAgICAgdGhpcy5jdXJ2ZXMucHVzaChuZXcgQ3VydmVzW2N1cnZlLnR5cGVdKCkuZnJvbUpTT04oY3VydmUpKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KfQpjbGFzcyBQYXRoIGV4dGVuZHMgQ3VydmVQYXRoIHsKICBjb25zdHJ1Y3Rvcihwb2ludHMpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLnR5cGUgPSAiUGF0aCI7CiAgICB0aGlzLmN1cnJlbnRQb2ludCA9IG5ldyBWZWN0b3IyKCk7CiAgICBpZiAocG9pbnRzKSB7CiAgICAgIHRoaXMuc2V0RnJvbVBvaW50cyhwb2ludHMpOwogICAgfQogIH0KICBzZXRGcm9tUG9pbnRzKHBvaW50cykgewogICAgdGhpcy5tb3ZlVG8ocG9pbnRzWzBdLngsIHBvaW50c1swXS55KTsKICAgIGZvciAobGV0IGkgPSAxLCBsID0gcG9pbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICB0aGlzLmxpbmVUbyhwb2ludHNbaV0ueCwgcG9pbnRzW2ldLnkpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIG1vdmVUbyh4LCB5KSB7CiAgICB0aGlzLmN1cnJlbnRQb2ludC5zZXQoeCwgeSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbGluZVRvKHgsIHkpIHsKICAgIGNvbnN0IGN1cnZlID0gbmV3IExpbmVDdXJ2ZSh0aGlzLmN1cnJlbnRQb2ludC5jbG9uZSgpLCBuZXcgVmVjdG9yMih4LCB5KSk7CiAgICB0aGlzLmN1cnZlcy5wdXNoKGN1cnZlKTsKICAgIHRoaXMuY3VycmVudFBvaW50LnNldCh4LCB5KTsKICAgIHJldHVybiB0aGlzOwogIH0KICBxdWFkcmF0aWNDdXJ2ZVRvKGFDUHgsIGFDUHksIGFYLCBhWSkgewogICAgY29uc3QgY3VydmUgPSBuZXcgUXVhZHJhdGljQmV6aWVyQ3VydmUodGhpcy5jdXJyZW50UG9pbnQuY2xvbmUoKSwgbmV3IFZlY3RvcjIoYUNQeCwgYUNQeSksIG5ldyBWZWN0b3IyKGFYLCBhWSkpOwogICAgdGhpcy5jdXJ2ZXMucHVzaChjdXJ2ZSk7CiAgICB0aGlzLmN1cnJlbnRQb2ludC5zZXQoYVgsIGFZKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBiZXppZXJDdXJ2ZVRvKGFDUDF4LCBhQ1AxeSwgYUNQMngsIGFDUDJ5LCBhWCwgYVkpIHsKICAgIGNvbnN0IGN1cnZlID0gbmV3IEN1YmljQmV6aWVyQ3VydmUodGhpcy5jdXJyZW50UG9pbnQuY2xvbmUoKSwgbmV3IFZlY3RvcjIoYUNQMXgsIGFDUDF5KSwgbmV3IFZlY3RvcjIoYUNQMngsIGFDUDJ5KSwgbmV3IFZlY3RvcjIoYVgsIGFZKSk7CiAgICB0aGlzLmN1cnZlcy5wdXNoKGN1cnZlKTsKICAgIHRoaXMuY3VycmVudFBvaW50LnNldChhWCwgYVkpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNwbGluZVRocnUocHRzKSB7CiAgICBjb25zdCBucHRzID0gW3RoaXMuY3VycmVudFBvaW50LmNsb25lKCldLmNvbmNhdChwdHMpOwogICAgY29uc3QgY3VydmUgPSBuZXcgU3BsaW5lQ3VydmUobnB0cyk7CiAgICB0aGlzLmN1cnZlcy5wdXNoKGN1cnZlKTsKICAgIHRoaXMuY3VycmVudFBvaW50LmNvcHkocHRzW3B0cy5sZW5ndGggLSAxXSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgYXJjKGFYLCBhWSwgYVJhZGl1cywgYVN0YXJ0QW5nbGUsIGFFbmRBbmdsZSwgYUNsb2Nrd2lzZSkgewogICAgY29uc3QgeDAgPSB0aGlzLmN1cnJlbnRQb2ludC54OwogICAgY29uc3QgeTAgPSB0aGlzLmN1cnJlbnRQb2ludC55OwogICAgdGhpcy5hYnNhcmMoYVggKyB4MCwgYVkgKyB5MCwgYVJhZGl1cywgYVN0YXJ0QW5nbGUsIGFFbmRBbmdsZSwgYUNsb2Nrd2lzZSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgYWJzYXJjKGFYLCBhWSwgYVJhZGl1cywgYVN0YXJ0QW5nbGUsIGFFbmRBbmdsZSwgYUNsb2Nrd2lzZSkgewogICAgdGhpcy5hYnNlbGxpcHNlKGFYLCBhWSwgYVJhZGl1cywgYVJhZGl1cywgYVN0YXJ0QW5nbGUsIGFFbmRBbmdsZSwgYUNsb2Nrd2lzZSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZWxsaXBzZShhWCwgYVksIHhSYWRpdXMsIHlSYWRpdXMsIGFTdGFydEFuZ2xlLCBhRW5kQW5nbGUsIGFDbG9ja3dpc2UsIGFSb3RhdGlvbikgewogICAgY29uc3QgeDAgPSB0aGlzLmN1cnJlbnRQb2ludC54OwogICAgY29uc3QgeTAgPSB0aGlzLmN1cnJlbnRQb2ludC55OwogICAgdGhpcy5hYnNlbGxpcHNlKGFYICsgeDAsIGFZICsgeTAsIHhSYWRpdXMsIHlSYWRpdXMsIGFTdGFydEFuZ2xlLCBhRW5kQW5nbGUsIGFDbG9ja3dpc2UsIGFSb3RhdGlvbik7CiAgICByZXR1cm4gdGhpczsKICB9CiAgYWJzZWxsaXBzZShhWCwgYVksIHhSYWRpdXMsIHlSYWRpdXMsIGFTdGFydEFuZ2xlLCBhRW5kQW5nbGUsIGFDbG9ja3dpc2UsIGFSb3RhdGlvbikgewogICAgY29uc3QgY3VydmUgPSBuZXcgRWxsaXBzZUN1cnZlKGFYLCBhWSwgeFJhZGl1cywgeVJhZGl1cywgYVN0YXJ0QW5nbGUsIGFFbmRBbmdsZSwgYUNsb2Nrd2lzZSwgYVJvdGF0aW9uKTsKICAgIGlmICh0aGlzLmN1cnZlcy5sZW5ndGggPiAwKSB7CiAgICAgIGNvbnN0IGZpcnN0UG9pbnQgPSBjdXJ2ZS5nZXRQb2ludCgwKTsKICAgICAgaWYgKCFmaXJzdFBvaW50LmVxdWFscyh0aGlzLmN1cnJlbnRQb2ludCkpIHsKICAgICAgICB0aGlzLmxpbmVUbyhmaXJzdFBvaW50LngsIGZpcnN0UG9pbnQueSk7CiAgICAgIH0KICAgIH0KICAgIHRoaXMuY3VydmVzLnB1c2goY3VydmUpOwogICAgY29uc3QgbGFzdFBvaW50ID0gY3VydmUuZ2V0UG9pbnQoMSk7CiAgICB0aGlzLmN1cnJlbnRQb2ludC5jb3B5KGxhc3RQb2ludCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHN1cGVyLmNvcHkoc291cmNlKTsKICAgIHRoaXMuY3VycmVudFBvaW50LmNvcHkoc291cmNlLmN1cnJlbnRQb2ludCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgdG9KU09OKCkgewogICAgY29uc3QgZGF0YSA9IHN1cGVyLnRvSlNPTigpOwogICAgZGF0YS5jdXJyZW50UG9pbnQgPSB0aGlzLmN1cnJlbnRQb2ludC50b0FycmF5KCk7CiAgICByZXR1cm4gZGF0YTsKICB9CiAgZnJvbUpTT04oanNvbikgewogICAgc3VwZXIuZnJvbUpTT04oanNvbik7CiAgICB0aGlzLmN1cnJlbnRQb2ludC5mcm9tQXJyYXkoanNvbi5jdXJyZW50UG9pbnQpOwogICAgcmV0dXJuIHRoaXM7CiAgfQp9CmNsYXNzIFNoYXBlIGV4dGVuZHMgUGF0aCB7CiAgY29uc3RydWN0b3IocG9pbnRzKSB7CiAgICBzdXBlcihwb2ludHMpOwogICAgdGhpcy51dWlkID0gZ2VuZXJhdGVVVUlEKCk7CiAgICB0aGlzLnR5cGUgPSAiU2hhcGUiOwogICAgdGhpcy5ob2xlcyA9IFtdOwogIH0KICBnZXRQb2ludHNIb2xlcyhkaXZpc2lvbnMpIHsKICAgIGNvbnN0IGhvbGVzUHRzID0gW107CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IHRoaXMuaG9sZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIGhvbGVzUHRzW2ldID0gdGhpcy5ob2xlc1tpXS5nZXRQb2ludHMoZGl2aXNpb25zKTsKICAgIH0KICAgIHJldHVybiBob2xlc1B0czsKICB9CiAgZXh0cmFjdFBvaW50cyhkaXZpc2lvbnMpIHsKICAgIHJldHVybiB7CiAgICAgIHNoYXBlOiB0aGlzLmdldFBvaW50cyhkaXZpc2lvbnMpLAogICAgICBob2xlczogdGhpcy5nZXRQb2ludHNIb2xlcyhkaXZpc2lvbnMpCiAgICB9OwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy5ob2xlcyA9IFtdOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSBzb3VyY2UuaG9sZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIGNvbnN0IGhvbGUgPSBzb3VyY2UuaG9sZXNbaV07CiAgICAgIHRoaXMuaG9sZXMucHVzaChob2xlLmNsb25lKCkpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRvSlNPTigpIHsKICAgIGNvbnN0IGRhdGEgPSBzdXBlci50b0pTT04oKTsKICAgIGRhdGEudXVpZCA9IHRoaXMudXVpZDsKICAgIGRhdGEuaG9sZXMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5ob2xlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgY29uc3QgaG9sZSA9IHRoaXMuaG9sZXNbaV07CiAgICAgIGRhdGEuaG9sZXMucHVzaChob2xlLnRvSlNPTigpKTsKICAgIH0KICAgIHJldHVybiBkYXRhOwogIH0KICBmcm9tSlNPTihqc29uKSB7CiAgICBzdXBlci5mcm9tSlNPTihqc29uKTsKICAgIHRoaXMudXVpZCA9IGpzb24udXVpZDsKICAgIHRoaXMuaG9sZXMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwLCBsID0ganNvbi5ob2xlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgY29uc3QgaG9sZSA9IGpzb24uaG9sZXNbaV07CiAgICAgIHRoaXMuaG9sZXMucHVzaChuZXcgUGF0aCgpLmZyb21KU09OKGhvbGUpKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KfQpjb25zdCBFYXJjdXQgPSB7CiAgdHJpYW5ndWxhdGU6IGZ1bmN0aW9uKGRhdGEsIGhvbGVJbmRpY2VzLCBkaW0gPSAyKSB7CiAgICBjb25zdCBoYXNIb2xlcyA9IGhvbGVJbmRpY2VzICYmIGhvbGVJbmRpY2VzLmxlbmd0aDsKICAgIGNvbnN0IG91dGVyTGVuID0gaGFzSG9sZXMgPyBob2xlSW5kaWNlc1swXSAqIGRpbSA6IGRhdGEubGVuZ3RoOwogICAgbGV0IG91dGVyTm9kZSA9IGxpbmtlZExpc3QoZGF0YSwgMCwgb3V0ZXJMZW4sIGRpbSwgdHJ1ZSk7CiAgICBjb25zdCB0cmlhbmdsZXMgPSBbXTsKICAgIGlmICghb3V0ZXJOb2RlIHx8IG91dGVyTm9kZS5uZXh0ID09PSBvdXRlck5vZGUucHJldikKICAgICAgcmV0dXJuIHRyaWFuZ2xlczsKICAgIGxldCBtaW5YLCBtaW5ZLCBtYXhYLCBtYXhZLCB4LCB5LCBpbnZTaXplOwogICAgaWYgKGhhc0hvbGVzKQogICAgICBvdXRlck5vZGUgPSBlbGltaW5hdGVIb2xlcyhkYXRhLCBob2xlSW5kaWNlcywgb3V0ZXJOb2RlLCBkaW0pOwogICAgaWYgKGRhdGEubGVuZ3RoID4gODAgKiBkaW0pIHsKICAgICAgbWluWCA9IG1heFggPSBkYXRhWzBdOwogICAgICBtaW5ZID0gbWF4WSA9IGRhdGFbMV07CiAgICAgIGZvciAobGV0IGkgPSBkaW07IGkgPCBvdXRlckxlbjsgaSArPSBkaW0pIHsKICAgICAgICB4ID0gZGF0YVtpXTsKICAgICAgICB5ID0gZGF0YVtpICsgMV07CiAgICAgICAgaWYgKHggPCBtaW5YKQogICAgICAgICAgbWluWCA9IHg7CiAgICAgICAgaWYgKHkgPCBtaW5ZKQogICAgICAgICAgbWluWSA9IHk7CiAgICAgICAgaWYgKHggPiBtYXhYKQogICAgICAgICAgbWF4WCA9IHg7CiAgICAgICAgaWYgKHkgPiBtYXhZKQogICAgICAgICAgbWF4WSA9IHk7CiAgICAgIH0KICAgICAgaW52U2l6ZSA9IE1hdGgubWF4KG1heFggLSBtaW5YLCBtYXhZIC0gbWluWSk7CiAgICAgIGludlNpemUgPSBpbnZTaXplICE9PSAwID8gMSAvIGludlNpemUgOiAwOwogICAgfQogICAgZWFyY3V0TGlua2VkKG91dGVyTm9kZSwgdHJpYW5nbGVzLCBkaW0sIG1pblgsIG1pblksIGludlNpemUpOwogICAgcmV0dXJuIHRyaWFuZ2xlczsKICB9Cn07CmZ1bmN0aW9uIGxpbmtlZExpc3QoZGF0YSwgc3RhcnQsIGVuZCwgZGltLCBjbG9ja3dpc2UpIHsKICBsZXQgaSwgbGFzdDsKICBpZiAoY2xvY2t3aXNlID09PSBzaWduZWRBcmVhKGRhdGEsIHN0YXJ0LCBlbmQsIGRpbSkgPiAwKSB7CiAgICBmb3IgKGkgPSBzdGFydDsgaSA8IGVuZDsgaSArPSBkaW0pCiAgICAgIGxhc3QgPSBpbnNlcnROb2RlKGksIGRhdGFbaV0sIGRhdGFbaSArIDFdLCBsYXN0KTsKICB9IGVsc2UgewogICAgZm9yIChpID0gZW5kIC0gZGltOyBpID49IHN0YXJ0OyBpIC09IGRpbSkKICAgICAgbGFzdCA9IGluc2VydE5vZGUoaSwgZGF0YVtpXSwgZGF0YVtpICsgMV0sIGxhc3QpOwogIH0KICBpZiAobGFzdCAmJiBlcXVhbHMobGFzdCwgbGFzdC5uZXh0KSkgewogICAgcmVtb3ZlTm9kZShsYXN0KTsKICAgIGxhc3QgPSBsYXN0Lm5leHQ7CiAgfQogIHJldHVybiBsYXN0Owp9CmZ1bmN0aW9uIGZpbHRlclBvaW50cyhzdGFydCwgZW5kKSB7CiAgaWYgKCFzdGFydCkKICAgIHJldHVybiBzdGFydDsKICBpZiAoIWVuZCkKICAgIGVuZCA9IHN0YXJ0OwogIGxldCBwID0gc3RhcnQsIGFnYWluOwogIGRvIHsKICAgIGFnYWluID0gZmFsc2U7CiAgICBpZiAoIXAuc3RlaW5lciAmJiAoZXF1YWxzKHAsIHAubmV4dCkgfHwgYXJlYShwLnByZXYsIHAsIHAubmV4dCkgPT09IDApKSB7CiAgICAgIHJlbW92ZU5vZGUocCk7CiAgICAgIHAgPSBlbmQgPSBwLnByZXY7CiAgICAgIGlmIChwID09PSBwLm5leHQpCiAgICAgICAgYnJlYWs7CiAgICAgIGFnYWluID0gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHAgPSBwLm5leHQ7CiAgICB9CiAgfSB3aGlsZSAoYWdhaW4gfHwgcCAhPT0gZW5kKTsKICByZXR1cm4gZW5kOwp9CmZ1bmN0aW9uIGVhcmN1dExpbmtlZChlYXIsIHRyaWFuZ2xlcywgZGltLCBtaW5YLCBtaW5ZLCBpbnZTaXplLCBwYXNzKSB7CiAgaWYgKCFlYXIpCiAgICByZXR1cm47CiAgaWYgKCFwYXNzICYmIGludlNpemUpCiAgICBpbmRleEN1cnZlKGVhciwgbWluWCwgbWluWSwgaW52U2l6ZSk7CiAgbGV0IHN0b3AgPSBlYXIsIHByZXYsIG5leHQ7CiAgd2hpbGUgKGVhci5wcmV2ICE9PSBlYXIubmV4dCkgewogICAgcHJldiA9IGVhci5wcmV2OwogICAgbmV4dCA9IGVhci5uZXh0OwogICAgaWYgKGludlNpemUgPyBpc0Vhckhhc2hlZChlYXIsIG1pblgsIG1pblksIGludlNpemUpIDogaXNFYXIoZWFyKSkgewogICAgICB0cmlhbmdsZXMucHVzaChwcmV2LmkgLyBkaW0pOwogICAgICB0cmlhbmdsZXMucHVzaChlYXIuaSAvIGRpbSk7CiAgICAgIHRyaWFuZ2xlcy5wdXNoKG5leHQuaSAvIGRpbSk7CiAgICAgIHJlbW92ZU5vZGUoZWFyKTsKICAgICAgZWFyID0gbmV4dC5uZXh0OwogICAgICBzdG9wID0gbmV4dC5uZXh0OwogICAgICBjb250aW51ZTsKICAgIH0KICAgIGVhciA9IG5leHQ7CiAgICBpZiAoZWFyID09PSBzdG9wKSB7CiAgICAgIGlmICghcGFzcykgewogICAgICAgIGVhcmN1dExpbmtlZChmaWx0ZXJQb2ludHMoZWFyKSwgdHJpYW5nbGVzLCBkaW0sIG1pblgsIG1pblksIGludlNpemUsIDEpOwogICAgICB9IGVsc2UgaWYgKHBhc3MgPT09IDEpIHsKICAgICAgICBlYXIgPSBjdXJlTG9jYWxJbnRlcnNlY3Rpb25zKGZpbHRlclBvaW50cyhlYXIpLCB0cmlhbmdsZXMsIGRpbSk7CiAgICAgICAgZWFyY3V0TGlua2VkKGVhciwgdHJpYW5nbGVzLCBkaW0sIG1pblgsIG1pblksIGludlNpemUsIDIpOwogICAgICB9IGVsc2UgaWYgKHBhc3MgPT09IDIpIHsKICAgICAgICBzcGxpdEVhcmN1dChlYXIsIHRyaWFuZ2xlcywgZGltLCBtaW5YLCBtaW5ZLCBpbnZTaXplKTsKICAgICAgfQogICAgICBicmVhazsKICAgIH0KICB9Cn0KZnVuY3Rpb24gaXNFYXIoZWFyKSB7CiAgY29uc3QgYSA9IGVhci5wcmV2LCBiID0gZWFyLCBjID0gZWFyLm5leHQ7CiAgaWYgKGFyZWEoYSwgYiwgYykgPj0gMCkKICAgIHJldHVybiBmYWxzZTsKICBsZXQgcCA9IGVhci5uZXh0Lm5leHQ7CiAgd2hpbGUgKHAgIT09IGVhci5wcmV2KSB7CiAgICBpZiAocG9pbnRJblRyaWFuZ2xlKGEueCwgYS55LCBiLngsIGIueSwgYy54LCBjLnksIHAueCwgcC55KSAmJiBhcmVhKHAucHJldiwgcCwgcC5uZXh0KSA+PSAwKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBwID0gcC5uZXh0OwogIH0KICByZXR1cm4gdHJ1ZTsKfQpmdW5jdGlvbiBpc0Vhckhhc2hlZChlYXIsIG1pblgsIG1pblksIGludlNpemUpIHsKICBjb25zdCBhID0gZWFyLnByZXYsIGIgPSBlYXIsIGMgPSBlYXIubmV4dDsKICBpZiAoYXJlYShhLCBiLCBjKSA+PSAwKQogICAgcmV0dXJuIGZhbHNlOwogIGNvbnN0IG1pblRYID0gYS54IDwgYi54ID8gYS54IDwgYy54ID8gYS54IDogYy54IDogYi54IDwgYy54ID8gYi54IDogYy54LCBtaW5UWSA9IGEueSA8IGIueSA/IGEueSA8IGMueSA/IGEueSA6IGMueSA6IGIueSA8IGMueSA/IGIueSA6IGMueSwgbWF4VFggPSBhLnggPiBiLnggPyBhLnggPiBjLnggPyBhLnggOiBjLnggOiBiLnggPiBjLnggPyBiLnggOiBjLngsIG1heFRZID0gYS55ID4gYi55ID8gYS55ID4gYy55ID8gYS55IDogYy55IDogYi55ID4gYy55ID8gYi55IDogYy55OwogIGNvbnN0IG1pblogPSB6T3JkZXIobWluVFgsIG1pblRZLCBtaW5YLCBtaW5ZLCBpbnZTaXplKSwgbWF4WiA9IHpPcmRlcihtYXhUWCwgbWF4VFksIG1pblgsIG1pblksIGludlNpemUpOwogIGxldCBwID0gZWFyLnByZXZaLCBuID0gZWFyLm5leHRaOwogIHdoaWxlIChwICYmIHAueiA+PSBtaW5aICYmIG4gJiYgbi56IDw9IG1heFopIHsKICAgIGlmIChwICE9PSBlYXIucHJldiAmJiBwICE9PSBlYXIubmV4dCAmJiBwb2ludEluVHJpYW5nbGUoYS54LCBhLnksIGIueCwgYi55LCBjLngsIGMueSwgcC54LCBwLnkpICYmIGFyZWEocC5wcmV2LCBwLCBwLm5leHQpID49IDApCiAgICAgIHJldHVybiBmYWxzZTsKICAgIHAgPSBwLnByZXZaOwogICAgaWYgKG4gIT09IGVhci5wcmV2ICYmIG4gIT09IGVhci5uZXh0ICYmIHBvaW50SW5UcmlhbmdsZShhLngsIGEueSwgYi54LCBiLnksIGMueCwgYy55LCBuLngsIG4ueSkgJiYgYXJlYShuLnByZXYsIG4sIG4ubmV4dCkgPj0gMCkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgbiA9IG4ubmV4dFo7CiAgfQogIHdoaWxlIChwICYmIHAueiA+PSBtaW5aKSB7CiAgICBpZiAocCAhPT0gZWFyLnByZXYgJiYgcCAhPT0gZWFyLm5leHQgJiYgcG9pbnRJblRyaWFuZ2xlKGEueCwgYS55LCBiLngsIGIueSwgYy54LCBjLnksIHAueCwgcC55KSAmJiBhcmVhKHAucHJldiwgcCwgcC5uZXh0KSA+PSAwKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBwID0gcC5wcmV2WjsKICB9CiAgd2hpbGUgKG4gJiYgbi56IDw9IG1heFopIHsKICAgIGlmIChuICE9PSBlYXIucHJldiAmJiBuICE9PSBlYXIubmV4dCAmJiBwb2ludEluVHJpYW5nbGUoYS54LCBhLnksIGIueCwgYi55LCBjLngsIGMueSwgbi54LCBuLnkpICYmIGFyZWEobi5wcmV2LCBuLCBuLm5leHQpID49IDApCiAgICAgIHJldHVybiBmYWxzZTsKICAgIG4gPSBuLm5leHRaOwogIH0KICByZXR1cm4gdHJ1ZTsKfQpmdW5jdGlvbiBjdXJlTG9jYWxJbnRlcnNlY3Rpb25zKHN0YXJ0LCB0cmlhbmdsZXMsIGRpbSkgewogIGxldCBwID0gc3RhcnQ7CiAgZG8gewogICAgY29uc3QgYSA9IHAucHJldiwgYiA9IHAubmV4dC5uZXh0OwogICAgaWYgKCFlcXVhbHMoYSwgYikgJiYgaW50ZXJzZWN0cyhhLCBwLCBwLm5leHQsIGIpICYmIGxvY2FsbHlJbnNpZGUoYSwgYikgJiYgbG9jYWxseUluc2lkZShiLCBhKSkgewogICAgICB0cmlhbmdsZXMucHVzaChhLmkgLyBkaW0pOwogICAgICB0cmlhbmdsZXMucHVzaChwLmkgLyBkaW0pOwogICAgICB0cmlhbmdsZXMucHVzaChiLmkgLyBkaW0pOwogICAgICByZW1vdmVOb2RlKHApOwogICAgICByZW1vdmVOb2RlKHAubmV4dCk7CiAgICAgIHAgPSBzdGFydCA9IGI7CiAgICB9CiAgICBwID0gcC5uZXh0OwogIH0gd2hpbGUgKHAgIT09IHN0YXJ0KTsKICByZXR1cm4gZmlsdGVyUG9pbnRzKHApOwp9CmZ1bmN0aW9uIHNwbGl0RWFyY3V0KHN0YXJ0LCB0cmlhbmdsZXMsIGRpbSwgbWluWCwgbWluWSwgaW52U2l6ZSkgewogIGxldCBhID0gc3RhcnQ7CiAgZG8gewogICAgbGV0IGIgPSBhLm5leHQubmV4dDsKICAgIHdoaWxlIChiICE9PSBhLnByZXYpIHsKICAgICAgaWYgKGEuaSAhPT0gYi5pICYmIGlzVmFsaWREaWFnb25hbChhLCBiKSkgewogICAgICAgIGxldCBjID0gc3BsaXRQb2x5Z29uKGEsIGIpOwogICAgICAgIGEgPSBmaWx0ZXJQb2ludHMoYSwgYS5uZXh0KTsKICAgICAgICBjID0gZmlsdGVyUG9pbnRzKGMsIGMubmV4dCk7CiAgICAgICAgZWFyY3V0TGlua2VkKGEsIHRyaWFuZ2xlcywgZGltLCBtaW5YLCBtaW5ZLCBpbnZTaXplKTsKICAgICAgICBlYXJjdXRMaW5rZWQoYywgdHJpYW5nbGVzLCBkaW0sIG1pblgsIG1pblksIGludlNpemUpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBiID0gYi5uZXh0OwogICAgfQogICAgYSA9IGEubmV4dDsKICB9IHdoaWxlIChhICE9PSBzdGFydCk7Cn0KZnVuY3Rpb24gZWxpbWluYXRlSG9sZXMoZGF0YSwgaG9sZUluZGljZXMsIG91dGVyTm9kZSwgZGltKSB7CiAgY29uc3QgcXVldWUgPSBbXTsKICBsZXQgaSwgbGVuLCBzdGFydCwgZW5kLCBsaXN0OwogIGZvciAoaSA9IDAsIGxlbiA9IGhvbGVJbmRpY2VzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICBzdGFydCA9IGhvbGVJbmRpY2VzW2ldICogZGltOwogICAgZW5kID0gaSA8IGxlbiAtIDEgPyBob2xlSW5kaWNlc1tpICsgMV0gKiBkaW0gOiBkYXRhLmxlbmd0aDsKICAgIGxpc3QgPSBsaW5rZWRMaXN0KGRhdGEsIHN0YXJ0LCBlbmQsIGRpbSwgZmFsc2UpOwogICAgaWYgKGxpc3QgPT09IGxpc3QubmV4dCkKICAgICAgbGlzdC5zdGVpbmVyID0gdHJ1ZTsKICAgIHF1ZXVlLnB1c2goZ2V0TGVmdG1vc3QobGlzdCkpOwogIH0KICBxdWV1ZS5zb3J0KGNvbXBhcmVYKTsKICBmb3IgKGkgPSAwOyBpIDwgcXVldWUubGVuZ3RoOyBpKyspIHsKICAgIGVsaW1pbmF0ZUhvbGUocXVldWVbaV0sIG91dGVyTm9kZSk7CiAgICBvdXRlck5vZGUgPSBmaWx0ZXJQb2ludHMob3V0ZXJOb2RlLCBvdXRlck5vZGUubmV4dCk7CiAgfQogIHJldHVybiBvdXRlck5vZGU7Cn0KZnVuY3Rpb24gY29tcGFyZVgoYSwgYikgewogIHJldHVybiBhLnggLSBiLng7Cn0KZnVuY3Rpb24gZWxpbWluYXRlSG9sZShob2xlLCBvdXRlck5vZGUpIHsKICBvdXRlck5vZGUgPSBmaW5kSG9sZUJyaWRnZShob2xlLCBvdXRlck5vZGUpOwogIGlmIChvdXRlck5vZGUpIHsKICAgIGNvbnN0IGIgPSBzcGxpdFBvbHlnb24ob3V0ZXJOb2RlLCBob2xlKTsKICAgIGZpbHRlclBvaW50cyhvdXRlck5vZGUsIG91dGVyTm9kZS5uZXh0KTsKICAgIGZpbHRlclBvaW50cyhiLCBiLm5leHQpOwogIH0KfQpmdW5jdGlvbiBmaW5kSG9sZUJyaWRnZShob2xlLCBvdXRlck5vZGUpIHsKICBsZXQgcCA9IG91dGVyTm9kZTsKICBjb25zdCBoeCA9IGhvbGUueDsKICBjb25zdCBoeSA9IGhvbGUueTsKICBsZXQgcXggPSAtSW5maW5pdHksIG07CiAgZG8gewogICAgaWYgKGh5IDw9IHAueSAmJiBoeSA+PSBwLm5leHQueSAmJiBwLm5leHQueSAhPT0gcC55KSB7CiAgICAgIGNvbnN0IHggPSBwLnggKyAoaHkgLSBwLnkpICogKHAubmV4dC54IC0gcC54KSAvIChwLm5leHQueSAtIHAueSk7CiAgICAgIGlmICh4IDw9IGh4ICYmIHggPiBxeCkgewogICAgICAgIHF4ID0geDsKICAgICAgICBpZiAoeCA9PT0gaHgpIHsKICAgICAgICAgIGlmIChoeSA9PT0gcC55KQogICAgICAgICAgICByZXR1cm4gcDsKICAgICAgICAgIGlmIChoeSA9PT0gcC5uZXh0LnkpCiAgICAgICAgICAgIHJldHVybiBwLm5leHQ7CiAgICAgICAgfQogICAgICAgIG0gPSBwLnggPCBwLm5leHQueCA/IHAgOiBwLm5leHQ7CiAgICAgIH0KICAgIH0KICAgIHAgPSBwLm5leHQ7CiAgfSB3aGlsZSAocCAhPT0gb3V0ZXJOb2RlKTsKICBpZiAoIW0pCiAgICByZXR1cm4gbnVsbDsKICBpZiAoaHggPT09IHF4KQogICAgcmV0dXJuIG07CiAgY29uc3Qgc3RvcCA9IG0sIG14ID0gbS54LCBteSA9IG0ueTsKICBsZXQgdGFuTWluID0gSW5maW5pdHksIHRhbjsKICBwID0gbTsKICBkbyB7CiAgICBpZiAoaHggPj0gcC54ICYmIHAueCA+PSBteCAmJiBoeCAhPT0gcC54ICYmIHBvaW50SW5UcmlhbmdsZShoeSA8IG15ID8gaHggOiBxeCwgaHksIG14LCBteSwgaHkgPCBteSA/IHF4IDogaHgsIGh5LCBwLngsIHAueSkpIHsKICAgICAgdGFuID0gTWF0aC5hYnMoaHkgLSBwLnkpIC8gKGh4IC0gcC54KTsKICAgICAgaWYgKGxvY2FsbHlJbnNpZGUocCwgaG9sZSkgJiYgKHRhbiA8IHRhbk1pbiB8fCB0YW4gPT09IHRhbk1pbiAmJiAocC54ID4gbS54IHx8IHAueCA9PT0gbS54ICYmIHNlY3RvckNvbnRhaW5zU2VjdG9yKG0sIHApKSkpIHsKICAgICAgICBtID0gcDsKICAgICAgICB0YW5NaW4gPSB0YW47CiAgICAgIH0KICAgIH0KICAgIHAgPSBwLm5leHQ7CiAgfSB3aGlsZSAocCAhPT0gc3RvcCk7CiAgcmV0dXJuIG07Cn0KZnVuY3Rpb24gc2VjdG9yQ29udGFpbnNTZWN0b3IobSwgcCkgewogIHJldHVybiBhcmVhKG0ucHJldiwgbSwgcC5wcmV2KSA8IDAgJiYgYXJlYShwLm5leHQsIG0sIG0ubmV4dCkgPCAwOwp9CmZ1bmN0aW9uIGluZGV4Q3VydmUoc3RhcnQsIG1pblgsIG1pblksIGludlNpemUpIHsKICBsZXQgcCA9IHN0YXJ0OwogIGRvIHsKICAgIGlmIChwLnogPT09IG51bGwpCiAgICAgIHAueiA9IHpPcmRlcihwLngsIHAueSwgbWluWCwgbWluWSwgaW52U2l6ZSk7CiAgICBwLnByZXZaID0gcC5wcmV2OwogICAgcC5uZXh0WiA9IHAubmV4dDsKICAgIHAgPSBwLm5leHQ7CiAgfSB3aGlsZSAocCAhPT0gc3RhcnQpOwogIHAucHJldloubmV4dFogPSBudWxsOwogIHAucHJldlogPSBudWxsOwogIHNvcnRMaW5rZWQocCk7Cn0KZnVuY3Rpb24gc29ydExpbmtlZChsaXN0KSB7CiAgbGV0IGksIHAsIHEsIGUsIHRhaWwsIG51bU1lcmdlcywgcFNpemUsIHFTaXplLCBpblNpemUgPSAxOwogIGRvIHsKICAgIHAgPSBsaXN0OwogICAgbGlzdCA9IG51bGw7CiAgICB0YWlsID0gbnVsbDsKICAgIG51bU1lcmdlcyA9IDA7CiAgICB3aGlsZSAocCkgewogICAgICBudW1NZXJnZXMrKzsKICAgICAgcSA9IHA7CiAgICAgIHBTaXplID0gMDsKICAgICAgZm9yIChpID0gMDsgaSA8IGluU2l6ZTsgaSsrKSB7CiAgICAgICAgcFNpemUrKzsKICAgICAgICBxID0gcS5uZXh0WjsKICAgICAgICBpZiAoIXEpCiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgICBxU2l6ZSA9IGluU2l6ZTsKICAgICAgd2hpbGUgKHBTaXplID4gMCB8fCBxU2l6ZSA+IDAgJiYgcSkgewogICAgICAgIGlmIChwU2l6ZSAhPT0gMCAmJiAocVNpemUgPT09IDAgfHwgIXEgfHwgcC56IDw9IHEueikpIHsKICAgICAgICAgIGUgPSBwOwogICAgICAgICAgcCA9IHAubmV4dFo7CiAgICAgICAgICBwU2l6ZS0tOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBlID0gcTsKICAgICAgICAgIHEgPSBxLm5leHRaOwogICAgICAgICAgcVNpemUtLTsKICAgICAgICB9CiAgICAgICAgaWYgKHRhaWwpCiAgICAgICAgICB0YWlsLm5leHRaID0gZTsKICAgICAgICBlbHNlCiAgICAgICAgICBsaXN0ID0gZTsKICAgICAgICBlLnByZXZaID0gdGFpbDsKICAgICAgICB0YWlsID0gZTsKICAgICAgfQogICAgICBwID0gcTsKICAgIH0KICAgIHRhaWwubmV4dFogPSBudWxsOwogICAgaW5TaXplICo9IDI7CiAgfSB3aGlsZSAobnVtTWVyZ2VzID4gMSk7CiAgcmV0dXJuIGxpc3Q7Cn0KZnVuY3Rpb24gek9yZGVyKHgsIHksIG1pblgsIG1pblksIGludlNpemUpIHsKICB4ID0gMzI3NjcgKiAoeCAtIG1pblgpICogaW52U2l6ZTsKICB5ID0gMzI3NjcgKiAoeSAtIG1pblkpICogaW52U2l6ZTsKICB4ID0gKHggfCB4IDw8IDgpICYgMTY3MTE5MzU7CiAgeCA9ICh4IHwgeCA8PCA0KSAmIDI1MjY0NTEzNTsKICB4ID0gKHggfCB4IDw8IDIpICYgODU4OTkzNDU5OwogIHggPSAoeCB8IHggPDwgMSkgJiAxNDMxNjU1NzY1OwogIHkgPSAoeSB8IHkgPDwgOCkgJiAxNjcxMTkzNTsKICB5ID0gKHkgfCB5IDw8IDQpICYgMjUyNjQ1MTM1OwogIHkgPSAoeSB8IHkgPDwgMikgJiA4NTg5OTM0NTk7CiAgeSA9ICh5IHwgeSA8PCAxKSAmIDE0MzE2NTU3NjU7CiAgcmV0dXJuIHggfCB5IDw8IDE7Cn0KZnVuY3Rpb24gZ2V0TGVmdG1vc3Qoc3RhcnQpIHsKICBsZXQgcCA9IHN0YXJ0LCBsZWZ0bW9zdCA9IHN0YXJ0OwogIGRvIHsKICAgIGlmIChwLnggPCBsZWZ0bW9zdC54IHx8IHAueCA9PT0gbGVmdG1vc3QueCAmJiBwLnkgPCBsZWZ0bW9zdC55KQogICAgICBsZWZ0bW9zdCA9IHA7CiAgICBwID0gcC5uZXh0OwogIH0gd2hpbGUgKHAgIT09IHN0YXJ0KTsKICByZXR1cm4gbGVmdG1vc3Q7Cn0KZnVuY3Rpb24gcG9pbnRJblRyaWFuZ2xlKGF4LCBheSwgYngsIGJ5LCBjeCwgY3ksIHB4MiwgcHkyKSB7CiAgcmV0dXJuIChjeCAtIHB4MikgKiAoYXkgLSBweTIpIC0gKGF4IC0gcHgyKSAqIChjeSAtIHB5MikgPj0gMCAmJiAoYXggLSBweDIpICogKGJ5IC0gcHkyKSAtIChieCAtIHB4MikgKiAoYXkgLSBweTIpID49IDAgJiYgKGJ4IC0gcHgyKSAqIChjeSAtIHB5MikgLSAoY3ggLSBweDIpICogKGJ5IC0gcHkyKSA+PSAwOwp9CmZ1bmN0aW9uIGlzVmFsaWREaWFnb25hbChhLCBiKSB7CiAgcmV0dXJuIGEubmV4dC5pICE9PSBiLmkgJiYgYS5wcmV2LmkgIT09IGIuaSAmJiAhaW50ZXJzZWN0c1BvbHlnb24oYSwgYikgJiYgKGxvY2FsbHlJbnNpZGUoYSwgYikgJiYgbG9jYWxseUluc2lkZShiLCBhKSAmJiBtaWRkbGVJbnNpZGUoYSwgYikgJiYgKGFyZWEoYS5wcmV2LCBhLCBiLnByZXYpIHx8IGFyZWEoYSwgYi5wcmV2LCBiKSkgfHwgZXF1YWxzKGEsIGIpICYmIGFyZWEoYS5wcmV2LCBhLCBhLm5leHQpID4gMCAmJiBhcmVhKGIucHJldiwgYiwgYi5uZXh0KSA+IDApOwp9CmZ1bmN0aW9uIGFyZWEocCwgcSwgcikgewogIHJldHVybiAocS55IC0gcC55KSAqIChyLnggLSBxLngpIC0gKHEueCAtIHAueCkgKiAoci55IC0gcS55KTsKfQpmdW5jdGlvbiBlcXVhbHMocDEsIHAyKSB7CiAgcmV0dXJuIHAxLnggPT09IHAyLnggJiYgcDEueSA9PT0gcDIueTsKfQpmdW5jdGlvbiBpbnRlcnNlY3RzKHAxLCBxMSwgcDIsIHEyKSB7CiAgY29uc3QgbzEgPSBzaWduKGFyZWEocDEsIHExLCBwMikpOwogIGNvbnN0IG8yID0gc2lnbihhcmVhKHAxLCBxMSwgcTIpKTsKICBjb25zdCBvMyA9IHNpZ24oYXJlYShwMiwgcTIsIHAxKSk7CiAgY29uc3QgbzQgPSBzaWduKGFyZWEocDIsIHEyLCBxMSkpOwogIGlmIChvMSAhPT0gbzIgJiYgbzMgIT09IG80KQogICAgcmV0dXJuIHRydWU7CiAgaWYgKG8xID09PSAwICYmIG9uU2VnbWVudChwMSwgcDIsIHExKSkKICAgIHJldHVybiB0cnVlOwogIGlmIChvMiA9PT0gMCAmJiBvblNlZ21lbnQocDEsIHEyLCBxMSkpCiAgICByZXR1cm4gdHJ1ZTsKICBpZiAobzMgPT09IDAgJiYgb25TZWdtZW50KHAyLCBwMSwgcTIpKQogICAgcmV0dXJuIHRydWU7CiAgaWYgKG80ID09PSAwICYmIG9uU2VnbWVudChwMiwgcTEsIHEyKSkKICAgIHJldHVybiB0cnVlOwogIHJldHVybiBmYWxzZTsKfQpmdW5jdGlvbiBvblNlZ21lbnQocCwgcSwgcikgewogIHJldHVybiBxLnggPD0gTWF0aC5tYXgocC54LCByLngpICYmIHEueCA+PSBNYXRoLm1pbihwLngsIHIueCkgJiYgcS55IDw9IE1hdGgubWF4KHAueSwgci55KSAmJiBxLnkgPj0gTWF0aC5taW4ocC55LCByLnkpOwp9CmZ1bmN0aW9uIHNpZ24obnVtKSB7CiAgcmV0dXJuIG51bSA+IDAgPyAxIDogbnVtIDwgMCA/IC0xIDogMDsKfQpmdW5jdGlvbiBpbnRlcnNlY3RzUG9seWdvbihhLCBiKSB7CiAgbGV0IHAgPSBhOwogIGRvIHsKICAgIGlmIChwLmkgIT09IGEuaSAmJiBwLm5leHQuaSAhPT0gYS5pICYmIHAuaSAhPT0gYi5pICYmIHAubmV4dC5pICE9PSBiLmkgJiYgaW50ZXJzZWN0cyhwLCBwLm5leHQsIGEsIGIpKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIHAgPSBwLm5leHQ7CiAgfSB3aGlsZSAocCAhPT0gYSk7CiAgcmV0dXJuIGZhbHNlOwp9CmZ1bmN0aW9uIGxvY2FsbHlJbnNpZGUoYSwgYikgewogIHJldHVybiBhcmVhKGEucHJldiwgYSwgYS5uZXh0KSA8IDAgPyBhcmVhKGEsIGIsIGEubmV4dCkgPj0gMCAmJiBhcmVhKGEsIGEucHJldiwgYikgPj0gMCA6IGFyZWEoYSwgYiwgYS5wcmV2KSA8IDAgfHwgYXJlYShhLCBhLm5leHQsIGIpIDwgMDsKfQpmdW5jdGlvbiBtaWRkbGVJbnNpZGUoYSwgYikgewogIGxldCBwID0gYSwgaW5zaWRlID0gZmFsc2U7CiAgY29uc3QgcHgyID0gKGEueCArIGIueCkgLyAyLCBweTIgPSAoYS55ICsgYi55KSAvIDI7CiAgZG8gewogICAgaWYgKHAueSA+IHB5MiAhPT0gcC5uZXh0LnkgPiBweTIgJiYgcC5uZXh0LnkgIT09IHAueSAmJiBweDIgPCAocC5uZXh0LnggLSBwLngpICogKHB5MiAtIHAueSkgLyAocC5uZXh0LnkgLSBwLnkpICsgcC54KQogICAgICBpbnNpZGUgPSAhaW5zaWRlOwogICAgcCA9IHAubmV4dDsKICB9IHdoaWxlIChwICE9PSBhKTsKICByZXR1cm4gaW5zaWRlOwp9CmZ1bmN0aW9uIHNwbGl0UG9seWdvbihhLCBiKSB7CiAgY29uc3QgYTIgPSBuZXcgTm9kZShhLmksIGEueCwgYS55KSwgYjIgPSBuZXcgTm9kZShiLmksIGIueCwgYi55KSwgYW4gPSBhLm5leHQsIGJwID0gYi5wcmV2OwogIGEubmV4dCA9IGI7CiAgYi5wcmV2ID0gYTsKICBhMi5uZXh0ID0gYW47CiAgYW4ucHJldiA9IGEyOwogIGIyLm5leHQgPSBhMjsKICBhMi5wcmV2ID0gYjI7CiAgYnAubmV4dCA9IGIyOwogIGIyLnByZXYgPSBicDsKICByZXR1cm4gYjI7Cn0KZnVuY3Rpb24gaW5zZXJ0Tm9kZShpLCB4LCB5LCBsYXN0KSB7CiAgY29uc3QgcCA9IG5ldyBOb2RlKGksIHgsIHkpOwogIGlmICghbGFzdCkgewogICAgcC5wcmV2ID0gcDsKICAgIHAubmV4dCA9IHA7CiAgfSBlbHNlIHsKICAgIHAubmV4dCA9IGxhc3QubmV4dDsKICAgIHAucHJldiA9IGxhc3Q7CiAgICBsYXN0Lm5leHQucHJldiA9IHA7CiAgICBsYXN0Lm5leHQgPSBwOwogIH0KICByZXR1cm4gcDsKfQpmdW5jdGlvbiByZW1vdmVOb2RlKHApIHsKICBwLm5leHQucHJldiA9IHAucHJldjsKICBwLnByZXYubmV4dCA9IHAubmV4dDsKICBpZiAocC5wcmV2WikKICAgIHAucHJldloubmV4dFogPSBwLm5leHRaOwogIGlmIChwLm5leHRaKQogICAgcC5uZXh0Wi5wcmV2WiA9IHAucHJldlo7Cn0KZnVuY3Rpb24gTm9kZShpLCB4LCB5KSB7CiAgdGhpcy5pID0gaTsKICB0aGlzLnggPSB4OwogIHRoaXMueSA9IHk7CiAgdGhpcy5wcmV2ID0gbnVsbDsKICB0aGlzLm5leHQgPSBudWxsOwogIHRoaXMueiA9IG51bGw7CiAgdGhpcy5wcmV2WiA9IG51bGw7CiAgdGhpcy5uZXh0WiA9IG51bGw7CiAgdGhpcy5zdGVpbmVyID0gZmFsc2U7Cn0KZnVuY3Rpb24gc2lnbmVkQXJlYShkYXRhLCBzdGFydCwgZW5kLCBkaW0pIHsKICBsZXQgc3VtID0gMDsKICBmb3IgKGxldCBpID0gc3RhcnQsIGogPSBlbmQgLSBkaW07IGkgPCBlbmQ7IGkgKz0gZGltKSB7CiAgICBzdW0gKz0gKGRhdGFbal0gLSBkYXRhW2ldKSAqIChkYXRhW2kgKyAxXSArIGRhdGFbaiArIDFdKTsKICAgIGogPSBpOwogIH0KICByZXR1cm4gc3VtOwp9CmNsYXNzIFNoYXBlVXRpbHMgewogIHN0YXRpYyBhcmVhKGNvbnRvdXIpIHsKICAgIGNvbnN0IG4gPSBjb250b3VyLmxlbmd0aDsKICAgIGxldCBhID0gMDsKICAgIGZvciAobGV0IHAgPSBuIC0gMSwgcSA9IDA7IHEgPCBuOyBwID0gcSsrKSB7CiAgICAgIGEgKz0gY29udG91cltwXS54ICogY29udG91cltxXS55IC0gY29udG91cltxXS54ICogY29udG91cltwXS55OwogICAgfQogICAgcmV0dXJuIGEgKiAwLjU7CiAgfQogIHN0YXRpYyBpc0Nsb2NrV2lzZShwdHMpIHsKICAgIHJldHVybiBTaGFwZVV0aWxzLmFyZWEocHRzKSA8IDA7CiAgfQogIHN0YXRpYyB0cmlhbmd1bGF0ZVNoYXBlKGNvbnRvdXIsIGhvbGVzKSB7CiAgICBjb25zdCB2ZXJ0aWNlcyA9IFtdOwogICAgY29uc3QgaG9sZUluZGljZXMgPSBbXTsKICAgIGNvbnN0IGZhY2VzID0gW107CiAgICByZW1vdmVEdXBFbmRQdHMoY29udG91cik7CiAgICBhZGRDb250b3VyKHZlcnRpY2VzLCBjb250b3VyKTsKICAgIGxldCBob2xlSW5kZXggPSBjb250b3VyLmxlbmd0aDsKICAgIGhvbGVzLmZvckVhY2gocmVtb3ZlRHVwRW5kUHRzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaG9sZXMubGVuZ3RoOyBpKyspIHsKICAgICAgaG9sZUluZGljZXMucHVzaChob2xlSW5kZXgpOwogICAgICBob2xlSW5kZXggKz0gaG9sZXNbaV0ubGVuZ3RoOwogICAgICBhZGRDb250b3VyKHZlcnRpY2VzLCBob2xlc1tpXSk7CiAgICB9CiAgICBjb25zdCB0cmlhbmdsZXMgPSBFYXJjdXQudHJpYW5ndWxhdGUodmVydGljZXMsIGhvbGVJbmRpY2VzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJpYW5nbGVzLmxlbmd0aDsgaSArPSAzKSB7CiAgICAgIGZhY2VzLnB1c2godHJpYW5nbGVzLnNsaWNlKGksIGkgKyAzKSk7CiAgICB9CiAgICByZXR1cm4gZmFjZXM7CiAgfQp9CmZ1bmN0aW9uIHJlbW92ZUR1cEVuZFB0cyhwb2ludHMpIHsKICBjb25zdCBsID0gcG9pbnRzLmxlbmd0aDsKICBpZiAobCA+IDIgJiYgcG9pbnRzW2wgLSAxXS5lcXVhbHMocG9pbnRzWzBdKSkgewogICAgcG9pbnRzLnBvcCgpOwogIH0KfQpmdW5jdGlvbiBhZGRDb250b3VyKHZlcnRpY2VzLCBjb250b3VyKSB7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb250b3VyLmxlbmd0aDsgaSsrKSB7CiAgICB2ZXJ0aWNlcy5wdXNoKGNvbnRvdXJbaV0ueCk7CiAgICB2ZXJ0aWNlcy5wdXNoKGNvbnRvdXJbaV0ueSk7CiAgfQp9CmNsYXNzIEV4dHJ1ZGVHZW9tZXRyeSBleHRlbmRzIEJ1ZmZlckdlb21ldHJ5IHsKICBjb25zdHJ1Y3RvcihzaGFwZXMgPSBuZXcgU2hhcGUoW25ldyBWZWN0b3IyKDAuNSwgMC41KSwgbmV3IFZlY3RvcjIoLTAuNSwgMC41KSwgbmV3IFZlY3RvcjIoLTAuNSwgLTAuNSksIG5ldyBWZWN0b3IyKDAuNSwgLTAuNSldKSwgb3B0aW9ucyA9IHt9KSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkV4dHJ1ZGVHZW9tZXRyeSI7CiAgICB0aGlzLnBhcmFtZXRlcnMgPSB7CiAgICAgIHNoYXBlcywKICAgICAgb3B0aW9ucwogICAgfTsKICAgIHNoYXBlcyA9IEFycmF5LmlzQXJyYXkoc2hhcGVzKSA/IHNoYXBlcyA6IFtzaGFwZXNdOwogICAgY29uc3Qgc2NvcGUgPSB0aGlzOwogICAgY29uc3QgdmVydGljZXNBcnJheSA9IFtdOwogICAgY29uc3QgdXZBcnJheSA9IFtdOwogICAgZm9yIChsZXQgaSA9IDAsIGwgPSBzaGFwZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW2ldOwogICAgICBhZGRTaGFwZShzaGFwZSk7CiAgICB9CiAgICB0aGlzLnNldEF0dHJpYnV0ZSgicG9zaXRpb24iLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh2ZXJ0aWNlc0FycmF5LCAzKSk7CiAgICB0aGlzLnNldEF0dHJpYnV0ZSgidXYiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh1dkFycmF5LCAyKSk7CiAgICB0aGlzLmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCk7CiAgICBmdW5jdGlvbiBhZGRTaGFwZShzaGFwZSkgewogICAgICBjb25zdCBwbGFjZWhvbGRlciA9IFtdOwogICAgICBjb25zdCBjdXJ2ZVNlZ21lbnRzID0gb3B0aW9ucy5jdXJ2ZVNlZ21lbnRzICE9PSB2b2lkIDAgPyBvcHRpb25zLmN1cnZlU2VnbWVudHMgOiAxMjsKICAgICAgY29uc3Qgc3RlcHMgPSBvcHRpb25zLnN0ZXBzICE9PSB2b2lkIDAgPyBvcHRpb25zLnN0ZXBzIDogMTsKICAgICAgbGV0IGRlcHRoID0gb3B0aW9ucy5kZXB0aCAhPT0gdm9pZCAwID8gb3B0aW9ucy5kZXB0aCA6IDE7CiAgICAgIGxldCBiZXZlbEVuYWJsZWQgPSBvcHRpb25zLmJldmVsRW5hYmxlZCAhPT0gdm9pZCAwID8gb3B0aW9ucy5iZXZlbEVuYWJsZWQgOiB0cnVlOwogICAgICBsZXQgYmV2ZWxUaGlja25lc3MgPSBvcHRpb25zLmJldmVsVGhpY2tuZXNzICE9PSB2b2lkIDAgPyBvcHRpb25zLmJldmVsVGhpY2tuZXNzIDogMC4yOwogICAgICBsZXQgYmV2ZWxTaXplID0gb3B0aW9ucy5iZXZlbFNpemUgIT09IHZvaWQgMCA/IG9wdGlvbnMuYmV2ZWxTaXplIDogYmV2ZWxUaGlja25lc3MgLSAwLjE7CiAgICAgIGxldCBiZXZlbE9mZnNldCA9IG9wdGlvbnMuYmV2ZWxPZmZzZXQgIT09IHZvaWQgMCA/IG9wdGlvbnMuYmV2ZWxPZmZzZXQgOiAwOwogICAgICBsZXQgYmV2ZWxTZWdtZW50cyA9IG9wdGlvbnMuYmV2ZWxTZWdtZW50cyAhPT0gdm9pZCAwID8gb3B0aW9ucy5iZXZlbFNlZ21lbnRzIDogMzsKICAgICAgY29uc3QgZXh0cnVkZVBhdGggPSBvcHRpb25zLmV4dHJ1ZGVQYXRoOwogICAgICBjb25zdCB1dmdlbiA9IG9wdGlvbnMuVVZHZW5lcmF0b3IgIT09IHZvaWQgMCA/IG9wdGlvbnMuVVZHZW5lcmF0b3IgOiBXb3JsZFVWR2VuZXJhdG9yOwogICAgICBpZiAob3B0aW9ucy5hbW91bnQgIT09IHZvaWQgMCkgewogICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuRXh0cnVkZUJ1ZmZlckdlb21ldHJ5OiBhbW91bnQgaGFzIGJlZW4gcmVuYW1lZCB0byBkZXB0aC4iKTsKICAgICAgICBkZXB0aCA9IG9wdGlvbnMuYW1vdW50OwogICAgICB9CiAgICAgIGxldCBleHRydWRlUHRzLCBleHRydWRlQnlQYXRoID0gZmFsc2U7CiAgICAgIGxldCBzcGxpbmVUdWJlLCBiaW5vcm1hbCwgbm9ybWFsLCBwb3NpdGlvbjI7CiAgICAgIGlmIChleHRydWRlUGF0aCkgewogICAgICAgIGV4dHJ1ZGVQdHMgPSBleHRydWRlUGF0aC5nZXRTcGFjZWRQb2ludHMoc3RlcHMpOwogICAgICAgIGV4dHJ1ZGVCeVBhdGggPSB0cnVlOwogICAgICAgIGJldmVsRW5hYmxlZCA9IGZhbHNlOwogICAgICAgIHNwbGluZVR1YmUgPSBleHRydWRlUGF0aC5jb21wdXRlRnJlbmV0RnJhbWVzKHN0ZXBzLCBmYWxzZSk7CiAgICAgICAgYmlub3JtYWwgPSBuZXcgVmVjdG9yMygpOwogICAgICAgIG5vcm1hbCA9IG5ldyBWZWN0b3IzKCk7CiAgICAgICAgcG9zaXRpb24yID0gbmV3IFZlY3RvcjMoKTsKICAgICAgfQogICAgICBpZiAoIWJldmVsRW5hYmxlZCkgewogICAgICAgIGJldmVsU2VnbWVudHMgPSAwOwogICAgICAgIGJldmVsVGhpY2tuZXNzID0gMDsKICAgICAgICBiZXZlbFNpemUgPSAwOwogICAgICAgIGJldmVsT2Zmc2V0ID0gMDsKICAgICAgfQogICAgICBjb25zdCBzaGFwZVBvaW50cyA9IHNoYXBlLmV4dHJhY3RQb2ludHMoY3VydmVTZWdtZW50cyk7CiAgICAgIGxldCB2ZXJ0aWNlcyA9IHNoYXBlUG9pbnRzLnNoYXBlOwogICAgICBjb25zdCBob2xlcyA9IHNoYXBlUG9pbnRzLmhvbGVzOwogICAgICBjb25zdCByZXZlcnNlID0gIVNoYXBlVXRpbHMuaXNDbG9ja1dpc2UodmVydGljZXMpOwogICAgICBpZiAocmV2ZXJzZSkgewogICAgICAgIHZlcnRpY2VzID0gdmVydGljZXMucmV2ZXJzZSgpOwogICAgICAgIGZvciAobGV0IGggPSAwLCBobCA9IGhvbGVzLmxlbmd0aDsgaCA8IGhsOyBoKyspIHsKICAgICAgICAgIGNvbnN0IGFob2xlID0gaG9sZXNbaF07CiAgICAgICAgICBpZiAoU2hhcGVVdGlscy5pc0Nsb2NrV2lzZShhaG9sZSkpIHsKICAgICAgICAgICAgaG9sZXNbaF0gPSBhaG9sZS5yZXZlcnNlKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbnN0IGZhY2VzID0gU2hhcGVVdGlscy50cmlhbmd1bGF0ZVNoYXBlKHZlcnRpY2VzLCBob2xlcyk7CiAgICAgIGNvbnN0IGNvbnRvdXIgPSB2ZXJ0aWNlczsKICAgICAgZm9yIChsZXQgaCA9IDAsIGhsID0gaG9sZXMubGVuZ3RoOyBoIDwgaGw7IGgrKykgewogICAgICAgIGNvbnN0IGFob2xlID0gaG9sZXNbaF07CiAgICAgICAgdmVydGljZXMgPSB2ZXJ0aWNlcy5jb25jYXQoYWhvbGUpOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIHNjYWxlUHQyKHB0LCB2ZWMsIHNpemUpIHsKICAgICAgICBpZiAoIXZlYykKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLkV4dHJ1ZGVHZW9tZXRyeTogdmVjIGRvZXMgbm90IGV4aXN0Iik7CiAgICAgICAgcmV0dXJuIHZlYy5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLmFkZChwdCk7CiAgICAgIH0KICAgICAgY29uc3QgdmxlbiA9IHZlcnRpY2VzLmxlbmd0aCwgZmxlbiA9IGZhY2VzLmxlbmd0aDsKICAgICAgZnVuY3Rpb24gZ2V0QmV2ZWxWZWMoaW5QdCwgaW5QcmV2LCBpbk5leHQpIHsKICAgICAgICBsZXQgdl90cmFuc194LCB2X3RyYW5zX3ksIHNocmlua19ieTsKICAgICAgICBjb25zdCB2X3ByZXZfeCA9IGluUHQueCAtIGluUHJldi54LCB2X3ByZXZfeSA9IGluUHQueSAtIGluUHJldi55OwogICAgICAgIGNvbnN0IHZfbmV4dF94ID0gaW5OZXh0LnggLSBpblB0LngsIHZfbmV4dF95ID0gaW5OZXh0LnkgLSBpblB0Lnk7CiAgICAgICAgY29uc3Qgdl9wcmV2X2xlbnNxID0gdl9wcmV2X3ggKiB2X3ByZXZfeCArIHZfcHJldl95ICogdl9wcmV2X3k7CiAgICAgICAgY29uc3QgY29sbGluZWFyMCA9IHZfcHJldl94ICogdl9uZXh0X3kgLSB2X3ByZXZfeSAqIHZfbmV4dF94OwogICAgICAgIGlmIChNYXRoLmFicyhjb2xsaW5lYXIwKSA+IE51bWJlci5FUFNJTE9OKSB7CiAgICAgICAgICBjb25zdCB2X3ByZXZfbGVuID0gTWF0aC5zcXJ0KHZfcHJldl9sZW5zcSk7CiAgICAgICAgICBjb25zdCB2X25leHRfbGVuID0gTWF0aC5zcXJ0KHZfbmV4dF94ICogdl9uZXh0X3ggKyB2X25leHRfeSAqIHZfbmV4dF95KTsKICAgICAgICAgIGNvbnN0IHB0UHJldlNoaWZ0X3ggPSBpblByZXYueCAtIHZfcHJldl95IC8gdl9wcmV2X2xlbjsKICAgICAgICAgIGNvbnN0IHB0UHJldlNoaWZ0X3kgPSBpblByZXYueSArIHZfcHJldl94IC8gdl9wcmV2X2xlbjsKICAgICAgICAgIGNvbnN0IHB0TmV4dFNoaWZ0X3ggPSBpbk5leHQueCAtIHZfbmV4dF95IC8gdl9uZXh0X2xlbjsKICAgICAgICAgIGNvbnN0IHB0TmV4dFNoaWZ0X3kgPSBpbk5leHQueSArIHZfbmV4dF94IC8gdl9uZXh0X2xlbjsKICAgICAgICAgIGNvbnN0IHNmID0gKChwdE5leHRTaGlmdF94IC0gcHRQcmV2U2hpZnRfeCkgKiB2X25leHRfeSAtIChwdE5leHRTaGlmdF95IC0gcHRQcmV2U2hpZnRfeSkgKiB2X25leHRfeCkgLyAodl9wcmV2X3ggKiB2X25leHRfeSAtIHZfcHJldl95ICogdl9uZXh0X3gpOwogICAgICAgICAgdl90cmFuc194ID0gcHRQcmV2U2hpZnRfeCArIHZfcHJldl94ICogc2YgLSBpblB0Lng7CiAgICAgICAgICB2X3RyYW5zX3kgPSBwdFByZXZTaGlmdF95ICsgdl9wcmV2X3kgKiBzZiAtIGluUHQueTsKICAgICAgICAgIGNvbnN0IHZfdHJhbnNfbGVuc3EgPSB2X3RyYW5zX3ggKiB2X3RyYW5zX3ggKyB2X3RyYW5zX3kgKiB2X3RyYW5zX3k7CiAgICAgICAgICBpZiAodl90cmFuc19sZW5zcSA8PSAyKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgVmVjdG9yMih2X3RyYW5zX3gsIHZfdHJhbnNfeSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzaHJpbmtfYnkgPSBNYXRoLnNxcnQodl90cmFuc19sZW5zcSAvIDIpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBsZXQgZGlyZWN0aW9uX2VxID0gZmFsc2U7CiAgICAgICAgICBpZiAodl9wcmV2X3ggPiBOdW1iZXIuRVBTSUxPTikgewogICAgICAgICAgICBpZiAodl9uZXh0X3ggPiBOdW1iZXIuRVBTSUxPTikgewogICAgICAgICAgICAgIGRpcmVjdGlvbl9lcSA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh2X3ByZXZfeCA8IC1OdW1iZXIuRVBTSUxPTikgewogICAgICAgICAgICAgIGlmICh2X25leHRfeCA8IC1OdW1iZXIuRVBTSUxPTikgewogICAgICAgICAgICAgICAgZGlyZWN0aW9uX2VxID0gdHJ1ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaWYgKE1hdGguc2lnbih2X3ByZXZfeSkgPT09IE1hdGguc2lnbih2X25leHRfeSkpIHsKICAgICAgICAgICAgICAgIGRpcmVjdGlvbl9lcSA9IHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoZGlyZWN0aW9uX2VxKSB7CiAgICAgICAgICAgIHZfdHJhbnNfeCA9IC12X3ByZXZfeTsKICAgICAgICAgICAgdl90cmFuc195ID0gdl9wcmV2X3g7CiAgICAgICAgICAgIHNocmlua19ieSA9IE1hdGguc3FydCh2X3ByZXZfbGVuc3EpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdl90cmFuc194ID0gdl9wcmV2X3g7CiAgICAgICAgICAgIHZfdHJhbnNfeSA9IHZfcHJldl95OwogICAgICAgICAgICBzaHJpbmtfYnkgPSBNYXRoLnNxcnQodl9wcmV2X2xlbnNxIC8gMik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXcgVmVjdG9yMih2X3RyYW5zX3ggLyBzaHJpbmtfYnksIHZfdHJhbnNfeSAvIHNocmlua19ieSk7CiAgICAgIH0KICAgICAgY29uc3QgY29udG91ck1vdmVtZW50cyA9IFtdOwogICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBjb250b3VyLmxlbmd0aCwgaiA9IGlsIC0gMSwgayA9IGkgKyAxOyBpIDwgaWw7IGkrKywgaisrLCBrKyspIHsKICAgICAgICBpZiAoaiA9PT0gaWwpCiAgICAgICAgICBqID0gMDsKICAgICAgICBpZiAoayA9PT0gaWwpCiAgICAgICAgICBrID0gMDsKICAgICAgICBjb250b3VyTW92ZW1lbnRzW2ldID0gZ2V0QmV2ZWxWZWMoY29udG91cltpXSwgY29udG91cltqXSwgY29udG91cltrXSk7CiAgICAgIH0KICAgICAgY29uc3QgaG9sZXNNb3ZlbWVudHMgPSBbXTsKICAgICAgbGV0IG9uZUhvbGVNb3ZlbWVudHMsIHZlcnRpY2VzTW92ZW1lbnRzID0gY29udG91ck1vdmVtZW50cy5jb25jYXQoKTsKICAgICAgZm9yIChsZXQgaCA9IDAsIGhsID0gaG9sZXMubGVuZ3RoOyBoIDwgaGw7IGgrKykgewogICAgICAgIGNvbnN0IGFob2xlID0gaG9sZXNbaF07CiAgICAgICAgb25lSG9sZU1vdmVtZW50cyA9IFtdOwogICAgICAgIGZvciAobGV0IGkgPSAwLCBpbCA9IGFob2xlLmxlbmd0aCwgaiA9IGlsIC0gMSwgayA9IGkgKyAxOyBpIDwgaWw7IGkrKywgaisrLCBrKyspIHsKICAgICAgICAgIGlmIChqID09PSBpbCkKICAgICAgICAgICAgaiA9IDA7CiAgICAgICAgICBpZiAoayA9PT0gaWwpCiAgICAgICAgICAgIGsgPSAwOwogICAgICAgICAgb25lSG9sZU1vdmVtZW50c1tpXSA9IGdldEJldmVsVmVjKGFob2xlW2ldLCBhaG9sZVtqXSwgYWhvbGVba10pOwogICAgICAgIH0KICAgICAgICBob2xlc01vdmVtZW50cy5wdXNoKG9uZUhvbGVNb3ZlbWVudHMpOwogICAgICAgIHZlcnRpY2VzTW92ZW1lbnRzID0gdmVydGljZXNNb3ZlbWVudHMuY29uY2F0KG9uZUhvbGVNb3ZlbWVudHMpOwogICAgICB9CiAgICAgIGZvciAobGV0IGIgPSAwOyBiIDwgYmV2ZWxTZWdtZW50czsgYisrKSB7CiAgICAgICAgY29uc3QgdCA9IGIgLyBiZXZlbFNlZ21lbnRzOwogICAgICAgIGNvbnN0IHogPSBiZXZlbFRoaWNrbmVzcyAqIE1hdGguY29zKHQgKiBNYXRoLlBJIC8gMik7CiAgICAgICAgY29uc3QgYnMyID0gYmV2ZWxTaXplICogTWF0aC5zaW4odCAqIE1hdGguUEkgLyAyKSArIGJldmVsT2Zmc2V0OwogICAgICAgIGZvciAobGV0IGkgPSAwLCBpbCA9IGNvbnRvdXIubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICAgICAgY29uc3QgdmVydCA9IHNjYWxlUHQyKGNvbnRvdXJbaV0sIGNvbnRvdXJNb3ZlbWVudHNbaV0sIGJzMik7CiAgICAgICAgICB2KHZlcnQueCwgdmVydC55LCAteik7CiAgICAgICAgfQogICAgICAgIGZvciAobGV0IGggPSAwLCBobCA9IGhvbGVzLmxlbmd0aDsgaCA8IGhsOyBoKyspIHsKICAgICAgICAgIGNvbnN0IGFob2xlID0gaG9sZXNbaF07CiAgICAgICAgICBvbmVIb2xlTW92ZW1lbnRzID0gaG9sZXNNb3ZlbWVudHNbaF07CiAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBhaG9sZS5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IHZlcnQgPSBzY2FsZVB0MihhaG9sZVtpXSwgb25lSG9sZU1vdmVtZW50c1tpXSwgYnMyKTsKICAgICAgICAgICAgdih2ZXJ0LngsIHZlcnQueSwgLXopOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBjb25zdCBicyA9IGJldmVsU2l6ZSArIGJldmVsT2Zmc2V0OwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZsZW47IGkrKykgewogICAgICAgIGNvbnN0IHZlcnQgPSBiZXZlbEVuYWJsZWQgPyBzY2FsZVB0Mih2ZXJ0aWNlc1tpXSwgdmVydGljZXNNb3ZlbWVudHNbaV0sIGJzKSA6IHZlcnRpY2VzW2ldOwogICAgICAgIGlmICghZXh0cnVkZUJ5UGF0aCkgewogICAgICAgICAgdih2ZXJ0LngsIHZlcnQueSwgMCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG5vcm1hbC5jb3B5KHNwbGluZVR1YmUubm9ybWFsc1swXSkubXVsdGlwbHlTY2FsYXIodmVydC54KTsKICAgICAgICAgIGJpbm9ybWFsLmNvcHkoc3BsaW5lVHViZS5iaW5vcm1hbHNbMF0pLm11bHRpcGx5U2NhbGFyKHZlcnQueSk7CiAgICAgICAgICBwb3NpdGlvbjIuY29weShleHRydWRlUHRzWzBdKS5hZGQobm9ybWFsKS5hZGQoYmlub3JtYWwpOwogICAgICAgICAgdihwb3NpdGlvbjIueCwgcG9zaXRpb24yLnksIHBvc2l0aW9uMi56KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZm9yIChsZXQgcyA9IDE7IHMgPD0gc3RlcHM7IHMrKykgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmxlbjsgaSsrKSB7CiAgICAgICAgICBjb25zdCB2ZXJ0ID0gYmV2ZWxFbmFibGVkID8gc2NhbGVQdDIodmVydGljZXNbaV0sIHZlcnRpY2VzTW92ZW1lbnRzW2ldLCBicykgOiB2ZXJ0aWNlc1tpXTsKICAgICAgICAgIGlmICghZXh0cnVkZUJ5UGF0aCkgewogICAgICAgICAgICB2KHZlcnQueCwgdmVydC55LCBkZXB0aCAvIHN0ZXBzICogcyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBub3JtYWwuY29weShzcGxpbmVUdWJlLm5vcm1hbHNbc10pLm11bHRpcGx5U2NhbGFyKHZlcnQueCk7CiAgICAgICAgICAgIGJpbm9ybWFsLmNvcHkoc3BsaW5lVHViZS5iaW5vcm1hbHNbc10pLm11bHRpcGx5U2NhbGFyKHZlcnQueSk7CiAgICAgICAgICAgIHBvc2l0aW9uMi5jb3B5KGV4dHJ1ZGVQdHNbc10pLmFkZChub3JtYWwpLmFkZChiaW5vcm1hbCk7CiAgICAgICAgICAgIHYocG9zaXRpb24yLngsIHBvc2l0aW9uMi55LCBwb3NpdGlvbjIueik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGZvciAobGV0IGIgPSBiZXZlbFNlZ21lbnRzIC0gMTsgYiA+PSAwOyBiLS0pIHsKICAgICAgICBjb25zdCB0ID0gYiAvIGJldmVsU2VnbWVudHM7CiAgICAgICAgY29uc3QgeiA9IGJldmVsVGhpY2tuZXNzICogTWF0aC5jb3ModCAqIE1hdGguUEkgLyAyKTsKICAgICAgICBjb25zdCBiczIgPSBiZXZlbFNpemUgKiBNYXRoLnNpbih0ICogTWF0aC5QSSAvIDIpICsgYmV2ZWxPZmZzZXQ7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlsID0gY29udG91ci5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgICAgICBjb25zdCB2ZXJ0ID0gc2NhbGVQdDIoY29udG91cltpXSwgY29udG91ck1vdmVtZW50c1tpXSwgYnMyKTsKICAgICAgICAgIHYodmVydC54LCB2ZXJ0LnksIGRlcHRoICsgeik7CiAgICAgICAgfQogICAgICAgIGZvciAobGV0IGggPSAwLCBobCA9IGhvbGVzLmxlbmd0aDsgaCA8IGhsOyBoKyspIHsKICAgICAgICAgIGNvbnN0IGFob2xlID0gaG9sZXNbaF07CiAgICAgICAgICBvbmVIb2xlTW92ZW1lbnRzID0gaG9sZXNNb3ZlbWVudHNbaF07CiAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBhaG9sZS5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IHZlcnQgPSBzY2FsZVB0MihhaG9sZVtpXSwgb25lSG9sZU1vdmVtZW50c1tpXSwgYnMyKTsKICAgICAgICAgICAgaWYgKCFleHRydWRlQnlQYXRoKSB7CiAgICAgICAgICAgICAgdih2ZXJ0LngsIHZlcnQueSwgZGVwdGggKyB6KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB2KHZlcnQueCwgdmVydC55ICsgZXh0cnVkZVB0c1tzdGVwcyAtIDFdLnksIGV4dHJ1ZGVQdHNbc3RlcHMgLSAxXS54ICsgeik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgYnVpbGRMaWRGYWNlcygpOwogICAgICBidWlsZFNpZGVGYWNlcygpOwogICAgICBmdW5jdGlvbiBidWlsZExpZEZhY2VzKCkgewogICAgICAgIGNvbnN0IHN0YXJ0ID0gdmVydGljZXNBcnJheS5sZW5ndGggLyAzOwogICAgICAgIGlmIChiZXZlbEVuYWJsZWQpIHsKICAgICAgICAgIGxldCBsYXllciA9IDA7CiAgICAgICAgICBsZXQgb2Zmc2V0ID0gdmxlbiAqIGxheWVyOwogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmbGVuOyBpKyspIHsKICAgICAgICAgICAgY29uc3QgZmFjZSA9IGZhY2VzW2ldOwogICAgICAgICAgICBmMyhmYWNlWzJdICsgb2Zmc2V0LCBmYWNlWzFdICsgb2Zmc2V0LCBmYWNlWzBdICsgb2Zmc2V0KTsKICAgICAgICAgIH0KICAgICAgICAgIGxheWVyID0gc3RlcHMgKyBiZXZlbFNlZ21lbnRzICogMjsKICAgICAgICAgIG9mZnNldCA9IHZsZW4gKiBsYXllcjsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmxlbjsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IGZhY2UgPSBmYWNlc1tpXTsKICAgICAgICAgICAgZjMoZmFjZVswXSArIG9mZnNldCwgZmFjZVsxXSArIG9mZnNldCwgZmFjZVsyXSArIG9mZnNldCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmxlbjsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IGZhY2UgPSBmYWNlc1tpXTsKICAgICAgICAgICAgZjMoZmFjZVsyXSwgZmFjZVsxXSwgZmFjZVswXSk7CiAgICAgICAgICB9CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZsZW47IGkrKykgewogICAgICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbaV07CiAgICAgICAgICAgIGYzKGZhY2VbMF0gKyB2bGVuICogc3RlcHMsIGZhY2VbMV0gKyB2bGVuICogc3RlcHMsIGZhY2VbMl0gKyB2bGVuICogc3RlcHMpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzY29wZS5hZGRHcm91cChzdGFydCwgdmVydGljZXNBcnJheS5sZW5ndGggLyAzIC0gc3RhcnQsIDApOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIGJ1aWxkU2lkZUZhY2VzKCkgewogICAgICAgIGNvbnN0IHN0YXJ0ID0gdmVydGljZXNBcnJheS5sZW5ndGggLyAzOwogICAgICAgIGxldCBsYXllcm9mZnNldCA9IDA7CiAgICAgICAgc2lkZXdhbGxzKGNvbnRvdXIsIGxheWVyb2Zmc2V0KTsKICAgICAgICBsYXllcm9mZnNldCArPSBjb250b3VyLmxlbmd0aDsKICAgICAgICBmb3IgKGxldCBoID0gMCwgaGwgPSBob2xlcy5sZW5ndGg7IGggPCBobDsgaCsrKSB7CiAgICAgICAgICBjb25zdCBhaG9sZSA9IGhvbGVzW2hdOwogICAgICAgICAgc2lkZXdhbGxzKGFob2xlLCBsYXllcm9mZnNldCk7CiAgICAgICAgICBsYXllcm9mZnNldCArPSBhaG9sZS5sZW5ndGg7CiAgICAgICAgfQogICAgICAgIHNjb3BlLmFkZEdyb3VwKHN0YXJ0LCB2ZXJ0aWNlc0FycmF5Lmxlbmd0aCAvIDMgLSBzdGFydCwgMSk7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gc2lkZXdhbGxzKGNvbnRvdXIyLCBsYXllcm9mZnNldCkgewogICAgICAgIGxldCBpID0gY29udG91cjIubGVuZ3RoOwogICAgICAgIHdoaWxlICgtLWkgPj0gMCkgewogICAgICAgICAgY29uc3QgaiA9IGk7CiAgICAgICAgICBsZXQgayA9IGkgLSAxOwogICAgICAgICAgaWYgKGsgPCAwKQogICAgICAgICAgICBrID0gY29udG91cjIubGVuZ3RoIC0gMTsKICAgICAgICAgIGZvciAobGV0IHMgPSAwLCBzbCA9IHN0ZXBzICsgYmV2ZWxTZWdtZW50cyAqIDI7IHMgPCBzbDsgcysrKSB7CiAgICAgICAgICAgIGNvbnN0IHNsZW4xID0gdmxlbiAqIHM7CiAgICAgICAgICAgIGNvbnN0IHNsZW4yID0gdmxlbiAqIChzICsgMSk7CiAgICAgICAgICAgIGNvbnN0IGEgPSBsYXllcm9mZnNldCArIGogKyBzbGVuMSwgYiA9IGxheWVyb2Zmc2V0ICsgayArIHNsZW4xLCBjID0gbGF5ZXJvZmZzZXQgKyBrICsgc2xlbjIsIGQgPSBsYXllcm9mZnNldCArIGogKyBzbGVuMjsKICAgICAgICAgICAgZjQoYSwgYiwgYywgZCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGZ1bmN0aW9uIHYoeCwgeSwgeikgewogICAgICAgIHBsYWNlaG9sZGVyLnB1c2goeCk7CiAgICAgICAgcGxhY2Vob2xkZXIucHVzaCh5KTsKICAgICAgICBwbGFjZWhvbGRlci5wdXNoKHopOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIGYzKGEsIGIsIGMpIHsKICAgICAgICBhZGRWZXJ0ZXgoYSk7CiAgICAgICAgYWRkVmVydGV4KGIpOwogICAgICAgIGFkZFZlcnRleChjKTsKICAgICAgICBjb25zdCBuZXh0SW5kZXggPSB2ZXJ0aWNlc0FycmF5Lmxlbmd0aCAvIDM7CiAgICAgICAgY29uc3QgdXZzID0gdXZnZW4uZ2VuZXJhdGVUb3BVVihzY29wZSwgdmVydGljZXNBcnJheSwgbmV4dEluZGV4IC0gMywgbmV4dEluZGV4IC0gMiwgbmV4dEluZGV4IC0gMSk7CiAgICAgICAgYWRkVVYodXZzWzBdKTsKICAgICAgICBhZGRVVih1dnNbMV0pOwogICAgICAgIGFkZFVWKHV2c1syXSk7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gZjQoYSwgYiwgYywgZCkgewogICAgICAgIGFkZFZlcnRleChhKTsKICAgICAgICBhZGRWZXJ0ZXgoYik7CiAgICAgICAgYWRkVmVydGV4KGQpOwogICAgICAgIGFkZFZlcnRleChiKTsKICAgICAgICBhZGRWZXJ0ZXgoYyk7CiAgICAgICAgYWRkVmVydGV4KGQpOwogICAgICAgIGNvbnN0IG5leHRJbmRleCA9IHZlcnRpY2VzQXJyYXkubGVuZ3RoIC8gMzsKICAgICAgICBjb25zdCB1dnMgPSB1dmdlbi5nZW5lcmF0ZVNpZGVXYWxsVVYoc2NvcGUsIHZlcnRpY2VzQXJyYXksIG5leHRJbmRleCAtIDYsIG5leHRJbmRleCAtIDMsIG5leHRJbmRleCAtIDIsIG5leHRJbmRleCAtIDEpOwogICAgICAgIGFkZFVWKHV2c1swXSk7CiAgICAgICAgYWRkVVYodXZzWzFdKTsKICAgICAgICBhZGRVVih1dnNbM10pOwogICAgICAgIGFkZFVWKHV2c1sxXSk7CiAgICAgICAgYWRkVVYodXZzWzJdKTsKICAgICAgICBhZGRVVih1dnNbM10pOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIGFkZFZlcnRleChpbmRleCkgewogICAgICAgIHZlcnRpY2VzQXJyYXkucHVzaChwbGFjZWhvbGRlcltpbmRleCAqIDMgKyAwXSk7CiAgICAgICAgdmVydGljZXNBcnJheS5wdXNoKHBsYWNlaG9sZGVyW2luZGV4ICogMyArIDFdKTsKICAgICAgICB2ZXJ0aWNlc0FycmF5LnB1c2gocGxhY2Vob2xkZXJbaW5kZXggKiAzICsgMl0pOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIGFkZFVWKHZlY3RvcjIpIHsKICAgICAgICB1dkFycmF5LnB1c2godmVjdG9yMi54KTsKICAgICAgICB1dkFycmF5LnB1c2godmVjdG9yMi55KTsKICAgICAgfQogICAgfQogIH0KICB0b0pTT04oKSB7CiAgICBjb25zdCBkYXRhID0gc3VwZXIudG9KU09OKCk7CiAgICBjb25zdCBzaGFwZXMgPSB0aGlzLnBhcmFtZXRlcnMuc2hhcGVzOwogICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMucGFyYW1ldGVycy5vcHRpb25zOwogICAgcmV0dXJuIHRvSlNPTiQxKHNoYXBlcywgb3B0aW9ucywgZGF0YSk7CiAgfQogIHN0YXRpYyBmcm9tSlNPTihkYXRhLCBzaGFwZXMpIHsKICAgIGNvbnN0IGdlb21ldHJ5U2hhcGVzID0gW107CiAgICBmb3IgKGxldCBqID0gMCwgamwgPSBkYXRhLnNoYXBlcy5sZW5ndGg7IGogPCBqbDsgaisrKSB7CiAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW2RhdGEuc2hhcGVzW2pdXTsKICAgICAgZ2VvbWV0cnlTaGFwZXMucHVzaChzaGFwZSk7CiAgICB9CiAgICBjb25zdCBleHRydWRlUGF0aCA9IGRhdGEub3B0aW9ucy5leHRydWRlUGF0aDsKICAgIGlmIChleHRydWRlUGF0aCAhPT0gdm9pZCAwKSB7CiAgICAgIGRhdGEub3B0aW9ucy5leHRydWRlUGF0aCA9IG5ldyBDdXJ2ZXNbZXh0cnVkZVBhdGgudHlwZV0oKS5mcm9tSlNPTihleHRydWRlUGF0aCk7CiAgICB9CiAgICByZXR1cm4gbmV3IEV4dHJ1ZGVHZW9tZXRyeShnZW9tZXRyeVNoYXBlcywgZGF0YS5vcHRpb25zKTsKICB9Cn0KY29uc3QgV29ybGRVVkdlbmVyYXRvciA9IHsKICBnZW5lcmF0ZVRvcFVWOiBmdW5jdGlvbihnZW9tZXRyeSwgdmVydGljZXMsIGluZGV4QSwgaW5kZXhCLCBpbmRleEMpIHsKICAgIGNvbnN0IGFfeCA9IHZlcnRpY2VzW2luZGV4QSAqIDNdOwogICAgY29uc3QgYV95ID0gdmVydGljZXNbaW5kZXhBICogMyArIDFdOwogICAgY29uc3QgYl94ID0gdmVydGljZXNbaW5kZXhCICogM107CiAgICBjb25zdCBiX3kgPSB2ZXJ0aWNlc1tpbmRleEIgKiAzICsgMV07CiAgICBjb25zdCBjX3ggPSB2ZXJ0aWNlc1tpbmRleEMgKiAzXTsKICAgIGNvbnN0IGNfeSA9IHZlcnRpY2VzW2luZGV4QyAqIDMgKyAxXTsKICAgIHJldHVybiBbCiAgICAgIG5ldyBWZWN0b3IyKGFfeCwgYV95KSwKICAgICAgbmV3IFZlY3RvcjIoYl94LCBiX3kpLAogICAgICBuZXcgVmVjdG9yMihjX3gsIGNfeSkKICAgIF07CiAgfSwKICBnZW5lcmF0ZVNpZGVXYWxsVVY6IGZ1bmN0aW9uKGdlb21ldHJ5LCB2ZXJ0aWNlcywgaW5kZXhBLCBpbmRleEIsIGluZGV4QywgaW5kZXhEKSB7CiAgICBjb25zdCBhX3ggPSB2ZXJ0aWNlc1tpbmRleEEgKiAzXTsKICAgIGNvbnN0IGFfeSA9IHZlcnRpY2VzW2luZGV4QSAqIDMgKyAxXTsKICAgIGNvbnN0IGFfeiA9IHZlcnRpY2VzW2luZGV4QSAqIDMgKyAyXTsKICAgIGNvbnN0IGJfeCA9IHZlcnRpY2VzW2luZGV4QiAqIDNdOwogICAgY29uc3QgYl95ID0gdmVydGljZXNbaW5kZXhCICogMyArIDFdOwogICAgY29uc3QgYl96ID0gdmVydGljZXNbaW5kZXhCICogMyArIDJdOwogICAgY29uc3QgY194ID0gdmVydGljZXNbaW5kZXhDICogM107CiAgICBjb25zdCBjX3kgPSB2ZXJ0aWNlc1tpbmRleEMgKiAzICsgMV07CiAgICBjb25zdCBjX3ogPSB2ZXJ0aWNlc1tpbmRleEMgKiAzICsgMl07CiAgICBjb25zdCBkX3ggPSB2ZXJ0aWNlc1tpbmRleEQgKiAzXTsKICAgIGNvbnN0IGRfeSA9IHZlcnRpY2VzW2luZGV4RCAqIDMgKyAxXTsKICAgIGNvbnN0IGRfeiA9IHZlcnRpY2VzW2luZGV4RCAqIDMgKyAyXTsKICAgIGlmIChNYXRoLmFicyhhX3kgLSBiX3kpIDwgTWF0aC5hYnMoYV94IC0gYl94KSkgewogICAgICByZXR1cm4gWwogICAgICAgIG5ldyBWZWN0b3IyKGFfeCwgMSAtIGFfeiksCiAgICAgICAgbmV3IFZlY3RvcjIoYl94LCAxIC0gYl96KSwKICAgICAgICBuZXcgVmVjdG9yMihjX3gsIDEgLSBjX3opLAogICAgICAgIG5ldyBWZWN0b3IyKGRfeCwgMSAtIGRfeikKICAgICAgXTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBbCiAgICAgICAgbmV3IFZlY3RvcjIoYV95LCAxIC0gYV96KSwKICAgICAgICBuZXcgVmVjdG9yMihiX3ksIDEgLSBiX3opLAogICAgICAgIG5ldyBWZWN0b3IyKGNfeSwgMSAtIGNfeiksCiAgICAgICAgbmV3IFZlY3RvcjIoZF95LCAxIC0gZF96KQogICAgICBdOwogICAgfQogIH0KfTsKZnVuY3Rpb24gdG9KU09OJDEoc2hhcGVzLCBvcHRpb25zLCBkYXRhKSB7CiAgZGF0YS5zaGFwZXMgPSBbXTsKICBpZiAoQXJyYXkuaXNBcnJheShzaGFwZXMpKSB7CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IHNoYXBlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgY29uc3Qgc2hhcGUgPSBzaGFwZXNbaV07CiAgICAgIGRhdGEuc2hhcGVzLnB1c2goc2hhcGUudXVpZCk7CiAgICB9CiAgfSBlbHNlIHsKICAgIGRhdGEuc2hhcGVzLnB1c2goc2hhcGVzLnV1aWQpOwogIH0KICBpZiAob3B0aW9ucy5leHRydWRlUGF0aCAhPT0gdm9pZCAwKQogICAgZGF0YS5vcHRpb25zLmV4dHJ1ZGVQYXRoID0gb3B0aW9ucy5leHRydWRlUGF0aC50b0pTT04oKTsKICByZXR1cm4gZGF0YTsKfQpjbGFzcyBJY29zYWhlZHJvbkdlb21ldHJ5IGV4dGVuZHMgUG9seWhlZHJvbkdlb21ldHJ5IHsKICBjb25zdHJ1Y3RvcihyYWRpdXMgPSAxLCBkZXRhaWwgPSAwKSB7CiAgICBjb25zdCB0ID0gKDEgKyBNYXRoLnNxcnQoNSkpIC8gMjsKICAgIGNvbnN0IHZlcnRpY2VzID0gWwogICAgICAtMSwKICAgICAgdCwKICAgICAgMCwKICAgICAgMSwKICAgICAgdCwKICAgICAgMCwKICAgICAgLTEsCiAgICAgIC10LAogICAgICAwLAogICAgICAxLAogICAgICAtdCwKICAgICAgMCwKICAgICAgMCwKICAgICAgLTEsCiAgICAgIHQsCiAgICAgIDAsCiAgICAgIDEsCiAgICAgIHQsCiAgICAgIDAsCiAgICAgIC0xLAogICAgICAtdCwKICAgICAgMCwKICAgICAgMSwKICAgICAgLXQsCiAgICAgIHQsCiAgICAgIDAsCiAgICAgIC0xLAogICAgICB0LAogICAgICAwLAogICAgICAxLAogICAgICAtdCwKICAgICAgMCwKICAgICAgLTEsCiAgICAgIC10LAogICAgICAwLAogICAgICAxCiAgICBdOwogICAgY29uc3QgaW5kaWNlcyA9IFsKICAgICAgMCwKICAgICAgMTEsCiAgICAgIDUsCiAgICAgIDAsCiAgICAgIDUsCiAgICAgIDEsCiAgICAgIDAsCiAgICAgIDEsCiAgICAgIDcsCiAgICAgIDAsCiAgICAgIDcsCiAgICAgIDEwLAogICAgICAwLAogICAgICAxMCwKICAgICAgMTEsCiAgICAgIDEsCiAgICAgIDUsCiAgICAgIDksCiAgICAgIDUsCiAgICAgIDExLAogICAgICA0LAogICAgICAxMSwKICAgICAgMTAsCiAgICAgIDIsCiAgICAgIDEwLAogICAgICA3LAogICAgICA2LAogICAgICA3LAogICAgICAxLAogICAgICA4LAogICAgICAzLAogICAgICA5LAogICAgICA0LAogICAgICAzLAogICAgICA0LAogICAgICAyLAogICAgICAzLAogICAgICAyLAogICAgICA2LAogICAgICAzLAogICAgICA2LAogICAgICA4LAogICAgICAzLAogICAgICA4LAogICAgICA5LAogICAgICA0LAogICAgICA5LAogICAgICA1LAogICAgICAyLAogICAgICA0LAogICAgICAxMSwKICAgICAgNiwKICAgICAgMiwKICAgICAgMTAsCiAgICAgIDgsCiAgICAgIDYsCiAgICAgIDcsCiAgICAgIDksCiAgICAgIDgsCiAgICAgIDEKICAgIF07CiAgICBzdXBlcih2ZXJ0aWNlcywgaW5kaWNlcywgcmFkaXVzLCBkZXRhaWwpOwogICAgdGhpcy50eXBlID0gIkljb3NhaGVkcm9uR2VvbWV0cnkiOwogICAgdGhpcy5wYXJhbWV0ZXJzID0gewogICAgICByYWRpdXMsCiAgICAgIGRldGFpbAogICAgfTsKICB9CiAgc3RhdGljIGZyb21KU09OKGRhdGEpIHsKICAgIHJldHVybiBuZXcgSWNvc2FoZWRyb25HZW9tZXRyeShkYXRhLnJhZGl1cywgZGF0YS5kZXRhaWwpOwogIH0KfQpjbGFzcyBMYXRoZUdlb21ldHJ5IGV4dGVuZHMgQnVmZmVyR2VvbWV0cnkgewogIGNvbnN0cnVjdG9yKHBvaW50cyA9IFtuZXcgVmVjdG9yMigwLCAwLjUpLCBuZXcgVmVjdG9yMigwLjUsIDApLCBuZXcgVmVjdG9yMigwLCAtMC41KV0sIHNlZ21lbnRzID0gMTIsIHBoaVN0YXJ0ID0gMCwgcGhpTGVuZ3RoID0gTWF0aC5QSSAqIDIpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLnR5cGUgPSAiTGF0aGVHZW9tZXRyeSI7CiAgICB0aGlzLnBhcmFtZXRlcnMgPSB7CiAgICAgIHBvaW50cywKICAgICAgc2VnbWVudHMsCiAgICAgIHBoaVN0YXJ0LAogICAgICBwaGlMZW5ndGgKICAgIH07CiAgICBzZWdtZW50cyA9IE1hdGguZmxvb3Ioc2VnbWVudHMpOwogICAgcGhpTGVuZ3RoID0gY2xhbXAocGhpTGVuZ3RoLCAwLCBNYXRoLlBJICogMik7CiAgICBjb25zdCBpbmRpY2VzID0gW107CiAgICBjb25zdCB2ZXJ0aWNlcyA9IFtdOwogICAgY29uc3QgdXZzID0gW107CiAgICBjb25zdCBpbml0Tm9ybWFscyA9IFtdOwogICAgY29uc3Qgbm9ybWFscyA9IFtdOwogICAgY29uc3QgaW52ZXJzZVNlZ21lbnRzID0gMSAvIHNlZ21lbnRzOwogICAgY29uc3QgdmVydGV4MiA9IG5ldyBWZWN0b3IzKCk7CiAgICBjb25zdCB1diA9IG5ldyBWZWN0b3IyKCk7CiAgICBjb25zdCBub3JtYWwgPSBuZXcgVmVjdG9yMygpOwogICAgY29uc3QgY3VyTm9ybWFsID0gbmV3IFZlY3RvcjMoKTsKICAgIGNvbnN0IHByZXZOb3JtYWwgPSBuZXcgVmVjdG9yMygpOwogICAgbGV0IGR4ID0gMDsKICAgIGxldCBkeSA9IDA7CiAgICBmb3IgKGxldCBqID0gMDsgaiA8PSBwb2ludHMubGVuZ3RoIC0gMTsgaisrKSB7CiAgICAgIHN3aXRjaCAoaikgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIGR4ID0gcG9pbnRzW2ogKyAxXS54IC0gcG9pbnRzW2pdLng7CiAgICAgICAgICBkeSA9IHBvaW50c1tqICsgMV0ueSAtIHBvaW50c1tqXS55OwogICAgICAgICAgbm9ybWFsLnggPSBkeSAqIDE7CiAgICAgICAgICBub3JtYWwueSA9IC1keDsKICAgICAgICAgIG5vcm1hbC56ID0gZHkgKiAwOwogICAgICAgICAgcHJldk5vcm1hbC5jb3B5KG5vcm1hbCk7CiAgICAgICAgICBub3JtYWwubm9ybWFsaXplKCk7CiAgICAgICAgICBpbml0Tm9ybWFscy5wdXNoKG5vcm1hbC54LCBub3JtYWwueSwgbm9ybWFsLnopOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBwb2ludHMubGVuZ3RoIC0gMToKICAgICAgICAgIGluaXROb3JtYWxzLnB1c2gocHJldk5vcm1hbC54LCBwcmV2Tm9ybWFsLnksIHByZXZOb3JtYWwueik7CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgZHggPSBwb2ludHNbaiArIDFdLnggLSBwb2ludHNbal0ueDsKICAgICAgICAgIGR5ID0gcG9pbnRzW2ogKyAxXS55IC0gcG9pbnRzW2pdLnk7CiAgICAgICAgICBub3JtYWwueCA9IGR5ICogMTsKICAgICAgICAgIG5vcm1hbC55ID0gLWR4OwogICAgICAgICAgbm9ybWFsLnogPSBkeSAqIDA7CiAgICAgICAgICBjdXJOb3JtYWwuY29weShub3JtYWwpOwogICAgICAgICAgbm9ybWFsLnggKz0gcHJldk5vcm1hbC54OwogICAgICAgICAgbm9ybWFsLnkgKz0gcHJldk5vcm1hbC55OwogICAgICAgICAgbm9ybWFsLnogKz0gcHJldk5vcm1hbC56OwogICAgICAgICAgbm9ybWFsLm5vcm1hbGl6ZSgpOwogICAgICAgICAgaW5pdE5vcm1hbHMucHVzaChub3JtYWwueCwgbm9ybWFsLnksIG5vcm1hbC56KTsKICAgICAgICAgIHByZXZOb3JtYWwuY29weShjdXJOb3JtYWwpOwogICAgICB9CiAgICB9CiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBzZWdtZW50czsgaSsrKSB7CiAgICAgIGNvbnN0IHBoaSA9IHBoaVN0YXJ0ICsgaSAqIGludmVyc2VTZWdtZW50cyAqIHBoaUxlbmd0aDsKICAgICAgY29uc3Qgc2luID0gTWF0aC5zaW4ocGhpKTsKICAgICAgY29uc3QgY29zID0gTWF0aC5jb3MocGhpKTsKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPD0gcG9pbnRzLmxlbmd0aCAtIDE7IGorKykgewogICAgICAgIHZlcnRleDIueCA9IHBvaW50c1tqXS54ICogc2luOwogICAgICAgIHZlcnRleDIueSA9IHBvaW50c1tqXS55OwogICAgICAgIHZlcnRleDIueiA9IHBvaW50c1tqXS54ICogY29zOwogICAgICAgIHZlcnRpY2VzLnB1c2godmVydGV4Mi54LCB2ZXJ0ZXgyLnksIHZlcnRleDIueik7CiAgICAgICAgdXYueCA9IGkgLyBzZWdtZW50czsKICAgICAgICB1di55ID0gaiAvIChwb2ludHMubGVuZ3RoIC0gMSk7CiAgICAgICAgdXZzLnB1c2godXYueCwgdXYueSk7CiAgICAgICAgY29uc3QgeCA9IGluaXROb3JtYWxzWzMgKiBqICsgMF0gKiBzaW47CiAgICAgICAgY29uc3QgeSA9IGluaXROb3JtYWxzWzMgKiBqICsgMV07CiAgICAgICAgY29uc3QgeiA9IGluaXROb3JtYWxzWzMgKiBqICsgMF0gKiBjb3M7CiAgICAgICAgbm9ybWFscy5wdXNoKHgsIHksIHopOwogICAgICB9CiAgICB9CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlZ21lbnRzOyBpKyspIHsKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBwb2ludHMubGVuZ3RoIC0gMTsgaisrKSB7CiAgICAgICAgY29uc3QgYmFzZSA9IGogKyBpICogcG9pbnRzLmxlbmd0aDsKICAgICAgICBjb25zdCBhID0gYmFzZTsKICAgICAgICBjb25zdCBiID0gYmFzZSArIHBvaW50cy5sZW5ndGg7CiAgICAgICAgY29uc3QgYyA9IGJhc2UgKyBwb2ludHMubGVuZ3RoICsgMTsKICAgICAgICBjb25zdCBkID0gYmFzZSArIDE7CiAgICAgICAgaW5kaWNlcy5wdXNoKGEsIGIsIGQpOwogICAgICAgIGluZGljZXMucHVzaChjLCBkLCBiKTsKICAgICAgfQogICAgfQogICAgdGhpcy5zZXRJbmRleChpbmRpY2VzKTsKICAgIHRoaXMuc2V0QXR0cmlidXRlKCJwb3NpdGlvbiIsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKHZlcnRpY2VzLCAzKSk7CiAgICB0aGlzLnNldEF0dHJpYnV0ZSgidXYiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh1dnMsIDIpKTsKICAgIHRoaXMuc2V0QXR0cmlidXRlKCJub3JtYWwiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShub3JtYWxzLCAzKSk7CiAgfQogIHN0YXRpYyBmcm9tSlNPTihkYXRhKSB7CiAgICByZXR1cm4gbmV3IExhdGhlR2VvbWV0cnkoZGF0YS5wb2ludHMsIGRhdGEuc2VnbWVudHMsIGRhdGEucGhpU3RhcnQsIGRhdGEucGhpTGVuZ3RoKTsKICB9Cn0KY2xhc3MgT2N0YWhlZHJvbkdlb21ldHJ5IGV4dGVuZHMgUG9seWhlZHJvbkdlb21ldHJ5IHsKICBjb25zdHJ1Y3RvcihyYWRpdXMgPSAxLCBkZXRhaWwgPSAwKSB7CiAgICBjb25zdCB2ZXJ0aWNlcyA9IFsKICAgICAgMSwKICAgICAgMCwKICAgICAgMCwKICAgICAgLTEsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIDEsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIC0xLAogICAgICAwLAogICAgICAwLAogICAgICAwLAogICAgICAxLAogICAgICAwLAogICAgICAwLAogICAgICAtMQogICAgXTsKICAgIGNvbnN0IGluZGljZXMgPSBbCiAgICAgIDAsCiAgICAgIDIsCiAgICAgIDQsCiAgICAgIDAsCiAgICAgIDQsCiAgICAgIDMsCiAgICAgIDAsCiAgICAgIDMsCiAgICAgIDUsCiAgICAgIDAsCiAgICAgIDUsCiAgICAgIDIsCiAgICAgIDEsCiAgICAgIDIsCiAgICAgIDUsCiAgICAgIDEsCiAgICAgIDUsCiAgICAgIDMsCiAgICAgIDEsCiAgICAgIDMsCiAgICAgIDQsCiAgICAgIDEsCiAgICAgIDQsCiAgICAgIDIKICAgIF07CiAgICBzdXBlcih2ZXJ0aWNlcywgaW5kaWNlcywgcmFkaXVzLCBkZXRhaWwpOwogICAgdGhpcy50eXBlID0gIk9jdGFoZWRyb25HZW9tZXRyeSI7CiAgICB0aGlzLnBhcmFtZXRlcnMgPSB7CiAgICAgIHJhZGl1cywKICAgICAgZGV0YWlsCiAgICB9OwogIH0KICBzdGF0aWMgZnJvbUpTT04oZGF0YSkgewogICAgcmV0dXJuIG5ldyBPY3RhaGVkcm9uR2VvbWV0cnkoZGF0YS5yYWRpdXMsIGRhdGEuZGV0YWlsKTsKICB9Cn0KY2xhc3MgUmluZ0dlb21ldHJ5IGV4dGVuZHMgQnVmZmVyR2VvbWV0cnkgewogIGNvbnN0cnVjdG9yKGlubmVyUmFkaXVzID0gMC41LCBvdXRlclJhZGl1cyA9IDEsIHRoZXRhU2VnbWVudHMgPSA4LCBwaGlTZWdtZW50cyA9IDEsIHRoZXRhU3RhcnQgPSAwLCB0aGV0YUxlbmd0aCA9IE1hdGguUEkgKiAyKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIlJpbmdHZW9tZXRyeSI7CiAgICB0aGlzLnBhcmFtZXRlcnMgPSB7CiAgICAgIGlubmVyUmFkaXVzLAogICAgICBvdXRlclJhZGl1cywKICAgICAgdGhldGFTZWdtZW50cywKICAgICAgcGhpU2VnbWVudHMsCiAgICAgIHRoZXRhU3RhcnQsCiAgICAgIHRoZXRhTGVuZ3RoCiAgICB9OwogICAgdGhldGFTZWdtZW50cyA9IE1hdGgubWF4KDMsIHRoZXRhU2VnbWVudHMpOwogICAgcGhpU2VnbWVudHMgPSBNYXRoLm1heCgxLCBwaGlTZWdtZW50cyk7CiAgICBjb25zdCBpbmRpY2VzID0gW107CiAgICBjb25zdCB2ZXJ0aWNlcyA9IFtdOwogICAgY29uc3Qgbm9ybWFscyA9IFtdOwogICAgY29uc3QgdXZzID0gW107CiAgICBsZXQgcmFkaXVzID0gaW5uZXJSYWRpdXM7CiAgICBjb25zdCByYWRpdXNTdGVwID0gKG91dGVyUmFkaXVzIC0gaW5uZXJSYWRpdXMpIC8gcGhpU2VnbWVudHM7CiAgICBjb25zdCB2ZXJ0ZXgyID0gbmV3IFZlY3RvcjMoKTsKICAgIGNvbnN0IHV2ID0gbmV3IFZlY3RvcjIoKTsKICAgIGZvciAobGV0IGogPSAwOyBqIDw9IHBoaVNlZ21lbnRzOyBqKyspIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gdGhldGFTZWdtZW50czsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2VnbWVudCA9IHRoZXRhU3RhcnQgKyBpIC8gdGhldGFTZWdtZW50cyAqIHRoZXRhTGVuZ3RoOwogICAgICAgIHZlcnRleDIueCA9IHJhZGl1cyAqIE1hdGguY29zKHNlZ21lbnQpOwogICAgICAgIHZlcnRleDIueSA9IHJhZGl1cyAqIE1hdGguc2luKHNlZ21lbnQpOwogICAgICAgIHZlcnRpY2VzLnB1c2godmVydGV4Mi54LCB2ZXJ0ZXgyLnksIHZlcnRleDIueik7CiAgICAgICAgbm9ybWFscy5wdXNoKDAsIDAsIDEpOwogICAgICAgIHV2LnggPSAodmVydGV4Mi54IC8gb3V0ZXJSYWRpdXMgKyAxKSAvIDI7CiAgICAgICAgdXYueSA9ICh2ZXJ0ZXgyLnkgLyBvdXRlclJhZGl1cyArIDEpIC8gMjsKICAgICAgICB1dnMucHVzaCh1di54LCB1di55KTsKICAgICAgfQogICAgICByYWRpdXMgKz0gcmFkaXVzU3RlcDsKICAgIH0KICAgIGZvciAobGV0IGogPSAwOyBqIDwgcGhpU2VnbWVudHM7IGorKykgewogICAgICBjb25zdCB0aGV0YVNlZ21lbnRMZXZlbCA9IGogKiAodGhldGFTZWdtZW50cyArIDEpOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoZXRhU2VnbWVudHM7IGkrKykgewogICAgICAgIGNvbnN0IHNlZ21lbnQgPSBpICsgdGhldGFTZWdtZW50TGV2ZWw7CiAgICAgICAgY29uc3QgYSA9IHNlZ21lbnQ7CiAgICAgICAgY29uc3QgYiA9IHNlZ21lbnQgKyB0aGV0YVNlZ21lbnRzICsgMTsKICAgICAgICBjb25zdCBjID0gc2VnbWVudCArIHRoZXRhU2VnbWVudHMgKyAyOwogICAgICAgIGNvbnN0IGQgPSBzZWdtZW50ICsgMTsKICAgICAgICBpbmRpY2VzLnB1c2goYSwgYiwgZCk7CiAgICAgICAgaW5kaWNlcy5wdXNoKGIsIGMsIGQpOwogICAgICB9CiAgICB9CiAgICB0aGlzLnNldEluZGV4KGluZGljZXMpOwogICAgdGhpcy5zZXRBdHRyaWJ1dGUoInBvc2l0aW9uIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUodmVydGljZXMsIDMpKTsKICAgIHRoaXMuc2V0QXR0cmlidXRlKCJub3JtYWwiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShub3JtYWxzLCAzKSk7CiAgICB0aGlzLnNldEF0dHJpYnV0ZSgidXYiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh1dnMsIDIpKTsKICB9CiAgc3RhdGljIGZyb21KU09OKGRhdGEpIHsKICAgIHJldHVybiBuZXcgUmluZ0dlb21ldHJ5KGRhdGEuaW5uZXJSYWRpdXMsIGRhdGEub3V0ZXJSYWRpdXMsIGRhdGEudGhldGFTZWdtZW50cywgZGF0YS5waGlTZWdtZW50cywgZGF0YS50aGV0YVN0YXJ0LCBkYXRhLnRoZXRhTGVuZ3RoKTsKICB9Cn0KY2xhc3MgU2hhcGVHZW9tZXRyeSBleHRlbmRzIEJ1ZmZlckdlb21ldHJ5IHsKICBjb25zdHJ1Y3RvcihzaGFwZXMgPSBuZXcgU2hhcGUoW25ldyBWZWN0b3IyKDAsIDAuNSksIG5ldyBWZWN0b3IyKC0wLjUsIC0wLjUpLCBuZXcgVmVjdG9yMigwLjUsIC0wLjUpXSksIGN1cnZlU2VnbWVudHMgPSAxMikgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJTaGFwZUdlb21ldHJ5IjsKICAgIHRoaXMucGFyYW1ldGVycyA9IHsKICAgICAgc2hhcGVzLAogICAgICBjdXJ2ZVNlZ21lbnRzCiAgICB9OwogICAgY29uc3QgaW5kaWNlcyA9IFtdOwogICAgY29uc3QgdmVydGljZXMgPSBbXTsKICAgIGNvbnN0IG5vcm1hbHMgPSBbXTsKICAgIGNvbnN0IHV2cyA9IFtdOwogICAgbGV0IGdyb3VwU3RhcnQgPSAwOwogICAgbGV0IGdyb3VwQ291bnQgPSAwOwogICAgaWYgKEFycmF5LmlzQXJyYXkoc2hhcGVzKSA9PT0gZmFsc2UpIHsKICAgICAgYWRkU2hhcGUoc2hhcGVzKTsKICAgIH0gZWxzZSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hhcGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgYWRkU2hhcGUoc2hhcGVzW2ldKTsKICAgICAgICB0aGlzLmFkZEdyb3VwKGdyb3VwU3RhcnQsIGdyb3VwQ291bnQsIGkpOwogICAgICAgIGdyb3VwU3RhcnQgKz0gZ3JvdXBDb3VudDsKICAgICAgICBncm91cENvdW50ID0gMDsKICAgICAgfQogICAgfQogICAgdGhpcy5zZXRJbmRleChpbmRpY2VzKTsKICAgIHRoaXMuc2V0QXR0cmlidXRlKCJwb3NpdGlvbiIsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKHZlcnRpY2VzLCAzKSk7CiAgICB0aGlzLnNldEF0dHJpYnV0ZSgibm9ybWFsIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUobm9ybWFscywgMykpOwogICAgdGhpcy5zZXRBdHRyaWJ1dGUoInV2IiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUodXZzLCAyKSk7CiAgICBmdW5jdGlvbiBhZGRTaGFwZShzaGFwZSkgewogICAgICBjb25zdCBpbmRleE9mZnNldCA9IHZlcnRpY2VzLmxlbmd0aCAvIDM7CiAgICAgIGNvbnN0IHBvaW50cyA9IHNoYXBlLmV4dHJhY3RQb2ludHMoY3VydmVTZWdtZW50cyk7CiAgICAgIGxldCBzaGFwZVZlcnRpY2VzID0gcG9pbnRzLnNoYXBlOwogICAgICBjb25zdCBzaGFwZUhvbGVzID0gcG9pbnRzLmhvbGVzOwogICAgICBpZiAoU2hhcGVVdGlscy5pc0Nsb2NrV2lzZShzaGFwZVZlcnRpY2VzKSA9PT0gZmFsc2UpIHsKICAgICAgICBzaGFwZVZlcnRpY2VzID0gc2hhcGVWZXJ0aWNlcy5yZXZlcnNlKCk7CiAgICAgIH0KICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBzaGFwZUhvbGVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGNvbnN0IHNoYXBlSG9sZSA9IHNoYXBlSG9sZXNbaV07CiAgICAgICAgaWYgKFNoYXBlVXRpbHMuaXNDbG9ja1dpc2Uoc2hhcGVIb2xlKSA9PT0gdHJ1ZSkgewogICAgICAgICAgc2hhcGVIb2xlc1tpXSA9IHNoYXBlSG9sZS5yZXZlcnNlKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbnN0IGZhY2VzID0gU2hhcGVVdGlscy50cmlhbmd1bGF0ZVNoYXBlKHNoYXBlVmVydGljZXMsIHNoYXBlSG9sZXMpOwogICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHNoYXBlSG9sZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2hhcGVIb2xlID0gc2hhcGVIb2xlc1tpXTsKICAgICAgICBzaGFwZVZlcnRpY2VzID0gc2hhcGVWZXJ0aWNlcy5jb25jYXQoc2hhcGVIb2xlKTsKICAgICAgfQogICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHNoYXBlVmVydGljZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY29uc3QgdmVydGV4MiA9IHNoYXBlVmVydGljZXNbaV07CiAgICAgICAgdmVydGljZXMucHVzaCh2ZXJ0ZXgyLngsIHZlcnRleDIueSwgMCk7CiAgICAgICAgbm9ybWFscy5wdXNoKDAsIDAsIDEpOwogICAgICAgIHV2cy5wdXNoKHZlcnRleDIueCwgdmVydGV4Mi55KTsKICAgICAgfQogICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGZhY2VzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGNvbnN0IGZhY2UgPSBmYWNlc1tpXTsKICAgICAgICBjb25zdCBhID0gZmFjZVswXSArIGluZGV4T2Zmc2V0OwogICAgICAgIGNvbnN0IGIgPSBmYWNlWzFdICsgaW5kZXhPZmZzZXQ7CiAgICAgICAgY29uc3QgYyA9IGZhY2VbMl0gKyBpbmRleE9mZnNldDsKICAgICAgICBpbmRpY2VzLnB1c2goYSwgYiwgYyk7CiAgICAgICAgZ3JvdXBDb3VudCArPSAzOwogICAgICB9CiAgICB9CiAgfQogIHRvSlNPTigpIHsKICAgIGNvbnN0IGRhdGEgPSBzdXBlci50b0pTT04oKTsKICAgIGNvbnN0IHNoYXBlcyA9IHRoaXMucGFyYW1ldGVycy5zaGFwZXM7CiAgICByZXR1cm4gdG9KU09OKHNoYXBlcywgZGF0YSk7CiAgfQogIHN0YXRpYyBmcm9tSlNPTihkYXRhLCBzaGFwZXMpIHsKICAgIGNvbnN0IGdlb21ldHJ5U2hhcGVzID0gW107CiAgICBmb3IgKGxldCBqID0gMCwgamwgPSBkYXRhLnNoYXBlcy5sZW5ndGg7IGogPCBqbDsgaisrKSB7CiAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW2RhdGEuc2hhcGVzW2pdXTsKICAgICAgZ2VvbWV0cnlTaGFwZXMucHVzaChzaGFwZSk7CiAgICB9CiAgICByZXR1cm4gbmV3IFNoYXBlR2VvbWV0cnkoZ2VvbWV0cnlTaGFwZXMsIGRhdGEuY3VydmVTZWdtZW50cyk7CiAgfQp9CmZ1bmN0aW9uIHRvSlNPTihzaGFwZXMsIGRhdGEpIHsKICBkYXRhLnNoYXBlcyA9IFtdOwogIGlmIChBcnJheS5pc0FycmF5KHNoYXBlcykpIHsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gc2hhcGVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBjb25zdCBzaGFwZSA9IHNoYXBlc1tpXTsKICAgICAgZGF0YS5zaGFwZXMucHVzaChzaGFwZS51dWlkKTsKICAgIH0KICB9IGVsc2UgewogICAgZGF0YS5zaGFwZXMucHVzaChzaGFwZXMudXVpZCk7CiAgfQogIHJldHVybiBkYXRhOwp9CmNsYXNzIFNwaGVyZUdlb21ldHJ5IGV4dGVuZHMgQnVmZmVyR2VvbWV0cnkgewogIGNvbnN0cnVjdG9yKHJhZGl1cyA9IDEsIHdpZHRoU2VnbWVudHMgPSAzMiwgaGVpZ2h0U2VnbWVudHMgPSAxNiwgcGhpU3RhcnQgPSAwLCBwaGlMZW5ndGggPSBNYXRoLlBJICogMiwgdGhldGFTdGFydCA9IDAsIHRoZXRhTGVuZ3RoID0gTWF0aC5QSSkgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJTcGhlcmVHZW9tZXRyeSI7CiAgICB0aGlzLnBhcmFtZXRlcnMgPSB7CiAgICAgIHJhZGl1cywKICAgICAgd2lkdGhTZWdtZW50cywKICAgICAgaGVpZ2h0U2VnbWVudHMsCiAgICAgIHBoaVN0YXJ0LAogICAgICBwaGlMZW5ndGgsCiAgICAgIHRoZXRhU3RhcnQsCiAgICAgIHRoZXRhTGVuZ3RoCiAgICB9OwogICAgd2lkdGhTZWdtZW50cyA9IE1hdGgubWF4KDMsIE1hdGguZmxvb3Iod2lkdGhTZWdtZW50cykpOwogICAgaGVpZ2h0U2VnbWVudHMgPSBNYXRoLm1heCgyLCBNYXRoLmZsb29yKGhlaWdodFNlZ21lbnRzKSk7CiAgICBjb25zdCB0aGV0YUVuZCA9IE1hdGgubWluKHRoZXRhU3RhcnQgKyB0aGV0YUxlbmd0aCwgTWF0aC5QSSk7CiAgICBsZXQgaW5kZXggPSAwOwogICAgY29uc3QgZ3JpZCA9IFtdOwogICAgY29uc3QgdmVydGV4MiA9IG5ldyBWZWN0b3IzKCk7CiAgICBjb25zdCBub3JtYWwgPSBuZXcgVmVjdG9yMygpOwogICAgY29uc3QgaW5kaWNlcyA9IFtdOwogICAgY29uc3QgdmVydGljZXMgPSBbXTsKICAgIGNvbnN0IG5vcm1hbHMgPSBbXTsKICAgIGNvbnN0IHV2cyA9IFtdOwogICAgZm9yIChsZXQgaXkgPSAwOyBpeSA8PSBoZWlnaHRTZWdtZW50czsgaXkrKykgewogICAgICBjb25zdCB2ZXJ0aWNlc1JvdyA9IFtdOwogICAgICBjb25zdCB2ID0gaXkgLyBoZWlnaHRTZWdtZW50czsKICAgICAgbGV0IHVPZmZzZXQgPSAwOwogICAgICBpZiAoaXkgPT0gMCAmJiB0aGV0YVN0YXJ0ID09IDApIHsKICAgICAgICB1T2Zmc2V0ID0gMC41IC8gd2lkdGhTZWdtZW50czsKICAgICAgfSBlbHNlIGlmIChpeSA9PSBoZWlnaHRTZWdtZW50cyAmJiB0aGV0YUVuZCA9PSBNYXRoLlBJKSB7CiAgICAgICAgdU9mZnNldCA9IC0wLjUgLyB3aWR0aFNlZ21lbnRzOwogICAgICB9CiAgICAgIGZvciAobGV0IGl4ID0gMDsgaXggPD0gd2lkdGhTZWdtZW50czsgaXgrKykgewogICAgICAgIGNvbnN0IHUgPSBpeCAvIHdpZHRoU2VnbWVudHM7CiAgICAgICAgdmVydGV4Mi54ID0gLXJhZGl1cyAqIE1hdGguY29zKHBoaVN0YXJ0ICsgdSAqIHBoaUxlbmd0aCkgKiBNYXRoLnNpbih0aGV0YVN0YXJ0ICsgdiAqIHRoZXRhTGVuZ3RoKTsKICAgICAgICB2ZXJ0ZXgyLnkgPSByYWRpdXMgKiBNYXRoLmNvcyh0aGV0YVN0YXJ0ICsgdiAqIHRoZXRhTGVuZ3RoKTsKICAgICAgICB2ZXJ0ZXgyLnogPSByYWRpdXMgKiBNYXRoLnNpbihwaGlTdGFydCArIHUgKiBwaGlMZW5ndGgpICogTWF0aC5zaW4odGhldGFTdGFydCArIHYgKiB0aGV0YUxlbmd0aCk7CiAgICAgICAgdmVydGljZXMucHVzaCh2ZXJ0ZXgyLngsIHZlcnRleDIueSwgdmVydGV4Mi56KTsKICAgICAgICBub3JtYWwuY29weSh2ZXJ0ZXgyKS5ub3JtYWxpemUoKTsKICAgICAgICBub3JtYWxzLnB1c2gobm9ybWFsLngsIG5vcm1hbC55LCBub3JtYWwueik7CiAgICAgICAgdXZzLnB1c2godSArIHVPZmZzZXQsIDEgLSB2KTsKICAgICAgICB2ZXJ0aWNlc1Jvdy5wdXNoKGluZGV4KyspOwogICAgICB9CiAgICAgIGdyaWQucHVzaCh2ZXJ0aWNlc1Jvdyk7CiAgICB9CiAgICBmb3IgKGxldCBpeSA9IDA7IGl5IDwgaGVpZ2h0U2VnbWVudHM7IGl5KyspIHsKICAgICAgZm9yIChsZXQgaXggPSAwOyBpeCA8IHdpZHRoU2VnbWVudHM7IGl4KyspIHsKICAgICAgICBjb25zdCBhID0gZ3JpZFtpeV1baXggKyAxXTsKICAgICAgICBjb25zdCBiID0gZ3JpZFtpeV1baXhdOwogICAgICAgIGNvbnN0IGMgPSBncmlkW2l5ICsgMV1baXhdOwogICAgICAgIGNvbnN0IGQgPSBncmlkW2l5ICsgMV1baXggKyAxXTsKICAgICAgICBpZiAoaXkgIT09IDAgfHwgdGhldGFTdGFydCA+IDApCiAgICAgICAgICBpbmRpY2VzLnB1c2goYSwgYiwgZCk7CiAgICAgICAgaWYgKGl5ICE9PSBoZWlnaHRTZWdtZW50cyAtIDEgfHwgdGhldGFFbmQgPCBNYXRoLlBJKQogICAgICAgICAgaW5kaWNlcy5wdXNoKGIsIGMsIGQpOwogICAgICB9CiAgICB9CiAgICB0aGlzLnNldEluZGV4KGluZGljZXMpOwogICAgdGhpcy5zZXRBdHRyaWJ1dGUoInBvc2l0aW9uIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUodmVydGljZXMsIDMpKTsKICAgIHRoaXMuc2V0QXR0cmlidXRlKCJub3JtYWwiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShub3JtYWxzLCAzKSk7CiAgICB0aGlzLnNldEF0dHJpYnV0ZSgidXYiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh1dnMsIDIpKTsKICB9CiAgc3RhdGljIGZyb21KU09OKGRhdGEpIHsKICAgIHJldHVybiBuZXcgU3BoZXJlR2VvbWV0cnkoZGF0YS5yYWRpdXMsIGRhdGEud2lkdGhTZWdtZW50cywgZGF0YS5oZWlnaHRTZWdtZW50cywgZGF0YS5waGlTdGFydCwgZGF0YS5waGlMZW5ndGgsIGRhdGEudGhldGFTdGFydCwgZGF0YS50aGV0YUxlbmd0aCk7CiAgfQp9CmNsYXNzIFRldHJhaGVkcm9uR2VvbWV0cnkgZXh0ZW5kcyBQb2x5aGVkcm9uR2VvbWV0cnkgewogIGNvbnN0cnVjdG9yKHJhZGl1cyA9IDEsIGRldGFpbCA9IDApIHsKICAgIGNvbnN0IHZlcnRpY2VzID0gWwogICAgICAxLAogICAgICAxLAogICAgICAxLAogICAgICAtMSwKICAgICAgLTEsCiAgICAgIDEsCiAgICAgIC0xLAogICAgICAxLAogICAgICAtMSwKICAgICAgMSwKICAgICAgLTEsCiAgICAgIC0xCiAgICBdOwogICAgY29uc3QgaW5kaWNlcyA9IFsKICAgICAgMiwKICAgICAgMSwKICAgICAgMCwKICAgICAgMCwKICAgICAgMywKICAgICAgMiwKICAgICAgMSwKICAgICAgMywKICAgICAgMCwKICAgICAgMiwKICAgICAgMywKICAgICAgMQogICAgXTsKICAgIHN1cGVyKHZlcnRpY2VzLCBpbmRpY2VzLCByYWRpdXMsIGRldGFpbCk7CiAgICB0aGlzLnR5cGUgPSAiVGV0cmFoZWRyb25HZW9tZXRyeSI7CiAgICB0aGlzLnBhcmFtZXRlcnMgPSB7CiAgICAgIHJhZGl1cywKICAgICAgZGV0YWlsCiAgICB9OwogIH0KICBzdGF0aWMgZnJvbUpTT04oZGF0YSkgewogICAgcmV0dXJuIG5ldyBUZXRyYWhlZHJvbkdlb21ldHJ5KGRhdGEucmFkaXVzLCBkYXRhLmRldGFpbCk7CiAgfQp9CmNsYXNzIFRvcnVzR2VvbWV0cnkgZXh0ZW5kcyBCdWZmZXJHZW9tZXRyeSB7CiAgY29uc3RydWN0b3IocmFkaXVzID0gMSwgdHViZSA9IDAuNCwgcmFkaWFsU2VnbWVudHMgPSA4LCB0dWJ1bGFyU2VnbWVudHMgPSA2LCBhcmMgPSBNYXRoLlBJICogMikgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJUb3J1c0dlb21ldHJ5IjsKICAgIHRoaXMucGFyYW1ldGVycyA9IHsKICAgICAgcmFkaXVzLAogICAgICB0dWJlLAogICAgICByYWRpYWxTZWdtZW50cywKICAgICAgdHVidWxhclNlZ21lbnRzLAogICAgICBhcmMKICAgIH07CiAgICByYWRpYWxTZWdtZW50cyA9IE1hdGguZmxvb3IocmFkaWFsU2VnbWVudHMpOwogICAgdHVidWxhclNlZ21lbnRzID0gTWF0aC5mbG9vcih0dWJ1bGFyU2VnbWVudHMpOwogICAgY29uc3QgaW5kaWNlcyA9IFtdOwogICAgY29uc3QgdmVydGljZXMgPSBbXTsKICAgIGNvbnN0IG5vcm1hbHMgPSBbXTsKICAgIGNvbnN0IHV2cyA9IFtdOwogICAgY29uc3QgY2VudGVyID0gbmV3IFZlY3RvcjMoKTsKICAgIGNvbnN0IHZlcnRleDIgPSBuZXcgVmVjdG9yMygpOwogICAgY29uc3Qgbm9ybWFsID0gbmV3IFZlY3RvcjMoKTsKICAgIGZvciAobGV0IGogPSAwOyBqIDw9IHJhZGlhbFNlZ21lbnRzOyBqKyspIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gdHVidWxhclNlZ21lbnRzOyBpKyspIHsKICAgICAgICBjb25zdCB1ID0gaSAvIHR1YnVsYXJTZWdtZW50cyAqIGFyYzsKICAgICAgICBjb25zdCB2ID0gaiAvIHJhZGlhbFNlZ21lbnRzICogTWF0aC5QSSAqIDI7CiAgICAgICAgdmVydGV4Mi54ID0gKHJhZGl1cyArIHR1YmUgKiBNYXRoLmNvcyh2KSkgKiBNYXRoLmNvcyh1KTsKICAgICAgICB2ZXJ0ZXgyLnkgPSAocmFkaXVzICsgdHViZSAqIE1hdGguY29zKHYpKSAqIE1hdGguc2luKHUpOwogICAgICAgIHZlcnRleDIueiA9IHR1YmUgKiBNYXRoLnNpbih2KTsKICAgICAgICB2ZXJ0aWNlcy5wdXNoKHZlcnRleDIueCwgdmVydGV4Mi55LCB2ZXJ0ZXgyLnopOwogICAgICAgIGNlbnRlci54ID0gcmFkaXVzICogTWF0aC5jb3ModSk7CiAgICAgICAgY2VudGVyLnkgPSByYWRpdXMgKiBNYXRoLnNpbih1KTsKICAgICAgICBub3JtYWwuc3ViVmVjdG9ycyh2ZXJ0ZXgyLCBjZW50ZXIpLm5vcm1hbGl6ZSgpOwogICAgICAgIG5vcm1hbHMucHVzaChub3JtYWwueCwgbm9ybWFsLnksIG5vcm1hbC56KTsKICAgICAgICB1dnMucHVzaChpIC8gdHVidWxhclNlZ21lbnRzKTsKICAgICAgICB1dnMucHVzaChqIC8gcmFkaWFsU2VnbWVudHMpOwogICAgICB9CiAgICB9CiAgICBmb3IgKGxldCBqID0gMTsgaiA8PSByYWRpYWxTZWdtZW50czsgaisrKSB7CiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHR1YnVsYXJTZWdtZW50czsgaSsrKSB7CiAgICAgICAgY29uc3QgYSA9ICh0dWJ1bGFyU2VnbWVudHMgKyAxKSAqIGogKyBpIC0gMTsKICAgICAgICBjb25zdCBiID0gKHR1YnVsYXJTZWdtZW50cyArIDEpICogKGogLSAxKSArIGkgLSAxOwogICAgICAgIGNvbnN0IGMgPSAodHVidWxhclNlZ21lbnRzICsgMSkgKiAoaiAtIDEpICsgaTsKICAgICAgICBjb25zdCBkID0gKHR1YnVsYXJTZWdtZW50cyArIDEpICogaiArIGk7CiAgICAgICAgaW5kaWNlcy5wdXNoKGEsIGIsIGQpOwogICAgICAgIGluZGljZXMucHVzaChiLCBjLCBkKTsKICAgICAgfQogICAgfQogICAgdGhpcy5zZXRJbmRleChpbmRpY2VzKTsKICAgIHRoaXMuc2V0QXR0cmlidXRlKCJwb3NpdGlvbiIsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKHZlcnRpY2VzLCAzKSk7CiAgICB0aGlzLnNldEF0dHJpYnV0ZSgibm9ybWFsIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUobm9ybWFscywgMykpOwogICAgdGhpcy5zZXRBdHRyaWJ1dGUoInV2IiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUodXZzLCAyKSk7CiAgfQogIHN0YXRpYyBmcm9tSlNPTihkYXRhKSB7CiAgICByZXR1cm4gbmV3IFRvcnVzR2VvbWV0cnkoZGF0YS5yYWRpdXMsIGRhdGEudHViZSwgZGF0YS5yYWRpYWxTZWdtZW50cywgZGF0YS50dWJ1bGFyU2VnbWVudHMsIGRhdGEuYXJjKTsKICB9Cn0KY2xhc3MgVG9ydXNLbm90R2VvbWV0cnkgZXh0ZW5kcyBCdWZmZXJHZW9tZXRyeSB7CiAgY29uc3RydWN0b3IocmFkaXVzID0gMSwgdHViZSA9IDAuNCwgdHVidWxhclNlZ21lbnRzID0gNjQsIHJhZGlhbFNlZ21lbnRzID0gOCwgcCA9IDIsIHEgPSAzKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIlRvcnVzS25vdEdlb21ldHJ5IjsKICAgIHRoaXMucGFyYW1ldGVycyA9IHsKICAgICAgcmFkaXVzLAogICAgICB0dWJlLAogICAgICB0dWJ1bGFyU2VnbWVudHMsCiAgICAgIHJhZGlhbFNlZ21lbnRzLAogICAgICBwLAogICAgICBxCiAgICB9OwogICAgdHVidWxhclNlZ21lbnRzID0gTWF0aC5mbG9vcih0dWJ1bGFyU2VnbWVudHMpOwogICAgcmFkaWFsU2VnbWVudHMgPSBNYXRoLmZsb29yKHJhZGlhbFNlZ21lbnRzKTsKICAgIGNvbnN0IGluZGljZXMgPSBbXTsKICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICBjb25zdCBub3JtYWxzID0gW107CiAgICBjb25zdCB1dnMgPSBbXTsKICAgIGNvbnN0IHZlcnRleDIgPSBuZXcgVmVjdG9yMygpOwogICAgY29uc3Qgbm9ybWFsID0gbmV3IFZlY3RvcjMoKTsKICAgIGNvbnN0IFAxID0gbmV3IFZlY3RvcjMoKTsKICAgIGNvbnN0IFAyID0gbmV3IFZlY3RvcjMoKTsKICAgIGNvbnN0IEIgPSBuZXcgVmVjdG9yMygpOwogICAgY29uc3QgVCA9IG5ldyBWZWN0b3IzKCk7CiAgICBjb25zdCBOID0gbmV3IFZlY3RvcjMoKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IHR1YnVsYXJTZWdtZW50czsgKytpKSB7CiAgICAgIGNvbnN0IHUgPSBpIC8gdHVidWxhclNlZ21lbnRzICogcCAqIE1hdGguUEkgKiAyOwogICAgICBjYWxjdWxhdGVQb3NpdGlvbk9uQ3VydmUodSwgcCwgcSwgcmFkaXVzLCBQMSk7CiAgICAgIGNhbGN1bGF0ZVBvc2l0aW9uT25DdXJ2ZSh1ICsgMC4wMSwgcCwgcSwgcmFkaXVzLCBQMik7CiAgICAgIFQuc3ViVmVjdG9ycyhQMiwgUDEpOwogICAgICBOLmFkZFZlY3RvcnMoUDIsIFAxKTsKICAgICAgQi5jcm9zc1ZlY3RvcnMoVCwgTik7CiAgICAgIE4uY3Jvc3NWZWN0b3JzKEIsIFQpOwogICAgICBCLm5vcm1hbGl6ZSgpOwogICAgICBOLm5vcm1hbGl6ZSgpOwogICAgICBmb3IgKGxldCBqID0gMDsgaiA8PSByYWRpYWxTZWdtZW50czsgKytqKSB7CiAgICAgICAgY29uc3QgdiA9IGogLyByYWRpYWxTZWdtZW50cyAqIE1hdGguUEkgKiAyOwogICAgICAgIGNvbnN0IGN4ID0gLXR1YmUgKiBNYXRoLmNvcyh2KTsKICAgICAgICBjb25zdCBjeSA9IHR1YmUgKiBNYXRoLnNpbih2KTsKICAgICAgICB2ZXJ0ZXgyLnggPSBQMS54ICsgKGN4ICogTi54ICsgY3kgKiBCLngpOwogICAgICAgIHZlcnRleDIueSA9IFAxLnkgKyAoY3ggKiBOLnkgKyBjeSAqIEIueSk7CiAgICAgICAgdmVydGV4Mi56ID0gUDEueiArIChjeCAqIE4ueiArIGN5ICogQi56KTsKICAgICAgICB2ZXJ0aWNlcy5wdXNoKHZlcnRleDIueCwgdmVydGV4Mi55LCB2ZXJ0ZXgyLnopOwogICAgICAgIG5vcm1hbC5zdWJWZWN0b3JzKHZlcnRleDIsIFAxKS5ub3JtYWxpemUoKTsKICAgICAgICBub3JtYWxzLnB1c2gobm9ybWFsLngsIG5vcm1hbC55LCBub3JtYWwueik7CiAgICAgICAgdXZzLnB1c2goaSAvIHR1YnVsYXJTZWdtZW50cyk7CiAgICAgICAgdXZzLnB1c2goaiAvIHJhZGlhbFNlZ21lbnRzKTsKICAgICAgfQogICAgfQogICAgZm9yIChsZXQgaiA9IDE7IGogPD0gdHVidWxhclNlZ21lbnRzOyBqKyspIHsKICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gcmFkaWFsU2VnbWVudHM7IGkrKykgewogICAgICAgIGNvbnN0IGEgPSAocmFkaWFsU2VnbWVudHMgKyAxKSAqIChqIC0gMSkgKyAoaSAtIDEpOwogICAgICAgIGNvbnN0IGIgPSAocmFkaWFsU2VnbWVudHMgKyAxKSAqIGogKyAoaSAtIDEpOwogICAgICAgIGNvbnN0IGMgPSAocmFkaWFsU2VnbWVudHMgKyAxKSAqIGogKyBpOwogICAgICAgIGNvbnN0IGQgPSAocmFkaWFsU2VnbWVudHMgKyAxKSAqIChqIC0gMSkgKyBpOwogICAgICAgIGluZGljZXMucHVzaChhLCBiLCBkKTsKICAgICAgICBpbmRpY2VzLnB1c2goYiwgYywgZCk7CiAgICAgIH0KICAgIH0KICAgIHRoaXMuc2V0SW5kZXgoaW5kaWNlcyk7CiAgICB0aGlzLnNldEF0dHJpYnV0ZSgicG9zaXRpb24iLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh2ZXJ0aWNlcywgMykpOwogICAgdGhpcy5zZXRBdHRyaWJ1dGUoIm5vcm1hbCIsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKG5vcm1hbHMsIDMpKTsKICAgIHRoaXMuc2V0QXR0cmlidXRlKCJ1diIsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKHV2cywgMikpOwogICAgZnVuY3Rpb24gY2FsY3VsYXRlUG9zaXRpb25PbkN1cnZlKHUsIHAyLCBxMiwgcmFkaXVzMiwgcG9zaXRpb24pIHsKICAgICAgY29uc3QgY3UgPSBNYXRoLmNvcyh1KTsKICAgICAgY29uc3Qgc3UgPSBNYXRoLnNpbih1KTsKICAgICAgY29uc3QgcXVPdmVyUCA9IHEyIC8gcDIgKiB1OwogICAgICBjb25zdCBjcyA9IE1hdGguY29zKHF1T3ZlclApOwogICAgICBwb3NpdGlvbi54ID0gcmFkaXVzMiAqICgyICsgY3MpICogMC41ICogY3U7CiAgICAgIHBvc2l0aW9uLnkgPSByYWRpdXMyICogKDIgKyBjcykgKiBzdSAqIDAuNTsKICAgICAgcG9zaXRpb24ueiA9IHJhZGl1czIgKiBNYXRoLnNpbihxdU92ZXJQKSAqIDAuNTsKICAgIH0KICB9CiAgc3RhdGljIGZyb21KU09OKGRhdGEpIHsKICAgIHJldHVybiBuZXcgVG9ydXNLbm90R2VvbWV0cnkoZGF0YS5yYWRpdXMsIGRhdGEudHViZSwgZGF0YS50dWJ1bGFyU2VnbWVudHMsIGRhdGEucmFkaWFsU2VnbWVudHMsIGRhdGEucCwgZGF0YS5xKTsKICB9Cn0KY2xhc3MgVHViZUdlb21ldHJ5IGV4dGVuZHMgQnVmZmVyR2VvbWV0cnkgewogIGNvbnN0cnVjdG9yKHBhdGggPSBuZXcgUXVhZHJhdGljQmV6aWVyQ3VydmUzKG5ldyBWZWN0b3IzKC0xLCAtMSwgMCksIG5ldyBWZWN0b3IzKC0xLCAxLCAwKSwgbmV3IFZlY3RvcjMoMSwgMSwgMCkpLCB0dWJ1bGFyU2VnbWVudHMgPSA2NCwgcmFkaXVzID0gMSwgcmFkaWFsU2VnbWVudHMgPSA4LCBjbG9zZWQgPSBmYWxzZSkgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJUdWJlR2VvbWV0cnkiOwogICAgdGhpcy5wYXJhbWV0ZXJzID0gewogICAgICBwYXRoLAogICAgICB0dWJ1bGFyU2VnbWVudHMsCiAgICAgIHJhZGl1cywKICAgICAgcmFkaWFsU2VnbWVudHMsCiAgICAgIGNsb3NlZAogICAgfTsKICAgIGNvbnN0IGZyYW1lcyA9IHBhdGguY29tcHV0ZUZyZW5ldEZyYW1lcyh0dWJ1bGFyU2VnbWVudHMsIGNsb3NlZCk7CiAgICB0aGlzLnRhbmdlbnRzID0gZnJhbWVzLnRhbmdlbnRzOwogICAgdGhpcy5ub3JtYWxzID0gZnJhbWVzLm5vcm1hbHM7CiAgICB0aGlzLmJpbm9ybWFscyA9IGZyYW1lcy5iaW5vcm1hbHM7CiAgICBjb25zdCB2ZXJ0ZXgyID0gbmV3IFZlY3RvcjMoKTsKICAgIGNvbnN0IG5vcm1hbCA9IG5ldyBWZWN0b3IzKCk7CiAgICBjb25zdCB1diA9IG5ldyBWZWN0b3IyKCk7CiAgICBsZXQgUCA9IG5ldyBWZWN0b3IzKCk7CiAgICBjb25zdCB2ZXJ0aWNlcyA9IFtdOwogICAgY29uc3Qgbm9ybWFscyA9IFtdOwogICAgY29uc3QgdXZzID0gW107CiAgICBjb25zdCBpbmRpY2VzID0gW107CiAgICBnZW5lcmF0ZUJ1ZmZlckRhdGEoKTsKICAgIHRoaXMuc2V0SW5kZXgoaW5kaWNlcyk7CiAgICB0aGlzLnNldEF0dHJpYnV0ZSgicG9zaXRpb24iLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh2ZXJ0aWNlcywgMykpOwogICAgdGhpcy5zZXRBdHRyaWJ1dGUoIm5vcm1hbCIsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKG5vcm1hbHMsIDMpKTsKICAgIHRoaXMuc2V0QXR0cmlidXRlKCJ1diIsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKHV2cywgMikpOwogICAgZnVuY3Rpb24gZ2VuZXJhdGVCdWZmZXJEYXRhKCkgewogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHR1YnVsYXJTZWdtZW50czsgaSsrKSB7CiAgICAgICAgZ2VuZXJhdGVTZWdtZW50KGkpOwogICAgICB9CiAgICAgIGdlbmVyYXRlU2VnbWVudChjbG9zZWQgPT09IGZhbHNlID8gdHVidWxhclNlZ21lbnRzIDogMCk7CiAgICAgIGdlbmVyYXRlVVZzKCk7CiAgICAgIGdlbmVyYXRlSW5kaWNlcygpOwogICAgfQogICAgZnVuY3Rpb24gZ2VuZXJhdGVTZWdtZW50KGkpIHsKICAgICAgUCA9IHBhdGguZ2V0UG9pbnRBdChpIC8gdHVidWxhclNlZ21lbnRzLCBQKTsKICAgICAgY29uc3QgTiA9IGZyYW1lcy5ub3JtYWxzW2ldOwogICAgICBjb25zdCBCID0gZnJhbWVzLmJpbm9ybWFsc1tpXTsKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPD0gcmFkaWFsU2VnbWVudHM7IGorKykgewogICAgICAgIGNvbnN0IHYgPSBqIC8gcmFkaWFsU2VnbWVudHMgKiBNYXRoLlBJICogMjsKICAgICAgICBjb25zdCBzaW4gPSBNYXRoLnNpbih2KTsKICAgICAgICBjb25zdCBjb3MgPSAtTWF0aC5jb3Modik7CiAgICAgICAgbm9ybWFsLnggPSBjb3MgKiBOLnggKyBzaW4gKiBCLng7CiAgICAgICAgbm9ybWFsLnkgPSBjb3MgKiBOLnkgKyBzaW4gKiBCLnk7CiAgICAgICAgbm9ybWFsLnogPSBjb3MgKiBOLnogKyBzaW4gKiBCLno7CiAgICAgICAgbm9ybWFsLm5vcm1hbGl6ZSgpOwogICAgICAgIG5vcm1hbHMucHVzaChub3JtYWwueCwgbm9ybWFsLnksIG5vcm1hbC56KTsKICAgICAgICB2ZXJ0ZXgyLnggPSBQLnggKyByYWRpdXMgKiBub3JtYWwueDsKICAgICAgICB2ZXJ0ZXgyLnkgPSBQLnkgKyByYWRpdXMgKiBub3JtYWwueTsKICAgICAgICB2ZXJ0ZXgyLnogPSBQLnogKyByYWRpdXMgKiBub3JtYWwuejsKICAgICAgICB2ZXJ0aWNlcy5wdXNoKHZlcnRleDIueCwgdmVydGV4Mi55LCB2ZXJ0ZXgyLnopOwogICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBnZW5lcmF0ZUluZGljZXMoKSB7CiAgICAgIGZvciAobGV0IGogPSAxOyBqIDw9IHR1YnVsYXJTZWdtZW50czsgaisrKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gcmFkaWFsU2VnbWVudHM7IGkrKykgewogICAgICAgICAgY29uc3QgYSA9IChyYWRpYWxTZWdtZW50cyArIDEpICogKGogLSAxKSArIChpIC0gMSk7CiAgICAgICAgICBjb25zdCBiID0gKHJhZGlhbFNlZ21lbnRzICsgMSkgKiBqICsgKGkgLSAxKTsKICAgICAgICAgIGNvbnN0IGMgPSAocmFkaWFsU2VnbWVudHMgKyAxKSAqIGogKyBpOwogICAgICAgICAgY29uc3QgZCA9IChyYWRpYWxTZWdtZW50cyArIDEpICogKGogLSAxKSArIGk7CiAgICAgICAgICBpbmRpY2VzLnB1c2goYSwgYiwgZCk7CiAgICAgICAgICBpbmRpY2VzLnB1c2goYiwgYywgZCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBnZW5lcmF0ZVVWcygpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gdHVidWxhclNlZ21lbnRzOyBpKyspIHsKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8PSByYWRpYWxTZWdtZW50czsgaisrKSB7CiAgICAgICAgICB1di54ID0gaSAvIHR1YnVsYXJTZWdtZW50czsKICAgICAgICAgIHV2LnkgPSBqIC8gcmFkaWFsU2VnbWVudHM7CiAgICAgICAgICB1dnMucHVzaCh1di54LCB1di55KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgdG9KU09OKCkgewogICAgY29uc3QgZGF0YSA9IHN1cGVyLnRvSlNPTigpOwogICAgZGF0YS5wYXRoID0gdGhpcy5wYXJhbWV0ZXJzLnBhdGgudG9KU09OKCk7CiAgICByZXR1cm4gZGF0YTsKICB9CiAgc3RhdGljIGZyb21KU09OKGRhdGEpIHsKICAgIHJldHVybiBuZXcgVHViZUdlb21ldHJ5KG5ldyBDdXJ2ZXNbZGF0YS5wYXRoLnR5cGVdKCkuZnJvbUpTT04oZGF0YS5wYXRoKSwgZGF0YS50dWJ1bGFyU2VnbWVudHMsIGRhdGEucmFkaXVzLCBkYXRhLnJhZGlhbFNlZ21lbnRzLCBkYXRhLmNsb3NlZCk7CiAgfQp9CmNsYXNzIFdpcmVmcmFtZUdlb21ldHJ5IGV4dGVuZHMgQnVmZmVyR2VvbWV0cnkgewogIGNvbnN0cnVjdG9yKGdlb21ldHJ5ID0gbnVsbCkgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJXaXJlZnJhbWVHZW9tZXRyeSI7CiAgICB0aGlzLnBhcmFtZXRlcnMgPSB7CiAgICAgIGdlb21ldHJ5CiAgICB9OwogICAgaWYgKGdlb21ldHJ5ICE9PSBudWxsKSB7CiAgICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICAgIGNvbnN0IGVkZ2VzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTsKICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgVmVjdG9yMygpOwogICAgICBjb25zdCBlbmQgPSBuZXcgVmVjdG9yMygpOwogICAgICBpZiAoZ2VvbWV0cnkuaW5kZXggIT09IG51bGwpIHsKICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb247CiAgICAgICAgY29uc3QgaW5kaWNlcyA9IGdlb21ldHJ5LmluZGV4OwogICAgICAgIGxldCBncm91cHMgPSBnZW9tZXRyeS5ncm91cHM7CiAgICAgICAgaWYgKGdyb3Vwcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgIGdyb3VwcyA9IFt7IHN0YXJ0OiAwLCBjb3VudDogaW5kaWNlcy5jb3VudCwgbWF0ZXJpYWxJbmRleDogMCB9XTsKICAgICAgICB9CiAgICAgICAgZm9yIChsZXQgbyA9IDAsIG9sID0gZ3JvdXBzLmxlbmd0aDsgbyA8IG9sOyArK28pIHsKICAgICAgICAgIGNvbnN0IGdyb3VwID0gZ3JvdXBzW29dOwogICAgICAgICAgY29uc3QgZ3JvdXBTdGFydCA9IGdyb3VwLnN0YXJ0OwogICAgICAgICAgY29uc3QgZ3JvdXBDb3VudCA9IGdyb3VwLmNvdW50OwogICAgICAgICAgZm9yIChsZXQgaSA9IGdyb3VwU3RhcnQsIGwgPSBncm91cFN0YXJ0ICsgZ3JvdXBDb3VudDsgaSA8IGw7IGkgKz0gMykgewogICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgICAgIGNvbnN0IGluZGV4MSA9IGluZGljZXMuZ2V0WChpICsgaik7CiAgICAgICAgICAgICAgY29uc3QgaW5kZXgyID0gaW5kaWNlcy5nZXRYKGkgKyAoaiArIDEpICUgMyk7CiAgICAgICAgICAgICAgc3RhcnQuZnJvbUJ1ZmZlckF0dHJpYnV0ZShwb3NpdGlvbiwgaW5kZXgxKTsKICAgICAgICAgICAgICBlbmQuZnJvbUJ1ZmZlckF0dHJpYnV0ZShwb3NpdGlvbiwgaW5kZXgyKTsKICAgICAgICAgICAgICBpZiAoaXNVbmlxdWVFZGdlKHN0YXJ0LCBlbmQsIGVkZ2VzKSA9PT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgdmVydGljZXMucHVzaChzdGFydC54LCBzdGFydC55LCBzdGFydC56KTsKICAgICAgICAgICAgICAgIHZlcnRpY2VzLnB1c2goZW5kLngsIGVuZC55LCBlbmQueik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IHBvc2l0aW9uID0gZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbjsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHBvc2l0aW9uLmNvdW50IC8gMzsgaSA8IGw7IGkrKykgewogICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICAgICAgY29uc3QgaW5kZXgxID0gMyAqIGkgKyBqOwogICAgICAgICAgICBjb25zdCBpbmRleDIgPSAzICogaSArIChqICsgMSkgJSAzOwogICAgICAgICAgICBzdGFydC5mcm9tQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9uLCBpbmRleDEpOwogICAgICAgICAgICBlbmQuZnJvbUJ1ZmZlckF0dHJpYnV0ZShwb3NpdGlvbiwgaW5kZXgyKTsKICAgICAgICAgICAgaWYgKGlzVW5pcXVlRWRnZShzdGFydCwgZW5kLCBlZGdlcykgPT09IHRydWUpIHsKICAgICAgICAgICAgICB2ZXJ0aWNlcy5wdXNoKHN0YXJ0LngsIHN0YXJ0LnksIHN0YXJ0LnopOwogICAgICAgICAgICAgIHZlcnRpY2VzLnB1c2goZW5kLngsIGVuZC55LCBlbmQueik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoInBvc2l0aW9uIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUodmVydGljZXMsIDMpKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gaXNVbmlxdWVFZGdlKHN0YXJ0LCBlbmQsIGVkZ2VzKSB7CiAgY29uc3QgaGFzaDEgPSBgJHtzdGFydC54fSwke3N0YXJ0Lnl9LCR7c3RhcnQuen0tJHtlbmQueH0sJHtlbmQueX0sJHtlbmQuen1gOwogIGNvbnN0IGhhc2gyID0gYCR7ZW5kLnh9LCR7ZW5kLnl9LCR7ZW5kLnp9LSR7c3RhcnQueH0sJHtzdGFydC55fSwke3N0YXJ0Lnp9YDsKICBpZiAoZWRnZXMuaGFzKGhhc2gxKSA9PT0gdHJ1ZSB8fCBlZGdlcy5oYXMoaGFzaDIpID09PSB0cnVlKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfSBlbHNlIHsKICAgIGVkZ2VzLmFkZChoYXNoMSwgaGFzaDIpOwogICAgcmV0dXJuIHRydWU7CiAgfQp9CnZhciBHZW9tZXRyaWVzID0gLyogQF9fUFVSRV9fICovIE9iamVjdC5mcmVlemUoewogIF9fcHJvdG9fXzogbnVsbCwKICBCb3hHZW9tZXRyeSwKICBCb3hCdWZmZXJHZW9tZXRyeTogQm94R2VvbWV0cnksCiAgQ2lyY2xlR2VvbWV0cnksCiAgQ2lyY2xlQnVmZmVyR2VvbWV0cnk6IENpcmNsZUdlb21ldHJ5LAogIENvbmVHZW9tZXRyeSwKICBDb25lQnVmZmVyR2VvbWV0cnk6IENvbmVHZW9tZXRyeSwKICBDeWxpbmRlckdlb21ldHJ5LAogIEN5bGluZGVyQnVmZmVyR2VvbWV0cnk6IEN5bGluZGVyR2VvbWV0cnksCiAgRG9kZWNhaGVkcm9uR2VvbWV0cnksCiAgRG9kZWNhaGVkcm9uQnVmZmVyR2VvbWV0cnk6IERvZGVjYWhlZHJvbkdlb21ldHJ5LAogIEVkZ2VzR2VvbWV0cnksCiAgRXh0cnVkZUdlb21ldHJ5LAogIEV4dHJ1ZGVCdWZmZXJHZW9tZXRyeTogRXh0cnVkZUdlb21ldHJ5LAogIEljb3NhaGVkcm9uR2VvbWV0cnksCiAgSWNvc2FoZWRyb25CdWZmZXJHZW9tZXRyeTogSWNvc2FoZWRyb25HZW9tZXRyeSwKICBMYXRoZUdlb21ldHJ5LAogIExhdGhlQnVmZmVyR2VvbWV0cnk6IExhdGhlR2VvbWV0cnksCiAgT2N0YWhlZHJvbkdlb21ldHJ5LAogIE9jdGFoZWRyb25CdWZmZXJHZW9tZXRyeTogT2N0YWhlZHJvbkdlb21ldHJ5LAogIFBsYW5lR2VvbWV0cnksCiAgUGxhbmVCdWZmZXJHZW9tZXRyeTogUGxhbmVHZW9tZXRyeSwKICBQb2x5aGVkcm9uR2VvbWV0cnksCiAgUG9seWhlZHJvbkJ1ZmZlckdlb21ldHJ5OiBQb2x5aGVkcm9uR2VvbWV0cnksCiAgUmluZ0dlb21ldHJ5LAogIFJpbmdCdWZmZXJHZW9tZXRyeTogUmluZ0dlb21ldHJ5LAogIFNoYXBlR2VvbWV0cnksCiAgU2hhcGVCdWZmZXJHZW9tZXRyeTogU2hhcGVHZW9tZXRyeSwKICBTcGhlcmVHZW9tZXRyeSwKICBTcGhlcmVCdWZmZXJHZW9tZXRyeTogU3BoZXJlR2VvbWV0cnksCiAgVGV0cmFoZWRyb25HZW9tZXRyeSwKICBUZXRyYWhlZHJvbkJ1ZmZlckdlb21ldHJ5OiBUZXRyYWhlZHJvbkdlb21ldHJ5LAogIFRvcnVzR2VvbWV0cnksCiAgVG9ydXNCdWZmZXJHZW9tZXRyeTogVG9ydXNHZW9tZXRyeSwKICBUb3J1c0tub3RHZW9tZXRyeSwKICBUb3J1c0tub3RCdWZmZXJHZW9tZXRyeTogVG9ydXNLbm90R2VvbWV0cnksCiAgVHViZUdlb21ldHJ5LAogIFR1YmVCdWZmZXJHZW9tZXRyeTogVHViZUdlb21ldHJ5LAogIFdpcmVmcmFtZUdlb21ldHJ5Cn0pOwpjbGFzcyBTaGFkb3dNYXRlcmlhbCBleHRlbmRzIE1hdGVyaWFsIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIlNoYWRvd01hdGVyaWFsIjsKICAgIHRoaXMuY29sb3IgPSBuZXcgQ29sb3IoMCk7CiAgICB0aGlzLnRyYW5zcGFyZW50ID0gdHJ1ZTsKICAgIHRoaXMuc2V0VmFsdWVzKHBhcmFtZXRlcnMpOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy5jb2xvci5jb3B5KHNvdXJjZS5jb2xvcik7CiAgICByZXR1cm4gdGhpczsKICB9Cn0KU2hhZG93TWF0ZXJpYWwucHJvdG90eXBlLmlzU2hhZG93TWF0ZXJpYWwgPSB0cnVlOwpjbGFzcyBNZXNoU3RhbmRhcmRNYXRlcmlhbCBleHRlbmRzIE1hdGVyaWFsIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5kZWZpbmVzID0geyAiU1RBTkRBUkQiOiAiIiB9OwogICAgdGhpcy50eXBlID0gIk1lc2hTdGFuZGFyZE1hdGVyaWFsIjsKICAgIHRoaXMuY29sb3IgPSBuZXcgQ29sb3IoMTY3NzcyMTUpOwogICAgdGhpcy5yb3VnaG5lc3MgPSAxOwogICAgdGhpcy5tZXRhbG5lc3MgPSAwOwogICAgdGhpcy5tYXAgPSBudWxsOwogICAgdGhpcy5saWdodE1hcCA9IG51bGw7CiAgICB0aGlzLmxpZ2h0TWFwSW50ZW5zaXR5ID0gMTsKICAgIHRoaXMuYW9NYXAgPSBudWxsOwogICAgdGhpcy5hb01hcEludGVuc2l0eSA9IDE7CiAgICB0aGlzLmVtaXNzaXZlID0gbmV3IENvbG9yKDApOwogICAgdGhpcy5lbWlzc2l2ZUludGVuc2l0eSA9IDE7CiAgICB0aGlzLmVtaXNzaXZlTWFwID0gbnVsbDsKICAgIHRoaXMuYnVtcE1hcCA9IG51bGw7CiAgICB0aGlzLmJ1bXBTY2FsZSA9IDE7CiAgICB0aGlzLm5vcm1hbE1hcCA9IG51bGw7CiAgICB0aGlzLm5vcm1hbE1hcFR5cGUgPSBUYW5nZW50U3BhY2VOb3JtYWxNYXA7CiAgICB0aGlzLm5vcm1hbFNjYWxlID0gbmV3IFZlY3RvcjIoMSwgMSk7CiAgICB0aGlzLmRpc3BsYWNlbWVudE1hcCA9IG51bGw7CiAgICB0aGlzLmRpc3BsYWNlbWVudFNjYWxlID0gMTsKICAgIHRoaXMuZGlzcGxhY2VtZW50QmlhcyA9IDA7CiAgICB0aGlzLnJvdWdobmVzc01hcCA9IG51bGw7CiAgICB0aGlzLm1ldGFsbmVzc01hcCA9IG51bGw7CiAgICB0aGlzLmFscGhhTWFwID0gbnVsbDsKICAgIHRoaXMuZW52TWFwID0gbnVsbDsKICAgIHRoaXMuZW52TWFwSW50ZW5zaXR5ID0gMTsKICAgIHRoaXMucmVmcmFjdGlvblJhdGlvID0gMC45ODsKICAgIHRoaXMud2lyZWZyYW1lID0gZmFsc2U7CiAgICB0aGlzLndpcmVmcmFtZUxpbmV3aWR0aCA9IDE7CiAgICB0aGlzLndpcmVmcmFtZUxpbmVjYXAgPSAicm91bmQiOwogICAgdGhpcy53aXJlZnJhbWVMaW5lam9pbiA9ICJyb3VuZCI7CiAgICB0aGlzLmZsYXRTaGFkaW5nID0gZmFsc2U7CiAgICB0aGlzLnNldFZhbHVlcyhwYXJhbWV0ZXJzKTsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHN1cGVyLmNvcHkoc291cmNlKTsKICAgIHRoaXMuZGVmaW5lcyA9IHsgIlNUQU5EQVJEIjogIiIgfTsKICAgIHRoaXMuY29sb3IuY29weShzb3VyY2UuY29sb3IpOwogICAgdGhpcy5yb3VnaG5lc3MgPSBzb3VyY2Uucm91Z2huZXNzOwogICAgdGhpcy5tZXRhbG5lc3MgPSBzb3VyY2UubWV0YWxuZXNzOwogICAgdGhpcy5tYXAgPSBzb3VyY2UubWFwOwogICAgdGhpcy5saWdodE1hcCA9IHNvdXJjZS5saWdodE1hcDsKICAgIHRoaXMubGlnaHRNYXBJbnRlbnNpdHkgPSBzb3VyY2UubGlnaHRNYXBJbnRlbnNpdHk7CiAgICB0aGlzLmFvTWFwID0gc291cmNlLmFvTWFwOwogICAgdGhpcy5hb01hcEludGVuc2l0eSA9IHNvdXJjZS5hb01hcEludGVuc2l0eTsKICAgIHRoaXMuZW1pc3NpdmUuY29weShzb3VyY2UuZW1pc3NpdmUpOwogICAgdGhpcy5lbWlzc2l2ZU1hcCA9IHNvdXJjZS5lbWlzc2l2ZU1hcDsKICAgIHRoaXMuZW1pc3NpdmVJbnRlbnNpdHkgPSBzb3VyY2UuZW1pc3NpdmVJbnRlbnNpdHk7CiAgICB0aGlzLmJ1bXBNYXAgPSBzb3VyY2UuYnVtcE1hcDsKICAgIHRoaXMuYnVtcFNjYWxlID0gc291cmNlLmJ1bXBTY2FsZTsKICAgIHRoaXMubm9ybWFsTWFwID0gc291cmNlLm5vcm1hbE1hcDsKICAgIHRoaXMubm9ybWFsTWFwVHlwZSA9IHNvdXJjZS5ub3JtYWxNYXBUeXBlOwogICAgdGhpcy5ub3JtYWxTY2FsZS5jb3B5KHNvdXJjZS5ub3JtYWxTY2FsZSk7CiAgICB0aGlzLmRpc3BsYWNlbWVudE1hcCA9IHNvdXJjZS5kaXNwbGFjZW1lbnRNYXA7CiAgICB0aGlzLmRpc3BsYWNlbWVudFNjYWxlID0gc291cmNlLmRpc3BsYWNlbWVudFNjYWxlOwogICAgdGhpcy5kaXNwbGFjZW1lbnRCaWFzID0gc291cmNlLmRpc3BsYWNlbWVudEJpYXM7CiAgICB0aGlzLnJvdWdobmVzc01hcCA9IHNvdXJjZS5yb3VnaG5lc3NNYXA7CiAgICB0aGlzLm1ldGFsbmVzc01hcCA9IHNvdXJjZS5tZXRhbG5lc3NNYXA7CiAgICB0aGlzLmFscGhhTWFwID0gc291cmNlLmFscGhhTWFwOwogICAgdGhpcy5lbnZNYXAgPSBzb3VyY2UuZW52TWFwOwogICAgdGhpcy5lbnZNYXBJbnRlbnNpdHkgPSBzb3VyY2UuZW52TWFwSW50ZW5zaXR5OwogICAgdGhpcy5yZWZyYWN0aW9uUmF0aW8gPSBzb3VyY2UucmVmcmFjdGlvblJhdGlvOwogICAgdGhpcy53aXJlZnJhbWUgPSBzb3VyY2Uud2lyZWZyYW1lOwogICAgdGhpcy53aXJlZnJhbWVMaW5ld2lkdGggPSBzb3VyY2Uud2lyZWZyYW1lTGluZXdpZHRoOwogICAgdGhpcy53aXJlZnJhbWVMaW5lY2FwID0gc291cmNlLndpcmVmcmFtZUxpbmVjYXA7CiAgICB0aGlzLndpcmVmcmFtZUxpbmVqb2luID0gc291cmNlLndpcmVmcmFtZUxpbmVqb2luOwogICAgdGhpcy5mbGF0U2hhZGluZyA9IHNvdXJjZS5mbGF0U2hhZGluZzsKICAgIHJldHVybiB0aGlzOwogIH0KfQpNZXNoU3RhbmRhcmRNYXRlcmlhbC5wcm90b3R5cGUuaXNNZXNoU3RhbmRhcmRNYXRlcmlhbCA9IHRydWU7CmNsYXNzIE1lc2hQaHlzaWNhbE1hdGVyaWFsIGV4dGVuZHMgTWVzaFN0YW5kYXJkTWF0ZXJpYWwgewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLmRlZmluZXMgPSB7CiAgICAgICJTVEFOREFSRCI6ICIiLAogICAgICAiUEhZU0lDQUwiOiAiIgogICAgfTsKICAgIHRoaXMudHlwZSA9ICJNZXNoUGh5c2ljYWxNYXRlcmlhbCI7CiAgICB0aGlzLmNsZWFyY29hdE1hcCA9IG51bGw7CiAgICB0aGlzLmNsZWFyY29hdFJvdWdobmVzcyA9IDA7CiAgICB0aGlzLmNsZWFyY29hdFJvdWdobmVzc01hcCA9IG51bGw7CiAgICB0aGlzLmNsZWFyY29hdE5vcm1hbFNjYWxlID0gbmV3IFZlY3RvcjIoMSwgMSk7CiAgICB0aGlzLmNsZWFyY29hdE5vcm1hbE1hcCA9IG51bGw7CiAgICB0aGlzLmlvciA9IDEuNTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAicmVmbGVjdGl2aXR5IiwgewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBjbGFtcCgyLjUgKiAodGhpcy5pb3IgLSAxKSAvICh0aGlzLmlvciArIDEpLCAwLCAxKTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbihyZWZsZWN0aXZpdHkpIHsKICAgICAgICB0aGlzLmlvciA9ICgxICsgMC40ICogcmVmbGVjdGl2aXR5KSAvICgxIC0gMC40ICogcmVmbGVjdGl2aXR5KTsKICAgICAgfQogICAgfSk7CiAgICB0aGlzLnNoZWVuQ29sb3IgPSBuZXcgQ29sb3IoMCk7CiAgICB0aGlzLnNoZWVuQ29sb3JNYXAgPSBudWxsOwogICAgdGhpcy5zaGVlblJvdWdobmVzcyA9IDE7CiAgICB0aGlzLnNoZWVuUm91Z2huZXNzTWFwID0gbnVsbDsKICAgIHRoaXMudHJhbnNtaXNzaW9uTWFwID0gbnVsbDsKICAgIHRoaXMudGhpY2tuZXNzID0gMDsKICAgIHRoaXMudGhpY2tuZXNzTWFwID0gbnVsbDsKICAgIHRoaXMuYXR0ZW51YXRpb25EaXN0YW5jZSA9IDA7CiAgICB0aGlzLmF0dGVudWF0aW9uQ29sb3IgPSBuZXcgQ29sb3IoMSwgMSwgMSk7CiAgICB0aGlzLnNwZWN1bGFySW50ZW5zaXR5ID0gMTsKICAgIHRoaXMuc3BlY3VsYXJJbnRlbnNpdHlNYXAgPSBudWxsOwogICAgdGhpcy5zcGVjdWxhckNvbG9yID0gbmV3IENvbG9yKDEsIDEsIDEpOwogICAgdGhpcy5zcGVjdWxhckNvbG9yTWFwID0gbnVsbDsKICAgIHRoaXMuX3NoZWVuID0gMDsKICAgIHRoaXMuX2NsZWFyY29hdCA9IDA7CiAgICB0aGlzLl90cmFuc21pc3Npb24gPSAwOwogICAgdGhpcy5zZXRWYWx1ZXMocGFyYW1ldGVycyk7CiAgfQogIGdldCBzaGVlbigpIHsKICAgIHJldHVybiB0aGlzLl9zaGVlbjsKICB9CiAgc2V0IHNoZWVuKHZhbHVlKSB7CiAgICBpZiAodGhpcy5fc2hlZW4gPiAwICE9PSB2YWx1ZSA+IDApIHsKICAgICAgdGhpcy52ZXJzaW9uKys7CiAgICB9CiAgICB0aGlzLl9zaGVlbiA9IHZhbHVlOwogIH0KICBnZXQgY2xlYXJjb2F0KCkgewogICAgcmV0dXJuIHRoaXMuX2NsZWFyY29hdDsKICB9CiAgc2V0IGNsZWFyY29hdCh2YWx1ZSkgewogICAgaWYgKHRoaXMuX2NsZWFyY29hdCA+IDAgIT09IHZhbHVlID4gMCkgewogICAgICB0aGlzLnZlcnNpb24rKzsKICAgIH0KICAgIHRoaXMuX2NsZWFyY29hdCA9IHZhbHVlOwogIH0KICBnZXQgdHJhbnNtaXNzaW9uKCkgewogICAgcmV0dXJuIHRoaXMuX3RyYW5zbWlzc2lvbjsKICB9CiAgc2V0IHRyYW5zbWlzc2lvbih2YWx1ZSkgewogICAgaWYgKHRoaXMuX3RyYW5zbWlzc2lvbiA+IDAgIT09IHZhbHVlID4gMCkgewogICAgICB0aGlzLnZlcnNpb24rKzsKICAgIH0KICAgIHRoaXMuX3RyYW5zbWlzc2lvbiA9IHZhbHVlOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy5kZWZpbmVzID0gewogICAgICAiU1RBTkRBUkQiOiAiIiwKICAgICAgIlBIWVNJQ0FMIjogIiIKICAgIH07CiAgICB0aGlzLmNsZWFyY29hdCA9IHNvdXJjZS5jbGVhcmNvYXQ7CiAgICB0aGlzLmNsZWFyY29hdE1hcCA9IHNvdXJjZS5jbGVhcmNvYXRNYXA7CiAgICB0aGlzLmNsZWFyY29hdFJvdWdobmVzcyA9IHNvdXJjZS5jbGVhcmNvYXRSb3VnaG5lc3M7CiAgICB0aGlzLmNsZWFyY29hdFJvdWdobmVzc01hcCA9IHNvdXJjZS5jbGVhcmNvYXRSb3VnaG5lc3NNYXA7CiAgICB0aGlzLmNsZWFyY29hdE5vcm1hbE1hcCA9IHNvdXJjZS5jbGVhcmNvYXROb3JtYWxNYXA7CiAgICB0aGlzLmNsZWFyY29hdE5vcm1hbFNjYWxlLmNvcHkoc291cmNlLmNsZWFyY29hdE5vcm1hbFNjYWxlKTsKICAgIHRoaXMuaW9yID0gc291cmNlLmlvcjsKICAgIHRoaXMuc2hlZW4gPSBzb3VyY2Uuc2hlZW47CiAgICB0aGlzLnNoZWVuQ29sb3IuY29weShzb3VyY2Uuc2hlZW5Db2xvcik7CiAgICB0aGlzLnNoZWVuQ29sb3JNYXAgPSBzb3VyY2Uuc2hlZW5Db2xvck1hcDsKICAgIHRoaXMuc2hlZW5Sb3VnaG5lc3MgPSBzb3VyY2Uuc2hlZW5Sb3VnaG5lc3M7CiAgICB0aGlzLnNoZWVuUm91Z2huZXNzTWFwID0gc291cmNlLnNoZWVuUm91Z2huZXNzTWFwOwogICAgdGhpcy50cmFuc21pc3Npb24gPSBzb3VyY2UudHJhbnNtaXNzaW9uOwogICAgdGhpcy50cmFuc21pc3Npb25NYXAgPSBzb3VyY2UudHJhbnNtaXNzaW9uTWFwOwogICAgdGhpcy50aGlja25lc3MgPSBzb3VyY2UudGhpY2tuZXNzOwogICAgdGhpcy50aGlja25lc3NNYXAgPSBzb3VyY2UudGhpY2tuZXNzTWFwOwogICAgdGhpcy5hdHRlbnVhdGlvbkRpc3RhbmNlID0gc291cmNlLmF0dGVudWF0aW9uRGlzdGFuY2U7CiAgICB0aGlzLmF0dGVudWF0aW9uQ29sb3IuY29weShzb3VyY2UuYXR0ZW51YXRpb25Db2xvcik7CiAgICB0aGlzLnNwZWN1bGFySW50ZW5zaXR5ID0gc291cmNlLnNwZWN1bGFySW50ZW5zaXR5OwogICAgdGhpcy5zcGVjdWxhckludGVuc2l0eU1hcCA9IHNvdXJjZS5zcGVjdWxhckludGVuc2l0eU1hcDsKICAgIHRoaXMuc3BlY3VsYXJDb2xvci5jb3B5KHNvdXJjZS5zcGVjdWxhckNvbG9yKTsKICAgIHRoaXMuc3BlY3VsYXJDb2xvck1hcCA9IHNvdXJjZS5zcGVjdWxhckNvbG9yTWFwOwogICAgcmV0dXJuIHRoaXM7CiAgfQp9Ck1lc2hQaHlzaWNhbE1hdGVyaWFsLnByb3RvdHlwZS5pc01lc2hQaHlzaWNhbE1hdGVyaWFsID0gdHJ1ZTsKY2xhc3MgTWVzaFBob25nTWF0ZXJpYWwgZXh0ZW5kcyBNYXRlcmlhbCB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJNZXNoUGhvbmdNYXRlcmlhbCI7CiAgICB0aGlzLmNvbG9yID0gbmV3IENvbG9yKDE2Nzc3MjE1KTsKICAgIHRoaXMuc3BlY3VsYXIgPSBuZXcgQ29sb3IoMTExODQ4MSk7CiAgICB0aGlzLnNoaW5pbmVzcyA9IDMwOwogICAgdGhpcy5tYXAgPSBudWxsOwogICAgdGhpcy5saWdodE1hcCA9IG51bGw7CiAgICB0aGlzLmxpZ2h0TWFwSW50ZW5zaXR5ID0gMTsKICAgIHRoaXMuYW9NYXAgPSBudWxsOwogICAgdGhpcy5hb01hcEludGVuc2l0eSA9IDE7CiAgICB0aGlzLmVtaXNzaXZlID0gbmV3IENvbG9yKDApOwogICAgdGhpcy5lbWlzc2l2ZUludGVuc2l0eSA9IDE7CiAgICB0aGlzLmVtaXNzaXZlTWFwID0gbnVsbDsKICAgIHRoaXMuYnVtcE1hcCA9IG51bGw7CiAgICB0aGlzLmJ1bXBTY2FsZSA9IDE7CiAgICB0aGlzLm5vcm1hbE1hcCA9IG51bGw7CiAgICB0aGlzLm5vcm1hbE1hcFR5cGUgPSBUYW5nZW50U3BhY2VOb3JtYWxNYXA7CiAgICB0aGlzLm5vcm1hbFNjYWxlID0gbmV3IFZlY3RvcjIoMSwgMSk7CiAgICB0aGlzLmRpc3BsYWNlbWVudE1hcCA9IG51bGw7CiAgICB0aGlzLmRpc3BsYWNlbWVudFNjYWxlID0gMTsKICAgIHRoaXMuZGlzcGxhY2VtZW50QmlhcyA9IDA7CiAgICB0aGlzLnNwZWN1bGFyTWFwID0gbnVsbDsKICAgIHRoaXMuYWxwaGFNYXAgPSBudWxsOwogICAgdGhpcy5lbnZNYXAgPSBudWxsOwogICAgdGhpcy5jb21iaW5lID0gTXVsdGlwbHlPcGVyYXRpb247CiAgICB0aGlzLnJlZmxlY3Rpdml0eSA9IDE7CiAgICB0aGlzLnJlZnJhY3Rpb25SYXRpbyA9IDAuOTg7CiAgICB0aGlzLndpcmVmcmFtZSA9IGZhbHNlOwogICAgdGhpcy53aXJlZnJhbWVMaW5ld2lkdGggPSAxOwogICAgdGhpcy53aXJlZnJhbWVMaW5lY2FwID0gInJvdW5kIjsKICAgIHRoaXMud2lyZWZyYW1lTGluZWpvaW4gPSAicm91bmQiOwogICAgdGhpcy5mbGF0U2hhZGluZyA9IGZhbHNlOwogICAgdGhpcy5zZXRWYWx1ZXMocGFyYW1ldGVycyk7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLmNvbG9yLmNvcHkoc291cmNlLmNvbG9yKTsKICAgIHRoaXMuc3BlY3VsYXIuY29weShzb3VyY2Uuc3BlY3VsYXIpOwogICAgdGhpcy5zaGluaW5lc3MgPSBzb3VyY2Uuc2hpbmluZXNzOwogICAgdGhpcy5tYXAgPSBzb3VyY2UubWFwOwogICAgdGhpcy5saWdodE1hcCA9IHNvdXJjZS5saWdodE1hcDsKICAgIHRoaXMubGlnaHRNYXBJbnRlbnNpdHkgPSBzb3VyY2UubGlnaHRNYXBJbnRlbnNpdHk7CiAgICB0aGlzLmFvTWFwID0gc291cmNlLmFvTWFwOwogICAgdGhpcy5hb01hcEludGVuc2l0eSA9IHNvdXJjZS5hb01hcEludGVuc2l0eTsKICAgIHRoaXMuZW1pc3NpdmUuY29weShzb3VyY2UuZW1pc3NpdmUpOwogICAgdGhpcy5lbWlzc2l2ZU1hcCA9IHNvdXJjZS5lbWlzc2l2ZU1hcDsKICAgIHRoaXMuZW1pc3NpdmVJbnRlbnNpdHkgPSBzb3VyY2UuZW1pc3NpdmVJbnRlbnNpdHk7CiAgICB0aGlzLmJ1bXBNYXAgPSBzb3VyY2UuYnVtcE1hcDsKICAgIHRoaXMuYnVtcFNjYWxlID0gc291cmNlLmJ1bXBTY2FsZTsKICAgIHRoaXMubm9ybWFsTWFwID0gc291cmNlLm5vcm1hbE1hcDsKICAgIHRoaXMubm9ybWFsTWFwVHlwZSA9IHNvdXJjZS5ub3JtYWxNYXBUeXBlOwogICAgdGhpcy5ub3JtYWxTY2FsZS5jb3B5KHNvdXJjZS5ub3JtYWxTY2FsZSk7CiAgICB0aGlzLmRpc3BsYWNlbWVudE1hcCA9IHNvdXJjZS5kaXNwbGFjZW1lbnRNYXA7CiAgICB0aGlzLmRpc3BsYWNlbWVudFNjYWxlID0gc291cmNlLmRpc3BsYWNlbWVudFNjYWxlOwogICAgdGhpcy5kaXNwbGFjZW1lbnRCaWFzID0gc291cmNlLmRpc3BsYWNlbWVudEJpYXM7CiAgICB0aGlzLnNwZWN1bGFyTWFwID0gc291cmNlLnNwZWN1bGFyTWFwOwogICAgdGhpcy5hbHBoYU1hcCA9IHNvdXJjZS5hbHBoYU1hcDsKICAgIHRoaXMuZW52TWFwID0gc291cmNlLmVudk1hcDsKICAgIHRoaXMuY29tYmluZSA9IHNvdXJjZS5jb21iaW5lOwogICAgdGhpcy5yZWZsZWN0aXZpdHkgPSBzb3VyY2UucmVmbGVjdGl2aXR5OwogICAgdGhpcy5yZWZyYWN0aW9uUmF0aW8gPSBzb3VyY2UucmVmcmFjdGlvblJhdGlvOwogICAgdGhpcy53aXJlZnJhbWUgPSBzb3VyY2Uud2lyZWZyYW1lOwogICAgdGhpcy53aXJlZnJhbWVMaW5ld2lkdGggPSBzb3VyY2Uud2lyZWZyYW1lTGluZXdpZHRoOwogICAgdGhpcy53aXJlZnJhbWVMaW5lY2FwID0gc291cmNlLndpcmVmcmFtZUxpbmVjYXA7CiAgICB0aGlzLndpcmVmcmFtZUxpbmVqb2luID0gc291cmNlLndpcmVmcmFtZUxpbmVqb2luOwogICAgdGhpcy5mbGF0U2hhZGluZyA9IHNvdXJjZS5mbGF0U2hhZGluZzsKICAgIHJldHVybiB0aGlzOwogIH0KfQpNZXNoUGhvbmdNYXRlcmlhbC5wcm90b3R5cGUuaXNNZXNoUGhvbmdNYXRlcmlhbCA9IHRydWU7CmNsYXNzIE1lc2hUb29uTWF0ZXJpYWwgZXh0ZW5kcyBNYXRlcmlhbCB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgc3VwZXIoKTsKICAgIHRoaXMuZGVmaW5lcyA9IHsgIlRPT04iOiAiIiB9OwogICAgdGhpcy50eXBlID0gIk1lc2hUb29uTWF0ZXJpYWwiOwogICAgdGhpcy5jb2xvciA9IG5ldyBDb2xvcigxNjc3NzIxNSk7CiAgICB0aGlzLm1hcCA9IG51bGw7CiAgICB0aGlzLmdyYWRpZW50TWFwID0gbnVsbDsKICAgIHRoaXMubGlnaHRNYXAgPSBudWxsOwogICAgdGhpcy5saWdodE1hcEludGVuc2l0eSA9IDE7CiAgICB0aGlzLmFvTWFwID0gbnVsbDsKICAgIHRoaXMuYW9NYXBJbnRlbnNpdHkgPSAxOwogICAgdGhpcy5lbWlzc2l2ZSA9IG5ldyBDb2xvcigwKTsKICAgIHRoaXMuZW1pc3NpdmVJbnRlbnNpdHkgPSAxOwogICAgdGhpcy5lbWlzc2l2ZU1hcCA9IG51bGw7CiAgICB0aGlzLmJ1bXBNYXAgPSBudWxsOwogICAgdGhpcy5idW1wU2NhbGUgPSAxOwogICAgdGhpcy5ub3JtYWxNYXAgPSBudWxsOwogICAgdGhpcy5ub3JtYWxNYXBUeXBlID0gVGFuZ2VudFNwYWNlTm9ybWFsTWFwOwogICAgdGhpcy5ub3JtYWxTY2FsZSA9IG5ldyBWZWN0b3IyKDEsIDEpOwogICAgdGhpcy5kaXNwbGFjZW1lbnRNYXAgPSBudWxsOwogICAgdGhpcy5kaXNwbGFjZW1lbnRTY2FsZSA9IDE7CiAgICB0aGlzLmRpc3BsYWNlbWVudEJpYXMgPSAwOwogICAgdGhpcy5hbHBoYU1hcCA9IG51bGw7CiAgICB0aGlzLndpcmVmcmFtZSA9IGZhbHNlOwogICAgdGhpcy53aXJlZnJhbWVMaW5ld2lkdGggPSAxOwogICAgdGhpcy53aXJlZnJhbWVMaW5lY2FwID0gInJvdW5kIjsKICAgIHRoaXMud2lyZWZyYW1lTGluZWpvaW4gPSAicm91bmQiOwogICAgdGhpcy5zZXRWYWx1ZXMocGFyYW1ldGVycyk7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLmNvbG9yLmNvcHkoc291cmNlLmNvbG9yKTsKICAgIHRoaXMubWFwID0gc291cmNlLm1hcDsKICAgIHRoaXMuZ3JhZGllbnRNYXAgPSBzb3VyY2UuZ3JhZGllbnRNYXA7CiAgICB0aGlzLmxpZ2h0TWFwID0gc291cmNlLmxpZ2h0TWFwOwogICAgdGhpcy5saWdodE1hcEludGVuc2l0eSA9IHNvdXJjZS5saWdodE1hcEludGVuc2l0eTsKICAgIHRoaXMuYW9NYXAgPSBzb3VyY2UuYW9NYXA7CiAgICB0aGlzLmFvTWFwSW50ZW5zaXR5ID0gc291cmNlLmFvTWFwSW50ZW5zaXR5OwogICAgdGhpcy5lbWlzc2l2ZS5jb3B5KHNvdXJjZS5lbWlzc2l2ZSk7CiAgICB0aGlzLmVtaXNzaXZlTWFwID0gc291cmNlLmVtaXNzaXZlTWFwOwogICAgdGhpcy5lbWlzc2l2ZUludGVuc2l0eSA9IHNvdXJjZS5lbWlzc2l2ZUludGVuc2l0eTsKICAgIHRoaXMuYnVtcE1hcCA9IHNvdXJjZS5idW1wTWFwOwogICAgdGhpcy5idW1wU2NhbGUgPSBzb3VyY2UuYnVtcFNjYWxlOwogICAgdGhpcy5ub3JtYWxNYXAgPSBzb3VyY2Uubm9ybWFsTWFwOwogICAgdGhpcy5ub3JtYWxNYXBUeXBlID0gc291cmNlLm5vcm1hbE1hcFR5cGU7CiAgICB0aGlzLm5vcm1hbFNjYWxlLmNvcHkoc291cmNlLm5vcm1hbFNjYWxlKTsKICAgIHRoaXMuZGlzcGxhY2VtZW50TWFwID0gc291cmNlLmRpc3BsYWNlbWVudE1hcDsKICAgIHRoaXMuZGlzcGxhY2VtZW50U2NhbGUgPSBzb3VyY2UuZGlzcGxhY2VtZW50U2NhbGU7CiAgICB0aGlzLmRpc3BsYWNlbWVudEJpYXMgPSBzb3VyY2UuZGlzcGxhY2VtZW50QmlhczsKICAgIHRoaXMuYWxwaGFNYXAgPSBzb3VyY2UuYWxwaGFNYXA7CiAgICB0aGlzLndpcmVmcmFtZSA9IHNvdXJjZS53aXJlZnJhbWU7CiAgICB0aGlzLndpcmVmcmFtZUxpbmV3aWR0aCA9IHNvdXJjZS53aXJlZnJhbWVMaW5ld2lkdGg7CiAgICB0aGlzLndpcmVmcmFtZUxpbmVjYXAgPSBzb3VyY2Uud2lyZWZyYW1lTGluZWNhcDsKICAgIHRoaXMud2lyZWZyYW1lTGluZWpvaW4gPSBzb3VyY2Uud2lyZWZyYW1lTGluZWpvaW47CiAgICByZXR1cm4gdGhpczsKICB9Cn0KTWVzaFRvb25NYXRlcmlhbC5wcm90b3R5cGUuaXNNZXNoVG9vbk1hdGVyaWFsID0gdHJ1ZTsKY2xhc3MgTWVzaE5vcm1hbE1hdGVyaWFsIGV4dGVuZHMgTWF0ZXJpYWwgewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLnR5cGUgPSAiTWVzaE5vcm1hbE1hdGVyaWFsIjsKICAgIHRoaXMuYnVtcE1hcCA9IG51bGw7CiAgICB0aGlzLmJ1bXBTY2FsZSA9IDE7CiAgICB0aGlzLm5vcm1hbE1hcCA9IG51bGw7CiAgICB0aGlzLm5vcm1hbE1hcFR5cGUgPSBUYW5nZW50U3BhY2VOb3JtYWxNYXA7CiAgICB0aGlzLm5vcm1hbFNjYWxlID0gbmV3IFZlY3RvcjIoMSwgMSk7CiAgICB0aGlzLmRpc3BsYWNlbWVudE1hcCA9IG51bGw7CiAgICB0aGlzLmRpc3BsYWNlbWVudFNjYWxlID0gMTsKICAgIHRoaXMuZGlzcGxhY2VtZW50QmlhcyA9IDA7CiAgICB0aGlzLndpcmVmcmFtZSA9IGZhbHNlOwogICAgdGhpcy53aXJlZnJhbWVMaW5ld2lkdGggPSAxOwogICAgdGhpcy5mb2cgPSBmYWxzZTsKICAgIHRoaXMuZmxhdFNoYWRpbmcgPSBmYWxzZTsKICAgIHRoaXMuc2V0VmFsdWVzKHBhcmFtZXRlcnMpOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy5idW1wTWFwID0gc291cmNlLmJ1bXBNYXA7CiAgICB0aGlzLmJ1bXBTY2FsZSA9IHNvdXJjZS5idW1wU2NhbGU7CiAgICB0aGlzLm5vcm1hbE1hcCA9IHNvdXJjZS5ub3JtYWxNYXA7CiAgICB0aGlzLm5vcm1hbE1hcFR5cGUgPSBzb3VyY2Uubm9ybWFsTWFwVHlwZTsKICAgIHRoaXMubm9ybWFsU2NhbGUuY29weShzb3VyY2Uubm9ybWFsU2NhbGUpOwogICAgdGhpcy5kaXNwbGFjZW1lbnRNYXAgPSBzb3VyY2UuZGlzcGxhY2VtZW50TWFwOwogICAgdGhpcy5kaXNwbGFjZW1lbnRTY2FsZSA9IHNvdXJjZS5kaXNwbGFjZW1lbnRTY2FsZTsKICAgIHRoaXMuZGlzcGxhY2VtZW50QmlhcyA9IHNvdXJjZS5kaXNwbGFjZW1lbnRCaWFzOwogICAgdGhpcy53aXJlZnJhbWUgPSBzb3VyY2Uud2lyZWZyYW1lOwogICAgdGhpcy53aXJlZnJhbWVMaW5ld2lkdGggPSBzb3VyY2Uud2lyZWZyYW1lTGluZXdpZHRoOwogICAgdGhpcy5mbGF0U2hhZGluZyA9IHNvdXJjZS5mbGF0U2hhZGluZzsKICAgIHJldHVybiB0aGlzOwogIH0KfQpNZXNoTm9ybWFsTWF0ZXJpYWwucHJvdG90eXBlLmlzTWVzaE5vcm1hbE1hdGVyaWFsID0gdHJ1ZTsKY2xhc3MgTWVzaExhbWJlcnRNYXRlcmlhbCBleHRlbmRzIE1hdGVyaWFsIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIk1lc2hMYW1iZXJ0TWF0ZXJpYWwiOwogICAgdGhpcy5jb2xvciA9IG5ldyBDb2xvcigxNjc3NzIxNSk7CiAgICB0aGlzLm1hcCA9IG51bGw7CiAgICB0aGlzLmxpZ2h0TWFwID0gbnVsbDsKICAgIHRoaXMubGlnaHRNYXBJbnRlbnNpdHkgPSAxOwogICAgdGhpcy5hb01hcCA9IG51bGw7CiAgICB0aGlzLmFvTWFwSW50ZW5zaXR5ID0gMTsKICAgIHRoaXMuZW1pc3NpdmUgPSBuZXcgQ29sb3IoMCk7CiAgICB0aGlzLmVtaXNzaXZlSW50ZW5zaXR5ID0gMTsKICAgIHRoaXMuZW1pc3NpdmVNYXAgPSBudWxsOwogICAgdGhpcy5zcGVjdWxhck1hcCA9IG51bGw7CiAgICB0aGlzLmFscGhhTWFwID0gbnVsbDsKICAgIHRoaXMuZW52TWFwID0gbnVsbDsKICAgIHRoaXMuY29tYmluZSA9IE11bHRpcGx5T3BlcmF0aW9uOwogICAgdGhpcy5yZWZsZWN0aXZpdHkgPSAxOwogICAgdGhpcy5yZWZyYWN0aW9uUmF0aW8gPSAwLjk4OwogICAgdGhpcy53aXJlZnJhbWUgPSBmYWxzZTsKICAgIHRoaXMud2lyZWZyYW1lTGluZXdpZHRoID0gMTsKICAgIHRoaXMud2lyZWZyYW1lTGluZWNhcCA9ICJyb3VuZCI7CiAgICB0aGlzLndpcmVmcmFtZUxpbmVqb2luID0gInJvdW5kIjsKICAgIHRoaXMuc2V0VmFsdWVzKHBhcmFtZXRlcnMpOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy5jb2xvci5jb3B5KHNvdXJjZS5jb2xvcik7CiAgICB0aGlzLm1hcCA9IHNvdXJjZS5tYXA7CiAgICB0aGlzLmxpZ2h0TWFwID0gc291cmNlLmxpZ2h0TWFwOwogICAgdGhpcy5saWdodE1hcEludGVuc2l0eSA9IHNvdXJjZS5saWdodE1hcEludGVuc2l0eTsKICAgIHRoaXMuYW9NYXAgPSBzb3VyY2UuYW9NYXA7CiAgICB0aGlzLmFvTWFwSW50ZW5zaXR5ID0gc291cmNlLmFvTWFwSW50ZW5zaXR5OwogICAgdGhpcy5lbWlzc2l2ZS5jb3B5KHNvdXJjZS5lbWlzc2l2ZSk7CiAgICB0aGlzLmVtaXNzaXZlTWFwID0gc291cmNlLmVtaXNzaXZlTWFwOwogICAgdGhpcy5lbWlzc2l2ZUludGVuc2l0eSA9IHNvdXJjZS5lbWlzc2l2ZUludGVuc2l0eTsKICAgIHRoaXMuc3BlY3VsYXJNYXAgPSBzb3VyY2Uuc3BlY3VsYXJNYXA7CiAgICB0aGlzLmFscGhhTWFwID0gc291cmNlLmFscGhhTWFwOwogICAgdGhpcy5lbnZNYXAgPSBzb3VyY2UuZW52TWFwOwogICAgdGhpcy5jb21iaW5lID0gc291cmNlLmNvbWJpbmU7CiAgICB0aGlzLnJlZmxlY3Rpdml0eSA9IHNvdXJjZS5yZWZsZWN0aXZpdHk7CiAgICB0aGlzLnJlZnJhY3Rpb25SYXRpbyA9IHNvdXJjZS5yZWZyYWN0aW9uUmF0aW87CiAgICB0aGlzLndpcmVmcmFtZSA9IHNvdXJjZS53aXJlZnJhbWU7CiAgICB0aGlzLndpcmVmcmFtZUxpbmV3aWR0aCA9IHNvdXJjZS53aXJlZnJhbWVMaW5ld2lkdGg7CiAgICB0aGlzLndpcmVmcmFtZUxpbmVjYXAgPSBzb3VyY2Uud2lyZWZyYW1lTGluZWNhcDsKICAgIHRoaXMud2lyZWZyYW1lTGluZWpvaW4gPSBzb3VyY2Uud2lyZWZyYW1lTGluZWpvaW47CiAgICByZXR1cm4gdGhpczsKICB9Cn0KTWVzaExhbWJlcnRNYXRlcmlhbC5wcm90b3R5cGUuaXNNZXNoTGFtYmVydE1hdGVyaWFsID0gdHJ1ZTsKY2xhc3MgTWVzaE1hdGNhcE1hdGVyaWFsIGV4dGVuZHMgTWF0ZXJpYWwgewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLmRlZmluZXMgPSB7ICJNQVRDQVAiOiAiIiB9OwogICAgdGhpcy50eXBlID0gIk1lc2hNYXRjYXBNYXRlcmlhbCI7CiAgICB0aGlzLmNvbG9yID0gbmV3IENvbG9yKDE2Nzc3MjE1KTsKICAgIHRoaXMubWF0Y2FwID0gbnVsbDsKICAgIHRoaXMubWFwID0gbnVsbDsKICAgIHRoaXMuYnVtcE1hcCA9IG51bGw7CiAgICB0aGlzLmJ1bXBTY2FsZSA9IDE7CiAgICB0aGlzLm5vcm1hbE1hcCA9IG51bGw7CiAgICB0aGlzLm5vcm1hbE1hcFR5cGUgPSBUYW5nZW50U3BhY2VOb3JtYWxNYXA7CiAgICB0aGlzLm5vcm1hbFNjYWxlID0gbmV3IFZlY3RvcjIoMSwgMSk7CiAgICB0aGlzLmRpc3BsYWNlbWVudE1hcCA9IG51bGw7CiAgICB0aGlzLmRpc3BsYWNlbWVudFNjYWxlID0gMTsKICAgIHRoaXMuZGlzcGxhY2VtZW50QmlhcyA9IDA7CiAgICB0aGlzLmFscGhhTWFwID0gbnVsbDsKICAgIHRoaXMuZmxhdFNoYWRpbmcgPSBmYWxzZTsKICAgIHRoaXMuc2V0VmFsdWVzKHBhcmFtZXRlcnMpOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy5kZWZpbmVzID0geyAiTUFUQ0FQIjogIiIgfTsKICAgIHRoaXMuY29sb3IuY29weShzb3VyY2UuY29sb3IpOwogICAgdGhpcy5tYXRjYXAgPSBzb3VyY2UubWF0Y2FwOwogICAgdGhpcy5tYXAgPSBzb3VyY2UubWFwOwogICAgdGhpcy5idW1wTWFwID0gc291cmNlLmJ1bXBNYXA7CiAgICB0aGlzLmJ1bXBTY2FsZSA9IHNvdXJjZS5idW1wU2NhbGU7CiAgICB0aGlzLm5vcm1hbE1hcCA9IHNvdXJjZS5ub3JtYWxNYXA7CiAgICB0aGlzLm5vcm1hbE1hcFR5cGUgPSBzb3VyY2Uubm9ybWFsTWFwVHlwZTsKICAgIHRoaXMubm9ybWFsU2NhbGUuY29weShzb3VyY2Uubm9ybWFsU2NhbGUpOwogICAgdGhpcy5kaXNwbGFjZW1lbnRNYXAgPSBzb3VyY2UuZGlzcGxhY2VtZW50TWFwOwogICAgdGhpcy5kaXNwbGFjZW1lbnRTY2FsZSA9IHNvdXJjZS5kaXNwbGFjZW1lbnRTY2FsZTsKICAgIHRoaXMuZGlzcGxhY2VtZW50QmlhcyA9IHNvdXJjZS5kaXNwbGFjZW1lbnRCaWFzOwogICAgdGhpcy5hbHBoYU1hcCA9IHNvdXJjZS5hbHBoYU1hcDsKICAgIHRoaXMuZmxhdFNoYWRpbmcgPSBzb3VyY2UuZmxhdFNoYWRpbmc7CiAgICByZXR1cm4gdGhpczsKICB9Cn0KTWVzaE1hdGNhcE1hdGVyaWFsLnByb3RvdHlwZS5pc01lc2hNYXRjYXBNYXRlcmlhbCA9IHRydWU7CmNsYXNzIExpbmVEYXNoZWRNYXRlcmlhbCBleHRlbmRzIExpbmVCYXNpY01hdGVyaWFsIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkxpbmVEYXNoZWRNYXRlcmlhbCI7CiAgICB0aGlzLnNjYWxlID0gMTsKICAgIHRoaXMuZGFzaFNpemUgPSAzOwogICAgdGhpcy5nYXBTaXplID0gMTsKICAgIHRoaXMuc2V0VmFsdWVzKHBhcmFtZXRlcnMpOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy5zY2FsZSA9IHNvdXJjZS5zY2FsZTsKICAgIHRoaXMuZGFzaFNpemUgPSBzb3VyY2UuZGFzaFNpemU7CiAgICB0aGlzLmdhcFNpemUgPSBzb3VyY2UuZ2FwU2l6ZTsKICAgIHJldHVybiB0aGlzOwogIH0KfQpMaW5lRGFzaGVkTWF0ZXJpYWwucHJvdG90eXBlLmlzTGluZURhc2hlZE1hdGVyaWFsID0gdHJ1ZTsKdmFyIE1hdGVyaWFscyA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuZnJlZXplKHsKICBfX3Byb3RvX186IG51bGwsCiAgU2hhZG93TWF0ZXJpYWwsCiAgU3ByaXRlTWF0ZXJpYWwsCiAgUmF3U2hhZGVyTWF0ZXJpYWwsCiAgU2hhZGVyTWF0ZXJpYWwsCiAgUG9pbnRzTWF0ZXJpYWwsCiAgTWVzaFBoeXNpY2FsTWF0ZXJpYWwsCiAgTWVzaFN0YW5kYXJkTWF0ZXJpYWwsCiAgTWVzaFBob25nTWF0ZXJpYWwsCiAgTWVzaFRvb25NYXRlcmlhbCwKICBNZXNoTm9ybWFsTWF0ZXJpYWwsCiAgTWVzaExhbWJlcnRNYXRlcmlhbCwKICBNZXNoRGVwdGhNYXRlcmlhbCwKICBNZXNoRGlzdGFuY2VNYXRlcmlhbCwKICBNZXNoQmFzaWNNYXRlcmlhbCwKICBNZXNoTWF0Y2FwTWF0ZXJpYWwsCiAgTGluZURhc2hlZE1hdGVyaWFsLAogIExpbmVCYXNpY01hdGVyaWFsLAogIE1hdGVyaWFsCn0pOwpjb25zdCBBbmltYXRpb25VdGlscyA9IHsKICBhcnJheVNsaWNlOiBmdW5jdGlvbihhcnJheSwgZnJvbSwgdG8pIHsKICAgIGlmIChBbmltYXRpb25VdGlscy5pc1R5cGVkQXJyYXkoYXJyYXkpKSB7CiAgICAgIHJldHVybiBuZXcgYXJyYXkuY29uc3RydWN0b3IoYXJyYXkuc3ViYXJyYXkoZnJvbSwgdG8gIT09IHZvaWQgMCA/IHRvIDogYXJyYXkubGVuZ3RoKSk7CiAgICB9CiAgICByZXR1cm4gYXJyYXkuc2xpY2UoZnJvbSwgdG8pOwogIH0sCiAgY29udmVydEFycmF5OiBmdW5jdGlvbihhcnJheSwgdHlwZSwgZm9yY2VDbG9uZSkgewogICAgaWYgKCFhcnJheSB8fCAhZm9yY2VDbG9uZSAmJiBhcnJheS5jb25zdHJ1Y3RvciA9PT0gdHlwZSkKICAgICAgcmV0dXJuIGFycmF5OwogICAgaWYgKHR5cGVvZiB0eXBlLkJZVEVTX1BFUl9FTEVNRU5UID09PSAibnVtYmVyIikgewogICAgICByZXR1cm4gbmV3IHR5cGUoYXJyYXkpOwogICAgfQogICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFycmF5KTsKICB9LAogIGlzVHlwZWRBcnJheTogZnVuY3Rpb24ob2JqZWN0KSB7CiAgICByZXR1cm4gQXJyYXlCdWZmZXIuaXNWaWV3KG9iamVjdCkgJiYgIShvYmplY3QgaW5zdGFuY2VvZiBEYXRhVmlldyk7CiAgfSwKICBnZXRLZXlmcmFtZU9yZGVyOiBmdW5jdGlvbih0aW1lcykgewogICAgZnVuY3Rpb24gY29tcGFyZVRpbWUoaSwgaikgewogICAgICByZXR1cm4gdGltZXNbaV0gLSB0aW1lc1tqXTsKICAgIH0KICAgIGNvbnN0IG4gPSB0aW1lcy5sZW5ndGg7CiAgICBjb25zdCByZXN1bHQgPSBuZXcgQXJyYXkobik7CiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gbjsgKytpKQogICAgICByZXN1bHRbaV0gPSBpOwogICAgcmVzdWx0LnNvcnQoY29tcGFyZVRpbWUpOwogICAgcmV0dXJuIHJlc3VsdDsKICB9LAogIHNvcnRlZEFycmF5OiBmdW5jdGlvbih2YWx1ZXMsIHN0cmlkZSwgb3JkZXIpIHsKICAgIGNvbnN0IG5WYWx1ZXMgPSB2YWx1ZXMubGVuZ3RoOwogICAgY29uc3QgcmVzdWx0ID0gbmV3IHZhbHVlcy5jb25zdHJ1Y3RvcihuVmFsdWVzKTsKICAgIGZvciAobGV0IGkgPSAwLCBkc3RPZmZzZXQgPSAwOyBkc3RPZmZzZXQgIT09IG5WYWx1ZXM7ICsraSkgewogICAgICBjb25zdCBzcmNPZmZzZXQgPSBvcmRlcltpXSAqIHN0cmlkZTsKICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IHN0cmlkZTsgKytqKSB7CiAgICAgICAgcmVzdWx0W2RzdE9mZnNldCsrXSA9IHZhbHVlc1tzcmNPZmZzZXQgKyBqXTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKICB9LAogIGZsYXR0ZW5KU09OOiBmdW5jdGlvbihqc29uS2V5cywgdGltZXMsIHZhbHVlcywgdmFsdWVQcm9wZXJ0eU5hbWUpIHsKICAgIGxldCBpID0gMSwga2V5ID0ganNvbktleXNbMF07CiAgICB3aGlsZSAoa2V5ICE9PSB2b2lkIDAgJiYga2V5W3ZhbHVlUHJvcGVydHlOYW1lXSA9PT0gdm9pZCAwKSB7CiAgICAgIGtleSA9IGpzb25LZXlzW2krK107CiAgICB9CiAgICBpZiAoa2V5ID09PSB2b2lkIDApCiAgICAgIHJldHVybjsKICAgIGxldCB2YWx1ZSA9IGtleVt2YWx1ZVByb3BlcnR5TmFtZV07CiAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkKICAgICAgcmV0dXJuOwogICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICAgIGRvIHsKICAgICAgICB2YWx1ZSA9IGtleVt2YWx1ZVByb3BlcnR5TmFtZV07CiAgICAgICAgaWYgKHZhbHVlICE9PSB2b2lkIDApIHsKICAgICAgICAgIHRpbWVzLnB1c2goa2V5LnRpbWUpOwogICAgICAgICAgdmFsdWVzLnB1c2guYXBwbHkodmFsdWVzLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICAgIGtleSA9IGpzb25LZXlzW2krK107CiAgICAgIH0gd2hpbGUgKGtleSAhPT0gdm9pZCAwKTsKICAgIH0gZWxzZSBpZiAodmFsdWUudG9BcnJheSAhPT0gdm9pZCAwKSB7CiAgICAgIGRvIHsKICAgICAgICB2YWx1ZSA9IGtleVt2YWx1ZVByb3BlcnR5TmFtZV07CiAgICAgICAgaWYgKHZhbHVlICE9PSB2b2lkIDApIHsKICAgICAgICAgIHRpbWVzLnB1c2goa2V5LnRpbWUpOwogICAgICAgICAgdmFsdWUudG9BcnJheSh2YWx1ZXMsIHZhbHVlcy5sZW5ndGgpOwogICAgICAgIH0KICAgICAgICBrZXkgPSBqc29uS2V5c1tpKytdOwogICAgICB9IHdoaWxlIChrZXkgIT09IHZvaWQgMCk7CiAgICB9IGVsc2UgewogICAgICBkbyB7CiAgICAgICAgdmFsdWUgPSBrZXlbdmFsdWVQcm9wZXJ0eU5hbWVdOwogICAgICAgIGlmICh2YWx1ZSAhPT0gdm9pZCAwKSB7CiAgICAgICAgICB0aW1lcy5wdXNoKGtleS50aW1lKTsKICAgICAgICAgIHZhbHVlcy5wdXNoKHZhbHVlKTsKICAgICAgICB9CiAgICAgICAga2V5ID0ganNvbktleXNbaSsrXTsKICAgICAgfSB3aGlsZSAoa2V5ICE9PSB2b2lkIDApOwogICAgfQogIH0sCiAgc3ViY2xpcDogZnVuY3Rpb24oc291cmNlQ2xpcCwgbmFtZSwgc3RhcnRGcmFtZSwgZW5kRnJhbWUsIGZwcyA9IDMwKSB7CiAgICBjb25zdCBjbGlwID0gc291cmNlQ2xpcC5jbG9uZSgpOwogICAgY2xpcC5uYW1lID0gbmFtZTsKICAgIGNvbnN0IHRyYWNrcyA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjbGlwLnRyYWNrcy5sZW5ndGg7ICsraSkgewogICAgICBjb25zdCB0cmFjayA9IGNsaXAudHJhY2tzW2ldOwogICAgICBjb25zdCB2YWx1ZVNpemUgPSB0cmFjay5nZXRWYWx1ZVNpemUoKTsKICAgICAgY29uc3QgdGltZXMgPSBbXTsKICAgICAgY29uc3QgdmFsdWVzID0gW107CiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdHJhY2sudGltZXMubGVuZ3RoOyArK2opIHsKICAgICAgICBjb25zdCBmcmFtZSA9IHRyYWNrLnRpbWVzW2pdICogZnBzOwogICAgICAgIGlmIChmcmFtZSA8IHN0YXJ0RnJhbWUgfHwgZnJhbWUgPj0gZW5kRnJhbWUpCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB0aW1lcy5wdXNoKHRyYWNrLnRpbWVzW2pdKTsKICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHZhbHVlU2l6ZTsgKytrKSB7CiAgICAgICAgICB2YWx1ZXMucHVzaCh0cmFjay52YWx1ZXNbaiAqIHZhbHVlU2l6ZSArIGtdKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHRpbWVzLmxlbmd0aCA9PT0gMCkKICAgICAgICBjb250aW51ZTsKICAgICAgdHJhY2sudGltZXMgPSBBbmltYXRpb25VdGlscy5jb252ZXJ0QXJyYXkodGltZXMsIHRyYWNrLnRpbWVzLmNvbnN0cnVjdG9yKTsKICAgICAgdHJhY2sudmFsdWVzID0gQW5pbWF0aW9uVXRpbHMuY29udmVydEFycmF5KHZhbHVlcywgdHJhY2sudmFsdWVzLmNvbnN0cnVjdG9yKTsKICAgICAgdHJhY2tzLnB1c2godHJhY2spOwogICAgfQogICAgY2xpcC50cmFja3MgPSB0cmFja3M7CiAgICBsZXQgbWluU3RhcnRUaW1lID0gSW5maW5pdHk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNsaXAudHJhY2tzLmxlbmd0aDsgKytpKSB7CiAgICAgIGlmIChtaW5TdGFydFRpbWUgPiBjbGlwLnRyYWNrc1tpXS50aW1lc1swXSkgewogICAgICAgIG1pblN0YXJ0VGltZSA9IGNsaXAudHJhY2tzW2ldLnRpbWVzWzBdOwogICAgICB9CiAgICB9CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNsaXAudHJhY2tzLmxlbmd0aDsgKytpKSB7CiAgICAgIGNsaXAudHJhY2tzW2ldLnNoaWZ0KC0xICogbWluU3RhcnRUaW1lKTsKICAgIH0KICAgIGNsaXAucmVzZXREdXJhdGlvbigpOwogICAgcmV0dXJuIGNsaXA7CiAgfSwKICBtYWtlQ2xpcEFkZGl0aXZlOiBmdW5jdGlvbih0YXJnZXRDbGlwLCByZWZlcmVuY2VGcmFtZSA9IDAsIHJlZmVyZW5jZUNsaXAgPSB0YXJnZXRDbGlwLCBmcHMgPSAzMCkgewogICAgaWYgKGZwcyA8PSAwKQogICAgICBmcHMgPSAzMDsKICAgIGNvbnN0IG51bVRyYWNrcyA9IHJlZmVyZW5jZUNsaXAudHJhY2tzLmxlbmd0aDsKICAgIGNvbnN0IHJlZmVyZW5jZVRpbWUgPSByZWZlcmVuY2VGcmFtZSAvIGZwczsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtVHJhY2tzOyArK2kpIHsKICAgICAgY29uc3QgcmVmZXJlbmNlVHJhY2sgPSByZWZlcmVuY2VDbGlwLnRyYWNrc1tpXTsKICAgICAgY29uc3QgcmVmZXJlbmNlVHJhY2tUeXBlID0gcmVmZXJlbmNlVHJhY2suVmFsdWVUeXBlTmFtZTsKICAgICAgaWYgKHJlZmVyZW5jZVRyYWNrVHlwZSA9PT0gImJvb2wiIHx8IHJlZmVyZW5jZVRyYWNrVHlwZSA9PT0gInN0cmluZyIpCiAgICAgICAgY29udGludWU7CiAgICAgIGNvbnN0IHRhcmdldFRyYWNrID0gdGFyZ2V0Q2xpcC50cmFja3MuZmluZChmdW5jdGlvbih0cmFjaykgewogICAgICAgIHJldHVybiB0cmFjay5uYW1lID09PSByZWZlcmVuY2VUcmFjay5uYW1lICYmIHRyYWNrLlZhbHVlVHlwZU5hbWUgPT09IHJlZmVyZW5jZVRyYWNrVHlwZTsKICAgICAgfSk7CiAgICAgIGlmICh0YXJnZXRUcmFjayA9PT0gdm9pZCAwKQogICAgICAgIGNvbnRpbnVlOwogICAgICBsZXQgcmVmZXJlbmNlT2Zmc2V0ID0gMDsKICAgICAgY29uc3QgcmVmZXJlbmNlVmFsdWVTaXplID0gcmVmZXJlbmNlVHJhY2suZ2V0VmFsdWVTaXplKCk7CiAgICAgIGlmIChyZWZlcmVuY2VUcmFjay5jcmVhdGVJbnRlcnBvbGFudC5pc0ludGVycG9sYW50RmFjdG9yeU1ldGhvZEdMVEZDdWJpY1NwbGluZSkgewogICAgICAgIHJlZmVyZW5jZU9mZnNldCA9IHJlZmVyZW5jZVZhbHVlU2l6ZSAvIDM7CiAgICAgIH0KICAgICAgbGV0IHRhcmdldE9mZnNldCA9IDA7CiAgICAgIGNvbnN0IHRhcmdldFZhbHVlU2l6ZSA9IHRhcmdldFRyYWNrLmdldFZhbHVlU2l6ZSgpOwogICAgICBpZiAodGFyZ2V0VHJhY2suY3JlYXRlSW50ZXJwb2xhbnQuaXNJbnRlcnBvbGFudEZhY3RvcnlNZXRob2RHTFRGQ3ViaWNTcGxpbmUpIHsKICAgICAgICB0YXJnZXRPZmZzZXQgPSB0YXJnZXRWYWx1ZVNpemUgLyAzOwogICAgICB9CiAgICAgIGNvbnN0IGxhc3RJbmRleCA9IHJlZmVyZW5jZVRyYWNrLnRpbWVzLmxlbmd0aCAtIDE7CiAgICAgIGxldCByZWZlcmVuY2VWYWx1ZTsKICAgICAgaWYgKHJlZmVyZW5jZVRpbWUgPD0gcmVmZXJlbmNlVHJhY2sudGltZXNbMF0pIHsKICAgICAgICBjb25zdCBzdGFydEluZGV4ID0gcmVmZXJlbmNlT2Zmc2V0OwogICAgICAgIGNvbnN0IGVuZEluZGV4ID0gcmVmZXJlbmNlVmFsdWVTaXplIC0gcmVmZXJlbmNlT2Zmc2V0OwogICAgICAgIHJlZmVyZW5jZVZhbHVlID0gQW5pbWF0aW9uVXRpbHMuYXJyYXlTbGljZShyZWZlcmVuY2VUcmFjay52YWx1ZXMsIHN0YXJ0SW5kZXgsIGVuZEluZGV4KTsKICAgICAgfSBlbHNlIGlmIChyZWZlcmVuY2VUaW1lID49IHJlZmVyZW5jZVRyYWNrLnRpbWVzW2xhc3RJbmRleF0pIHsKICAgICAgICBjb25zdCBzdGFydEluZGV4ID0gbGFzdEluZGV4ICogcmVmZXJlbmNlVmFsdWVTaXplICsgcmVmZXJlbmNlT2Zmc2V0OwogICAgICAgIGNvbnN0IGVuZEluZGV4ID0gc3RhcnRJbmRleCArIHJlZmVyZW5jZVZhbHVlU2l6ZSAtIHJlZmVyZW5jZU9mZnNldDsKICAgICAgICByZWZlcmVuY2VWYWx1ZSA9IEFuaW1hdGlvblV0aWxzLmFycmF5U2xpY2UocmVmZXJlbmNlVHJhY2sudmFsdWVzLCBzdGFydEluZGV4LCBlbmRJbmRleCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgaW50ZXJwb2xhbnQgPSByZWZlcmVuY2VUcmFjay5jcmVhdGVJbnRlcnBvbGFudCgpOwogICAgICAgIGNvbnN0IHN0YXJ0SW5kZXggPSByZWZlcmVuY2VPZmZzZXQ7CiAgICAgICAgY29uc3QgZW5kSW5kZXggPSByZWZlcmVuY2VWYWx1ZVNpemUgLSByZWZlcmVuY2VPZmZzZXQ7CiAgICAgICAgaW50ZXJwb2xhbnQuZXZhbHVhdGUocmVmZXJlbmNlVGltZSk7CiAgICAgICAgcmVmZXJlbmNlVmFsdWUgPSBBbmltYXRpb25VdGlscy5hcnJheVNsaWNlKGludGVycG9sYW50LnJlc3VsdEJ1ZmZlciwgc3RhcnRJbmRleCwgZW5kSW5kZXgpOwogICAgICB9CiAgICAgIGlmIChyZWZlcmVuY2VUcmFja1R5cGUgPT09ICJxdWF0ZXJuaW9uIikgewogICAgICAgIGNvbnN0IHJlZmVyZW5jZVF1YXQgPSBuZXcgUXVhdGVybmlvbigpLmZyb21BcnJheShyZWZlcmVuY2VWYWx1ZSkubm9ybWFsaXplKCkuY29uanVnYXRlKCk7CiAgICAgICAgcmVmZXJlbmNlUXVhdC50b0FycmF5KHJlZmVyZW5jZVZhbHVlKTsKICAgICAgfQogICAgICBjb25zdCBudW1UaW1lcyA9IHRhcmdldFRyYWNrLnRpbWVzLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBudW1UaW1lczsgKytqKSB7CiAgICAgICAgY29uc3QgdmFsdWVTdGFydCA9IGogKiB0YXJnZXRWYWx1ZVNpemUgKyB0YXJnZXRPZmZzZXQ7CiAgICAgICAgaWYgKHJlZmVyZW5jZVRyYWNrVHlwZSA9PT0gInF1YXRlcm5pb24iKSB7CiAgICAgICAgICBRdWF0ZXJuaW9uLm11bHRpcGx5UXVhdGVybmlvbnNGbGF0KHRhcmdldFRyYWNrLnZhbHVlcywgdmFsdWVTdGFydCwgcmVmZXJlbmNlVmFsdWUsIDAsIHRhcmdldFRyYWNrLnZhbHVlcywgdmFsdWVTdGFydCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IHZhbHVlRW5kID0gdGFyZ2V0VmFsdWVTaXplIC0gdGFyZ2V0T2Zmc2V0ICogMjsKICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgdmFsdWVFbmQ7ICsraykgewogICAgICAgICAgICB0YXJnZXRUcmFjay52YWx1ZXNbdmFsdWVTdGFydCArIGtdIC09IHJlZmVyZW5jZVZhbHVlW2tdOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgdGFyZ2V0Q2xpcC5ibGVuZE1vZGUgPSBBZGRpdGl2ZUFuaW1hdGlvbkJsZW5kTW9kZTsKICAgIHJldHVybiB0YXJnZXRDbGlwOwogIH0KfTsKY2xhc3MgSW50ZXJwb2xhbnQgewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlclBvc2l0aW9ucywgc2FtcGxlVmFsdWVzLCBzYW1wbGVTaXplLCByZXN1bHRCdWZmZXIpIHsKICAgIHRoaXMucGFyYW1ldGVyUG9zaXRpb25zID0gcGFyYW1ldGVyUG9zaXRpb25zOwogICAgdGhpcy5fY2FjaGVkSW5kZXggPSAwOwogICAgdGhpcy5yZXN1bHRCdWZmZXIgPSByZXN1bHRCdWZmZXIgIT09IHZvaWQgMCA/IHJlc3VsdEJ1ZmZlciA6IG5ldyBzYW1wbGVWYWx1ZXMuY29uc3RydWN0b3Ioc2FtcGxlU2l6ZSk7CiAgICB0aGlzLnNhbXBsZVZhbHVlcyA9IHNhbXBsZVZhbHVlczsKICAgIHRoaXMudmFsdWVTaXplID0gc2FtcGxlU2l6ZTsKICAgIHRoaXMuc2V0dGluZ3MgPSBudWxsOwogICAgdGhpcy5EZWZhdWx0U2V0dGluZ3NfID0ge307CiAgfQogIGV2YWx1YXRlKHQpIHsKICAgIGNvbnN0IHBwID0gdGhpcy5wYXJhbWV0ZXJQb3NpdGlvbnM7CiAgICBsZXQgaTEgPSB0aGlzLl9jYWNoZWRJbmRleCwgdDEgPSBwcFtpMV0sIHQwID0gcHBbaTEgLSAxXTsKICAgIHZhbGlkYXRlX2ludGVydmFsOiB7CiAgICAgIHNlZWs6IHsKICAgICAgICBsZXQgcmlnaHQ7CiAgICAgICAgbGluZWFyX3NjYW46IHsKICAgICAgICAgIGZvcndhcmRfc2NhbjoKICAgICAgICAgICAgaWYgKCEodCA8IHQxKSkgewogICAgICAgICAgICAgIGZvciAobGV0IGdpdmVVcEF0ID0gaTEgKyAyOyA7ICkgewogICAgICAgICAgICAgICAgaWYgKHQxID09PSB2b2lkIDApIHsKICAgICAgICAgICAgICAgICAgaWYgKHQgPCB0MCkKICAgICAgICAgICAgICAgICAgICBicmVhayBmb3J3YXJkX3NjYW47CiAgICAgICAgICAgICAgICAgIGkxID0gcHAubGVuZ3RoOwogICAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZWRJbmRleCA9IGkxOwogICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hZnRlckVuZF8oaTEgLSAxLCB0LCB0MCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoaTEgPT09IGdpdmVVcEF0KQogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIHQwID0gdDE7CiAgICAgICAgICAgICAgICB0MSA9IHBwWysraTFdOwogICAgICAgICAgICAgICAgaWYgKHQgPCB0MSkgewogICAgICAgICAgICAgICAgICBicmVhayBzZWVrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICByaWdodCA9IHBwLmxlbmd0aDsKICAgICAgICAgICAgICBicmVhayBsaW5lYXJfc2NhbjsKICAgICAgICAgICAgfQogICAgICAgICAgaWYgKCEodCA+PSB0MCkpIHsKICAgICAgICAgICAgY29uc3QgdDFnbG9iYWwgPSBwcFsxXTsKICAgICAgICAgICAgaWYgKHQgPCB0MWdsb2JhbCkgewogICAgICAgICAgICAgIGkxID0gMjsKICAgICAgICAgICAgICB0MCA9IHQxZ2xvYmFsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAobGV0IGdpdmVVcEF0ID0gaTEgLSAyOyA7ICkgewogICAgICAgICAgICAgIGlmICh0MCA9PT0gdm9pZCAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZWRJbmRleCA9IDA7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5iZWZvcmVTdGFydF8oMCwgdCwgdDEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoaTEgPT09IGdpdmVVcEF0KQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgdDEgPSB0MDsKICAgICAgICAgICAgICB0MCA9IHBwWy0taTEgLSAxXTsKICAgICAgICAgICAgICBpZiAodCA+PSB0MCkgewogICAgICAgICAgICAgICAgYnJlYWsgc2VlazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmlnaHQgPSBpMTsKICAgICAgICAgICAgaTEgPSAwOwogICAgICAgICAgICBicmVhayBsaW5lYXJfc2NhbjsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrIHZhbGlkYXRlX2ludGVydmFsOwogICAgICAgIH0KICAgICAgICB3aGlsZSAoaTEgPCByaWdodCkgewogICAgICAgICAgY29uc3QgbWlkID0gaTEgKyByaWdodCA+Pj4gMTsKICAgICAgICAgIGlmICh0IDwgcHBbbWlkXSkgewogICAgICAgICAgICByaWdodCA9IG1pZDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGkxID0gbWlkICsgMTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdDEgPSBwcFtpMV07CiAgICAgICAgdDAgPSBwcFtpMSAtIDFdOwogICAgICAgIGlmICh0MCA9PT0gdm9pZCAwKSB7CiAgICAgICAgICB0aGlzLl9jYWNoZWRJbmRleCA9IDA7CiAgICAgICAgICByZXR1cm4gdGhpcy5iZWZvcmVTdGFydF8oMCwgdCwgdDEpOwogICAgICAgIH0KICAgICAgICBpZiAodDEgPT09IHZvaWQgMCkgewogICAgICAgICAgaTEgPSBwcC5sZW5ndGg7CiAgICAgICAgICB0aGlzLl9jYWNoZWRJbmRleCA9IGkxOwogICAgICAgICAgcmV0dXJuIHRoaXMuYWZ0ZXJFbmRfKGkxIC0gMSwgdDAsIHQpOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLl9jYWNoZWRJbmRleCA9IGkxOwogICAgICB0aGlzLmludGVydmFsQ2hhbmdlZF8oaTEsIHQwLCB0MSk7CiAgICB9CiAgICByZXR1cm4gdGhpcy5pbnRlcnBvbGF0ZV8oaTEsIHQwLCB0LCB0MSk7CiAgfQogIGdldFNldHRpbmdzXygpIHsKICAgIHJldHVybiB0aGlzLnNldHRpbmdzIHx8IHRoaXMuRGVmYXVsdFNldHRpbmdzXzsKICB9CiAgY29weVNhbXBsZVZhbHVlXyhpbmRleCkgewogICAgY29uc3QgcmVzdWx0ID0gdGhpcy5yZXN1bHRCdWZmZXIsIHZhbHVlcyA9IHRoaXMuc2FtcGxlVmFsdWVzLCBzdHJpZGUgPSB0aGlzLnZhbHVlU2l6ZSwgb2Zmc2V0ID0gaW5kZXggKiBzdHJpZGU7CiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gc3RyaWRlOyArK2kpIHsKICAgICAgcmVzdWx0W2ldID0gdmFsdWVzW29mZnNldCArIGldOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKICB9CiAgaW50ZXJwb2xhdGVfKCkgewogICAgdGhyb3cgbmV3IEVycm9yKCJjYWxsIHRvIGFic3RyYWN0IG1ldGhvZCIpOwogIH0KICBpbnRlcnZhbENoYW5nZWRfKCkgewogIH0KfQpJbnRlcnBvbGFudC5wcm90b3R5cGUuYmVmb3JlU3RhcnRfID0gSW50ZXJwb2xhbnQucHJvdG90eXBlLmNvcHlTYW1wbGVWYWx1ZV87CkludGVycG9sYW50LnByb3RvdHlwZS5hZnRlckVuZF8gPSBJbnRlcnBvbGFudC5wcm90b3R5cGUuY29weVNhbXBsZVZhbHVlXzsKY2xhc3MgQ3ViaWNJbnRlcnBvbGFudCBleHRlbmRzIEludGVycG9sYW50IHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJQb3NpdGlvbnMsIHNhbXBsZVZhbHVlcywgc2FtcGxlU2l6ZSwgcmVzdWx0QnVmZmVyKSB7CiAgICBzdXBlcihwYXJhbWV0ZXJQb3NpdGlvbnMsIHNhbXBsZVZhbHVlcywgc2FtcGxlU2l6ZSwgcmVzdWx0QnVmZmVyKTsKICAgIHRoaXMuX3dlaWdodFByZXYgPSAtMDsKICAgIHRoaXMuX29mZnNldFByZXYgPSAtMDsKICAgIHRoaXMuX3dlaWdodE5leHQgPSAtMDsKICAgIHRoaXMuX29mZnNldE5leHQgPSAtMDsKICAgIHRoaXMuRGVmYXVsdFNldHRpbmdzXyA9IHsKICAgICAgZW5kaW5nU3RhcnQ6IFplcm9DdXJ2YXR1cmVFbmRpbmcsCiAgICAgIGVuZGluZ0VuZDogWmVyb0N1cnZhdHVyZUVuZGluZwogICAgfTsKICB9CiAgaW50ZXJ2YWxDaGFuZ2VkXyhpMSwgdDAsIHQxKSB7CiAgICBjb25zdCBwcCA9IHRoaXMucGFyYW1ldGVyUG9zaXRpb25zOwogICAgbGV0IGlQcmV2ID0gaTEgLSAyLCBpTmV4dCA9IGkxICsgMSwgdFByZXYgPSBwcFtpUHJldl0sIHROZXh0ID0gcHBbaU5leHRdOwogICAgaWYgKHRQcmV2ID09PSB2b2lkIDApIHsKICAgICAgc3dpdGNoICh0aGlzLmdldFNldHRpbmdzXygpLmVuZGluZ1N0YXJ0KSB7CiAgICAgICAgY2FzZSBaZXJvU2xvcGVFbmRpbmc6CiAgICAgICAgICBpUHJldiA9IGkxOwogICAgICAgICAgdFByZXYgPSAyICogdDAgLSB0MTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgV3JhcEFyb3VuZEVuZGluZzoKICAgICAgICAgIGlQcmV2ID0gcHAubGVuZ3RoIC0gMjsKICAgICAgICAgIHRQcmV2ID0gdDAgKyBwcFtpUHJldl0gLSBwcFtpUHJldiArIDFdOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGlQcmV2ID0gaTE7CiAgICAgICAgICB0UHJldiA9IHQxOwogICAgICB9CiAgICB9CiAgICBpZiAodE5leHQgPT09IHZvaWQgMCkgewogICAgICBzd2l0Y2ggKHRoaXMuZ2V0U2V0dGluZ3NfKCkuZW5kaW5nRW5kKSB7CiAgICAgICAgY2FzZSBaZXJvU2xvcGVFbmRpbmc6CiAgICAgICAgICBpTmV4dCA9IGkxOwogICAgICAgICAgdE5leHQgPSAyICogdDEgLSB0MDsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgV3JhcEFyb3VuZEVuZGluZzoKICAgICAgICAgIGlOZXh0ID0gMTsKICAgICAgICAgIHROZXh0ID0gdDEgKyBwcFsxXSAtIHBwWzBdOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGlOZXh0ID0gaTEgLSAxOwogICAgICAgICAgdE5leHQgPSB0MDsKICAgICAgfQogICAgfQogICAgY29uc3QgaGFsZkR0ID0gKHQxIC0gdDApICogMC41LCBzdHJpZGUgPSB0aGlzLnZhbHVlU2l6ZTsKICAgIHRoaXMuX3dlaWdodFByZXYgPSBoYWxmRHQgLyAodDAgLSB0UHJldik7CiAgICB0aGlzLl93ZWlnaHROZXh0ID0gaGFsZkR0IC8gKHROZXh0IC0gdDEpOwogICAgdGhpcy5fb2Zmc2V0UHJldiA9IGlQcmV2ICogc3RyaWRlOwogICAgdGhpcy5fb2Zmc2V0TmV4dCA9IGlOZXh0ICogc3RyaWRlOwogIH0KICBpbnRlcnBvbGF0ZV8oaTEsIHQwLCB0LCB0MSkgewogICAgY29uc3QgcmVzdWx0ID0gdGhpcy5yZXN1bHRCdWZmZXIsIHZhbHVlcyA9IHRoaXMuc2FtcGxlVmFsdWVzLCBzdHJpZGUgPSB0aGlzLnZhbHVlU2l6ZSwgbzEgPSBpMSAqIHN0cmlkZSwgbzAgPSBvMSAtIHN0cmlkZSwgb1AgPSB0aGlzLl9vZmZzZXRQcmV2LCBvTiA9IHRoaXMuX29mZnNldE5leHQsIHdQID0gdGhpcy5fd2VpZ2h0UHJldiwgd04gPSB0aGlzLl93ZWlnaHROZXh0LCBwID0gKHQgLSB0MCkgLyAodDEgLSB0MCksIHBwID0gcCAqIHAsIHBwcCA9IHBwICogcDsKICAgIGNvbnN0IHNQID0gLXdQICogcHBwICsgMiAqIHdQICogcHAgLSB3UCAqIHA7CiAgICBjb25zdCBzMCA9ICgxICsgd1ApICogcHBwICsgKC0xLjUgLSAyICogd1ApICogcHAgKyAoLTAuNSArIHdQKSAqIHAgKyAxOwogICAgY29uc3QgczEgPSAoLTEgLSB3TikgKiBwcHAgKyAoMS41ICsgd04pICogcHAgKyAwLjUgKiBwOwogICAgY29uc3Qgc04gPSB3TiAqIHBwcCAtIHdOICogcHA7CiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gc3RyaWRlOyArK2kpIHsKICAgICAgcmVzdWx0W2ldID0gc1AgKiB2YWx1ZXNbb1AgKyBpXSArIHMwICogdmFsdWVzW28wICsgaV0gKyBzMSAqIHZhbHVlc1tvMSArIGldICsgc04gKiB2YWx1ZXNbb04gKyBpXTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQp9CmNsYXNzIExpbmVhckludGVycG9sYW50IGV4dGVuZHMgSW50ZXJwb2xhbnQgewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlclBvc2l0aW9ucywgc2FtcGxlVmFsdWVzLCBzYW1wbGVTaXplLCByZXN1bHRCdWZmZXIpIHsKICAgIHN1cGVyKHBhcmFtZXRlclBvc2l0aW9ucywgc2FtcGxlVmFsdWVzLCBzYW1wbGVTaXplLCByZXN1bHRCdWZmZXIpOwogIH0KICBpbnRlcnBvbGF0ZV8oaTEsIHQwLCB0LCB0MSkgewogICAgY29uc3QgcmVzdWx0ID0gdGhpcy5yZXN1bHRCdWZmZXIsIHZhbHVlcyA9IHRoaXMuc2FtcGxlVmFsdWVzLCBzdHJpZGUgPSB0aGlzLnZhbHVlU2l6ZSwgb2Zmc2V0MSA9IGkxICogc3RyaWRlLCBvZmZzZXQwID0gb2Zmc2V0MSAtIHN0cmlkZSwgd2VpZ2h0MSA9ICh0IC0gdDApIC8gKHQxIC0gdDApLCB3ZWlnaHQwID0gMSAtIHdlaWdodDE7CiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gc3RyaWRlOyArK2kpIHsKICAgICAgcmVzdWx0W2ldID0gdmFsdWVzW29mZnNldDAgKyBpXSAqIHdlaWdodDAgKyB2YWx1ZXNbb2Zmc2V0MSArIGldICogd2VpZ2h0MTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQp9CmNsYXNzIERpc2NyZXRlSW50ZXJwb2xhbnQgZXh0ZW5kcyBJbnRlcnBvbGFudCB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVyUG9zaXRpb25zLCBzYW1wbGVWYWx1ZXMsIHNhbXBsZVNpemUsIHJlc3VsdEJ1ZmZlcikgewogICAgc3VwZXIocGFyYW1ldGVyUG9zaXRpb25zLCBzYW1wbGVWYWx1ZXMsIHNhbXBsZVNpemUsIHJlc3VsdEJ1ZmZlcik7CiAgfQogIGludGVycG9sYXRlXyhpMSkgewogICAgcmV0dXJuIHRoaXMuY29weVNhbXBsZVZhbHVlXyhpMSAtIDEpOwogIH0KfQpjbGFzcyBLZXlmcmFtZVRyYWNrIHsKICBjb25zdHJ1Y3RvcihuYW1lLCB0aW1lcywgdmFsdWVzLCBpbnRlcnBvbGF0aW9uKSB7CiAgICBpZiAobmFtZSA9PT0gdm9pZCAwKQogICAgICB0aHJvdyBuZXcgRXJyb3IoIlRIUkVFLktleWZyYW1lVHJhY2s6IHRyYWNrIG5hbWUgaXMgdW5kZWZpbmVkIik7CiAgICBpZiAodGltZXMgPT09IHZvaWQgMCB8fCB0aW1lcy5sZW5ndGggPT09IDApCiAgICAgIHRocm93IG5ldyBFcnJvcigiVEhSRUUuS2V5ZnJhbWVUcmFjazogbm8ga2V5ZnJhbWVzIGluIHRyYWNrIG5hbWVkICIgKyBuYW1lKTsKICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICB0aGlzLnRpbWVzID0gQW5pbWF0aW9uVXRpbHMuY29udmVydEFycmF5KHRpbWVzLCB0aGlzLlRpbWVCdWZmZXJUeXBlKTsKICAgIHRoaXMudmFsdWVzID0gQW5pbWF0aW9uVXRpbHMuY29udmVydEFycmF5KHZhbHVlcywgdGhpcy5WYWx1ZUJ1ZmZlclR5cGUpOwogICAgdGhpcy5zZXRJbnRlcnBvbGF0aW9uKGludGVycG9sYXRpb24gfHwgdGhpcy5EZWZhdWx0SW50ZXJwb2xhdGlvbik7CiAgfQogIHN0YXRpYyB0b0pTT04odHJhY2spIHsKICAgIGNvbnN0IHRyYWNrVHlwZSA9IHRyYWNrLmNvbnN0cnVjdG9yOwogICAgbGV0IGpzb247CiAgICBpZiAodHJhY2tUeXBlLnRvSlNPTiAhPT0gdGhpcy50b0pTT04pIHsKICAgICAganNvbiA9IHRyYWNrVHlwZS50b0pTT04odHJhY2spOwogICAgfSBlbHNlIHsKICAgICAganNvbiA9IHsKICAgICAgICAibmFtZSI6IHRyYWNrLm5hbWUsCiAgICAgICAgInRpbWVzIjogQW5pbWF0aW9uVXRpbHMuY29udmVydEFycmF5KHRyYWNrLnRpbWVzLCBBcnJheSksCiAgICAgICAgInZhbHVlcyI6IEFuaW1hdGlvblV0aWxzLmNvbnZlcnRBcnJheSh0cmFjay52YWx1ZXMsIEFycmF5KQogICAgICB9OwogICAgICBjb25zdCBpbnRlcnBvbGF0aW9uID0gdHJhY2suZ2V0SW50ZXJwb2xhdGlvbigpOwogICAgICBpZiAoaW50ZXJwb2xhdGlvbiAhPT0gdHJhY2suRGVmYXVsdEludGVycG9sYXRpb24pIHsKICAgICAgICBqc29uLmludGVycG9sYXRpb24gPSBpbnRlcnBvbGF0aW9uOwogICAgICB9CiAgICB9CiAgICBqc29uLnR5cGUgPSB0cmFjay5WYWx1ZVR5cGVOYW1lOwogICAgcmV0dXJuIGpzb247CiAgfQogIEludGVycG9sYW50RmFjdG9yeU1ldGhvZERpc2NyZXRlKHJlc3VsdCkgewogICAgcmV0dXJuIG5ldyBEaXNjcmV0ZUludGVycG9sYW50KHRoaXMudGltZXMsIHRoaXMudmFsdWVzLCB0aGlzLmdldFZhbHVlU2l6ZSgpLCByZXN1bHQpOwogIH0KICBJbnRlcnBvbGFudEZhY3RvcnlNZXRob2RMaW5lYXIocmVzdWx0KSB7CiAgICByZXR1cm4gbmV3IExpbmVhckludGVycG9sYW50KHRoaXMudGltZXMsIHRoaXMudmFsdWVzLCB0aGlzLmdldFZhbHVlU2l6ZSgpLCByZXN1bHQpOwogIH0KICBJbnRlcnBvbGFudEZhY3RvcnlNZXRob2RTbW9vdGgocmVzdWx0KSB7CiAgICByZXR1cm4gbmV3IEN1YmljSW50ZXJwb2xhbnQodGhpcy50aW1lcywgdGhpcy52YWx1ZXMsIHRoaXMuZ2V0VmFsdWVTaXplKCksIHJlc3VsdCk7CiAgfQogIHNldEludGVycG9sYXRpb24oaW50ZXJwb2xhdGlvbikgewogICAgbGV0IGZhY3RvcnlNZXRob2Q7CiAgICBzd2l0Y2ggKGludGVycG9sYXRpb24pIHsKICAgICAgY2FzZSBJbnRlcnBvbGF0ZURpc2NyZXRlOgogICAgICAgIGZhY3RvcnlNZXRob2QgPSB0aGlzLkludGVycG9sYW50RmFjdG9yeU1ldGhvZERpc2NyZXRlOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIEludGVycG9sYXRlTGluZWFyOgogICAgICAgIGZhY3RvcnlNZXRob2QgPSB0aGlzLkludGVycG9sYW50RmFjdG9yeU1ldGhvZExpbmVhcjsKICAgICAgICBicmVhazsKICAgICAgY2FzZSBJbnRlcnBvbGF0ZVNtb290aDoKICAgICAgICBmYWN0b3J5TWV0aG9kID0gdGhpcy5JbnRlcnBvbGFudEZhY3RvcnlNZXRob2RTbW9vdGg7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgICBpZiAoZmFjdG9yeU1ldGhvZCA9PT0gdm9pZCAwKSB7CiAgICAgIGNvbnN0IG1lc3NhZ2UgPSAidW5zdXBwb3J0ZWQgaW50ZXJwb2xhdGlvbiBmb3IgIiArIHRoaXMuVmFsdWVUeXBlTmFtZSArICIga2V5ZnJhbWUgdHJhY2sgbmFtZWQgIiArIHRoaXMubmFtZTsKICAgICAgaWYgKHRoaXMuY3JlYXRlSW50ZXJwb2xhbnQgPT09IHZvaWQgMCkgewogICAgICAgIGlmIChpbnRlcnBvbGF0aW9uICE9PSB0aGlzLkRlZmF1bHRJbnRlcnBvbGF0aW9uKSB7CiAgICAgICAgICB0aGlzLnNldEludGVycG9sYXRpb24odGhpcy5EZWZhdWx0SW50ZXJwb2xhdGlvbik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5LZXlmcmFtZVRyYWNrOiIsIG1lc3NhZ2UpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIHRoaXMuY3JlYXRlSW50ZXJwb2xhbnQgPSBmYWN0b3J5TWV0aG9kOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGdldEludGVycG9sYXRpb24oKSB7CiAgICBzd2l0Y2ggKHRoaXMuY3JlYXRlSW50ZXJwb2xhbnQpIHsKICAgICAgY2FzZSB0aGlzLkludGVycG9sYW50RmFjdG9yeU1ldGhvZERpc2NyZXRlOgogICAgICAgIHJldHVybiBJbnRlcnBvbGF0ZURpc2NyZXRlOwogICAgICBjYXNlIHRoaXMuSW50ZXJwb2xhbnRGYWN0b3J5TWV0aG9kTGluZWFyOgogICAgICAgIHJldHVybiBJbnRlcnBvbGF0ZUxpbmVhcjsKICAgICAgY2FzZSB0aGlzLkludGVycG9sYW50RmFjdG9yeU1ldGhvZFNtb290aDoKICAgICAgICByZXR1cm4gSW50ZXJwb2xhdGVTbW9vdGg7CiAgICB9CiAgfQogIGdldFZhbHVlU2l6ZSgpIHsKICAgIHJldHVybiB0aGlzLnZhbHVlcy5sZW5ndGggLyB0aGlzLnRpbWVzLmxlbmd0aDsKICB9CiAgc2hpZnQodGltZU9mZnNldCkgewogICAgaWYgKHRpbWVPZmZzZXQgIT09IDApIHsKICAgICAgY29uc3QgdGltZXMgPSB0aGlzLnRpbWVzOwogICAgICBmb3IgKGxldCBpID0gMCwgbiA9IHRpbWVzLmxlbmd0aDsgaSAhPT0gbjsgKytpKSB7CiAgICAgICAgdGltZXNbaV0gKz0gdGltZU9mZnNldDsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNjYWxlKHRpbWVTY2FsZSkgewogICAgaWYgKHRpbWVTY2FsZSAhPT0gMSkgewogICAgICBjb25zdCB0aW1lcyA9IHRoaXMudGltZXM7CiAgICAgIGZvciAobGV0IGkgPSAwLCBuID0gdGltZXMubGVuZ3RoOyBpICE9PSBuOyArK2kpIHsKICAgICAgICB0aW1lc1tpXSAqPSB0aW1lU2NhbGU7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICB0cmltKHN0YXJ0VGltZSwgZW5kVGltZSkgewogICAgY29uc3QgdGltZXMgPSB0aGlzLnRpbWVzLCBuS2V5cyA9IHRpbWVzLmxlbmd0aDsKICAgIGxldCBmcm9tID0gMCwgdG8gPSBuS2V5cyAtIDE7CiAgICB3aGlsZSAoZnJvbSAhPT0gbktleXMgJiYgdGltZXNbZnJvbV0gPCBzdGFydFRpbWUpIHsKICAgICAgKytmcm9tOwogICAgfQogICAgd2hpbGUgKHRvICE9PSAtMSAmJiB0aW1lc1t0b10gPiBlbmRUaW1lKSB7CiAgICAgIC0tdG87CiAgICB9CiAgICArK3RvOwogICAgaWYgKGZyb20gIT09IDAgfHwgdG8gIT09IG5LZXlzKSB7CiAgICAgIGlmIChmcm9tID49IHRvKSB7CiAgICAgICAgdG8gPSBNYXRoLm1heCh0bywgMSk7CiAgICAgICAgZnJvbSA9IHRvIC0gMTsKICAgICAgfQogICAgICBjb25zdCBzdHJpZGUgPSB0aGlzLmdldFZhbHVlU2l6ZSgpOwogICAgICB0aGlzLnRpbWVzID0gQW5pbWF0aW9uVXRpbHMuYXJyYXlTbGljZSh0aW1lcywgZnJvbSwgdG8pOwogICAgICB0aGlzLnZhbHVlcyA9IEFuaW1hdGlvblV0aWxzLmFycmF5U2xpY2UodGhpcy52YWx1ZXMsIGZyb20gKiBzdHJpZGUsIHRvICogc3RyaWRlKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICB2YWxpZGF0ZSgpIHsKICAgIGxldCB2YWxpZCA9IHRydWU7CiAgICBjb25zdCB2YWx1ZVNpemUgPSB0aGlzLmdldFZhbHVlU2l6ZSgpOwogICAgaWYgKHZhbHVlU2l6ZSAtIE1hdGguZmxvb3IodmFsdWVTaXplKSAhPT0gMCkgewogICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5LZXlmcmFtZVRyYWNrOiBJbnZhbGlkIHZhbHVlIHNpemUgaW4gdHJhY2suIiwgdGhpcyk7CiAgICAgIHZhbGlkID0gZmFsc2U7CiAgICB9CiAgICBjb25zdCB0aW1lcyA9IHRoaXMudGltZXMsIHZhbHVlcyA9IHRoaXMudmFsdWVzLCBuS2V5cyA9IHRpbWVzLmxlbmd0aDsKICAgIGlmIChuS2V5cyA9PT0gMCkgewogICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5LZXlmcmFtZVRyYWNrOiBUcmFjayBpcyBlbXB0eS4iLCB0aGlzKTsKICAgICAgdmFsaWQgPSBmYWxzZTsKICAgIH0KICAgIGxldCBwcmV2VGltZSA9IG51bGw7CiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gbktleXM7IGkrKykgewogICAgICBjb25zdCBjdXJyVGltZSA9IHRpbWVzW2ldOwogICAgICBpZiAodHlwZW9mIGN1cnJUaW1lID09PSAibnVtYmVyIiAmJiBpc05hTihjdXJyVGltZSkpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5LZXlmcmFtZVRyYWNrOiBUaW1lIGlzIG5vdCBhIHZhbGlkIG51bWJlci4iLCB0aGlzLCBpLCBjdXJyVGltZSk7CiAgICAgICAgdmFsaWQgPSBmYWxzZTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgICBpZiAocHJldlRpbWUgIT09IG51bGwgJiYgcHJldlRpbWUgPiBjdXJyVGltZSkgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLktleWZyYW1lVHJhY2s6IE91dCBvZiBvcmRlciBrZXlzLiIsIHRoaXMsIGksIGN1cnJUaW1lLCBwcmV2VGltZSk7CiAgICAgICAgdmFsaWQgPSBmYWxzZTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgICBwcmV2VGltZSA9IGN1cnJUaW1lOwogICAgfQogICAgaWYgKHZhbHVlcyAhPT0gdm9pZCAwKSB7CiAgICAgIGlmIChBbmltYXRpb25VdGlscy5pc1R5cGVkQXJyYXkodmFsdWVzKSkgewogICAgICAgIGZvciAobGV0IGkgPSAwLCBuID0gdmFsdWVzLmxlbmd0aDsgaSAhPT0gbjsgKytpKSB7CiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHZhbHVlc1tpXTsKICAgICAgICAgIGlmIChpc05hTih2YWx1ZSkpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuS2V5ZnJhbWVUcmFjazogVmFsdWUgaXMgbm90IGEgdmFsaWQgbnVtYmVyLiIsIHRoaXMsIGksIHZhbHVlKTsKICAgICAgICAgICAgdmFsaWQgPSBmYWxzZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICByZXR1cm4gdmFsaWQ7CiAgfQogIG9wdGltaXplKCkgewogICAgY29uc3QgdGltZXMgPSBBbmltYXRpb25VdGlscy5hcnJheVNsaWNlKHRoaXMudGltZXMpLCB2YWx1ZXMgPSBBbmltYXRpb25VdGlscy5hcnJheVNsaWNlKHRoaXMudmFsdWVzKSwgc3RyaWRlID0gdGhpcy5nZXRWYWx1ZVNpemUoKSwgc21vb3RoSW50ZXJwb2xhdGlvbiA9IHRoaXMuZ2V0SW50ZXJwb2xhdGlvbigpID09PSBJbnRlcnBvbGF0ZVNtb290aCwgbGFzdEluZGV4ID0gdGltZXMubGVuZ3RoIC0gMTsKICAgIGxldCB3cml0ZUluZGV4ID0gMTsKICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbGFzdEluZGV4OyArK2kpIHsKICAgICAgbGV0IGtlZXAgPSBmYWxzZTsKICAgICAgY29uc3QgdGltZSA9IHRpbWVzW2ldOwogICAgICBjb25zdCB0aW1lTmV4dCA9IHRpbWVzW2kgKyAxXTsKICAgICAgaWYgKHRpbWUgIT09IHRpbWVOZXh0ICYmIChpICE9PSAxIHx8IHRpbWUgIT09IHRpbWVzWzBdKSkgewogICAgICAgIGlmICghc21vb3RoSW50ZXJwb2xhdGlvbikgewogICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gaSAqIHN0cmlkZSwgb2Zmc2V0UCA9IG9mZnNldCAtIHN0cmlkZSwgb2Zmc2V0TiA9IG9mZnNldCArIHN0cmlkZTsKICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBzdHJpZGU7ICsraikgewogICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHZhbHVlc1tvZmZzZXQgKyBqXTsKICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB2YWx1ZXNbb2Zmc2V0UCArIGpdIHx8IHZhbHVlICE9PSB2YWx1ZXNbb2Zmc2V0TiArIGpdKSB7CiAgICAgICAgICAgICAga2VlcCA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAga2VlcCA9IHRydWU7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChrZWVwKSB7CiAgICAgICAgaWYgKGkgIT09IHdyaXRlSW5kZXgpIHsKICAgICAgICAgIHRpbWVzW3dyaXRlSW5kZXhdID0gdGltZXNbaV07CiAgICAgICAgICBjb25zdCByZWFkT2Zmc2V0ID0gaSAqIHN0cmlkZSwgd3JpdGVPZmZzZXQgPSB3cml0ZUluZGV4ICogc3RyaWRlOwogICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IHN0cmlkZTsgKytqKSB7CiAgICAgICAgICAgIHZhbHVlc1t3cml0ZU9mZnNldCArIGpdID0gdmFsdWVzW3JlYWRPZmZzZXQgKyBqXTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgKyt3cml0ZUluZGV4OwogICAgICB9CiAgICB9CiAgICBpZiAobGFzdEluZGV4ID4gMCkgewogICAgICB0aW1lc1t3cml0ZUluZGV4XSA9IHRpbWVzW2xhc3RJbmRleF07CiAgICAgIGZvciAobGV0IHJlYWRPZmZzZXQgPSBsYXN0SW5kZXggKiBzdHJpZGUsIHdyaXRlT2Zmc2V0ID0gd3JpdGVJbmRleCAqIHN0cmlkZSwgaiA9IDA7IGogIT09IHN0cmlkZTsgKytqKSB7CiAgICAgICAgdmFsdWVzW3dyaXRlT2Zmc2V0ICsgal0gPSB2YWx1ZXNbcmVhZE9mZnNldCArIGpdOwogICAgICB9CiAgICAgICsrd3JpdGVJbmRleDsKICAgIH0KICAgIGlmICh3cml0ZUluZGV4ICE9PSB0aW1lcy5sZW5ndGgpIHsKICAgICAgdGhpcy50aW1lcyA9IEFuaW1hdGlvblV0aWxzLmFycmF5U2xpY2UodGltZXMsIDAsIHdyaXRlSW5kZXgpOwogICAgICB0aGlzLnZhbHVlcyA9IEFuaW1hdGlvblV0aWxzLmFycmF5U2xpY2UodmFsdWVzLCAwLCB3cml0ZUluZGV4ICogc3RyaWRlKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMudGltZXMgPSB0aW1lczsKICAgICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXM7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xvbmUoKSB7CiAgICBjb25zdCB0aW1lcyA9IEFuaW1hdGlvblV0aWxzLmFycmF5U2xpY2UodGhpcy50aW1lcywgMCk7CiAgICBjb25zdCB2YWx1ZXMgPSBBbmltYXRpb25VdGlscy5hcnJheVNsaWNlKHRoaXMudmFsdWVzLCAwKTsKICAgIGNvbnN0IFR5cGVkS2V5ZnJhbWVUcmFjayA9IHRoaXMuY29uc3RydWN0b3I7CiAgICBjb25zdCB0cmFjayA9IG5ldyBUeXBlZEtleWZyYW1lVHJhY2sodGhpcy5uYW1lLCB0aW1lcywgdmFsdWVzKTsKICAgIHRyYWNrLmNyZWF0ZUludGVycG9sYW50ID0gdGhpcy5jcmVhdGVJbnRlcnBvbGFudDsKICAgIHJldHVybiB0cmFjazsKICB9Cn0KS2V5ZnJhbWVUcmFjay5wcm90b3R5cGUuVGltZUJ1ZmZlclR5cGUgPSBGbG9hdDMyQXJyYXk7CktleWZyYW1lVHJhY2sucHJvdG90eXBlLlZhbHVlQnVmZmVyVHlwZSA9IEZsb2F0MzJBcnJheTsKS2V5ZnJhbWVUcmFjay5wcm90b3R5cGUuRGVmYXVsdEludGVycG9sYXRpb24gPSBJbnRlcnBvbGF0ZUxpbmVhcjsKY2xhc3MgQm9vbGVhbktleWZyYW1lVHJhY2sgZXh0ZW5kcyBLZXlmcmFtZVRyYWNrIHsKfQpCb29sZWFuS2V5ZnJhbWVUcmFjay5wcm90b3R5cGUuVmFsdWVUeXBlTmFtZSA9ICJib29sIjsKQm9vbGVhbktleWZyYW1lVHJhY2sucHJvdG90eXBlLlZhbHVlQnVmZmVyVHlwZSA9IEFycmF5OwpCb29sZWFuS2V5ZnJhbWVUcmFjay5wcm90b3R5cGUuRGVmYXVsdEludGVycG9sYXRpb24gPSBJbnRlcnBvbGF0ZURpc2NyZXRlOwpCb29sZWFuS2V5ZnJhbWVUcmFjay5wcm90b3R5cGUuSW50ZXJwb2xhbnRGYWN0b3J5TWV0aG9kTGluZWFyID0gdm9pZCAwOwpCb29sZWFuS2V5ZnJhbWVUcmFjay5wcm90b3R5cGUuSW50ZXJwb2xhbnRGYWN0b3J5TWV0aG9kU21vb3RoID0gdm9pZCAwOwpjbGFzcyBDb2xvcktleWZyYW1lVHJhY2sgZXh0ZW5kcyBLZXlmcmFtZVRyYWNrIHsKfQpDb2xvcktleWZyYW1lVHJhY2sucHJvdG90eXBlLlZhbHVlVHlwZU5hbWUgPSAiY29sb3IiOwpjbGFzcyBOdW1iZXJLZXlmcmFtZVRyYWNrIGV4dGVuZHMgS2V5ZnJhbWVUcmFjayB7Cn0KTnVtYmVyS2V5ZnJhbWVUcmFjay5wcm90b3R5cGUuVmFsdWVUeXBlTmFtZSA9ICJudW1iZXIiOwpjbGFzcyBRdWF0ZXJuaW9uTGluZWFySW50ZXJwb2xhbnQgZXh0ZW5kcyBJbnRlcnBvbGFudCB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVyUG9zaXRpb25zLCBzYW1wbGVWYWx1ZXMsIHNhbXBsZVNpemUsIHJlc3VsdEJ1ZmZlcikgewogICAgc3VwZXIocGFyYW1ldGVyUG9zaXRpb25zLCBzYW1wbGVWYWx1ZXMsIHNhbXBsZVNpemUsIHJlc3VsdEJ1ZmZlcik7CiAgfQogIGludGVycG9sYXRlXyhpMSwgdDAsIHQsIHQxKSB7CiAgICBjb25zdCByZXN1bHQgPSB0aGlzLnJlc3VsdEJ1ZmZlciwgdmFsdWVzID0gdGhpcy5zYW1wbGVWYWx1ZXMsIHN0cmlkZSA9IHRoaXMudmFsdWVTaXplLCBhbHBoYSA9ICh0IC0gdDApIC8gKHQxIC0gdDApOwogICAgbGV0IG9mZnNldCA9IGkxICogc3RyaWRlOwogICAgZm9yIChsZXQgZW5kID0gb2Zmc2V0ICsgc3RyaWRlOyBvZmZzZXQgIT09IGVuZDsgb2Zmc2V0ICs9IDQpIHsKICAgICAgUXVhdGVybmlvbi5zbGVycEZsYXQocmVzdWx0LCAwLCB2YWx1ZXMsIG9mZnNldCAtIHN0cmlkZSwgdmFsdWVzLCBvZmZzZXQsIGFscGhhKTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQp9CmNsYXNzIFF1YXRlcm5pb25LZXlmcmFtZVRyYWNrIGV4dGVuZHMgS2V5ZnJhbWVUcmFjayB7CiAgSW50ZXJwb2xhbnRGYWN0b3J5TWV0aG9kTGluZWFyKHJlc3VsdCkgewogICAgcmV0dXJuIG5ldyBRdWF0ZXJuaW9uTGluZWFySW50ZXJwb2xhbnQodGhpcy50aW1lcywgdGhpcy52YWx1ZXMsIHRoaXMuZ2V0VmFsdWVTaXplKCksIHJlc3VsdCk7CiAgfQp9ClF1YXRlcm5pb25LZXlmcmFtZVRyYWNrLnByb3RvdHlwZS5WYWx1ZVR5cGVOYW1lID0gInF1YXRlcm5pb24iOwpRdWF0ZXJuaW9uS2V5ZnJhbWVUcmFjay5wcm90b3R5cGUuRGVmYXVsdEludGVycG9sYXRpb24gPSBJbnRlcnBvbGF0ZUxpbmVhcjsKUXVhdGVybmlvbktleWZyYW1lVHJhY2sucHJvdG90eXBlLkludGVycG9sYW50RmFjdG9yeU1ldGhvZFNtb290aCA9IHZvaWQgMDsKY2xhc3MgU3RyaW5nS2V5ZnJhbWVUcmFjayBleHRlbmRzIEtleWZyYW1lVHJhY2sgewp9ClN0cmluZ0tleWZyYW1lVHJhY2sucHJvdG90eXBlLlZhbHVlVHlwZU5hbWUgPSAic3RyaW5nIjsKU3RyaW5nS2V5ZnJhbWVUcmFjay5wcm90b3R5cGUuVmFsdWVCdWZmZXJUeXBlID0gQXJyYXk7ClN0cmluZ0tleWZyYW1lVHJhY2sucHJvdG90eXBlLkRlZmF1bHRJbnRlcnBvbGF0aW9uID0gSW50ZXJwb2xhdGVEaXNjcmV0ZTsKU3RyaW5nS2V5ZnJhbWVUcmFjay5wcm90b3R5cGUuSW50ZXJwb2xhbnRGYWN0b3J5TWV0aG9kTGluZWFyID0gdm9pZCAwOwpTdHJpbmdLZXlmcmFtZVRyYWNrLnByb3RvdHlwZS5JbnRlcnBvbGFudEZhY3RvcnlNZXRob2RTbW9vdGggPSB2b2lkIDA7CmNsYXNzIFZlY3RvcktleWZyYW1lVHJhY2sgZXh0ZW5kcyBLZXlmcmFtZVRyYWNrIHsKfQpWZWN0b3JLZXlmcmFtZVRyYWNrLnByb3RvdHlwZS5WYWx1ZVR5cGVOYW1lID0gInZlY3RvciI7CmNsYXNzIEFuaW1hdGlvbkNsaXAgewogIGNvbnN0cnVjdG9yKG5hbWUsIGR1cmF0aW9uID0gLTEsIHRyYWNrcywgYmxlbmRNb2RlID0gTm9ybWFsQW5pbWF0aW9uQmxlbmRNb2RlKSB7CiAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgdGhpcy50cmFja3MgPSB0cmFja3M7CiAgICB0aGlzLmR1cmF0aW9uID0gZHVyYXRpb247CiAgICB0aGlzLmJsZW5kTW9kZSA9IGJsZW5kTW9kZTsKICAgIHRoaXMudXVpZCA9IGdlbmVyYXRlVVVJRCgpOwogICAgaWYgKHRoaXMuZHVyYXRpb24gPCAwKSB7CiAgICAgIHRoaXMucmVzZXREdXJhdGlvbigpOwogICAgfQogIH0KICBzdGF0aWMgcGFyc2UoanNvbikgewogICAgY29uc3QgdHJhY2tzID0gW10sIGpzb25UcmFja3MgPSBqc29uLnRyYWNrcywgZnJhbWVUaW1lID0gMSAvIChqc29uLmZwcyB8fCAxKTsKICAgIGZvciAobGV0IGkgPSAwLCBuID0ganNvblRyYWNrcy5sZW5ndGg7IGkgIT09IG47ICsraSkgewogICAgICB0cmFja3MucHVzaChwYXJzZUtleWZyYW1lVHJhY2soanNvblRyYWNrc1tpXSkuc2NhbGUoZnJhbWVUaW1lKSk7CiAgICB9CiAgICBjb25zdCBjbGlwID0gbmV3IHRoaXMoanNvbi5uYW1lLCBqc29uLmR1cmF0aW9uLCB0cmFja3MsIGpzb24uYmxlbmRNb2RlKTsKICAgIGNsaXAudXVpZCA9IGpzb24udXVpZDsKICAgIHJldHVybiBjbGlwOwogIH0KICBzdGF0aWMgdG9KU09OKGNsaXApIHsKICAgIGNvbnN0IHRyYWNrcyA9IFtdLCBjbGlwVHJhY2tzID0gY2xpcC50cmFja3M7CiAgICBjb25zdCBqc29uID0gewogICAgICAibmFtZSI6IGNsaXAubmFtZSwKICAgICAgImR1cmF0aW9uIjogY2xpcC5kdXJhdGlvbiwKICAgICAgInRyYWNrcyI6IHRyYWNrcywKICAgICAgInV1aWQiOiBjbGlwLnV1aWQsCiAgICAgICJibGVuZE1vZGUiOiBjbGlwLmJsZW5kTW9kZQogICAgfTsKICAgIGZvciAobGV0IGkgPSAwLCBuID0gY2xpcFRyYWNrcy5sZW5ndGg7IGkgIT09IG47ICsraSkgewogICAgICB0cmFja3MucHVzaChLZXlmcmFtZVRyYWNrLnRvSlNPTihjbGlwVHJhY2tzW2ldKSk7CiAgICB9CiAgICByZXR1cm4ganNvbjsKICB9CiAgc3RhdGljIENyZWF0ZUZyb21Nb3JwaFRhcmdldFNlcXVlbmNlKG5hbWUsIG1vcnBoVGFyZ2V0U2VxdWVuY2UsIGZwcywgbm9Mb29wKSB7CiAgICBjb25zdCBudW1Nb3JwaFRhcmdldHMgPSBtb3JwaFRhcmdldFNlcXVlbmNlLmxlbmd0aDsKICAgIGNvbnN0IHRyYWNrcyA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1Nb3JwaFRhcmdldHM7IGkrKykgewogICAgICBsZXQgdGltZXMgPSBbXTsKICAgICAgbGV0IHZhbHVlcyA9IFtdOwogICAgICB0aW1lcy5wdXNoKChpICsgbnVtTW9ycGhUYXJnZXRzIC0gMSkgJSBudW1Nb3JwaFRhcmdldHMsIGksIChpICsgMSkgJSBudW1Nb3JwaFRhcmdldHMpOwogICAgICB2YWx1ZXMucHVzaCgwLCAxLCAwKTsKICAgICAgY29uc3Qgb3JkZXIgPSBBbmltYXRpb25VdGlscy5nZXRLZXlmcmFtZU9yZGVyKHRpbWVzKTsKICAgICAgdGltZXMgPSBBbmltYXRpb25VdGlscy5zb3J0ZWRBcnJheSh0aW1lcywgMSwgb3JkZXIpOwogICAgICB2YWx1ZXMgPSBBbmltYXRpb25VdGlscy5zb3J0ZWRBcnJheSh2YWx1ZXMsIDEsIG9yZGVyKTsKICAgICAgaWYgKCFub0xvb3AgJiYgdGltZXNbMF0gPT09IDApIHsKICAgICAgICB0aW1lcy5wdXNoKG51bU1vcnBoVGFyZ2V0cyk7CiAgICAgICAgdmFsdWVzLnB1c2godmFsdWVzWzBdKTsKICAgICAgfQogICAgICB0cmFja3MucHVzaChuZXcgTnVtYmVyS2V5ZnJhbWVUcmFjaygiLm1vcnBoVGFyZ2V0SW5mbHVlbmNlc1siICsgbW9ycGhUYXJnZXRTZXF1ZW5jZVtpXS5uYW1lICsgIl0iLCB0aW1lcywgdmFsdWVzKS5zY2FsZSgxIC8gZnBzKSk7CiAgICB9CiAgICByZXR1cm4gbmV3IHRoaXMobmFtZSwgLTEsIHRyYWNrcyk7CiAgfQogIHN0YXRpYyBmaW5kQnlOYW1lKG9iamVjdE9yQ2xpcEFycmF5LCBuYW1lKSB7CiAgICBsZXQgY2xpcEFycmF5ID0gb2JqZWN0T3JDbGlwQXJyYXk7CiAgICBpZiAoIUFycmF5LmlzQXJyYXkob2JqZWN0T3JDbGlwQXJyYXkpKSB7CiAgICAgIGNvbnN0IG8gPSBvYmplY3RPckNsaXBBcnJheTsKICAgICAgY2xpcEFycmF5ID0gby5nZW9tZXRyeSAmJiBvLmdlb21ldHJ5LmFuaW1hdGlvbnMgfHwgby5hbmltYXRpb25zOwogICAgfQogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjbGlwQXJyYXkubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKGNsaXBBcnJheVtpXS5uYW1lID09PSBuYW1lKSB7CiAgICAgICAgcmV0dXJuIGNsaXBBcnJheVtpXTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIG51bGw7CiAgfQogIHN0YXRpYyBDcmVhdGVDbGlwc0Zyb21Nb3JwaFRhcmdldFNlcXVlbmNlcyhtb3JwaFRhcmdldHMsIGZwcywgbm9Mb29wKSB7CiAgICBjb25zdCBhbmltYXRpb25Ub01vcnBoVGFyZ2V0cyA9IHt9OwogICAgY29uc3QgcGF0dGVybiA9IC9eKFtcdy1dKj8pKFtcZF0rKSQvOwogICAgZm9yIChsZXQgaSA9IDAsIGlsID0gbW9ycGhUYXJnZXRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHsKICAgICAgY29uc3QgbW9ycGhUYXJnZXQgPSBtb3JwaFRhcmdldHNbaV07CiAgICAgIGNvbnN0IHBhcnRzID0gbW9ycGhUYXJnZXQubmFtZS5tYXRjaChwYXR0ZXJuKTsKICAgICAgaWYgKHBhcnRzICYmIHBhcnRzLmxlbmd0aCA+IDEpIHsKICAgICAgICBjb25zdCBuYW1lID0gcGFydHNbMV07CiAgICAgICAgbGV0IGFuaW1hdGlvbk1vcnBoVGFyZ2V0cyA9IGFuaW1hdGlvblRvTW9ycGhUYXJnZXRzW25hbWVdOwogICAgICAgIGlmICghYW5pbWF0aW9uTW9ycGhUYXJnZXRzKSB7CiAgICAgICAgICBhbmltYXRpb25Ub01vcnBoVGFyZ2V0c1tuYW1lXSA9IGFuaW1hdGlvbk1vcnBoVGFyZ2V0cyA9IFtdOwogICAgICAgIH0KICAgICAgICBhbmltYXRpb25Nb3JwaFRhcmdldHMucHVzaChtb3JwaFRhcmdldCk7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IGNsaXBzID0gW107CiAgICBmb3IgKGNvbnN0IG5hbWUgaW4gYW5pbWF0aW9uVG9Nb3JwaFRhcmdldHMpIHsKICAgICAgY2xpcHMucHVzaCh0aGlzLkNyZWF0ZUZyb21Nb3JwaFRhcmdldFNlcXVlbmNlKG5hbWUsIGFuaW1hdGlvblRvTW9ycGhUYXJnZXRzW25hbWVdLCBmcHMsIG5vTG9vcCkpOwogICAgfQogICAgcmV0dXJuIGNsaXBzOwogIH0KICBzdGF0aWMgcGFyc2VBbmltYXRpb24oYW5pbWF0aW9uLCBib25lcykgewogICAgaWYgKCFhbmltYXRpb24pIHsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuQW5pbWF0aW9uQ2xpcDogTm8gYW5pbWF0aW9uIGluIEpTT05Mb2FkZXIgZGF0YS4iKTsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICBjb25zdCBhZGROb25lbXB0eVRyYWNrID0gZnVuY3Rpb24odHJhY2tUeXBlLCB0cmFja05hbWUsIGFuaW1hdGlvbktleXMsIHByb3BlcnR5TmFtZSwgZGVzdFRyYWNrcykgewogICAgICBpZiAoYW5pbWF0aW9uS2V5cy5sZW5ndGggIT09IDApIHsKICAgICAgICBjb25zdCB0aW1lcyA9IFtdOwogICAgICAgIGNvbnN0IHZhbHVlcyA9IFtdOwogICAgICAgIEFuaW1hdGlvblV0aWxzLmZsYXR0ZW5KU09OKGFuaW1hdGlvbktleXMsIHRpbWVzLCB2YWx1ZXMsIHByb3BlcnR5TmFtZSk7CiAgICAgICAgaWYgKHRpbWVzLmxlbmd0aCAhPT0gMCkgewogICAgICAgICAgZGVzdFRyYWNrcy5wdXNoKG5ldyB0cmFja1R5cGUodHJhY2tOYW1lLCB0aW1lcywgdmFsdWVzKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgY29uc3QgdHJhY2tzID0gW107CiAgICBjb25zdCBjbGlwTmFtZSA9IGFuaW1hdGlvbi5uYW1lIHx8ICJkZWZhdWx0IjsKICAgIGNvbnN0IGZwcyA9IGFuaW1hdGlvbi5mcHMgfHwgMzA7CiAgICBjb25zdCBibGVuZE1vZGUgPSBhbmltYXRpb24uYmxlbmRNb2RlOwogICAgbGV0IGR1cmF0aW9uID0gYW5pbWF0aW9uLmxlbmd0aCB8fCAtMTsKICAgIGNvbnN0IGhpZXJhcmNoeVRyYWNrcyA9IGFuaW1hdGlvbi5oaWVyYXJjaHkgfHwgW107CiAgICBmb3IgKGxldCBoID0gMDsgaCA8IGhpZXJhcmNoeVRyYWNrcy5sZW5ndGg7IGgrKykgewogICAgICBjb25zdCBhbmltYXRpb25LZXlzID0gaGllcmFyY2h5VHJhY2tzW2hdLmtleXM7CiAgICAgIGlmICghYW5pbWF0aW9uS2V5cyB8fCBhbmltYXRpb25LZXlzLmxlbmd0aCA9PT0gMCkKICAgICAgICBjb250aW51ZTsKICAgICAgaWYgKGFuaW1hdGlvbktleXNbMF0ubW9ycGhUYXJnZXRzKSB7CiAgICAgICAgY29uc3QgbW9ycGhUYXJnZXROYW1lcyA9IHt9OwogICAgICAgIGxldCBrOwogICAgICAgIGZvciAoayA9IDA7IGsgPCBhbmltYXRpb25LZXlzLmxlbmd0aDsgaysrKSB7CiAgICAgICAgICBpZiAoYW5pbWF0aW9uS2V5c1trXS5tb3JwaFRhcmdldHMpIHsKICAgICAgICAgICAgZm9yIChsZXQgbSA9IDA7IG0gPCBhbmltYXRpb25LZXlzW2tdLm1vcnBoVGFyZ2V0cy5sZW5ndGg7IG0rKykgewogICAgICAgICAgICAgIG1vcnBoVGFyZ2V0TmFtZXNbYW5pbWF0aW9uS2V5c1trXS5tb3JwaFRhcmdldHNbbV1dID0gLTE7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZm9yIChjb25zdCBtb3JwaFRhcmdldE5hbWUgaW4gbW9ycGhUYXJnZXROYW1lcykgewogICAgICAgICAgY29uc3QgdGltZXMgPSBbXTsKICAgICAgICAgIGNvbnN0IHZhbHVlcyA9IFtdOwogICAgICAgICAgZm9yIChsZXQgbSA9IDA7IG0gIT09IGFuaW1hdGlvbktleXNba10ubW9ycGhUYXJnZXRzLmxlbmd0aDsgKyttKSB7CiAgICAgICAgICAgIGNvbnN0IGFuaW1hdGlvbktleSA9IGFuaW1hdGlvbktleXNba107CiAgICAgICAgICAgIHRpbWVzLnB1c2goYW5pbWF0aW9uS2V5LnRpbWUpOwogICAgICAgICAgICB2YWx1ZXMucHVzaChhbmltYXRpb25LZXkubW9ycGhUYXJnZXQgPT09IG1vcnBoVGFyZ2V0TmFtZSA/IDEgOiAwKTsKICAgICAgICAgIH0KICAgICAgICAgIHRyYWNrcy5wdXNoKG5ldyBOdW1iZXJLZXlmcmFtZVRyYWNrKCIubW9ycGhUYXJnZXRJbmZsdWVuY2VbIiArIG1vcnBoVGFyZ2V0TmFtZSArICJdIiwgdGltZXMsIHZhbHVlcykpOwogICAgICAgIH0KICAgICAgICBkdXJhdGlvbiA9IG1vcnBoVGFyZ2V0TmFtZXMubGVuZ3RoICogKGZwcyB8fCAxKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBib25lTmFtZSA9ICIuYm9uZXNbIiArIGJvbmVzW2hdLm5hbWUgKyAiXSI7CiAgICAgICAgYWRkTm9uZW1wdHlUcmFjayhWZWN0b3JLZXlmcmFtZVRyYWNrLCBib25lTmFtZSArICIucG9zaXRpb24iLCBhbmltYXRpb25LZXlzLCAicG9zIiwgdHJhY2tzKTsKICAgICAgICBhZGROb25lbXB0eVRyYWNrKFF1YXRlcm5pb25LZXlmcmFtZVRyYWNrLCBib25lTmFtZSArICIucXVhdGVybmlvbiIsIGFuaW1hdGlvbktleXMsICJyb3QiLCB0cmFja3MpOwogICAgICAgIGFkZE5vbmVtcHR5VHJhY2soVmVjdG9yS2V5ZnJhbWVUcmFjaywgYm9uZU5hbWUgKyAiLnNjYWxlIiwgYW5pbWF0aW9uS2V5cywgInNjbCIsIHRyYWNrcyk7CiAgICAgIH0KICAgIH0KICAgIGlmICh0cmFja3MubGVuZ3RoID09PSAwKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQogICAgY29uc3QgY2xpcCA9IG5ldyB0aGlzKGNsaXBOYW1lLCBkdXJhdGlvbiwgdHJhY2tzLCBibGVuZE1vZGUpOwogICAgcmV0dXJuIGNsaXA7CiAgfQogIHJlc2V0RHVyYXRpb24oKSB7CiAgICBjb25zdCB0cmFja3MgPSB0aGlzLnRyYWNrczsKICAgIGxldCBkdXJhdGlvbiA9IDA7CiAgICBmb3IgKGxldCBpID0gMCwgbiA9IHRyYWNrcy5sZW5ndGg7IGkgIT09IG47ICsraSkgewogICAgICBjb25zdCB0cmFjayA9IHRoaXMudHJhY2tzW2ldOwogICAgICBkdXJhdGlvbiA9IE1hdGgubWF4KGR1cmF0aW9uLCB0cmFjay50aW1lc1t0cmFjay50aW1lcy5sZW5ndGggLSAxXSk7CiAgICB9CiAgICB0aGlzLmR1cmF0aW9uID0gZHVyYXRpb247CiAgICByZXR1cm4gdGhpczsKICB9CiAgdHJpbSgpIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50cmFja3MubGVuZ3RoOyBpKyspIHsKICAgICAgdGhpcy50cmFja3NbaV0udHJpbSgwLCB0aGlzLmR1cmF0aW9uKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICB2YWxpZGF0ZSgpIHsKICAgIGxldCB2YWxpZCA9IHRydWU7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudHJhY2tzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhbGlkID0gdmFsaWQgJiYgdGhpcy50cmFja3NbaV0udmFsaWRhdGUoKTsKICAgIH0KICAgIHJldHVybiB2YWxpZDsKICB9CiAgb3B0aW1pemUoKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudHJhY2tzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHRoaXMudHJhY2tzW2ldLm9wdGltaXplKCk7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xvbmUoKSB7CiAgICBjb25zdCB0cmFja3MgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50cmFja3MubGVuZ3RoOyBpKyspIHsKICAgICAgdHJhY2tzLnB1c2godGhpcy50cmFja3NbaV0uY2xvbmUoKSk7CiAgICB9CiAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5uYW1lLCB0aGlzLmR1cmF0aW9uLCB0cmFja3MsIHRoaXMuYmxlbmRNb2RlKTsKICB9CiAgdG9KU09OKCkgewogICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3IudG9KU09OKHRoaXMpOwogIH0KfQpmdW5jdGlvbiBnZXRUcmFja1R5cGVGb3JWYWx1ZVR5cGVOYW1lKHR5cGVOYW1lKSB7CiAgc3dpdGNoICh0eXBlTmFtZS50b0xvd2VyQ2FzZSgpKSB7CiAgICBjYXNlICJzY2FsYXIiOgogICAgY2FzZSAiZG91YmxlIjoKICAgIGNhc2UgImZsb2F0IjoKICAgIGNhc2UgIm51bWJlciI6CiAgICBjYXNlICJpbnRlZ2VyIjoKICAgICAgcmV0dXJuIE51bWJlcktleWZyYW1lVHJhY2s7CiAgICBjYXNlICJ2ZWN0b3IiOgogICAgY2FzZSAidmVjdG9yMiI6CiAgICBjYXNlICJ2ZWN0b3IzIjoKICAgIGNhc2UgInZlY3RvcjQiOgogICAgICByZXR1cm4gVmVjdG9yS2V5ZnJhbWVUcmFjazsKICAgIGNhc2UgImNvbG9yIjoKICAgICAgcmV0dXJuIENvbG9yS2V5ZnJhbWVUcmFjazsKICAgIGNhc2UgInF1YXRlcm5pb24iOgogICAgICByZXR1cm4gUXVhdGVybmlvbktleWZyYW1lVHJhY2s7CiAgICBjYXNlICJib29sIjoKICAgIGNhc2UgImJvb2xlYW4iOgogICAgICByZXR1cm4gQm9vbGVhbktleWZyYW1lVHJhY2s7CiAgICBjYXNlICJzdHJpbmciOgogICAgICByZXR1cm4gU3RyaW5nS2V5ZnJhbWVUcmFjazsKICB9CiAgdGhyb3cgbmV3IEVycm9yKCJUSFJFRS5LZXlmcmFtZVRyYWNrOiBVbnN1cHBvcnRlZCB0eXBlTmFtZTogIiArIHR5cGVOYW1lKTsKfQpmdW5jdGlvbiBwYXJzZUtleWZyYW1lVHJhY2soanNvbikgewogIGlmIChqc29uLnR5cGUgPT09IHZvaWQgMCkgewogICAgdGhyb3cgbmV3IEVycm9yKCJUSFJFRS5LZXlmcmFtZVRyYWNrOiB0cmFjayB0eXBlIHVuZGVmaW5lZCwgY2FuIG5vdCBwYXJzZSIpOwogIH0KICBjb25zdCB0cmFja1R5cGUgPSBnZXRUcmFja1R5cGVGb3JWYWx1ZVR5cGVOYW1lKGpzb24udHlwZSk7CiAgaWYgKGpzb24udGltZXMgPT09IHZvaWQgMCkgewogICAgY29uc3QgdGltZXMgPSBbXSwgdmFsdWVzID0gW107CiAgICBBbmltYXRpb25VdGlscy5mbGF0dGVuSlNPTihqc29uLmtleXMsIHRpbWVzLCB2YWx1ZXMsICJ2YWx1ZSIpOwogICAganNvbi50aW1lcyA9IHRpbWVzOwogICAganNvbi52YWx1ZXMgPSB2YWx1ZXM7CiAgfQogIGlmICh0cmFja1R5cGUucGFyc2UgIT09IHZvaWQgMCkgewogICAgcmV0dXJuIHRyYWNrVHlwZS5wYXJzZShqc29uKTsKICB9IGVsc2UgewogICAgcmV0dXJuIG5ldyB0cmFja1R5cGUoanNvbi5uYW1lLCBqc29uLnRpbWVzLCBqc29uLnZhbHVlcywganNvbi5pbnRlcnBvbGF0aW9uKTsKICB9Cn0KY29uc3QgQ2FjaGUgPSB7CiAgZW5hYmxlZDogZmFsc2UsCiAgZmlsZXM6IHt9LAogIGFkZDogZnVuY3Rpb24oa2V5LCBmaWxlKSB7CiAgICBpZiAodGhpcy5lbmFibGVkID09PSBmYWxzZSkKICAgICAgcmV0dXJuOwogICAgdGhpcy5maWxlc1trZXldID0gZmlsZTsKICB9LAogIGdldDogZnVuY3Rpb24oa2V5KSB7CiAgICBpZiAodGhpcy5lbmFibGVkID09PSBmYWxzZSkKICAgICAgcmV0dXJuOwogICAgcmV0dXJuIHRoaXMuZmlsZXNba2V5XTsKICB9LAogIHJlbW92ZTogZnVuY3Rpb24oa2V5KSB7CiAgICBkZWxldGUgdGhpcy5maWxlc1trZXldOwogIH0sCiAgY2xlYXI6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5maWxlcyA9IHt9OwogIH0KfTsKY2xhc3MgTG9hZGluZ01hbmFnZXIgewogIGNvbnN0cnVjdG9yKG9uTG9hZCwgb25Qcm9ncmVzcywgb25FcnJvcikgewogICAgY29uc3Qgc2NvcGUgPSB0aGlzOwogICAgbGV0IGlzTG9hZGluZyA9IGZhbHNlOwogICAgbGV0IGl0ZW1zTG9hZGVkID0gMDsKICAgIGxldCBpdGVtc1RvdGFsID0gMDsKICAgIGxldCB1cmxNb2RpZmllciA9IHZvaWQgMDsKICAgIGNvbnN0IGhhbmRsZXJzID0gW107CiAgICB0aGlzLm9uU3RhcnQgPSB2b2lkIDA7CiAgICB0aGlzLm9uTG9hZCA9IG9uTG9hZDsKICAgIHRoaXMub25Qcm9ncmVzcyA9IG9uUHJvZ3Jlc3M7CiAgICB0aGlzLm9uRXJyb3IgPSBvbkVycm9yOwogICAgdGhpcy5pdGVtU3RhcnQgPSBmdW5jdGlvbih1cmwpIHsKICAgICAgaXRlbXNUb3RhbCsrOwogICAgICBpZiAoaXNMb2FkaW5nID09PSBmYWxzZSkgewogICAgICAgIGlmIChzY29wZS5vblN0YXJ0ICE9PSB2b2lkIDApIHsKICAgICAgICAgIHNjb3BlLm9uU3RhcnQodXJsLCBpdGVtc0xvYWRlZCwgaXRlbXNUb3RhbCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlzTG9hZGluZyA9IHRydWU7CiAgICB9OwogICAgdGhpcy5pdGVtRW5kID0gZnVuY3Rpb24odXJsKSB7CiAgICAgIGl0ZW1zTG9hZGVkKys7CiAgICAgIGlmIChzY29wZS5vblByb2dyZXNzICE9PSB2b2lkIDApIHsKICAgICAgICBzY29wZS5vblByb2dyZXNzKHVybCwgaXRlbXNMb2FkZWQsIGl0ZW1zVG90YWwpOwogICAgICB9CiAgICAgIGlmIChpdGVtc0xvYWRlZCA9PT0gaXRlbXNUb3RhbCkgewogICAgICAgIGlzTG9hZGluZyA9IGZhbHNlOwogICAgICAgIGlmIChzY29wZS5vbkxvYWQgIT09IHZvaWQgMCkgewogICAgICAgICAgc2NvcGUub25Mb2FkKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogICAgdGhpcy5pdGVtRXJyb3IgPSBmdW5jdGlvbih1cmwpIHsKICAgICAgaWYgKHNjb3BlLm9uRXJyb3IgIT09IHZvaWQgMCkgewogICAgICAgIHNjb3BlLm9uRXJyb3IodXJsKTsKICAgICAgfQogICAgfTsKICAgIHRoaXMucmVzb2x2ZVVSTCA9IGZ1bmN0aW9uKHVybCkgewogICAgICBpZiAodXJsTW9kaWZpZXIpIHsKICAgICAgICByZXR1cm4gdXJsTW9kaWZpZXIodXJsKTsKICAgICAgfQogICAgICByZXR1cm4gdXJsOwogICAgfTsKICAgIHRoaXMuc2V0VVJMTW9kaWZpZXIgPSBmdW5jdGlvbih0cmFuc2Zvcm0pIHsKICAgICAgdXJsTW9kaWZpZXIgPSB0cmFuc2Zvcm07CiAgICAgIHJldHVybiB0aGlzOwogICAgfTsKICAgIHRoaXMuYWRkSGFuZGxlciA9IGZ1bmN0aW9uKHJlZ2V4LCBsb2FkZXIpIHsKICAgICAgaGFuZGxlcnMucHVzaChyZWdleCwgbG9hZGVyKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9OwogICAgdGhpcy5yZW1vdmVIYW5kbGVyID0gZnVuY3Rpb24ocmVnZXgpIHsKICAgICAgY29uc3QgaW5kZXggPSBoYW5kbGVycy5pbmRleE9mKHJlZ2V4KTsKICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgIGhhbmRsZXJzLnNwbGljZShpbmRleCwgMik7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXM7CiAgICB9OwogICAgdGhpcy5nZXRIYW5kbGVyID0gZnVuY3Rpb24oZmlsZSkgewogICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGhhbmRsZXJzLmxlbmd0aDsgaSA8IGw7IGkgKz0gMikgewogICAgICAgIGNvbnN0IHJlZ2V4ID0gaGFuZGxlcnNbaV07CiAgICAgICAgY29uc3QgbG9hZGVyID0gaGFuZGxlcnNbaSArIDFdOwogICAgICAgIGlmIChyZWdleC5nbG9iYWwpCiAgICAgICAgICByZWdleC5sYXN0SW5kZXggPSAwOwogICAgICAgIGlmIChyZWdleC50ZXN0KGZpbGUpKSB7CiAgICAgICAgICByZXR1cm4gbG9hZGVyOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH07CiAgfQp9CmNvbnN0IERlZmF1bHRMb2FkaW5nTWFuYWdlciA9IG5ldyBMb2FkaW5nTWFuYWdlcigpOwpjbGFzcyBMb2FkZXIgewogIGNvbnN0cnVjdG9yKG1hbmFnZXIpIHsKICAgIHRoaXMubWFuYWdlciA9IG1hbmFnZXIgIT09IHZvaWQgMCA/IG1hbmFnZXIgOiBEZWZhdWx0TG9hZGluZ01hbmFnZXI7CiAgICB0aGlzLmNyb3NzT3JpZ2luID0gImFub255bW91cyI7CiAgICB0aGlzLndpdGhDcmVkZW50aWFscyA9IGZhbHNlOwogICAgdGhpcy5wYXRoID0gIiI7CiAgICB0aGlzLnJlc291cmNlUGF0aCA9ICIiOwogICAgdGhpcy5yZXF1ZXN0SGVhZGVyID0ge307CiAgfQogIGxvYWQoKSB7CiAgfQogIGxvYWRBc3luYyh1cmwsIG9uUHJvZ3Jlc3MpIHsKICAgIGNvbnN0IHNjb3BlID0gdGhpczsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHsKICAgICAgc2NvcGUubG9hZCh1cmwsIHJlc29sdmUsIG9uUHJvZ3Jlc3MsIHJlamVjdCk7CiAgICB9KTsKICB9CiAgcGFyc2UoKSB7CiAgfQogIHNldENyb3NzT3JpZ2luKGNyb3NzT3JpZ2luKSB7CiAgICB0aGlzLmNyb3NzT3JpZ2luID0gY3Jvc3NPcmlnaW47CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0V2l0aENyZWRlbnRpYWxzKHZhbHVlKSB7CiAgICB0aGlzLndpdGhDcmVkZW50aWFscyA9IHZhbHVlOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldFBhdGgocGF0aCkgewogICAgdGhpcy5wYXRoID0gcGF0aDsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRSZXNvdXJjZVBhdGgocmVzb3VyY2VQYXRoKSB7CiAgICB0aGlzLnJlc291cmNlUGF0aCA9IHJlc291cmNlUGF0aDsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRSZXF1ZXN0SGVhZGVyKHJlcXVlc3RIZWFkZXIpIHsKICAgIHRoaXMucmVxdWVzdEhlYWRlciA9IHJlcXVlc3RIZWFkZXI7CiAgICByZXR1cm4gdGhpczsKICB9Cn0KY29uc3QgbG9hZGluZyA9IHt9OwpjbGFzcyBGaWxlTG9hZGVyIGV4dGVuZHMgTG9hZGVyIHsKICBjb25zdHJ1Y3RvcihtYW5hZ2VyKSB7CiAgICBzdXBlcihtYW5hZ2VyKTsKICB9CiAgbG9hZCh1cmwsIG9uTG9hZCwgb25Qcm9ncmVzcywgb25FcnJvcikgewogICAgaWYgKHVybCA9PT0gdm9pZCAwKQogICAgICB1cmwgPSAiIjsKICAgIGlmICh0aGlzLnBhdGggIT09IHZvaWQgMCkKICAgICAgdXJsID0gdGhpcy5wYXRoICsgdXJsOwogICAgdXJsID0gdGhpcy5tYW5hZ2VyLnJlc29sdmVVUkwodXJsKTsKICAgIGNvbnN0IGNhY2hlZCA9IENhY2hlLmdldCh1cmwpOwogICAgaWYgKGNhY2hlZCAhPT0gdm9pZCAwKSB7CiAgICAgIHRoaXMubWFuYWdlci5pdGVtU3RhcnQodXJsKTsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgaWYgKG9uTG9hZCkKICAgICAgICAgIG9uTG9hZChjYWNoZWQpOwogICAgICAgIHRoaXMubWFuYWdlci5pdGVtRW5kKHVybCk7CiAgICAgIH0sIDApOwogICAgICByZXR1cm4gY2FjaGVkOwogICAgfQogICAgaWYgKGxvYWRpbmdbdXJsXSAhPT0gdm9pZCAwKSB7CiAgICAgIGxvYWRpbmdbdXJsXS5wdXNoKHsKICAgICAgICBvbkxvYWQsCiAgICAgICAgb25Qcm9ncmVzcywKICAgICAgICBvbkVycm9yCiAgICAgIH0pOwogICAgICByZXR1cm47CiAgICB9CiAgICBsb2FkaW5nW3VybF0gPSBbXTsKICAgIGxvYWRpbmdbdXJsXS5wdXNoKHsKICAgICAgb25Mb2FkLAogICAgICBvblByb2dyZXNzLAogICAgICBvbkVycm9yCiAgICB9KTsKICAgIGNvbnN0IHJlcSA9IG5ldyBSZXF1ZXN0KHVybCwgewogICAgICBoZWFkZXJzOiBuZXcgSGVhZGVycyh0aGlzLnJlcXVlc3RIZWFkZXIpLAogICAgICBjcmVkZW50aWFsczogdGhpcy53aXRoQ3JlZGVudGlhbHMgPyAiaW5jbHVkZSIgOiAic2FtZS1vcmlnaW4iCiAgICB9KTsKICAgIGNvbnN0IG1pbWVUeXBlID0gdGhpcy5taW1lVHlwZTsKICAgIGNvbnN0IHJlc3BvbnNlVHlwZSA9IHRoaXMucmVzcG9uc2VUeXBlOwogICAgZmV0Y2gocmVxKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDAgfHwgcmVzcG9uc2Uuc3RhdHVzID09PSAwKSB7CiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMCkgewogICAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5GaWxlTG9hZGVyOiBIVFRQIFN0YXR1cyAwIHJlY2VpdmVkLiIpOwogICAgICAgIH0KICAgICAgICBpZiAodHlwZW9mIFJlYWRhYmxlU3RyZWFtID09PSAidW5kZWZpbmVkIiB8fCByZXNwb25zZS5ib2R5LmdldFJlYWRlciA9PT0gdm9pZCAwKSB7CiAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9IGxvYWRpbmdbdXJsXTsKICAgICAgICBjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5LmdldFJlYWRlcigpOwogICAgICAgIGNvbnN0IGNvbnRlbnRMZW5ndGggPSByZXNwb25zZS5oZWFkZXJzLmdldCgiQ29udGVudC1MZW5ndGgiKTsKICAgICAgICBjb25zdCB0b3RhbCA9IGNvbnRlbnRMZW5ndGggPyBwYXJzZUludChjb250ZW50TGVuZ3RoKSA6IDA7CiAgICAgICAgY29uc3QgbGVuZ3RoQ29tcHV0YWJsZSA9IHRvdGFsICE9PSAwOwogICAgICAgIGxldCBsb2FkZWQgPSAwOwogICAgICAgIGNvbnN0IHN0cmVhbSA9IG5ldyBSZWFkYWJsZVN0cmVhbSh7CiAgICAgICAgICBzdGFydChjb250cm9sbGVyKSB7CiAgICAgICAgICAgIHJlYWREYXRhKCk7CiAgICAgICAgICAgIGZ1bmN0aW9uIHJlYWREYXRhKCkgewogICAgICAgICAgICAgIHJlYWRlci5yZWFkKCkudGhlbigoeyBkb25lLCB2YWx1ZSB9KSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoZG9uZSkgewogICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBsb2FkZWQgKz0gdmFsdWUuYnl0ZUxlbmd0aDsKICAgICAgICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgUHJvZ3Jlc3NFdmVudCgicHJvZ3Jlc3MiLCB7IGxlbmd0aENvbXB1dGFibGUsIGxvYWRlZCwgdG90YWwgfSk7CiAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBpbCA9IGNhbGxiYWNrcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FsbGJhY2sgPSBjYWxsYmFja3NbaV07CiAgICAgICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrLm9uUHJvZ3Jlc3MpCiAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vblByb2dyZXNzKGV2ZW50KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUodmFsdWUpOwogICAgICAgICAgICAgICAgICByZWFkRGF0YSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShzdHJlYW0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IEVycm9yKGBmZXRjaCBmb3IgIiR7cmVzcG9uc2UudXJsfSIgcmVzcG9uZGVkIHdpdGggJHtyZXNwb25zZS5zdGF0dXN9OiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7CiAgICAgIH0KICAgIH0pLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgIHN3aXRjaCAocmVzcG9uc2VUeXBlKSB7CiAgICAgICAgY2FzZSAiYXJyYXlidWZmZXIiOgogICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmFycmF5QnVmZmVyKCk7CiAgICAgICAgY2FzZSAiYmxvYiI6CiAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuYmxvYigpOwogICAgICAgIGNhc2UgImRvY3VtZW50IjoKICAgICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0KCkudGhlbigodGV4dCkgPT4gewogICAgICAgICAgICBjb25zdCBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7CiAgICAgICAgICAgIHJldHVybiBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKHRleHQsIG1pbWVUeXBlKTsKICAgICAgICAgIH0pOwogICAgICAgIGNhc2UgImpzb24iOgogICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgaWYgKG1pbWVUeXBlID09PSB2b2lkIDApIHsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnRleHQoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IHJlID0gL2NoYXJzZXQ9Ij8oW147IlxzXSopIj8vaTsKICAgICAgICAgICAgY29uc3QgZXhlYyA9IHJlLmV4ZWMobWltZVR5cGUpOwogICAgICAgICAgICBjb25zdCBsYWJlbCA9IGV4ZWMgJiYgZXhlY1sxXSA/IGV4ZWNbMV0udG9Mb3dlckNhc2UoKSA6IHZvaWQgMDsKICAgICAgICAgICAgY29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcihsYWJlbCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5hcnJheUJ1ZmZlcigpLnRoZW4oKGFiKSA9PiBkZWNvZGVyLmRlY29kZShhYikpOwogICAgICAgICAgfQogICAgICB9CiAgICB9KS50aGVuKChkYXRhKSA9PiB7CiAgICAgIENhY2hlLmFkZCh1cmwsIGRhdGEpOwogICAgICBjb25zdCBjYWxsYmFja3MgPSBsb2FkaW5nW3VybF07CiAgICAgIGRlbGV0ZSBsb2FkaW5nW3VybF07CiAgICAgIGZvciAobGV0IGkgPSAwLCBpbCA9IGNhbGxiYWNrcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgICAgY29uc3QgY2FsbGJhY2sgPSBjYWxsYmFja3NbaV07CiAgICAgICAgaWYgKGNhbGxiYWNrLm9uTG9hZCkKICAgICAgICAgIGNhbGxiYWNrLm9uTG9hZChkYXRhKTsKICAgICAgfQogICAgfSkuY2F0Y2goKGVycikgPT4gewogICAgICBjb25zdCBjYWxsYmFja3MgPSBsb2FkaW5nW3VybF07CiAgICAgIGlmIChjYWxsYmFja3MgPT09IHZvaWQgMCkgewogICAgICAgIHRoaXMubWFuYWdlci5pdGVtRXJyb3IodXJsKTsKICAgICAgICB0aHJvdyBlcnI7CiAgICAgIH0KICAgICAgZGVsZXRlIGxvYWRpbmdbdXJsXTsKICAgICAgZm9yIChsZXQgaSA9IDAsIGlsID0gY2FsbGJhY2tzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHsKICAgICAgICBjb25zdCBjYWxsYmFjayA9IGNhbGxiYWNrc1tpXTsKICAgICAgICBpZiAoY2FsbGJhY2sub25FcnJvcikKICAgICAgICAgIGNhbGxiYWNrLm9uRXJyb3IoZXJyKTsKICAgICAgfQogICAgICB0aGlzLm1hbmFnZXIuaXRlbUVycm9yKHVybCk7CiAgICB9KS5maW5hbGx5KCgpID0+IHsKICAgICAgdGhpcy5tYW5hZ2VyLml0ZW1FbmQodXJsKTsKICAgIH0pOwogICAgdGhpcy5tYW5hZ2VyLml0ZW1TdGFydCh1cmwpOwogIH0KICBzZXRSZXNwb25zZVR5cGUodmFsdWUpIHsKICAgIHRoaXMucmVzcG9uc2VUeXBlID0gdmFsdWU7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0TWltZVR5cGUodmFsdWUpIHsKICAgIHRoaXMubWltZVR5cGUgPSB2YWx1ZTsKICAgIHJldHVybiB0aGlzOwogIH0KfQpjbGFzcyBBbmltYXRpb25Mb2FkZXIgZXh0ZW5kcyBMb2FkZXIgewogIGNvbnN0cnVjdG9yKG1hbmFnZXIpIHsKICAgIHN1cGVyKG1hbmFnZXIpOwogIH0KICBsb2FkKHVybCwgb25Mb2FkLCBvblByb2dyZXNzLCBvbkVycm9yKSB7CiAgICBjb25zdCBzY29wZSA9IHRoaXM7CiAgICBjb25zdCBsb2FkZXIgPSBuZXcgRmlsZUxvYWRlcih0aGlzLm1hbmFnZXIpOwogICAgbG9hZGVyLnNldFBhdGgodGhpcy5wYXRoKTsKICAgIGxvYWRlci5zZXRSZXF1ZXN0SGVhZGVyKHRoaXMucmVxdWVzdEhlYWRlcik7CiAgICBsb2FkZXIuc2V0V2l0aENyZWRlbnRpYWxzKHRoaXMud2l0aENyZWRlbnRpYWxzKTsKICAgIGxvYWRlci5sb2FkKHVybCwgZnVuY3Rpb24odGV4dCkgewogICAgICB0cnkgewogICAgICAgIG9uTG9hZChzY29wZS5wYXJzZShKU09OLnBhcnNlKHRleHQpKSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBpZiAob25FcnJvcikgewogICAgICAgICAgb25FcnJvcihlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgICB9CiAgICAgICAgc2NvcGUubWFuYWdlci5pdGVtRXJyb3IodXJsKTsKICAgICAgfQogICAgfSwgb25Qcm9ncmVzcywgb25FcnJvcik7CiAgfQogIHBhcnNlKGpzb24pIHsKICAgIGNvbnN0IGFuaW1hdGlvbnMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwganNvbi5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBjbGlwID0gQW5pbWF0aW9uQ2xpcC5wYXJzZShqc29uW2ldKTsKICAgICAgYW5pbWF0aW9ucy5wdXNoKGNsaXApOwogICAgfQogICAgcmV0dXJuIGFuaW1hdGlvbnM7CiAgfQp9CmNsYXNzIENvbXByZXNzZWRUZXh0dXJlTG9hZGVyIGV4dGVuZHMgTG9hZGVyIHsKICBjb25zdHJ1Y3RvcihtYW5hZ2VyKSB7CiAgICBzdXBlcihtYW5hZ2VyKTsKICB9CiAgbG9hZCh1cmwsIG9uTG9hZCwgb25Qcm9ncmVzcywgb25FcnJvcikgewogICAgY29uc3Qgc2NvcGUgPSB0aGlzOwogICAgY29uc3QgaW1hZ2VzID0gW107CiAgICBjb25zdCB0ZXh0dXJlID0gbmV3IENvbXByZXNzZWRUZXh0dXJlKCk7CiAgICBjb25zdCBsb2FkZXIgPSBuZXcgRmlsZUxvYWRlcih0aGlzLm1hbmFnZXIpOwogICAgbG9hZGVyLnNldFBhdGgodGhpcy5wYXRoKTsKICAgIGxvYWRlci5zZXRSZXNwb25zZVR5cGUoImFycmF5YnVmZmVyIik7CiAgICBsb2FkZXIuc2V0UmVxdWVzdEhlYWRlcih0aGlzLnJlcXVlc3RIZWFkZXIpOwogICAgbG9hZGVyLnNldFdpdGhDcmVkZW50aWFscyhzY29wZS53aXRoQ3JlZGVudGlhbHMpOwogICAgbGV0IGxvYWRlZCA9IDA7CiAgICBmdW5jdGlvbiBsb2FkVGV4dHVyZShpKSB7CiAgICAgIGxvYWRlci5sb2FkKHVybFtpXSwgZnVuY3Rpb24oYnVmZmVyKSB7CiAgICAgICAgY29uc3QgdGV4RGF0YXMgPSBzY29wZS5wYXJzZShidWZmZXIsIHRydWUpOwogICAgICAgIGltYWdlc1tpXSA9IHsKICAgICAgICAgIHdpZHRoOiB0ZXhEYXRhcy53aWR0aCwKICAgICAgICAgIGhlaWdodDogdGV4RGF0YXMuaGVpZ2h0LAogICAgICAgICAgZm9ybWF0OiB0ZXhEYXRhcy5mb3JtYXQsCiAgICAgICAgICBtaXBtYXBzOiB0ZXhEYXRhcy5taXBtYXBzCiAgICAgICAgfTsKICAgICAgICBsb2FkZWQgKz0gMTsKICAgICAgICBpZiAobG9hZGVkID09PSA2KSB7CiAgICAgICAgICBpZiAodGV4RGF0YXMubWlwbWFwQ291bnQgPT09IDEpCiAgICAgICAgICAgIHRleHR1cmUubWluRmlsdGVyID0gTGluZWFyRmlsdGVyOwogICAgICAgICAgdGV4dHVyZS5pbWFnZSA9IGltYWdlczsKICAgICAgICAgIHRleHR1cmUuZm9ybWF0ID0gdGV4RGF0YXMuZm9ybWF0OwogICAgICAgICAgdGV4dHVyZS5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgICAgICBpZiAob25Mb2FkKQogICAgICAgICAgICBvbkxvYWQodGV4dHVyZSk7CiAgICAgICAgfQogICAgICB9LCBvblByb2dyZXNzLCBvbkVycm9yKTsKICAgIH0KICAgIGlmIChBcnJheS5pc0FycmF5KHVybCkpIHsKICAgICAgZm9yIChsZXQgaSA9IDAsIGlsID0gdXJsLmxlbmd0aDsgaSA8IGlsOyArK2kpIHsKICAgICAgICBsb2FkVGV4dHVyZShpKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgbG9hZGVyLmxvYWQodXJsLCBmdW5jdGlvbihidWZmZXIpIHsKICAgICAgICBjb25zdCB0ZXhEYXRhcyA9IHNjb3BlLnBhcnNlKGJ1ZmZlciwgdHJ1ZSk7CiAgICAgICAgaWYgKHRleERhdGFzLmlzQ3ViZW1hcCkgewogICAgICAgICAgY29uc3QgZmFjZXMgPSB0ZXhEYXRhcy5taXBtYXBzLmxlbmd0aCAvIHRleERhdGFzLm1pcG1hcENvdW50OwogICAgICAgICAgZm9yIChsZXQgZiA9IDA7IGYgPCBmYWNlczsgZisrKSB7CiAgICAgICAgICAgIGltYWdlc1tmXSA9IHsgbWlwbWFwczogW10gfTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0ZXhEYXRhcy5taXBtYXBDb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgaW1hZ2VzW2ZdLm1pcG1hcHMucHVzaCh0ZXhEYXRhcy5taXBtYXBzW2YgKiB0ZXhEYXRhcy5taXBtYXBDb3VudCArIGldKTsKICAgICAgICAgICAgICBpbWFnZXNbZl0uZm9ybWF0ID0gdGV4RGF0YXMuZm9ybWF0OwogICAgICAgICAgICAgIGltYWdlc1tmXS53aWR0aCA9IHRleERhdGFzLndpZHRoOwogICAgICAgICAgICAgIGltYWdlc1tmXS5oZWlnaHQgPSB0ZXhEYXRhcy5oZWlnaHQ7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHRleHR1cmUuaW1hZ2UgPSBpbWFnZXM7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRleHR1cmUuaW1hZ2Uud2lkdGggPSB0ZXhEYXRhcy53aWR0aDsKICAgICAgICAgIHRleHR1cmUuaW1hZ2UuaGVpZ2h0ID0gdGV4RGF0YXMuaGVpZ2h0OwogICAgICAgICAgdGV4dHVyZS5taXBtYXBzID0gdGV4RGF0YXMubWlwbWFwczsKICAgICAgICB9CiAgICAgICAgaWYgKHRleERhdGFzLm1pcG1hcENvdW50ID09PSAxKSB7CiAgICAgICAgICB0ZXh0dXJlLm1pbkZpbHRlciA9IExpbmVhckZpbHRlcjsKICAgICAgICB9CiAgICAgICAgdGV4dHVyZS5mb3JtYXQgPSB0ZXhEYXRhcy5mb3JtYXQ7CiAgICAgICAgdGV4dHVyZS5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgICAgaWYgKG9uTG9hZCkKICAgICAgICAgIG9uTG9hZCh0ZXh0dXJlKTsKICAgICAgfSwgb25Qcm9ncmVzcywgb25FcnJvcik7CiAgICB9CiAgICByZXR1cm4gdGV4dHVyZTsKICB9Cn0KY2xhc3MgSW1hZ2VMb2FkZXIgZXh0ZW5kcyBMb2FkZXIgewogIGNvbnN0cnVjdG9yKG1hbmFnZXIpIHsKICAgIHN1cGVyKG1hbmFnZXIpOwogIH0KICBsb2FkKHVybCwgb25Mb2FkLCBvblByb2dyZXNzLCBvbkVycm9yKSB7CiAgICBpZiAodGhpcy5wYXRoICE9PSB2b2lkIDApCiAgICAgIHVybCA9IHRoaXMucGF0aCArIHVybDsKICAgIHVybCA9IHRoaXMubWFuYWdlci5yZXNvbHZlVVJMKHVybCk7CiAgICBjb25zdCBzY29wZSA9IHRoaXM7CiAgICBjb25zdCBjYWNoZWQgPSBDYWNoZS5nZXQodXJsKTsKICAgIGlmIChjYWNoZWQgIT09IHZvaWQgMCkgewogICAgICBzY29wZS5tYW5hZ2VyLml0ZW1TdGFydCh1cmwpOwogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgIGlmIChvbkxvYWQpCiAgICAgICAgICBvbkxvYWQoY2FjaGVkKTsKICAgICAgICBzY29wZS5tYW5hZ2VyLml0ZW1FbmQodXJsKTsKICAgICAgfSwgMCk7CiAgICAgIHJldHVybiBjYWNoZWQ7CiAgICB9CiAgICBjb25zdCBpbWFnZSA9IGNyZWF0ZUVsZW1lbnROUygiaW1nIik7CiAgICBmdW5jdGlvbiBvbkltYWdlTG9hZCgpIHsKICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTsKICAgICAgQ2FjaGUuYWRkKHVybCwgdGhpcyk7CiAgICAgIGlmIChvbkxvYWQpCiAgICAgICAgb25Mb2FkKHRoaXMpOwogICAgICBzY29wZS5tYW5hZ2VyLml0ZW1FbmQodXJsKTsKICAgIH0KICAgIGZ1bmN0aW9uIG9uSW1hZ2VFcnJvcihldmVudCkgewogICAgICByZW1vdmVFdmVudExpc3RlbmVycygpOwogICAgICBpZiAob25FcnJvcikKICAgICAgICBvbkVycm9yKGV2ZW50KTsKICAgICAgc2NvcGUubWFuYWdlci5pdGVtRXJyb3IodXJsKTsKICAgICAgc2NvcGUubWFuYWdlci5pdGVtRW5kKHVybCk7CiAgICB9CiAgICBmdW5jdGlvbiByZW1vdmVFdmVudExpc3RlbmVycygpIHsKICAgICAgaW1hZ2UucmVtb3ZlRXZlbnRMaXN0ZW5lcigibG9hZCIsIG9uSW1hZ2VMb2FkLCBmYWxzZSk7CiAgICAgIGltYWdlLnJlbW92ZUV2ZW50TGlzdGVuZXIoImVycm9yIiwgb25JbWFnZUVycm9yLCBmYWxzZSk7CiAgICB9CiAgICBpbWFnZS5hZGRFdmVudExpc3RlbmVyKCJsb2FkIiwgb25JbWFnZUxvYWQsIGZhbHNlKTsKICAgIGltYWdlLmFkZEV2ZW50TGlzdGVuZXIoImVycm9yIiwgb25JbWFnZUVycm9yLCBmYWxzZSk7CiAgICBpZiAodXJsLnN1YnN0cigwLCA1KSAhPT0gImRhdGE6IikgewogICAgICBpZiAodGhpcy5jcm9zc09yaWdpbiAhPT0gdm9pZCAwKQogICAgICAgIGltYWdlLmNyb3NzT3JpZ2luID0gdGhpcy5jcm9zc09yaWdpbjsKICAgIH0KICAgIHNjb3BlLm1hbmFnZXIuaXRlbVN0YXJ0KHVybCk7CiAgICBpbWFnZS5zcmMgPSB1cmw7CiAgICByZXR1cm4gaW1hZ2U7CiAgfQp9CmNsYXNzIEN1YmVUZXh0dXJlTG9hZGVyIGV4dGVuZHMgTG9hZGVyIHsKICBjb25zdHJ1Y3RvcihtYW5hZ2VyKSB7CiAgICBzdXBlcihtYW5hZ2VyKTsKICB9CiAgbG9hZCh1cmxzLCBvbkxvYWQsIG9uUHJvZ3Jlc3MsIG9uRXJyb3IpIHsKICAgIGNvbnN0IHRleHR1cmUgPSBuZXcgQ3ViZVRleHR1cmUoKTsKICAgIGNvbnN0IGxvYWRlciA9IG5ldyBJbWFnZUxvYWRlcih0aGlzLm1hbmFnZXIpOwogICAgbG9hZGVyLnNldENyb3NzT3JpZ2luKHRoaXMuY3Jvc3NPcmlnaW4pOwogICAgbG9hZGVyLnNldFBhdGgodGhpcy5wYXRoKTsKICAgIGxldCBsb2FkZWQgPSAwOwogICAgZnVuY3Rpb24gbG9hZFRleHR1cmUoaSkgewogICAgICBsb2FkZXIubG9hZCh1cmxzW2ldLCBmdW5jdGlvbihpbWFnZSkgewogICAgICAgIHRleHR1cmUuaW1hZ2VzW2ldID0gaW1hZ2U7CiAgICAgICAgbG9hZGVkKys7CiAgICAgICAgaWYgKGxvYWRlZCA9PT0gNikgewogICAgICAgICAgdGV4dHVyZS5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgICAgICBpZiAob25Mb2FkKQogICAgICAgICAgICBvbkxvYWQodGV4dHVyZSk7CiAgICAgICAgfQogICAgICB9LCB2b2lkIDAsIG9uRXJyb3IpOwogICAgfQogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB1cmxzLmxlbmd0aDsgKytpKSB7CiAgICAgIGxvYWRUZXh0dXJlKGkpOwogICAgfQogICAgcmV0dXJuIHRleHR1cmU7CiAgfQp9CmNsYXNzIERhdGFUZXh0dXJlTG9hZGVyIGV4dGVuZHMgTG9hZGVyIHsKICBjb25zdHJ1Y3RvcihtYW5hZ2VyKSB7CiAgICBzdXBlcihtYW5hZ2VyKTsKICB9CiAgbG9hZCh1cmwsIG9uTG9hZCwgb25Qcm9ncmVzcywgb25FcnJvcikgewogICAgY29uc3Qgc2NvcGUgPSB0aGlzOwogICAgY29uc3QgdGV4dHVyZSA9IG5ldyBEYXRhVGV4dHVyZSgpOwogICAgY29uc3QgbG9hZGVyID0gbmV3IEZpbGVMb2FkZXIodGhpcy5tYW5hZ2VyKTsKICAgIGxvYWRlci5zZXRSZXNwb25zZVR5cGUoImFycmF5YnVmZmVyIik7CiAgICBsb2FkZXIuc2V0UmVxdWVzdEhlYWRlcih0aGlzLnJlcXVlc3RIZWFkZXIpOwogICAgbG9hZGVyLnNldFBhdGgodGhpcy5wYXRoKTsKICAgIGxvYWRlci5zZXRXaXRoQ3JlZGVudGlhbHMoc2NvcGUud2l0aENyZWRlbnRpYWxzKTsKICAgIGxvYWRlci5sb2FkKHVybCwgZnVuY3Rpb24oYnVmZmVyKSB7CiAgICAgIGNvbnN0IHRleERhdGEgPSBzY29wZS5wYXJzZShidWZmZXIpOwogICAgICBpZiAoIXRleERhdGEpCiAgICAgICAgcmV0dXJuOwogICAgICBpZiAodGV4RGF0YS5pbWFnZSAhPT0gdm9pZCAwKSB7CiAgICAgICAgdGV4dHVyZS5pbWFnZSA9IHRleERhdGEuaW1hZ2U7CiAgICAgIH0gZWxzZSBpZiAodGV4RGF0YS5kYXRhICE9PSB2b2lkIDApIHsKICAgICAgICB0ZXh0dXJlLmltYWdlLndpZHRoID0gdGV4RGF0YS53aWR0aDsKICAgICAgICB0ZXh0dXJlLmltYWdlLmhlaWdodCA9IHRleERhdGEuaGVpZ2h0OwogICAgICAgIHRleHR1cmUuaW1hZ2UuZGF0YSA9IHRleERhdGEuZGF0YTsKICAgICAgfQogICAgICB0ZXh0dXJlLndyYXBTID0gdGV4RGF0YS53cmFwUyAhPT0gdm9pZCAwID8gdGV4RGF0YS53cmFwUyA6IENsYW1wVG9FZGdlV3JhcHBpbmc7CiAgICAgIHRleHR1cmUud3JhcFQgPSB0ZXhEYXRhLndyYXBUICE9PSB2b2lkIDAgPyB0ZXhEYXRhLndyYXBUIDogQ2xhbXBUb0VkZ2VXcmFwcGluZzsKICAgICAgdGV4dHVyZS5tYWdGaWx0ZXIgPSB0ZXhEYXRhLm1hZ0ZpbHRlciAhPT0gdm9pZCAwID8gdGV4RGF0YS5tYWdGaWx0ZXIgOiBMaW5lYXJGaWx0ZXI7CiAgICAgIHRleHR1cmUubWluRmlsdGVyID0gdGV4RGF0YS5taW5GaWx0ZXIgIT09IHZvaWQgMCA/IHRleERhdGEubWluRmlsdGVyIDogTGluZWFyRmlsdGVyOwogICAgICB0ZXh0dXJlLmFuaXNvdHJvcHkgPSB0ZXhEYXRhLmFuaXNvdHJvcHkgIT09IHZvaWQgMCA/IHRleERhdGEuYW5pc290cm9weSA6IDE7CiAgICAgIGlmICh0ZXhEYXRhLmVuY29kaW5nICE9PSB2b2lkIDApIHsKICAgICAgICB0ZXh0dXJlLmVuY29kaW5nID0gdGV4RGF0YS5lbmNvZGluZzsKICAgICAgfQogICAgICBpZiAodGV4RGF0YS5mbGlwWSAhPT0gdm9pZCAwKSB7CiAgICAgICAgdGV4dHVyZS5mbGlwWSA9IHRleERhdGEuZmxpcFk7CiAgICAgIH0KICAgICAgaWYgKHRleERhdGEuZm9ybWF0ICE9PSB2b2lkIDApIHsKICAgICAgICB0ZXh0dXJlLmZvcm1hdCA9IHRleERhdGEuZm9ybWF0OwogICAgICB9CiAgICAgIGlmICh0ZXhEYXRhLnR5cGUgIT09IHZvaWQgMCkgewogICAgICAgIHRleHR1cmUudHlwZSA9IHRleERhdGEudHlwZTsKICAgICAgfQogICAgICBpZiAodGV4RGF0YS5taXBtYXBzICE9PSB2b2lkIDApIHsKICAgICAgICB0ZXh0dXJlLm1pcG1hcHMgPSB0ZXhEYXRhLm1pcG1hcHM7CiAgICAgICAgdGV4dHVyZS5taW5GaWx0ZXIgPSBMaW5lYXJNaXBtYXBMaW5lYXJGaWx0ZXI7CiAgICAgIH0KICAgICAgaWYgKHRleERhdGEubWlwbWFwQ291bnQgPT09IDEpIHsKICAgICAgICB0ZXh0dXJlLm1pbkZpbHRlciA9IExpbmVhckZpbHRlcjsKICAgICAgfQogICAgICBpZiAodGV4RGF0YS5nZW5lcmF0ZU1pcG1hcHMgIT09IHZvaWQgMCkgewogICAgICAgIHRleHR1cmUuZ2VuZXJhdGVNaXBtYXBzID0gdGV4RGF0YS5nZW5lcmF0ZU1pcG1hcHM7CiAgICAgIH0KICAgICAgdGV4dHVyZS5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIGlmIChvbkxvYWQpCiAgICAgICAgb25Mb2FkKHRleHR1cmUsIHRleERhdGEpOwogICAgfSwgb25Qcm9ncmVzcywgb25FcnJvcik7CiAgICByZXR1cm4gdGV4dHVyZTsKICB9Cn0KY2xhc3MgVGV4dHVyZUxvYWRlciBleHRlbmRzIExvYWRlciB7CiAgY29uc3RydWN0b3IobWFuYWdlcikgewogICAgc3VwZXIobWFuYWdlcik7CiAgfQogIGxvYWQodXJsLCBvbkxvYWQsIG9uUHJvZ3Jlc3MsIG9uRXJyb3IpIHsKICAgIGNvbnN0IHRleHR1cmUgPSBuZXcgVGV4dHVyZSgpOwogICAgY29uc3QgbG9hZGVyID0gbmV3IEltYWdlTG9hZGVyKHRoaXMubWFuYWdlcik7CiAgICBsb2FkZXIuc2V0Q3Jvc3NPcmlnaW4odGhpcy5jcm9zc09yaWdpbik7CiAgICBsb2FkZXIuc2V0UGF0aCh0aGlzLnBhdGgpOwogICAgbG9hZGVyLmxvYWQodXJsLCBmdW5jdGlvbihpbWFnZSkgewogICAgICB0ZXh0dXJlLmltYWdlID0gaW1hZ2U7CiAgICAgIHRleHR1cmUubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICBpZiAob25Mb2FkICE9PSB2b2lkIDApIHsKICAgICAgICBvbkxvYWQodGV4dHVyZSk7CiAgICAgIH0KICAgIH0sIG9uUHJvZ3Jlc3MsIG9uRXJyb3IpOwogICAgcmV0dXJuIHRleHR1cmU7CiAgfQp9CmNsYXNzIExpZ2h0IGV4dGVuZHMgT2JqZWN0M0QgewogIGNvbnN0cnVjdG9yKGNvbG9yLCBpbnRlbnNpdHkgPSAxKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkxpZ2h0IjsKICAgIHRoaXMuY29sb3IgPSBuZXcgQ29sb3IoY29sb3IpOwogICAgdGhpcy5pbnRlbnNpdHkgPSBpbnRlbnNpdHk7CiAgfQogIGRpc3Bvc2UoKSB7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLmNvbG9yLmNvcHkoc291cmNlLmNvbG9yKTsKICAgIHRoaXMuaW50ZW5zaXR5ID0gc291cmNlLmludGVuc2l0eTsKICAgIHJldHVybiB0aGlzOwogIH0KICB0b0pTT04obWV0YSkgewogICAgY29uc3QgZGF0YSA9IHN1cGVyLnRvSlNPTihtZXRhKTsKICAgIGRhdGEub2JqZWN0LmNvbG9yID0gdGhpcy5jb2xvci5nZXRIZXgoKTsKICAgIGRhdGEub2JqZWN0LmludGVuc2l0eSA9IHRoaXMuaW50ZW5zaXR5OwogICAgaWYgKHRoaXMuZ3JvdW5kQ29sb3IgIT09IHZvaWQgMCkKICAgICAgZGF0YS5vYmplY3QuZ3JvdW5kQ29sb3IgPSB0aGlzLmdyb3VuZENvbG9yLmdldEhleCgpOwogICAgaWYgKHRoaXMuZGlzdGFuY2UgIT09IHZvaWQgMCkKICAgICAgZGF0YS5vYmplY3QuZGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlOwogICAgaWYgKHRoaXMuYW5nbGUgIT09IHZvaWQgMCkKICAgICAgZGF0YS5vYmplY3QuYW5nbGUgPSB0aGlzLmFuZ2xlOwogICAgaWYgKHRoaXMuZGVjYXkgIT09IHZvaWQgMCkKICAgICAgZGF0YS5vYmplY3QuZGVjYXkgPSB0aGlzLmRlY2F5OwogICAgaWYgKHRoaXMucGVudW1icmEgIT09IHZvaWQgMCkKICAgICAgZGF0YS5vYmplY3QucGVudW1icmEgPSB0aGlzLnBlbnVtYnJhOwogICAgaWYgKHRoaXMuc2hhZG93ICE9PSB2b2lkIDApCiAgICAgIGRhdGEub2JqZWN0LnNoYWRvdyA9IHRoaXMuc2hhZG93LnRvSlNPTigpOwogICAgcmV0dXJuIGRhdGE7CiAgfQp9CkxpZ2h0LnByb3RvdHlwZS5pc0xpZ2h0ID0gdHJ1ZTsKY2xhc3MgSGVtaXNwaGVyZUxpZ2h0IGV4dGVuZHMgTGlnaHQgewogIGNvbnN0cnVjdG9yKHNreUNvbG9yLCBncm91bmRDb2xvciwgaW50ZW5zaXR5KSB7CiAgICBzdXBlcihza3lDb2xvciwgaW50ZW5zaXR5KTsKICAgIHRoaXMudHlwZSA9ICJIZW1pc3BoZXJlTGlnaHQiOwogICAgdGhpcy5wb3NpdGlvbi5jb3B5KE9iamVjdDNELkRlZmF1bHRVcCk7CiAgICB0aGlzLnVwZGF0ZU1hdHJpeCgpOwogICAgdGhpcy5ncm91bmRDb2xvciA9IG5ldyBDb2xvcihncm91bmRDb2xvcik7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBMaWdodC5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsIHNvdXJjZSk7CiAgICB0aGlzLmdyb3VuZENvbG9yLmNvcHkoc291cmNlLmdyb3VuZENvbG9yKTsKICAgIHJldHVybiB0aGlzOwogIH0KfQpIZW1pc3BoZXJlTGlnaHQucHJvdG90eXBlLmlzSGVtaXNwaGVyZUxpZ2h0ID0gdHJ1ZTsKY29uc3QgX3Byb2pTY3JlZW5NYXRyaXgkMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWF0cml4NCgpOwpjb25zdCBfbGlnaHRQb3NpdGlvbldvcmxkJDEgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX2xvb2tUYXJnZXQkMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjbGFzcyBMaWdodFNoYWRvdyB7CiAgY29uc3RydWN0b3IoY2FtZXJhKSB7CiAgICB0aGlzLmNhbWVyYSA9IGNhbWVyYTsKICAgIHRoaXMuYmlhcyA9IDA7CiAgICB0aGlzLm5vcm1hbEJpYXMgPSAwOwogICAgdGhpcy5yYWRpdXMgPSAxOwogICAgdGhpcy5ibHVyU2FtcGxlcyA9IDg7CiAgICB0aGlzLm1hcFNpemUgPSBuZXcgVmVjdG9yMig1MTIsIDUxMik7CiAgICB0aGlzLm1hcCA9IG51bGw7CiAgICB0aGlzLm1hcFBhc3MgPSBudWxsOwogICAgdGhpcy5tYXRyaXggPSBuZXcgTWF0cml4NCgpOwogICAgdGhpcy5hdXRvVXBkYXRlID0gdHJ1ZTsKICAgIHRoaXMubmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgIHRoaXMuX2ZydXN0dW0gPSBuZXcgRnJ1c3R1bSgpOwogICAgdGhpcy5fZnJhbWVFeHRlbnRzID0gbmV3IFZlY3RvcjIoMSwgMSk7CiAgICB0aGlzLl92aWV3cG9ydENvdW50ID0gMTsKICAgIHRoaXMuX3ZpZXdwb3J0cyA9IFsKICAgICAgbmV3IFZlY3RvcjQoMCwgMCwgMSwgMSkKICAgIF07CiAgfQogIGdldFZpZXdwb3J0Q291bnQoKSB7CiAgICByZXR1cm4gdGhpcy5fdmlld3BvcnRDb3VudDsKICB9CiAgZ2V0RnJ1c3R1bSgpIHsKICAgIHJldHVybiB0aGlzLl9mcnVzdHVtOwogIH0KICB1cGRhdGVNYXRyaWNlcyhsaWdodCkgewogICAgY29uc3Qgc2hhZG93Q2FtZXJhID0gdGhpcy5jYW1lcmE7CiAgICBjb25zdCBzaGFkb3dNYXRyaXggPSB0aGlzLm1hdHJpeDsKICAgIF9saWdodFBvc2l0aW9uV29ybGQkMS5zZXRGcm9tTWF0cml4UG9zaXRpb24obGlnaHQubWF0cml4V29ybGQpOwogICAgc2hhZG93Q2FtZXJhLnBvc2l0aW9uLmNvcHkoX2xpZ2h0UG9zaXRpb25Xb3JsZCQxKTsKICAgIF9sb29rVGFyZ2V0JDEuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKGxpZ2h0LnRhcmdldC5tYXRyaXhXb3JsZCk7CiAgICBzaGFkb3dDYW1lcmEubG9va0F0KF9sb29rVGFyZ2V0JDEpOwogICAgc2hhZG93Q2FtZXJhLnVwZGF0ZU1hdHJpeFdvcmxkKCk7CiAgICBfcHJvalNjcmVlbk1hdHJpeCQxLm11bHRpcGx5TWF0cmljZXMoc2hhZG93Q2FtZXJhLnByb2plY3Rpb25NYXRyaXgsIHNoYWRvd0NhbWVyYS5tYXRyaXhXb3JsZEludmVyc2UpOwogICAgdGhpcy5fZnJ1c3R1bS5zZXRGcm9tUHJvamVjdGlvbk1hdHJpeChfcHJvalNjcmVlbk1hdHJpeCQxKTsKICAgIHNoYWRvd01hdHJpeC5zZXQoMC41LCAwLCAwLCAwLjUsIDAsIDAuNSwgMCwgMC41LCAwLCAwLCAwLjUsIDAuNSwgMCwgMCwgMCwgMSk7CiAgICBzaGFkb3dNYXRyaXgubXVsdGlwbHkoc2hhZG93Q2FtZXJhLnByb2plY3Rpb25NYXRyaXgpOwogICAgc2hhZG93TWF0cml4Lm11bHRpcGx5KHNoYWRvd0NhbWVyYS5tYXRyaXhXb3JsZEludmVyc2UpOwogIH0KICBnZXRWaWV3cG9ydCh2aWV3cG9ydEluZGV4KSB7CiAgICByZXR1cm4gdGhpcy5fdmlld3BvcnRzW3ZpZXdwb3J0SW5kZXhdOwogIH0KICBnZXRGcmFtZUV4dGVudHMoKSB7CiAgICByZXR1cm4gdGhpcy5fZnJhbWVFeHRlbnRzOwogIH0KICBkaXNwb3NlKCkgewogICAgaWYgKHRoaXMubWFwKSB7CiAgICAgIHRoaXMubWFwLmRpc3Bvc2UoKTsKICAgIH0KICAgIGlmICh0aGlzLm1hcFBhc3MpIHsKICAgICAgdGhpcy5tYXBQYXNzLmRpc3Bvc2UoKTsKICAgIH0KICB9CiAgY29weShzb3VyY2UpIHsKICAgIHRoaXMuY2FtZXJhID0gc291cmNlLmNhbWVyYS5jbG9uZSgpOwogICAgdGhpcy5iaWFzID0gc291cmNlLmJpYXM7CiAgICB0aGlzLnJhZGl1cyA9IHNvdXJjZS5yYWRpdXM7CiAgICB0aGlzLm1hcFNpemUuY29weShzb3VyY2UubWFwU2l6ZSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xvbmUoKSB7CiAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoKS5jb3B5KHRoaXMpOwogIH0KICB0b0pTT04oKSB7CiAgICBjb25zdCBvYmplY3QgPSB7fTsKICAgIGlmICh0aGlzLmJpYXMgIT09IDApCiAgICAgIG9iamVjdC5iaWFzID0gdGhpcy5iaWFzOwogICAgaWYgKHRoaXMubm9ybWFsQmlhcyAhPT0gMCkKICAgICAgb2JqZWN0Lm5vcm1hbEJpYXMgPSB0aGlzLm5vcm1hbEJpYXM7CiAgICBpZiAodGhpcy5yYWRpdXMgIT09IDEpCiAgICAgIG9iamVjdC5yYWRpdXMgPSB0aGlzLnJhZGl1czsKICAgIGlmICh0aGlzLm1hcFNpemUueCAhPT0gNTEyIHx8IHRoaXMubWFwU2l6ZS55ICE9PSA1MTIpCiAgICAgIG9iamVjdC5tYXBTaXplID0gdGhpcy5tYXBTaXplLnRvQXJyYXkoKTsKICAgIG9iamVjdC5jYW1lcmEgPSB0aGlzLmNhbWVyYS50b0pTT04oZmFsc2UpLm9iamVjdDsKICAgIGRlbGV0ZSBvYmplY3QuY2FtZXJhLm1hdHJpeDsKICAgIHJldHVybiBvYmplY3Q7CiAgfQp9CmNsYXNzIFNwb3RMaWdodFNoYWRvdyBleHRlbmRzIExpZ2h0U2hhZG93IHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHN1cGVyKG5ldyBQZXJzcGVjdGl2ZUNhbWVyYSg1MCwgMSwgMC41LCA1MDApKTsKICAgIHRoaXMuZm9jdXMgPSAxOwogIH0KICB1cGRhdGVNYXRyaWNlcyhsaWdodCkgewogICAgY29uc3QgY2FtZXJhID0gdGhpcy5jYW1lcmE7CiAgICBjb25zdCBmb3YyID0gUkFEMkRFRyAqIDIgKiBsaWdodC5hbmdsZSAqIHRoaXMuZm9jdXM7CiAgICBjb25zdCBhc3BlY3QyID0gdGhpcy5tYXBTaXplLndpZHRoIC8gdGhpcy5tYXBTaXplLmhlaWdodDsKICAgIGNvbnN0IGZhciA9IGxpZ2h0LmRpc3RhbmNlIHx8IGNhbWVyYS5mYXI7CiAgICBpZiAoZm92MiAhPT0gY2FtZXJhLmZvdiB8fCBhc3BlY3QyICE9PSBjYW1lcmEuYXNwZWN0IHx8IGZhciAhPT0gY2FtZXJhLmZhcikgewogICAgICBjYW1lcmEuZm92ID0gZm92MjsKICAgICAgY2FtZXJhLmFzcGVjdCA9IGFzcGVjdDI7CiAgICAgIGNhbWVyYS5mYXIgPSBmYXI7CiAgICAgIGNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7CiAgICB9CiAgICBzdXBlci51cGRhdGVNYXRyaWNlcyhsaWdodCk7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLmZvY3VzID0gc291cmNlLmZvY3VzOwogICAgcmV0dXJuIHRoaXM7CiAgfQp9ClNwb3RMaWdodFNoYWRvdy5wcm90b3R5cGUuaXNTcG90TGlnaHRTaGFkb3cgPSB0cnVlOwpjbGFzcyBTcG90TGlnaHQgZXh0ZW5kcyBMaWdodCB7CiAgY29uc3RydWN0b3IoY29sb3IsIGludGVuc2l0eSwgZGlzdGFuY2UgPSAwLCBhbmdsZSA9IE1hdGguUEkgLyAzLCBwZW51bWJyYSA9IDAsIGRlY2F5ID0gMSkgewogICAgc3VwZXIoY29sb3IsIGludGVuc2l0eSk7CiAgICB0aGlzLnR5cGUgPSAiU3BvdExpZ2h0IjsKICAgIHRoaXMucG9zaXRpb24uY29weShPYmplY3QzRC5EZWZhdWx0VXApOwogICAgdGhpcy51cGRhdGVNYXRyaXgoKTsKICAgIHRoaXMudGFyZ2V0ID0gbmV3IE9iamVjdDNEKCk7CiAgICB0aGlzLmRpc3RhbmNlID0gZGlzdGFuY2U7CiAgICB0aGlzLmFuZ2xlID0gYW5nbGU7CiAgICB0aGlzLnBlbnVtYnJhID0gcGVudW1icmE7CiAgICB0aGlzLmRlY2F5ID0gZGVjYXk7CiAgICB0aGlzLnNoYWRvdyA9IG5ldyBTcG90TGlnaHRTaGFkb3coKTsKICB9CiAgZ2V0IHBvd2VyKCkgewogICAgcmV0dXJuIHRoaXMuaW50ZW5zaXR5ICogTWF0aC5QSTsKICB9CiAgc2V0IHBvd2VyKHBvd2VyKSB7CiAgICB0aGlzLmludGVuc2l0eSA9IHBvd2VyIC8gTWF0aC5QSTsKICB9CiAgZGlzcG9zZSgpIHsKICAgIHRoaXMuc2hhZG93LmRpc3Bvc2UoKTsKICB9CiAgY29weShzb3VyY2UpIHsKICAgIHN1cGVyLmNvcHkoc291cmNlKTsKICAgIHRoaXMuZGlzdGFuY2UgPSBzb3VyY2UuZGlzdGFuY2U7CiAgICB0aGlzLmFuZ2xlID0gc291cmNlLmFuZ2xlOwogICAgdGhpcy5wZW51bWJyYSA9IHNvdXJjZS5wZW51bWJyYTsKICAgIHRoaXMuZGVjYXkgPSBzb3VyY2UuZGVjYXk7CiAgICB0aGlzLnRhcmdldCA9IHNvdXJjZS50YXJnZXQuY2xvbmUoKTsKICAgIHRoaXMuc2hhZG93ID0gc291cmNlLnNoYWRvdy5jbG9uZSgpOwogICAgcmV0dXJuIHRoaXM7CiAgfQp9ClNwb3RMaWdodC5wcm90b3R5cGUuaXNTcG90TGlnaHQgPSB0cnVlOwpjb25zdCBfcHJvalNjcmVlbk1hdHJpeCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWF0cml4NCgpOwpjb25zdCBfbGlnaHRQb3NpdGlvbldvcmxkID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF9sb29rVGFyZ2V0ID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNsYXNzIFBvaW50TGlnaHRTaGFkb3cgZXh0ZW5kcyBMaWdodFNoYWRvdyB7CiAgY29uc3RydWN0b3IoKSB7CiAgICBzdXBlcihuZXcgUGVyc3BlY3RpdmVDYW1lcmEoOTAsIDEsIDAuNSwgNTAwKSk7CiAgICB0aGlzLl9mcmFtZUV4dGVudHMgPSBuZXcgVmVjdG9yMig0LCAyKTsKICAgIHRoaXMuX3ZpZXdwb3J0Q291bnQgPSA2OwogICAgdGhpcy5fdmlld3BvcnRzID0gWwogICAgICBuZXcgVmVjdG9yNCgyLCAxLCAxLCAxKSwKICAgICAgbmV3IFZlY3RvcjQoMCwgMSwgMSwgMSksCiAgICAgIG5ldyBWZWN0b3I0KDMsIDEsIDEsIDEpLAogICAgICBuZXcgVmVjdG9yNCgxLCAxLCAxLCAxKSwKICAgICAgbmV3IFZlY3RvcjQoMywgMCwgMSwgMSksCiAgICAgIG5ldyBWZWN0b3I0KDEsIDAsIDEsIDEpCiAgICBdOwogICAgdGhpcy5fY3ViZURpcmVjdGlvbnMgPSBbCiAgICAgIG5ldyBWZWN0b3IzKDEsIDAsIDApLAogICAgICBuZXcgVmVjdG9yMygtMSwgMCwgMCksCiAgICAgIG5ldyBWZWN0b3IzKDAsIDAsIDEpLAogICAgICBuZXcgVmVjdG9yMygwLCAwLCAtMSksCiAgICAgIG5ldyBWZWN0b3IzKDAsIDEsIDApLAogICAgICBuZXcgVmVjdG9yMygwLCAtMSwgMCkKICAgIF07CiAgICB0aGlzLl9jdWJlVXBzID0gWwogICAgICBuZXcgVmVjdG9yMygwLCAxLCAwKSwKICAgICAgbmV3IFZlY3RvcjMoMCwgMSwgMCksCiAgICAgIG5ldyBWZWN0b3IzKDAsIDEsIDApLAogICAgICBuZXcgVmVjdG9yMygwLCAxLCAwKSwKICAgICAgbmV3IFZlY3RvcjMoMCwgMCwgMSksCiAgICAgIG5ldyBWZWN0b3IzKDAsIDAsIC0xKQogICAgXTsKICB9CiAgdXBkYXRlTWF0cmljZXMobGlnaHQsIHZpZXdwb3J0SW5kZXggPSAwKSB7CiAgICBjb25zdCBjYW1lcmEgPSB0aGlzLmNhbWVyYTsKICAgIGNvbnN0IHNoYWRvd01hdHJpeCA9IHRoaXMubWF0cml4OwogICAgY29uc3QgZmFyID0gbGlnaHQuZGlzdGFuY2UgfHwgY2FtZXJhLmZhcjsKICAgIGlmIChmYXIgIT09IGNhbWVyYS5mYXIpIHsKICAgICAgY2FtZXJhLmZhciA9IGZhcjsKICAgICAgY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICAgIH0KICAgIF9saWdodFBvc2l0aW9uV29ybGQuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKGxpZ2h0Lm1hdHJpeFdvcmxkKTsKICAgIGNhbWVyYS5wb3NpdGlvbi5jb3B5KF9saWdodFBvc2l0aW9uV29ybGQpOwogICAgX2xvb2tUYXJnZXQuY29weShjYW1lcmEucG9zaXRpb24pOwogICAgX2xvb2tUYXJnZXQuYWRkKHRoaXMuX2N1YmVEaXJlY3Rpb25zW3ZpZXdwb3J0SW5kZXhdKTsKICAgIGNhbWVyYS51cC5jb3B5KHRoaXMuX2N1YmVVcHNbdmlld3BvcnRJbmRleF0pOwogICAgY2FtZXJhLmxvb2tBdChfbG9va1RhcmdldCk7CiAgICBjYW1lcmEudXBkYXRlTWF0cml4V29ybGQoKTsKICAgIHNoYWRvd01hdHJpeC5tYWtlVHJhbnNsYXRpb24oLV9saWdodFBvc2l0aW9uV29ybGQueCwgLV9saWdodFBvc2l0aW9uV29ybGQueSwgLV9saWdodFBvc2l0aW9uV29ybGQueik7CiAgICBfcHJvalNjcmVlbk1hdHJpeC5tdWx0aXBseU1hdHJpY2VzKGNhbWVyYS5wcm9qZWN0aW9uTWF0cml4LCBjYW1lcmEubWF0cml4V29ybGRJbnZlcnNlKTsKICAgIHRoaXMuX2ZydXN0dW0uc2V0RnJvbVByb2plY3Rpb25NYXRyaXgoX3Byb2pTY3JlZW5NYXRyaXgpOwogIH0KfQpQb2ludExpZ2h0U2hhZG93LnByb3RvdHlwZS5pc1BvaW50TGlnaHRTaGFkb3cgPSB0cnVlOwpjbGFzcyBQb2ludExpZ2h0IGV4dGVuZHMgTGlnaHQgewogIGNvbnN0cnVjdG9yKGNvbG9yLCBpbnRlbnNpdHksIGRpc3RhbmNlID0gMCwgZGVjYXkgPSAxKSB7CiAgICBzdXBlcihjb2xvciwgaW50ZW5zaXR5KTsKICAgIHRoaXMudHlwZSA9ICJQb2ludExpZ2h0IjsKICAgIHRoaXMuZGlzdGFuY2UgPSBkaXN0YW5jZTsKICAgIHRoaXMuZGVjYXkgPSBkZWNheTsKICAgIHRoaXMuc2hhZG93ID0gbmV3IFBvaW50TGlnaHRTaGFkb3coKTsKICB9CiAgZ2V0IHBvd2VyKCkgewogICAgcmV0dXJuIHRoaXMuaW50ZW5zaXR5ICogNCAqIE1hdGguUEk7CiAgfQogIHNldCBwb3dlcihwb3dlcikgewogICAgdGhpcy5pbnRlbnNpdHkgPSBwb3dlciAvICg0ICogTWF0aC5QSSk7CiAgfQogIGRpc3Bvc2UoKSB7CiAgICB0aGlzLnNoYWRvdy5kaXNwb3NlKCk7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLmRpc3RhbmNlID0gc291cmNlLmRpc3RhbmNlOwogICAgdGhpcy5kZWNheSA9IHNvdXJjZS5kZWNheTsKICAgIHRoaXMuc2hhZG93ID0gc291cmNlLnNoYWRvdy5jbG9uZSgpOwogICAgcmV0dXJuIHRoaXM7CiAgfQp9ClBvaW50TGlnaHQucHJvdG90eXBlLmlzUG9pbnRMaWdodCA9IHRydWU7CmNsYXNzIERpcmVjdGlvbmFsTGlnaHRTaGFkb3cgZXh0ZW5kcyBMaWdodFNoYWRvdyB7CiAgY29uc3RydWN0b3IoKSB7CiAgICBzdXBlcihuZXcgT3J0aG9ncmFwaGljQ2FtZXJhKC01LCA1LCA1LCAtNSwgMC41LCA1MDApKTsKICB9Cn0KRGlyZWN0aW9uYWxMaWdodFNoYWRvdy5wcm90b3R5cGUuaXNEaXJlY3Rpb25hbExpZ2h0U2hhZG93ID0gdHJ1ZTsKY2xhc3MgRGlyZWN0aW9uYWxMaWdodCBleHRlbmRzIExpZ2h0IHsKICBjb25zdHJ1Y3Rvcihjb2xvciwgaW50ZW5zaXR5KSB7CiAgICBzdXBlcihjb2xvciwgaW50ZW5zaXR5KTsKICAgIHRoaXMudHlwZSA9ICJEaXJlY3Rpb25hbExpZ2h0IjsKICAgIHRoaXMucG9zaXRpb24uY29weShPYmplY3QzRC5EZWZhdWx0VXApOwogICAgdGhpcy51cGRhdGVNYXRyaXgoKTsKICAgIHRoaXMudGFyZ2V0ID0gbmV3IE9iamVjdDNEKCk7CiAgICB0aGlzLnNoYWRvdyA9IG5ldyBEaXJlY3Rpb25hbExpZ2h0U2hhZG93KCk7CiAgfQogIGRpc3Bvc2UoKSB7CiAgICB0aGlzLnNoYWRvdy5kaXNwb3NlKCk7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLnRhcmdldCA9IHNvdXJjZS50YXJnZXQuY2xvbmUoKTsKICAgIHRoaXMuc2hhZG93ID0gc291cmNlLnNoYWRvdy5jbG9uZSgpOwogICAgcmV0dXJuIHRoaXM7CiAgfQp9CkRpcmVjdGlvbmFsTGlnaHQucHJvdG90eXBlLmlzRGlyZWN0aW9uYWxMaWdodCA9IHRydWU7CmNsYXNzIEFtYmllbnRMaWdodCBleHRlbmRzIExpZ2h0IHsKICBjb25zdHJ1Y3Rvcihjb2xvciwgaW50ZW5zaXR5KSB7CiAgICBzdXBlcihjb2xvciwgaW50ZW5zaXR5KTsKICAgIHRoaXMudHlwZSA9ICJBbWJpZW50TGlnaHQiOwogIH0KfQpBbWJpZW50TGlnaHQucHJvdG90eXBlLmlzQW1iaWVudExpZ2h0ID0gdHJ1ZTsKY2xhc3MgUmVjdEFyZWFMaWdodCBleHRlbmRzIExpZ2h0IHsKICBjb25zdHJ1Y3Rvcihjb2xvciwgaW50ZW5zaXR5LCB3aWR0aCA9IDEwLCBoZWlnaHQgPSAxMCkgewogICAgc3VwZXIoY29sb3IsIGludGVuc2l0eSk7CiAgICB0aGlzLnR5cGUgPSAiUmVjdEFyZWFMaWdodCI7CiAgICB0aGlzLndpZHRoID0gd2lkdGg7CiAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKICB9CiAgZ2V0IHBvd2VyKCkgewogICAgcmV0dXJuIHRoaXMuaW50ZW5zaXR5ICogdGhpcy53aWR0aCAqIHRoaXMuaGVpZ2h0ICogTWF0aC5QSTsKICB9CiAgc2V0IHBvd2VyKHBvd2VyKSB7CiAgICB0aGlzLmludGVuc2l0eSA9IHBvd2VyIC8gKHRoaXMud2lkdGggKiB0aGlzLmhlaWdodCAqIE1hdGguUEkpOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy53aWR0aCA9IHNvdXJjZS53aWR0aDsKICAgIHRoaXMuaGVpZ2h0ID0gc291cmNlLmhlaWdodDsKICAgIHJldHVybiB0aGlzOwogIH0KICB0b0pTT04obWV0YSkgewogICAgY29uc3QgZGF0YSA9IHN1cGVyLnRvSlNPTihtZXRhKTsKICAgIGRhdGEub2JqZWN0LndpZHRoID0gdGhpcy53aWR0aDsKICAgIGRhdGEub2JqZWN0LmhlaWdodCA9IHRoaXMuaGVpZ2h0OwogICAgcmV0dXJuIGRhdGE7CiAgfQp9ClJlY3RBcmVhTGlnaHQucHJvdG90eXBlLmlzUmVjdEFyZWFMaWdodCA9IHRydWU7CmNsYXNzIFNwaGVyaWNhbEhhcm1vbmljczMgewogIGNvbnN0cnVjdG9yKCkgewogICAgdGhpcy5jb2VmZmljaWVudHMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgOTsgaSsrKSB7CiAgICAgIHRoaXMuY29lZmZpY2llbnRzLnB1c2gobmV3IFZlY3RvcjMoKSk7CiAgICB9CiAgfQogIHNldChjb2VmZmljaWVudHMpIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgOTsgaSsrKSB7CiAgICAgIHRoaXMuY29lZmZpY2llbnRzW2ldLmNvcHkoY29lZmZpY2llbnRzW2ldKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICB6ZXJvKCkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCA5OyBpKyspIHsKICAgICAgdGhpcy5jb2VmZmljaWVudHNbaV0uc2V0KDAsIDAsIDApOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGdldEF0KG5vcm1hbCwgdGFyZ2V0KSB7CiAgICBjb25zdCB4ID0gbm9ybWFsLngsIHkgPSBub3JtYWwueSwgeiA9IG5vcm1hbC56OwogICAgY29uc3QgY29lZmYgPSB0aGlzLmNvZWZmaWNpZW50czsKICAgIHRhcmdldC5jb3B5KGNvZWZmWzBdKS5tdWx0aXBseVNjYWxhcigwLjI4MjA5NSk7CiAgICB0YXJnZXQuYWRkU2NhbGVkVmVjdG9yKGNvZWZmWzFdLCAwLjQ4ODYwMyAqIHkpOwogICAgdGFyZ2V0LmFkZFNjYWxlZFZlY3Rvcihjb2VmZlsyXSwgMC40ODg2MDMgKiB6KTsKICAgIHRhcmdldC5hZGRTY2FsZWRWZWN0b3IoY29lZmZbM10sIDAuNDg4NjAzICogeCk7CiAgICB0YXJnZXQuYWRkU2NhbGVkVmVjdG9yKGNvZWZmWzRdLCAxLjA5MjU0OCAqICh4ICogeSkpOwogICAgdGFyZ2V0LmFkZFNjYWxlZFZlY3Rvcihjb2VmZls1XSwgMS4wOTI1NDggKiAoeSAqIHopKTsKICAgIHRhcmdldC5hZGRTY2FsZWRWZWN0b3IoY29lZmZbNl0sIDAuMzE1MzkyICogKDMgKiB6ICogeiAtIDEpKTsKICAgIHRhcmdldC5hZGRTY2FsZWRWZWN0b3IoY29lZmZbN10sIDEuMDkyNTQ4ICogKHggKiB6KSk7CiAgICB0YXJnZXQuYWRkU2NhbGVkVmVjdG9yKGNvZWZmWzhdLCAwLjU0NjI3NCAqICh4ICogeCAtIHkgKiB5KSk7CiAgICByZXR1cm4gdGFyZ2V0OwogIH0KICBnZXRJcnJhZGlhbmNlQXQobm9ybWFsLCB0YXJnZXQpIHsKICAgIGNvbnN0IHggPSBub3JtYWwueCwgeSA9IG5vcm1hbC55LCB6ID0gbm9ybWFsLno7CiAgICBjb25zdCBjb2VmZiA9IHRoaXMuY29lZmZpY2llbnRzOwogICAgdGFyZ2V0LmNvcHkoY29lZmZbMF0pLm11bHRpcGx5U2NhbGFyKDAuODg2MjI3KTsKICAgIHRhcmdldC5hZGRTY2FsZWRWZWN0b3IoY29lZmZbMV0sIDIgKiAwLjUxMTY2NCAqIHkpOwogICAgdGFyZ2V0LmFkZFNjYWxlZFZlY3Rvcihjb2VmZlsyXSwgMiAqIDAuNTExNjY0ICogeik7CiAgICB0YXJnZXQuYWRkU2NhbGVkVmVjdG9yKGNvZWZmWzNdLCAyICogMC41MTE2NjQgKiB4KTsKICAgIHRhcmdldC5hZGRTY2FsZWRWZWN0b3IoY29lZmZbNF0sIDIgKiAwLjQyOTA0MyAqIHggKiB5KTsKICAgIHRhcmdldC5hZGRTY2FsZWRWZWN0b3IoY29lZmZbNV0sIDIgKiAwLjQyOTA0MyAqIHkgKiB6KTsKICAgIHRhcmdldC5hZGRTY2FsZWRWZWN0b3IoY29lZmZbNl0sIDAuNzQzMTI1ICogeiAqIHogLSAwLjI0NzcwOCk7CiAgICB0YXJnZXQuYWRkU2NhbGVkVmVjdG9yKGNvZWZmWzddLCAyICogMC40MjkwNDMgKiB4ICogeik7CiAgICB0YXJnZXQuYWRkU2NhbGVkVmVjdG9yKGNvZWZmWzhdLCAwLjQyOTA0MyAqICh4ICogeCAtIHkgKiB5KSk7CiAgICByZXR1cm4gdGFyZ2V0OwogIH0KICBhZGQoc2gpIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgOTsgaSsrKSB7CiAgICAgIHRoaXMuY29lZmZpY2llbnRzW2ldLmFkZChzaC5jb2VmZmljaWVudHNbaV0pOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGFkZFNjYWxlZFNIKHNoLCBzKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDk7IGkrKykgewogICAgICB0aGlzLmNvZWZmaWNpZW50c1tpXS5hZGRTY2FsZWRWZWN0b3Ioc2guY29lZmZpY2llbnRzW2ldLCBzKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBzY2FsZShzKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDk7IGkrKykgewogICAgICB0aGlzLmNvZWZmaWNpZW50c1tpXS5tdWx0aXBseVNjYWxhcihzKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBsZXJwKHNoLCBhbHBoYSkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCA5OyBpKyspIHsKICAgICAgdGhpcy5jb2VmZmljaWVudHNbaV0ubGVycChzaC5jb2VmZmljaWVudHNbaV0sIGFscGhhKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBlcXVhbHMoc2gpIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgOTsgaSsrKSB7CiAgICAgIGlmICghdGhpcy5jb2VmZmljaWVudHNbaV0uZXF1YWxzKHNoLmNvZWZmaWNpZW50c1tpXSkpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0cnVlOwogIH0KICBjb3B5KHNoKSB7CiAgICByZXR1cm4gdGhpcy5zZXQoc2guY29lZmZpY2llbnRzKTsKICB9CiAgY2xvbmUoKSB7CiAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoKS5jb3B5KHRoaXMpOwogIH0KICBmcm9tQXJyYXkoYXJyYXksIG9mZnNldCA9IDApIHsKICAgIGNvbnN0IGNvZWZmaWNpZW50cyA9IHRoaXMuY29lZmZpY2llbnRzOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCA5OyBpKyspIHsKICAgICAgY29lZmZpY2llbnRzW2ldLmZyb21BcnJheShhcnJheSwgb2Zmc2V0ICsgaSAqIDMpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIHRvQXJyYXkoYXJyYXkgPSBbXSwgb2Zmc2V0ID0gMCkgewogICAgY29uc3QgY29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDk7IGkrKykgewogICAgICBjb2VmZmljaWVudHNbaV0udG9BcnJheShhcnJheSwgb2Zmc2V0ICsgaSAqIDMpOwogICAgfQogICAgcmV0dXJuIGFycmF5OwogIH0KICBzdGF0aWMgZ2V0QmFzaXNBdChub3JtYWwsIHNoQmFzaXMpIHsKICAgIGNvbnN0IHggPSBub3JtYWwueCwgeSA9IG5vcm1hbC55LCB6ID0gbm9ybWFsLno7CiAgICBzaEJhc2lzWzBdID0gMC4yODIwOTU7CiAgICBzaEJhc2lzWzFdID0gMC40ODg2MDMgKiB5OwogICAgc2hCYXNpc1syXSA9IDAuNDg4NjAzICogejsKICAgIHNoQmFzaXNbM10gPSAwLjQ4ODYwMyAqIHg7CiAgICBzaEJhc2lzWzRdID0gMS4wOTI1NDggKiB4ICogeTsKICAgIHNoQmFzaXNbNV0gPSAxLjA5MjU0OCAqIHkgKiB6OwogICAgc2hCYXNpc1s2XSA9IDAuMzE1MzkyICogKDMgKiB6ICogeiAtIDEpOwogICAgc2hCYXNpc1s3XSA9IDEuMDkyNTQ4ICogeCAqIHo7CiAgICBzaEJhc2lzWzhdID0gMC41NDYyNzQgKiAoeCAqIHggLSB5ICogeSk7CiAgfQp9ClNwaGVyaWNhbEhhcm1vbmljczMucHJvdG90eXBlLmlzU3BoZXJpY2FsSGFybW9uaWNzMyA9IHRydWU7CmNsYXNzIExpZ2h0UHJvYmUgZXh0ZW5kcyBMaWdodCB7CiAgY29uc3RydWN0b3Ioc2ggPSBuZXcgU3BoZXJpY2FsSGFybW9uaWNzMygpLCBpbnRlbnNpdHkgPSAxKSB7CiAgICBzdXBlcih2b2lkIDAsIGludGVuc2l0eSk7CiAgICB0aGlzLnNoID0gc2g7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLnNoLmNvcHkoc291cmNlLnNoKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBmcm9tSlNPTihqc29uKSB7CiAgICB0aGlzLmludGVuc2l0eSA9IGpzb24uaW50ZW5zaXR5OwogICAgdGhpcy5zaC5mcm9tQXJyYXkoanNvbi5zaCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgdG9KU09OKG1ldGEpIHsKICAgIGNvbnN0IGRhdGEgPSBzdXBlci50b0pTT04obWV0YSk7CiAgICBkYXRhLm9iamVjdC5zaCA9IHRoaXMuc2gudG9BcnJheSgpOwogICAgcmV0dXJuIGRhdGE7CiAgfQp9CkxpZ2h0UHJvYmUucHJvdG90eXBlLmlzTGlnaHRQcm9iZSA9IHRydWU7CmNsYXNzIE1hdGVyaWFsTG9hZGVyIGV4dGVuZHMgTG9hZGVyIHsKICBjb25zdHJ1Y3RvcihtYW5hZ2VyKSB7CiAgICBzdXBlcihtYW5hZ2VyKTsKICAgIHRoaXMudGV4dHVyZXMgPSB7fTsKICB9CiAgbG9hZCh1cmwsIG9uTG9hZCwgb25Qcm9ncmVzcywgb25FcnJvcikgewogICAgY29uc3Qgc2NvcGUgPSB0aGlzOwogICAgY29uc3QgbG9hZGVyID0gbmV3IEZpbGVMb2FkZXIoc2NvcGUubWFuYWdlcik7CiAgICBsb2FkZXIuc2V0UGF0aChzY29wZS5wYXRoKTsKICAgIGxvYWRlci5zZXRSZXF1ZXN0SGVhZGVyKHNjb3BlLnJlcXVlc3RIZWFkZXIpOwogICAgbG9hZGVyLnNldFdpdGhDcmVkZW50aWFscyhzY29wZS53aXRoQ3JlZGVudGlhbHMpOwogICAgbG9hZGVyLmxvYWQodXJsLCBmdW5jdGlvbih0ZXh0KSB7CiAgICAgIHRyeSB7CiAgICAgICAgb25Mb2FkKHNjb3BlLnBhcnNlKEpTT04ucGFyc2UodGV4dCkpKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGlmIChvbkVycm9yKSB7CiAgICAgICAgICBvbkVycm9yKGUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgIH0KICAgICAgICBzY29wZS5tYW5hZ2VyLml0ZW1FcnJvcih1cmwpOwogICAgICB9CiAgICB9LCBvblByb2dyZXNzLCBvbkVycm9yKTsKICB9CiAgcGFyc2UoanNvbikgewogICAgY29uc3QgdGV4dHVyZXMgPSB0aGlzLnRleHR1cmVzOwogICAgZnVuY3Rpb24gZ2V0VGV4dHVyZShuYW1lKSB7CiAgICAgIGlmICh0ZXh0dXJlc1tuYW1lXSA9PT0gdm9pZCAwKSB7CiAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5NYXRlcmlhbExvYWRlcjogVW5kZWZpbmVkIHRleHR1cmUiLCBuYW1lKTsKICAgICAgfQogICAgICByZXR1cm4gdGV4dHVyZXNbbmFtZV07CiAgICB9CiAgICBjb25zdCBtYXRlcmlhbCA9IG5ldyBNYXRlcmlhbHNbanNvbi50eXBlXSgpOwogICAgaWYgKGpzb24udXVpZCAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC51dWlkID0ganNvbi51dWlkOwogICAgaWYgKGpzb24ubmFtZSAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5uYW1lID0ganNvbi5uYW1lOwogICAgaWYgKGpzb24uY29sb3IgIT09IHZvaWQgMCAmJiBtYXRlcmlhbC5jb2xvciAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5jb2xvci5zZXRIZXgoanNvbi5jb2xvcik7CiAgICBpZiAoanNvbi5yb3VnaG5lc3MgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwucm91Z2huZXNzID0ganNvbi5yb3VnaG5lc3M7CiAgICBpZiAoanNvbi5tZXRhbG5lc3MgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwubWV0YWxuZXNzID0ganNvbi5tZXRhbG5lc3M7CiAgICBpZiAoanNvbi5zaGVlbiAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5zaGVlbiA9IGpzb24uc2hlZW47CiAgICBpZiAoanNvbi5zaGVlbkNvbG9yICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnNoZWVuQ29sb3IgPSBuZXcgQ29sb3IoKS5zZXRIZXgoanNvbi5zaGVlbkNvbG9yKTsKICAgIGlmIChqc29uLnNoZWVuUm91Z2huZXNzICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnNoZWVuUm91Z2huZXNzID0ganNvbi5zaGVlblJvdWdobmVzczsKICAgIGlmIChqc29uLmVtaXNzaXZlICE9PSB2b2lkIDAgJiYgbWF0ZXJpYWwuZW1pc3NpdmUgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuZW1pc3NpdmUuc2V0SGV4KGpzb24uZW1pc3NpdmUpOwogICAgaWYgKGpzb24uc3BlY3VsYXIgIT09IHZvaWQgMCAmJiBtYXRlcmlhbC5zcGVjdWxhciAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5zcGVjdWxhci5zZXRIZXgoanNvbi5zcGVjdWxhcik7CiAgICBpZiAoanNvbi5zcGVjdWxhckludGVuc2l0eSAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5zcGVjdWxhckludGVuc2l0eSA9IGpzb24uc3BlY3VsYXJJbnRlbnNpdHk7CiAgICBpZiAoanNvbi5zcGVjdWxhckNvbG9yICE9PSB2b2lkIDAgJiYgbWF0ZXJpYWwuc3BlY3VsYXJDb2xvciAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5zcGVjdWxhckNvbG9yLnNldEhleChqc29uLnNwZWN1bGFyQ29sb3IpOwogICAgaWYgKGpzb24uc2hpbmluZXNzICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnNoaW5pbmVzcyA9IGpzb24uc2hpbmluZXNzOwogICAgaWYgKGpzb24uY2xlYXJjb2F0ICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmNsZWFyY29hdCA9IGpzb24uY2xlYXJjb2F0OwogICAgaWYgKGpzb24uY2xlYXJjb2F0Um91Z2huZXNzICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmNsZWFyY29hdFJvdWdobmVzcyA9IGpzb24uY2xlYXJjb2F0Um91Z2huZXNzOwogICAgaWYgKGpzb24udHJhbnNtaXNzaW9uICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnRyYW5zbWlzc2lvbiA9IGpzb24udHJhbnNtaXNzaW9uOwogICAgaWYgKGpzb24udGhpY2tuZXNzICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnRoaWNrbmVzcyA9IGpzb24udGhpY2tuZXNzOwogICAgaWYgKGpzb24uYXR0ZW51YXRpb25EaXN0YW5jZSAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5hdHRlbnVhdGlvbkRpc3RhbmNlID0ganNvbi5hdHRlbnVhdGlvbkRpc3RhbmNlOwogICAgaWYgKGpzb24uYXR0ZW51YXRpb25Db2xvciAhPT0gdm9pZCAwICYmIG1hdGVyaWFsLmF0dGVudWF0aW9uQ29sb3IgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuYXR0ZW51YXRpb25Db2xvci5zZXRIZXgoanNvbi5hdHRlbnVhdGlvbkNvbG9yKTsKICAgIGlmIChqc29uLmZvZyAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5mb2cgPSBqc29uLmZvZzsKICAgIGlmIChqc29uLmZsYXRTaGFkaW5nICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmZsYXRTaGFkaW5nID0ganNvbi5mbGF0U2hhZGluZzsKICAgIGlmIChqc29uLmJsZW5kaW5nICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmJsZW5kaW5nID0ganNvbi5ibGVuZGluZzsKICAgIGlmIChqc29uLmNvbWJpbmUgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuY29tYmluZSA9IGpzb24uY29tYmluZTsKICAgIGlmIChqc29uLnNpZGUgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuc2lkZSA9IGpzb24uc2lkZTsKICAgIGlmIChqc29uLnNoYWRvd1NpZGUgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuc2hhZG93U2lkZSA9IGpzb24uc2hhZG93U2lkZTsKICAgIGlmIChqc29uLm9wYWNpdHkgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwub3BhY2l0eSA9IGpzb24ub3BhY2l0eTsKICAgIGlmIChqc29uLnRyYW5zcGFyZW50ICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnRyYW5zcGFyZW50ID0ganNvbi50cmFuc3BhcmVudDsKICAgIGlmIChqc29uLmFscGhhVGVzdCAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5hbHBoYVRlc3QgPSBqc29uLmFscGhhVGVzdDsKICAgIGlmIChqc29uLmRlcHRoVGVzdCAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5kZXB0aFRlc3QgPSBqc29uLmRlcHRoVGVzdDsKICAgIGlmIChqc29uLmRlcHRoV3JpdGUgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuZGVwdGhXcml0ZSA9IGpzb24uZGVwdGhXcml0ZTsKICAgIGlmIChqc29uLmNvbG9yV3JpdGUgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuY29sb3JXcml0ZSA9IGpzb24uY29sb3JXcml0ZTsKICAgIGlmIChqc29uLnN0ZW5jaWxXcml0ZSAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5zdGVuY2lsV3JpdGUgPSBqc29uLnN0ZW5jaWxXcml0ZTsKICAgIGlmIChqc29uLnN0ZW5jaWxXcml0ZU1hc2sgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuc3RlbmNpbFdyaXRlTWFzayA9IGpzb24uc3RlbmNpbFdyaXRlTWFzazsKICAgIGlmIChqc29uLnN0ZW5jaWxGdW5jICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnN0ZW5jaWxGdW5jID0ganNvbi5zdGVuY2lsRnVuYzsKICAgIGlmIChqc29uLnN0ZW5jaWxSZWYgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuc3RlbmNpbFJlZiA9IGpzb24uc3RlbmNpbFJlZjsKICAgIGlmIChqc29uLnN0ZW5jaWxGdW5jTWFzayAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5zdGVuY2lsRnVuY01hc2sgPSBqc29uLnN0ZW5jaWxGdW5jTWFzazsKICAgIGlmIChqc29uLnN0ZW5jaWxGYWlsICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnN0ZW5jaWxGYWlsID0ganNvbi5zdGVuY2lsRmFpbDsKICAgIGlmIChqc29uLnN0ZW5jaWxaRmFpbCAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5zdGVuY2lsWkZhaWwgPSBqc29uLnN0ZW5jaWxaRmFpbDsKICAgIGlmIChqc29uLnN0ZW5jaWxaUGFzcyAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5zdGVuY2lsWlBhc3MgPSBqc29uLnN0ZW5jaWxaUGFzczsKICAgIGlmIChqc29uLndpcmVmcmFtZSAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC53aXJlZnJhbWUgPSBqc29uLndpcmVmcmFtZTsKICAgIGlmIChqc29uLndpcmVmcmFtZUxpbmV3aWR0aCAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC53aXJlZnJhbWVMaW5ld2lkdGggPSBqc29uLndpcmVmcmFtZUxpbmV3aWR0aDsKICAgIGlmIChqc29uLndpcmVmcmFtZUxpbmVjYXAgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwud2lyZWZyYW1lTGluZWNhcCA9IGpzb24ud2lyZWZyYW1lTGluZWNhcDsKICAgIGlmIChqc29uLndpcmVmcmFtZUxpbmVqb2luICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLndpcmVmcmFtZUxpbmVqb2luID0ganNvbi53aXJlZnJhbWVMaW5lam9pbjsKICAgIGlmIChqc29uLnJvdGF0aW9uICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnJvdGF0aW9uID0ganNvbi5yb3RhdGlvbjsKICAgIGlmIChqc29uLmxpbmV3aWR0aCAhPT0gMSkKICAgICAgbWF0ZXJpYWwubGluZXdpZHRoID0ganNvbi5saW5ld2lkdGg7CiAgICBpZiAoanNvbi5kYXNoU2l6ZSAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5kYXNoU2l6ZSA9IGpzb24uZGFzaFNpemU7CiAgICBpZiAoanNvbi5nYXBTaXplICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmdhcFNpemUgPSBqc29uLmdhcFNpemU7CiAgICBpZiAoanNvbi5zY2FsZSAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5zY2FsZSA9IGpzb24uc2NhbGU7CiAgICBpZiAoanNvbi5wb2x5Z29uT2Zmc2V0ICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnBvbHlnb25PZmZzZXQgPSBqc29uLnBvbHlnb25PZmZzZXQ7CiAgICBpZiAoanNvbi5wb2x5Z29uT2Zmc2V0RmFjdG9yICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnBvbHlnb25PZmZzZXRGYWN0b3IgPSBqc29uLnBvbHlnb25PZmZzZXRGYWN0b3I7CiAgICBpZiAoanNvbi5wb2x5Z29uT2Zmc2V0VW5pdHMgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwucG9seWdvbk9mZnNldFVuaXRzID0ganNvbi5wb2x5Z29uT2Zmc2V0VW5pdHM7CiAgICBpZiAoanNvbi5kaXRoZXJpbmcgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuZGl0aGVyaW5nID0ganNvbi5kaXRoZXJpbmc7CiAgICBpZiAoanNvbi5hbHBoYVRvQ292ZXJhZ2UgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuYWxwaGFUb0NvdmVyYWdlID0ganNvbi5hbHBoYVRvQ292ZXJhZ2U7CiAgICBpZiAoanNvbi5wcmVtdWx0aXBsaWVkQWxwaGEgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwucHJlbXVsdGlwbGllZEFscGhhID0ganNvbi5wcmVtdWx0aXBsaWVkQWxwaGE7CiAgICBpZiAoanNvbi52aXNpYmxlICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnZpc2libGUgPSBqc29uLnZpc2libGU7CiAgICBpZiAoanNvbi50b25lTWFwcGVkICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnRvbmVNYXBwZWQgPSBqc29uLnRvbmVNYXBwZWQ7CiAgICBpZiAoanNvbi51c2VyRGF0YSAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC51c2VyRGF0YSA9IGpzb24udXNlckRhdGE7CiAgICBpZiAoanNvbi52ZXJ0ZXhDb2xvcnMgIT09IHZvaWQgMCkgewogICAgICBpZiAodHlwZW9mIGpzb24udmVydGV4Q29sb3JzID09PSAibnVtYmVyIikgewogICAgICAgIG1hdGVyaWFsLnZlcnRleENvbG9ycyA9IGpzb24udmVydGV4Q29sb3JzID4gMCA/IHRydWUgOiBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBtYXRlcmlhbC52ZXJ0ZXhDb2xvcnMgPSBqc29uLnZlcnRleENvbG9yczsKICAgICAgfQogICAgfQogICAgaWYgKGpzb24udW5pZm9ybXMgIT09IHZvaWQgMCkgewogICAgICBmb3IgKGNvbnN0IG5hbWUgaW4ganNvbi51bmlmb3JtcykgewogICAgICAgIGNvbnN0IHVuaWZvcm0gPSBqc29uLnVuaWZvcm1zW25hbWVdOwogICAgICAgIG1hdGVyaWFsLnVuaWZvcm1zW25hbWVdID0ge307CiAgICAgICAgc3dpdGNoICh1bmlmb3JtLnR5cGUpIHsKICAgICAgICAgIGNhc2UgInQiOgogICAgICAgICAgICBtYXRlcmlhbC51bmlmb3Jtc1tuYW1lXS52YWx1ZSA9IGdldFRleHR1cmUodW5pZm9ybS52YWx1ZSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiYyI6CiAgICAgICAgICAgIG1hdGVyaWFsLnVuaWZvcm1zW25hbWVdLnZhbHVlID0gbmV3IENvbG9yKCkuc2V0SGV4KHVuaWZvcm0udmFsdWUpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgInYyIjoKICAgICAgICAgICAgbWF0ZXJpYWwudW5pZm9ybXNbbmFtZV0udmFsdWUgPSBuZXcgVmVjdG9yMigpLmZyb21BcnJheSh1bmlmb3JtLnZhbHVlKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJ2MyI6CiAgICAgICAgICAgIG1hdGVyaWFsLnVuaWZvcm1zW25hbWVdLnZhbHVlID0gbmV3IFZlY3RvcjMoKS5mcm9tQXJyYXkodW5pZm9ybS52YWx1ZSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAidjQiOgogICAgICAgICAgICBtYXRlcmlhbC51bmlmb3Jtc1tuYW1lXS52YWx1ZSA9IG5ldyBWZWN0b3I0KCkuZnJvbUFycmF5KHVuaWZvcm0udmFsdWUpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgIm0zIjoKICAgICAgICAgICAgbWF0ZXJpYWwudW5pZm9ybXNbbmFtZV0udmFsdWUgPSBuZXcgTWF0cml4MygpLmZyb21BcnJheSh1bmlmb3JtLnZhbHVlKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJtNCI6CiAgICAgICAgICAgIG1hdGVyaWFsLnVuaWZvcm1zW25hbWVdLnZhbHVlID0gbmV3IE1hdHJpeDQoKS5mcm9tQXJyYXkodW5pZm9ybS52YWx1ZSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgbWF0ZXJpYWwudW5pZm9ybXNbbmFtZV0udmFsdWUgPSB1bmlmb3JtLnZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgaWYgKGpzb24uZGVmaW5lcyAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5kZWZpbmVzID0ganNvbi5kZWZpbmVzOwogICAgaWYgKGpzb24udmVydGV4U2hhZGVyICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnZlcnRleFNoYWRlciA9IGpzb24udmVydGV4U2hhZGVyOwogICAgaWYgKGpzb24uZnJhZ21lbnRTaGFkZXIgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuZnJhZ21lbnRTaGFkZXIgPSBqc29uLmZyYWdtZW50U2hhZGVyOwogICAgaWYgKGpzb24uZXh0ZW5zaW9ucyAhPT0gdm9pZCAwKSB7CiAgICAgIGZvciAoY29uc3Qga2V5IGluIGpzb24uZXh0ZW5zaW9ucykgewogICAgICAgIG1hdGVyaWFsLmV4dGVuc2lvbnNba2V5XSA9IGpzb24uZXh0ZW5zaW9uc1trZXldOwogICAgICB9CiAgICB9CiAgICBpZiAoanNvbi5zaGFkaW5nICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmZsYXRTaGFkaW5nID0ganNvbi5zaGFkaW5nID09PSAxOwogICAgaWYgKGpzb24uc2l6ZSAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5zaXplID0ganNvbi5zaXplOwogICAgaWYgKGpzb24uc2l6ZUF0dGVudWF0aW9uICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnNpemVBdHRlbnVhdGlvbiA9IGpzb24uc2l6ZUF0dGVudWF0aW9uOwogICAgaWYgKGpzb24ubWFwICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLm1hcCA9IGdldFRleHR1cmUoanNvbi5tYXApOwogICAgaWYgKGpzb24ubWF0Y2FwICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLm1hdGNhcCA9IGdldFRleHR1cmUoanNvbi5tYXRjYXApOwogICAgaWYgKGpzb24uYWxwaGFNYXAgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuYWxwaGFNYXAgPSBnZXRUZXh0dXJlKGpzb24uYWxwaGFNYXApOwogICAgaWYgKGpzb24uYnVtcE1hcCAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5idW1wTWFwID0gZ2V0VGV4dHVyZShqc29uLmJ1bXBNYXApOwogICAgaWYgKGpzb24uYnVtcFNjYWxlICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmJ1bXBTY2FsZSA9IGpzb24uYnVtcFNjYWxlOwogICAgaWYgKGpzb24ubm9ybWFsTWFwICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLm5vcm1hbE1hcCA9IGdldFRleHR1cmUoanNvbi5ub3JtYWxNYXApOwogICAgaWYgKGpzb24ubm9ybWFsTWFwVHlwZSAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5ub3JtYWxNYXBUeXBlID0ganNvbi5ub3JtYWxNYXBUeXBlOwogICAgaWYgKGpzb24ubm9ybWFsU2NhbGUgIT09IHZvaWQgMCkgewogICAgICBsZXQgbm9ybWFsU2NhbGUgPSBqc29uLm5vcm1hbFNjYWxlOwogICAgICBpZiAoQXJyYXkuaXNBcnJheShub3JtYWxTY2FsZSkgPT09IGZhbHNlKSB7CiAgICAgICAgbm9ybWFsU2NhbGUgPSBbbm9ybWFsU2NhbGUsIG5vcm1hbFNjYWxlXTsKICAgICAgfQogICAgICBtYXRlcmlhbC5ub3JtYWxTY2FsZSA9IG5ldyBWZWN0b3IyKCkuZnJvbUFycmF5KG5vcm1hbFNjYWxlKTsKICAgIH0KICAgIGlmIChqc29uLmRpc3BsYWNlbWVudE1hcCAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5kaXNwbGFjZW1lbnRNYXAgPSBnZXRUZXh0dXJlKGpzb24uZGlzcGxhY2VtZW50TWFwKTsKICAgIGlmIChqc29uLmRpc3BsYWNlbWVudFNjYWxlICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmRpc3BsYWNlbWVudFNjYWxlID0ganNvbi5kaXNwbGFjZW1lbnRTY2FsZTsKICAgIGlmIChqc29uLmRpc3BsYWNlbWVudEJpYXMgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuZGlzcGxhY2VtZW50QmlhcyA9IGpzb24uZGlzcGxhY2VtZW50QmlhczsKICAgIGlmIChqc29uLnJvdWdobmVzc01hcCAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5yb3VnaG5lc3NNYXAgPSBnZXRUZXh0dXJlKGpzb24ucm91Z2huZXNzTWFwKTsKICAgIGlmIChqc29uLm1ldGFsbmVzc01hcCAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5tZXRhbG5lc3NNYXAgPSBnZXRUZXh0dXJlKGpzb24ubWV0YWxuZXNzTWFwKTsKICAgIGlmIChqc29uLmVtaXNzaXZlTWFwICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmVtaXNzaXZlTWFwID0gZ2V0VGV4dHVyZShqc29uLmVtaXNzaXZlTWFwKTsKICAgIGlmIChqc29uLmVtaXNzaXZlSW50ZW5zaXR5ICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmVtaXNzaXZlSW50ZW5zaXR5ID0ganNvbi5lbWlzc2l2ZUludGVuc2l0eTsKICAgIGlmIChqc29uLnNwZWN1bGFyTWFwICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnNwZWN1bGFyTWFwID0gZ2V0VGV4dHVyZShqc29uLnNwZWN1bGFyTWFwKTsKICAgIGlmIChqc29uLnNwZWN1bGFySW50ZW5zaXR5TWFwICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnNwZWN1bGFySW50ZW5zaXR5TWFwID0gZ2V0VGV4dHVyZShqc29uLnNwZWN1bGFySW50ZW5zaXR5TWFwKTsKICAgIGlmIChqc29uLnNwZWN1bGFyQ29sb3JNYXAgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwuc3BlY3VsYXJDb2xvck1hcCA9IGdldFRleHR1cmUoanNvbi5zcGVjdWxhckNvbG9yTWFwKTsKICAgIGlmIChqc29uLmVudk1hcCAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5lbnZNYXAgPSBnZXRUZXh0dXJlKGpzb24uZW52TWFwKTsKICAgIGlmIChqc29uLmVudk1hcEludGVuc2l0eSAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5lbnZNYXBJbnRlbnNpdHkgPSBqc29uLmVudk1hcEludGVuc2l0eTsKICAgIGlmIChqc29uLnJlZmxlY3Rpdml0eSAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5yZWZsZWN0aXZpdHkgPSBqc29uLnJlZmxlY3Rpdml0eTsKICAgIGlmIChqc29uLnJlZnJhY3Rpb25SYXRpbyAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5yZWZyYWN0aW9uUmF0aW8gPSBqc29uLnJlZnJhY3Rpb25SYXRpbzsKICAgIGlmIChqc29uLmxpZ2h0TWFwICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmxpZ2h0TWFwID0gZ2V0VGV4dHVyZShqc29uLmxpZ2h0TWFwKTsKICAgIGlmIChqc29uLmxpZ2h0TWFwSW50ZW5zaXR5ICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmxpZ2h0TWFwSW50ZW5zaXR5ID0ganNvbi5saWdodE1hcEludGVuc2l0eTsKICAgIGlmIChqc29uLmFvTWFwICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmFvTWFwID0gZ2V0VGV4dHVyZShqc29uLmFvTWFwKTsKICAgIGlmIChqc29uLmFvTWFwSW50ZW5zaXR5ICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmFvTWFwSW50ZW5zaXR5ID0ganNvbi5hb01hcEludGVuc2l0eTsKICAgIGlmIChqc29uLmdyYWRpZW50TWFwICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmdyYWRpZW50TWFwID0gZ2V0VGV4dHVyZShqc29uLmdyYWRpZW50TWFwKTsKICAgIGlmIChqc29uLmNsZWFyY29hdE1hcCAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5jbGVhcmNvYXRNYXAgPSBnZXRUZXh0dXJlKGpzb24uY2xlYXJjb2F0TWFwKTsKICAgIGlmIChqc29uLmNsZWFyY29hdFJvdWdobmVzc01hcCAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5jbGVhcmNvYXRSb3VnaG5lc3NNYXAgPSBnZXRUZXh0dXJlKGpzb24uY2xlYXJjb2F0Um91Z2huZXNzTWFwKTsKICAgIGlmIChqc29uLmNsZWFyY29hdE5vcm1hbE1hcCAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5jbGVhcmNvYXROb3JtYWxNYXAgPSBnZXRUZXh0dXJlKGpzb24uY2xlYXJjb2F0Tm9ybWFsTWFwKTsKICAgIGlmIChqc29uLmNsZWFyY29hdE5vcm1hbFNjYWxlICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLmNsZWFyY29hdE5vcm1hbFNjYWxlID0gbmV3IFZlY3RvcjIoKS5mcm9tQXJyYXkoanNvbi5jbGVhcmNvYXROb3JtYWxTY2FsZSk7CiAgICBpZiAoanNvbi50cmFuc21pc3Npb25NYXAgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwudHJhbnNtaXNzaW9uTWFwID0gZ2V0VGV4dHVyZShqc29uLnRyYW5zbWlzc2lvbk1hcCk7CiAgICBpZiAoanNvbi50aGlja25lc3NNYXAgIT09IHZvaWQgMCkKICAgICAgbWF0ZXJpYWwudGhpY2tuZXNzTWFwID0gZ2V0VGV4dHVyZShqc29uLnRoaWNrbmVzc01hcCk7CiAgICBpZiAoanNvbi5zaGVlbkNvbG9yTWFwICE9PSB2b2lkIDApCiAgICAgIG1hdGVyaWFsLnNoZWVuQ29sb3JNYXAgPSBnZXRUZXh0dXJlKGpzb24uc2hlZW5Db2xvck1hcCk7CiAgICBpZiAoanNvbi5zaGVlblJvdWdobmVzc01hcCAhPT0gdm9pZCAwKQogICAgICBtYXRlcmlhbC5zaGVlblJvdWdobmVzc01hcCA9IGdldFRleHR1cmUoanNvbi5zaGVlblJvdWdobmVzc01hcCk7CiAgICByZXR1cm4gbWF0ZXJpYWw7CiAgfQogIHNldFRleHR1cmVzKHZhbHVlKSB7CiAgICB0aGlzLnRleHR1cmVzID0gdmFsdWU7CiAgICByZXR1cm4gdGhpczsKICB9Cn0KY2xhc3MgTG9hZGVyVXRpbHMgewogIHN0YXRpYyBkZWNvZGVUZXh0KGFycmF5KSB7CiAgICBpZiAodHlwZW9mIFRleHREZWNvZGVyICE9PSAidW5kZWZpbmVkIikgewogICAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGFycmF5KTsKICAgIH0KICAgIGxldCBzID0gIiI7CiAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBhcnJheS5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgIHMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShhcnJheVtpXSk7CiAgICB9CiAgICB0cnkgewogICAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGVzY2FwZShzKSk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIHJldHVybiBzOwogICAgfQogIH0KICBzdGF0aWMgZXh0cmFjdFVybEJhc2UodXJsKSB7CiAgICBjb25zdCBpbmRleCA9IHVybC5sYXN0SW5kZXhPZigiLyIpOwogICAgaWYgKGluZGV4ID09PSAtMSkKICAgICAgcmV0dXJuICIuLyI7CiAgICByZXR1cm4gdXJsLnN1YnN0cigwLCBpbmRleCArIDEpOwogIH0KICBzdGF0aWMgcmVzb2x2ZVVSTCh1cmwsIHBhdGgpIHsKICAgIGlmICh0eXBlb2YgdXJsICE9PSAic3RyaW5nIiB8fCB1cmwgPT09ICIiKQogICAgICByZXR1cm4gIiI7CiAgICBpZiAoL15odHRwcz86XC9cLy9pLnRlc3QocGF0aCkgJiYgL15cLy8udGVzdCh1cmwpKSB7CiAgICAgIHBhdGggPSBwYXRoLnJlcGxhY2UoLyheaHR0cHM/OlwvXC9bXlwvXSspLiovaSwgIiQxIik7CiAgICB9CiAgICBpZiAoL14oaHR0cHM/Oik/XC9cLy9pLnRlc3QodXJsKSkKICAgICAgcmV0dXJuIHVybDsKICAgIGlmICgvXmRhdGE6LiosLiokL2kudGVzdCh1cmwpKQogICAgICByZXR1cm4gdXJsOwogICAgaWYgKC9eYmxvYjouKiQvaS50ZXN0KHVybCkpCiAgICAgIHJldHVybiB1cmw7CiAgICByZXR1cm4gcGF0aCArIHVybDsKICB9Cn0KY2xhc3MgSW5zdGFuY2VkQnVmZmVyR2VvbWV0cnkgZXh0ZW5kcyBCdWZmZXJHZW9tZXRyeSB7CiAgY29uc3RydWN0b3IoKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkluc3RhbmNlZEJ1ZmZlckdlb21ldHJ5IjsKICAgIHRoaXMuaW5zdGFuY2VDb3VudCA9IEluZmluaXR5OwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgc3VwZXIuY29weShzb3VyY2UpOwogICAgdGhpcy5pbnN0YW5jZUNvdW50ID0gc291cmNlLmluc3RhbmNlQ291bnQ7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xvbmUoKSB7CiAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoKS5jb3B5KHRoaXMpOwogIH0KICB0b0pTT04oKSB7CiAgICBjb25zdCBkYXRhID0gc3VwZXIudG9KU09OKHRoaXMpOwogICAgZGF0YS5pbnN0YW5jZUNvdW50ID0gdGhpcy5pbnN0YW5jZUNvdW50OwogICAgZGF0YS5pc0luc3RhbmNlZEJ1ZmZlckdlb21ldHJ5ID0gdHJ1ZTsKICAgIHJldHVybiBkYXRhOwogIH0KfQpJbnN0YW5jZWRCdWZmZXJHZW9tZXRyeS5wcm90b3R5cGUuaXNJbnN0YW5jZWRCdWZmZXJHZW9tZXRyeSA9IHRydWU7CmNsYXNzIEJ1ZmZlckdlb21ldHJ5TG9hZGVyIGV4dGVuZHMgTG9hZGVyIHsKICBjb25zdHJ1Y3RvcihtYW5hZ2VyKSB7CiAgICBzdXBlcihtYW5hZ2VyKTsKICB9CiAgbG9hZCh1cmwsIG9uTG9hZCwgb25Qcm9ncmVzcywgb25FcnJvcikgewogICAgY29uc3Qgc2NvcGUgPSB0aGlzOwogICAgY29uc3QgbG9hZGVyID0gbmV3IEZpbGVMb2FkZXIoc2NvcGUubWFuYWdlcik7CiAgICBsb2FkZXIuc2V0UGF0aChzY29wZS5wYXRoKTsKICAgIGxvYWRlci5zZXRSZXF1ZXN0SGVhZGVyKHNjb3BlLnJlcXVlc3RIZWFkZXIpOwogICAgbG9hZGVyLnNldFdpdGhDcmVkZW50aWFscyhzY29wZS53aXRoQ3JlZGVudGlhbHMpOwogICAgbG9hZGVyLmxvYWQodXJsLCBmdW5jdGlvbih0ZXh0KSB7CiAgICAgIHRyeSB7CiAgICAgICAgb25Mb2FkKHNjb3BlLnBhcnNlKEpTT04ucGFyc2UodGV4dCkpKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGlmIChvbkVycm9yKSB7CiAgICAgICAgICBvbkVycm9yKGUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgIH0KICAgICAgICBzY29wZS5tYW5hZ2VyLml0ZW1FcnJvcih1cmwpOwogICAgICB9CiAgICB9LCBvblByb2dyZXNzLCBvbkVycm9yKTsKICB9CiAgcGFyc2UoanNvbikgewogICAgY29uc3QgaW50ZXJsZWF2ZWRCdWZmZXJNYXAgPSB7fTsKICAgIGNvbnN0IGFycmF5QnVmZmVyTWFwID0ge307CiAgICBmdW5jdGlvbiBnZXRJbnRlcmxlYXZlZEJ1ZmZlcihqc29uMiwgdXVpZCkgewogICAgICBpZiAoaW50ZXJsZWF2ZWRCdWZmZXJNYXBbdXVpZF0gIT09IHZvaWQgMCkKICAgICAgICByZXR1cm4gaW50ZXJsZWF2ZWRCdWZmZXJNYXBbdXVpZF07CiAgICAgIGNvbnN0IGludGVybGVhdmVkQnVmZmVycyA9IGpzb24yLmludGVybGVhdmVkQnVmZmVyczsKICAgICAgY29uc3QgaW50ZXJsZWF2ZWRCdWZmZXIgPSBpbnRlcmxlYXZlZEJ1ZmZlcnNbdXVpZF07CiAgICAgIGNvbnN0IGJ1ZmZlciA9IGdldEFycmF5QnVmZmVyKGpzb24yLCBpbnRlcmxlYXZlZEJ1ZmZlci5idWZmZXIpOwogICAgICBjb25zdCBhcnJheSA9IGdldFR5cGVkQXJyYXkoaW50ZXJsZWF2ZWRCdWZmZXIudHlwZSwgYnVmZmVyKTsKICAgICAgY29uc3QgaWIgPSBuZXcgSW50ZXJsZWF2ZWRCdWZmZXIoYXJyYXksIGludGVybGVhdmVkQnVmZmVyLnN0cmlkZSk7CiAgICAgIGliLnV1aWQgPSBpbnRlcmxlYXZlZEJ1ZmZlci51dWlkOwogICAgICBpbnRlcmxlYXZlZEJ1ZmZlck1hcFt1dWlkXSA9IGliOwogICAgICByZXR1cm4gaWI7CiAgICB9CiAgICBmdW5jdGlvbiBnZXRBcnJheUJ1ZmZlcihqc29uMiwgdXVpZCkgewogICAgICBpZiAoYXJyYXlCdWZmZXJNYXBbdXVpZF0gIT09IHZvaWQgMCkKICAgICAgICByZXR1cm4gYXJyYXlCdWZmZXJNYXBbdXVpZF07CiAgICAgIGNvbnN0IGFycmF5QnVmZmVycyA9IGpzb24yLmFycmF5QnVmZmVyczsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhcnJheUJ1ZmZlcnNbdXVpZF07CiAgICAgIGNvbnN0IGFiID0gbmV3IFVpbnQzMkFycmF5KGFycmF5QnVmZmVyKS5idWZmZXI7CiAgICAgIGFycmF5QnVmZmVyTWFwW3V1aWRdID0gYWI7CiAgICAgIHJldHVybiBhYjsKICAgIH0KICAgIGNvbnN0IGdlb21ldHJ5ID0ganNvbi5pc0luc3RhbmNlZEJ1ZmZlckdlb21ldHJ5ID8gbmV3IEluc3RhbmNlZEJ1ZmZlckdlb21ldHJ5KCkgOiBuZXcgQnVmZmVyR2VvbWV0cnkoKTsKICAgIGNvbnN0IGluZGV4ID0ganNvbi5kYXRhLmluZGV4OwogICAgaWYgKGluZGV4ICE9PSB2b2lkIDApIHsKICAgICAgY29uc3QgdHlwZWRBcnJheSA9IGdldFR5cGVkQXJyYXkoaW5kZXgudHlwZSwgaW5kZXguYXJyYXkpOwogICAgICBnZW9tZXRyeS5zZXRJbmRleChuZXcgQnVmZmVyQXR0cmlidXRlKHR5cGVkQXJyYXksIDEpKTsKICAgIH0KICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBqc29uLmRhdGEuYXR0cmlidXRlczsKICAgIGZvciAoY29uc3Qga2V5IGluIGF0dHJpYnV0ZXMpIHsKICAgICAgY29uc3QgYXR0cmlidXRlID0gYXR0cmlidXRlc1trZXldOwogICAgICBsZXQgYnVmZmVyQXR0cmlidXRlOwogICAgICBpZiAoYXR0cmlidXRlLmlzSW50ZXJsZWF2ZWRCdWZmZXJBdHRyaWJ1dGUpIHsKICAgICAgICBjb25zdCBpbnRlcmxlYXZlZEJ1ZmZlciA9IGdldEludGVybGVhdmVkQnVmZmVyKGpzb24uZGF0YSwgYXR0cmlidXRlLmRhdGEpOwogICAgICAgIGJ1ZmZlckF0dHJpYnV0ZSA9IG5ldyBJbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZShpbnRlcmxlYXZlZEJ1ZmZlciwgYXR0cmlidXRlLml0ZW1TaXplLCBhdHRyaWJ1dGUub2Zmc2V0LCBhdHRyaWJ1dGUubm9ybWFsaXplZCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgdHlwZWRBcnJheSA9IGdldFR5cGVkQXJyYXkoYXR0cmlidXRlLnR5cGUsIGF0dHJpYnV0ZS5hcnJheSk7CiAgICAgICAgY29uc3QgYnVmZmVyQXR0cmlidXRlQ29uc3RyID0gYXR0cmlidXRlLmlzSW5zdGFuY2VkQnVmZmVyQXR0cmlidXRlID8gSW5zdGFuY2VkQnVmZmVyQXR0cmlidXRlIDogQnVmZmVyQXR0cmlidXRlOwogICAgICAgIGJ1ZmZlckF0dHJpYnV0ZSA9IG5ldyBidWZmZXJBdHRyaWJ1dGVDb25zdHIodHlwZWRBcnJheSwgYXR0cmlidXRlLml0ZW1TaXplLCBhdHRyaWJ1dGUubm9ybWFsaXplZCk7CiAgICAgIH0KICAgICAgaWYgKGF0dHJpYnV0ZS5uYW1lICE9PSB2b2lkIDApCiAgICAgICAgYnVmZmVyQXR0cmlidXRlLm5hbWUgPSBhdHRyaWJ1dGUubmFtZTsKICAgICAgaWYgKGF0dHJpYnV0ZS51c2FnZSAhPT0gdm9pZCAwKQogICAgICAgIGJ1ZmZlckF0dHJpYnV0ZS5zZXRVc2FnZShhdHRyaWJ1dGUudXNhZ2UpOwogICAgICBpZiAoYXR0cmlidXRlLnVwZGF0ZVJhbmdlICE9PSB2b2lkIDApIHsKICAgICAgICBidWZmZXJBdHRyaWJ1dGUudXBkYXRlUmFuZ2Uub2Zmc2V0ID0gYXR0cmlidXRlLnVwZGF0ZVJhbmdlLm9mZnNldDsKICAgICAgICBidWZmZXJBdHRyaWJ1dGUudXBkYXRlUmFuZ2UuY291bnQgPSBhdHRyaWJ1dGUudXBkYXRlUmFuZ2UuY291bnQ7CiAgICAgIH0KICAgICAgZ2VvbWV0cnkuc2V0QXR0cmlidXRlKGtleSwgYnVmZmVyQXR0cmlidXRlKTsKICAgIH0KICAgIGNvbnN0IG1vcnBoQXR0cmlidXRlcyA9IGpzb24uZGF0YS5tb3JwaEF0dHJpYnV0ZXM7CiAgICBpZiAobW9ycGhBdHRyaWJ1dGVzKSB7CiAgICAgIGZvciAoY29uc3Qga2V5IGluIG1vcnBoQXR0cmlidXRlcykgewogICAgICAgIGNvbnN0IGF0dHJpYnV0ZUFycmF5ID0gbW9ycGhBdHRyaWJ1dGVzW2tleV07CiAgICAgICAgY29uc3QgYXJyYXkgPSBbXTsKICAgICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBhdHRyaWJ1dGVBcnJheS5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgICAgICBjb25zdCBhdHRyaWJ1dGUgPSBhdHRyaWJ1dGVBcnJheVtpXTsKICAgICAgICAgIGxldCBidWZmZXJBdHRyaWJ1dGU7CiAgICAgICAgICBpZiAoYXR0cmlidXRlLmlzSW50ZXJsZWF2ZWRCdWZmZXJBdHRyaWJ1dGUpIHsKICAgICAgICAgICAgY29uc3QgaW50ZXJsZWF2ZWRCdWZmZXIgPSBnZXRJbnRlcmxlYXZlZEJ1ZmZlcihqc29uLmRhdGEsIGF0dHJpYnV0ZS5kYXRhKTsKICAgICAgICAgICAgYnVmZmVyQXR0cmlidXRlID0gbmV3IEludGVybGVhdmVkQnVmZmVyQXR0cmlidXRlKGludGVybGVhdmVkQnVmZmVyLCBhdHRyaWJ1dGUuaXRlbVNpemUsIGF0dHJpYnV0ZS5vZmZzZXQsIGF0dHJpYnV0ZS5ub3JtYWxpemVkKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IHR5cGVkQXJyYXkgPSBnZXRUeXBlZEFycmF5KGF0dHJpYnV0ZS50eXBlLCBhdHRyaWJ1dGUuYXJyYXkpOwogICAgICAgICAgICBidWZmZXJBdHRyaWJ1dGUgPSBuZXcgQnVmZmVyQXR0cmlidXRlKHR5cGVkQXJyYXksIGF0dHJpYnV0ZS5pdGVtU2l6ZSwgYXR0cmlidXRlLm5vcm1hbGl6ZWQpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGF0dHJpYnV0ZS5uYW1lICE9PSB2b2lkIDApCiAgICAgICAgICAgIGJ1ZmZlckF0dHJpYnV0ZS5uYW1lID0gYXR0cmlidXRlLm5hbWU7CiAgICAgICAgICBhcnJheS5wdXNoKGJ1ZmZlckF0dHJpYnV0ZSk7CiAgICAgICAgfQogICAgICAgIGdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlc1trZXldID0gYXJyYXk7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IG1vcnBoVGFyZ2V0c1JlbGF0aXZlID0ganNvbi5kYXRhLm1vcnBoVGFyZ2V0c1JlbGF0aXZlOwogICAgaWYgKG1vcnBoVGFyZ2V0c1JlbGF0aXZlKSB7CiAgICAgIGdlb21ldHJ5Lm1vcnBoVGFyZ2V0c1JlbGF0aXZlID0gdHJ1ZTsKICAgIH0KICAgIGNvbnN0IGdyb3VwcyA9IGpzb24uZGF0YS5ncm91cHMgfHwganNvbi5kYXRhLmRyYXdjYWxscyB8fCBqc29uLmRhdGEub2Zmc2V0czsKICAgIGlmIChncm91cHMgIT09IHZvaWQgMCkgewogICAgICBmb3IgKGxldCBpID0gMCwgbiA9IGdyb3Vwcy5sZW5ndGg7IGkgIT09IG47ICsraSkgewogICAgICAgIGNvbnN0IGdyb3VwID0gZ3JvdXBzW2ldOwogICAgICAgIGdlb21ldHJ5LmFkZEdyb3VwKGdyb3VwLnN0YXJ0LCBncm91cC5jb3VudCwgZ3JvdXAubWF0ZXJpYWxJbmRleCk7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IGJvdW5kaW5nU3BoZXJlID0ganNvbi5kYXRhLmJvdW5kaW5nU3BoZXJlOwogICAgaWYgKGJvdW5kaW5nU3BoZXJlICE9PSB2b2lkIDApIHsKICAgICAgY29uc3QgY2VudGVyID0gbmV3IFZlY3RvcjMoKTsKICAgICAgaWYgKGJvdW5kaW5nU3BoZXJlLmNlbnRlciAhPT0gdm9pZCAwKSB7CiAgICAgICAgY2VudGVyLmZyb21BcnJheShib3VuZGluZ1NwaGVyZS5jZW50ZXIpOwogICAgICB9CiAgICAgIGdlb21ldHJ5LmJvdW5kaW5nU3BoZXJlID0gbmV3IFNwaGVyZShjZW50ZXIsIGJvdW5kaW5nU3BoZXJlLnJhZGl1cyk7CiAgICB9CiAgICBpZiAoanNvbi5uYW1lKQogICAgICBnZW9tZXRyeS5uYW1lID0ganNvbi5uYW1lOwogICAgaWYgKGpzb24udXNlckRhdGEpCiAgICAgIGdlb21ldHJ5LnVzZXJEYXRhID0ganNvbi51c2VyRGF0YTsKICAgIHJldHVybiBnZW9tZXRyeTsKICB9Cn0KY2xhc3MgT2JqZWN0TG9hZGVyIGV4dGVuZHMgTG9hZGVyIHsKICBjb25zdHJ1Y3RvcihtYW5hZ2VyKSB7CiAgICBzdXBlcihtYW5hZ2VyKTsKICB9CiAgbG9hZCh1cmwsIG9uTG9hZCwgb25Qcm9ncmVzcywgb25FcnJvcikgewogICAgY29uc3Qgc2NvcGUgPSB0aGlzOwogICAgY29uc3QgcGF0aCA9IHRoaXMucGF0aCA9PT0gIiIgPyBMb2FkZXJVdGlscy5leHRyYWN0VXJsQmFzZSh1cmwpIDogdGhpcy5wYXRoOwogICAgdGhpcy5yZXNvdXJjZVBhdGggPSB0aGlzLnJlc291cmNlUGF0aCB8fCBwYXRoOwogICAgY29uc3QgbG9hZGVyID0gbmV3IEZpbGVMb2FkZXIodGhpcy5tYW5hZ2VyKTsKICAgIGxvYWRlci5zZXRQYXRoKHRoaXMucGF0aCk7CiAgICBsb2FkZXIuc2V0UmVxdWVzdEhlYWRlcih0aGlzLnJlcXVlc3RIZWFkZXIpOwogICAgbG9hZGVyLnNldFdpdGhDcmVkZW50aWFscyh0aGlzLndpdGhDcmVkZW50aWFscyk7CiAgICBsb2FkZXIubG9hZCh1cmwsIGZ1bmN0aW9uKHRleHQpIHsKICAgICAgbGV0IGpzb24gPSBudWxsOwogICAgICB0cnkgewogICAgICAgIGpzb24gPSBKU09OLnBhcnNlKHRleHQpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGlmIChvbkVycm9yICE9PSB2b2lkIDApCiAgICAgICAgICBvbkVycm9yKGVycm9yKTsKICAgICAgICBjb25zb2xlLmVycm9yKCJUSFJFRTpPYmplY3RMb2FkZXI6IENhbid0IHBhcnNlICIgKyB1cmwgKyAiLiIsIGVycm9yLm1lc3NhZ2UpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBjb25zdCBtZXRhZGF0YSA9IGpzb24ubWV0YWRhdGE7CiAgICAgIGlmIChtZXRhZGF0YSA9PT0gdm9pZCAwIHx8IG1ldGFkYXRhLnR5cGUgPT09IHZvaWQgMCB8fCBtZXRhZGF0YS50eXBlLnRvTG93ZXJDYXNlKCkgPT09ICJnZW9tZXRyeSIpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5PYmplY3RMb2FkZXI6IENhbid0IGxvYWQgIiArIHVybCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHNjb3BlLnBhcnNlKGpzb24sIG9uTG9hZCk7CiAgICB9LCBvblByb2dyZXNzLCBvbkVycm9yKTsKICB9CiAgbG9hZEFzeW5jKHVybCwgb25Qcm9ncmVzcykgewogICAgcmV0dXJuIF9fYXN5bmModGhpcywgbnVsbCwgZnVuY3Rpb24qICgpIHsKICAgICAgY29uc3Qgc2NvcGUgPSB0aGlzOwogICAgICBjb25zdCBwYXRoID0gdGhpcy5wYXRoID09PSAiIiA/IExvYWRlclV0aWxzLmV4dHJhY3RVcmxCYXNlKHVybCkgOiB0aGlzLnBhdGg7CiAgICAgIHRoaXMucmVzb3VyY2VQYXRoID0gdGhpcy5yZXNvdXJjZVBhdGggfHwgcGF0aDsKICAgICAgY29uc3QgbG9hZGVyID0gbmV3IEZpbGVMb2FkZXIodGhpcy5tYW5hZ2VyKTsKICAgICAgbG9hZGVyLnNldFBhdGgodGhpcy5wYXRoKTsKICAgICAgbG9hZGVyLnNldFJlcXVlc3RIZWFkZXIodGhpcy5yZXF1ZXN0SGVhZGVyKTsKICAgICAgbG9hZGVyLnNldFdpdGhDcmVkZW50aWFscyh0aGlzLndpdGhDcmVkZW50aWFscyk7CiAgICAgIGNvbnN0IHRleHQgPSB5aWVsZCBsb2FkZXIubG9hZEFzeW5jKHVybCwgb25Qcm9ncmVzcyk7CiAgICAgIGNvbnN0IGpzb24gPSBKU09OLnBhcnNlKHRleHQpOwogICAgICBjb25zdCBtZXRhZGF0YSA9IGpzb24ubWV0YWRhdGE7CiAgICAgIGlmIChtZXRhZGF0YSA9PT0gdm9pZCAwIHx8IG1ldGFkYXRhLnR5cGUgPT09IHZvaWQgMCB8fCBtZXRhZGF0YS50eXBlLnRvTG93ZXJDYXNlKCkgPT09ICJnZW9tZXRyeSIpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlRIUkVFLk9iamVjdExvYWRlcjogQ2FuJ3QgbG9hZCAiICsgdXJsKTsKICAgICAgfQogICAgICByZXR1cm4geWllbGQgc2NvcGUucGFyc2VBc3luYyhqc29uKTsKICAgIH0pOwogIH0KICBwYXJzZShqc29uLCBvbkxvYWQpIHsKICAgIGNvbnN0IGFuaW1hdGlvbnMgPSB0aGlzLnBhcnNlQW5pbWF0aW9ucyhqc29uLmFuaW1hdGlvbnMpOwogICAgY29uc3Qgc2hhcGVzID0gdGhpcy5wYXJzZVNoYXBlcyhqc29uLnNoYXBlcyk7CiAgICBjb25zdCBnZW9tZXRyaWVzID0gdGhpcy5wYXJzZUdlb21ldHJpZXMoanNvbi5nZW9tZXRyaWVzLCBzaGFwZXMpOwogICAgY29uc3QgaW1hZ2VzID0gdGhpcy5wYXJzZUltYWdlcyhqc29uLmltYWdlcywgZnVuY3Rpb24oKSB7CiAgICAgIGlmIChvbkxvYWQgIT09IHZvaWQgMCkKICAgICAgICBvbkxvYWQob2JqZWN0KTsKICAgIH0pOwogICAgY29uc3QgdGV4dHVyZXMgPSB0aGlzLnBhcnNlVGV4dHVyZXMoanNvbi50ZXh0dXJlcywgaW1hZ2VzKTsKICAgIGNvbnN0IG1hdGVyaWFscyA9IHRoaXMucGFyc2VNYXRlcmlhbHMoanNvbi5tYXRlcmlhbHMsIHRleHR1cmVzKTsKICAgIGNvbnN0IG9iamVjdCA9IHRoaXMucGFyc2VPYmplY3QoanNvbi5vYmplY3QsIGdlb21ldHJpZXMsIG1hdGVyaWFscywgdGV4dHVyZXMsIGFuaW1hdGlvbnMpOwogICAgY29uc3Qgc2tlbGV0b25zID0gdGhpcy5wYXJzZVNrZWxldG9ucyhqc29uLnNrZWxldG9ucywgb2JqZWN0KTsKICAgIHRoaXMuYmluZFNrZWxldG9ucyhvYmplY3QsIHNrZWxldG9ucyk7CiAgICBpZiAob25Mb2FkICE9PSB2b2lkIDApIHsKICAgICAgbGV0IGhhc0ltYWdlcyA9IGZhbHNlOwogICAgICBmb3IgKGNvbnN0IHV1aWQgaW4gaW1hZ2VzKSB7CiAgICAgICAgaWYgKGltYWdlc1t1dWlkXSBpbnN0YW5jZW9mIEhUTUxJbWFnZUVsZW1lbnQpIHsKICAgICAgICAgIGhhc0ltYWdlcyA9IHRydWU7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGhhc0ltYWdlcyA9PT0gZmFsc2UpCiAgICAgICAgb25Mb2FkKG9iamVjdCk7CiAgICB9CiAgICByZXR1cm4gb2JqZWN0OwogIH0KICBwYXJzZUFzeW5jKGpzb24pIHsKICAgIHJldHVybiBfX2FzeW5jKHRoaXMsIG51bGwsIGZ1bmN0aW9uKiAoKSB7CiAgICAgIGNvbnN0IGFuaW1hdGlvbnMgPSB0aGlzLnBhcnNlQW5pbWF0aW9ucyhqc29uLmFuaW1hdGlvbnMpOwogICAgICBjb25zdCBzaGFwZXMgPSB0aGlzLnBhcnNlU2hhcGVzKGpzb24uc2hhcGVzKTsKICAgICAgY29uc3QgZ2VvbWV0cmllcyA9IHRoaXMucGFyc2VHZW9tZXRyaWVzKGpzb24uZ2VvbWV0cmllcywgc2hhcGVzKTsKICAgICAgY29uc3QgaW1hZ2VzID0geWllbGQgdGhpcy5wYXJzZUltYWdlc0FzeW5jKGpzb24uaW1hZ2VzKTsKICAgICAgY29uc3QgdGV4dHVyZXMgPSB0aGlzLnBhcnNlVGV4dHVyZXMoanNvbi50ZXh0dXJlcywgaW1hZ2VzKTsKICAgICAgY29uc3QgbWF0ZXJpYWxzID0gdGhpcy5wYXJzZU1hdGVyaWFscyhqc29uLm1hdGVyaWFscywgdGV4dHVyZXMpOwogICAgICBjb25zdCBvYmplY3QgPSB0aGlzLnBhcnNlT2JqZWN0KGpzb24ub2JqZWN0LCBnZW9tZXRyaWVzLCBtYXRlcmlhbHMsIHRleHR1cmVzLCBhbmltYXRpb25zKTsKICAgICAgY29uc3Qgc2tlbGV0b25zID0gdGhpcy5wYXJzZVNrZWxldG9ucyhqc29uLnNrZWxldG9ucywgb2JqZWN0KTsKICAgICAgdGhpcy5iaW5kU2tlbGV0b25zKG9iamVjdCwgc2tlbGV0b25zKTsKICAgICAgcmV0dXJuIG9iamVjdDsKICAgIH0pOwogIH0KICBwYXJzZVNoYXBlcyhqc29uKSB7CiAgICBjb25zdCBzaGFwZXMgPSB7fTsKICAgIGlmIChqc29uICE9PSB2b2lkIDApIHsKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBqc29uLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGNvbnN0IHNoYXBlID0gbmV3IFNoYXBlKCkuZnJvbUpTT04oanNvbltpXSk7CiAgICAgICAgc2hhcGVzW3NoYXBlLnV1aWRdID0gc2hhcGU7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBzaGFwZXM7CiAgfQogIHBhcnNlU2tlbGV0b25zKGpzb24sIG9iamVjdCkgewogICAgY29uc3Qgc2tlbGV0b25zID0ge307CiAgICBjb25zdCBib25lcyA9IHt9OwogICAgb2JqZWN0LnRyYXZlcnNlKGZ1bmN0aW9uKGNoaWxkKSB7CiAgICAgIGlmIChjaGlsZC5pc0JvbmUpCiAgICAgICAgYm9uZXNbY2hpbGQudXVpZF0gPSBjaGlsZDsKICAgIH0pOwogICAgaWYgKGpzb24gIT09IHZvaWQgMCkgewogICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGpzb24ubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2tlbGV0b24gPSBuZXcgU2tlbGV0b24oKS5mcm9tSlNPTihqc29uW2ldLCBib25lcyk7CiAgICAgICAgc2tlbGV0b25zW3NrZWxldG9uLnV1aWRdID0gc2tlbGV0b247CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBza2VsZXRvbnM7CiAgfQogIHBhcnNlR2VvbWV0cmllcyhqc29uLCBzaGFwZXMpIHsKICAgIGNvbnN0IGdlb21ldHJpZXMgPSB7fTsKICAgIGlmIChqc29uICE9PSB2b2lkIDApIHsKICAgICAgY29uc3QgYnVmZmVyR2VvbWV0cnlMb2FkZXIgPSBuZXcgQnVmZmVyR2VvbWV0cnlMb2FkZXIoKTsKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBqc29uLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGxldCBnZW9tZXRyeTsKICAgICAgICBjb25zdCBkYXRhID0ganNvbltpXTsKICAgICAgICBzd2l0Y2ggKGRhdGEudHlwZSkgewogICAgICAgICAgY2FzZSAiQnVmZmVyR2VvbWV0cnkiOgogICAgICAgICAgY2FzZSAiSW5zdGFuY2VkQnVmZmVyR2VvbWV0cnkiOgogICAgICAgICAgICBnZW9tZXRyeSA9IGJ1ZmZlckdlb21ldHJ5TG9hZGVyLnBhcnNlKGRhdGEpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgIkdlb21ldHJ5IjoKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuT2JqZWN0TG9hZGVyOiBUaGUgbGVnYWN5IEdlb21ldHJ5IHR5cGUgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZC4iKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBpZiAoZGF0YS50eXBlIGluIEdlb21ldHJpZXMpIHsKICAgICAgICAgICAgICBnZW9tZXRyeSA9IEdlb21ldHJpZXNbZGF0YS50eXBlXS5mcm9tSlNPTihkYXRhLCBzaGFwZXMpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnNvbGUud2FybihgVEhSRUUuT2JqZWN0TG9hZGVyOiBVbnN1cHBvcnRlZCBnZW9tZXRyeSB0eXBlICIke2RhdGEudHlwZX0iYCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZ2VvbWV0cnkudXVpZCA9IGRhdGEudXVpZDsKICAgICAgICBpZiAoZGF0YS5uYW1lICE9PSB2b2lkIDApCiAgICAgICAgICBnZW9tZXRyeS5uYW1lID0gZGF0YS5uYW1lOwogICAgICAgIGlmIChnZW9tZXRyeS5pc0J1ZmZlckdlb21ldHJ5ID09PSB0cnVlICYmIGRhdGEudXNlckRhdGEgIT09IHZvaWQgMCkKICAgICAgICAgIGdlb21ldHJ5LnVzZXJEYXRhID0gZGF0YS51c2VyRGF0YTsKICAgICAgICBnZW9tZXRyaWVzW2RhdGEudXVpZF0gPSBnZW9tZXRyeTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGdlb21ldHJpZXM7CiAgfQogIHBhcnNlTWF0ZXJpYWxzKGpzb24sIHRleHR1cmVzKSB7CiAgICBjb25zdCBjYWNoZSA9IHt9OwogICAgY29uc3QgbWF0ZXJpYWxzID0ge307CiAgICBpZiAoanNvbiAhPT0gdm9pZCAwKSB7CiAgICAgIGNvbnN0IGxvYWRlciA9IG5ldyBNYXRlcmlhbExvYWRlcigpOwogICAgICBsb2FkZXIuc2V0VGV4dHVyZXModGV4dHVyZXMpOwogICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGpzb24ubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY29uc3QgZGF0YSA9IGpzb25baV07CiAgICAgICAgaWYgKGRhdGEudHlwZSA9PT0gIk11bHRpTWF0ZXJpYWwiKSB7CiAgICAgICAgICBjb25zdCBhcnJheSA9IFtdOwogICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBkYXRhLm1hdGVyaWFscy5sZW5ndGg7IGorKykgewogICAgICAgICAgICBjb25zdCBtYXRlcmlhbCA9IGRhdGEubWF0ZXJpYWxzW2pdOwogICAgICAgICAgICBpZiAoY2FjaGVbbWF0ZXJpYWwudXVpZF0gPT09IHZvaWQgMCkgewogICAgICAgICAgICAgIGNhY2hlW21hdGVyaWFsLnV1aWRdID0gbG9hZGVyLnBhcnNlKG1hdGVyaWFsKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBhcnJheS5wdXNoKGNhY2hlW21hdGVyaWFsLnV1aWRdKTsKICAgICAgICAgIH0KICAgICAgICAgIG1hdGVyaWFsc1tkYXRhLnV1aWRdID0gYXJyYXk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChjYWNoZVtkYXRhLnV1aWRdID09PSB2b2lkIDApIHsKICAgICAgICAgICAgY2FjaGVbZGF0YS51dWlkXSA9IGxvYWRlci5wYXJzZShkYXRhKTsKICAgICAgICAgIH0KICAgICAgICAgIG1hdGVyaWFsc1tkYXRhLnV1aWRdID0gY2FjaGVbZGF0YS51dWlkXTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBtYXRlcmlhbHM7CiAgfQogIHBhcnNlQW5pbWF0aW9ucyhqc29uKSB7CiAgICBjb25zdCBhbmltYXRpb25zID0ge307CiAgICBpZiAoanNvbiAhPT0gdm9pZCAwKSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwganNvbi5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGRhdGEgPSBqc29uW2ldOwogICAgICAgIGNvbnN0IGNsaXAgPSBBbmltYXRpb25DbGlwLnBhcnNlKGRhdGEpOwogICAgICAgIGFuaW1hdGlvbnNbY2xpcC51dWlkXSA9IGNsaXA7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBhbmltYXRpb25zOwogIH0KICBwYXJzZUltYWdlcyhqc29uLCBvbkxvYWQpIHsKICAgIGNvbnN0IHNjb3BlID0gdGhpczsKICAgIGNvbnN0IGltYWdlcyA9IHt9OwogICAgbGV0IGxvYWRlcjsKICAgIGZ1bmN0aW9uIGxvYWRJbWFnZSh1cmwpIHsKICAgICAgc2NvcGUubWFuYWdlci5pdGVtU3RhcnQodXJsKTsKICAgICAgcmV0dXJuIGxvYWRlci5sb2FkKHVybCwgZnVuY3Rpb24oKSB7CiAgICAgICAgc2NvcGUubWFuYWdlci5pdGVtRW5kKHVybCk7CiAgICAgIH0sIHZvaWQgMCwgZnVuY3Rpb24oKSB7CiAgICAgICAgc2NvcGUubWFuYWdlci5pdGVtRXJyb3IodXJsKTsKICAgICAgICBzY29wZS5tYW5hZ2VyLml0ZW1FbmQodXJsKTsKICAgICAgfSk7CiAgICB9CiAgICBmdW5jdGlvbiBkZXNlcmlhbGl6ZUltYWdlKGltYWdlKSB7CiAgICAgIGlmICh0eXBlb2YgaW1hZ2UgPT09ICJzdHJpbmciKSB7CiAgICAgICAgY29uc3QgdXJsID0gaW1hZ2U7CiAgICAgICAgY29uc3QgcGF0aCA9IC9eKFwvXC8pfChbYS16XSs6KFwvXC8pPykvaS50ZXN0KHVybCkgPyB1cmwgOiBzY29wZS5yZXNvdXJjZVBhdGggKyB1cmw7CiAgICAgICAgcmV0dXJuIGxvYWRJbWFnZShwYXRoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoaW1hZ2UuZGF0YSkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgZGF0YTogZ2V0VHlwZWRBcnJheShpbWFnZS50eXBlLCBpbWFnZS5kYXRhKSwKICAgICAgICAgICAgd2lkdGg6IGltYWdlLndpZHRoLAogICAgICAgICAgICBoZWlnaHQ6IGltYWdlLmhlaWdodAogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAoanNvbiAhPT0gdm9pZCAwICYmIGpzb24ubGVuZ3RoID4gMCkgewogICAgICBjb25zdCBtYW5hZ2VyID0gbmV3IExvYWRpbmdNYW5hZ2VyKG9uTG9hZCk7CiAgICAgIGxvYWRlciA9IG5ldyBJbWFnZUxvYWRlcihtYW5hZ2VyKTsKICAgICAgbG9hZGVyLnNldENyb3NzT3JpZ2luKHRoaXMuY3Jvc3NPcmlnaW4pOwogICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBqc29uLmxlbmd0aDsgaSA8IGlsOyBpKyspIHsKICAgICAgICBjb25zdCBpbWFnZSA9IGpzb25baV07CiAgICAgICAgY29uc3QgdXJsID0gaW1hZ2UudXJsOwogICAgICAgIGlmIChBcnJheS5pc0FycmF5KHVybCkpIHsKICAgICAgICAgIGltYWdlc1tpbWFnZS51dWlkXSA9IFtdOwogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIGpsID0gdXJsLmxlbmd0aDsgaiA8IGpsOyBqKyspIHsKICAgICAgICAgICAgY29uc3QgY3VycmVudFVybCA9IHVybFtqXTsKICAgICAgICAgICAgY29uc3QgZGVzZXJpYWxpemVkSW1hZ2UgPSBkZXNlcmlhbGl6ZUltYWdlKGN1cnJlbnRVcmwpOwogICAgICAgICAgICBpZiAoZGVzZXJpYWxpemVkSW1hZ2UgIT09IG51bGwpIHsKICAgICAgICAgICAgICBpZiAoZGVzZXJpYWxpemVkSW1hZ2UgaW5zdGFuY2VvZiBIVE1MSW1hZ2VFbGVtZW50KSB7CiAgICAgICAgICAgICAgICBpbWFnZXNbaW1hZ2UudXVpZF0ucHVzaChkZXNlcmlhbGl6ZWRJbWFnZSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGltYWdlc1tpbWFnZS51dWlkXS5wdXNoKG5ldyBEYXRhVGV4dHVyZShkZXNlcmlhbGl6ZWRJbWFnZS5kYXRhLCBkZXNlcmlhbGl6ZWRJbWFnZS53aWR0aCwgZGVzZXJpYWxpemVkSW1hZ2UuaGVpZ2h0KSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGRlc2VyaWFsaXplZEltYWdlID0gZGVzZXJpYWxpemVJbWFnZShpbWFnZS51cmwpOwogICAgICAgICAgaWYgKGRlc2VyaWFsaXplZEltYWdlICE9PSBudWxsKSB7CiAgICAgICAgICAgIGltYWdlc1tpbWFnZS51dWlkXSA9IGRlc2VyaWFsaXplZEltYWdlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIGltYWdlczsKICB9CiAgcGFyc2VJbWFnZXNBc3luYyhqc29uKSB7CiAgICByZXR1cm4gX19hc3luYyh0aGlzLCBudWxsLCBmdW5jdGlvbiogKCkgewogICAgICBjb25zdCBzY29wZSA9IHRoaXM7CiAgICAgIGNvbnN0IGltYWdlcyA9IHt9OwogICAgICBsZXQgbG9hZGVyOwogICAgICBmdW5jdGlvbiBkZXNlcmlhbGl6ZUltYWdlKGltYWdlKSB7CiAgICAgICAgcmV0dXJuIF9fYXN5bmModGhpcywgbnVsbCwgZnVuY3Rpb24qICgpIHsKICAgICAgICAgIGlmICh0eXBlb2YgaW1hZ2UgPT09ICJzdHJpbmciKSB7CiAgICAgICAgICAgIGNvbnN0IHVybCA9IGltYWdlOwogICAgICAgICAgICBjb25zdCBwYXRoID0gL14oXC9cLyl8KFthLXpdKzooXC9cLyk/KS9pLnRlc3QodXJsKSA/IHVybCA6IHNjb3BlLnJlc291cmNlUGF0aCArIHVybDsKICAgICAgICAgICAgcmV0dXJuIHlpZWxkIGxvYWRlci5sb2FkQXN5bmMocGF0aCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoaW1hZ2UuZGF0YSkgewogICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBkYXRhOiBnZXRUeXBlZEFycmF5KGltYWdlLnR5cGUsIGltYWdlLmRhdGEpLAogICAgICAgICAgICAgICAgd2lkdGg6IGltYWdlLndpZHRoLAogICAgICAgICAgICAgICAgaGVpZ2h0OiBpbWFnZS5oZWlnaHQKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgaWYgKGpzb24gIT09IHZvaWQgMCAmJiBqc29uLmxlbmd0aCA+IDApIHsKICAgICAgICBsb2FkZXIgPSBuZXcgSW1hZ2VMb2FkZXIodGhpcy5tYW5hZ2VyKTsKICAgICAgICBsb2FkZXIuc2V0Q3Jvc3NPcmlnaW4odGhpcy5jcm9zc09yaWdpbik7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlsID0ganNvbi5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgICAgICBjb25zdCBpbWFnZSA9IGpzb25baV07CiAgICAgICAgICBjb25zdCB1cmwgPSBpbWFnZS51cmw7CiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh1cmwpKSB7CiAgICAgICAgICAgIGltYWdlc1tpbWFnZS51dWlkXSA9IFtdOwogICAgICAgICAgICBmb3IgKGxldCBqID0gMCwgamwgPSB1cmwubGVuZ3RoOyBqIDwgamw7IGorKykgewogICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRVcmwgPSB1cmxbal07CiAgICAgICAgICAgICAgY29uc3QgZGVzZXJpYWxpemVkSW1hZ2UgPSB5aWVsZCBkZXNlcmlhbGl6ZUltYWdlKGN1cnJlbnRVcmwpOwogICAgICAgICAgICAgIGlmIChkZXNlcmlhbGl6ZWRJbWFnZSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgaWYgKGRlc2VyaWFsaXplZEltYWdlIGluc3RhbmNlb2YgSFRNTEltYWdlRWxlbWVudCkgewogICAgICAgICAgICAgICAgICBpbWFnZXNbaW1hZ2UudXVpZF0ucHVzaChkZXNlcmlhbGl6ZWRJbWFnZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBpbWFnZXNbaW1hZ2UudXVpZF0ucHVzaChuZXcgRGF0YVRleHR1cmUoZGVzZXJpYWxpemVkSW1hZ2UuZGF0YSwgZGVzZXJpYWxpemVkSW1hZ2Uud2lkdGgsIGRlc2VyaWFsaXplZEltYWdlLmhlaWdodCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3QgZGVzZXJpYWxpemVkSW1hZ2UgPSB5aWVsZCBkZXNlcmlhbGl6ZUltYWdlKGltYWdlLnVybCk7CiAgICAgICAgICAgIGlmIChkZXNlcmlhbGl6ZWRJbWFnZSAhPT0gbnVsbCkgewogICAgICAgICAgICAgIGltYWdlc1tpbWFnZS51dWlkXSA9IGRlc2VyaWFsaXplZEltYWdlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBpbWFnZXM7CiAgICB9KTsKICB9CiAgcGFyc2VUZXh0dXJlcyhqc29uLCBpbWFnZXMpIHsKICAgIGZ1bmN0aW9uIHBhcnNlQ29uc3RhbnQodmFsdWUsIHR5cGUpIHsKICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gIm51bWJlciIpCiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLk9iamVjdExvYWRlci5wYXJzZVRleHR1cmU6IENvbnN0YW50IHNob3VsZCBiZSBpbiBudW1lcmljIGZvcm0uIiwgdmFsdWUpOwogICAgICByZXR1cm4gdHlwZVt2YWx1ZV07CiAgICB9CiAgICBjb25zdCB0ZXh0dXJlcyA9IHt9OwogICAgaWYgKGpzb24gIT09IHZvaWQgMCkgewogICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGpzb24ubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY29uc3QgZGF0YSA9IGpzb25baV07CiAgICAgICAgaWYgKGRhdGEuaW1hZ2UgPT09IHZvaWQgMCkgewogICAgICAgICAgY29uc29sZS53YXJuKCdUSFJFRS5PYmplY3RMb2FkZXI6IE5vICJpbWFnZSIgc3BlY2lmaWVkIGZvcicsIGRhdGEudXVpZCk7CiAgICAgICAgfQogICAgICAgIGlmIChpbWFnZXNbZGF0YS5pbWFnZV0gPT09IHZvaWQgMCkgewogICAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5PYmplY3RMb2FkZXI6IFVuZGVmaW5lZCBpbWFnZSIsIGRhdGEuaW1hZ2UpOwogICAgICAgIH0KICAgICAgICBsZXQgdGV4dHVyZTsKICAgICAgICBjb25zdCBpbWFnZSA9IGltYWdlc1tkYXRhLmltYWdlXTsKICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpbWFnZSkpIHsKICAgICAgICAgIHRleHR1cmUgPSBuZXcgQ3ViZVRleHR1cmUoaW1hZ2UpOwogICAgICAgICAgaWYgKGltYWdlLmxlbmd0aCA9PT0gNikKICAgICAgICAgICAgdGV4dHVyZS5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChpbWFnZSAmJiBpbWFnZS5kYXRhKSB7CiAgICAgICAgICAgIHRleHR1cmUgPSBuZXcgRGF0YVRleHR1cmUoaW1hZ2UuZGF0YSwgaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0ZXh0dXJlID0gbmV3IFRleHR1cmUoaW1hZ2UpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGltYWdlKQogICAgICAgICAgICB0ZXh0dXJlLm5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgdGV4dHVyZS51dWlkID0gZGF0YS51dWlkOwogICAgICAgIGlmIChkYXRhLm5hbWUgIT09IHZvaWQgMCkKICAgICAgICAgIHRleHR1cmUubmFtZSA9IGRhdGEubmFtZTsKICAgICAgICBpZiAoZGF0YS5tYXBwaW5nICE9PSB2b2lkIDApCiAgICAgICAgICB0ZXh0dXJlLm1hcHBpbmcgPSBwYXJzZUNvbnN0YW50KGRhdGEubWFwcGluZywgVEVYVFVSRV9NQVBQSU5HKTsKICAgICAgICBpZiAoZGF0YS5vZmZzZXQgIT09IHZvaWQgMCkKICAgICAgICAgIHRleHR1cmUub2Zmc2V0LmZyb21BcnJheShkYXRhLm9mZnNldCk7CiAgICAgICAgaWYgKGRhdGEucmVwZWF0ICE9PSB2b2lkIDApCiAgICAgICAgICB0ZXh0dXJlLnJlcGVhdC5mcm9tQXJyYXkoZGF0YS5yZXBlYXQpOwogICAgICAgIGlmIChkYXRhLmNlbnRlciAhPT0gdm9pZCAwKQogICAgICAgICAgdGV4dHVyZS5jZW50ZXIuZnJvbUFycmF5KGRhdGEuY2VudGVyKTsKICAgICAgICBpZiAoZGF0YS5yb3RhdGlvbiAhPT0gdm9pZCAwKQogICAgICAgICAgdGV4dHVyZS5yb3RhdGlvbiA9IGRhdGEucm90YXRpb247CiAgICAgICAgaWYgKGRhdGEud3JhcCAhPT0gdm9pZCAwKSB7CiAgICAgICAgICB0ZXh0dXJlLndyYXBTID0gcGFyc2VDb25zdGFudChkYXRhLndyYXBbMF0sIFRFWFRVUkVfV1JBUFBJTkcpOwogICAgICAgICAgdGV4dHVyZS53cmFwVCA9IHBhcnNlQ29uc3RhbnQoZGF0YS53cmFwWzFdLCBURVhUVVJFX1dSQVBQSU5HKTsKICAgICAgICB9CiAgICAgICAgaWYgKGRhdGEuZm9ybWF0ICE9PSB2b2lkIDApCiAgICAgICAgICB0ZXh0dXJlLmZvcm1hdCA9IGRhdGEuZm9ybWF0OwogICAgICAgIGlmIChkYXRhLnR5cGUgIT09IHZvaWQgMCkKICAgICAgICAgIHRleHR1cmUudHlwZSA9IGRhdGEudHlwZTsKICAgICAgICBpZiAoZGF0YS5lbmNvZGluZyAhPT0gdm9pZCAwKQogICAgICAgICAgdGV4dHVyZS5lbmNvZGluZyA9IGRhdGEuZW5jb2Rpbmc7CiAgICAgICAgaWYgKGRhdGEubWluRmlsdGVyICE9PSB2b2lkIDApCiAgICAgICAgICB0ZXh0dXJlLm1pbkZpbHRlciA9IHBhcnNlQ29uc3RhbnQoZGF0YS5taW5GaWx0ZXIsIFRFWFRVUkVfRklMVEVSKTsKICAgICAgICBpZiAoZGF0YS5tYWdGaWx0ZXIgIT09IHZvaWQgMCkKICAgICAgICAgIHRleHR1cmUubWFnRmlsdGVyID0gcGFyc2VDb25zdGFudChkYXRhLm1hZ0ZpbHRlciwgVEVYVFVSRV9GSUxURVIpOwogICAgICAgIGlmIChkYXRhLmFuaXNvdHJvcHkgIT09IHZvaWQgMCkKICAgICAgICAgIHRleHR1cmUuYW5pc290cm9weSA9IGRhdGEuYW5pc290cm9weTsKICAgICAgICBpZiAoZGF0YS5mbGlwWSAhPT0gdm9pZCAwKQogICAgICAgICAgdGV4dHVyZS5mbGlwWSA9IGRhdGEuZmxpcFk7CiAgICAgICAgaWYgKGRhdGEucHJlbXVsdGlwbHlBbHBoYSAhPT0gdm9pZCAwKQogICAgICAgICAgdGV4dHVyZS5wcmVtdWx0aXBseUFscGhhID0gZGF0YS5wcmVtdWx0aXBseUFscGhhOwogICAgICAgIGlmIChkYXRhLnVucGFja0FsaWdubWVudCAhPT0gdm9pZCAwKQogICAgICAgICAgdGV4dHVyZS51bnBhY2tBbGlnbm1lbnQgPSBkYXRhLnVucGFja0FsaWdubWVudDsKICAgICAgICBpZiAoZGF0YS51c2VyRGF0YSAhPT0gdm9pZCAwKQogICAgICAgICAgdGV4dHVyZS51c2VyRGF0YSA9IGRhdGEudXNlckRhdGE7CiAgICAgICAgdGV4dHVyZXNbZGF0YS51dWlkXSA9IHRleHR1cmU7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0ZXh0dXJlczsKICB9CiAgcGFyc2VPYmplY3QoZGF0YSwgZ2VvbWV0cmllcywgbWF0ZXJpYWxzLCB0ZXh0dXJlcywgYW5pbWF0aW9ucykgewogICAgbGV0IG9iamVjdDsKICAgIGZ1bmN0aW9uIGdldEdlb21ldHJ5KG5hbWUpIHsKICAgICAgaWYgKGdlb21ldHJpZXNbbmFtZV0gPT09IHZvaWQgMCkgewogICAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuT2JqZWN0TG9hZGVyOiBVbmRlZmluZWQgZ2VvbWV0cnkiLCBuYW1lKTsKICAgICAgfQogICAgICByZXR1cm4gZ2VvbWV0cmllc1tuYW1lXTsKICAgIH0KICAgIGZ1bmN0aW9uIGdldE1hdGVyaWFsKG5hbWUpIHsKICAgICAgaWYgKG5hbWUgPT09IHZvaWQgMCkKICAgICAgICByZXR1cm4gdm9pZCAwOwogICAgICBpZiAoQXJyYXkuaXNBcnJheShuYW1lKSkgewogICAgICAgIGNvbnN0IGFycmF5ID0gW107CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBuYW1lLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgY29uc3QgdXVpZCA9IG5hbWVbaV07CiAgICAgICAgICBpZiAobWF0ZXJpYWxzW3V1aWRdID09PSB2b2lkIDApIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5PYmplY3RMb2FkZXI6IFVuZGVmaW5lZCBtYXRlcmlhbCIsIHV1aWQpOwogICAgICAgICAgfQogICAgICAgICAgYXJyYXkucHVzaChtYXRlcmlhbHNbdXVpZF0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYXJyYXk7CiAgICAgIH0KICAgICAgaWYgKG1hdGVyaWFsc1tuYW1lXSA9PT0gdm9pZCAwKSB7CiAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5PYmplY3RMb2FkZXI6IFVuZGVmaW5lZCBtYXRlcmlhbCIsIG5hbWUpOwogICAgICB9CiAgICAgIHJldHVybiBtYXRlcmlhbHNbbmFtZV07CiAgICB9CiAgICBmdW5jdGlvbiBnZXRUZXh0dXJlKHV1aWQpIHsKICAgICAgaWYgKHRleHR1cmVzW3V1aWRdID09PSB2b2lkIDApIHsKICAgICAgICBjb25zb2xlLndhcm4oIlRIUkVFLk9iamVjdExvYWRlcjogVW5kZWZpbmVkIHRleHR1cmUiLCB1dWlkKTsKICAgICAgfQogICAgICByZXR1cm4gdGV4dHVyZXNbdXVpZF07CiAgICB9CiAgICBsZXQgZ2VvbWV0cnksIG1hdGVyaWFsOwogICAgc3dpdGNoIChkYXRhLnR5cGUpIHsKICAgICAgY2FzZSAiU2NlbmUiOgogICAgICAgIG9iamVjdCA9IG5ldyBTY2VuZSgpOwogICAgICAgIGlmIChkYXRhLmJhY2tncm91bmQgIT09IHZvaWQgMCkgewogICAgICAgICAgaWYgKE51bWJlci5pc0ludGVnZXIoZGF0YS5iYWNrZ3JvdW5kKSkgewogICAgICAgICAgICBvYmplY3QuYmFja2dyb3VuZCA9IG5ldyBDb2xvcihkYXRhLmJhY2tncm91bmQpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgb2JqZWN0LmJhY2tncm91bmQgPSBnZXRUZXh0dXJlKGRhdGEuYmFja2dyb3VuZCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChkYXRhLmVudmlyb25tZW50ICE9PSB2b2lkIDApIHsKICAgICAgICAgIG9iamVjdC5lbnZpcm9ubWVudCA9IGdldFRleHR1cmUoZGF0YS5lbnZpcm9ubWVudCk7CiAgICAgICAgfQogICAgICAgIGlmIChkYXRhLmZvZyAhPT0gdm9pZCAwKSB7CiAgICAgICAgICBpZiAoZGF0YS5mb2cudHlwZSA9PT0gIkZvZyIpIHsKICAgICAgICAgICAgb2JqZWN0LmZvZyA9IG5ldyBGb2coZGF0YS5mb2cuY29sb3IsIGRhdGEuZm9nLm5lYXIsIGRhdGEuZm9nLmZhcik7CiAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuZm9nLnR5cGUgPT09ICJGb2dFeHAyIikgewogICAgICAgICAgICBvYmplY3QuZm9nID0gbmV3IEZvZ0V4cDIoZGF0YS5mb2cuY29sb3IsIGRhdGEuZm9nLmRlbnNpdHkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAiUGVyc3BlY3RpdmVDYW1lcmEiOgogICAgICAgIG9iamVjdCA9IG5ldyBQZXJzcGVjdGl2ZUNhbWVyYShkYXRhLmZvdiwgZGF0YS5hc3BlY3QsIGRhdGEubmVhciwgZGF0YS5mYXIpOwogICAgICAgIGlmIChkYXRhLmZvY3VzICE9PSB2b2lkIDApCiAgICAgICAgICBvYmplY3QuZm9jdXMgPSBkYXRhLmZvY3VzOwogICAgICAgIGlmIChkYXRhLnpvb20gIT09IHZvaWQgMCkKICAgICAgICAgIG9iamVjdC56b29tID0gZGF0YS56b29tOwogICAgICAgIGlmIChkYXRhLmZpbG1HYXVnZSAhPT0gdm9pZCAwKQogICAgICAgICAgb2JqZWN0LmZpbG1HYXVnZSA9IGRhdGEuZmlsbUdhdWdlOwogICAgICAgIGlmIChkYXRhLmZpbG1PZmZzZXQgIT09IHZvaWQgMCkKICAgICAgICAgIG9iamVjdC5maWxtT2Zmc2V0ID0gZGF0YS5maWxtT2Zmc2V0OwogICAgICAgIGlmIChkYXRhLnZpZXcgIT09IHZvaWQgMCkKICAgICAgICAgIG9iamVjdC52aWV3ID0gT2JqZWN0LmFzc2lnbih7fSwgZGF0YS52aWV3KTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAiT3J0aG9ncmFwaGljQ2FtZXJhIjoKICAgICAgICBvYmplY3QgPSBuZXcgT3J0aG9ncmFwaGljQ2FtZXJhKGRhdGEubGVmdCwgZGF0YS5yaWdodCwgZGF0YS50b3AsIGRhdGEuYm90dG9tLCBkYXRhLm5lYXIsIGRhdGEuZmFyKTsKICAgICAgICBpZiAoZGF0YS56b29tICE9PSB2b2lkIDApCiAgICAgICAgICBvYmplY3Quem9vbSA9IGRhdGEuem9vbTsKICAgICAgICBpZiAoZGF0YS52aWV3ICE9PSB2b2lkIDApCiAgICAgICAgICBvYmplY3QudmlldyA9IE9iamVjdC5hc3NpZ24oe30sIGRhdGEudmlldyk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIkFtYmllbnRMaWdodCI6CiAgICAgICAgb2JqZWN0ID0gbmV3IEFtYmllbnRMaWdodChkYXRhLmNvbG9yLCBkYXRhLmludGVuc2l0eSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIkRpcmVjdGlvbmFsTGlnaHQiOgogICAgICAgIG9iamVjdCA9IG5ldyBEaXJlY3Rpb25hbExpZ2h0KGRhdGEuY29sb3IsIGRhdGEuaW50ZW5zaXR5KTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAiUG9pbnRMaWdodCI6CiAgICAgICAgb2JqZWN0ID0gbmV3IFBvaW50TGlnaHQoZGF0YS5jb2xvciwgZGF0YS5pbnRlbnNpdHksIGRhdGEuZGlzdGFuY2UsIGRhdGEuZGVjYXkpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJSZWN0QXJlYUxpZ2h0IjoKICAgICAgICBvYmplY3QgPSBuZXcgUmVjdEFyZWFMaWdodChkYXRhLmNvbG9yLCBkYXRhLmludGVuc2l0eSwgZGF0YS53aWR0aCwgZGF0YS5oZWlnaHQpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJTcG90TGlnaHQiOgogICAgICAgIG9iamVjdCA9IG5ldyBTcG90TGlnaHQoZGF0YS5jb2xvciwgZGF0YS5pbnRlbnNpdHksIGRhdGEuZGlzdGFuY2UsIGRhdGEuYW5nbGUsIGRhdGEucGVudW1icmEsIGRhdGEuZGVjYXkpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJIZW1pc3BoZXJlTGlnaHQiOgogICAgICAgIG9iamVjdCA9IG5ldyBIZW1pc3BoZXJlTGlnaHQoZGF0YS5jb2xvciwgZGF0YS5ncm91bmRDb2xvciwgZGF0YS5pbnRlbnNpdHkpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJMaWdodFByb2JlIjoKICAgICAgICBvYmplY3QgPSBuZXcgTGlnaHRQcm9iZSgpLmZyb21KU09OKGRhdGEpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJTa2lubmVkTWVzaCI6CiAgICAgICAgZ2VvbWV0cnkgPSBnZXRHZW9tZXRyeShkYXRhLmdlb21ldHJ5KTsKICAgICAgICBtYXRlcmlhbCA9IGdldE1hdGVyaWFsKGRhdGEubWF0ZXJpYWwpOwogICAgICAgIG9iamVjdCA9IG5ldyBTa2lubmVkTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwpOwogICAgICAgIGlmIChkYXRhLmJpbmRNb2RlICE9PSB2b2lkIDApCiAgICAgICAgICBvYmplY3QuYmluZE1vZGUgPSBkYXRhLmJpbmRNb2RlOwogICAgICAgIGlmIChkYXRhLmJpbmRNYXRyaXggIT09IHZvaWQgMCkKICAgICAgICAgIG9iamVjdC5iaW5kTWF0cml4LmZyb21BcnJheShkYXRhLmJpbmRNYXRyaXgpOwogICAgICAgIGlmIChkYXRhLnNrZWxldG9uICE9PSB2b2lkIDApCiAgICAgICAgICBvYmplY3Quc2tlbGV0b24gPSBkYXRhLnNrZWxldG9uOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJNZXNoIjoKICAgICAgICBnZW9tZXRyeSA9IGdldEdlb21ldHJ5KGRhdGEuZ2VvbWV0cnkpOwogICAgICAgIG1hdGVyaWFsID0gZ2V0TWF0ZXJpYWwoZGF0YS5tYXRlcmlhbCk7CiAgICAgICAgb2JqZWN0ID0gbmV3IE1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAiSW5zdGFuY2VkTWVzaCI6CiAgICAgICAgZ2VvbWV0cnkgPSBnZXRHZW9tZXRyeShkYXRhLmdlb21ldHJ5KTsKICAgICAgICBtYXRlcmlhbCA9IGdldE1hdGVyaWFsKGRhdGEubWF0ZXJpYWwpOwogICAgICAgIGNvbnN0IGNvdW50ID0gZGF0YS5jb3VudDsKICAgICAgICBjb25zdCBpbnN0YW5jZU1hdHJpeCA9IGRhdGEuaW5zdGFuY2VNYXRyaXg7CiAgICAgICAgY29uc3QgaW5zdGFuY2VDb2xvciA9IGRhdGEuaW5zdGFuY2VDb2xvcjsKICAgICAgICBvYmplY3QgPSBuZXcgSW5zdGFuY2VkTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwsIGNvdW50KTsKICAgICAgICBvYmplY3QuaW5zdGFuY2VNYXRyaXggPSBuZXcgSW5zdGFuY2VkQnVmZmVyQXR0cmlidXRlKG5ldyBGbG9hdDMyQXJyYXkoaW5zdGFuY2VNYXRyaXguYXJyYXkpLCAxNik7CiAgICAgICAgaWYgKGluc3RhbmNlQ29sb3IgIT09IHZvaWQgMCkKICAgICAgICAgIG9iamVjdC5pbnN0YW5jZUNvbG9yID0gbmV3IEluc3RhbmNlZEJ1ZmZlckF0dHJpYnV0ZShuZXcgRmxvYXQzMkFycmF5KGluc3RhbmNlQ29sb3IuYXJyYXkpLCBpbnN0YW5jZUNvbG9yLml0ZW1TaXplKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAiTE9EIjoKICAgICAgICBvYmplY3QgPSBuZXcgTE9EKCk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIkxpbmUiOgogICAgICAgIG9iamVjdCA9IG5ldyBMaW5lKGdldEdlb21ldHJ5KGRhdGEuZ2VvbWV0cnkpLCBnZXRNYXRlcmlhbChkYXRhLm1hdGVyaWFsKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIkxpbmVMb29wIjoKICAgICAgICBvYmplY3QgPSBuZXcgTGluZUxvb3AoZ2V0R2VvbWV0cnkoZGF0YS5nZW9tZXRyeSksIGdldE1hdGVyaWFsKGRhdGEubWF0ZXJpYWwpKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAiTGluZVNlZ21lbnRzIjoKICAgICAgICBvYmplY3QgPSBuZXcgTGluZVNlZ21lbnRzKGdldEdlb21ldHJ5KGRhdGEuZ2VvbWV0cnkpLCBnZXRNYXRlcmlhbChkYXRhLm1hdGVyaWFsKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIlBvaW50Q2xvdWQiOgogICAgICBjYXNlICJQb2ludHMiOgogICAgICAgIG9iamVjdCA9IG5ldyBQb2ludHMoZ2V0R2VvbWV0cnkoZGF0YS5nZW9tZXRyeSksIGdldE1hdGVyaWFsKGRhdGEubWF0ZXJpYWwpKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAiU3ByaXRlIjoKICAgICAgICBvYmplY3QgPSBuZXcgU3ByaXRlKGdldE1hdGVyaWFsKGRhdGEubWF0ZXJpYWwpKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAiR3JvdXAiOgogICAgICAgIG9iamVjdCA9IG5ldyBHcm91cCgpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJCb25lIjoKICAgICAgICBvYmplY3QgPSBuZXcgQm9uZSgpOwogICAgICAgIGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgIG9iamVjdCA9IG5ldyBPYmplY3QzRCgpOwogICAgfQogICAgb2JqZWN0LnV1aWQgPSBkYXRhLnV1aWQ7CiAgICBpZiAoZGF0YS5uYW1lICE9PSB2b2lkIDApCiAgICAgIG9iamVjdC5uYW1lID0gZGF0YS5uYW1lOwogICAgaWYgKGRhdGEubWF0cml4ICE9PSB2b2lkIDApIHsKICAgICAgb2JqZWN0Lm1hdHJpeC5mcm9tQXJyYXkoZGF0YS5tYXRyaXgpOwogICAgICBpZiAoZGF0YS5tYXRyaXhBdXRvVXBkYXRlICE9PSB2b2lkIDApCiAgICAgICAgb2JqZWN0Lm1hdHJpeEF1dG9VcGRhdGUgPSBkYXRhLm1hdHJpeEF1dG9VcGRhdGU7CiAgICAgIGlmIChvYmplY3QubWF0cml4QXV0b1VwZGF0ZSkKICAgICAgICBvYmplY3QubWF0cml4LmRlY29tcG9zZShvYmplY3QucG9zaXRpb24sIG9iamVjdC5xdWF0ZXJuaW9uLCBvYmplY3Quc2NhbGUpOwogICAgfSBlbHNlIHsKICAgICAgaWYgKGRhdGEucG9zaXRpb24gIT09IHZvaWQgMCkKICAgICAgICBvYmplY3QucG9zaXRpb24uZnJvbUFycmF5KGRhdGEucG9zaXRpb24pOwogICAgICBpZiAoZGF0YS5yb3RhdGlvbiAhPT0gdm9pZCAwKQogICAgICAgIG9iamVjdC5yb3RhdGlvbi5mcm9tQXJyYXkoZGF0YS5yb3RhdGlvbik7CiAgICAgIGlmIChkYXRhLnF1YXRlcm5pb24gIT09IHZvaWQgMCkKICAgICAgICBvYmplY3QucXVhdGVybmlvbi5mcm9tQXJyYXkoZGF0YS5xdWF0ZXJuaW9uKTsKICAgICAgaWYgKGRhdGEuc2NhbGUgIT09IHZvaWQgMCkKICAgICAgICBvYmplY3Quc2NhbGUuZnJvbUFycmF5KGRhdGEuc2NhbGUpOwogICAgfQogICAgaWYgKGRhdGEuY2FzdFNoYWRvdyAhPT0gdm9pZCAwKQogICAgICBvYmplY3QuY2FzdFNoYWRvdyA9IGRhdGEuY2FzdFNoYWRvdzsKICAgIGlmIChkYXRhLnJlY2VpdmVTaGFkb3cgIT09IHZvaWQgMCkKICAgICAgb2JqZWN0LnJlY2VpdmVTaGFkb3cgPSBkYXRhLnJlY2VpdmVTaGFkb3c7CiAgICBpZiAoZGF0YS5zaGFkb3cpIHsKICAgICAgaWYgKGRhdGEuc2hhZG93LmJpYXMgIT09IHZvaWQgMCkKICAgICAgICBvYmplY3Quc2hhZG93LmJpYXMgPSBkYXRhLnNoYWRvdy5iaWFzOwogICAgICBpZiAoZGF0YS5zaGFkb3cubm9ybWFsQmlhcyAhPT0gdm9pZCAwKQogICAgICAgIG9iamVjdC5zaGFkb3cubm9ybWFsQmlhcyA9IGRhdGEuc2hhZG93Lm5vcm1hbEJpYXM7CiAgICAgIGlmIChkYXRhLnNoYWRvdy5yYWRpdXMgIT09IHZvaWQgMCkKICAgICAgICBvYmplY3Quc2hhZG93LnJhZGl1cyA9IGRhdGEuc2hhZG93LnJhZGl1czsKICAgICAgaWYgKGRhdGEuc2hhZG93Lm1hcFNpemUgIT09IHZvaWQgMCkKICAgICAgICBvYmplY3Quc2hhZG93Lm1hcFNpemUuZnJvbUFycmF5KGRhdGEuc2hhZG93Lm1hcFNpemUpOwogICAgICBpZiAoZGF0YS5zaGFkb3cuY2FtZXJhICE9PSB2b2lkIDApCiAgICAgICAgb2JqZWN0LnNoYWRvdy5jYW1lcmEgPSB0aGlzLnBhcnNlT2JqZWN0KGRhdGEuc2hhZG93LmNhbWVyYSk7CiAgICB9CiAgICBpZiAoZGF0YS52aXNpYmxlICE9PSB2b2lkIDApCiAgICAgIG9iamVjdC52aXNpYmxlID0gZGF0YS52aXNpYmxlOwogICAgaWYgKGRhdGEuZnJ1c3R1bUN1bGxlZCAhPT0gdm9pZCAwKQogICAgICBvYmplY3QuZnJ1c3R1bUN1bGxlZCA9IGRhdGEuZnJ1c3R1bUN1bGxlZDsKICAgIGlmIChkYXRhLnJlbmRlck9yZGVyICE9PSB2b2lkIDApCiAgICAgIG9iamVjdC5yZW5kZXJPcmRlciA9IGRhdGEucmVuZGVyT3JkZXI7CiAgICBpZiAoZGF0YS51c2VyRGF0YSAhPT0gdm9pZCAwKQogICAgICBvYmplY3QudXNlckRhdGEgPSBkYXRhLnVzZXJEYXRhOwogICAgaWYgKGRhdGEubGF5ZXJzICE9PSB2b2lkIDApCiAgICAgIG9iamVjdC5sYXllcnMubWFzayA9IGRhdGEubGF5ZXJzOwogICAgaWYgKGRhdGEuY2hpbGRyZW4gIT09IHZvaWQgMCkgewogICAgICBjb25zdCBjaGlsZHJlbiA9IGRhdGEuY2hpbGRyZW47CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHsKICAgICAgICBvYmplY3QuYWRkKHRoaXMucGFyc2VPYmplY3QoY2hpbGRyZW5baV0sIGdlb21ldHJpZXMsIG1hdGVyaWFscywgdGV4dHVyZXMsIGFuaW1hdGlvbnMpKTsKICAgICAgfQogICAgfQogICAgaWYgKGRhdGEuYW5pbWF0aW9ucyAhPT0gdm9pZCAwKSB7CiAgICAgIGNvbnN0IG9iamVjdEFuaW1hdGlvbnMgPSBkYXRhLmFuaW1hdGlvbnM7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb2JqZWN0QW5pbWF0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHV1aWQgPSBvYmplY3RBbmltYXRpb25zW2ldOwogICAgICAgIG9iamVjdC5hbmltYXRpb25zLnB1c2goYW5pbWF0aW9uc1t1dWlkXSk7CiAgICAgIH0KICAgIH0KICAgIGlmIChkYXRhLnR5cGUgPT09ICJMT0QiKSB7CiAgICAgIGlmIChkYXRhLmF1dG9VcGRhdGUgIT09IHZvaWQgMCkKICAgICAgICBvYmplY3QuYXV0b1VwZGF0ZSA9IGRhdGEuYXV0b1VwZGF0ZTsKICAgICAgY29uc3QgbGV2ZWxzID0gZGF0YS5sZXZlbHM7CiAgICAgIGZvciAobGV0IGwgPSAwOyBsIDwgbGV2ZWxzLmxlbmd0aDsgbCsrKSB7CiAgICAgICAgY29uc3QgbGV2ZWwgPSBsZXZlbHNbbF07CiAgICAgICAgY29uc3QgY2hpbGQgPSBvYmplY3QuZ2V0T2JqZWN0QnlQcm9wZXJ0eSgidXVpZCIsIGxldmVsLm9iamVjdCk7CiAgICAgICAgaWYgKGNoaWxkICE9PSB2b2lkIDApIHsKICAgICAgICAgIG9iamVjdC5hZGRMZXZlbChjaGlsZCwgbGV2ZWwuZGlzdGFuY2UpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIG9iamVjdDsKICB9CiAgYmluZFNrZWxldG9ucyhvYmplY3QsIHNrZWxldG9ucykgewogICAgaWYgKE9iamVjdC5rZXlzKHNrZWxldG9ucykubGVuZ3RoID09PSAwKQogICAgICByZXR1cm47CiAgICBvYmplY3QudHJhdmVyc2UoZnVuY3Rpb24oY2hpbGQpIHsKICAgICAgaWYgKGNoaWxkLmlzU2tpbm5lZE1lc2ggPT09IHRydWUgJiYgY2hpbGQuc2tlbGV0b24gIT09IHZvaWQgMCkgewogICAgICAgIGNvbnN0IHNrZWxldG9uID0gc2tlbGV0b25zW2NoaWxkLnNrZWxldG9uXTsKICAgICAgICBpZiAoc2tlbGV0b24gPT09IHZvaWQgMCkgewogICAgICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5PYmplY3RMb2FkZXI6IE5vIHNrZWxldG9uIGZvdW5kIHdpdGggVVVJRDoiLCBjaGlsZC5za2VsZXRvbik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNoaWxkLmJpbmQoc2tlbGV0b24sIGNoaWxkLmJpbmRNYXRyaXgpOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfQogIHNldFRleHR1cmVQYXRoKHZhbHVlKSB7CiAgICBjb25zb2xlLndhcm4oIlRIUkVFLk9iamVjdExvYWRlcjogLnNldFRleHR1cmVQYXRoKCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuc2V0UmVzb3VyY2VQYXRoKCkuIik7CiAgICByZXR1cm4gdGhpcy5zZXRSZXNvdXJjZVBhdGgodmFsdWUpOwogIH0KfQpjb25zdCBURVhUVVJFX01BUFBJTkcgPSB7CiAgVVZNYXBwaW5nLAogIEN1YmVSZWZsZWN0aW9uTWFwcGluZywKICBDdWJlUmVmcmFjdGlvbk1hcHBpbmcsCiAgRXF1aXJlY3Rhbmd1bGFyUmVmbGVjdGlvbk1hcHBpbmcsCiAgRXF1aXJlY3Rhbmd1bGFyUmVmcmFjdGlvbk1hcHBpbmcsCiAgQ3ViZVVWUmVmbGVjdGlvbk1hcHBpbmcsCiAgQ3ViZVVWUmVmcmFjdGlvbk1hcHBpbmcKfTsKY29uc3QgVEVYVFVSRV9XUkFQUElORyA9IHsKICBSZXBlYXRXcmFwcGluZywKICBDbGFtcFRvRWRnZVdyYXBwaW5nLAogIE1pcnJvcmVkUmVwZWF0V3JhcHBpbmcKfTsKY29uc3QgVEVYVFVSRV9GSUxURVIgPSB7CiAgTmVhcmVzdEZpbHRlciwKICBOZWFyZXN0TWlwbWFwTmVhcmVzdEZpbHRlciwKICBOZWFyZXN0TWlwbWFwTGluZWFyRmlsdGVyLAogIExpbmVhckZpbHRlciwKICBMaW5lYXJNaXBtYXBOZWFyZXN0RmlsdGVyLAogIExpbmVhck1pcG1hcExpbmVhckZpbHRlcgp9OwpjbGFzcyBJbWFnZUJpdG1hcExvYWRlciBleHRlbmRzIExvYWRlciB7CiAgY29uc3RydWN0b3IobWFuYWdlcikgewogICAgc3VwZXIobWFuYWdlcik7CiAgICBpZiAodHlwZW9mIGNyZWF0ZUltYWdlQml0bWFwID09PSAidW5kZWZpbmVkIikgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkltYWdlQml0bWFwTG9hZGVyOiBjcmVhdGVJbWFnZUJpdG1hcCgpIG5vdCBzdXBwb3J0ZWQuIik7CiAgICB9CiAgICBpZiAodHlwZW9mIGZldGNoID09PSAidW5kZWZpbmVkIikgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkltYWdlQml0bWFwTG9hZGVyOiBmZXRjaCgpIG5vdCBzdXBwb3J0ZWQuIik7CiAgICB9CiAgICB0aGlzLm9wdGlvbnMgPSB7IHByZW11bHRpcGx5QWxwaGE6ICJub25lIiB9OwogIH0KICBzZXRPcHRpb25zKG9wdGlvbnMpIHsKICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbG9hZCh1cmwsIG9uTG9hZCwgb25Qcm9ncmVzcywgb25FcnJvcikgewogICAgaWYgKHVybCA9PT0gdm9pZCAwKQogICAgICB1cmwgPSAiIjsKICAgIGlmICh0aGlzLnBhdGggIT09IHZvaWQgMCkKICAgICAgdXJsID0gdGhpcy5wYXRoICsgdXJsOwogICAgdXJsID0gdGhpcy5tYW5hZ2VyLnJlc29sdmVVUkwodXJsKTsKICAgIGNvbnN0IHNjb3BlID0gdGhpczsKICAgIGNvbnN0IGNhY2hlZCA9IENhY2hlLmdldCh1cmwpOwogICAgaWYgKGNhY2hlZCAhPT0gdm9pZCAwKSB7CiAgICAgIHNjb3BlLm1hbmFnZXIuaXRlbVN0YXJ0KHVybCk7CiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKG9uTG9hZCkKICAgICAgICAgIG9uTG9hZChjYWNoZWQpOwogICAgICAgIHNjb3BlLm1hbmFnZXIuaXRlbUVuZCh1cmwpOwogICAgICB9LCAwKTsKICAgICAgcmV0dXJuIGNhY2hlZDsKICAgIH0KICAgIGNvbnN0IGZldGNoT3B0aW9ucyA9IHt9OwogICAgZmV0Y2hPcHRpb25zLmNyZWRlbnRpYWxzID0gdGhpcy5jcm9zc09yaWdpbiA9PT0gImFub255bW91cyIgPyAic2FtZS1vcmlnaW4iIDogImluY2x1ZGUiOwogICAgZmV0Y2hPcHRpb25zLmhlYWRlcnMgPSB0aGlzLnJlcXVlc3RIZWFkZXI7CiAgICBmZXRjaCh1cmwsIGZldGNoT3B0aW9ucykudGhlbihmdW5jdGlvbihyZXMpIHsKICAgICAgcmV0dXJuIHJlcy5ibG9iKCk7CiAgICB9KS50aGVuKGZ1bmN0aW9uKGJsb2IpIHsKICAgICAgcmV0dXJuIGNyZWF0ZUltYWdlQml0bWFwKGJsb2IsIE9iamVjdC5hc3NpZ24oc2NvcGUub3B0aW9ucywgeyBjb2xvclNwYWNlQ29udmVyc2lvbjogIm5vbmUiIH0pKTsKICAgIH0pLnRoZW4oZnVuY3Rpb24oaW1hZ2VCaXRtYXApIHsKICAgICAgQ2FjaGUuYWRkKHVybCwgaW1hZ2VCaXRtYXApOwogICAgICBpZiAob25Mb2FkKQogICAgICAgIG9uTG9hZChpbWFnZUJpdG1hcCk7CiAgICAgIHNjb3BlLm1hbmFnZXIuaXRlbUVuZCh1cmwpOwogICAgfSkuY2F0Y2goZnVuY3Rpb24oZSkgewogICAgICBpZiAob25FcnJvcikKICAgICAgICBvbkVycm9yKGUpOwogICAgICBzY29wZS5tYW5hZ2VyLml0ZW1FcnJvcih1cmwpOwogICAgICBzY29wZS5tYW5hZ2VyLml0ZW1FbmQodXJsKTsKICAgIH0pOwogICAgc2NvcGUubWFuYWdlci5pdGVtU3RhcnQodXJsKTsKICB9Cn0KSW1hZ2VCaXRtYXBMb2FkZXIucHJvdG90eXBlLmlzSW1hZ2VCaXRtYXBMb2FkZXIgPSB0cnVlOwpsZXQgX2NvbnRleHQ7CmNvbnN0IEF1ZGlvQ29udGV4dCA9IHsKICBnZXRDb250ZXh0OiBmdW5jdGlvbigpIHsKICAgIGlmIChfY29udGV4dCA9PT0gdm9pZCAwKSB7CiAgICAgIF9jb250ZXh0ID0gbmV3ICh3aW5kb3cuQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQpKCk7CiAgICB9CiAgICByZXR1cm4gX2NvbnRleHQ7CiAgfSwKICBzZXRDb250ZXh0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgX2NvbnRleHQgPSB2YWx1ZTsKICB9Cn07CmNsYXNzIEF1ZGlvTG9hZGVyIGV4dGVuZHMgTG9hZGVyIHsKICBjb25zdHJ1Y3RvcihtYW5hZ2VyKSB7CiAgICBzdXBlcihtYW5hZ2VyKTsKICB9CiAgbG9hZCh1cmwsIG9uTG9hZCwgb25Qcm9ncmVzcywgb25FcnJvcikgewogICAgY29uc3Qgc2NvcGUgPSB0aGlzOwogICAgY29uc3QgbG9hZGVyID0gbmV3IEZpbGVMb2FkZXIodGhpcy5tYW5hZ2VyKTsKICAgIGxvYWRlci5zZXRSZXNwb25zZVR5cGUoImFycmF5YnVmZmVyIik7CiAgICBsb2FkZXIuc2V0UGF0aCh0aGlzLnBhdGgpOwogICAgbG9hZGVyLnNldFJlcXVlc3RIZWFkZXIodGhpcy5yZXF1ZXN0SGVhZGVyKTsKICAgIGxvYWRlci5zZXRXaXRoQ3JlZGVudGlhbHModGhpcy53aXRoQ3JlZGVudGlhbHMpOwogICAgbG9hZGVyLmxvYWQodXJsLCBmdW5jdGlvbihidWZmZXIpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBidWZmZXJDb3B5ID0gYnVmZmVyLnNsaWNlKDApOwogICAgICAgIGNvbnN0IGNvbnRleHQgPSBBdWRpb0NvbnRleHQuZ2V0Q29udGV4dCgpOwogICAgICAgIGNvbnRleHQuZGVjb2RlQXVkaW9EYXRhKGJ1ZmZlckNvcHksIGZ1bmN0aW9uKGF1ZGlvQnVmZmVyKSB7CiAgICAgICAgICBvbkxvYWQoYXVkaW9CdWZmZXIpOwogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgaWYgKG9uRXJyb3IpIHsKICAgICAgICAgIG9uRXJyb3IoZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7CiAgICAgICAgfQogICAgICAgIHNjb3BlLm1hbmFnZXIuaXRlbUVycm9yKHVybCk7CiAgICAgIH0KICAgIH0sIG9uUHJvZ3Jlc3MsIG9uRXJyb3IpOwogIH0KfQpjbGFzcyBIZW1pc3BoZXJlTGlnaHRQcm9iZSBleHRlbmRzIExpZ2h0UHJvYmUgewogIGNvbnN0cnVjdG9yKHNreUNvbG9yLCBncm91bmRDb2xvciwgaW50ZW5zaXR5ID0gMSkgewogICAgc3VwZXIodm9pZCAwLCBpbnRlbnNpdHkpOwogICAgY29uc3QgY29sb3IxID0gbmV3IENvbG9yKCkuc2V0KHNreUNvbG9yKTsKICAgIGNvbnN0IGNvbG9yMiA9IG5ldyBDb2xvcigpLnNldChncm91bmRDb2xvcik7CiAgICBjb25zdCBza3kgPSBuZXcgVmVjdG9yMyhjb2xvcjEuciwgY29sb3IxLmcsIGNvbG9yMS5iKTsKICAgIGNvbnN0IGdyb3VuZCA9IG5ldyBWZWN0b3IzKGNvbG9yMi5yLCBjb2xvcjIuZywgY29sb3IyLmIpOwogICAgY29uc3QgYzAgPSBNYXRoLnNxcnQoTWF0aC5QSSk7CiAgICBjb25zdCBjMSA9IGMwICogTWF0aC5zcXJ0KDAuNzUpOwogICAgdGhpcy5zaC5jb2VmZmljaWVudHNbMF0uY29weShza3kpLmFkZChncm91bmQpLm11bHRpcGx5U2NhbGFyKGMwKTsKICAgIHRoaXMuc2guY29lZmZpY2llbnRzWzFdLmNvcHkoc2t5KS5zdWIoZ3JvdW5kKS5tdWx0aXBseVNjYWxhcihjMSk7CiAgfQp9CkhlbWlzcGhlcmVMaWdodFByb2JlLnByb3RvdHlwZS5pc0hlbWlzcGhlcmVMaWdodFByb2JlID0gdHJ1ZTsKY2xhc3MgQW1iaWVudExpZ2h0UHJvYmUgZXh0ZW5kcyBMaWdodFByb2JlIHsKICBjb25zdHJ1Y3Rvcihjb2xvciwgaW50ZW5zaXR5ID0gMSkgewogICAgc3VwZXIodm9pZCAwLCBpbnRlbnNpdHkpOwogICAgY29uc3QgY29sb3IxID0gbmV3IENvbG9yKCkuc2V0KGNvbG9yKTsKICAgIHRoaXMuc2guY29lZmZpY2llbnRzWzBdLnNldChjb2xvcjEuciwgY29sb3IxLmcsIGNvbG9yMS5iKS5tdWx0aXBseVNjYWxhcigyICogTWF0aC5zcXJ0KE1hdGguUEkpKTsKICB9Cn0KQW1iaWVudExpZ2h0UHJvYmUucHJvdG90eXBlLmlzQW1iaWVudExpZ2h0UHJvYmUgPSB0cnVlOwpjb25zdCBfZXllUmlnaHQgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hdHJpeDQoKTsKY29uc3QgX2V5ZUxlZnQgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hdHJpeDQoKTsKY29uc3QgX3Byb2plY3Rpb25NYXRyaXggPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hdHJpeDQoKTsKY2xhc3MgU3RlcmVvQ2FtZXJhIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHRoaXMudHlwZSA9ICJTdGVyZW9DYW1lcmEiOwogICAgdGhpcy5hc3BlY3QgPSAxOwogICAgdGhpcy5leWVTZXAgPSAwLjA2NDsKICAgIHRoaXMuY2FtZXJhTCA9IG5ldyBQZXJzcGVjdGl2ZUNhbWVyYSgpOwogICAgdGhpcy5jYW1lcmFMLmxheWVycy5lbmFibGUoMSk7CiAgICB0aGlzLmNhbWVyYUwubWF0cml4QXV0b1VwZGF0ZSA9IGZhbHNlOwogICAgdGhpcy5jYW1lcmFSID0gbmV3IFBlcnNwZWN0aXZlQ2FtZXJhKCk7CiAgICB0aGlzLmNhbWVyYVIubGF5ZXJzLmVuYWJsZSgyKTsKICAgIHRoaXMuY2FtZXJhUi5tYXRyaXhBdXRvVXBkYXRlID0gZmFsc2U7CiAgICB0aGlzLl9jYWNoZSA9IHsKICAgICAgZm9jdXM6IG51bGwsCiAgICAgIGZvdjogbnVsbCwKICAgICAgYXNwZWN0OiBudWxsLAogICAgICBuZWFyOiBudWxsLAogICAgICBmYXI6IG51bGwsCiAgICAgIHpvb206IG51bGwsCiAgICAgIGV5ZVNlcDogbnVsbAogICAgfTsKICB9CiAgdXBkYXRlKGNhbWVyYSkgewogICAgY29uc3QgY2FjaGUgPSB0aGlzLl9jYWNoZTsKICAgIGNvbnN0IG5lZWRzVXBkYXRlID0gY2FjaGUuZm9jdXMgIT09IGNhbWVyYS5mb2N1cyB8fCBjYWNoZS5mb3YgIT09IGNhbWVyYS5mb3YgfHwgY2FjaGUuYXNwZWN0ICE9PSBjYW1lcmEuYXNwZWN0ICogdGhpcy5hc3BlY3QgfHwgY2FjaGUubmVhciAhPT0gY2FtZXJhLm5lYXIgfHwgY2FjaGUuZmFyICE9PSBjYW1lcmEuZmFyIHx8IGNhY2hlLnpvb20gIT09IGNhbWVyYS56b29tIHx8IGNhY2hlLmV5ZVNlcCAhPT0gdGhpcy5leWVTZXA7CiAgICBpZiAobmVlZHNVcGRhdGUpIHsKICAgICAgY2FjaGUuZm9jdXMgPSBjYW1lcmEuZm9jdXM7CiAgICAgIGNhY2hlLmZvdiA9IGNhbWVyYS5mb3Y7CiAgICAgIGNhY2hlLmFzcGVjdCA9IGNhbWVyYS5hc3BlY3QgKiB0aGlzLmFzcGVjdDsKICAgICAgY2FjaGUubmVhciA9IGNhbWVyYS5uZWFyOwogICAgICBjYWNoZS5mYXIgPSBjYW1lcmEuZmFyOwogICAgICBjYWNoZS56b29tID0gY2FtZXJhLnpvb207CiAgICAgIGNhY2hlLmV5ZVNlcCA9IHRoaXMuZXllU2VwOwogICAgICBfcHJvamVjdGlvbk1hdHJpeC5jb3B5KGNhbWVyYS5wcm9qZWN0aW9uTWF0cml4KTsKICAgICAgY29uc3QgZXllU2VwSGFsZiA9IGNhY2hlLmV5ZVNlcCAvIDI7CiAgICAgIGNvbnN0IGV5ZVNlcE9uUHJvamVjdGlvbiA9IGV5ZVNlcEhhbGYgKiBjYWNoZS5uZWFyIC8gY2FjaGUuZm9jdXM7CiAgICAgIGNvbnN0IHltYXggPSBjYWNoZS5uZWFyICogTWF0aC50YW4oREVHMlJBRCAqIGNhY2hlLmZvdiAqIDAuNSkgLyBjYWNoZS56b29tOwogICAgICBsZXQgeG1pbiwgeG1heDsKICAgICAgX2V5ZUxlZnQuZWxlbWVudHNbMTJdID0gLWV5ZVNlcEhhbGY7CiAgICAgIF9leWVSaWdodC5lbGVtZW50c1sxMl0gPSBleWVTZXBIYWxmOwogICAgICB4bWluID0gLXltYXggKiBjYWNoZS5hc3BlY3QgKyBleWVTZXBPblByb2plY3Rpb247CiAgICAgIHhtYXggPSB5bWF4ICogY2FjaGUuYXNwZWN0ICsgZXllU2VwT25Qcm9qZWN0aW9uOwogICAgICBfcHJvamVjdGlvbk1hdHJpeC5lbGVtZW50c1swXSA9IDIgKiBjYWNoZS5uZWFyIC8gKHhtYXggLSB4bWluKTsKICAgICAgX3Byb2plY3Rpb25NYXRyaXguZWxlbWVudHNbOF0gPSAoeG1heCArIHhtaW4pIC8gKHhtYXggLSB4bWluKTsKICAgICAgdGhpcy5jYW1lcmFMLnByb2plY3Rpb25NYXRyaXguY29weShfcHJvamVjdGlvbk1hdHJpeCk7CiAgICAgIHhtaW4gPSAteW1heCAqIGNhY2hlLmFzcGVjdCAtIGV5ZVNlcE9uUHJvamVjdGlvbjsKICAgICAgeG1heCA9IHltYXggKiBjYWNoZS5hc3BlY3QgLSBleWVTZXBPblByb2plY3Rpb247CiAgICAgIF9wcm9qZWN0aW9uTWF0cml4LmVsZW1lbnRzWzBdID0gMiAqIGNhY2hlLm5lYXIgLyAoeG1heCAtIHhtaW4pOwogICAgICBfcHJvamVjdGlvbk1hdHJpeC5lbGVtZW50c1s4XSA9ICh4bWF4ICsgeG1pbikgLyAoeG1heCAtIHhtaW4pOwogICAgICB0aGlzLmNhbWVyYVIucHJvamVjdGlvbk1hdHJpeC5jb3B5KF9wcm9qZWN0aW9uTWF0cml4KTsKICAgIH0KICAgIHRoaXMuY2FtZXJhTC5tYXRyaXhXb3JsZC5jb3B5KGNhbWVyYS5tYXRyaXhXb3JsZCkubXVsdGlwbHkoX2V5ZUxlZnQpOwogICAgdGhpcy5jYW1lcmFSLm1hdHJpeFdvcmxkLmNvcHkoY2FtZXJhLm1hdHJpeFdvcmxkKS5tdWx0aXBseShfZXllUmlnaHQpOwogIH0KfQpjbGFzcyBDbG9jayB7CiAgY29uc3RydWN0b3IoYXV0b1N0YXJ0ID0gdHJ1ZSkgewogICAgdGhpcy5hdXRvU3RhcnQgPSBhdXRvU3RhcnQ7CiAgICB0aGlzLnN0YXJ0VGltZSA9IDA7CiAgICB0aGlzLm9sZFRpbWUgPSAwOwogICAgdGhpcy5lbGFwc2VkVGltZSA9IDA7CiAgICB0aGlzLnJ1bm5pbmcgPSBmYWxzZTsKICB9CiAgc3RhcnQoKSB7CiAgICB0aGlzLnN0YXJ0VGltZSA9IG5vdygpOwogICAgdGhpcy5vbGRUaW1lID0gdGhpcy5zdGFydFRpbWU7CiAgICB0aGlzLmVsYXBzZWRUaW1lID0gMDsKICAgIHRoaXMucnVubmluZyA9IHRydWU7CiAgfQogIHN0b3AoKSB7CiAgICB0aGlzLmdldEVsYXBzZWRUaW1lKCk7CiAgICB0aGlzLnJ1bm5pbmcgPSBmYWxzZTsKICAgIHRoaXMuYXV0b1N0YXJ0ID0gZmFsc2U7CiAgfQogIGdldEVsYXBzZWRUaW1lKCkgewogICAgdGhpcy5nZXREZWx0YSgpOwogICAgcmV0dXJuIHRoaXMuZWxhcHNlZFRpbWU7CiAgfQogIGdldERlbHRhKCkgewogICAgbGV0IGRpZmYgPSAwOwogICAgaWYgKHRoaXMuYXV0b1N0YXJ0ICYmICF0aGlzLnJ1bm5pbmcpIHsKICAgICAgdGhpcy5zdGFydCgpOwogICAgICByZXR1cm4gMDsKICAgIH0KICAgIGlmICh0aGlzLnJ1bm5pbmcpIHsKICAgICAgY29uc3QgbmV3VGltZSA9IG5vdygpOwogICAgICBkaWZmID0gKG5ld1RpbWUgLSB0aGlzLm9sZFRpbWUpIC8gMWUzOwogICAgICB0aGlzLm9sZFRpbWUgPSBuZXdUaW1lOwogICAgICB0aGlzLmVsYXBzZWRUaW1lICs9IGRpZmY7CiAgICB9CiAgICByZXR1cm4gZGlmZjsKICB9Cn0KZnVuY3Rpb24gbm93KCkgewogIHJldHVybiAodHlwZW9mIHBlcmZvcm1hbmNlID09PSAidW5kZWZpbmVkIiA/IERhdGUgOiBwZXJmb3JtYW5jZSkubm93KCk7Cn0KY29uc3QgX3Bvc2l0aW9uJDEgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3F1YXRlcm5pb24kMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgUXVhdGVybmlvbigpOwpjb25zdCBfc2NhbGUkMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfb3JpZW50YXRpb24kMSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjbGFzcyBBdWRpb0xpc3RlbmVyIGV4dGVuZHMgT2JqZWN0M0QgewogIGNvbnN0cnVjdG9yKCkgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJBdWRpb0xpc3RlbmVyIjsKICAgIHRoaXMuY29udGV4dCA9IEF1ZGlvQ29udGV4dC5nZXRDb250ZXh0KCk7CiAgICB0aGlzLmdhaW4gPSB0aGlzLmNvbnRleHQuY3JlYXRlR2FpbigpOwogICAgdGhpcy5nYWluLmNvbm5lY3QodGhpcy5jb250ZXh0LmRlc3RpbmF0aW9uKTsKICAgIHRoaXMuZmlsdGVyID0gbnVsbDsKICAgIHRoaXMudGltZURlbHRhID0gMDsKICAgIHRoaXMuX2Nsb2NrID0gbmV3IENsb2NrKCk7CiAgfQogIGdldElucHV0KCkgewogICAgcmV0dXJuIHRoaXMuZ2FpbjsKICB9CiAgcmVtb3ZlRmlsdGVyKCkgewogICAgaWYgKHRoaXMuZmlsdGVyICE9PSBudWxsKSB7CiAgICAgIHRoaXMuZ2Fpbi5kaXNjb25uZWN0KHRoaXMuZmlsdGVyKTsKICAgICAgdGhpcy5maWx0ZXIuZGlzY29ubmVjdCh0aGlzLmNvbnRleHQuZGVzdGluYXRpb24pOwogICAgICB0aGlzLmdhaW4uY29ubmVjdCh0aGlzLmNvbnRleHQuZGVzdGluYXRpb24pOwogICAgICB0aGlzLmZpbHRlciA9IG51bGw7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9CiAgZ2V0RmlsdGVyKCkgewogICAgcmV0dXJuIHRoaXMuZmlsdGVyOwogIH0KICBzZXRGaWx0ZXIodmFsdWUpIHsKICAgIGlmICh0aGlzLmZpbHRlciAhPT0gbnVsbCkgewogICAgICB0aGlzLmdhaW4uZGlzY29ubmVjdCh0aGlzLmZpbHRlcik7CiAgICAgIHRoaXMuZmlsdGVyLmRpc2Nvbm5lY3QodGhpcy5jb250ZXh0LmRlc3RpbmF0aW9uKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZ2Fpbi5kaXNjb25uZWN0KHRoaXMuY29udGV4dC5kZXN0aW5hdGlvbik7CiAgICB9CiAgICB0aGlzLmZpbHRlciA9IHZhbHVlOwogICAgdGhpcy5nYWluLmNvbm5lY3QodGhpcy5maWx0ZXIpOwogICAgdGhpcy5maWx0ZXIuY29ubmVjdCh0aGlzLmNvbnRleHQuZGVzdGluYXRpb24pOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGdldE1hc3RlclZvbHVtZSgpIHsKICAgIHJldHVybiB0aGlzLmdhaW4uZ2Fpbi52YWx1ZTsKICB9CiAgc2V0TWFzdGVyVm9sdW1lKHZhbHVlKSB7CiAgICB0aGlzLmdhaW4uZ2Fpbi5zZXRUYXJnZXRBdFRpbWUodmFsdWUsIHRoaXMuY29udGV4dC5jdXJyZW50VGltZSwgMC4wMSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgdXBkYXRlTWF0cml4V29ybGQoZm9yY2UpIHsKICAgIHN1cGVyLnVwZGF0ZU1hdHJpeFdvcmxkKGZvcmNlKTsKICAgIGNvbnN0IGxpc3RlbmVyID0gdGhpcy5jb250ZXh0Lmxpc3RlbmVyOwogICAgY29uc3QgdXAgPSB0aGlzLnVwOwogICAgdGhpcy50aW1lRGVsdGEgPSB0aGlzLl9jbG9jay5nZXREZWx0YSgpOwogICAgdGhpcy5tYXRyaXhXb3JsZC5kZWNvbXBvc2UoX3Bvc2l0aW9uJDEsIF9xdWF0ZXJuaW9uJDEsIF9zY2FsZSQxKTsKICAgIF9vcmllbnRhdGlvbiQxLnNldCgwLCAwLCAtMSkuYXBwbHlRdWF0ZXJuaW9uKF9xdWF0ZXJuaW9uJDEpOwogICAgaWYgKGxpc3RlbmVyLnBvc2l0aW9uWCkgewogICAgICBjb25zdCBlbmRUaW1lID0gdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lICsgdGhpcy50aW1lRGVsdGE7CiAgICAgIGxpc3RlbmVyLnBvc2l0aW9uWC5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZShfcG9zaXRpb24kMS54LCBlbmRUaW1lKTsKICAgICAgbGlzdGVuZXIucG9zaXRpb25ZLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKF9wb3NpdGlvbiQxLnksIGVuZFRpbWUpOwogICAgICBsaXN0ZW5lci5wb3NpdGlvbloubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoX3Bvc2l0aW9uJDEueiwgZW5kVGltZSk7CiAgICAgIGxpc3RlbmVyLmZvcndhcmRYLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKF9vcmllbnRhdGlvbiQxLngsIGVuZFRpbWUpOwogICAgICBsaXN0ZW5lci5mb3J3YXJkWS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZShfb3JpZW50YXRpb24kMS55LCBlbmRUaW1lKTsKICAgICAgbGlzdGVuZXIuZm9yd2FyZFoubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoX29yaWVudGF0aW9uJDEueiwgZW5kVGltZSk7CiAgICAgIGxpc3RlbmVyLnVwWC5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh1cC54LCBlbmRUaW1lKTsKICAgICAgbGlzdGVuZXIudXBZLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKHVwLnksIGVuZFRpbWUpOwogICAgICBsaXN0ZW5lci51cFoubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodXAueiwgZW5kVGltZSk7CiAgICB9IGVsc2UgewogICAgICBsaXN0ZW5lci5zZXRQb3NpdGlvbihfcG9zaXRpb24kMS54LCBfcG9zaXRpb24kMS55LCBfcG9zaXRpb24kMS56KTsKICAgICAgbGlzdGVuZXIuc2V0T3JpZW50YXRpb24oX29yaWVudGF0aW9uJDEueCwgX29yaWVudGF0aW9uJDEueSwgX29yaWVudGF0aW9uJDEueiwgdXAueCwgdXAueSwgdXAueik7CiAgICB9CiAgfQp9CmNsYXNzIEF1ZGlvIGV4dGVuZHMgT2JqZWN0M0QgewogIGNvbnN0cnVjdG9yKGxpc3RlbmVyKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy50eXBlID0gIkF1ZGlvIjsKICAgIHRoaXMubGlzdGVuZXIgPSBsaXN0ZW5lcjsKICAgIHRoaXMuY29udGV4dCA9IGxpc3RlbmVyLmNvbnRleHQ7CiAgICB0aGlzLmdhaW4gPSB0aGlzLmNvbnRleHQuY3JlYXRlR2FpbigpOwogICAgdGhpcy5nYWluLmNvbm5lY3QobGlzdGVuZXIuZ2V0SW5wdXQoKSk7CiAgICB0aGlzLmF1dG9wbGF5ID0gZmFsc2U7CiAgICB0aGlzLmJ1ZmZlciA9IG51bGw7CiAgICB0aGlzLmRldHVuZSA9IDA7CiAgICB0aGlzLmxvb3AgPSBmYWxzZTsKICAgIHRoaXMubG9vcFN0YXJ0ID0gMDsKICAgIHRoaXMubG9vcEVuZCA9IDA7CiAgICB0aGlzLm9mZnNldCA9IDA7CiAgICB0aGlzLmR1cmF0aW9uID0gdm9pZCAwOwogICAgdGhpcy5wbGF5YmFja1JhdGUgPSAxOwogICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTsKICAgIHRoaXMuaGFzUGxheWJhY2tDb250cm9sID0gdHJ1ZTsKICAgIHRoaXMuc291cmNlID0gbnVsbDsKICAgIHRoaXMuc291cmNlVHlwZSA9ICJlbXB0eSI7CiAgICB0aGlzLl9zdGFydGVkQXQgPSAwOwogICAgdGhpcy5fcHJvZ3Jlc3MgPSAwOwogICAgdGhpcy5fY29ubmVjdGVkID0gZmFsc2U7CiAgICB0aGlzLmZpbHRlcnMgPSBbXTsKICB9CiAgZ2V0T3V0cHV0KCkgewogICAgcmV0dXJuIHRoaXMuZ2FpbjsKICB9CiAgc2V0Tm9kZVNvdXJjZShhdWRpb05vZGUpIHsKICAgIHRoaXMuaGFzUGxheWJhY2tDb250cm9sID0gZmFsc2U7CiAgICB0aGlzLnNvdXJjZVR5cGUgPSAiYXVkaW9Ob2RlIjsKICAgIHRoaXMuc291cmNlID0gYXVkaW9Ob2RlOwogICAgdGhpcy5jb25uZWN0KCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0TWVkaWFFbGVtZW50U291cmNlKG1lZGlhRWxlbWVudCkgewogICAgdGhpcy5oYXNQbGF5YmFja0NvbnRyb2wgPSBmYWxzZTsKICAgIHRoaXMuc291cmNlVHlwZSA9ICJtZWRpYU5vZGUiOwogICAgdGhpcy5zb3VyY2UgPSB0aGlzLmNvbnRleHQuY3JlYXRlTWVkaWFFbGVtZW50U291cmNlKG1lZGlhRWxlbWVudCk7CiAgICB0aGlzLmNvbm5lY3QoKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRNZWRpYVN0cmVhbVNvdXJjZShtZWRpYVN0cmVhbSkgewogICAgdGhpcy5oYXNQbGF5YmFja0NvbnRyb2wgPSBmYWxzZTsKICAgIHRoaXMuc291cmNlVHlwZSA9ICJtZWRpYVN0cmVhbU5vZGUiOwogICAgdGhpcy5zb3VyY2UgPSB0aGlzLmNvbnRleHQuY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2UobWVkaWFTdHJlYW0pOwogICAgdGhpcy5jb25uZWN0KCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0QnVmZmVyKGF1ZGlvQnVmZmVyKSB7CiAgICB0aGlzLmJ1ZmZlciA9IGF1ZGlvQnVmZmVyOwogICAgdGhpcy5zb3VyY2VUeXBlID0gImJ1ZmZlciI7CiAgICBpZiAodGhpcy5hdXRvcGxheSkKICAgICAgdGhpcy5wbGF5KCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgcGxheShkZWxheSA9IDApIHsKICAgIGlmICh0aGlzLmlzUGxheWluZyA9PT0gdHJ1ZSkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkF1ZGlvOiBBdWRpbyBpcyBhbHJlYWR5IHBsYXlpbmcuIik7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICh0aGlzLmhhc1BsYXliYWNrQ29udHJvbCA9PT0gZmFsc2UpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5BdWRpbzogdGhpcyBBdWRpbyBoYXMgbm8gcGxheWJhY2sgY29udHJvbC4iKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgdGhpcy5fc3RhcnRlZEF0ID0gdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lICsgZGVsYXk7CiAgICBjb25zdCBzb3VyY2UgPSB0aGlzLmNvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7CiAgICBzb3VyY2UuYnVmZmVyID0gdGhpcy5idWZmZXI7CiAgICBzb3VyY2UubG9vcCA9IHRoaXMubG9vcDsKICAgIHNvdXJjZS5sb29wU3RhcnQgPSB0aGlzLmxvb3BTdGFydDsKICAgIHNvdXJjZS5sb29wRW5kID0gdGhpcy5sb29wRW5kOwogICAgc291cmNlLm9uZW5kZWQgPSB0aGlzLm9uRW5kZWQuYmluZCh0aGlzKTsKICAgIHNvdXJjZS5zdGFydCh0aGlzLl9zdGFydGVkQXQsIHRoaXMuX3Byb2dyZXNzICsgdGhpcy5vZmZzZXQsIHRoaXMuZHVyYXRpb24pOwogICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlOwogICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7CiAgICB0aGlzLnNldERldHVuZSh0aGlzLmRldHVuZSk7CiAgICB0aGlzLnNldFBsYXliYWNrUmF0ZSh0aGlzLnBsYXliYWNrUmF0ZSk7CiAgICByZXR1cm4gdGhpcy5jb25uZWN0KCk7CiAgfQogIHBhdXNlKCkgewogICAgaWYgKHRoaXMuaGFzUGxheWJhY2tDb250cm9sID09PSBmYWxzZSkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkF1ZGlvOiB0aGlzIEF1ZGlvIGhhcyBubyBwbGF5YmFjayBjb250cm9sLiIpOwogICAgICByZXR1cm47CiAgICB9CiAgICBpZiAodGhpcy5pc1BsYXlpbmcgPT09IHRydWUpIHsKICAgICAgdGhpcy5fcHJvZ3Jlc3MgKz0gTWF0aC5tYXgodGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lIC0gdGhpcy5fc3RhcnRlZEF0LCAwKSAqIHRoaXMucGxheWJhY2tSYXRlOwogICAgICBpZiAodGhpcy5sb29wID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy5fcHJvZ3Jlc3MgPSB0aGlzLl9wcm9ncmVzcyAlICh0aGlzLmR1cmF0aW9uIHx8IHRoaXMuYnVmZmVyLmR1cmF0aW9uKTsKICAgICAgfQogICAgICB0aGlzLnNvdXJjZS5zdG9wKCk7CiAgICAgIHRoaXMuc291cmNlLm9uZW5kZWQgPSBudWxsOwogICAgICB0aGlzLmlzUGxheWluZyA9IGZhbHNlOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIHN0b3AoKSB7CiAgICBpZiAodGhpcy5oYXNQbGF5YmFja0NvbnRyb2wgPT09IGZhbHNlKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuQXVkaW86IHRoaXMgQXVkaW8gaGFzIG5vIHBsYXliYWNrIGNvbnRyb2wuIik7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHRoaXMuX3Byb2dyZXNzID0gMDsKICAgIHRoaXMuc291cmNlLnN0b3AoKTsKICAgIHRoaXMuc291cmNlLm9uZW5kZWQgPSBudWxsOwogICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTsKICAgIHJldHVybiB0aGlzOwogIH0KICBjb25uZWN0KCkgewogICAgaWYgKHRoaXMuZmlsdGVycy5sZW5ndGggPiAwKSB7CiAgICAgIHRoaXMuc291cmNlLmNvbm5lY3QodGhpcy5maWx0ZXJzWzBdKTsKICAgICAgZm9yIChsZXQgaSA9IDEsIGwgPSB0aGlzLmZpbHRlcnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgdGhpcy5maWx0ZXJzW2kgLSAxXS5jb25uZWN0KHRoaXMuZmlsdGVyc1tpXSk7CiAgICAgIH0KICAgICAgdGhpcy5maWx0ZXJzW3RoaXMuZmlsdGVycy5sZW5ndGggLSAxXS5jb25uZWN0KHRoaXMuZ2V0T3V0cHV0KCkpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5zb3VyY2UuY29ubmVjdCh0aGlzLmdldE91dHB1dCgpKTsKICAgIH0KICAgIHRoaXMuX2Nvbm5lY3RlZCA9IHRydWU7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZGlzY29ubmVjdCgpIHsKICAgIGlmICh0aGlzLmZpbHRlcnMubGVuZ3RoID4gMCkgewogICAgICB0aGlzLnNvdXJjZS5kaXNjb25uZWN0KHRoaXMuZmlsdGVyc1swXSk7CiAgICAgIGZvciAobGV0IGkgPSAxLCBsID0gdGhpcy5maWx0ZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHRoaXMuZmlsdGVyc1tpIC0gMV0uZGlzY29ubmVjdCh0aGlzLmZpbHRlcnNbaV0pOwogICAgICB9CiAgICAgIHRoaXMuZmlsdGVyc1t0aGlzLmZpbHRlcnMubGVuZ3RoIC0gMV0uZGlzY29ubmVjdCh0aGlzLmdldE91dHB1dCgpKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuc291cmNlLmRpc2Nvbm5lY3QodGhpcy5nZXRPdXRwdXQoKSk7CiAgICB9CiAgICB0aGlzLl9jb25uZWN0ZWQgPSBmYWxzZTsKICAgIHJldHVybiB0aGlzOwogIH0KICBnZXRGaWx0ZXJzKCkgewogICAgcmV0dXJuIHRoaXMuZmlsdGVyczsKICB9CiAgc2V0RmlsdGVycyh2YWx1ZSkgewogICAgaWYgKCF2YWx1ZSkKICAgICAgdmFsdWUgPSBbXTsKICAgIGlmICh0aGlzLl9jb25uZWN0ZWQgPT09IHRydWUpIHsKICAgICAgdGhpcy5kaXNjb25uZWN0KCk7CiAgICAgIHRoaXMuZmlsdGVycyA9IHZhbHVlLnNsaWNlKCk7CiAgICAgIHRoaXMuY29ubmVjdCgpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5maWx0ZXJzID0gdmFsdWUuc2xpY2UoKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBzZXREZXR1bmUodmFsdWUpIHsKICAgIHRoaXMuZGV0dW5lID0gdmFsdWU7CiAgICBpZiAodGhpcy5zb3VyY2UuZGV0dW5lID09PSB2b2lkIDApCiAgICAgIHJldHVybjsKICAgIGlmICh0aGlzLmlzUGxheWluZyA9PT0gdHJ1ZSkgewogICAgICB0aGlzLnNvdXJjZS5kZXR1bmUuc2V0VGFyZ2V0QXRUaW1lKHRoaXMuZGV0dW5lLCB0aGlzLmNvbnRleHQuY3VycmVudFRpbWUsIDAuMDEpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGdldERldHVuZSgpIHsKICAgIHJldHVybiB0aGlzLmRldHVuZTsKICB9CiAgZ2V0RmlsdGVyKCkgewogICAgcmV0dXJuIHRoaXMuZ2V0RmlsdGVycygpWzBdOwogIH0KICBzZXRGaWx0ZXIoZmlsdGVyKSB7CiAgICByZXR1cm4gdGhpcy5zZXRGaWx0ZXJzKGZpbHRlciA/IFtmaWx0ZXJdIDogW10pOwogIH0KICBzZXRQbGF5YmFja1JhdGUodmFsdWUpIHsKICAgIGlmICh0aGlzLmhhc1BsYXliYWNrQ29udHJvbCA9PT0gZmFsc2UpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5BdWRpbzogdGhpcyBBdWRpbyBoYXMgbm8gcGxheWJhY2sgY29udHJvbC4iKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgdGhpcy5wbGF5YmFja1JhdGUgPSB2YWx1ZTsKICAgIGlmICh0aGlzLmlzUGxheWluZyA9PT0gdHJ1ZSkgewogICAgICB0aGlzLnNvdXJjZS5wbGF5YmFja1JhdGUuc2V0VGFyZ2V0QXRUaW1lKHRoaXMucGxheWJhY2tSYXRlLCB0aGlzLmNvbnRleHQuY3VycmVudFRpbWUsIDAuMDEpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGdldFBsYXliYWNrUmF0ZSgpIHsKICAgIHJldHVybiB0aGlzLnBsYXliYWNrUmF0ZTsKICB9CiAgb25FbmRlZCgpIHsKICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7CiAgfQogIGdldExvb3AoKSB7CiAgICBpZiAodGhpcy5oYXNQbGF5YmFja0NvbnRyb2wgPT09IGZhbHNlKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuQXVkaW86IHRoaXMgQXVkaW8gaGFzIG5vIHBsYXliYWNrIGNvbnRyb2wuIik7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHJldHVybiB0aGlzLmxvb3A7CiAgfQogIHNldExvb3AodmFsdWUpIHsKICAgIGlmICh0aGlzLmhhc1BsYXliYWNrQ29udHJvbCA9PT0gZmFsc2UpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5BdWRpbzogdGhpcyBBdWRpbyBoYXMgbm8gcGxheWJhY2sgY29udHJvbC4iKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgdGhpcy5sb29wID0gdmFsdWU7CiAgICBpZiAodGhpcy5pc1BsYXlpbmcgPT09IHRydWUpIHsKICAgICAgdGhpcy5zb3VyY2UubG9vcCA9IHRoaXMubG9vcDsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRMb29wU3RhcnQodmFsdWUpIHsKICAgIHRoaXMubG9vcFN0YXJ0ID0gdmFsdWU7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0TG9vcEVuZCh2YWx1ZSkgewogICAgdGhpcy5sb29wRW5kID0gdmFsdWU7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZ2V0Vm9sdW1lKCkgewogICAgcmV0dXJuIHRoaXMuZ2Fpbi5nYWluLnZhbHVlOwogIH0KICBzZXRWb2x1bWUodmFsdWUpIHsKICAgIHRoaXMuZ2Fpbi5nYWluLnNldFRhcmdldEF0VGltZSh2YWx1ZSwgdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lLCAwLjAxKTsKICAgIHJldHVybiB0aGlzOwogIH0KfQpjb25zdCBfcG9zaXRpb24gPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3F1YXRlcm5pb24gPSAvKiBAX19QVVJFX18gKi8gbmV3IFF1YXRlcm5pb24oKTsKY29uc3QgX3NjYWxlID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF9vcmllbnRhdGlvbiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjbGFzcyBQb3NpdGlvbmFsQXVkaW8gZXh0ZW5kcyBBdWRpbyB7CiAgY29uc3RydWN0b3IobGlzdGVuZXIpIHsKICAgIHN1cGVyKGxpc3RlbmVyKTsKICAgIHRoaXMucGFubmVyID0gdGhpcy5jb250ZXh0LmNyZWF0ZVBhbm5lcigpOwogICAgdGhpcy5wYW5uZXIucGFubmluZ01vZGVsID0gIkhSVEYiOwogICAgdGhpcy5wYW5uZXIuY29ubmVjdCh0aGlzLmdhaW4pOwogIH0KICBnZXRPdXRwdXQoKSB7CiAgICByZXR1cm4gdGhpcy5wYW5uZXI7CiAgfQogIGdldFJlZkRpc3RhbmNlKCkgewogICAgcmV0dXJuIHRoaXMucGFubmVyLnJlZkRpc3RhbmNlOwogIH0KICBzZXRSZWZEaXN0YW5jZSh2YWx1ZSkgewogICAgdGhpcy5wYW5uZXIucmVmRGlzdGFuY2UgPSB2YWx1ZTsKICAgIHJldHVybiB0aGlzOwogIH0KICBnZXRSb2xsb2ZmRmFjdG9yKCkgewogICAgcmV0dXJuIHRoaXMucGFubmVyLnJvbGxvZmZGYWN0b3I7CiAgfQogIHNldFJvbGxvZmZGYWN0b3IodmFsdWUpIHsKICAgIHRoaXMucGFubmVyLnJvbGxvZmZGYWN0b3IgPSB2YWx1ZTsKICAgIHJldHVybiB0aGlzOwogIH0KICBnZXREaXN0YW5jZU1vZGVsKCkgewogICAgcmV0dXJuIHRoaXMucGFubmVyLmRpc3RhbmNlTW9kZWw7CiAgfQogIHNldERpc3RhbmNlTW9kZWwodmFsdWUpIHsKICAgIHRoaXMucGFubmVyLmRpc3RhbmNlTW9kZWwgPSB2YWx1ZTsKICAgIHJldHVybiB0aGlzOwogIH0KICBnZXRNYXhEaXN0YW5jZSgpIHsKICAgIHJldHVybiB0aGlzLnBhbm5lci5tYXhEaXN0YW5jZTsKICB9CiAgc2V0TWF4RGlzdGFuY2UodmFsdWUpIHsKICAgIHRoaXMucGFubmVyLm1heERpc3RhbmNlID0gdmFsdWU7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0RGlyZWN0aW9uYWxDb25lKGNvbmVJbm5lckFuZ2xlLCBjb25lT3V0ZXJBbmdsZSwgY29uZU91dGVyR2FpbikgewogICAgdGhpcy5wYW5uZXIuY29uZUlubmVyQW5nbGUgPSBjb25lSW5uZXJBbmdsZTsKICAgIHRoaXMucGFubmVyLmNvbmVPdXRlckFuZ2xlID0gY29uZU91dGVyQW5nbGU7CiAgICB0aGlzLnBhbm5lci5jb25lT3V0ZXJHYWluID0gY29uZU91dGVyR2FpbjsKICAgIHJldHVybiB0aGlzOwogIH0KICB1cGRhdGVNYXRyaXhXb3JsZChmb3JjZSkgewogICAgc3VwZXIudXBkYXRlTWF0cml4V29ybGQoZm9yY2UpOwogICAgaWYgKHRoaXMuaGFzUGxheWJhY2tDb250cm9sID09PSB0cnVlICYmIHRoaXMuaXNQbGF5aW5nID09PSBmYWxzZSkKICAgICAgcmV0dXJuOwogICAgdGhpcy5tYXRyaXhXb3JsZC5kZWNvbXBvc2UoX3Bvc2l0aW9uLCBfcXVhdGVybmlvbiwgX3NjYWxlKTsKICAgIF9vcmllbnRhdGlvbi5zZXQoMCwgMCwgMSkuYXBwbHlRdWF0ZXJuaW9uKF9xdWF0ZXJuaW9uKTsKICAgIGNvbnN0IHBhbm5lciA9IHRoaXMucGFubmVyOwogICAgaWYgKHBhbm5lci5wb3NpdGlvblgpIHsKICAgICAgY29uc3QgZW5kVGltZSA9IHRoaXMuY29udGV4dC5jdXJyZW50VGltZSArIHRoaXMubGlzdGVuZXIudGltZURlbHRhOwogICAgICBwYW5uZXIucG9zaXRpb25YLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKF9wb3NpdGlvbi54LCBlbmRUaW1lKTsKICAgICAgcGFubmVyLnBvc2l0aW9uWS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZShfcG9zaXRpb24ueSwgZW5kVGltZSk7CiAgICAgIHBhbm5lci5wb3NpdGlvbloubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoX3Bvc2l0aW9uLnosIGVuZFRpbWUpOwogICAgICBwYW5uZXIub3JpZW50YXRpb25YLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKF9vcmllbnRhdGlvbi54LCBlbmRUaW1lKTsKICAgICAgcGFubmVyLm9yaWVudGF0aW9uWS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZShfb3JpZW50YXRpb24ueSwgZW5kVGltZSk7CiAgICAgIHBhbm5lci5vcmllbnRhdGlvbloubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoX29yaWVudGF0aW9uLnosIGVuZFRpbWUpOwogICAgfSBlbHNlIHsKICAgICAgcGFubmVyLnNldFBvc2l0aW9uKF9wb3NpdGlvbi54LCBfcG9zaXRpb24ueSwgX3Bvc2l0aW9uLnopOwogICAgICBwYW5uZXIuc2V0T3JpZW50YXRpb24oX29yaWVudGF0aW9uLngsIF9vcmllbnRhdGlvbi55LCBfb3JpZW50YXRpb24ueik7CiAgICB9CiAgfQp9CmNsYXNzIEF1ZGlvQW5hbHlzZXIgewogIGNvbnN0cnVjdG9yKGF1ZGlvLCBmZnRTaXplID0gMjA0OCkgewogICAgdGhpcy5hbmFseXNlciA9IGF1ZGlvLmNvbnRleHQuY3JlYXRlQW5hbHlzZXIoKTsKICAgIHRoaXMuYW5hbHlzZXIuZmZ0U2l6ZSA9IGZmdFNpemU7CiAgICB0aGlzLmRhdGEgPSBuZXcgVWludDhBcnJheSh0aGlzLmFuYWx5c2VyLmZyZXF1ZW5jeUJpbkNvdW50KTsKICAgIGF1ZGlvLmdldE91dHB1dCgpLmNvbm5lY3QodGhpcy5hbmFseXNlcik7CiAgfQogIGdldEZyZXF1ZW5jeURhdGEoKSB7CiAgICB0aGlzLmFuYWx5c2VyLmdldEJ5dGVGcmVxdWVuY3lEYXRhKHRoaXMuZGF0YSk7CiAgICByZXR1cm4gdGhpcy5kYXRhOwogIH0KICBnZXRBdmVyYWdlRnJlcXVlbmN5KCkgewogICAgbGV0IHZhbHVlID0gMDsKICAgIGNvbnN0IGRhdGEgPSB0aGlzLmdldEZyZXF1ZW5jeURhdGEoKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgewogICAgICB2YWx1ZSArPSBkYXRhW2ldOwogICAgfQogICAgcmV0dXJuIHZhbHVlIC8gZGF0YS5sZW5ndGg7CiAgfQp9CmNsYXNzIFByb3BlcnR5TWl4ZXIgewogIGNvbnN0cnVjdG9yKGJpbmRpbmcsIHR5cGVOYW1lLCB2YWx1ZVNpemUpIHsKICAgIHRoaXMuYmluZGluZyA9IGJpbmRpbmc7CiAgICB0aGlzLnZhbHVlU2l6ZSA9IHZhbHVlU2l6ZTsKICAgIGxldCBtaXhGdW5jdGlvbiwgbWl4RnVuY3Rpb25BZGRpdGl2ZSwgc2V0SWRlbnRpdHk7CiAgICBzd2l0Y2ggKHR5cGVOYW1lKSB7CiAgICAgIGNhc2UgInF1YXRlcm5pb24iOgogICAgICAgIG1peEZ1bmN0aW9uID0gdGhpcy5fc2xlcnA7CiAgICAgICAgbWl4RnVuY3Rpb25BZGRpdGl2ZSA9IHRoaXMuX3NsZXJwQWRkaXRpdmU7CiAgICAgICAgc2V0SWRlbnRpdHkgPSB0aGlzLl9zZXRBZGRpdGl2ZUlkZW50aXR5UXVhdGVybmlvbjsKICAgICAgICB0aGlzLmJ1ZmZlciA9IG5ldyBGbG9hdDY0QXJyYXkodmFsdWVTaXplICogNik7CiAgICAgICAgdGhpcy5fd29ya0luZGV4ID0gNTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAic3RyaW5nIjoKICAgICAgY2FzZSAiYm9vbCI6CiAgICAgICAgbWl4RnVuY3Rpb24gPSB0aGlzLl9zZWxlY3Q7CiAgICAgICAgbWl4RnVuY3Rpb25BZGRpdGl2ZSA9IHRoaXMuX3NlbGVjdDsKICAgICAgICBzZXRJZGVudGl0eSA9IHRoaXMuX3NldEFkZGl0aXZlSWRlbnRpdHlPdGhlcjsKICAgICAgICB0aGlzLmJ1ZmZlciA9IG5ldyBBcnJheSh2YWx1ZVNpemUgKiA1KTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICBtaXhGdW5jdGlvbiA9IHRoaXMuX2xlcnA7CiAgICAgICAgbWl4RnVuY3Rpb25BZGRpdGl2ZSA9IHRoaXMuX2xlcnBBZGRpdGl2ZTsKICAgICAgICBzZXRJZGVudGl0eSA9IHRoaXMuX3NldEFkZGl0aXZlSWRlbnRpdHlOdW1lcmljOwogICAgICAgIHRoaXMuYnVmZmVyID0gbmV3IEZsb2F0NjRBcnJheSh2YWx1ZVNpemUgKiA1KTsKICAgIH0KICAgIHRoaXMuX21peEJ1ZmZlclJlZ2lvbiA9IG1peEZ1bmN0aW9uOwogICAgdGhpcy5fbWl4QnVmZmVyUmVnaW9uQWRkaXRpdmUgPSBtaXhGdW5jdGlvbkFkZGl0aXZlOwogICAgdGhpcy5fc2V0SWRlbnRpdHkgPSBzZXRJZGVudGl0eTsKICAgIHRoaXMuX29yaWdJbmRleCA9IDM7CiAgICB0aGlzLl9hZGRJbmRleCA9IDQ7CiAgICB0aGlzLmN1bXVsYXRpdmVXZWlnaHQgPSAwOwogICAgdGhpcy5jdW11bGF0aXZlV2VpZ2h0QWRkaXRpdmUgPSAwOwogICAgdGhpcy51c2VDb3VudCA9IDA7CiAgICB0aGlzLnJlZmVyZW5jZUNvdW50ID0gMDsKICB9CiAgYWNjdW11bGF0ZShhY2N1SW5kZXgsIHdlaWdodCkgewogICAgY29uc3QgYnVmZmVyID0gdGhpcy5idWZmZXIsIHN0cmlkZSA9IHRoaXMudmFsdWVTaXplLCBvZmZzZXQgPSBhY2N1SW5kZXggKiBzdHJpZGUgKyBzdHJpZGU7CiAgICBsZXQgY3VycmVudFdlaWdodCA9IHRoaXMuY3VtdWxhdGl2ZVdlaWdodDsKICAgIGlmIChjdXJyZW50V2VpZ2h0ID09PSAwKSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBzdHJpZGU7ICsraSkgewogICAgICAgIGJ1ZmZlcltvZmZzZXQgKyBpXSA9IGJ1ZmZlcltpXTsKICAgICAgfQogICAgICBjdXJyZW50V2VpZ2h0ID0gd2VpZ2h0OwogICAgfSBlbHNlIHsKICAgICAgY3VycmVudFdlaWdodCArPSB3ZWlnaHQ7CiAgICAgIGNvbnN0IG1peCA9IHdlaWdodCAvIGN1cnJlbnRXZWlnaHQ7CiAgICAgIHRoaXMuX21peEJ1ZmZlclJlZ2lvbihidWZmZXIsIG9mZnNldCwgMCwgbWl4LCBzdHJpZGUpOwogICAgfQogICAgdGhpcy5jdW11bGF0aXZlV2VpZ2h0ID0gY3VycmVudFdlaWdodDsKICB9CiAgYWNjdW11bGF0ZUFkZGl0aXZlKHdlaWdodCkgewogICAgY29uc3QgYnVmZmVyID0gdGhpcy5idWZmZXIsIHN0cmlkZSA9IHRoaXMudmFsdWVTaXplLCBvZmZzZXQgPSBzdHJpZGUgKiB0aGlzLl9hZGRJbmRleDsKICAgIGlmICh0aGlzLmN1bXVsYXRpdmVXZWlnaHRBZGRpdGl2ZSA9PT0gMCkgewogICAgICB0aGlzLl9zZXRJZGVudGl0eSgpOwogICAgfQogICAgdGhpcy5fbWl4QnVmZmVyUmVnaW9uQWRkaXRpdmUoYnVmZmVyLCBvZmZzZXQsIDAsIHdlaWdodCwgc3RyaWRlKTsKICAgIHRoaXMuY3VtdWxhdGl2ZVdlaWdodEFkZGl0aXZlICs9IHdlaWdodDsKICB9CiAgYXBwbHkoYWNjdUluZGV4KSB7CiAgICBjb25zdCBzdHJpZGUgPSB0aGlzLnZhbHVlU2l6ZSwgYnVmZmVyID0gdGhpcy5idWZmZXIsIG9mZnNldCA9IGFjY3VJbmRleCAqIHN0cmlkZSArIHN0cmlkZSwgd2VpZ2h0ID0gdGhpcy5jdW11bGF0aXZlV2VpZ2h0LCB3ZWlnaHRBZGRpdGl2ZSA9IHRoaXMuY3VtdWxhdGl2ZVdlaWdodEFkZGl0aXZlLCBiaW5kaW5nID0gdGhpcy5iaW5kaW5nOwogICAgdGhpcy5jdW11bGF0aXZlV2VpZ2h0ID0gMDsKICAgIHRoaXMuY3VtdWxhdGl2ZVdlaWdodEFkZGl0aXZlID0gMDsKICAgIGlmICh3ZWlnaHQgPCAxKSB7CiAgICAgIGNvbnN0IG9yaWdpbmFsVmFsdWVPZmZzZXQgPSBzdHJpZGUgKiB0aGlzLl9vcmlnSW5kZXg7CiAgICAgIHRoaXMuX21peEJ1ZmZlclJlZ2lvbihidWZmZXIsIG9mZnNldCwgb3JpZ2luYWxWYWx1ZU9mZnNldCwgMSAtIHdlaWdodCwgc3RyaWRlKTsKICAgIH0KICAgIGlmICh3ZWlnaHRBZGRpdGl2ZSA+IDApIHsKICAgICAgdGhpcy5fbWl4QnVmZmVyUmVnaW9uQWRkaXRpdmUoYnVmZmVyLCBvZmZzZXQsIHRoaXMuX2FkZEluZGV4ICogc3RyaWRlLCAxLCBzdHJpZGUpOwogICAgfQogICAgZm9yIChsZXQgaSA9IHN0cmlkZSwgZSA9IHN0cmlkZSArIHN0cmlkZTsgaSAhPT0gZTsgKytpKSB7CiAgICAgIGlmIChidWZmZXJbaV0gIT09IGJ1ZmZlcltpICsgc3RyaWRlXSkgewogICAgICAgIGJpbmRpbmcuc2V0VmFsdWUoYnVmZmVyLCBvZmZzZXQpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQogIHNhdmVPcmlnaW5hbFN0YXRlKCkgewogICAgY29uc3QgYmluZGluZyA9IHRoaXMuYmluZGluZzsKICAgIGNvbnN0IGJ1ZmZlciA9IHRoaXMuYnVmZmVyLCBzdHJpZGUgPSB0aGlzLnZhbHVlU2l6ZSwgb3JpZ2luYWxWYWx1ZU9mZnNldCA9IHN0cmlkZSAqIHRoaXMuX29yaWdJbmRleDsKICAgIGJpbmRpbmcuZ2V0VmFsdWUoYnVmZmVyLCBvcmlnaW5hbFZhbHVlT2Zmc2V0KTsKICAgIGZvciAobGV0IGkgPSBzdHJpZGUsIGUgPSBvcmlnaW5hbFZhbHVlT2Zmc2V0OyBpICE9PSBlOyArK2kpIHsKICAgICAgYnVmZmVyW2ldID0gYnVmZmVyW29yaWdpbmFsVmFsdWVPZmZzZXQgKyBpICUgc3RyaWRlXTsKICAgIH0KICAgIHRoaXMuX3NldElkZW50aXR5KCk7CiAgICB0aGlzLmN1bXVsYXRpdmVXZWlnaHQgPSAwOwogICAgdGhpcy5jdW11bGF0aXZlV2VpZ2h0QWRkaXRpdmUgPSAwOwogIH0KICByZXN0b3JlT3JpZ2luYWxTdGF0ZSgpIHsKICAgIGNvbnN0IG9yaWdpbmFsVmFsdWVPZmZzZXQgPSB0aGlzLnZhbHVlU2l6ZSAqIDM7CiAgICB0aGlzLmJpbmRpbmcuc2V0VmFsdWUodGhpcy5idWZmZXIsIG9yaWdpbmFsVmFsdWVPZmZzZXQpOwogIH0KICBfc2V0QWRkaXRpdmVJZGVudGl0eU51bWVyaWMoKSB7CiAgICBjb25zdCBzdGFydEluZGV4ID0gdGhpcy5fYWRkSW5kZXggKiB0aGlzLnZhbHVlU2l6ZTsKICAgIGNvbnN0IGVuZEluZGV4ID0gc3RhcnRJbmRleCArIHRoaXMudmFsdWVTaXplOwogICAgZm9yIChsZXQgaSA9IHN0YXJ0SW5kZXg7IGkgPCBlbmRJbmRleDsgaSsrKSB7CiAgICAgIHRoaXMuYnVmZmVyW2ldID0gMDsKICAgIH0KICB9CiAgX3NldEFkZGl0aXZlSWRlbnRpdHlRdWF0ZXJuaW9uKCkgewogICAgdGhpcy5fc2V0QWRkaXRpdmVJZGVudGl0eU51bWVyaWMoKTsKICAgIHRoaXMuYnVmZmVyW3RoaXMuX2FkZEluZGV4ICogdGhpcy52YWx1ZVNpemUgKyAzXSA9IDE7CiAgfQogIF9zZXRBZGRpdGl2ZUlkZW50aXR5T3RoZXIoKSB7CiAgICBjb25zdCBzdGFydEluZGV4ID0gdGhpcy5fb3JpZ0luZGV4ICogdGhpcy52YWx1ZVNpemU7CiAgICBjb25zdCB0YXJnZXRJbmRleCA9IHRoaXMuX2FkZEluZGV4ICogdGhpcy52YWx1ZVNpemU7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudmFsdWVTaXplOyBpKyspIHsKICAgICAgdGhpcy5idWZmZXJbdGFyZ2V0SW5kZXggKyBpXSA9IHRoaXMuYnVmZmVyW3N0YXJ0SW5kZXggKyBpXTsKICAgIH0KICB9CiAgX3NlbGVjdChidWZmZXIsIGRzdE9mZnNldCwgc3JjT2Zmc2V0LCB0LCBzdHJpZGUpIHsKICAgIGlmICh0ID49IDAuNSkgewogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gc3RyaWRlOyArK2kpIHsKICAgICAgICBidWZmZXJbZHN0T2Zmc2V0ICsgaV0gPSBidWZmZXJbc3JjT2Zmc2V0ICsgaV07CiAgICAgIH0KICAgIH0KICB9CiAgX3NsZXJwKGJ1ZmZlciwgZHN0T2Zmc2V0LCBzcmNPZmZzZXQsIHQpIHsKICAgIFF1YXRlcm5pb24uc2xlcnBGbGF0KGJ1ZmZlciwgZHN0T2Zmc2V0LCBidWZmZXIsIGRzdE9mZnNldCwgYnVmZmVyLCBzcmNPZmZzZXQsIHQpOwogIH0KICBfc2xlcnBBZGRpdGl2ZShidWZmZXIsIGRzdE9mZnNldCwgc3JjT2Zmc2V0LCB0LCBzdHJpZGUpIHsKICAgIGNvbnN0IHdvcmtPZmZzZXQgPSB0aGlzLl93b3JrSW5kZXggKiBzdHJpZGU7CiAgICBRdWF0ZXJuaW9uLm11bHRpcGx5UXVhdGVybmlvbnNGbGF0KGJ1ZmZlciwgd29ya09mZnNldCwgYnVmZmVyLCBkc3RPZmZzZXQsIGJ1ZmZlciwgc3JjT2Zmc2V0KTsKICAgIFF1YXRlcm5pb24uc2xlcnBGbGF0KGJ1ZmZlciwgZHN0T2Zmc2V0LCBidWZmZXIsIGRzdE9mZnNldCwgYnVmZmVyLCB3b3JrT2Zmc2V0LCB0KTsKICB9CiAgX2xlcnAoYnVmZmVyLCBkc3RPZmZzZXQsIHNyY09mZnNldCwgdCwgc3RyaWRlKSB7CiAgICBjb25zdCBzID0gMSAtIHQ7CiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gc3RyaWRlOyArK2kpIHsKICAgICAgY29uc3QgaiA9IGRzdE9mZnNldCArIGk7CiAgICAgIGJ1ZmZlcltqXSA9IGJ1ZmZlcltqXSAqIHMgKyBidWZmZXJbc3JjT2Zmc2V0ICsgaV0gKiB0OwogICAgfQogIH0KICBfbGVycEFkZGl0aXZlKGJ1ZmZlciwgZHN0T2Zmc2V0LCBzcmNPZmZzZXQsIHQsIHN0cmlkZSkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IHN0cmlkZTsgKytpKSB7CiAgICAgIGNvbnN0IGogPSBkc3RPZmZzZXQgKyBpOwogICAgICBidWZmZXJbal0gPSBidWZmZXJbal0gKyBidWZmZXJbc3JjT2Zmc2V0ICsgaV0gKiB0OwogICAgfQogIH0KfQpjb25zdCBfUkVTRVJWRURfQ0hBUlNfUkUgPSAiXFxbXFxdXFwuOlxcLyI7CmNvbnN0IF9yZXNlcnZlZFJlID0gbmV3IFJlZ0V4cCgiWyIgKyBfUkVTRVJWRURfQ0hBUlNfUkUgKyAiXSIsICJnIik7CmNvbnN0IF93b3JkQ2hhciA9ICJbXiIgKyBfUkVTRVJWRURfQ0hBUlNfUkUgKyAiXSI7CmNvbnN0IF93b3JkQ2hhck9yRG90ID0gIlteIiArIF9SRVNFUlZFRF9DSEFSU19SRS5yZXBsYWNlKCJcXC4iLCAiIikgKyAiXSI7CmNvbnN0IF9kaXJlY3RvcnlSZSA9IC8oKD86V0MrW1wvOl0pKikvLnNvdXJjZS5yZXBsYWNlKCJXQyIsIF93b3JkQ2hhcik7CmNvbnN0IF9ub2RlUmUgPSAvKFdDT0QrKT8vLnNvdXJjZS5yZXBsYWNlKCJXQ09EIiwgX3dvcmRDaGFyT3JEb3QpOwpjb25zdCBfb2JqZWN0UmUgPSAvKD86XC4oV0MrKSg/OlxbKC4rKVxdKT8pPy8uc291cmNlLnJlcGxhY2UoIldDIiwgX3dvcmRDaGFyKTsKY29uc3QgX3Byb3BlcnR5UmUgPSAvXC4oV0MrKSg/OlxbKC4rKVxdKT8vLnNvdXJjZS5yZXBsYWNlKCJXQyIsIF93b3JkQ2hhcik7CmNvbnN0IF90cmFja1JlID0gbmV3IFJlZ0V4cCgiXiIgKyBfZGlyZWN0b3J5UmUgKyBfbm9kZVJlICsgX29iamVjdFJlICsgX3Byb3BlcnR5UmUgKyAiJCIpOwpjb25zdCBfc3VwcG9ydGVkT2JqZWN0TmFtZXMgPSBbIm1hdGVyaWFsIiwgIm1hdGVyaWFscyIsICJib25lcyJdOwpjbGFzcyBDb21wb3NpdGUgewogIGNvbnN0cnVjdG9yKHRhcmdldEdyb3VwLCBwYXRoLCBvcHRpb25hbFBhcnNlZFBhdGgpIHsKICAgIGNvbnN0IHBhcnNlZFBhdGggPSBvcHRpb25hbFBhcnNlZFBhdGggfHwgUHJvcGVydHlCaW5kaW5nLnBhcnNlVHJhY2tOYW1lKHBhdGgpOwogICAgdGhpcy5fdGFyZ2V0R3JvdXAgPSB0YXJnZXRHcm91cDsKICAgIHRoaXMuX2JpbmRpbmdzID0gdGFyZ2V0R3JvdXAuc3Vic2NyaWJlXyhwYXRoLCBwYXJzZWRQYXRoKTsKICB9CiAgZ2V0VmFsdWUoYXJyYXksIG9mZnNldCkgewogICAgdGhpcy5iaW5kKCk7CiAgICBjb25zdCBmaXJzdFZhbGlkSW5kZXggPSB0aGlzLl90YXJnZXRHcm91cC5uQ2FjaGVkT2JqZWN0c18sIGJpbmRpbmcgPSB0aGlzLl9iaW5kaW5nc1tmaXJzdFZhbGlkSW5kZXhdOwogICAgaWYgKGJpbmRpbmcgIT09IHZvaWQgMCkKICAgICAgYmluZGluZy5nZXRWYWx1ZShhcnJheSwgb2Zmc2V0KTsKICB9CiAgc2V0VmFsdWUoYXJyYXksIG9mZnNldCkgewogICAgY29uc3QgYmluZGluZ3MgPSB0aGlzLl9iaW5kaW5nczsKICAgIGZvciAobGV0IGkgPSB0aGlzLl90YXJnZXRHcm91cC5uQ2FjaGVkT2JqZWN0c18sIG4gPSBiaW5kaW5ncy5sZW5ndGg7IGkgIT09IG47ICsraSkgewogICAgICBiaW5kaW5nc1tpXS5zZXRWYWx1ZShhcnJheSwgb2Zmc2V0KTsKICAgIH0KICB9CiAgYmluZCgpIHsKICAgIGNvbnN0IGJpbmRpbmdzID0gdGhpcy5fYmluZGluZ3M7CiAgICBmb3IgKGxldCBpID0gdGhpcy5fdGFyZ2V0R3JvdXAubkNhY2hlZE9iamVjdHNfLCBuID0gYmluZGluZ3MubGVuZ3RoOyBpICE9PSBuOyArK2kpIHsKICAgICAgYmluZGluZ3NbaV0uYmluZCgpOwogICAgfQogIH0KICB1bmJpbmQoKSB7CiAgICBjb25zdCBiaW5kaW5ncyA9IHRoaXMuX2JpbmRpbmdzOwogICAgZm9yIChsZXQgaSA9IHRoaXMuX3RhcmdldEdyb3VwLm5DYWNoZWRPYmplY3RzXywgbiA9IGJpbmRpbmdzLmxlbmd0aDsgaSAhPT0gbjsgKytpKSB7CiAgICAgIGJpbmRpbmdzW2ldLnVuYmluZCgpOwogICAgfQogIH0KfQpjbGFzcyBQcm9wZXJ0eUJpbmRpbmcgewogIGNvbnN0cnVjdG9yKHJvb3ROb2RlLCBwYXRoLCBwYXJzZWRQYXRoKSB7CiAgICB0aGlzLnBhdGggPSBwYXRoOwogICAgdGhpcy5wYXJzZWRQYXRoID0gcGFyc2VkUGF0aCB8fCBQcm9wZXJ0eUJpbmRpbmcucGFyc2VUcmFja05hbWUocGF0aCk7CiAgICB0aGlzLm5vZGUgPSBQcm9wZXJ0eUJpbmRpbmcuZmluZE5vZGUocm9vdE5vZGUsIHRoaXMucGFyc2VkUGF0aC5ub2RlTmFtZSkgfHwgcm9vdE5vZGU7CiAgICB0aGlzLnJvb3ROb2RlID0gcm9vdE5vZGU7CiAgICB0aGlzLmdldFZhbHVlID0gdGhpcy5fZ2V0VmFsdWVfdW5ib3VuZDsKICAgIHRoaXMuc2V0VmFsdWUgPSB0aGlzLl9zZXRWYWx1ZV91bmJvdW5kOwogIH0KICBzdGF0aWMgY3JlYXRlKHJvb3QsIHBhdGgsIHBhcnNlZFBhdGgpIHsKICAgIGlmICghKHJvb3QgJiYgcm9vdC5pc0FuaW1hdGlvbk9iamVjdEdyb3VwKSkgewogICAgICByZXR1cm4gbmV3IFByb3BlcnR5QmluZGluZyhyb290LCBwYXRoLCBwYXJzZWRQYXRoKTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBuZXcgUHJvcGVydHlCaW5kaW5nLkNvbXBvc2l0ZShyb290LCBwYXRoLCBwYXJzZWRQYXRoKTsKICAgIH0KICB9CiAgc3RhdGljIHNhbml0aXplTm9kZU5hbWUobmFtZSkgewogICAgcmV0dXJuIG5hbWUucmVwbGFjZSgvXHMvZywgIl8iKS5yZXBsYWNlKF9yZXNlcnZlZFJlLCAiIik7CiAgfQogIHN0YXRpYyBwYXJzZVRyYWNrTmFtZSh0cmFja05hbWUpIHsKICAgIGNvbnN0IG1hdGNoZXMgPSBfdHJhY2tSZS5leGVjKHRyYWNrTmFtZSk7CiAgICBpZiAoIW1hdGNoZXMpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJQcm9wZXJ0eUJpbmRpbmc6IENhbm5vdCBwYXJzZSB0cmFja05hbWU6ICIgKyB0cmFja05hbWUpOwogICAgfQogICAgY29uc3QgcmVzdWx0cyA9IHsKICAgICAgbm9kZU5hbWU6IG1hdGNoZXNbMl0sCiAgICAgIG9iamVjdE5hbWU6IG1hdGNoZXNbM10sCiAgICAgIG9iamVjdEluZGV4OiBtYXRjaGVzWzRdLAogICAgICBwcm9wZXJ0eU5hbWU6IG1hdGNoZXNbNV0sCiAgICAgIHByb3BlcnR5SW5kZXg6IG1hdGNoZXNbNl0KICAgIH07CiAgICBjb25zdCBsYXN0RG90ID0gcmVzdWx0cy5ub2RlTmFtZSAmJiByZXN1bHRzLm5vZGVOYW1lLmxhc3RJbmRleE9mKCIuIik7CiAgICBpZiAobGFzdERvdCAhPT0gdm9pZCAwICYmIGxhc3REb3QgIT09IC0xKSB7CiAgICAgIGNvbnN0IG9iamVjdE5hbWUgPSByZXN1bHRzLm5vZGVOYW1lLnN1YnN0cmluZyhsYXN0RG90ICsgMSk7CiAgICAgIGlmIChfc3VwcG9ydGVkT2JqZWN0TmFtZXMuaW5kZXhPZihvYmplY3ROYW1lKSAhPT0gLTEpIHsKICAgICAgICByZXN1bHRzLm5vZGVOYW1lID0gcmVzdWx0cy5ub2RlTmFtZS5zdWJzdHJpbmcoMCwgbGFzdERvdCk7CiAgICAgICAgcmVzdWx0cy5vYmplY3ROYW1lID0gb2JqZWN0TmFtZTsKICAgICAgfQogICAgfQogICAgaWYgKHJlc3VsdHMucHJvcGVydHlOYW1lID09PSBudWxsIHx8IHJlc3VsdHMucHJvcGVydHlOYW1lLmxlbmd0aCA9PT0gMCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIlByb3BlcnR5QmluZGluZzogY2FuIG5vdCBwYXJzZSBwcm9wZXJ0eU5hbWUgZnJvbSB0cmFja05hbWU6ICIgKyB0cmFja05hbWUpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdHM7CiAgfQogIHN0YXRpYyBmaW5kTm9kZShyb290LCBub2RlTmFtZSkgewogICAgaWYgKCFub2RlTmFtZSB8fCBub2RlTmFtZSA9PT0gIiIgfHwgbm9kZU5hbWUgPT09ICIuIiB8fCBub2RlTmFtZSA9PT0gLTEgfHwgbm9kZU5hbWUgPT09IHJvb3QubmFtZSB8fCBub2RlTmFtZSA9PT0gcm9vdC51dWlkKSB7CiAgICAgIHJldHVybiByb290OwogICAgfQogICAgaWYgKHJvb3Quc2tlbGV0b24pIHsKICAgICAgY29uc3QgYm9uZSA9IHJvb3Quc2tlbGV0b24uZ2V0Qm9uZUJ5TmFtZShub2RlTmFtZSk7CiAgICAgIGlmIChib25lICE9PSB2b2lkIDApIHsKICAgICAgICByZXR1cm4gYm9uZTsKICAgICAgfQogICAgfQogICAgaWYgKHJvb3QuY2hpbGRyZW4pIHsKICAgICAgY29uc3Qgc2VhcmNoTm9kZVN1YnRyZWUgPSBmdW5jdGlvbihjaGlsZHJlbikgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGNoaWxkTm9kZSA9IGNoaWxkcmVuW2ldOwogICAgICAgICAgaWYgKGNoaWxkTm9kZS5uYW1lID09PSBub2RlTmFtZSB8fCBjaGlsZE5vZGUudXVpZCA9PT0gbm9kZU5hbWUpIHsKICAgICAgICAgICAgcmV0dXJuIGNoaWxkTm9kZTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHNlYXJjaE5vZGVTdWJ0cmVlKGNoaWxkTm9kZS5jaGlsZHJlbik7CiAgICAgICAgICBpZiAocmVzdWx0KQogICAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfTsKICAgICAgY29uc3Qgc3ViVHJlZU5vZGUgPSBzZWFyY2hOb2RlU3VidHJlZShyb290LmNoaWxkcmVuKTsKICAgICAgaWYgKHN1YlRyZWVOb2RlKSB7CiAgICAgICAgcmV0dXJuIHN1YlRyZWVOb2RlOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gbnVsbDsKICB9CiAgX2dldFZhbHVlX3VuYXZhaWxhYmxlKCkgewogIH0KICBfc2V0VmFsdWVfdW5hdmFpbGFibGUoKSB7CiAgfQogIF9nZXRWYWx1ZV9kaXJlY3QoYnVmZmVyLCBvZmZzZXQpIHsKICAgIGJ1ZmZlcltvZmZzZXRdID0gdGhpcy50YXJnZXRPYmplY3RbdGhpcy5wcm9wZXJ0eU5hbWVdOwogIH0KICBfZ2V0VmFsdWVfYXJyYXkoYnVmZmVyLCBvZmZzZXQpIHsKICAgIGNvbnN0IHNvdXJjZSA9IHRoaXMucmVzb2x2ZWRQcm9wZXJ0eTsKICAgIGZvciAobGV0IGkgPSAwLCBuID0gc291cmNlLmxlbmd0aDsgaSAhPT0gbjsgKytpKSB7CiAgICAgIGJ1ZmZlcltvZmZzZXQrK10gPSBzb3VyY2VbaV07CiAgICB9CiAgfQogIF9nZXRWYWx1ZV9hcnJheUVsZW1lbnQoYnVmZmVyLCBvZmZzZXQpIHsKICAgIGJ1ZmZlcltvZmZzZXRdID0gdGhpcy5yZXNvbHZlZFByb3BlcnR5W3RoaXMucHJvcGVydHlJbmRleF07CiAgfQogIF9nZXRWYWx1ZV90b0FycmF5KGJ1ZmZlciwgb2Zmc2V0KSB7CiAgICB0aGlzLnJlc29sdmVkUHJvcGVydHkudG9BcnJheShidWZmZXIsIG9mZnNldCk7CiAgfQogIF9zZXRWYWx1ZV9kaXJlY3QoYnVmZmVyLCBvZmZzZXQpIHsKICAgIHRoaXMudGFyZ2V0T2JqZWN0W3RoaXMucHJvcGVydHlOYW1lXSA9IGJ1ZmZlcltvZmZzZXRdOwogIH0KICBfc2V0VmFsdWVfZGlyZWN0X3NldE5lZWRzVXBkYXRlKGJ1ZmZlciwgb2Zmc2V0KSB7CiAgICB0aGlzLnRhcmdldE9iamVjdFt0aGlzLnByb3BlcnR5TmFtZV0gPSBidWZmZXJbb2Zmc2V0XTsKICAgIHRoaXMudGFyZ2V0T2JqZWN0Lm5lZWRzVXBkYXRlID0gdHJ1ZTsKICB9CiAgX3NldFZhbHVlX2RpcmVjdF9zZXRNYXRyaXhXb3JsZE5lZWRzVXBkYXRlKGJ1ZmZlciwgb2Zmc2V0KSB7CiAgICB0aGlzLnRhcmdldE9iamVjdFt0aGlzLnByb3BlcnR5TmFtZV0gPSBidWZmZXJbb2Zmc2V0XTsKICAgIHRoaXMudGFyZ2V0T2JqZWN0Lm1hdHJpeFdvcmxkTmVlZHNVcGRhdGUgPSB0cnVlOwogIH0KICBfc2V0VmFsdWVfYXJyYXkoYnVmZmVyLCBvZmZzZXQpIHsKICAgIGNvbnN0IGRlc3QgPSB0aGlzLnJlc29sdmVkUHJvcGVydHk7CiAgICBmb3IgKGxldCBpID0gMCwgbiA9IGRlc3QubGVuZ3RoOyBpICE9PSBuOyArK2kpIHsKICAgICAgZGVzdFtpXSA9IGJ1ZmZlcltvZmZzZXQrK107CiAgICB9CiAgfQogIF9zZXRWYWx1ZV9hcnJheV9zZXROZWVkc1VwZGF0ZShidWZmZXIsIG9mZnNldCkgewogICAgY29uc3QgZGVzdCA9IHRoaXMucmVzb2x2ZWRQcm9wZXJ0eTsKICAgIGZvciAobGV0IGkgPSAwLCBuID0gZGVzdC5sZW5ndGg7IGkgIT09IG47ICsraSkgewogICAgICBkZXN0W2ldID0gYnVmZmVyW29mZnNldCsrXTsKICAgIH0KICAgIHRoaXMudGFyZ2V0T2JqZWN0Lm5lZWRzVXBkYXRlID0gdHJ1ZTsKICB9CiAgX3NldFZhbHVlX2FycmF5X3NldE1hdHJpeFdvcmxkTmVlZHNVcGRhdGUoYnVmZmVyLCBvZmZzZXQpIHsKICAgIGNvbnN0IGRlc3QgPSB0aGlzLnJlc29sdmVkUHJvcGVydHk7CiAgICBmb3IgKGxldCBpID0gMCwgbiA9IGRlc3QubGVuZ3RoOyBpICE9PSBuOyArK2kpIHsKICAgICAgZGVzdFtpXSA9IGJ1ZmZlcltvZmZzZXQrK107CiAgICB9CiAgICB0aGlzLnRhcmdldE9iamVjdC5tYXRyaXhXb3JsZE5lZWRzVXBkYXRlID0gdHJ1ZTsKICB9CiAgX3NldFZhbHVlX2FycmF5RWxlbWVudChidWZmZXIsIG9mZnNldCkgewogICAgdGhpcy5yZXNvbHZlZFByb3BlcnR5W3RoaXMucHJvcGVydHlJbmRleF0gPSBidWZmZXJbb2Zmc2V0XTsKICB9CiAgX3NldFZhbHVlX2FycmF5RWxlbWVudF9zZXROZWVkc1VwZGF0ZShidWZmZXIsIG9mZnNldCkgewogICAgdGhpcy5yZXNvbHZlZFByb3BlcnR5W3RoaXMucHJvcGVydHlJbmRleF0gPSBidWZmZXJbb2Zmc2V0XTsKICAgIHRoaXMudGFyZ2V0T2JqZWN0Lm5lZWRzVXBkYXRlID0gdHJ1ZTsKICB9CiAgX3NldFZhbHVlX2FycmF5RWxlbWVudF9zZXRNYXRyaXhXb3JsZE5lZWRzVXBkYXRlKGJ1ZmZlciwgb2Zmc2V0KSB7CiAgICB0aGlzLnJlc29sdmVkUHJvcGVydHlbdGhpcy5wcm9wZXJ0eUluZGV4XSA9IGJ1ZmZlcltvZmZzZXRdOwogICAgdGhpcy50YXJnZXRPYmplY3QubWF0cml4V29ybGROZWVkc1VwZGF0ZSA9IHRydWU7CiAgfQogIF9zZXRWYWx1ZV9mcm9tQXJyYXkoYnVmZmVyLCBvZmZzZXQpIHsKICAgIHRoaXMucmVzb2x2ZWRQcm9wZXJ0eS5mcm9tQXJyYXkoYnVmZmVyLCBvZmZzZXQpOwogIH0KICBfc2V0VmFsdWVfZnJvbUFycmF5X3NldE5lZWRzVXBkYXRlKGJ1ZmZlciwgb2Zmc2V0KSB7CiAgICB0aGlzLnJlc29sdmVkUHJvcGVydHkuZnJvbUFycmF5KGJ1ZmZlciwgb2Zmc2V0KTsKICAgIHRoaXMudGFyZ2V0T2JqZWN0Lm5lZWRzVXBkYXRlID0gdHJ1ZTsKICB9CiAgX3NldFZhbHVlX2Zyb21BcnJheV9zZXRNYXRyaXhXb3JsZE5lZWRzVXBkYXRlKGJ1ZmZlciwgb2Zmc2V0KSB7CiAgICB0aGlzLnJlc29sdmVkUHJvcGVydHkuZnJvbUFycmF5KGJ1ZmZlciwgb2Zmc2V0KTsKICAgIHRoaXMudGFyZ2V0T2JqZWN0Lm1hdHJpeFdvcmxkTmVlZHNVcGRhdGUgPSB0cnVlOwogIH0KICBfZ2V0VmFsdWVfdW5ib3VuZCh0YXJnZXRBcnJheSwgb2Zmc2V0KSB7CiAgICB0aGlzLmJpbmQoKTsKICAgIHRoaXMuZ2V0VmFsdWUodGFyZ2V0QXJyYXksIG9mZnNldCk7CiAgfQogIF9zZXRWYWx1ZV91bmJvdW5kKHNvdXJjZUFycmF5LCBvZmZzZXQpIHsKICAgIHRoaXMuYmluZCgpOwogICAgdGhpcy5zZXRWYWx1ZShzb3VyY2VBcnJheSwgb2Zmc2V0KTsKICB9CiAgYmluZCgpIHsKICAgIGxldCB0YXJnZXRPYmplY3QgPSB0aGlzLm5vZGU7CiAgICBjb25zdCBwYXJzZWRQYXRoID0gdGhpcy5wYXJzZWRQYXRoOwogICAgY29uc3Qgb2JqZWN0TmFtZSA9IHBhcnNlZFBhdGgub2JqZWN0TmFtZTsKICAgIGNvbnN0IHByb3BlcnR5TmFtZSA9IHBhcnNlZFBhdGgucHJvcGVydHlOYW1lOwogICAgbGV0IHByb3BlcnR5SW5kZXggPSBwYXJzZWRQYXRoLnByb3BlcnR5SW5kZXg7CiAgICBpZiAoIXRhcmdldE9iamVjdCkgewogICAgICB0YXJnZXRPYmplY3QgPSBQcm9wZXJ0eUJpbmRpbmcuZmluZE5vZGUodGhpcy5yb290Tm9kZSwgcGFyc2VkUGF0aC5ub2RlTmFtZSkgfHwgdGhpcy5yb290Tm9kZTsKICAgICAgdGhpcy5ub2RlID0gdGFyZ2V0T2JqZWN0OwogICAgfQogICAgdGhpcy5nZXRWYWx1ZSA9IHRoaXMuX2dldFZhbHVlX3VuYXZhaWxhYmxlOwogICAgdGhpcy5zZXRWYWx1ZSA9IHRoaXMuX3NldFZhbHVlX3VuYXZhaWxhYmxlOwogICAgaWYgKCF0YXJnZXRPYmplY3QpIHsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuUHJvcGVydHlCaW5kaW5nOiBUcnlpbmcgdG8gdXBkYXRlIG5vZGUgZm9yIHRyYWNrOiAiICsgdGhpcy5wYXRoICsgIiBidXQgaXQgd2Fzbid0IGZvdW5kLiIpOwogICAgICByZXR1cm47CiAgICB9CiAgICBpZiAob2JqZWN0TmFtZSkgewogICAgICBsZXQgb2JqZWN0SW5kZXggPSBwYXJzZWRQYXRoLm9iamVjdEluZGV4OwogICAgICBzd2l0Y2ggKG9iamVjdE5hbWUpIHsKICAgICAgICBjYXNlICJtYXRlcmlhbHMiOgogICAgICAgICAgaWYgKCF0YXJnZXRPYmplY3QubWF0ZXJpYWwpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuUHJvcGVydHlCaW5kaW5nOiBDYW4gbm90IGJpbmQgdG8gbWF0ZXJpYWwgYXMgbm9kZSBkb2VzIG5vdCBoYXZlIGEgbWF0ZXJpYWwuIiwgdGhpcyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghdGFyZ2V0T2JqZWN0Lm1hdGVyaWFsLm1hdGVyaWFscykgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5Qcm9wZXJ0eUJpbmRpbmc6IENhbiBub3QgYmluZCB0byBtYXRlcmlhbC5tYXRlcmlhbHMgYXMgbm9kZS5tYXRlcmlhbCBkb2VzIG5vdCBoYXZlIGEgbWF0ZXJpYWxzIGFycmF5LiIsIHRoaXMpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICB0YXJnZXRPYmplY3QgPSB0YXJnZXRPYmplY3QubWF0ZXJpYWwubWF0ZXJpYWxzOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAiYm9uZXMiOgogICAgICAgICAgaWYgKCF0YXJnZXRPYmplY3Quc2tlbGV0b24pIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuUHJvcGVydHlCaW5kaW5nOiBDYW4gbm90IGJpbmQgdG8gYm9uZXMgYXMgbm9kZSBkb2VzIG5vdCBoYXZlIGEgc2tlbGV0b24uIiwgdGhpcyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIHRhcmdldE9iamVjdCA9IHRhcmdldE9iamVjdC5za2VsZXRvbi5ib25lczsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0T2JqZWN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICh0YXJnZXRPYmplY3RbaV0ubmFtZSA9PT0gb2JqZWN0SW5kZXgpIHsKICAgICAgICAgICAgICBvYmplY3RJbmRleCA9IGk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBpZiAodGFyZ2V0T2JqZWN0W29iamVjdE5hbWVdID09PSB2b2lkIDApIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuUHJvcGVydHlCaW5kaW5nOiBDYW4gbm90IGJpbmQgdG8gb2JqZWN0TmFtZSBvZiBub2RlIHVuZGVmaW5lZC4iLCB0aGlzKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgdGFyZ2V0T2JqZWN0ID0gdGFyZ2V0T2JqZWN0W29iamVjdE5hbWVdOwogICAgICB9CiAgICAgIGlmIChvYmplY3RJbmRleCAhPT0gdm9pZCAwKSB7CiAgICAgICAgaWYgKHRhcmdldE9iamVjdFtvYmplY3RJbmRleF0gPT09IHZvaWQgMCkgewogICAgICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuUHJvcGVydHlCaW5kaW5nOiBUcnlpbmcgdG8gYmluZCB0byBvYmplY3RJbmRleCBvZiBvYmplY3ROYW1lLCBidXQgaXMgdW5kZWZpbmVkLiIsIHRoaXMsIHRhcmdldE9iamVjdCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRhcmdldE9iamVjdCA9IHRhcmdldE9iamVjdFtvYmplY3RJbmRleF07CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IG5vZGVQcm9wZXJ0eSA9IHRhcmdldE9iamVjdFtwcm9wZXJ0eU5hbWVdOwogICAgaWYgKG5vZGVQcm9wZXJ0eSA9PT0gdm9pZCAwKSB7CiAgICAgIGNvbnN0IG5vZGVOYW1lID0gcGFyc2VkUGF0aC5ub2RlTmFtZTsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuUHJvcGVydHlCaW5kaW5nOiBUcnlpbmcgdG8gdXBkYXRlIHByb3BlcnR5IGZvciB0cmFjazogIiArIG5vZGVOYW1lICsgIi4iICsgcHJvcGVydHlOYW1lICsgIiBidXQgaXQgd2Fzbid0IGZvdW5kLiIsIHRhcmdldE9iamVjdCk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGxldCB2ZXJzaW9uaW5nID0gdGhpcy5WZXJzaW9uaW5nLk5vbmU7CiAgICB0aGlzLnRhcmdldE9iamVjdCA9IHRhcmdldE9iamVjdDsKICAgIGlmICh0YXJnZXRPYmplY3QubmVlZHNVcGRhdGUgIT09IHZvaWQgMCkgewogICAgICB2ZXJzaW9uaW5nID0gdGhpcy5WZXJzaW9uaW5nLk5lZWRzVXBkYXRlOwogICAgfSBlbHNlIGlmICh0YXJnZXRPYmplY3QubWF0cml4V29ybGROZWVkc1VwZGF0ZSAhPT0gdm9pZCAwKSB7CiAgICAgIHZlcnNpb25pbmcgPSB0aGlzLlZlcnNpb25pbmcuTWF0cml4V29ybGROZWVkc1VwZGF0ZTsKICAgIH0KICAgIGxldCBiaW5kaW5nVHlwZSA9IHRoaXMuQmluZGluZ1R5cGUuRGlyZWN0OwogICAgaWYgKHByb3BlcnR5SW5kZXggIT09IHZvaWQgMCkgewogICAgICBpZiAocHJvcGVydHlOYW1lID09PSAibW9ycGhUYXJnZXRJbmZsdWVuY2VzIikgewogICAgICAgIGlmICghdGFyZ2V0T2JqZWN0Lmdlb21ldHJ5KSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5Qcm9wZXJ0eUJpbmRpbmc6IENhbiBub3QgYmluZCB0byBtb3JwaFRhcmdldEluZmx1ZW5jZXMgYmVjYXVzZSBub2RlIGRvZXMgbm90IGhhdmUgYSBnZW9tZXRyeS4iLCB0aGlzKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKHRhcmdldE9iamVjdC5nZW9tZXRyeS5pc0J1ZmZlckdlb21ldHJ5KSB7CiAgICAgICAgICBpZiAoIXRhcmdldE9iamVjdC5nZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXMpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuUHJvcGVydHlCaW5kaW5nOiBDYW4gbm90IGJpbmQgdG8gbW9ycGhUYXJnZXRJbmZsdWVuY2VzIGJlY2F1c2Ugbm9kZSBkb2VzIG5vdCBoYXZlIGEgZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzLiIsIHRoaXMpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodGFyZ2V0T2JqZWN0Lm1vcnBoVGFyZ2V0RGljdGlvbmFyeVtwcm9wZXJ0eUluZGV4XSAhPT0gdm9pZCAwKSB7CiAgICAgICAgICAgIHByb3BlcnR5SW5kZXggPSB0YXJnZXRPYmplY3QubW9ycGhUYXJnZXREaWN0aW9uYXJ5W3Byb3BlcnR5SW5kZXhdOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5Qcm9wZXJ0eUJpbmRpbmc6IENhbiBub3QgYmluZCB0byBtb3JwaFRhcmdldEluZmx1ZW5jZXMgb24gVEhSRUUuR2VvbWV0cnkuIFVzZSBUSFJFRS5CdWZmZXJHZW9tZXRyeSBpbnN0ZWFkLiIsIHRoaXMpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQogICAgICBiaW5kaW5nVHlwZSA9IHRoaXMuQmluZGluZ1R5cGUuQXJyYXlFbGVtZW50OwogICAgICB0aGlzLnJlc29sdmVkUHJvcGVydHkgPSBub2RlUHJvcGVydHk7CiAgICAgIHRoaXMucHJvcGVydHlJbmRleCA9IHByb3BlcnR5SW5kZXg7CiAgICB9IGVsc2UgaWYgKG5vZGVQcm9wZXJ0eS5mcm9tQXJyYXkgIT09IHZvaWQgMCAmJiBub2RlUHJvcGVydHkudG9BcnJheSAhPT0gdm9pZCAwKSB7CiAgICAgIGJpbmRpbmdUeXBlID0gdGhpcy5CaW5kaW5nVHlwZS5IYXNGcm9tVG9BcnJheTsKICAgICAgdGhpcy5yZXNvbHZlZFByb3BlcnR5ID0gbm9kZVByb3BlcnR5OwogICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KG5vZGVQcm9wZXJ0eSkpIHsKICAgICAgYmluZGluZ1R5cGUgPSB0aGlzLkJpbmRpbmdUeXBlLkVudGlyZUFycmF5OwogICAgICB0aGlzLnJlc29sdmVkUHJvcGVydHkgPSBub2RlUHJvcGVydHk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnByb3BlcnR5TmFtZSA9IHByb3BlcnR5TmFtZTsKICAgIH0KICAgIHRoaXMuZ2V0VmFsdWUgPSB0aGlzLkdldHRlckJ5QmluZGluZ1R5cGVbYmluZGluZ1R5cGVdOwogICAgdGhpcy5zZXRWYWx1ZSA9IHRoaXMuU2V0dGVyQnlCaW5kaW5nVHlwZUFuZFZlcnNpb25pbmdbYmluZGluZ1R5cGVdW3ZlcnNpb25pbmddOwogIH0KICB1bmJpbmQoKSB7CiAgICB0aGlzLm5vZGUgPSBudWxsOwogICAgdGhpcy5nZXRWYWx1ZSA9IHRoaXMuX2dldFZhbHVlX3VuYm91bmQ7CiAgICB0aGlzLnNldFZhbHVlID0gdGhpcy5fc2V0VmFsdWVfdW5ib3VuZDsKICB9Cn0KUHJvcGVydHlCaW5kaW5nLkNvbXBvc2l0ZSA9IENvbXBvc2l0ZTsKUHJvcGVydHlCaW5kaW5nLnByb3RvdHlwZS5CaW5kaW5nVHlwZSA9IHsKICBEaXJlY3Q6IDAsCiAgRW50aXJlQXJyYXk6IDEsCiAgQXJyYXlFbGVtZW50OiAyLAogIEhhc0Zyb21Ub0FycmF5OiAzCn07ClByb3BlcnR5QmluZGluZy5wcm90b3R5cGUuVmVyc2lvbmluZyA9IHsKICBOb25lOiAwLAogIE5lZWRzVXBkYXRlOiAxLAogIE1hdHJpeFdvcmxkTmVlZHNVcGRhdGU6IDIKfTsKUHJvcGVydHlCaW5kaW5nLnByb3RvdHlwZS5HZXR0ZXJCeUJpbmRpbmdUeXBlID0gWwogIFByb3BlcnR5QmluZGluZy5wcm90b3R5cGUuX2dldFZhbHVlX2RpcmVjdCwKICBQcm9wZXJ0eUJpbmRpbmcucHJvdG90eXBlLl9nZXRWYWx1ZV9hcnJheSwKICBQcm9wZXJ0eUJpbmRpbmcucHJvdG90eXBlLl9nZXRWYWx1ZV9hcnJheUVsZW1lbnQsCiAgUHJvcGVydHlCaW5kaW5nLnByb3RvdHlwZS5fZ2V0VmFsdWVfdG9BcnJheQpdOwpQcm9wZXJ0eUJpbmRpbmcucHJvdG90eXBlLlNldHRlckJ5QmluZGluZ1R5cGVBbmRWZXJzaW9uaW5nID0gWwogIFsKICAgIFByb3BlcnR5QmluZGluZy5wcm90b3R5cGUuX3NldFZhbHVlX2RpcmVjdCwKICAgIFByb3BlcnR5QmluZGluZy5wcm90b3R5cGUuX3NldFZhbHVlX2RpcmVjdF9zZXROZWVkc1VwZGF0ZSwKICAgIFByb3BlcnR5QmluZGluZy5wcm90b3R5cGUuX3NldFZhbHVlX2RpcmVjdF9zZXRNYXRyaXhXb3JsZE5lZWRzVXBkYXRlCiAgXSwKICBbCiAgICBQcm9wZXJ0eUJpbmRpbmcucHJvdG90eXBlLl9zZXRWYWx1ZV9hcnJheSwKICAgIFByb3BlcnR5QmluZGluZy5wcm90b3R5cGUuX3NldFZhbHVlX2FycmF5X3NldE5lZWRzVXBkYXRlLAogICAgUHJvcGVydHlCaW5kaW5nLnByb3RvdHlwZS5fc2V0VmFsdWVfYXJyYXlfc2V0TWF0cml4V29ybGROZWVkc1VwZGF0ZQogIF0sCiAgWwogICAgUHJvcGVydHlCaW5kaW5nLnByb3RvdHlwZS5fc2V0VmFsdWVfYXJyYXlFbGVtZW50LAogICAgUHJvcGVydHlCaW5kaW5nLnByb3RvdHlwZS5fc2V0VmFsdWVfYXJyYXlFbGVtZW50X3NldE5lZWRzVXBkYXRlLAogICAgUHJvcGVydHlCaW5kaW5nLnByb3RvdHlwZS5fc2V0VmFsdWVfYXJyYXlFbGVtZW50X3NldE1hdHJpeFdvcmxkTmVlZHNVcGRhdGUKICBdLAogIFsKICAgIFByb3BlcnR5QmluZGluZy5wcm90b3R5cGUuX3NldFZhbHVlX2Zyb21BcnJheSwKICAgIFByb3BlcnR5QmluZGluZy5wcm90b3R5cGUuX3NldFZhbHVlX2Zyb21BcnJheV9zZXROZWVkc1VwZGF0ZSwKICAgIFByb3BlcnR5QmluZGluZy5wcm90b3R5cGUuX3NldFZhbHVlX2Zyb21BcnJheV9zZXRNYXRyaXhXb3JsZE5lZWRzVXBkYXRlCiAgXQpdOwpjbGFzcyBBbmltYXRpb25PYmplY3RHcm91cCB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLnV1aWQgPSBnZW5lcmF0ZVVVSUQoKTsKICAgIHRoaXMuX29iamVjdHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpOwogICAgdGhpcy5uQ2FjaGVkT2JqZWN0c18gPSAwOwogICAgY29uc3QgaW5kaWNlcyA9IHt9OwogICAgdGhpcy5faW5kaWNlc0J5VVVJRCA9IGluZGljZXM7CiAgICBmb3IgKGxldCBpID0gMCwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgIT09IG47ICsraSkgewogICAgICBpbmRpY2VzW2FyZ3VtZW50c1tpXS51dWlkXSA9IGk7CiAgICB9CiAgICB0aGlzLl9wYXRocyA9IFtdOwogICAgdGhpcy5fcGFyc2VkUGF0aHMgPSBbXTsKICAgIHRoaXMuX2JpbmRpbmdzID0gW107CiAgICB0aGlzLl9iaW5kaW5nc0luZGljZXNCeVBhdGggPSB7fTsKICAgIGNvbnN0IHNjb3BlID0gdGhpczsKICAgIHRoaXMuc3RhdHMgPSB7CiAgICAgIG9iamVjdHM6IHsKICAgICAgICBnZXQgdG90YWwoKSB7CiAgICAgICAgICByZXR1cm4gc2NvcGUuX29iamVjdHMubGVuZ3RoOwogICAgICAgIH0sCiAgICAgICAgZ2V0IGluVXNlKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMudG90YWwgLSBzY29wZS5uQ2FjaGVkT2JqZWN0c187CiAgICAgICAgfQogICAgICB9LAogICAgICBnZXQgYmluZGluZ3NQZXJPYmplY3QoKSB7CiAgICAgICAgcmV0dXJuIHNjb3BlLl9iaW5kaW5ncy5sZW5ndGg7CiAgICAgIH0KICAgIH07CiAgfQogIGFkZCgpIHsKICAgIGNvbnN0IG9iamVjdHMgPSB0aGlzLl9vYmplY3RzLCBpbmRpY2VzQnlVVUlEID0gdGhpcy5faW5kaWNlc0J5VVVJRCwgcGF0aHMgPSB0aGlzLl9wYXRocywgcGFyc2VkUGF0aHMgPSB0aGlzLl9wYXJzZWRQYXRocywgYmluZGluZ3MgPSB0aGlzLl9iaW5kaW5ncywgbkJpbmRpbmdzID0gYmluZGluZ3MubGVuZ3RoOwogICAgbGV0IGtub3duT2JqZWN0ID0gdm9pZCAwLCBuT2JqZWN0cyA9IG9iamVjdHMubGVuZ3RoLCBuQ2FjaGVkT2JqZWN0cyA9IHRoaXMubkNhY2hlZE9iamVjdHNfOwogICAgZm9yIChsZXQgaSA9IDAsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpICE9PSBuOyArK2kpIHsKICAgICAgY29uc3Qgb2JqZWN0ID0gYXJndW1lbnRzW2ldLCB1dWlkID0gb2JqZWN0LnV1aWQ7CiAgICAgIGxldCBpbmRleCA9IGluZGljZXNCeVVVSURbdXVpZF07CiAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7CiAgICAgICAgaW5kZXggPSBuT2JqZWN0cysrOwogICAgICAgIGluZGljZXNCeVVVSURbdXVpZF0gPSBpbmRleDsKICAgICAgICBvYmplY3RzLnB1c2gob2JqZWN0KTsKICAgICAgICBmb3IgKGxldCBqID0gMCwgbSA9IG5CaW5kaW5nczsgaiAhPT0gbTsgKytqKSB7CiAgICAgICAgICBiaW5kaW5nc1tqXS5wdXNoKG5ldyBQcm9wZXJ0eUJpbmRpbmcob2JqZWN0LCBwYXRoc1tqXSwgcGFyc2VkUGF0aHNbal0pKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoaW5kZXggPCBuQ2FjaGVkT2JqZWN0cykgewogICAgICAgIGtub3duT2JqZWN0ID0gb2JqZWN0c1tpbmRleF07CiAgICAgICAgY29uc3QgZmlyc3RBY3RpdmVJbmRleCA9IC0tbkNhY2hlZE9iamVjdHMsIGxhc3RDYWNoZWRPYmplY3QgPSBvYmplY3RzW2ZpcnN0QWN0aXZlSW5kZXhdOwogICAgICAgIGluZGljZXNCeVVVSURbbGFzdENhY2hlZE9iamVjdC51dWlkXSA9IGluZGV4OwogICAgICAgIG9iamVjdHNbaW5kZXhdID0gbGFzdENhY2hlZE9iamVjdDsKICAgICAgICBpbmRpY2VzQnlVVUlEW3V1aWRdID0gZmlyc3RBY3RpdmVJbmRleDsKICAgICAgICBvYmplY3RzW2ZpcnN0QWN0aXZlSW5kZXhdID0gb2JqZWN0OwogICAgICAgIGZvciAobGV0IGogPSAwLCBtID0gbkJpbmRpbmdzOyBqICE9PSBtOyArK2opIHsKICAgICAgICAgIGNvbnN0IGJpbmRpbmdzRm9yUGF0aCA9IGJpbmRpbmdzW2pdLCBsYXN0Q2FjaGVkID0gYmluZGluZ3NGb3JQYXRoW2ZpcnN0QWN0aXZlSW5kZXhdOwogICAgICAgICAgbGV0IGJpbmRpbmcgPSBiaW5kaW5nc0ZvclBhdGhbaW5kZXhdOwogICAgICAgICAgYmluZGluZ3NGb3JQYXRoW2luZGV4XSA9IGxhc3RDYWNoZWQ7CiAgICAgICAgICBpZiAoYmluZGluZyA9PT0gdm9pZCAwKSB7CiAgICAgICAgICAgIGJpbmRpbmcgPSBuZXcgUHJvcGVydHlCaW5kaW5nKG9iamVjdCwgcGF0aHNbal0sIHBhcnNlZFBhdGhzW2pdKTsKICAgICAgICAgIH0KICAgICAgICAgIGJpbmRpbmdzRm9yUGF0aFtmaXJzdEFjdGl2ZUluZGV4XSA9IGJpbmRpbmc7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKG9iamVjdHNbaW5kZXhdICE9PSBrbm93bk9iamVjdCkgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLkFuaW1hdGlvbk9iamVjdEdyb3VwOiBEaWZmZXJlbnQgb2JqZWN0cyB3aXRoIHRoZSBzYW1lIFVVSUQgZGV0ZWN0ZWQuIENsZWFuIHRoZSBjYWNoZXMgb3IgcmVjcmVhdGUgeW91ciBpbmZyYXN0cnVjdHVyZSB3aGVuIHJlbG9hZGluZyBzY2VuZXMuIik7CiAgICAgIH0KICAgIH0KICAgIHRoaXMubkNhY2hlZE9iamVjdHNfID0gbkNhY2hlZE9iamVjdHM7CiAgfQogIHJlbW92ZSgpIHsKICAgIGNvbnN0IG9iamVjdHMgPSB0aGlzLl9vYmplY3RzLCBpbmRpY2VzQnlVVUlEID0gdGhpcy5faW5kaWNlc0J5VVVJRCwgYmluZGluZ3MgPSB0aGlzLl9iaW5kaW5ncywgbkJpbmRpbmdzID0gYmluZGluZ3MubGVuZ3RoOwogICAgbGV0IG5DYWNoZWRPYmplY3RzID0gdGhpcy5uQ2FjaGVkT2JqZWN0c187CiAgICBmb3IgKGxldCBpID0gMCwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgIT09IG47ICsraSkgewogICAgICBjb25zdCBvYmplY3QgPSBhcmd1bWVudHNbaV0sIHV1aWQgPSBvYmplY3QudXVpZCwgaW5kZXggPSBpbmRpY2VzQnlVVUlEW3V1aWRdOwogICAgICBpZiAoaW5kZXggIT09IHZvaWQgMCAmJiBpbmRleCA+PSBuQ2FjaGVkT2JqZWN0cykgewogICAgICAgIGNvbnN0IGxhc3RDYWNoZWRJbmRleCA9IG5DYWNoZWRPYmplY3RzKyssIGZpcnN0QWN0aXZlT2JqZWN0ID0gb2JqZWN0c1tsYXN0Q2FjaGVkSW5kZXhdOwogICAgICAgIGluZGljZXNCeVVVSURbZmlyc3RBY3RpdmVPYmplY3QudXVpZF0gPSBpbmRleDsKICAgICAgICBvYmplY3RzW2luZGV4XSA9IGZpcnN0QWN0aXZlT2JqZWN0OwogICAgICAgIGluZGljZXNCeVVVSURbdXVpZF0gPSBsYXN0Q2FjaGVkSW5kZXg7CiAgICAgICAgb2JqZWN0c1tsYXN0Q2FjaGVkSW5kZXhdID0gb2JqZWN0OwogICAgICAgIGZvciAobGV0IGogPSAwLCBtID0gbkJpbmRpbmdzOyBqICE9PSBtOyArK2opIHsKICAgICAgICAgIGNvbnN0IGJpbmRpbmdzRm9yUGF0aCA9IGJpbmRpbmdzW2pdLCBmaXJzdEFjdGl2ZSA9IGJpbmRpbmdzRm9yUGF0aFtsYXN0Q2FjaGVkSW5kZXhdLCBiaW5kaW5nID0gYmluZGluZ3NGb3JQYXRoW2luZGV4XTsKICAgICAgICAgIGJpbmRpbmdzRm9yUGF0aFtpbmRleF0gPSBmaXJzdEFjdGl2ZTsKICAgICAgICAgIGJpbmRpbmdzRm9yUGF0aFtsYXN0Q2FjaGVkSW5kZXhdID0gYmluZGluZzsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHRoaXMubkNhY2hlZE9iamVjdHNfID0gbkNhY2hlZE9iamVjdHM7CiAgfQogIHVuY2FjaGUoKSB7CiAgICBjb25zdCBvYmplY3RzID0gdGhpcy5fb2JqZWN0cywgaW5kaWNlc0J5VVVJRCA9IHRoaXMuX2luZGljZXNCeVVVSUQsIGJpbmRpbmdzID0gdGhpcy5fYmluZGluZ3MsIG5CaW5kaW5ncyA9IGJpbmRpbmdzLmxlbmd0aDsKICAgIGxldCBuQ2FjaGVkT2JqZWN0cyA9IHRoaXMubkNhY2hlZE9iamVjdHNfLCBuT2JqZWN0cyA9IG9iamVjdHMubGVuZ3RoOwogICAgZm9yIChsZXQgaSA9IDAsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpICE9PSBuOyArK2kpIHsKICAgICAgY29uc3Qgb2JqZWN0ID0gYXJndW1lbnRzW2ldLCB1dWlkID0gb2JqZWN0LnV1aWQsIGluZGV4ID0gaW5kaWNlc0J5VVVJRFt1dWlkXTsKICAgICAgaWYgKGluZGV4ICE9PSB2b2lkIDApIHsKICAgICAgICBkZWxldGUgaW5kaWNlc0J5VVVJRFt1dWlkXTsKICAgICAgICBpZiAoaW5kZXggPCBuQ2FjaGVkT2JqZWN0cykgewogICAgICAgICAgY29uc3QgZmlyc3RBY3RpdmVJbmRleCA9IC0tbkNhY2hlZE9iamVjdHMsIGxhc3RDYWNoZWRPYmplY3QgPSBvYmplY3RzW2ZpcnN0QWN0aXZlSW5kZXhdLCBsYXN0SW5kZXggPSAtLW5PYmplY3RzLCBsYXN0T2JqZWN0ID0gb2JqZWN0c1tsYXN0SW5kZXhdOwogICAgICAgICAgaW5kaWNlc0J5VVVJRFtsYXN0Q2FjaGVkT2JqZWN0LnV1aWRdID0gaW5kZXg7CiAgICAgICAgICBvYmplY3RzW2luZGV4XSA9IGxhc3RDYWNoZWRPYmplY3Q7CiAgICAgICAgICBpbmRpY2VzQnlVVUlEW2xhc3RPYmplY3QudXVpZF0gPSBmaXJzdEFjdGl2ZUluZGV4OwogICAgICAgICAgb2JqZWN0c1tmaXJzdEFjdGl2ZUluZGV4XSA9IGxhc3RPYmplY3Q7CiAgICAgICAgICBvYmplY3RzLnBvcCgpOwogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIG0gPSBuQmluZGluZ3M7IGogIT09IG07ICsraikgewogICAgICAgICAgICBjb25zdCBiaW5kaW5nc0ZvclBhdGggPSBiaW5kaW5nc1tqXSwgbGFzdENhY2hlZCA9IGJpbmRpbmdzRm9yUGF0aFtmaXJzdEFjdGl2ZUluZGV4XSwgbGFzdCA9IGJpbmRpbmdzRm9yUGF0aFtsYXN0SW5kZXhdOwogICAgICAgICAgICBiaW5kaW5nc0ZvclBhdGhbaW5kZXhdID0gbGFzdENhY2hlZDsKICAgICAgICAgICAgYmluZGluZ3NGb3JQYXRoW2ZpcnN0QWN0aXZlSW5kZXhdID0gbGFzdDsKICAgICAgICAgICAgYmluZGluZ3NGb3JQYXRoLnBvcCgpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zdCBsYXN0SW5kZXggPSAtLW5PYmplY3RzLCBsYXN0T2JqZWN0ID0gb2JqZWN0c1tsYXN0SW5kZXhdOwogICAgICAgICAgaWYgKGxhc3RJbmRleCA+IDApIHsKICAgICAgICAgICAgaW5kaWNlc0J5VVVJRFtsYXN0T2JqZWN0LnV1aWRdID0gaW5kZXg7CiAgICAgICAgICB9CiAgICAgICAgICBvYmplY3RzW2luZGV4XSA9IGxhc3RPYmplY3Q7CiAgICAgICAgICBvYmplY3RzLnBvcCgpOwogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIG0gPSBuQmluZGluZ3M7IGogIT09IG07ICsraikgewogICAgICAgICAgICBjb25zdCBiaW5kaW5nc0ZvclBhdGggPSBiaW5kaW5nc1tqXTsKICAgICAgICAgICAgYmluZGluZ3NGb3JQYXRoW2luZGV4XSA9IGJpbmRpbmdzRm9yUGF0aFtsYXN0SW5kZXhdOwogICAgICAgICAgICBiaW5kaW5nc0ZvclBhdGgucG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICB0aGlzLm5DYWNoZWRPYmplY3RzXyA9IG5DYWNoZWRPYmplY3RzOwogIH0KICBzdWJzY3JpYmVfKHBhdGgsIHBhcnNlZFBhdGgpIHsKICAgIGNvbnN0IGluZGljZXNCeVBhdGggPSB0aGlzLl9iaW5kaW5nc0luZGljZXNCeVBhdGg7CiAgICBsZXQgaW5kZXggPSBpbmRpY2VzQnlQYXRoW3BhdGhdOwogICAgY29uc3QgYmluZGluZ3MgPSB0aGlzLl9iaW5kaW5nczsKICAgIGlmIChpbmRleCAhPT0gdm9pZCAwKQogICAgICByZXR1cm4gYmluZGluZ3NbaW5kZXhdOwogICAgY29uc3QgcGF0aHMgPSB0aGlzLl9wYXRocywgcGFyc2VkUGF0aHMgPSB0aGlzLl9wYXJzZWRQYXRocywgb2JqZWN0cyA9IHRoaXMuX29iamVjdHMsIG5PYmplY3RzID0gb2JqZWN0cy5sZW5ndGgsIG5DYWNoZWRPYmplY3RzID0gdGhpcy5uQ2FjaGVkT2JqZWN0c18sIGJpbmRpbmdzRm9yUGF0aCA9IG5ldyBBcnJheShuT2JqZWN0cyk7CiAgICBpbmRleCA9IGJpbmRpbmdzLmxlbmd0aDsKICAgIGluZGljZXNCeVBhdGhbcGF0aF0gPSBpbmRleDsKICAgIHBhdGhzLnB1c2gocGF0aCk7CiAgICBwYXJzZWRQYXRocy5wdXNoKHBhcnNlZFBhdGgpOwogICAgYmluZGluZ3MucHVzaChiaW5kaW5nc0ZvclBhdGgpOwogICAgZm9yIChsZXQgaSA9IG5DYWNoZWRPYmplY3RzLCBuID0gb2JqZWN0cy5sZW5ndGg7IGkgIT09IG47ICsraSkgewogICAgICBjb25zdCBvYmplY3QgPSBvYmplY3RzW2ldOwogICAgICBiaW5kaW5nc0ZvclBhdGhbaV0gPSBuZXcgUHJvcGVydHlCaW5kaW5nKG9iamVjdCwgcGF0aCwgcGFyc2VkUGF0aCk7CiAgICB9CiAgICByZXR1cm4gYmluZGluZ3NGb3JQYXRoOwogIH0KICB1bnN1YnNjcmliZV8ocGF0aCkgewogICAgY29uc3QgaW5kaWNlc0J5UGF0aCA9IHRoaXMuX2JpbmRpbmdzSW5kaWNlc0J5UGF0aCwgaW5kZXggPSBpbmRpY2VzQnlQYXRoW3BhdGhdOwogICAgaWYgKGluZGV4ICE9PSB2b2lkIDApIHsKICAgICAgY29uc3QgcGF0aHMgPSB0aGlzLl9wYXRocywgcGFyc2VkUGF0aHMgPSB0aGlzLl9wYXJzZWRQYXRocywgYmluZGluZ3MgPSB0aGlzLl9iaW5kaW5ncywgbGFzdEJpbmRpbmdzSW5kZXggPSBiaW5kaW5ncy5sZW5ndGggLSAxLCBsYXN0QmluZGluZ3MgPSBiaW5kaW5nc1tsYXN0QmluZGluZ3NJbmRleF0sIGxhc3RCaW5kaW5nc1BhdGggPSBwYXRoW2xhc3RCaW5kaW5nc0luZGV4XTsKICAgICAgaW5kaWNlc0J5UGF0aFtsYXN0QmluZGluZ3NQYXRoXSA9IGluZGV4OwogICAgICBiaW5kaW5nc1tpbmRleF0gPSBsYXN0QmluZGluZ3M7CiAgICAgIGJpbmRpbmdzLnBvcCgpOwogICAgICBwYXJzZWRQYXRoc1tpbmRleF0gPSBwYXJzZWRQYXRoc1tsYXN0QmluZGluZ3NJbmRleF07CiAgICAgIHBhcnNlZFBhdGhzLnBvcCgpOwogICAgICBwYXRoc1tpbmRleF0gPSBwYXRoc1tsYXN0QmluZGluZ3NJbmRleF07CiAgICAgIHBhdGhzLnBvcCgpOwogICAgfQogIH0KfQpBbmltYXRpb25PYmplY3RHcm91cC5wcm90b3R5cGUuaXNBbmltYXRpb25PYmplY3RHcm91cCA9IHRydWU7CmNsYXNzIEFuaW1hdGlvbkFjdGlvbiB7CiAgY29uc3RydWN0b3IobWl4ZXIsIGNsaXAsIGxvY2FsUm9vdCA9IG51bGwsIGJsZW5kTW9kZSA9IGNsaXAuYmxlbmRNb2RlKSB7CiAgICB0aGlzLl9taXhlciA9IG1peGVyOwogICAgdGhpcy5fY2xpcCA9IGNsaXA7CiAgICB0aGlzLl9sb2NhbFJvb3QgPSBsb2NhbFJvb3Q7CiAgICB0aGlzLmJsZW5kTW9kZSA9IGJsZW5kTW9kZTsKICAgIGNvbnN0IHRyYWNrcyA9IGNsaXAudHJhY2tzLCBuVHJhY2tzID0gdHJhY2tzLmxlbmd0aCwgaW50ZXJwb2xhbnRzID0gbmV3IEFycmF5KG5UcmFja3MpOwogICAgY29uc3QgaW50ZXJwb2xhbnRTZXR0aW5ncyA9IHsKICAgICAgZW5kaW5nU3RhcnQ6IFplcm9DdXJ2YXR1cmVFbmRpbmcsCiAgICAgIGVuZGluZ0VuZDogWmVyb0N1cnZhdHVyZUVuZGluZwogICAgfTsKICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBuVHJhY2tzOyArK2kpIHsKICAgICAgY29uc3QgaW50ZXJwb2xhbnQgPSB0cmFja3NbaV0uY3JlYXRlSW50ZXJwb2xhbnQobnVsbCk7CiAgICAgIGludGVycG9sYW50c1tpXSA9IGludGVycG9sYW50OwogICAgICBpbnRlcnBvbGFudC5zZXR0aW5ncyA9IGludGVycG9sYW50U2V0dGluZ3M7CiAgICB9CiAgICB0aGlzLl9pbnRlcnBvbGFudFNldHRpbmdzID0gaW50ZXJwb2xhbnRTZXR0aW5nczsKICAgIHRoaXMuX2ludGVycG9sYW50cyA9IGludGVycG9sYW50czsKICAgIHRoaXMuX3Byb3BlcnR5QmluZGluZ3MgPSBuZXcgQXJyYXkoblRyYWNrcyk7CiAgICB0aGlzLl9jYWNoZUluZGV4ID0gbnVsbDsKICAgIHRoaXMuX2J5Q2xpcENhY2hlSW5kZXggPSBudWxsOwogICAgdGhpcy5fdGltZVNjYWxlSW50ZXJwb2xhbnQgPSBudWxsOwogICAgdGhpcy5fd2VpZ2h0SW50ZXJwb2xhbnQgPSBudWxsOwogICAgdGhpcy5sb29wID0gTG9vcFJlcGVhdDsKICAgIHRoaXMuX2xvb3BDb3VudCA9IC0xOwogICAgdGhpcy5fc3RhcnRUaW1lID0gbnVsbDsKICAgIHRoaXMudGltZSA9IDA7CiAgICB0aGlzLnRpbWVTY2FsZSA9IDE7CiAgICB0aGlzLl9lZmZlY3RpdmVUaW1lU2NhbGUgPSAxOwogICAgdGhpcy53ZWlnaHQgPSAxOwogICAgdGhpcy5fZWZmZWN0aXZlV2VpZ2h0ID0gMTsKICAgIHRoaXMucmVwZXRpdGlvbnMgPSBJbmZpbml0eTsKICAgIHRoaXMucGF1c2VkID0gZmFsc2U7CiAgICB0aGlzLmVuYWJsZWQgPSB0cnVlOwogICAgdGhpcy5jbGFtcFdoZW5GaW5pc2hlZCA9IGZhbHNlOwogICAgdGhpcy56ZXJvU2xvcGVBdFN0YXJ0ID0gdHJ1ZTsKICAgIHRoaXMuemVyb1Nsb3BlQXRFbmQgPSB0cnVlOwogIH0KICBwbGF5KCkgewogICAgdGhpcy5fbWl4ZXIuX2FjdGl2YXRlQWN0aW9uKHRoaXMpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHN0b3AoKSB7CiAgICB0aGlzLl9taXhlci5fZGVhY3RpdmF0ZUFjdGlvbih0aGlzKTsKICAgIHJldHVybiB0aGlzLnJlc2V0KCk7CiAgfQogIHJlc2V0KCkgewogICAgdGhpcy5wYXVzZWQgPSBmYWxzZTsKICAgIHRoaXMuZW5hYmxlZCA9IHRydWU7CiAgICB0aGlzLnRpbWUgPSAwOwogICAgdGhpcy5fbG9vcENvdW50ID0gLTE7CiAgICB0aGlzLl9zdGFydFRpbWUgPSBudWxsOwogICAgcmV0dXJuIHRoaXMuc3RvcEZhZGluZygpLnN0b3BXYXJwaW5nKCk7CiAgfQogIGlzUnVubmluZygpIHsKICAgIHJldHVybiB0aGlzLmVuYWJsZWQgJiYgIXRoaXMucGF1c2VkICYmIHRoaXMudGltZVNjYWxlICE9PSAwICYmIHRoaXMuX3N0YXJ0VGltZSA9PT0gbnVsbCAmJiB0aGlzLl9taXhlci5faXNBY3RpdmVBY3Rpb24odGhpcyk7CiAgfQogIGlzU2NoZWR1bGVkKCkgewogICAgcmV0dXJuIHRoaXMuX21peGVyLl9pc0FjdGl2ZUFjdGlvbih0aGlzKTsKICB9CiAgc3RhcnRBdCh0aW1lKSB7CiAgICB0aGlzLl9zdGFydFRpbWUgPSB0aW1lOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldExvb3AobW9kZSwgcmVwZXRpdGlvbnMpIHsKICAgIHRoaXMubG9vcCA9IG1vZGU7CiAgICB0aGlzLnJlcGV0aXRpb25zID0gcmVwZXRpdGlvbnM7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0RWZmZWN0aXZlV2VpZ2h0KHdlaWdodCkgewogICAgdGhpcy53ZWlnaHQgPSB3ZWlnaHQ7CiAgICB0aGlzLl9lZmZlY3RpdmVXZWlnaHQgPSB0aGlzLmVuYWJsZWQgPyB3ZWlnaHQgOiAwOwogICAgcmV0dXJuIHRoaXMuc3RvcEZhZGluZygpOwogIH0KICBnZXRFZmZlY3RpdmVXZWlnaHQoKSB7CiAgICByZXR1cm4gdGhpcy5fZWZmZWN0aXZlV2VpZ2h0OwogIH0KICBmYWRlSW4oZHVyYXRpb24pIHsKICAgIHJldHVybiB0aGlzLl9zY2hlZHVsZUZhZGluZyhkdXJhdGlvbiwgMCwgMSk7CiAgfQogIGZhZGVPdXQoZHVyYXRpb24pIHsKICAgIHJldHVybiB0aGlzLl9zY2hlZHVsZUZhZGluZyhkdXJhdGlvbiwgMSwgMCk7CiAgfQogIGNyb3NzRmFkZUZyb20oZmFkZU91dEFjdGlvbiwgZHVyYXRpb24sIHdhcnApIHsKICAgIGZhZGVPdXRBY3Rpb24uZmFkZU91dChkdXJhdGlvbik7CiAgICB0aGlzLmZhZGVJbihkdXJhdGlvbik7CiAgICBpZiAod2FycCkgewogICAgICBjb25zdCBmYWRlSW5EdXJhdGlvbiA9IHRoaXMuX2NsaXAuZHVyYXRpb24sIGZhZGVPdXREdXJhdGlvbiA9IGZhZGVPdXRBY3Rpb24uX2NsaXAuZHVyYXRpb24sIHN0YXJ0RW5kUmF0aW8gPSBmYWRlT3V0RHVyYXRpb24gLyBmYWRlSW5EdXJhdGlvbiwgZW5kU3RhcnRSYXRpbyA9IGZhZGVJbkR1cmF0aW9uIC8gZmFkZU91dER1cmF0aW9uOwogICAgICBmYWRlT3V0QWN0aW9uLndhcnAoMSwgc3RhcnRFbmRSYXRpbywgZHVyYXRpb24pOwogICAgICB0aGlzLndhcnAoZW5kU3RhcnRSYXRpbywgMSwgZHVyYXRpb24pOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNyb3NzRmFkZVRvKGZhZGVJbkFjdGlvbiwgZHVyYXRpb24sIHdhcnApIHsKICAgIHJldHVybiBmYWRlSW5BY3Rpb24uY3Jvc3NGYWRlRnJvbSh0aGlzLCBkdXJhdGlvbiwgd2FycCk7CiAgfQogIHN0b3BGYWRpbmcoKSB7CiAgICBjb25zdCB3ZWlnaHRJbnRlcnBvbGFudCA9IHRoaXMuX3dlaWdodEludGVycG9sYW50OwogICAgaWYgKHdlaWdodEludGVycG9sYW50ICE9PSBudWxsKSB7CiAgICAgIHRoaXMuX3dlaWdodEludGVycG9sYW50ID0gbnVsbDsKICAgICAgdGhpcy5fbWl4ZXIuX3Rha2VCYWNrQ29udHJvbEludGVycG9sYW50KHdlaWdodEludGVycG9sYW50KTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRFZmZlY3RpdmVUaW1lU2NhbGUodGltZVNjYWxlKSB7CiAgICB0aGlzLnRpbWVTY2FsZSA9IHRpbWVTY2FsZTsKICAgIHRoaXMuX2VmZmVjdGl2ZVRpbWVTY2FsZSA9IHRoaXMucGF1c2VkID8gMCA6IHRpbWVTY2FsZTsKICAgIHJldHVybiB0aGlzLnN0b3BXYXJwaW5nKCk7CiAgfQogIGdldEVmZmVjdGl2ZVRpbWVTY2FsZSgpIHsKICAgIHJldHVybiB0aGlzLl9lZmZlY3RpdmVUaW1lU2NhbGU7CiAgfQogIHNldER1cmF0aW9uKGR1cmF0aW9uKSB7CiAgICB0aGlzLnRpbWVTY2FsZSA9IHRoaXMuX2NsaXAuZHVyYXRpb24gLyBkdXJhdGlvbjsKICAgIHJldHVybiB0aGlzLnN0b3BXYXJwaW5nKCk7CiAgfQogIHN5bmNXaXRoKGFjdGlvbikgewogICAgdGhpcy50aW1lID0gYWN0aW9uLnRpbWU7CiAgICB0aGlzLnRpbWVTY2FsZSA9IGFjdGlvbi50aW1lU2NhbGU7CiAgICByZXR1cm4gdGhpcy5zdG9wV2FycGluZygpOwogIH0KICBoYWx0KGR1cmF0aW9uKSB7CiAgICByZXR1cm4gdGhpcy53YXJwKHRoaXMuX2VmZmVjdGl2ZVRpbWVTY2FsZSwgMCwgZHVyYXRpb24pOwogIH0KICB3YXJwKHN0YXJ0VGltZVNjYWxlLCBlbmRUaW1lU2NhbGUsIGR1cmF0aW9uKSB7CiAgICBjb25zdCBtaXhlciA9IHRoaXMuX21peGVyLCBub3cyID0gbWl4ZXIudGltZSwgdGltZVNjYWxlID0gdGhpcy50aW1lU2NhbGU7CiAgICBsZXQgaW50ZXJwb2xhbnQgPSB0aGlzLl90aW1lU2NhbGVJbnRlcnBvbGFudDsKICAgIGlmIChpbnRlcnBvbGFudCA9PT0gbnVsbCkgewogICAgICBpbnRlcnBvbGFudCA9IG1peGVyLl9sZW5kQ29udHJvbEludGVycG9sYW50KCk7CiAgICAgIHRoaXMuX3RpbWVTY2FsZUludGVycG9sYW50ID0gaW50ZXJwb2xhbnQ7CiAgICB9CiAgICBjb25zdCB0aW1lcyA9IGludGVycG9sYW50LnBhcmFtZXRlclBvc2l0aW9ucywgdmFsdWVzID0gaW50ZXJwb2xhbnQuc2FtcGxlVmFsdWVzOwogICAgdGltZXNbMF0gPSBub3cyOwogICAgdGltZXNbMV0gPSBub3cyICsgZHVyYXRpb247CiAgICB2YWx1ZXNbMF0gPSBzdGFydFRpbWVTY2FsZSAvIHRpbWVTY2FsZTsKICAgIHZhbHVlc1sxXSA9IGVuZFRpbWVTY2FsZSAvIHRpbWVTY2FsZTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzdG9wV2FycGluZygpIHsKICAgIGNvbnN0IHRpbWVTY2FsZUludGVycG9sYW50ID0gdGhpcy5fdGltZVNjYWxlSW50ZXJwb2xhbnQ7CiAgICBpZiAodGltZVNjYWxlSW50ZXJwb2xhbnQgIT09IG51bGwpIHsKICAgICAgdGhpcy5fdGltZVNjYWxlSW50ZXJwb2xhbnQgPSBudWxsOwogICAgICB0aGlzLl9taXhlci5fdGFrZUJhY2tDb250cm9sSW50ZXJwb2xhbnQodGltZVNjYWxlSW50ZXJwb2xhbnQpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGdldE1peGVyKCkgewogICAgcmV0dXJuIHRoaXMuX21peGVyOwogIH0KICBnZXRDbGlwKCkgewogICAgcmV0dXJuIHRoaXMuX2NsaXA7CiAgfQogIGdldFJvb3QoKSB7CiAgICByZXR1cm4gdGhpcy5fbG9jYWxSb290IHx8IHRoaXMuX21peGVyLl9yb290OwogIH0KICBfdXBkYXRlKHRpbWUsIGRlbHRhVGltZSwgdGltZURpcmVjdGlvbiwgYWNjdUluZGV4KSB7CiAgICBpZiAoIXRoaXMuZW5hYmxlZCkgewogICAgICB0aGlzLl91cGRhdGVXZWlnaHQodGltZSk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGNvbnN0IHN0YXJ0VGltZSA9IHRoaXMuX3N0YXJ0VGltZTsKICAgIGlmIChzdGFydFRpbWUgIT09IG51bGwpIHsKICAgICAgY29uc3QgdGltZVJ1bm5pbmcgPSAodGltZSAtIHN0YXJ0VGltZSkgKiB0aW1lRGlyZWN0aW9uOwogICAgICBpZiAodGltZVJ1bm5pbmcgPCAwIHx8IHRpbWVEaXJlY3Rpb24gPT09IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5fc3RhcnRUaW1lID0gbnVsbDsKICAgICAgZGVsdGFUaW1lID0gdGltZURpcmVjdGlvbiAqIHRpbWVSdW5uaW5nOwogICAgfQogICAgZGVsdGFUaW1lICo9IHRoaXMuX3VwZGF0ZVRpbWVTY2FsZSh0aW1lKTsKICAgIGNvbnN0IGNsaXBUaW1lID0gdGhpcy5fdXBkYXRlVGltZShkZWx0YVRpbWUpOwogICAgY29uc3Qgd2VpZ2h0ID0gdGhpcy5fdXBkYXRlV2VpZ2h0KHRpbWUpOwogICAgaWYgKHdlaWdodCA+IDApIHsKICAgICAgY29uc3QgaW50ZXJwb2xhbnRzID0gdGhpcy5faW50ZXJwb2xhbnRzOwogICAgICBjb25zdCBwcm9wZXJ0eU1peGVycyA9IHRoaXMuX3Byb3BlcnR5QmluZGluZ3M7CiAgICAgIHN3aXRjaCAodGhpcy5ibGVuZE1vZGUpIHsKICAgICAgICBjYXNlIEFkZGl0aXZlQW5pbWF0aW9uQmxlbmRNb2RlOgogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIG0gPSBpbnRlcnBvbGFudHMubGVuZ3RoOyBqICE9PSBtOyArK2opIHsKICAgICAgICAgICAgaW50ZXJwb2xhbnRzW2pdLmV2YWx1YXRlKGNsaXBUaW1lKTsKICAgICAgICAgICAgcHJvcGVydHlNaXhlcnNbal0uYWNjdW11bGF0ZUFkZGl0aXZlKHdlaWdodCk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIE5vcm1hbEFuaW1hdGlvbkJsZW5kTW9kZToKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIG0gPSBpbnRlcnBvbGFudHMubGVuZ3RoOyBqICE9PSBtOyArK2opIHsKICAgICAgICAgICAgaW50ZXJwb2xhbnRzW2pdLmV2YWx1YXRlKGNsaXBUaW1lKTsKICAgICAgICAgICAgcHJvcGVydHlNaXhlcnNbal0uYWNjdW11bGF0ZShhY2N1SW5kZXgsIHdlaWdodCk7CiAgICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgX3VwZGF0ZVdlaWdodCh0aW1lKSB7CiAgICBsZXQgd2VpZ2h0ID0gMDsKICAgIGlmICh0aGlzLmVuYWJsZWQpIHsKICAgICAgd2VpZ2h0ID0gdGhpcy53ZWlnaHQ7CiAgICAgIGNvbnN0IGludGVycG9sYW50ID0gdGhpcy5fd2VpZ2h0SW50ZXJwb2xhbnQ7CiAgICAgIGlmIChpbnRlcnBvbGFudCAhPT0gbnVsbCkgewogICAgICAgIGNvbnN0IGludGVycG9sYW50VmFsdWUgPSBpbnRlcnBvbGFudC5ldmFsdWF0ZSh0aW1lKVswXTsKICAgICAgICB3ZWlnaHQgKj0gaW50ZXJwb2xhbnRWYWx1ZTsKICAgICAgICBpZiAodGltZSA+IGludGVycG9sYW50LnBhcmFtZXRlclBvc2l0aW9uc1sxXSkgewogICAgICAgICAgdGhpcy5zdG9wRmFkaW5nKCk7CiAgICAgICAgICBpZiAoaW50ZXJwb2xhbnRWYWx1ZSA9PT0gMCkgewogICAgICAgICAgICB0aGlzLmVuYWJsZWQgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHRoaXMuX2VmZmVjdGl2ZVdlaWdodCA9IHdlaWdodDsKICAgIHJldHVybiB3ZWlnaHQ7CiAgfQogIF91cGRhdGVUaW1lU2NhbGUodGltZSkgewogICAgbGV0IHRpbWVTY2FsZSA9IDA7CiAgICBpZiAoIXRoaXMucGF1c2VkKSB7CiAgICAgIHRpbWVTY2FsZSA9IHRoaXMudGltZVNjYWxlOwogICAgICBjb25zdCBpbnRlcnBvbGFudCA9IHRoaXMuX3RpbWVTY2FsZUludGVycG9sYW50OwogICAgICBpZiAoaW50ZXJwb2xhbnQgIT09IG51bGwpIHsKICAgICAgICBjb25zdCBpbnRlcnBvbGFudFZhbHVlID0gaW50ZXJwb2xhbnQuZXZhbHVhdGUodGltZSlbMF07CiAgICAgICAgdGltZVNjYWxlICo9IGludGVycG9sYW50VmFsdWU7CiAgICAgICAgaWYgKHRpbWUgPiBpbnRlcnBvbGFudC5wYXJhbWV0ZXJQb3NpdGlvbnNbMV0pIHsKICAgICAgICAgIHRoaXMuc3RvcFdhcnBpbmcoKTsKICAgICAgICAgIGlmICh0aW1lU2NhbGUgPT09IDApIHsKICAgICAgICAgICAgdGhpcy5wYXVzZWQgPSB0cnVlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy50aW1lU2NhbGUgPSB0aW1lU2NhbGU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICB0aGlzLl9lZmZlY3RpdmVUaW1lU2NhbGUgPSB0aW1lU2NhbGU7CiAgICByZXR1cm4gdGltZVNjYWxlOwogIH0KICBfdXBkYXRlVGltZShkZWx0YVRpbWUpIHsKICAgIGNvbnN0IGR1cmF0aW9uID0gdGhpcy5fY2xpcC5kdXJhdGlvbjsKICAgIGNvbnN0IGxvb3AgPSB0aGlzLmxvb3A7CiAgICBsZXQgdGltZSA9IHRoaXMudGltZSArIGRlbHRhVGltZTsKICAgIGxldCBsb29wQ291bnQgPSB0aGlzLl9sb29wQ291bnQ7CiAgICBjb25zdCBwaW5nUG9uZyA9IGxvb3AgPT09IExvb3BQaW5nUG9uZzsKICAgIGlmIChkZWx0YVRpbWUgPT09IDApIHsKICAgICAgaWYgKGxvb3BDb3VudCA9PT0gLTEpCiAgICAgICAgcmV0dXJuIHRpbWU7CiAgICAgIHJldHVybiBwaW5nUG9uZyAmJiAobG9vcENvdW50ICYgMSkgPT09IDEgPyBkdXJhdGlvbiAtIHRpbWUgOiB0aW1lOwogICAgfQogICAgaWYgKGxvb3AgPT09IExvb3BPbmNlKSB7CiAgICAgIGlmIChsb29wQ291bnQgPT09IC0xKSB7CiAgICAgICAgdGhpcy5fbG9vcENvdW50ID0gMDsKICAgICAgICB0aGlzLl9zZXRFbmRpbmdzKHRydWUsIHRydWUsIGZhbHNlKTsKICAgICAgfQogICAgICBoYW5kbGVfc3RvcDogewogICAgICAgIGlmICh0aW1lID49IGR1cmF0aW9uKSB7CiAgICAgICAgICB0aW1lID0gZHVyYXRpb247CiAgICAgICAgfSBlbHNlIGlmICh0aW1lIDwgMCkgewogICAgICAgICAgdGltZSA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudGltZSA9IHRpbWU7CiAgICAgICAgICBicmVhayBoYW5kbGVfc3RvcDsKICAgICAgICB9CiAgICAgICAgaWYgKHRoaXMuY2xhbXBXaGVuRmluaXNoZWQpCiAgICAgICAgICB0aGlzLnBhdXNlZCA9IHRydWU7CiAgICAgICAgZWxzZQogICAgICAgICAgdGhpcy5lbmFibGVkID0gZmFsc2U7CiAgICAgICAgdGhpcy50aW1lID0gdGltZTsKICAgICAgICB0aGlzLl9taXhlci5kaXNwYXRjaEV2ZW50KHsKICAgICAgICAgIHR5cGU6ICJmaW5pc2hlZCIsCiAgICAgICAgICBhY3Rpb246IHRoaXMsCiAgICAgICAgICBkaXJlY3Rpb246IGRlbHRhVGltZSA8IDAgPyAtMSA6IDEKICAgICAgICB9KTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKGxvb3BDb3VudCA9PT0gLTEpIHsKICAgICAgICBpZiAoZGVsdGFUaW1lID49IDApIHsKICAgICAgICAgIGxvb3BDb3VudCA9IDA7CiAgICAgICAgICB0aGlzLl9zZXRFbmRpbmdzKHRydWUsIHRoaXMucmVwZXRpdGlvbnMgPT09IDAsIHBpbmdQb25nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5fc2V0RW5kaW5ncyh0aGlzLnJlcGV0aXRpb25zID09PSAwLCB0cnVlLCBwaW5nUG9uZyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aW1lID49IGR1cmF0aW9uIHx8IHRpbWUgPCAwKSB7CiAgICAgICAgY29uc3QgbG9vcERlbHRhID0gTWF0aC5mbG9vcih0aW1lIC8gZHVyYXRpb24pOwogICAgICAgIHRpbWUgLT0gZHVyYXRpb24gKiBsb29wRGVsdGE7CiAgICAgICAgbG9vcENvdW50ICs9IE1hdGguYWJzKGxvb3BEZWx0YSk7CiAgICAgICAgY29uc3QgcGVuZGluZyA9IHRoaXMucmVwZXRpdGlvbnMgLSBsb29wQ291bnQ7CiAgICAgICAgaWYgKHBlbmRpbmcgPD0gMCkgewogICAgICAgICAgaWYgKHRoaXMuY2xhbXBXaGVuRmluaXNoZWQpCiAgICAgICAgICAgIHRoaXMucGF1c2VkID0gdHJ1ZTsKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgdGhpcy5lbmFibGVkID0gZmFsc2U7CiAgICAgICAgICB0aW1lID0gZGVsdGFUaW1lID4gMCA/IGR1cmF0aW9uIDogMDsKICAgICAgICAgIHRoaXMudGltZSA9IHRpbWU7CiAgICAgICAgICB0aGlzLl9taXhlci5kaXNwYXRjaEV2ZW50KHsKICAgICAgICAgICAgdHlwZTogImZpbmlzaGVkIiwKICAgICAgICAgICAgYWN0aW9uOiB0aGlzLAogICAgICAgICAgICBkaXJlY3Rpb246IGRlbHRhVGltZSA+IDAgPyAxIDogLTEKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAocGVuZGluZyA9PT0gMSkgewogICAgICAgICAgICBjb25zdCBhdFN0YXJ0ID0gZGVsdGFUaW1lIDwgMDsKICAgICAgICAgICAgdGhpcy5fc2V0RW5kaW5ncyhhdFN0YXJ0LCAhYXRTdGFydCwgcGluZ1BvbmcpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5fc2V0RW5kaW5ncyhmYWxzZSwgZmFsc2UsIHBpbmdQb25nKTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuX2xvb3BDb3VudCA9IGxvb3BDb3VudDsKICAgICAgICAgIHRoaXMudGltZSA9IHRpbWU7CiAgICAgICAgICB0aGlzLl9taXhlci5kaXNwYXRjaEV2ZW50KHsKICAgICAgICAgICAgdHlwZTogImxvb3AiLAogICAgICAgICAgICBhY3Rpb246IHRoaXMsCiAgICAgICAgICAgIGxvb3BEZWx0YQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMudGltZSA9IHRpbWU7CiAgICAgIH0KICAgICAgaWYgKHBpbmdQb25nICYmIChsb29wQ291bnQgJiAxKSA9PT0gMSkgewogICAgICAgIHJldHVybiBkdXJhdGlvbiAtIHRpbWU7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0aW1lOwogIH0KICBfc2V0RW5kaW5ncyhhdFN0YXJ0LCBhdEVuZCwgcGluZ1BvbmcpIHsKICAgIGNvbnN0IHNldHRpbmdzID0gdGhpcy5faW50ZXJwb2xhbnRTZXR0aW5nczsKICAgIGlmIChwaW5nUG9uZykgewogICAgICBzZXR0aW5ncy5lbmRpbmdTdGFydCA9IFplcm9TbG9wZUVuZGluZzsKICAgICAgc2V0dGluZ3MuZW5kaW5nRW5kID0gWmVyb1Nsb3BlRW5kaW5nOwogICAgfSBlbHNlIHsKICAgICAgaWYgKGF0U3RhcnQpIHsKICAgICAgICBzZXR0aW5ncy5lbmRpbmdTdGFydCA9IHRoaXMuemVyb1Nsb3BlQXRTdGFydCA/IFplcm9TbG9wZUVuZGluZyA6IFplcm9DdXJ2YXR1cmVFbmRpbmc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2V0dGluZ3MuZW5kaW5nU3RhcnQgPSBXcmFwQXJvdW5kRW5kaW5nOwogICAgICB9CiAgICAgIGlmIChhdEVuZCkgewogICAgICAgIHNldHRpbmdzLmVuZGluZ0VuZCA9IHRoaXMuemVyb1Nsb3BlQXRFbmQgPyBaZXJvU2xvcGVFbmRpbmcgOiBaZXJvQ3VydmF0dXJlRW5kaW5nOwogICAgICB9IGVsc2UgewogICAgICAgIHNldHRpbmdzLmVuZGluZ0VuZCA9IFdyYXBBcm91bmRFbmRpbmc7CiAgICAgIH0KICAgIH0KICB9CiAgX3NjaGVkdWxlRmFkaW5nKGR1cmF0aW9uLCB3ZWlnaHROb3csIHdlaWdodFRoZW4pIHsKICAgIGNvbnN0IG1peGVyID0gdGhpcy5fbWl4ZXIsIG5vdzIgPSBtaXhlci50aW1lOwogICAgbGV0IGludGVycG9sYW50ID0gdGhpcy5fd2VpZ2h0SW50ZXJwb2xhbnQ7CiAgICBpZiAoaW50ZXJwb2xhbnQgPT09IG51bGwpIHsKICAgICAgaW50ZXJwb2xhbnQgPSBtaXhlci5fbGVuZENvbnRyb2xJbnRlcnBvbGFudCgpOwogICAgICB0aGlzLl93ZWlnaHRJbnRlcnBvbGFudCA9IGludGVycG9sYW50OwogICAgfQogICAgY29uc3QgdGltZXMgPSBpbnRlcnBvbGFudC5wYXJhbWV0ZXJQb3NpdGlvbnMsIHZhbHVlcyA9IGludGVycG9sYW50LnNhbXBsZVZhbHVlczsKICAgIHRpbWVzWzBdID0gbm93MjsKICAgIHZhbHVlc1swXSA9IHdlaWdodE5vdzsKICAgIHRpbWVzWzFdID0gbm93MiArIGR1cmF0aW9uOwogICAgdmFsdWVzWzFdID0gd2VpZ2h0VGhlbjsKICAgIHJldHVybiB0aGlzOwogIH0KfQpjbGFzcyBBbmltYXRpb25NaXhlciBleHRlbmRzIEV2ZW50RGlzcGF0Y2hlciB7CiAgY29uc3RydWN0b3Iocm9vdCkgewogICAgc3VwZXIoKTsKICAgIHRoaXMuX3Jvb3QgPSByb290OwogICAgdGhpcy5faW5pdE1lbW9yeU1hbmFnZXIoKTsKICAgIHRoaXMuX2FjY3VJbmRleCA9IDA7CiAgICB0aGlzLnRpbWUgPSAwOwogICAgdGhpcy50aW1lU2NhbGUgPSAxOwogIH0KICBfYmluZEFjdGlvbihhY3Rpb24sIHByb3RvdHlwZUFjdGlvbikgewogICAgY29uc3Qgcm9vdCA9IGFjdGlvbi5fbG9jYWxSb290IHx8IHRoaXMuX3Jvb3QsIHRyYWNrcyA9IGFjdGlvbi5fY2xpcC50cmFja3MsIG5UcmFja3MgPSB0cmFja3MubGVuZ3RoLCBiaW5kaW5ncyA9IGFjdGlvbi5fcHJvcGVydHlCaW5kaW5ncywgaW50ZXJwb2xhbnRzID0gYWN0aW9uLl9pbnRlcnBvbGFudHMsIHJvb3RVdWlkID0gcm9vdC51dWlkLCBiaW5kaW5nc0J5Um9vdCA9IHRoaXMuX2JpbmRpbmdzQnlSb290QW5kTmFtZTsKICAgIGxldCBiaW5kaW5nc0J5TmFtZSA9IGJpbmRpbmdzQnlSb290W3Jvb3RVdWlkXTsKICAgIGlmIChiaW5kaW5nc0J5TmFtZSA9PT0gdm9pZCAwKSB7CiAgICAgIGJpbmRpbmdzQnlOYW1lID0ge307CiAgICAgIGJpbmRpbmdzQnlSb290W3Jvb3RVdWlkXSA9IGJpbmRpbmdzQnlOYW1lOwogICAgfQogICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IG5UcmFja3M7ICsraSkgewogICAgICBjb25zdCB0cmFjayA9IHRyYWNrc1tpXSwgdHJhY2tOYW1lID0gdHJhY2submFtZTsKICAgICAgbGV0IGJpbmRpbmcgPSBiaW5kaW5nc0J5TmFtZVt0cmFja05hbWVdOwogICAgICBpZiAoYmluZGluZyAhPT0gdm9pZCAwKSB7CiAgICAgICAgKytiaW5kaW5nLnJlZmVyZW5jZUNvdW50OwogICAgICAgIGJpbmRpbmdzW2ldID0gYmluZGluZzsKICAgICAgfSBlbHNlIHsKICAgICAgICBiaW5kaW5nID0gYmluZGluZ3NbaV07CiAgICAgICAgaWYgKGJpbmRpbmcgIT09IHZvaWQgMCkgewogICAgICAgICAgaWYgKGJpbmRpbmcuX2NhY2hlSW5kZXggPT09IG51bGwpIHsKICAgICAgICAgICAgKytiaW5kaW5nLnJlZmVyZW5jZUNvdW50OwogICAgICAgICAgICB0aGlzLl9hZGRJbmFjdGl2ZUJpbmRpbmcoYmluZGluZywgcm9vdFV1aWQsIHRyYWNrTmFtZSk7CiAgICAgICAgICB9CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgY29uc3QgcGF0aCA9IHByb3RvdHlwZUFjdGlvbiAmJiBwcm90b3R5cGVBY3Rpb24uX3Byb3BlcnR5QmluZGluZ3NbaV0uYmluZGluZy5wYXJzZWRQYXRoOwogICAgICAgIGJpbmRpbmcgPSBuZXcgUHJvcGVydHlNaXhlcihQcm9wZXJ0eUJpbmRpbmcuY3JlYXRlKHJvb3QsIHRyYWNrTmFtZSwgcGF0aCksIHRyYWNrLlZhbHVlVHlwZU5hbWUsIHRyYWNrLmdldFZhbHVlU2l6ZSgpKTsKICAgICAgICArK2JpbmRpbmcucmVmZXJlbmNlQ291bnQ7CiAgICAgICAgdGhpcy5fYWRkSW5hY3RpdmVCaW5kaW5nKGJpbmRpbmcsIHJvb3RVdWlkLCB0cmFja05hbWUpOwogICAgICAgIGJpbmRpbmdzW2ldID0gYmluZGluZzsKICAgICAgfQogICAgICBpbnRlcnBvbGFudHNbaV0ucmVzdWx0QnVmZmVyID0gYmluZGluZy5idWZmZXI7CiAgICB9CiAgfQogIF9hY3RpdmF0ZUFjdGlvbihhY3Rpb24pIHsKICAgIGlmICghdGhpcy5faXNBY3RpdmVBY3Rpb24oYWN0aW9uKSkgewogICAgICBpZiAoYWN0aW9uLl9jYWNoZUluZGV4ID09PSBudWxsKSB7CiAgICAgICAgY29uc3Qgcm9vdFV1aWQgPSAoYWN0aW9uLl9sb2NhbFJvb3QgfHwgdGhpcy5fcm9vdCkudXVpZCwgY2xpcFV1aWQgPSBhY3Rpb24uX2NsaXAudXVpZCwgYWN0aW9uc0ZvckNsaXAgPSB0aGlzLl9hY3Rpb25zQnlDbGlwW2NsaXBVdWlkXTsKICAgICAgICB0aGlzLl9iaW5kQWN0aW9uKGFjdGlvbiwgYWN0aW9uc0ZvckNsaXAgJiYgYWN0aW9uc0ZvckNsaXAua25vd25BY3Rpb25zWzBdKTsKICAgICAgICB0aGlzLl9hZGRJbmFjdGl2ZUFjdGlvbihhY3Rpb24sIGNsaXBVdWlkLCByb290VXVpZCk7CiAgICAgIH0KICAgICAgY29uc3QgYmluZGluZ3MgPSBhY3Rpb24uX3Byb3BlcnR5QmluZGluZ3M7CiAgICAgIGZvciAobGV0IGkgPSAwLCBuID0gYmluZGluZ3MubGVuZ3RoOyBpICE9PSBuOyArK2kpIHsKICAgICAgICBjb25zdCBiaW5kaW5nID0gYmluZGluZ3NbaV07CiAgICAgICAgaWYgKGJpbmRpbmcudXNlQ291bnQrKyA9PT0gMCkgewogICAgICAgICAgdGhpcy5fbGVuZEJpbmRpbmcoYmluZGluZyk7CiAgICAgICAgICBiaW5kaW5nLnNhdmVPcmlnaW5hbFN0YXRlKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuX2xlbmRBY3Rpb24oYWN0aW9uKTsKICAgIH0KICB9CiAgX2RlYWN0aXZhdGVBY3Rpb24oYWN0aW9uKSB7CiAgICBpZiAodGhpcy5faXNBY3RpdmVBY3Rpb24oYWN0aW9uKSkgewogICAgICBjb25zdCBiaW5kaW5ncyA9IGFjdGlvbi5fcHJvcGVydHlCaW5kaW5nczsKICAgICAgZm9yIChsZXQgaSA9IDAsIG4gPSBiaW5kaW5ncy5sZW5ndGg7IGkgIT09IG47ICsraSkgewogICAgICAgIGNvbnN0IGJpbmRpbmcgPSBiaW5kaW5nc1tpXTsKICAgICAgICBpZiAoLS1iaW5kaW5nLnVzZUNvdW50ID09PSAwKSB7CiAgICAgICAgICBiaW5kaW5nLnJlc3RvcmVPcmlnaW5hbFN0YXRlKCk7CiAgICAgICAgICB0aGlzLl90YWtlQmFja0JpbmRpbmcoYmluZGluZyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuX3Rha2VCYWNrQWN0aW9uKGFjdGlvbik7CiAgICB9CiAgfQogIF9pbml0TWVtb3J5TWFuYWdlcigpIHsKICAgIHRoaXMuX2FjdGlvbnMgPSBbXTsKICAgIHRoaXMuX25BY3RpdmVBY3Rpb25zID0gMDsKICAgIHRoaXMuX2FjdGlvbnNCeUNsaXAgPSB7fTsKICAgIHRoaXMuX2JpbmRpbmdzID0gW107CiAgICB0aGlzLl9uQWN0aXZlQmluZGluZ3MgPSAwOwogICAgdGhpcy5fYmluZGluZ3NCeVJvb3RBbmROYW1lID0ge307CiAgICB0aGlzLl9jb250cm9sSW50ZXJwb2xhbnRzID0gW107CiAgICB0aGlzLl9uQWN0aXZlQ29udHJvbEludGVycG9sYW50cyA9IDA7CiAgICBjb25zdCBzY29wZSA9IHRoaXM7CiAgICB0aGlzLnN0YXRzID0gewogICAgICBhY3Rpb25zOiB7CiAgICAgICAgZ2V0IHRvdGFsKCkgewogICAgICAgICAgcmV0dXJuIHNjb3BlLl9hY3Rpb25zLmxlbmd0aDsKICAgICAgICB9LAogICAgICAgIGdldCBpblVzZSgpIHsKICAgICAgICAgIHJldHVybiBzY29wZS5fbkFjdGl2ZUFjdGlvbnM7CiAgICAgICAgfQogICAgICB9LAogICAgICBiaW5kaW5nczogewogICAgICAgIGdldCB0b3RhbCgpIHsKICAgICAgICAgIHJldHVybiBzY29wZS5fYmluZGluZ3MubGVuZ3RoOwogICAgICAgIH0sCiAgICAgICAgZ2V0IGluVXNlKCkgewogICAgICAgICAgcmV0dXJuIHNjb3BlLl9uQWN0aXZlQmluZGluZ3M7CiAgICAgICAgfQogICAgICB9LAogICAgICBjb250cm9sSW50ZXJwb2xhbnRzOiB7CiAgICAgICAgZ2V0IHRvdGFsKCkgewogICAgICAgICAgcmV0dXJuIHNjb3BlLl9jb250cm9sSW50ZXJwb2xhbnRzLmxlbmd0aDsKICAgICAgICB9LAogICAgICAgIGdldCBpblVzZSgpIHsKICAgICAgICAgIHJldHVybiBzY29wZS5fbkFjdGl2ZUNvbnRyb2xJbnRlcnBvbGFudHM7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogIH0KICBfaXNBY3RpdmVBY3Rpb24oYWN0aW9uKSB7CiAgICBjb25zdCBpbmRleCA9IGFjdGlvbi5fY2FjaGVJbmRleDsKICAgIHJldHVybiBpbmRleCAhPT0gbnVsbCAmJiBpbmRleCA8IHRoaXMuX25BY3RpdmVBY3Rpb25zOwogIH0KICBfYWRkSW5hY3RpdmVBY3Rpb24oYWN0aW9uLCBjbGlwVXVpZCwgcm9vdFV1aWQpIHsKICAgIGNvbnN0IGFjdGlvbnMgPSB0aGlzLl9hY3Rpb25zLCBhY3Rpb25zQnlDbGlwID0gdGhpcy5fYWN0aW9uc0J5Q2xpcDsKICAgIGxldCBhY3Rpb25zRm9yQ2xpcCA9IGFjdGlvbnNCeUNsaXBbY2xpcFV1aWRdOwogICAgaWYgKGFjdGlvbnNGb3JDbGlwID09PSB2b2lkIDApIHsKICAgICAgYWN0aW9uc0ZvckNsaXAgPSB7CiAgICAgICAga25vd25BY3Rpb25zOiBbYWN0aW9uXSwKICAgICAgICBhY3Rpb25CeVJvb3Q6IHt9CiAgICAgIH07CiAgICAgIGFjdGlvbi5fYnlDbGlwQ2FjaGVJbmRleCA9IDA7CiAgICAgIGFjdGlvbnNCeUNsaXBbY2xpcFV1aWRdID0gYWN0aW9uc0ZvckNsaXA7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBrbm93bkFjdGlvbnMgPSBhY3Rpb25zRm9yQ2xpcC5rbm93bkFjdGlvbnM7CiAgICAgIGFjdGlvbi5fYnlDbGlwQ2FjaGVJbmRleCA9IGtub3duQWN0aW9ucy5sZW5ndGg7CiAgICAgIGtub3duQWN0aW9ucy5wdXNoKGFjdGlvbik7CiAgICB9CiAgICBhY3Rpb24uX2NhY2hlSW5kZXggPSBhY3Rpb25zLmxlbmd0aDsKICAgIGFjdGlvbnMucHVzaChhY3Rpb24pOwogICAgYWN0aW9uc0ZvckNsaXAuYWN0aW9uQnlSb290W3Jvb3RVdWlkXSA9IGFjdGlvbjsKICB9CiAgX3JlbW92ZUluYWN0aXZlQWN0aW9uKGFjdGlvbikgewogICAgY29uc3QgYWN0aW9ucyA9IHRoaXMuX2FjdGlvbnMsIGxhc3RJbmFjdGl2ZUFjdGlvbiA9IGFjdGlvbnNbYWN0aW9ucy5sZW5ndGggLSAxXSwgY2FjaGVJbmRleCA9IGFjdGlvbi5fY2FjaGVJbmRleDsKICAgIGxhc3RJbmFjdGl2ZUFjdGlvbi5fY2FjaGVJbmRleCA9IGNhY2hlSW5kZXg7CiAgICBhY3Rpb25zW2NhY2hlSW5kZXhdID0gbGFzdEluYWN0aXZlQWN0aW9uOwogICAgYWN0aW9ucy5wb3AoKTsKICAgIGFjdGlvbi5fY2FjaGVJbmRleCA9IG51bGw7CiAgICBjb25zdCBjbGlwVXVpZCA9IGFjdGlvbi5fY2xpcC51dWlkLCBhY3Rpb25zQnlDbGlwID0gdGhpcy5fYWN0aW9uc0J5Q2xpcCwgYWN0aW9uc0ZvckNsaXAgPSBhY3Rpb25zQnlDbGlwW2NsaXBVdWlkXSwga25vd25BY3Rpb25zRm9yQ2xpcCA9IGFjdGlvbnNGb3JDbGlwLmtub3duQWN0aW9ucywgbGFzdEtub3duQWN0aW9uID0ga25vd25BY3Rpb25zRm9yQ2xpcFtrbm93bkFjdGlvbnNGb3JDbGlwLmxlbmd0aCAtIDFdLCBieUNsaXBDYWNoZUluZGV4ID0gYWN0aW9uLl9ieUNsaXBDYWNoZUluZGV4OwogICAgbGFzdEtub3duQWN0aW9uLl9ieUNsaXBDYWNoZUluZGV4ID0gYnlDbGlwQ2FjaGVJbmRleDsKICAgIGtub3duQWN0aW9uc0ZvckNsaXBbYnlDbGlwQ2FjaGVJbmRleF0gPSBsYXN0S25vd25BY3Rpb247CiAgICBrbm93bkFjdGlvbnNGb3JDbGlwLnBvcCgpOwogICAgYWN0aW9uLl9ieUNsaXBDYWNoZUluZGV4ID0gbnVsbDsKICAgIGNvbnN0IGFjdGlvbkJ5Um9vdCA9IGFjdGlvbnNGb3JDbGlwLmFjdGlvbkJ5Um9vdCwgcm9vdFV1aWQgPSAoYWN0aW9uLl9sb2NhbFJvb3QgfHwgdGhpcy5fcm9vdCkudXVpZDsKICAgIGRlbGV0ZSBhY3Rpb25CeVJvb3Rbcm9vdFV1aWRdOwogICAgaWYgKGtub3duQWN0aW9uc0ZvckNsaXAubGVuZ3RoID09PSAwKSB7CiAgICAgIGRlbGV0ZSBhY3Rpb25zQnlDbGlwW2NsaXBVdWlkXTsKICAgIH0KICAgIHRoaXMuX3JlbW92ZUluYWN0aXZlQmluZGluZ3NGb3JBY3Rpb24oYWN0aW9uKTsKICB9CiAgX3JlbW92ZUluYWN0aXZlQmluZGluZ3NGb3JBY3Rpb24oYWN0aW9uKSB7CiAgICBjb25zdCBiaW5kaW5ncyA9IGFjdGlvbi5fcHJvcGVydHlCaW5kaW5nczsKICAgIGZvciAobGV0IGkgPSAwLCBuID0gYmluZGluZ3MubGVuZ3RoOyBpICE9PSBuOyArK2kpIHsKICAgICAgY29uc3QgYmluZGluZyA9IGJpbmRpbmdzW2ldOwogICAgICBpZiAoLS1iaW5kaW5nLnJlZmVyZW5jZUNvdW50ID09PSAwKSB7CiAgICAgICAgdGhpcy5fcmVtb3ZlSW5hY3RpdmVCaW5kaW5nKGJpbmRpbmcpOwogICAgICB9CiAgICB9CiAgfQogIF9sZW5kQWN0aW9uKGFjdGlvbikgewogICAgY29uc3QgYWN0aW9ucyA9IHRoaXMuX2FjdGlvbnMsIHByZXZJbmRleCA9IGFjdGlvbi5fY2FjaGVJbmRleCwgbGFzdEFjdGl2ZUluZGV4ID0gdGhpcy5fbkFjdGl2ZUFjdGlvbnMrKywgZmlyc3RJbmFjdGl2ZUFjdGlvbiA9IGFjdGlvbnNbbGFzdEFjdGl2ZUluZGV4XTsKICAgIGFjdGlvbi5fY2FjaGVJbmRleCA9IGxhc3RBY3RpdmVJbmRleDsKICAgIGFjdGlvbnNbbGFzdEFjdGl2ZUluZGV4XSA9IGFjdGlvbjsKICAgIGZpcnN0SW5hY3RpdmVBY3Rpb24uX2NhY2hlSW5kZXggPSBwcmV2SW5kZXg7CiAgICBhY3Rpb25zW3ByZXZJbmRleF0gPSBmaXJzdEluYWN0aXZlQWN0aW9uOwogIH0KICBfdGFrZUJhY2tBY3Rpb24oYWN0aW9uKSB7CiAgICBjb25zdCBhY3Rpb25zID0gdGhpcy5fYWN0aW9ucywgcHJldkluZGV4ID0gYWN0aW9uLl9jYWNoZUluZGV4LCBmaXJzdEluYWN0aXZlSW5kZXggPSAtLXRoaXMuX25BY3RpdmVBY3Rpb25zLCBsYXN0QWN0aXZlQWN0aW9uID0gYWN0aW9uc1tmaXJzdEluYWN0aXZlSW5kZXhdOwogICAgYWN0aW9uLl9jYWNoZUluZGV4ID0gZmlyc3RJbmFjdGl2ZUluZGV4OwogICAgYWN0aW9uc1tmaXJzdEluYWN0aXZlSW5kZXhdID0gYWN0aW9uOwogICAgbGFzdEFjdGl2ZUFjdGlvbi5fY2FjaGVJbmRleCA9IHByZXZJbmRleDsKICAgIGFjdGlvbnNbcHJldkluZGV4XSA9IGxhc3RBY3RpdmVBY3Rpb247CiAgfQogIF9hZGRJbmFjdGl2ZUJpbmRpbmcoYmluZGluZywgcm9vdFV1aWQsIHRyYWNrTmFtZSkgewogICAgY29uc3QgYmluZGluZ3NCeVJvb3QgPSB0aGlzLl9iaW5kaW5nc0J5Um9vdEFuZE5hbWUsIGJpbmRpbmdzID0gdGhpcy5fYmluZGluZ3M7CiAgICBsZXQgYmluZGluZ0J5TmFtZSA9IGJpbmRpbmdzQnlSb290W3Jvb3RVdWlkXTsKICAgIGlmIChiaW5kaW5nQnlOYW1lID09PSB2b2lkIDApIHsKICAgICAgYmluZGluZ0J5TmFtZSA9IHt9OwogICAgICBiaW5kaW5nc0J5Um9vdFtyb290VXVpZF0gPSBiaW5kaW5nQnlOYW1lOwogICAgfQogICAgYmluZGluZ0J5TmFtZVt0cmFja05hbWVdID0gYmluZGluZzsKICAgIGJpbmRpbmcuX2NhY2hlSW5kZXggPSBiaW5kaW5ncy5sZW5ndGg7CiAgICBiaW5kaW5ncy5wdXNoKGJpbmRpbmcpOwogIH0KICBfcmVtb3ZlSW5hY3RpdmVCaW5kaW5nKGJpbmRpbmcpIHsKICAgIGNvbnN0IGJpbmRpbmdzID0gdGhpcy5fYmluZGluZ3MsIHByb3BCaW5kaW5nID0gYmluZGluZy5iaW5kaW5nLCByb290VXVpZCA9IHByb3BCaW5kaW5nLnJvb3ROb2RlLnV1aWQsIHRyYWNrTmFtZSA9IHByb3BCaW5kaW5nLnBhdGgsIGJpbmRpbmdzQnlSb290ID0gdGhpcy5fYmluZGluZ3NCeVJvb3RBbmROYW1lLCBiaW5kaW5nQnlOYW1lID0gYmluZGluZ3NCeVJvb3Rbcm9vdFV1aWRdLCBsYXN0SW5hY3RpdmVCaW5kaW5nID0gYmluZGluZ3NbYmluZGluZ3MubGVuZ3RoIC0gMV0sIGNhY2hlSW5kZXggPSBiaW5kaW5nLl9jYWNoZUluZGV4OwogICAgbGFzdEluYWN0aXZlQmluZGluZy5fY2FjaGVJbmRleCA9IGNhY2hlSW5kZXg7CiAgICBiaW5kaW5nc1tjYWNoZUluZGV4XSA9IGxhc3RJbmFjdGl2ZUJpbmRpbmc7CiAgICBiaW5kaW5ncy5wb3AoKTsKICAgIGRlbGV0ZSBiaW5kaW5nQnlOYW1lW3RyYWNrTmFtZV07CiAgICBpZiAoT2JqZWN0LmtleXMoYmluZGluZ0J5TmFtZSkubGVuZ3RoID09PSAwKSB7CiAgICAgIGRlbGV0ZSBiaW5kaW5nc0J5Um9vdFtyb290VXVpZF07CiAgICB9CiAgfQogIF9sZW5kQmluZGluZyhiaW5kaW5nKSB7CiAgICBjb25zdCBiaW5kaW5ncyA9IHRoaXMuX2JpbmRpbmdzLCBwcmV2SW5kZXggPSBiaW5kaW5nLl9jYWNoZUluZGV4LCBsYXN0QWN0aXZlSW5kZXggPSB0aGlzLl9uQWN0aXZlQmluZGluZ3MrKywgZmlyc3RJbmFjdGl2ZUJpbmRpbmcgPSBiaW5kaW5nc1tsYXN0QWN0aXZlSW5kZXhdOwogICAgYmluZGluZy5fY2FjaGVJbmRleCA9IGxhc3RBY3RpdmVJbmRleDsKICAgIGJpbmRpbmdzW2xhc3RBY3RpdmVJbmRleF0gPSBiaW5kaW5nOwogICAgZmlyc3RJbmFjdGl2ZUJpbmRpbmcuX2NhY2hlSW5kZXggPSBwcmV2SW5kZXg7CiAgICBiaW5kaW5nc1twcmV2SW5kZXhdID0gZmlyc3RJbmFjdGl2ZUJpbmRpbmc7CiAgfQogIF90YWtlQmFja0JpbmRpbmcoYmluZGluZykgewogICAgY29uc3QgYmluZGluZ3MgPSB0aGlzLl9iaW5kaW5ncywgcHJldkluZGV4ID0gYmluZGluZy5fY2FjaGVJbmRleCwgZmlyc3RJbmFjdGl2ZUluZGV4ID0gLS10aGlzLl9uQWN0aXZlQmluZGluZ3MsIGxhc3RBY3RpdmVCaW5kaW5nID0gYmluZGluZ3NbZmlyc3RJbmFjdGl2ZUluZGV4XTsKICAgIGJpbmRpbmcuX2NhY2hlSW5kZXggPSBmaXJzdEluYWN0aXZlSW5kZXg7CiAgICBiaW5kaW5nc1tmaXJzdEluYWN0aXZlSW5kZXhdID0gYmluZGluZzsKICAgIGxhc3RBY3RpdmVCaW5kaW5nLl9jYWNoZUluZGV4ID0gcHJldkluZGV4OwogICAgYmluZGluZ3NbcHJldkluZGV4XSA9IGxhc3RBY3RpdmVCaW5kaW5nOwogIH0KICBfbGVuZENvbnRyb2xJbnRlcnBvbGFudCgpIHsKICAgIGNvbnN0IGludGVycG9sYW50cyA9IHRoaXMuX2NvbnRyb2xJbnRlcnBvbGFudHMsIGxhc3RBY3RpdmVJbmRleCA9IHRoaXMuX25BY3RpdmVDb250cm9sSW50ZXJwb2xhbnRzKys7CiAgICBsZXQgaW50ZXJwb2xhbnQgPSBpbnRlcnBvbGFudHNbbGFzdEFjdGl2ZUluZGV4XTsKICAgIGlmIChpbnRlcnBvbGFudCA9PT0gdm9pZCAwKSB7CiAgICAgIGludGVycG9sYW50ID0gbmV3IExpbmVhckludGVycG9sYW50KG5ldyBGbG9hdDMyQXJyYXkoMiksIG5ldyBGbG9hdDMyQXJyYXkoMiksIDEsIHRoaXMuX2NvbnRyb2xJbnRlcnBvbGFudHNSZXN1bHRCdWZmZXIpOwogICAgICBpbnRlcnBvbGFudC5fX2NhY2hlSW5kZXggPSBsYXN0QWN0aXZlSW5kZXg7CiAgICAgIGludGVycG9sYW50c1tsYXN0QWN0aXZlSW5kZXhdID0gaW50ZXJwb2xhbnQ7CiAgICB9CiAgICByZXR1cm4gaW50ZXJwb2xhbnQ7CiAgfQogIF90YWtlQmFja0NvbnRyb2xJbnRlcnBvbGFudChpbnRlcnBvbGFudCkgewogICAgY29uc3QgaW50ZXJwb2xhbnRzID0gdGhpcy5fY29udHJvbEludGVycG9sYW50cywgcHJldkluZGV4ID0gaW50ZXJwb2xhbnQuX19jYWNoZUluZGV4LCBmaXJzdEluYWN0aXZlSW5kZXggPSAtLXRoaXMuX25BY3RpdmVDb250cm9sSW50ZXJwb2xhbnRzLCBsYXN0QWN0aXZlSW50ZXJwb2xhbnQgPSBpbnRlcnBvbGFudHNbZmlyc3RJbmFjdGl2ZUluZGV4XTsKICAgIGludGVycG9sYW50Ll9fY2FjaGVJbmRleCA9IGZpcnN0SW5hY3RpdmVJbmRleDsKICAgIGludGVycG9sYW50c1tmaXJzdEluYWN0aXZlSW5kZXhdID0gaW50ZXJwb2xhbnQ7CiAgICBsYXN0QWN0aXZlSW50ZXJwb2xhbnQuX19jYWNoZUluZGV4ID0gcHJldkluZGV4OwogICAgaW50ZXJwb2xhbnRzW3ByZXZJbmRleF0gPSBsYXN0QWN0aXZlSW50ZXJwb2xhbnQ7CiAgfQogIGNsaXBBY3Rpb24oY2xpcCwgb3B0aW9uYWxSb290LCBibGVuZE1vZGUpIHsKICAgIGNvbnN0IHJvb3QgPSBvcHRpb25hbFJvb3QgfHwgdGhpcy5fcm9vdCwgcm9vdFV1aWQgPSByb290LnV1aWQ7CiAgICBsZXQgY2xpcE9iamVjdCA9IHR5cGVvZiBjbGlwID09PSAic3RyaW5nIiA/IEFuaW1hdGlvbkNsaXAuZmluZEJ5TmFtZShyb290LCBjbGlwKSA6IGNsaXA7CiAgICBjb25zdCBjbGlwVXVpZCA9IGNsaXBPYmplY3QgIT09IG51bGwgPyBjbGlwT2JqZWN0LnV1aWQgOiBjbGlwOwogICAgY29uc3QgYWN0aW9uc0ZvckNsaXAgPSB0aGlzLl9hY3Rpb25zQnlDbGlwW2NsaXBVdWlkXTsKICAgIGxldCBwcm90b3R5cGVBY3Rpb24gPSBudWxsOwogICAgaWYgKGJsZW5kTW9kZSA9PT0gdm9pZCAwKSB7CiAgICAgIGlmIChjbGlwT2JqZWN0ICE9PSBudWxsKSB7CiAgICAgICAgYmxlbmRNb2RlID0gY2xpcE9iamVjdC5ibGVuZE1vZGU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYmxlbmRNb2RlID0gTm9ybWFsQW5pbWF0aW9uQmxlbmRNb2RlOwogICAgICB9CiAgICB9CiAgICBpZiAoYWN0aW9uc0ZvckNsaXAgIT09IHZvaWQgMCkgewogICAgICBjb25zdCBleGlzdGluZ0FjdGlvbiA9IGFjdGlvbnNGb3JDbGlwLmFjdGlvbkJ5Um9vdFtyb290VXVpZF07CiAgICAgIGlmIChleGlzdGluZ0FjdGlvbiAhPT0gdm9pZCAwICYmIGV4aXN0aW5nQWN0aW9uLmJsZW5kTW9kZSA9PT0gYmxlbmRNb2RlKSB7CiAgICAgICAgcmV0dXJuIGV4aXN0aW5nQWN0aW9uOwogICAgICB9CiAgICAgIHByb3RvdHlwZUFjdGlvbiA9IGFjdGlvbnNGb3JDbGlwLmtub3duQWN0aW9uc1swXTsKICAgICAgaWYgKGNsaXBPYmplY3QgPT09IG51bGwpCiAgICAgICAgY2xpcE9iamVjdCA9IHByb3RvdHlwZUFjdGlvbi5fY2xpcDsKICAgIH0KICAgIGlmIChjbGlwT2JqZWN0ID09PSBudWxsKQogICAgICByZXR1cm4gbnVsbDsKICAgIGNvbnN0IG5ld0FjdGlvbiA9IG5ldyBBbmltYXRpb25BY3Rpb24odGhpcywgY2xpcE9iamVjdCwgb3B0aW9uYWxSb290LCBibGVuZE1vZGUpOwogICAgdGhpcy5fYmluZEFjdGlvbihuZXdBY3Rpb24sIHByb3RvdHlwZUFjdGlvbik7CiAgICB0aGlzLl9hZGRJbmFjdGl2ZUFjdGlvbihuZXdBY3Rpb24sIGNsaXBVdWlkLCByb290VXVpZCk7CiAgICByZXR1cm4gbmV3QWN0aW9uOwogIH0KICBleGlzdGluZ0FjdGlvbihjbGlwLCBvcHRpb25hbFJvb3QpIHsKICAgIGNvbnN0IHJvb3QgPSBvcHRpb25hbFJvb3QgfHwgdGhpcy5fcm9vdCwgcm9vdFV1aWQgPSByb290LnV1aWQsIGNsaXBPYmplY3QgPSB0eXBlb2YgY2xpcCA9PT0gInN0cmluZyIgPyBBbmltYXRpb25DbGlwLmZpbmRCeU5hbWUocm9vdCwgY2xpcCkgOiBjbGlwLCBjbGlwVXVpZCA9IGNsaXBPYmplY3QgPyBjbGlwT2JqZWN0LnV1aWQgOiBjbGlwLCBhY3Rpb25zRm9yQ2xpcCA9IHRoaXMuX2FjdGlvbnNCeUNsaXBbY2xpcFV1aWRdOwogICAgaWYgKGFjdGlvbnNGb3JDbGlwICE9PSB2b2lkIDApIHsKICAgICAgcmV0dXJuIGFjdGlvbnNGb3JDbGlwLmFjdGlvbkJ5Um9vdFtyb290VXVpZF0gfHwgbnVsbDsKICAgIH0KICAgIHJldHVybiBudWxsOwogIH0KICBzdG9wQWxsQWN0aW9uKCkgewogICAgY29uc3QgYWN0aW9ucyA9IHRoaXMuX2FjdGlvbnMsIG5BY3Rpb25zID0gdGhpcy5fbkFjdGl2ZUFjdGlvbnM7CiAgICBmb3IgKGxldCBpID0gbkFjdGlvbnMgLSAxOyBpID49IDA7IC0taSkgewogICAgICBhY3Rpb25zW2ldLnN0b3AoKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICB1cGRhdGUoZGVsdGFUaW1lKSB7CiAgICBkZWx0YVRpbWUgKj0gdGhpcy50aW1lU2NhbGU7CiAgICBjb25zdCBhY3Rpb25zID0gdGhpcy5fYWN0aW9ucywgbkFjdGlvbnMgPSB0aGlzLl9uQWN0aXZlQWN0aW9ucywgdGltZSA9IHRoaXMudGltZSArPSBkZWx0YVRpbWUsIHRpbWVEaXJlY3Rpb24gPSBNYXRoLnNpZ24oZGVsdGFUaW1lKSwgYWNjdUluZGV4ID0gdGhpcy5fYWNjdUluZGV4IF49IDE7CiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gbkFjdGlvbnM7ICsraSkgewogICAgICBjb25zdCBhY3Rpb24gPSBhY3Rpb25zW2ldOwogICAgICBhY3Rpb24uX3VwZGF0ZSh0aW1lLCBkZWx0YVRpbWUsIHRpbWVEaXJlY3Rpb24sIGFjY3VJbmRleCk7CiAgICB9CiAgICBjb25zdCBiaW5kaW5ncyA9IHRoaXMuX2JpbmRpbmdzLCBuQmluZGluZ3MgPSB0aGlzLl9uQWN0aXZlQmluZGluZ3M7CiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gbkJpbmRpbmdzOyArK2kpIHsKICAgICAgYmluZGluZ3NbaV0uYXBwbHkoYWNjdUluZGV4KTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRUaW1lKHRpbWVJblNlY29uZHMpIHsKICAgIHRoaXMudGltZSA9IDA7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX2FjdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgdGhpcy5fYWN0aW9uc1tpXS50aW1lID0gMDsKICAgIH0KICAgIHJldHVybiB0aGlzLnVwZGF0ZSh0aW1lSW5TZWNvbmRzKTsKICB9CiAgZ2V0Um9vdCgpIHsKICAgIHJldHVybiB0aGlzLl9yb290OwogIH0KICB1bmNhY2hlQ2xpcChjbGlwKSB7CiAgICBjb25zdCBhY3Rpb25zID0gdGhpcy5fYWN0aW9ucywgY2xpcFV1aWQgPSBjbGlwLnV1aWQsIGFjdGlvbnNCeUNsaXAgPSB0aGlzLl9hY3Rpb25zQnlDbGlwLCBhY3Rpb25zRm9yQ2xpcCA9IGFjdGlvbnNCeUNsaXBbY2xpcFV1aWRdOwogICAgaWYgKGFjdGlvbnNGb3JDbGlwICE9PSB2b2lkIDApIHsKICAgICAgY29uc3QgYWN0aW9uc1RvUmVtb3ZlID0gYWN0aW9uc0ZvckNsaXAua25vd25BY3Rpb25zOwogICAgICBmb3IgKGxldCBpID0gMCwgbiA9IGFjdGlvbnNUb1JlbW92ZS5sZW5ndGg7IGkgIT09IG47ICsraSkgewogICAgICAgIGNvbnN0IGFjdGlvbiA9IGFjdGlvbnNUb1JlbW92ZVtpXTsKICAgICAgICB0aGlzLl9kZWFjdGl2YXRlQWN0aW9uKGFjdGlvbik7CiAgICAgICAgY29uc3QgY2FjaGVJbmRleCA9IGFjdGlvbi5fY2FjaGVJbmRleCwgbGFzdEluYWN0aXZlQWN0aW9uID0gYWN0aW9uc1thY3Rpb25zLmxlbmd0aCAtIDFdOwogICAgICAgIGFjdGlvbi5fY2FjaGVJbmRleCA9IG51bGw7CiAgICAgICAgYWN0aW9uLl9ieUNsaXBDYWNoZUluZGV4ID0gbnVsbDsKICAgICAgICBsYXN0SW5hY3RpdmVBY3Rpb24uX2NhY2hlSW5kZXggPSBjYWNoZUluZGV4OwogICAgICAgIGFjdGlvbnNbY2FjaGVJbmRleF0gPSBsYXN0SW5hY3RpdmVBY3Rpb247CiAgICAgICAgYWN0aW9ucy5wb3AoKTsKICAgICAgICB0aGlzLl9yZW1vdmVJbmFjdGl2ZUJpbmRpbmdzRm9yQWN0aW9uKGFjdGlvbik7CiAgICAgIH0KICAgICAgZGVsZXRlIGFjdGlvbnNCeUNsaXBbY2xpcFV1aWRdOwogICAgfQogIH0KICB1bmNhY2hlUm9vdChyb290KSB7CiAgICBjb25zdCByb290VXVpZCA9IHJvb3QudXVpZCwgYWN0aW9uc0J5Q2xpcCA9IHRoaXMuX2FjdGlvbnNCeUNsaXA7CiAgICBmb3IgKGNvbnN0IGNsaXBVdWlkIGluIGFjdGlvbnNCeUNsaXApIHsKICAgICAgY29uc3QgYWN0aW9uQnlSb290ID0gYWN0aW9uc0J5Q2xpcFtjbGlwVXVpZF0uYWN0aW9uQnlSb290LCBhY3Rpb24gPSBhY3Rpb25CeVJvb3Rbcm9vdFV1aWRdOwogICAgICBpZiAoYWN0aW9uICE9PSB2b2lkIDApIHsKICAgICAgICB0aGlzLl9kZWFjdGl2YXRlQWN0aW9uKGFjdGlvbik7CiAgICAgICAgdGhpcy5fcmVtb3ZlSW5hY3RpdmVBY3Rpb24oYWN0aW9uKTsKICAgICAgfQogICAgfQogICAgY29uc3QgYmluZGluZ3NCeVJvb3QgPSB0aGlzLl9iaW5kaW5nc0J5Um9vdEFuZE5hbWUsIGJpbmRpbmdCeU5hbWUgPSBiaW5kaW5nc0J5Um9vdFtyb290VXVpZF07CiAgICBpZiAoYmluZGluZ0J5TmFtZSAhPT0gdm9pZCAwKSB7CiAgICAgIGZvciAoY29uc3QgdHJhY2tOYW1lIGluIGJpbmRpbmdCeU5hbWUpIHsKICAgICAgICBjb25zdCBiaW5kaW5nID0gYmluZGluZ0J5TmFtZVt0cmFja05hbWVdOwogICAgICAgIGJpbmRpbmcucmVzdG9yZU9yaWdpbmFsU3RhdGUoKTsKICAgICAgICB0aGlzLl9yZW1vdmVJbmFjdGl2ZUJpbmRpbmcoYmluZGluZyk7CiAgICAgIH0KICAgIH0KICB9CiAgdW5jYWNoZUFjdGlvbihjbGlwLCBvcHRpb25hbFJvb3QpIHsKICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMuZXhpc3RpbmdBY3Rpb24oY2xpcCwgb3B0aW9uYWxSb290KTsKICAgIGlmIChhY3Rpb24gIT09IG51bGwpIHsKICAgICAgdGhpcy5fZGVhY3RpdmF0ZUFjdGlvbihhY3Rpb24pOwogICAgICB0aGlzLl9yZW1vdmVJbmFjdGl2ZUFjdGlvbihhY3Rpb24pOwogICAgfQogIH0KfQpBbmltYXRpb25NaXhlci5wcm90b3R5cGUuX2NvbnRyb2xJbnRlcnBvbGFudHNSZXN1bHRCdWZmZXIgPSBuZXcgRmxvYXQzMkFycmF5KDEpOwpjbGFzcyBVbmlmb3JtIHsKICBjb25zdHJ1Y3Rvcih2YWx1ZSkgewogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5Vbmlmb3JtOiBUeXBlIHBhcmFtZXRlciBpcyBubyBsb25nZXIgbmVlZGVkLiIpOwogICAgICB2YWx1ZSA9IGFyZ3VtZW50c1sxXTsKICAgIH0KICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKICB9CiAgY2xvbmUoKSB7CiAgICByZXR1cm4gbmV3IFVuaWZvcm0odGhpcy52YWx1ZS5jbG9uZSA9PT0gdm9pZCAwID8gdGhpcy52YWx1ZSA6IHRoaXMudmFsdWUuY2xvbmUoKSk7CiAgfQp9CmNsYXNzIEluc3RhbmNlZEludGVybGVhdmVkQnVmZmVyIGV4dGVuZHMgSW50ZXJsZWF2ZWRCdWZmZXIgewogIGNvbnN0cnVjdG9yKGFycmF5LCBzdHJpZGUsIG1lc2hQZXJBdHRyaWJ1dGUgPSAxKSB7CiAgICBzdXBlcihhcnJheSwgc3RyaWRlKTsKICAgIHRoaXMubWVzaFBlckF0dHJpYnV0ZSA9IG1lc2hQZXJBdHRyaWJ1dGU7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSk7CiAgICB0aGlzLm1lc2hQZXJBdHRyaWJ1dGUgPSBzb3VyY2UubWVzaFBlckF0dHJpYnV0ZTsKICAgIHJldHVybiB0aGlzOwogIH0KICBjbG9uZShkYXRhKSB7CiAgICBjb25zdCBpYiA9IHN1cGVyLmNsb25lKGRhdGEpOwogICAgaWIubWVzaFBlckF0dHJpYnV0ZSA9IHRoaXMubWVzaFBlckF0dHJpYnV0ZTsKICAgIHJldHVybiBpYjsKICB9CiAgdG9KU09OKGRhdGEpIHsKICAgIGNvbnN0IGpzb24gPSBzdXBlci50b0pTT04oZGF0YSk7CiAgICBqc29uLmlzSW5zdGFuY2VkSW50ZXJsZWF2ZWRCdWZmZXIgPSB0cnVlOwogICAganNvbi5tZXNoUGVyQXR0cmlidXRlID0gdGhpcy5tZXNoUGVyQXR0cmlidXRlOwogICAgcmV0dXJuIGpzb247CiAgfQp9Ckluc3RhbmNlZEludGVybGVhdmVkQnVmZmVyLnByb3RvdHlwZS5pc0luc3RhbmNlZEludGVybGVhdmVkQnVmZmVyID0gdHJ1ZTsKY2xhc3MgR0xCdWZmZXJBdHRyaWJ1dGUgewogIGNvbnN0cnVjdG9yKGJ1ZmZlciwgdHlwZSwgaXRlbVNpemUsIGVsZW1lbnRTaXplLCBjb3VudCkgewogICAgdGhpcy5idWZmZXIgPSBidWZmZXI7CiAgICB0aGlzLnR5cGUgPSB0eXBlOwogICAgdGhpcy5pdGVtU2l6ZSA9IGl0ZW1TaXplOwogICAgdGhpcy5lbGVtZW50U2l6ZSA9IGVsZW1lbnRTaXplOwogICAgdGhpcy5jb3VudCA9IGNvdW50OwogICAgdGhpcy52ZXJzaW9uID0gMDsKICB9CiAgc2V0IG5lZWRzVXBkYXRlKHZhbHVlKSB7CiAgICBpZiAodmFsdWUgPT09IHRydWUpCiAgICAgIHRoaXMudmVyc2lvbisrOwogIH0KICBzZXRCdWZmZXIoYnVmZmVyKSB7CiAgICB0aGlzLmJ1ZmZlciA9IGJ1ZmZlcjsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRUeXBlKHR5cGUsIGVsZW1lbnRTaXplKSB7CiAgICB0aGlzLnR5cGUgPSB0eXBlOwogICAgdGhpcy5lbGVtZW50U2l6ZSA9IGVsZW1lbnRTaXplOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNldEl0ZW1TaXplKGl0ZW1TaXplKSB7CiAgICB0aGlzLml0ZW1TaXplID0gaXRlbVNpemU7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0Q291bnQoY291bnQpIHsKICAgIHRoaXMuY291bnQgPSBjb3VudDsKICAgIHJldHVybiB0aGlzOwogIH0KfQpHTEJ1ZmZlckF0dHJpYnV0ZS5wcm90b3R5cGUuaXNHTEJ1ZmZlckF0dHJpYnV0ZSA9IHRydWU7CmNsYXNzIFJheWNhc3RlciB7CiAgY29uc3RydWN0b3Iob3JpZ2luLCBkaXJlY3Rpb24sIG5lYXIgPSAwLCBmYXIgPSBJbmZpbml0eSkgewogICAgdGhpcy5yYXkgPSBuZXcgUmF5KG9yaWdpbiwgZGlyZWN0aW9uKTsKICAgIHRoaXMubmVhciA9IG5lYXI7CiAgICB0aGlzLmZhciA9IGZhcjsKICAgIHRoaXMuY2FtZXJhID0gbnVsbDsKICAgIHRoaXMubGF5ZXJzID0gbmV3IExheWVycygpOwogICAgdGhpcy5wYXJhbXMgPSB7CiAgICAgIE1lc2g6IHt9LAogICAgICBMaW5lOiB7IHRocmVzaG9sZDogMSB9LAogICAgICBMT0Q6IHt9LAogICAgICBQb2ludHM6IHsgdGhyZXNob2xkOiAxIH0sCiAgICAgIFNwcml0ZToge30KICAgIH07CiAgfQogIHNldChvcmlnaW4sIGRpcmVjdGlvbikgewogICAgdGhpcy5yYXkuc2V0KG9yaWdpbiwgZGlyZWN0aW9uKTsKICB9CiAgc2V0RnJvbUNhbWVyYShjb29yZHMsIGNhbWVyYSkgewogICAgaWYgKGNhbWVyYSAmJiBjYW1lcmEuaXNQZXJzcGVjdGl2ZUNhbWVyYSkgewogICAgICB0aGlzLnJheS5vcmlnaW4uc2V0RnJvbU1hdHJpeFBvc2l0aW9uKGNhbWVyYS5tYXRyaXhXb3JsZCk7CiAgICAgIHRoaXMucmF5LmRpcmVjdGlvbi5zZXQoY29vcmRzLngsIGNvb3Jkcy55LCAwLjUpLnVucHJvamVjdChjYW1lcmEpLnN1Yih0aGlzLnJheS5vcmlnaW4pLm5vcm1hbGl6ZSgpOwogICAgICB0aGlzLmNhbWVyYSA9IGNhbWVyYTsKICAgIH0gZWxzZSBpZiAoY2FtZXJhICYmIGNhbWVyYS5pc09ydGhvZ3JhcGhpY0NhbWVyYSkgewogICAgICB0aGlzLnJheS5vcmlnaW4uc2V0KGNvb3Jkcy54LCBjb29yZHMueSwgKGNhbWVyYS5uZWFyICsgY2FtZXJhLmZhcikgLyAoY2FtZXJhLm5lYXIgLSBjYW1lcmEuZmFyKSkudW5wcm9qZWN0KGNhbWVyYSk7CiAgICAgIHRoaXMucmF5LmRpcmVjdGlvbi5zZXQoMCwgMCwgLTEpLnRyYW5zZm9ybURpcmVjdGlvbihjYW1lcmEubWF0cml4V29ybGQpOwogICAgICB0aGlzLmNhbWVyYSA9IGNhbWVyYTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLlJheWNhc3RlcjogVW5zdXBwb3J0ZWQgY2FtZXJhIHR5cGU6ICIgKyBjYW1lcmEudHlwZSk7CiAgICB9CiAgfQogIGludGVyc2VjdE9iamVjdChvYmplY3QsIHJlY3Vyc2l2ZSA9IHRydWUsIGludGVyc2VjdHMyID0gW10pIHsKICAgIGludGVyc2VjdE9iamVjdChvYmplY3QsIHRoaXMsIGludGVyc2VjdHMyLCByZWN1cnNpdmUpOwogICAgaW50ZXJzZWN0czIuc29ydChhc2NTb3J0KTsKICAgIHJldHVybiBpbnRlcnNlY3RzMjsKICB9CiAgaW50ZXJzZWN0T2JqZWN0cyhvYmplY3RzLCByZWN1cnNpdmUgPSB0cnVlLCBpbnRlcnNlY3RzMiA9IFtdKSB7CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IG9iamVjdHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIGludGVyc2VjdE9iamVjdChvYmplY3RzW2ldLCB0aGlzLCBpbnRlcnNlY3RzMiwgcmVjdXJzaXZlKTsKICAgIH0KICAgIGludGVyc2VjdHMyLnNvcnQoYXNjU29ydCk7CiAgICByZXR1cm4gaW50ZXJzZWN0czI7CiAgfQp9CmZ1bmN0aW9uIGFzY1NvcnQoYSwgYikgewogIHJldHVybiBhLmRpc3RhbmNlIC0gYi5kaXN0YW5jZTsKfQpmdW5jdGlvbiBpbnRlcnNlY3RPYmplY3Qob2JqZWN0LCByYXljYXN0ZXIsIGludGVyc2VjdHMyLCByZWN1cnNpdmUpIHsKICBpZiAob2JqZWN0LmxheWVycy50ZXN0KHJheWNhc3Rlci5sYXllcnMpKSB7CiAgICBvYmplY3QucmF5Y2FzdChyYXljYXN0ZXIsIGludGVyc2VjdHMyKTsKICB9CiAgaWYgKHJlY3Vyc2l2ZSA9PT0gdHJ1ZSkgewogICAgY29uc3QgY2hpbGRyZW4gPSBvYmplY3QuY2hpbGRyZW47CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBpbnRlcnNlY3RPYmplY3QoY2hpbGRyZW5baV0sIHJheWNhc3RlciwgaW50ZXJzZWN0czIsIHRydWUpOwogICAgfQogIH0KfQpjbGFzcyBTcGhlcmljYWwgewogIGNvbnN0cnVjdG9yKHJhZGl1cyA9IDEsIHBoaSA9IDAsIHRoZXRhID0gMCkgewogICAgdGhpcy5yYWRpdXMgPSByYWRpdXM7CiAgICB0aGlzLnBoaSA9IHBoaTsKICAgIHRoaXMudGhldGEgPSB0aGV0YTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXQocmFkaXVzLCBwaGksIHRoZXRhKSB7CiAgICB0aGlzLnJhZGl1cyA9IHJhZGl1czsKICAgIHRoaXMucGhpID0gcGhpOwogICAgdGhpcy50aGV0YSA9IHRoZXRhOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNvcHkob3RoZXIpIHsKICAgIHRoaXMucmFkaXVzID0gb3RoZXIucmFkaXVzOwogICAgdGhpcy5waGkgPSBvdGhlci5waGk7CiAgICB0aGlzLnRoZXRhID0gb3RoZXIudGhldGE7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbWFrZVNhZmUoKSB7CiAgICBjb25zdCBFUFMgPSAxZS02OwogICAgdGhpcy5waGkgPSBNYXRoLm1heChFUFMsIE1hdGgubWluKE1hdGguUEkgLSBFUFMsIHRoaXMucGhpKSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0RnJvbVZlY3RvcjModikgewogICAgcmV0dXJuIHRoaXMuc2V0RnJvbUNhcnRlc2lhbkNvb3Jkcyh2LngsIHYueSwgdi56KTsKICB9CiAgc2V0RnJvbUNhcnRlc2lhbkNvb3Jkcyh4LCB5LCB6KSB7CiAgICB0aGlzLnJhZGl1cyA9IE1hdGguc3FydCh4ICogeCArIHkgKiB5ICsgeiAqIHopOwogICAgaWYgKHRoaXMucmFkaXVzID09PSAwKSB7CiAgICAgIHRoaXMudGhldGEgPSAwOwogICAgICB0aGlzLnBoaSA9IDA7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnRoZXRhID0gTWF0aC5hdGFuMih4LCB6KTsKICAgICAgdGhpcy5waGkgPSBNYXRoLmFjb3MoY2xhbXAoeSAvIHRoaXMucmFkaXVzLCAtMSwgMSkpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKCkuY29weSh0aGlzKTsKICB9Cn0KY2xhc3MgQ3lsaW5kcmljYWwgewogIGNvbnN0cnVjdG9yKHJhZGl1cyA9IDEsIHRoZXRhID0gMCwgeSA9IDApIHsKICAgIHRoaXMucmFkaXVzID0gcmFkaXVzOwogICAgdGhpcy50aGV0YSA9IHRoZXRhOwogICAgdGhpcy55ID0geTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXQocmFkaXVzLCB0aGV0YSwgeSkgewogICAgdGhpcy5yYWRpdXMgPSByYWRpdXM7CiAgICB0aGlzLnRoZXRhID0gdGhldGE7CiAgICB0aGlzLnkgPSB5OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNvcHkob3RoZXIpIHsKICAgIHRoaXMucmFkaXVzID0gb3RoZXIucmFkaXVzOwogICAgdGhpcy50aGV0YSA9IG90aGVyLnRoZXRhOwogICAgdGhpcy55ID0gb3RoZXIueTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRGcm9tVmVjdG9yMyh2KSB7CiAgICByZXR1cm4gdGhpcy5zZXRGcm9tQ2FydGVzaWFuQ29vcmRzKHYueCwgdi55LCB2LnopOwogIH0KICBzZXRGcm9tQ2FydGVzaWFuQ29vcmRzKHgsIHksIHopIHsKICAgIHRoaXMucmFkaXVzID0gTWF0aC5zcXJ0KHggKiB4ICsgeiAqIHopOwogICAgdGhpcy50aGV0YSA9IE1hdGguYXRhbjIoeCwgeik7CiAgICB0aGlzLnkgPSB5OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKCkuY29weSh0aGlzKTsKICB9Cn0KY29uc3QgX3ZlY3RvciQ0ID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IyKCk7CmNsYXNzIEJveDIgewogIGNvbnN0cnVjdG9yKG1pbiA9IG5ldyBWZWN0b3IyKEluZmluaXR5LCBJbmZpbml0eSksIG1heCA9IG5ldyBWZWN0b3IyKC1JbmZpbml0eSwgLUluZmluaXR5KSkgewogICAgdGhpcy5taW4gPSBtaW47CiAgICB0aGlzLm1heCA9IG1heDsKICB9CiAgc2V0KG1pbiwgbWF4KSB7CiAgICB0aGlzLm1pbi5jb3B5KG1pbik7CiAgICB0aGlzLm1heC5jb3B5KG1heCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgc2V0RnJvbVBvaW50cyhwb2ludHMpIHsKICAgIHRoaXMubWFrZUVtcHR5KCk7CiAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBwb2ludHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICB0aGlzLmV4cGFuZEJ5UG9pbnQocG9pbnRzW2ldKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0KICBzZXRGcm9tQ2VudGVyQW5kU2l6ZShjZW50ZXIsIHNpemUpIHsKICAgIGNvbnN0IGhhbGZTaXplID0gX3ZlY3RvciQ0LmNvcHkoc2l6ZSkubXVsdGlwbHlTY2FsYXIoMC41KTsKICAgIHRoaXMubWluLmNvcHkoY2VudGVyKS5zdWIoaGFsZlNpemUpOwogICAgdGhpcy5tYXguY29weShjZW50ZXIpLmFkZChoYWxmU2l6ZSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY2xvbmUoKSB7CiAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoKS5jb3B5KHRoaXMpOwogIH0KICBjb3B5KGJveCkgewogICAgdGhpcy5taW4uY29weShib3gubWluKTsKICAgIHRoaXMubWF4LmNvcHkoYm94Lm1heCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgbWFrZUVtcHR5KCkgewogICAgdGhpcy5taW4ueCA9IHRoaXMubWluLnkgPSBJbmZpbml0eTsKICAgIHRoaXMubWF4LnggPSB0aGlzLm1heC55ID0gLUluZmluaXR5OwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGlzRW1wdHkoKSB7CiAgICByZXR1cm4gdGhpcy5tYXgueCA8IHRoaXMubWluLnggfHwgdGhpcy5tYXgueSA8IHRoaXMubWluLnk7CiAgfQogIGdldENlbnRlcih0YXJnZXQpIHsKICAgIHJldHVybiB0aGlzLmlzRW1wdHkoKSA/IHRhcmdldC5zZXQoMCwgMCkgOiB0YXJnZXQuYWRkVmVjdG9ycyh0aGlzLm1pbiwgdGhpcy5tYXgpLm11bHRpcGx5U2NhbGFyKDAuNSk7CiAgfQogIGdldFNpemUodGFyZ2V0KSB7CiAgICByZXR1cm4gdGhpcy5pc0VtcHR5KCkgPyB0YXJnZXQuc2V0KDAsIDApIDogdGFyZ2V0LnN1YlZlY3RvcnModGhpcy5tYXgsIHRoaXMubWluKTsKICB9CiAgZXhwYW5kQnlQb2ludChwb2ludCkgewogICAgdGhpcy5taW4ubWluKHBvaW50KTsKICAgIHRoaXMubWF4Lm1heChwb2ludCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZXhwYW5kQnlWZWN0b3IodmVjdG9yKSB7CiAgICB0aGlzLm1pbi5zdWIodmVjdG9yKTsKICAgIHRoaXMubWF4LmFkZCh2ZWN0b3IpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGV4cGFuZEJ5U2NhbGFyKHNjYWxhcikgewogICAgdGhpcy5taW4uYWRkU2NhbGFyKC1zY2FsYXIpOwogICAgdGhpcy5tYXguYWRkU2NhbGFyKHNjYWxhcik7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY29udGFpbnNQb2ludChwb2ludCkgewogICAgcmV0dXJuIHBvaW50LnggPCB0aGlzLm1pbi54IHx8IHBvaW50LnggPiB0aGlzLm1heC54IHx8IHBvaW50LnkgPCB0aGlzLm1pbi55IHx8IHBvaW50LnkgPiB0aGlzLm1heC55ID8gZmFsc2UgOiB0cnVlOwogIH0KICBjb250YWluc0JveChib3gpIHsKICAgIHJldHVybiB0aGlzLm1pbi54IDw9IGJveC5taW4ueCAmJiBib3gubWF4LnggPD0gdGhpcy5tYXgueCAmJiB0aGlzLm1pbi55IDw9IGJveC5taW4ueSAmJiBib3gubWF4LnkgPD0gdGhpcy5tYXgueTsKICB9CiAgZ2V0UGFyYW1ldGVyKHBvaW50LCB0YXJnZXQpIHsKICAgIHJldHVybiB0YXJnZXQuc2V0KChwb2ludC54IC0gdGhpcy5taW4ueCkgLyAodGhpcy5tYXgueCAtIHRoaXMubWluLngpLCAocG9pbnQueSAtIHRoaXMubWluLnkpIC8gKHRoaXMubWF4LnkgLSB0aGlzLm1pbi55KSk7CiAgfQogIGludGVyc2VjdHNCb3goYm94KSB7CiAgICByZXR1cm4gYm94Lm1heC54IDwgdGhpcy5taW4ueCB8fCBib3gubWluLnggPiB0aGlzLm1heC54IHx8IGJveC5tYXgueSA8IHRoaXMubWluLnkgfHwgYm94Lm1pbi55ID4gdGhpcy5tYXgueSA/IGZhbHNlIDogdHJ1ZTsKICB9CiAgY2xhbXBQb2ludChwb2ludCwgdGFyZ2V0KSB7CiAgICByZXR1cm4gdGFyZ2V0LmNvcHkocG9pbnQpLmNsYW1wKHRoaXMubWluLCB0aGlzLm1heCk7CiAgfQogIGRpc3RhbmNlVG9Qb2ludChwb2ludCkgewogICAgY29uc3QgY2xhbXBlZFBvaW50ID0gX3ZlY3RvciQ0LmNvcHkocG9pbnQpLmNsYW1wKHRoaXMubWluLCB0aGlzLm1heCk7CiAgICByZXR1cm4gY2xhbXBlZFBvaW50LnN1Yihwb2ludCkubGVuZ3RoKCk7CiAgfQogIGludGVyc2VjdChib3gpIHsKICAgIHRoaXMubWluLm1heChib3gubWluKTsKICAgIHRoaXMubWF4Lm1pbihib3gubWF4KTsKICAgIHJldHVybiB0aGlzOwogIH0KICB1bmlvbihib3gpIHsKICAgIHRoaXMubWluLm1pbihib3gubWluKTsKICAgIHRoaXMubWF4Lm1heChib3gubWF4KTsKICAgIHJldHVybiB0aGlzOwogIH0KICB0cmFuc2xhdGUob2Zmc2V0KSB7CiAgICB0aGlzLm1pbi5hZGQob2Zmc2V0KTsKICAgIHRoaXMubWF4LmFkZChvZmZzZXQpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGVxdWFscyhib3gpIHsKICAgIHJldHVybiBib3gubWluLmVxdWFscyh0aGlzLm1pbikgJiYgYm94Lm1heC5lcXVhbHModGhpcy5tYXgpOwogIH0KfQpCb3gyLnByb3RvdHlwZS5pc0JveDIgPSB0cnVlOwpjb25zdCBfc3RhcnRQID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF9zdGFydEVuZCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjbGFzcyBMaW5lMyB7CiAgY29uc3RydWN0b3Ioc3RhcnQgPSBuZXcgVmVjdG9yMygpLCBlbmQgPSBuZXcgVmVjdG9yMygpKSB7CiAgICB0aGlzLnN0YXJ0ID0gc3RhcnQ7CiAgICB0aGlzLmVuZCA9IGVuZDsKICB9CiAgc2V0KHN0YXJ0LCBlbmQpIHsKICAgIHRoaXMuc3RhcnQuY29weShzdGFydCk7CiAgICB0aGlzLmVuZC5jb3B5KGVuZCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgY29weShsaW5lKSB7CiAgICB0aGlzLnN0YXJ0LmNvcHkobGluZS5zdGFydCk7CiAgICB0aGlzLmVuZC5jb3B5KGxpbmUuZW5kKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBnZXRDZW50ZXIodGFyZ2V0KSB7CiAgICByZXR1cm4gdGFyZ2V0LmFkZFZlY3RvcnModGhpcy5zdGFydCwgdGhpcy5lbmQpLm11bHRpcGx5U2NhbGFyKDAuNSk7CiAgfQogIGRlbHRhKHRhcmdldCkgewogICAgcmV0dXJuIHRhcmdldC5zdWJWZWN0b3JzKHRoaXMuZW5kLCB0aGlzLnN0YXJ0KTsKICB9CiAgZGlzdGFuY2VTcSgpIHsKICAgIHJldHVybiB0aGlzLnN0YXJ0LmRpc3RhbmNlVG9TcXVhcmVkKHRoaXMuZW5kKTsKICB9CiAgZGlzdGFuY2UoKSB7CiAgICByZXR1cm4gdGhpcy5zdGFydC5kaXN0YW5jZVRvKHRoaXMuZW5kKTsKICB9CiAgYXQodCwgdGFyZ2V0KSB7CiAgICByZXR1cm4gdGhpcy5kZWx0YSh0YXJnZXQpLm11bHRpcGx5U2NhbGFyKHQpLmFkZCh0aGlzLnN0YXJ0KTsKICB9CiAgY2xvc2VzdFBvaW50VG9Qb2ludFBhcmFtZXRlcihwb2ludCwgY2xhbXBUb0xpbmUpIHsKICAgIF9zdGFydFAuc3ViVmVjdG9ycyhwb2ludCwgdGhpcy5zdGFydCk7CiAgICBfc3RhcnRFbmQuc3ViVmVjdG9ycyh0aGlzLmVuZCwgdGhpcy5zdGFydCk7CiAgICBjb25zdCBzdGFydEVuZDIgPSBfc3RhcnRFbmQuZG90KF9zdGFydEVuZCk7CiAgICBjb25zdCBzdGFydEVuZF9zdGFydFAgPSBfc3RhcnRFbmQuZG90KF9zdGFydFApOwogICAgbGV0IHQgPSBzdGFydEVuZF9zdGFydFAgLyBzdGFydEVuZDI7CiAgICBpZiAoY2xhbXBUb0xpbmUpIHsKICAgICAgdCA9IGNsYW1wKHQsIDAsIDEpOwogICAgfQogICAgcmV0dXJuIHQ7CiAgfQogIGNsb3Nlc3RQb2ludFRvUG9pbnQocG9pbnQsIGNsYW1wVG9MaW5lLCB0YXJnZXQpIHsKICAgIGNvbnN0IHQgPSB0aGlzLmNsb3Nlc3RQb2ludFRvUG9pbnRQYXJhbWV0ZXIocG9pbnQsIGNsYW1wVG9MaW5lKTsKICAgIHJldHVybiB0aGlzLmRlbHRhKHRhcmdldCkubXVsdGlwbHlTY2FsYXIodCkuYWRkKHRoaXMuc3RhcnQpOwogIH0KICBhcHBseU1hdHJpeDQobWF0cml4KSB7CiAgICB0aGlzLnN0YXJ0LmFwcGx5TWF0cml4NChtYXRyaXgpOwogICAgdGhpcy5lbmQuYXBwbHlNYXRyaXg0KG1hdHJpeCk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZXF1YWxzKGxpbmUpIHsKICAgIHJldHVybiBsaW5lLnN0YXJ0LmVxdWFscyh0aGlzLnN0YXJ0KSAmJiBsaW5lLmVuZC5lcXVhbHModGhpcy5lbmQpOwogIH0KICBjbG9uZSgpIHsKICAgIHJldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3RvcigpLmNvcHkodGhpcyk7CiAgfQp9CmNvbnN0IF92ZWN0b3IkMyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjbGFzcyBTcG90TGlnaHRIZWxwZXIgZXh0ZW5kcyBPYmplY3QzRCB7CiAgY29uc3RydWN0b3IobGlnaHQsIGNvbG9yKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5saWdodCA9IGxpZ2h0OwogICAgdGhpcy5saWdodC51cGRhdGVNYXRyaXhXb3JsZCgpOwogICAgdGhpcy5tYXRyaXggPSBsaWdodC5tYXRyaXhXb3JsZDsKICAgIHRoaXMubWF0cml4QXV0b1VwZGF0ZSA9IGZhbHNlOwogICAgdGhpcy5jb2xvciA9IGNvbG9yOwogICAgY29uc3QgZ2VvbWV0cnkgPSBuZXcgQnVmZmVyR2VvbWV0cnkoKTsKICAgIGNvbnN0IHBvc2l0aW9ucyA9IFsKICAgICAgMCwKICAgICAgMCwKICAgICAgMCwKICAgICAgMCwKICAgICAgMCwKICAgICAgMSwKICAgICAgMCwKICAgICAgMCwKICAgICAgMCwKICAgICAgMSwKICAgICAgMCwKICAgICAgMSwKICAgICAgMCwKICAgICAgMCwKICAgICAgMCwKICAgICAgLTEsCiAgICAgIDAsCiAgICAgIDEsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIDEsCiAgICAgIDEsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIC0xLAogICAgICAxCiAgICBdOwogICAgZm9yIChsZXQgaSA9IDAsIGogPSAxLCBsID0gMzI7IGkgPCBsOyBpKyssIGorKykgewogICAgICBjb25zdCBwMSA9IGkgLyBsICogTWF0aC5QSSAqIDI7CiAgICAgIGNvbnN0IHAyID0gaiAvIGwgKiBNYXRoLlBJICogMjsKICAgICAgcG9zaXRpb25zLnB1c2goTWF0aC5jb3MocDEpLCBNYXRoLnNpbihwMSksIDEsIE1hdGguY29zKHAyKSwgTWF0aC5zaW4ocDIpLCAxKTsKICAgIH0KICAgIGdlb21ldHJ5LnNldEF0dHJpYnV0ZSgicG9zaXRpb24iLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShwb3NpdGlvbnMsIDMpKTsKICAgIGNvbnN0IG1hdGVyaWFsID0gbmV3IExpbmVCYXNpY01hdGVyaWFsKHsgZm9nOiBmYWxzZSwgdG9uZU1hcHBlZDogZmFsc2UgfSk7CiAgICB0aGlzLmNvbmUgPSBuZXcgTGluZVNlZ21lbnRzKGdlb21ldHJ5LCBtYXRlcmlhbCk7CiAgICB0aGlzLmFkZCh0aGlzLmNvbmUpOwogICAgdGhpcy51cGRhdGUoKTsKICB9CiAgZGlzcG9zZSgpIHsKICAgIHRoaXMuY29uZS5nZW9tZXRyeS5kaXNwb3NlKCk7CiAgICB0aGlzLmNvbmUubWF0ZXJpYWwuZGlzcG9zZSgpOwogIH0KICB1cGRhdGUoKSB7CiAgICB0aGlzLmxpZ2h0LnVwZGF0ZU1hdHJpeFdvcmxkKCk7CiAgICBjb25zdCBjb25lTGVuZ3RoID0gdGhpcy5saWdodC5kaXN0YW5jZSA/IHRoaXMubGlnaHQuZGlzdGFuY2UgOiAxZTM7CiAgICBjb25zdCBjb25lV2lkdGggPSBjb25lTGVuZ3RoICogTWF0aC50YW4odGhpcy5saWdodC5hbmdsZSk7CiAgICB0aGlzLmNvbmUuc2NhbGUuc2V0KGNvbmVXaWR0aCwgY29uZVdpZHRoLCBjb25lTGVuZ3RoKTsKICAgIF92ZWN0b3IkMy5zZXRGcm9tTWF0cml4UG9zaXRpb24odGhpcy5saWdodC50YXJnZXQubWF0cml4V29ybGQpOwogICAgdGhpcy5jb25lLmxvb2tBdChfdmVjdG9yJDMpOwogICAgaWYgKHRoaXMuY29sb3IgIT09IHZvaWQgMCkgewogICAgICB0aGlzLmNvbmUubWF0ZXJpYWwuY29sb3Iuc2V0KHRoaXMuY29sb3IpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5jb25lLm1hdGVyaWFsLmNvbG9yLmNvcHkodGhpcy5saWdodC5jb2xvcik7CiAgICB9CiAgfQp9CmNvbnN0IF92ZWN0b3IkMiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfYm9uZU1hdHJpeCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWF0cml4NCgpOwpjb25zdCBfbWF0cml4V29ybGRJbnYgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hdHJpeDQoKTsKY2xhc3MgU2tlbGV0b25IZWxwZXIgZXh0ZW5kcyBMaW5lU2VnbWVudHMgewogIGNvbnN0cnVjdG9yKG9iamVjdCkgewogICAgY29uc3QgYm9uZXMgPSBnZXRCb25lTGlzdChvYmplY3QpOwogICAgY29uc3QgZ2VvbWV0cnkgPSBuZXcgQnVmZmVyR2VvbWV0cnkoKTsKICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICBjb25zdCBjb2xvcnMgPSBbXTsKICAgIGNvbnN0IGNvbG9yMSA9IG5ldyBDb2xvcigwLCAwLCAxKTsKICAgIGNvbnN0IGNvbG9yMiA9IG5ldyBDb2xvcigwLCAxLCAwKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9uZXMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYm9uZSA9IGJvbmVzW2ldOwogICAgICBpZiAoYm9uZS5wYXJlbnQgJiYgYm9uZS5wYXJlbnQuaXNCb25lKSB7CiAgICAgICAgdmVydGljZXMucHVzaCgwLCAwLCAwKTsKICAgICAgICB2ZXJ0aWNlcy5wdXNoKDAsIDAsIDApOwogICAgICAgIGNvbG9ycy5wdXNoKGNvbG9yMS5yLCBjb2xvcjEuZywgY29sb3IxLmIpOwogICAgICAgIGNvbG9ycy5wdXNoKGNvbG9yMi5yLCBjb2xvcjIuZywgY29sb3IyLmIpOwogICAgICB9CiAgICB9CiAgICBnZW9tZXRyeS5zZXRBdHRyaWJ1dGUoInBvc2l0aW9uIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUodmVydGljZXMsIDMpKTsKICAgIGdlb21ldHJ5LnNldEF0dHJpYnV0ZSgiY29sb3IiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShjb2xvcnMsIDMpKTsKICAgIGNvbnN0IG1hdGVyaWFsID0gbmV3IExpbmVCYXNpY01hdGVyaWFsKHsgdmVydGV4Q29sb3JzOiB0cnVlLCBkZXB0aFRlc3Q6IGZhbHNlLCBkZXB0aFdyaXRlOiBmYWxzZSwgdG9uZU1hcHBlZDogZmFsc2UsIHRyYW5zcGFyZW50OiB0cnVlIH0pOwogICAgc3VwZXIoZ2VvbWV0cnksIG1hdGVyaWFsKTsKICAgIHRoaXMudHlwZSA9ICJTa2VsZXRvbkhlbHBlciI7CiAgICB0aGlzLmlzU2tlbGV0b25IZWxwZXIgPSB0cnVlOwogICAgdGhpcy5yb290ID0gb2JqZWN0OwogICAgdGhpcy5ib25lcyA9IGJvbmVzOwogICAgdGhpcy5tYXRyaXggPSBvYmplY3QubWF0cml4V29ybGQ7CiAgICB0aGlzLm1hdHJpeEF1dG9VcGRhdGUgPSBmYWxzZTsKICB9CiAgdXBkYXRlTWF0cml4V29ybGQoZm9yY2UpIHsKICAgIGNvbnN0IGJvbmVzID0gdGhpcy5ib25lczsKICAgIGNvbnN0IGdlb21ldHJ5ID0gdGhpcy5nZW9tZXRyeTsKICAgIGNvbnN0IHBvc2l0aW9uID0gZ2VvbWV0cnkuZ2V0QXR0cmlidXRlKCJwb3NpdGlvbiIpOwogICAgX21hdHJpeFdvcmxkSW52LmNvcHkodGhpcy5yb290Lm1hdHJpeFdvcmxkKS5pbnZlcnQoKTsKICAgIGZvciAobGV0IGkgPSAwLCBqID0gMDsgaSA8IGJvbmVzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGJvbmUgPSBib25lc1tpXTsKICAgICAgaWYgKGJvbmUucGFyZW50ICYmIGJvbmUucGFyZW50LmlzQm9uZSkgewogICAgICAgIF9ib25lTWF0cml4Lm11bHRpcGx5TWF0cmljZXMoX21hdHJpeFdvcmxkSW52LCBib25lLm1hdHJpeFdvcmxkKTsKICAgICAgICBfdmVjdG9yJDIuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKF9ib25lTWF0cml4KTsKICAgICAgICBwb3NpdGlvbi5zZXRYWVooaiwgX3ZlY3RvciQyLngsIF92ZWN0b3IkMi55LCBfdmVjdG9yJDIueik7CiAgICAgICAgX2JvbmVNYXRyaXgubXVsdGlwbHlNYXRyaWNlcyhfbWF0cml4V29ybGRJbnYsIGJvbmUucGFyZW50Lm1hdHJpeFdvcmxkKTsKICAgICAgICBfdmVjdG9yJDIuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKF9ib25lTWF0cml4KTsKICAgICAgICBwb3NpdGlvbi5zZXRYWVooaiArIDEsIF92ZWN0b3IkMi54LCBfdmVjdG9yJDIueSwgX3ZlY3RvciQyLnopOwogICAgICAgIGogKz0gMjsKICAgICAgfQogICAgfQogICAgZ2VvbWV0cnkuZ2V0QXR0cmlidXRlKCJwb3NpdGlvbiIpLm5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgIHN1cGVyLnVwZGF0ZU1hdHJpeFdvcmxkKGZvcmNlKTsKICB9Cn0KZnVuY3Rpb24gZ2V0Qm9uZUxpc3Qob2JqZWN0KSB7CiAgY29uc3QgYm9uZUxpc3QgPSBbXTsKICBpZiAob2JqZWN0ICYmIG9iamVjdC5pc0JvbmUpIHsKICAgIGJvbmVMaXN0LnB1c2gob2JqZWN0KTsKICB9CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBvYmplY3QuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHsKICAgIGJvbmVMaXN0LnB1c2guYXBwbHkoYm9uZUxpc3QsIGdldEJvbmVMaXN0KG9iamVjdC5jaGlsZHJlbltpXSkpOwogIH0KICByZXR1cm4gYm9uZUxpc3Q7Cn0KY2xhc3MgUG9pbnRMaWdodEhlbHBlciBleHRlbmRzIE1lc2ggewogIGNvbnN0cnVjdG9yKGxpZ2h0LCBzcGhlcmVTaXplLCBjb2xvcikgewogICAgY29uc3QgZ2VvbWV0cnkgPSBuZXcgU3BoZXJlR2VvbWV0cnkoc3BoZXJlU2l6ZSwgNCwgMik7CiAgICBjb25zdCBtYXRlcmlhbCA9IG5ldyBNZXNoQmFzaWNNYXRlcmlhbCh7IHdpcmVmcmFtZTogdHJ1ZSwgZm9nOiBmYWxzZSwgdG9uZU1hcHBlZDogZmFsc2UgfSk7CiAgICBzdXBlcihnZW9tZXRyeSwgbWF0ZXJpYWwpOwogICAgdGhpcy5saWdodCA9IGxpZ2h0OwogICAgdGhpcy5saWdodC51cGRhdGVNYXRyaXhXb3JsZCgpOwogICAgdGhpcy5jb2xvciA9IGNvbG9yOwogICAgdGhpcy50eXBlID0gIlBvaW50TGlnaHRIZWxwZXIiOwogICAgdGhpcy5tYXRyaXggPSB0aGlzLmxpZ2h0Lm1hdHJpeFdvcmxkOwogICAgdGhpcy5tYXRyaXhBdXRvVXBkYXRlID0gZmFsc2U7CiAgICB0aGlzLnVwZGF0ZSgpOwogIH0KICBkaXNwb3NlKCkgewogICAgdGhpcy5nZW9tZXRyeS5kaXNwb3NlKCk7CiAgICB0aGlzLm1hdGVyaWFsLmRpc3Bvc2UoKTsKICB9CiAgdXBkYXRlKCkgewogICAgaWYgKHRoaXMuY29sb3IgIT09IHZvaWQgMCkgewogICAgICB0aGlzLm1hdGVyaWFsLmNvbG9yLnNldCh0aGlzLmNvbG9yKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMubWF0ZXJpYWwuY29sb3IuY29weSh0aGlzLmxpZ2h0LmNvbG9yKTsKICAgIH0KICB9Cn0KY29uc3QgX3ZlY3RvciQxID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF9jb2xvcjEgPSAvKiBAX19QVVJFX18gKi8gbmV3IENvbG9yKCk7CmNvbnN0IF9jb2xvcjIgPSAvKiBAX19QVVJFX18gKi8gbmV3IENvbG9yKCk7CmNsYXNzIEhlbWlzcGhlcmVMaWdodEhlbHBlciBleHRlbmRzIE9iamVjdDNEIHsKICBjb25zdHJ1Y3RvcihsaWdodCwgc2l6ZSwgY29sb3IpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLmxpZ2h0ID0gbGlnaHQ7CiAgICB0aGlzLmxpZ2h0LnVwZGF0ZU1hdHJpeFdvcmxkKCk7CiAgICB0aGlzLm1hdHJpeCA9IGxpZ2h0Lm1hdHJpeFdvcmxkOwogICAgdGhpcy5tYXRyaXhBdXRvVXBkYXRlID0gZmFsc2U7CiAgICB0aGlzLmNvbG9yID0gY29sb3I7CiAgICBjb25zdCBnZW9tZXRyeSA9IG5ldyBPY3RhaGVkcm9uR2VvbWV0cnkoc2l6ZSk7CiAgICBnZW9tZXRyeS5yb3RhdGVZKE1hdGguUEkgKiAwLjUpOwogICAgdGhpcy5tYXRlcmlhbCA9IG5ldyBNZXNoQmFzaWNNYXRlcmlhbCh7IHdpcmVmcmFtZTogdHJ1ZSwgZm9nOiBmYWxzZSwgdG9uZU1hcHBlZDogZmFsc2UgfSk7CiAgICBpZiAodGhpcy5jb2xvciA9PT0gdm9pZCAwKQogICAgICB0aGlzLm1hdGVyaWFsLnZlcnRleENvbG9ycyA9IHRydWU7CiAgICBjb25zdCBwb3NpdGlvbiA9IGdlb21ldHJ5LmdldEF0dHJpYnV0ZSgicG9zaXRpb24iKTsKICAgIGNvbnN0IGNvbG9ycyA9IG5ldyBGbG9hdDMyQXJyYXkocG9zaXRpb24uY291bnQgKiAzKTsKICAgIGdlb21ldHJ5LnNldEF0dHJpYnV0ZSgiY29sb3IiLCBuZXcgQnVmZmVyQXR0cmlidXRlKGNvbG9ycywgMykpOwogICAgdGhpcy5hZGQobmV3IE1lc2goZ2VvbWV0cnksIHRoaXMubWF0ZXJpYWwpKTsKICAgIHRoaXMudXBkYXRlKCk7CiAgfQogIGRpc3Bvc2UoKSB7CiAgICB0aGlzLmNoaWxkcmVuWzBdLmdlb21ldHJ5LmRpc3Bvc2UoKTsKICAgIHRoaXMuY2hpbGRyZW5bMF0ubWF0ZXJpYWwuZGlzcG9zZSgpOwogIH0KICB1cGRhdGUoKSB7CiAgICBjb25zdCBtZXNoID0gdGhpcy5jaGlsZHJlblswXTsKICAgIGlmICh0aGlzLmNvbG9yICE9PSB2b2lkIDApIHsKICAgICAgdGhpcy5tYXRlcmlhbC5jb2xvci5zZXQodGhpcy5jb2xvcik7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBjb2xvcnMgPSBtZXNoLmdlb21ldHJ5LmdldEF0dHJpYnV0ZSgiY29sb3IiKTsKICAgICAgX2NvbG9yMS5jb3B5KHRoaXMubGlnaHQuY29sb3IpOwogICAgICBfY29sb3IyLmNvcHkodGhpcy5saWdodC5ncm91bmRDb2xvcik7CiAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gY29sb3JzLmNvdW50OyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY29uc3QgY29sb3IgPSBpIDwgbCAvIDIgPyBfY29sb3IxIDogX2NvbG9yMjsKICAgICAgICBjb2xvcnMuc2V0WFlaKGksIGNvbG9yLnIsIGNvbG9yLmcsIGNvbG9yLmIpOwogICAgICB9CiAgICAgIGNvbG9ycy5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICB9CiAgICBtZXNoLmxvb2tBdChfdmVjdG9yJDEuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKHRoaXMubGlnaHQubWF0cml4V29ybGQpLm5lZ2F0ZSgpKTsKICB9Cn0KY2xhc3MgR3JpZEhlbHBlciBleHRlbmRzIExpbmVTZWdtZW50cyB7CiAgY29uc3RydWN0b3Ioc2l6ZSA9IDEwLCBkaXZpc2lvbnMgPSAxMCwgY29sb3IxID0gNDQ3MzkyNCwgY29sb3IyID0gODk0Nzg0OCkgewogICAgY29sb3IxID0gbmV3IENvbG9yKGNvbG9yMSk7CiAgICBjb2xvcjIgPSBuZXcgQ29sb3IoY29sb3IyKTsKICAgIGNvbnN0IGNlbnRlciA9IGRpdmlzaW9ucyAvIDI7CiAgICBjb25zdCBzdGVwID0gc2l6ZSAvIGRpdmlzaW9uczsKICAgIGNvbnN0IGhhbGZTaXplID0gc2l6ZSAvIDI7CiAgICBjb25zdCB2ZXJ0aWNlcyA9IFtdLCBjb2xvcnMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwLCBqID0gMCwgayA9IC1oYWxmU2l6ZTsgaSA8PSBkaXZpc2lvbnM7IGkrKywgayArPSBzdGVwKSB7CiAgICAgIHZlcnRpY2VzLnB1c2goLWhhbGZTaXplLCAwLCBrLCBoYWxmU2l6ZSwgMCwgayk7CiAgICAgIHZlcnRpY2VzLnB1c2goaywgMCwgLWhhbGZTaXplLCBrLCAwLCBoYWxmU2l6ZSk7CiAgICAgIGNvbnN0IGNvbG9yID0gaSA9PT0gY2VudGVyID8gY29sb3IxIDogY29sb3IyOwogICAgICBjb2xvci50b0FycmF5KGNvbG9ycywgaik7CiAgICAgIGogKz0gMzsKICAgICAgY29sb3IudG9BcnJheShjb2xvcnMsIGopOwogICAgICBqICs9IDM7CiAgICAgIGNvbG9yLnRvQXJyYXkoY29sb3JzLCBqKTsKICAgICAgaiArPSAzOwogICAgICBjb2xvci50b0FycmF5KGNvbG9ycywgaik7CiAgICAgIGogKz0gMzsKICAgIH0KICAgIGNvbnN0IGdlb21ldHJ5ID0gbmV3IEJ1ZmZlckdlb21ldHJ5KCk7CiAgICBnZW9tZXRyeS5zZXRBdHRyaWJ1dGUoInBvc2l0aW9uIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUodmVydGljZXMsIDMpKTsKICAgIGdlb21ldHJ5LnNldEF0dHJpYnV0ZSgiY29sb3IiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShjb2xvcnMsIDMpKTsKICAgIGNvbnN0IG1hdGVyaWFsID0gbmV3IExpbmVCYXNpY01hdGVyaWFsKHsgdmVydGV4Q29sb3JzOiB0cnVlLCB0b25lTWFwcGVkOiBmYWxzZSB9KTsKICAgIHN1cGVyKGdlb21ldHJ5LCBtYXRlcmlhbCk7CiAgICB0aGlzLnR5cGUgPSAiR3JpZEhlbHBlciI7CiAgfQp9CmNsYXNzIFBvbGFyR3JpZEhlbHBlciBleHRlbmRzIExpbmVTZWdtZW50cyB7CiAgY29uc3RydWN0b3IocmFkaXVzID0gMTAsIHJhZGlhbHMgPSAxNiwgY2lyY2xlcyA9IDgsIGRpdmlzaW9ucyA9IDY0LCBjb2xvcjEgPSA0NDczOTI0LCBjb2xvcjIgPSA4OTQ3ODQ4KSB7CiAgICBjb2xvcjEgPSBuZXcgQ29sb3IoY29sb3IxKTsKICAgIGNvbG9yMiA9IG5ldyBDb2xvcihjb2xvcjIpOwogICAgY29uc3QgdmVydGljZXMgPSBbXTsKICAgIGNvbnN0IGNvbG9ycyA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gcmFkaWFsczsgaSsrKSB7CiAgICAgIGNvbnN0IHYgPSBpIC8gcmFkaWFscyAqIChNYXRoLlBJICogMik7CiAgICAgIGNvbnN0IHggPSBNYXRoLnNpbih2KSAqIHJhZGl1czsKICAgICAgY29uc3QgeiA9IE1hdGguY29zKHYpICogcmFkaXVzOwogICAgICB2ZXJ0aWNlcy5wdXNoKDAsIDAsIDApOwogICAgICB2ZXJ0aWNlcy5wdXNoKHgsIDAsIHopOwogICAgICBjb25zdCBjb2xvciA9IGkgJiAxID8gY29sb3IxIDogY29sb3IyOwogICAgICBjb2xvcnMucHVzaChjb2xvci5yLCBjb2xvci5nLCBjb2xvci5iKTsKICAgICAgY29sb3JzLnB1c2goY29sb3IuciwgY29sb3IuZywgY29sb3IuYik7CiAgICB9CiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBjaXJjbGVzOyBpKyspIHsKICAgICAgY29uc3QgY29sb3IgPSBpICYgMSA/IGNvbG9yMSA6IGNvbG9yMjsKICAgICAgY29uc3QgciA9IHJhZGl1cyAtIHJhZGl1cyAvIGNpcmNsZXMgKiBpOwogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGRpdmlzaW9uczsgaisrKSB7CiAgICAgICAgbGV0IHYgPSBqIC8gZGl2aXNpb25zICogKE1hdGguUEkgKiAyKTsKICAgICAgICBsZXQgeCA9IE1hdGguc2luKHYpICogcjsKICAgICAgICBsZXQgeiA9IE1hdGguY29zKHYpICogcjsKICAgICAgICB2ZXJ0aWNlcy5wdXNoKHgsIDAsIHopOwogICAgICAgIGNvbG9ycy5wdXNoKGNvbG9yLnIsIGNvbG9yLmcsIGNvbG9yLmIpOwogICAgICAgIHYgPSAoaiArIDEpIC8gZGl2aXNpb25zICogKE1hdGguUEkgKiAyKTsKICAgICAgICB4ID0gTWF0aC5zaW4odikgKiByOwogICAgICAgIHogPSBNYXRoLmNvcyh2KSAqIHI7CiAgICAgICAgdmVydGljZXMucHVzaCh4LCAwLCB6KTsKICAgICAgICBjb2xvcnMucHVzaChjb2xvci5yLCBjb2xvci5nLCBjb2xvci5iKTsKICAgICAgfQogICAgfQogICAgY29uc3QgZ2VvbWV0cnkgPSBuZXcgQnVmZmVyR2VvbWV0cnkoKTsKICAgIGdlb21ldHJ5LnNldEF0dHJpYnV0ZSgicG9zaXRpb24iLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh2ZXJ0aWNlcywgMykpOwogICAgZ2VvbWV0cnkuc2V0QXR0cmlidXRlKCJjb2xvciIsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKGNvbG9ycywgMykpOwogICAgY29uc3QgbWF0ZXJpYWwgPSBuZXcgTGluZUJhc2ljTWF0ZXJpYWwoeyB2ZXJ0ZXhDb2xvcnM6IHRydWUsIHRvbmVNYXBwZWQ6IGZhbHNlIH0pOwogICAgc3VwZXIoZ2VvbWV0cnksIG1hdGVyaWFsKTsKICAgIHRoaXMudHlwZSA9ICJQb2xhckdyaWRIZWxwZXIiOwogIH0KfQpjb25zdCBfdjEgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKY29uc3QgX3YyID0gLyogQF9fUFVSRV9fICovIG5ldyBWZWN0b3IzKCk7CmNvbnN0IF92MyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjbGFzcyBEaXJlY3Rpb25hbExpZ2h0SGVscGVyIGV4dGVuZHMgT2JqZWN0M0QgewogIGNvbnN0cnVjdG9yKGxpZ2h0LCBzaXplLCBjb2xvcikgewogICAgc3VwZXIoKTsKICAgIHRoaXMubGlnaHQgPSBsaWdodDsKICAgIHRoaXMubGlnaHQudXBkYXRlTWF0cml4V29ybGQoKTsKICAgIHRoaXMubWF0cml4ID0gbGlnaHQubWF0cml4V29ybGQ7CiAgICB0aGlzLm1hdHJpeEF1dG9VcGRhdGUgPSBmYWxzZTsKICAgIHRoaXMuY29sb3IgPSBjb2xvcjsKICAgIGlmIChzaXplID09PSB2b2lkIDApCiAgICAgIHNpemUgPSAxOwogICAgbGV0IGdlb21ldHJ5ID0gbmV3IEJ1ZmZlckdlb21ldHJ5KCk7CiAgICBnZW9tZXRyeS5zZXRBdHRyaWJ1dGUoInBvc2l0aW9uIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUoWwogICAgICAtc2l6ZSwKICAgICAgc2l6ZSwKICAgICAgMCwKICAgICAgc2l6ZSwKICAgICAgc2l6ZSwKICAgICAgMCwKICAgICAgc2l6ZSwKICAgICAgLXNpemUsCiAgICAgIDAsCiAgICAgIC1zaXplLAogICAgICAtc2l6ZSwKICAgICAgMCwKICAgICAgLXNpemUsCiAgICAgIHNpemUsCiAgICAgIDAKICAgIF0sIDMpKTsKICAgIGNvbnN0IG1hdGVyaWFsID0gbmV3IExpbmVCYXNpY01hdGVyaWFsKHsgZm9nOiBmYWxzZSwgdG9uZU1hcHBlZDogZmFsc2UgfSk7CiAgICB0aGlzLmxpZ2h0UGxhbmUgPSBuZXcgTGluZShnZW9tZXRyeSwgbWF0ZXJpYWwpOwogICAgdGhpcy5hZGQodGhpcy5saWdodFBsYW5lKTsKICAgIGdlb21ldHJ5ID0gbmV3IEJ1ZmZlckdlb21ldHJ5KCk7CiAgICBnZW9tZXRyeS5zZXRBdHRyaWJ1dGUoInBvc2l0aW9uIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUoWzAsIDAsIDAsIDAsIDAsIDFdLCAzKSk7CiAgICB0aGlzLnRhcmdldExpbmUgPSBuZXcgTGluZShnZW9tZXRyeSwgbWF0ZXJpYWwpOwogICAgdGhpcy5hZGQodGhpcy50YXJnZXRMaW5lKTsKICAgIHRoaXMudXBkYXRlKCk7CiAgfQogIGRpc3Bvc2UoKSB7CiAgICB0aGlzLmxpZ2h0UGxhbmUuZ2VvbWV0cnkuZGlzcG9zZSgpOwogICAgdGhpcy5saWdodFBsYW5lLm1hdGVyaWFsLmRpc3Bvc2UoKTsKICAgIHRoaXMudGFyZ2V0TGluZS5nZW9tZXRyeS5kaXNwb3NlKCk7CiAgICB0aGlzLnRhcmdldExpbmUubWF0ZXJpYWwuZGlzcG9zZSgpOwogIH0KICB1cGRhdGUoKSB7CiAgICBfdjEuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKHRoaXMubGlnaHQubWF0cml4V29ybGQpOwogICAgX3YyLnNldEZyb21NYXRyaXhQb3NpdGlvbih0aGlzLmxpZ2h0LnRhcmdldC5tYXRyaXhXb3JsZCk7CiAgICBfdjMuc3ViVmVjdG9ycyhfdjIsIF92MSk7CiAgICB0aGlzLmxpZ2h0UGxhbmUubG9va0F0KF92Mik7CiAgICBpZiAodGhpcy5jb2xvciAhPT0gdm9pZCAwKSB7CiAgICAgIHRoaXMubGlnaHRQbGFuZS5tYXRlcmlhbC5jb2xvci5zZXQodGhpcy5jb2xvcik7CiAgICAgIHRoaXMudGFyZ2V0TGluZS5tYXRlcmlhbC5jb2xvci5zZXQodGhpcy5jb2xvcik7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmxpZ2h0UGxhbmUubWF0ZXJpYWwuY29sb3IuY29weSh0aGlzLmxpZ2h0LmNvbG9yKTsKICAgICAgdGhpcy50YXJnZXRMaW5lLm1hdGVyaWFsLmNvbG9yLmNvcHkodGhpcy5saWdodC5jb2xvcik7CiAgICB9CiAgICB0aGlzLnRhcmdldExpbmUubG9va0F0KF92Mik7CiAgICB0aGlzLnRhcmdldExpbmUuc2NhbGUueiA9IF92My5sZW5ndGgoKTsKICB9Cn0KY29uc3QgX3ZlY3RvciA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVmVjdG9yMygpOwpjb25zdCBfY2FtZXJhID0gLyogQF9fUFVSRV9fICovIG5ldyBDYW1lcmEoKTsKY2xhc3MgQ2FtZXJhSGVscGVyIGV4dGVuZHMgTGluZVNlZ21lbnRzIHsKICBjb25zdHJ1Y3RvcihjYW1lcmEpIHsKICAgIGNvbnN0IGdlb21ldHJ5ID0gbmV3IEJ1ZmZlckdlb21ldHJ5KCk7CiAgICBjb25zdCBtYXRlcmlhbCA9IG5ldyBMaW5lQmFzaWNNYXRlcmlhbCh7IGNvbG9yOiAxNjc3NzIxNSwgdmVydGV4Q29sb3JzOiB0cnVlLCB0b25lTWFwcGVkOiBmYWxzZSB9KTsKICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICBjb25zdCBjb2xvcnMgPSBbXTsKICAgIGNvbnN0IHBvaW50TWFwID0ge307CiAgICBjb25zdCBjb2xvckZydXN0dW0gPSBuZXcgQ29sb3IoMTY3NTUyMDApOwogICAgY29uc3QgY29sb3JDb25lID0gbmV3IENvbG9yKDE2NzExNjgwKTsKICAgIGNvbnN0IGNvbG9yVXAgPSBuZXcgQ29sb3IoNDM3NzUpOwogICAgY29uc3QgY29sb3JUYXJnZXQgPSBuZXcgQ29sb3IoMTY3NzcyMTUpOwogICAgY29uc3QgY29sb3JDcm9zcyA9IG5ldyBDb2xvcigzMzU1NDQzKTsKICAgIGFkZExpbmUoIm4xIiwgIm4yIiwgY29sb3JGcnVzdHVtKTsKICAgIGFkZExpbmUoIm4yIiwgIm40IiwgY29sb3JGcnVzdHVtKTsKICAgIGFkZExpbmUoIm40IiwgIm4zIiwgY29sb3JGcnVzdHVtKTsKICAgIGFkZExpbmUoIm4zIiwgIm4xIiwgY29sb3JGcnVzdHVtKTsKICAgIGFkZExpbmUoImYxIiwgImYyIiwgY29sb3JGcnVzdHVtKTsKICAgIGFkZExpbmUoImYyIiwgImY0IiwgY29sb3JGcnVzdHVtKTsKICAgIGFkZExpbmUoImY0IiwgImYzIiwgY29sb3JGcnVzdHVtKTsKICAgIGFkZExpbmUoImYzIiwgImYxIiwgY29sb3JGcnVzdHVtKTsKICAgIGFkZExpbmUoIm4xIiwgImYxIiwgY29sb3JGcnVzdHVtKTsKICAgIGFkZExpbmUoIm4yIiwgImYyIiwgY29sb3JGcnVzdHVtKTsKICAgIGFkZExpbmUoIm4zIiwgImYzIiwgY29sb3JGcnVzdHVtKTsKICAgIGFkZExpbmUoIm40IiwgImY0IiwgY29sb3JGcnVzdHVtKTsKICAgIGFkZExpbmUoInAiLCAibjEiLCBjb2xvckNvbmUpOwogICAgYWRkTGluZSgicCIsICJuMiIsIGNvbG9yQ29uZSk7CiAgICBhZGRMaW5lKCJwIiwgIm4zIiwgY29sb3JDb25lKTsKICAgIGFkZExpbmUoInAiLCAibjQiLCBjb2xvckNvbmUpOwogICAgYWRkTGluZSgidTEiLCAidTIiLCBjb2xvclVwKTsKICAgIGFkZExpbmUoInUyIiwgInUzIiwgY29sb3JVcCk7CiAgICBhZGRMaW5lKCJ1MyIsICJ1MSIsIGNvbG9yVXApOwogICAgYWRkTGluZSgiYyIsICJ0IiwgY29sb3JUYXJnZXQpOwogICAgYWRkTGluZSgicCIsICJjIiwgY29sb3JDcm9zcyk7CiAgICBhZGRMaW5lKCJjbjEiLCAiY24yIiwgY29sb3JDcm9zcyk7CiAgICBhZGRMaW5lKCJjbjMiLCAiY240IiwgY29sb3JDcm9zcyk7CiAgICBhZGRMaW5lKCJjZjEiLCAiY2YyIiwgY29sb3JDcm9zcyk7CiAgICBhZGRMaW5lKCJjZjMiLCAiY2Y0IiwgY29sb3JDcm9zcyk7CiAgICBmdW5jdGlvbiBhZGRMaW5lKGEsIGIsIGNvbG9yKSB7CiAgICAgIGFkZFBvaW50KGEsIGNvbG9yKTsKICAgICAgYWRkUG9pbnQoYiwgY29sb3IpOwogICAgfQogICAgZnVuY3Rpb24gYWRkUG9pbnQoaWQsIGNvbG9yKSB7CiAgICAgIHZlcnRpY2VzLnB1c2goMCwgMCwgMCk7CiAgICAgIGNvbG9ycy5wdXNoKGNvbG9yLnIsIGNvbG9yLmcsIGNvbG9yLmIpOwogICAgICBpZiAocG9pbnRNYXBbaWRdID09PSB2b2lkIDApIHsKICAgICAgICBwb2ludE1hcFtpZF0gPSBbXTsKICAgICAgfQogICAgICBwb2ludE1hcFtpZF0ucHVzaCh2ZXJ0aWNlcy5sZW5ndGggLyAzIC0gMSk7CiAgICB9CiAgICBnZW9tZXRyeS5zZXRBdHRyaWJ1dGUoInBvc2l0aW9uIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUodmVydGljZXMsIDMpKTsKICAgIGdlb21ldHJ5LnNldEF0dHJpYnV0ZSgiY29sb3IiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShjb2xvcnMsIDMpKTsKICAgIHN1cGVyKGdlb21ldHJ5LCBtYXRlcmlhbCk7CiAgICB0aGlzLnR5cGUgPSAiQ2FtZXJhSGVscGVyIjsKICAgIHRoaXMuY2FtZXJhID0gY2FtZXJhOwogICAgaWYgKHRoaXMuY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgpCiAgICAgIHRoaXMuY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICAgIHRoaXMubWF0cml4ID0gY2FtZXJhLm1hdHJpeFdvcmxkOwogICAgdGhpcy5tYXRyaXhBdXRvVXBkYXRlID0gZmFsc2U7CiAgICB0aGlzLnBvaW50TWFwID0gcG9pbnRNYXA7CiAgICB0aGlzLnVwZGF0ZSgpOwogIH0KICB1cGRhdGUoKSB7CiAgICBjb25zdCBnZW9tZXRyeSA9IHRoaXMuZ2VvbWV0cnk7CiAgICBjb25zdCBwb2ludE1hcCA9IHRoaXMucG9pbnRNYXA7CiAgICBjb25zdCB3ID0gMSwgaCA9IDE7CiAgICBfY2FtZXJhLnByb2plY3Rpb25NYXRyaXhJbnZlcnNlLmNvcHkodGhpcy5jYW1lcmEucHJvamVjdGlvbk1hdHJpeEludmVyc2UpOwogICAgc2V0UG9pbnQoImMiLCBwb2ludE1hcCwgZ2VvbWV0cnksIF9jYW1lcmEsIDAsIDAsIC0xKTsKICAgIHNldFBvaW50KCJ0IiwgcG9pbnRNYXAsIGdlb21ldHJ5LCBfY2FtZXJhLCAwLCAwLCAxKTsKICAgIHNldFBvaW50KCJuMSIsIHBvaW50TWFwLCBnZW9tZXRyeSwgX2NhbWVyYSwgLXcsIC1oLCAtMSk7CiAgICBzZXRQb2ludCgibjIiLCBwb2ludE1hcCwgZ2VvbWV0cnksIF9jYW1lcmEsIHcsIC1oLCAtMSk7CiAgICBzZXRQb2ludCgibjMiLCBwb2ludE1hcCwgZ2VvbWV0cnksIF9jYW1lcmEsIC13LCBoLCAtMSk7CiAgICBzZXRQb2ludCgibjQiLCBwb2ludE1hcCwgZ2VvbWV0cnksIF9jYW1lcmEsIHcsIGgsIC0xKTsKICAgIHNldFBvaW50KCJmMSIsIHBvaW50TWFwLCBnZW9tZXRyeSwgX2NhbWVyYSwgLXcsIC1oLCAxKTsKICAgIHNldFBvaW50KCJmMiIsIHBvaW50TWFwLCBnZW9tZXRyeSwgX2NhbWVyYSwgdywgLWgsIDEpOwogICAgc2V0UG9pbnQoImYzIiwgcG9pbnRNYXAsIGdlb21ldHJ5LCBfY2FtZXJhLCAtdywgaCwgMSk7CiAgICBzZXRQb2ludCgiZjQiLCBwb2ludE1hcCwgZ2VvbWV0cnksIF9jYW1lcmEsIHcsIGgsIDEpOwogICAgc2V0UG9pbnQoInUxIiwgcG9pbnRNYXAsIGdlb21ldHJ5LCBfY2FtZXJhLCB3ICogMC43LCBoICogMS4xLCAtMSk7CiAgICBzZXRQb2ludCgidTIiLCBwb2ludE1hcCwgZ2VvbWV0cnksIF9jYW1lcmEsIC13ICogMC43LCBoICogMS4xLCAtMSk7CiAgICBzZXRQb2ludCgidTMiLCBwb2ludE1hcCwgZ2VvbWV0cnksIF9jYW1lcmEsIDAsIGggKiAyLCAtMSk7CiAgICBzZXRQb2ludCgiY2YxIiwgcG9pbnRNYXAsIGdlb21ldHJ5LCBfY2FtZXJhLCAtdywgMCwgMSk7CiAgICBzZXRQb2ludCgiY2YyIiwgcG9pbnRNYXAsIGdlb21ldHJ5LCBfY2FtZXJhLCB3LCAwLCAxKTsKICAgIHNldFBvaW50KCJjZjMiLCBwb2ludE1hcCwgZ2VvbWV0cnksIF9jYW1lcmEsIDAsIC1oLCAxKTsKICAgIHNldFBvaW50KCJjZjQiLCBwb2ludE1hcCwgZ2VvbWV0cnksIF9jYW1lcmEsIDAsIGgsIDEpOwogICAgc2V0UG9pbnQoImNuMSIsIHBvaW50TWFwLCBnZW9tZXRyeSwgX2NhbWVyYSwgLXcsIDAsIC0xKTsKICAgIHNldFBvaW50KCJjbjIiLCBwb2ludE1hcCwgZ2VvbWV0cnksIF9jYW1lcmEsIHcsIDAsIC0xKTsKICAgIHNldFBvaW50KCJjbjMiLCBwb2ludE1hcCwgZ2VvbWV0cnksIF9jYW1lcmEsIDAsIC1oLCAtMSk7CiAgICBzZXRQb2ludCgiY240IiwgcG9pbnRNYXAsIGdlb21ldHJ5LCBfY2FtZXJhLCAwLCBoLCAtMSk7CiAgICBnZW9tZXRyeS5nZXRBdHRyaWJ1dGUoInBvc2l0aW9uIikubmVlZHNVcGRhdGUgPSB0cnVlOwogIH0KICBkaXNwb3NlKCkgewogICAgdGhpcy5nZW9tZXRyeS5kaXNwb3NlKCk7CiAgICB0aGlzLm1hdGVyaWFsLmRpc3Bvc2UoKTsKICB9Cn0KZnVuY3Rpb24gc2V0UG9pbnQocG9pbnQsIHBvaW50TWFwLCBnZW9tZXRyeSwgY2FtZXJhLCB4LCB5LCB6KSB7CiAgX3ZlY3Rvci5zZXQoeCwgeSwgeikudW5wcm9qZWN0KGNhbWVyYSk7CiAgY29uc3QgcG9pbnRzID0gcG9pbnRNYXBbcG9pbnRdOwogIGlmIChwb2ludHMgIT09IHZvaWQgMCkgewogICAgY29uc3QgcG9zaXRpb24gPSBnZW9tZXRyeS5nZXRBdHRyaWJ1dGUoInBvc2l0aW9uIik7CiAgICBmb3IgKGxldCBpID0gMCwgbCA9IHBvaW50cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgcG9zaXRpb24uc2V0WFlaKHBvaW50c1tpXSwgX3ZlY3Rvci54LCBfdmVjdG9yLnksIF92ZWN0b3Iueik7CiAgICB9CiAgfQp9CmNvbnN0IF9ib3ggPSAvKiBAX19QVVJFX18gKi8gbmV3IEJveDMoKTsKY2xhc3MgQm94SGVscGVyIGV4dGVuZHMgTGluZVNlZ21lbnRzIHsKICBjb25zdHJ1Y3RvcihvYmplY3QsIGNvbG9yID0gMTY3NzY5NjApIHsKICAgIGNvbnN0IGluZGljZXMgPSBuZXcgVWludDE2QXJyYXkoWzAsIDEsIDEsIDIsIDIsIDMsIDMsIDAsIDQsIDUsIDUsIDYsIDYsIDcsIDcsIDQsIDAsIDQsIDEsIDUsIDIsIDYsIDMsIDddKTsKICAgIGNvbnN0IHBvc2l0aW9ucyA9IG5ldyBGbG9hdDMyQXJyYXkoOCAqIDMpOwogICAgY29uc3QgZ2VvbWV0cnkgPSBuZXcgQnVmZmVyR2VvbWV0cnkoKTsKICAgIGdlb21ldHJ5LnNldEluZGV4KG5ldyBCdWZmZXJBdHRyaWJ1dGUoaW5kaWNlcywgMSkpOwogICAgZ2VvbWV0cnkuc2V0QXR0cmlidXRlKCJwb3NpdGlvbiIsIG5ldyBCdWZmZXJBdHRyaWJ1dGUocG9zaXRpb25zLCAzKSk7CiAgICBzdXBlcihnZW9tZXRyeSwgbmV3IExpbmVCYXNpY01hdGVyaWFsKHsgY29sb3IsIHRvbmVNYXBwZWQ6IGZhbHNlIH0pKTsKICAgIHRoaXMub2JqZWN0ID0gb2JqZWN0OwogICAgdGhpcy50eXBlID0gIkJveEhlbHBlciI7CiAgICB0aGlzLm1hdHJpeEF1dG9VcGRhdGUgPSBmYWxzZTsKICAgIHRoaXMudXBkYXRlKCk7CiAgfQogIHVwZGF0ZShvYmplY3QpIHsKICAgIGlmIChvYmplY3QgIT09IHZvaWQgMCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkJveEhlbHBlcjogLnVwZGF0ZSgpIGhhcyBubyBsb25nZXIgYXJndW1lbnRzLiIpOwogICAgfQogICAgaWYgKHRoaXMub2JqZWN0ICE9PSB2b2lkIDApIHsKICAgICAgX2JveC5zZXRGcm9tT2JqZWN0KHRoaXMub2JqZWN0KTsKICAgIH0KICAgIGlmIChfYm94LmlzRW1wdHkoKSkKICAgICAgcmV0dXJuOwogICAgY29uc3QgbWluID0gX2JveC5taW47CiAgICBjb25zdCBtYXggPSBfYm94Lm1heDsKICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uOwogICAgY29uc3QgYXJyYXkgPSBwb3NpdGlvbi5hcnJheTsKICAgIGFycmF5WzBdID0gbWF4Lng7CiAgICBhcnJheVsxXSA9IG1heC55OwogICAgYXJyYXlbMl0gPSBtYXguejsKICAgIGFycmF5WzNdID0gbWluLng7CiAgICBhcnJheVs0XSA9IG1heC55OwogICAgYXJyYXlbNV0gPSBtYXguejsKICAgIGFycmF5WzZdID0gbWluLng7CiAgICBhcnJheVs3XSA9IG1pbi55OwogICAgYXJyYXlbOF0gPSBtYXguejsKICAgIGFycmF5WzldID0gbWF4Lng7CiAgICBhcnJheVsxMF0gPSBtaW4ueTsKICAgIGFycmF5WzExXSA9IG1heC56OwogICAgYXJyYXlbMTJdID0gbWF4Lng7CiAgICBhcnJheVsxM10gPSBtYXgueTsKICAgIGFycmF5WzE0XSA9IG1pbi56OwogICAgYXJyYXlbMTVdID0gbWluLng7CiAgICBhcnJheVsxNl0gPSBtYXgueTsKICAgIGFycmF5WzE3XSA9IG1pbi56OwogICAgYXJyYXlbMThdID0gbWluLng7CiAgICBhcnJheVsxOV0gPSBtaW4ueTsKICAgIGFycmF5WzIwXSA9IG1pbi56OwogICAgYXJyYXlbMjFdID0gbWF4Lng7CiAgICBhcnJheVsyMl0gPSBtaW4ueTsKICAgIGFycmF5WzIzXSA9IG1pbi56OwogICAgcG9zaXRpb24ubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgdGhpcy5nZW9tZXRyeS5jb21wdXRlQm91bmRpbmdTcGhlcmUoKTsKICB9CiAgc2V0RnJvbU9iamVjdChvYmplY3QpIHsKICAgIHRoaXMub2JqZWN0ID0gb2JqZWN0OwogICAgdGhpcy51cGRhdGUoKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBjb3B5KHNvdXJjZSkgewogICAgTGluZVNlZ21lbnRzLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcywgc291cmNlKTsKICAgIHRoaXMub2JqZWN0ID0gc291cmNlLm9iamVjdDsKICAgIHJldHVybiB0aGlzOwogIH0KfQpjbGFzcyBCb3gzSGVscGVyIGV4dGVuZHMgTGluZVNlZ21lbnRzIHsKICBjb25zdHJ1Y3Rvcihib3gsIGNvbG9yID0gMTY3NzY5NjApIHsKICAgIGNvbnN0IGluZGljZXMgPSBuZXcgVWludDE2QXJyYXkoWzAsIDEsIDEsIDIsIDIsIDMsIDMsIDAsIDQsIDUsIDUsIDYsIDYsIDcsIDcsIDQsIDAsIDQsIDEsIDUsIDIsIDYsIDMsIDddKTsKICAgIGNvbnN0IHBvc2l0aW9ucyA9IFsxLCAxLCAxLCAtMSwgMSwgMSwgLTEsIC0xLCAxLCAxLCAtMSwgMSwgMSwgMSwgLTEsIC0xLCAxLCAtMSwgLTEsIC0xLCAtMSwgMSwgLTEsIC0xXTsKICAgIGNvbnN0IGdlb21ldHJ5ID0gbmV3IEJ1ZmZlckdlb21ldHJ5KCk7CiAgICBnZW9tZXRyeS5zZXRJbmRleChuZXcgQnVmZmVyQXR0cmlidXRlKGluZGljZXMsIDEpKTsKICAgIGdlb21ldHJ5LnNldEF0dHJpYnV0ZSgicG9zaXRpb24iLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShwb3NpdGlvbnMsIDMpKTsKICAgIHN1cGVyKGdlb21ldHJ5LCBuZXcgTGluZUJhc2ljTWF0ZXJpYWwoeyBjb2xvciwgdG9uZU1hcHBlZDogZmFsc2UgfSkpOwogICAgdGhpcy5ib3ggPSBib3g7CiAgICB0aGlzLnR5cGUgPSAiQm94M0hlbHBlciI7CiAgICB0aGlzLmdlb21ldHJ5LmNvbXB1dGVCb3VuZGluZ1NwaGVyZSgpOwogIH0KICB1cGRhdGVNYXRyaXhXb3JsZChmb3JjZSkgewogICAgY29uc3QgYm94ID0gdGhpcy5ib3g7CiAgICBpZiAoYm94LmlzRW1wdHkoKSkKICAgICAgcmV0dXJuOwogICAgYm94LmdldENlbnRlcih0aGlzLnBvc2l0aW9uKTsKICAgIGJveC5nZXRTaXplKHRoaXMuc2NhbGUpOwogICAgdGhpcy5zY2FsZS5tdWx0aXBseVNjYWxhcigwLjUpOwogICAgc3VwZXIudXBkYXRlTWF0cml4V29ybGQoZm9yY2UpOwogIH0KfQpjbGFzcyBQbGFuZUhlbHBlciBleHRlbmRzIExpbmUgewogIGNvbnN0cnVjdG9yKHBsYW5lLCBzaXplID0gMSwgaGV4ID0gMTY3NzY5NjApIHsKICAgIGNvbnN0IGNvbG9yID0gaGV4OwogICAgY29uc3QgcG9zaXRpb25zID0gWzEsIC0xLCAxLCAtMSwgMSwgMSwgLTEsIC0xLCAxLCAxLCAxLCAxLCAtMSwgMSwgMSwgLTEsIC0xLCAxLCAxLCAtMSwgMSwgMSwgMSwgMSwgMCwgMCwgMSwgMCwgMCwgMF07CiAgICBjb25zdCBnZW9tZXRyeSA9IG5ldyBCdWZmZXJHZW9tZXRyeSgpOwogICAgZ2VvbWV0cnkuc2V0QXR0cmlidXRlKCJwb3NpdGlvbiIsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9ucywgMykpOwogICAgZ2VvbWV0cnkuY29tcHV0ZUJvdW5kaW5nU3BoZXJlKCk7CiAgICBzdXBlcihnZW9tZXRyeSwgbmV3IExpbmVCYXNpY01hdGVyaWFsKHsgY29sb3IsIHRvbmVNYXBwZWQ6IGZhbHNlIH0pKTsKICAgIHRoaXMudHlwZSA9ICJQbGFuZUhlbHBlciI7CiAgICB0aGlzLnBsYW5lID0gcGxhbmU7CiAgICB0aGlzLnNpemUgPSBzaXplOwogICAgY29uc3QgcG9zaXRpb25zMiA9IFsxLCAxLCAxLCAtMSwgMSwgMSwgLTEsIC0xLCAxLCAxLCAxLCAxLCAtMSwgLTEsIDEsIDEsIC0xLCAxXTsKICAgIGNvbnN0IGdlb21ldHJ5MiA9IG5ldyBCdWZmZXJHZW9tZXRyeSgpOwogICAgZ2VvbWV0cnkyLnNldEF0dHJpYnV0ZSgicG9zaXRpb24iLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShwb3NpdGlvbnMyLCAzKSk7CiAgICBnZW9tZXRyeTIuY29tcHV0ZUJvdW5kaW5nU3BoZXJlKCk7CiAgICB0aGlzLmFkZChuZXcgTWVzaChnZW9tZXRyeTIsIG5ldyBNZXNoQmFzaWNNYXRlcmlhbCh7IGNvbG9yLCBvcGFjaXR5OiAwLjIsIHRyYW5zcGFyZW50OiB0cnVlLCBkZXB0aFdyaXRlOiBmYWxzZSwgdG9uZU1hcHBlZDogZmFsc2UgfSkpKTsKICB9CiAgdXBkYXRlTWF0cml4V29ybGQoZm9yY2UpIHsKICAgIGxldCBzY2FsZSA9IC10aGlzLnBsYW5lLmNvbnN0YW50OwogICAgaWYgKE1hdGguYWJzKHNjYWxlKSA8IDFlLTgpCiAgICAgIHNjYWxlID0gMWUtODsKICAgIHRoaXMuc2NhbGUuc2V0KDAuNSAqIHRoaXMuc2l6ZSwgMC41ICogdGhpcy5zaXplLCBzY2FsZSk7CiAgICB0aGlzLmNoaWxkcmVuWzBdLm1hdGVyaWFsLnNpZGUgPSBzY2FsZSA8IDAgPyBCYWNrU2lkZSA6IEZyb250U2lkZTsKICAgIHRoaXMubG9va0F0KHRoaXMucGxhbmUubm9ybWFsKTsKICAgIHN1cGVyLnVwZGF0ZU1hdHJpeFdvcmxkKGZvcmNlKTsKICB9Cn0KY29uc3QgX2F4aXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFZlY3RvcjMoKTsKbGV0IF9saW5lR2VvbWV0cnksIF9jb25lR2VvbWV0cnk7CmNsYXNzIEFycm93SGVscGVyIGV4dGVuZHMgT2JqZWN0M0QgewogIGNvbnN0cnVjdG9yKGRpciA9IG5ldyBWZWN0b3IzKDAsIDAsIDEpLCBvcmlnaW4gPSBuZXcgVmVjdG9yMygwLCAwLCAwKSwgbGVuZ3RoID0gMSwgY29sb3IgPSAxNjc3Njk2MCwgaGVhZExlbmd0aCA9IGxlbmd0aCAqIDAuMiwgaGVhZFdpZHRoID0gaGVhZExlbmd0aCAqIDAuMikgewogICAgc3VwZXIoKTsKICAgIHRoaXMudHlwZSA9ICJBcnJvd0hlbHBlciI7CiAgICBpZiAoX2xpbmVHZW9tZXRyeSA9PT0gdm9pZCAwKSB7CiAgICAgIF9saW5lR2VvbWV0cnkgPSBuZXcgQnVmZmVyR2VvbWV0cnkoKTsKICAgICAgX2xpbmVHZW9tZXRyeS5zZXRBdHRyaWJ1dGUoInBvc2l0aW9uIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUoWzAsIDAsIDAsIDAsIDEsIDBdLCAzKSk7CiAgICAgIF9jb25lR2VvbWV0cnkgPSBuZXcgQ3lsaW5kZXJHZW9tZXRyeSgwLCAwLjUsIDEsIDUsIDEpOwogICAgICBfY29uZUdlb21ldHJ5LnRyYW5zbGF0ZSgwLCAtMC41LCAwKTsKICAgIH0KICAgIHRoaXMucG9zaXRpb24uY29weShvcmlnaW4pOwogICAgdGhpcy5saW5lID0gbmV3IExpbmUoX2xpbmVHZW9tZXRyeSwgbmV3IExpbmVCYXNpY01hdGVyaWFsKHsgY29sb3IsIHRvbmVNYXBwZWQ6IGZhbHNlIH0pKTsKICAgIHRoaXMubGluZS5tYXRyaXhBdXRvVXBkYXRlID0gZmFsc2U7CiAgICB0aGlzLmFkZCh0aGlzLmxpbmUpOwogICAgdGhpcy5jb25lID0gbmV3IE1lc2goX2NvbmVHZW9tZXRyeSwgbmV3IE1lc2hCYXNpY01hdGVyaWFsKHsgY29sb3IsIHRvbmVNYXBwZWQ6IGZhbHNlIH0pKTsKICAgIHRoaXMuY29uZS5tYXRyaXhBdXRvVXBkYXRlID0gZmFsc2U7CiAgICB0aGlzLmFkZCh0aGlzLmNvbmUpOwogICAgdGhpcy5zZXREaXJlY3Rpb24oZGlyKTsKICAgIHRoaXMuc2V0TGVuZ3RoKGxlbmd0aCwgaGVhZExlbmd0aCwgaGVhZFdpZHRoKTsKICB9CiAgc2V0RGlyZWN0aW9uKGRpcikgewogICAgaWYgKGRpci55ID4gMC45OTk5OSkgewogICAgICB0aGlzLnF1YXRlcm5pb24uc2V0KDAsIDAsIDAsIDEpOwogICAgfSBlbHNlIGlmIChkaXIueSA8IC0wLjk5OTk5KSB7CiAgICAgIHRoaXMucXVhdGVybmlvbi5zZXQoMSwgMCwgMCwgMCk7CiAgICB9IGVsc2UgewogICAgICBfYXhpcy5zZXQoZGlyLnosIDAsIC1kaXIueCkubm9ybWFsaXplKCk7CiAgICAgIGNvbnN0IHJhZGlhbnMgPSBNYXRoLmFjb3MoZGlyLnkpOwogICAgICB0aGlzLnF1YXRlcm5pb24uc2V0RnJvbUF4aXNBbmdsZShfYXhpcywgcmFkaWFucyk7CiAgICB9CiAgfQogIHNldExlbmd0aChsZW5ndGgsIGhlYWRMZW5ndGggPSBsZW5ndGggKiAwLjIsIGhlYWRXaWR0aCA9IGhlYWRMZW5ndGggKiAwLjIpIHsKICAgIHRoaXMubGluZS5zY2FsZS5zZXQoMSwgTWF0aC5tYXgoMWUtNCwgbGVuZ3RoIC0gaGVhZExlbmd0aCksIDEpOwogICAgdGhpcy5saW5lLnVwZGF0ZU1hdHJpeCgpOwogICAgdGhpcy5jb25lLnNjYWxlLnNldChoZWFkV2lkdGgsIGhlYWRMZW5ndGgsIGhlYWRXaWR0aCk7CiAgICB0aGlzLmNvbmUucG9zaXRpb24ueSA9IGxlbmd0aDsKICAgIHRoaXMuY29uZS51cGRhdGVNYXRyaXgoKTsKICB9CiAgc2V0Q29sb3IoY29sb3IpIHsKICAgIHRoaXMubGluZS5tYXRlcmlhbC5jb2xvci5zZXQoY29sb3IpOwogICAgdGhpcy5jb25lLm1hdGVyaWFsLmNvbG9yLnNldChjb2xvcik7CiAgfQogIGNvcHkoc291cmNlKSB7CiAgICBzdXBlci5jb3B5KHNvdXJjZSwgZmFsc2UpOwogICAgdGhpcy5saW5lLmNvcHkoc291cmNlLmxpbmUpOwogICAgdGhpcy5jb25lLmNvcHkoc291cmNlLmNvbmUpOwogICAgcmV0dXJuIHRoaXM7CiAgfQp9CmNsYXNzIEF4ZXNIZWxwZXIgZXh0ZW5kcyBMaW5lU2VnbWVudHMgewogIGNvbnN0cnVjdG9yKHNpemUgPSAxKSB7CiAgICBjb25zdCB2ZXJ0aWNlcyA9IFsKICAgICAgMCwKICAgICAgMCwKICAgICAgMCwKICAgICAgc2l6ZSwKICAgICAgMCwKICAgICAgMCwKICAgICAgMCwKICAgICAgMCwKICAgICAgMCwKICAgICAgMCwKICAgICAgc2l6ZSwKICAgICAgMCwKICAgICAgMCwKICAgICAgMCwKICAgICAgMCwKICAgICAgMCwKICAgICAgMCwKICAgICAgc2l6ZQogICAgXTsKICAgIGNvbnN0IGNvbG9ycyA9IFsKICAgICAgMSwKICAgICAgMCwKICAgICAgMCwKICAgICAgMSwKICAgICAgMC42LAogICAgICAwLAogICAgICAwLAogICAgICAxLAogICAgICAwLAogICAgICAwLjYsCiAgICAgIDEsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIDAsCiAgICAgIDEsCiAgICAgIDAsCiAgICAgIDAuNiwKICAgICAgMQogICAgXTsKICAgIGNvbnN0IGdlb21ldHJ5ID0gbmV3IEJ1ZmZlckdlb21ldHJ5KCk7CiAgICBnZW9tZXRyeS5zZXRBdHRyaWJ1dGUoInBvc2l0aW9uIiwgbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUodmVydGljZXMsIDMpKTsKICAgIGdlb21ldHJ5LnNldEF0dHJpYnV0ZSgiY29sb3IiLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShjb2xvcnMsIDMpKTsKICAgIGNvbnN0IG1hdGVyaWFsID0gbmV3IExpbmVCYXNpY01hdGVyaWFsKHsgdmVydGV4Q29sb3JzOiB0cnVlLCB0b25lTWFwcGVkOiBmYWxzZSB9KTsKICAgIHN1cGVyKGdlb21ldHJ5LCBtYXRlcmlhbCk7CiAgICB0aGlzLnR5cGUgPSAiQXhlc0hlbHBlciI7CiAgfQogIHNldENvbG9ycyh4QXhpc0NvbG9yLCB5QXhpc0NvbG9yLCB6QXhpc0NvbG9yKSB7CiAgICBjb25zdCBjb2xvciA9IG5ldyBDb2xvcigpOwogICAgY29uc3QgYXJyYXkgPSB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMuY29sb3IuYXJyYXk7CiAgICBjb2xvci5zZXQoeEF4aXNDb2xvcik7CiAgICBjb2xvci50b0FycmF5KGFycmF5LCAwKTsKICAgIGNvbG9yLnRvQXJyYXkoYXJyYXksIDMpOwogICAgY29sb3Iuc2V0KHlBeGlzQ29sb3IpOwogICAgY29sb3IudG9BcnJheShhcnJheSwgNik7CiAgICBjb2xvci50b0FycmF5KGFycmF5LCA5KTsKICAgIGNvbG9yLnNldCh6QXhpc0NvbG9yKTsKICAgIGNvbG9yLnRvQXJyYXkoYXJyYXksIDEyKTsKICAgIGNvbG9yLnRvQXJyYXkoYXJyYXksIDE1KTsKICAgIHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5jb2xvci5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICByZXR1cm4gdGhpczsKICB9CiAgZGlzcG9zZSgpIHsKICAgIHRoaXMuZ2VvbWV0cnkuZGlzcG9zZSgpOwogICAgdGhpcy5tYXRlcmlhbC5kaXNwb3NlKCk7CiAgfQp9CmNsYXNzIFNoYXBlUGF0aCB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLnR5cGUgPSAiU2hhcGVQYXRoIjsKICAgIHRoaXMuY29sb3IgPSBuZXcgQ29sb3IoKTsKICAgIHRoaXMuc3ViUGF0aHMgPSBbXTsKICAgIHRoaXMuY3VycmVudFBhdGggPSBudWxsOwogIH0KICBtb3ZlVG8oeCwgeSkgewogICAgdGhpcy5jdXJyZW50UGF0aCA9IG5ldyBQYXRoKCk7CiAgICB0aGlzLnN1YlBhdGhzLnB1c2godGhpcy5jdXJyZW50UGF0aCk7CiAgICB0aGlzLmN1cnJlbnRQYXRoLm1vdmVUbyh4LCB5KTsKICAgIHJldHVybiB0aGlzOwogIH0KICBsaW5lVG8oeCwgeSkgewogICAgdGhpcy5jdXJyZW50UGF0aC5saW5lVG8oeCwgeSk7CiAgICByZXR1cm4gdGhpczsKICB9CiAgcXVhZHJhdGljQ3VydmVUbyhhQ1B4LCBhQ1B5LCBhWCwgYVkpIHsKICAgIHRoaXMuY3VycmVudFBhdGgucXVhZHJhdGljQ3VydmVUbyhhQ1B4LCBhQ1B5LCBhWCwgYVkpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIGJlemllckN1cnZlVG8oYUNQMXgsIGFDUDF5LCBhQ1AyeCwgYUNQMnksIGFYLCBhWSkgewogICAgdGhpcy5jdXJyZW50UGF0aC5iZXppZXJDdXJ2ZVRvKGFDUDF4LCBhQ1AxeSwgYUNQMngsIGFDUDJ5LCBhWCwgYVkpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHNwbGluZVRocnUocHRzKSB7CiAgICB0aGlzLmN1cnJlbnRQYXRoLnNwbGluZVRocnUocHRzKTsKICAgIHJldHVybiB0aGlzOwogIH0KICB0b1NoYXBlcyhpc0NDVywgbm9Ib2xlcykgewogICAgZnVuY3Rpb24gdG9TaGFwZXNOb0hvbGVzKGluU3VicGF0aHMpIHsKICAgICAgY29uc3Qgc2hhcGVzMiA9IFtdOwogICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGluU3VicGF0aHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY29uc3QgdG1wUGF0aDIgPSBpblN1YnBhdGhzW2ldOwogICAgICAgIGNvbnN0IHRtcFNoYXBlMiA9IG5ldyBTaGFwZSgpOwogICAgICAgIHRtcFNoYXBlMi5jdXJ2ZXMgPSB0bXBQYXRoMi5jdXJ2ZXM7CiAgICAgICAgc2hhcGVzMi5wdXNoKHRtcFNoYXBlMik7CiAgICAgIH0KICAgICAgcmV0dXJuIHNoYXBlczI7CiAgICB9CiAgICBmdW5jdGlvbiBpc1BvaW50SW5zaWRlUG9seWdvbihpblB0LCBpblBvbHlnb24pIHsKICAgICAgY29uc3QgcG9seUxlbiA9IGluUG9seWdvbi5sZW5ndGg7CiAgICAgIGxldCBpbnNpZGUgPSBmYWxzZTsKICAgICAgZm9yIChsZXQgcCA9IHBvbHlMZW4gLSAxLCBxID0gMDsgcSA8IHBvbHlMZW47IHAgPSBxKyspIHsKICAgICAgICBsZXQgZWRnZUxvd1B0ID0gaW5Qb2x5Z29uW3BdOwogICAgICAgIGxldCBlZGdlSGlnaFB0ID0gaW5Qb2x5Z29uW3FdOwogICAgICAgIGxldCBlZGdlRHggPSBlZGdlSGlnaFB0LnggLSBlZGdlTG93UHQueDsKICAgICAgICBsZXQgZWRnZUR5ID0gZWRnZUhpZ2hQdC55IC0gZWRnZUxvd1B0Lnk7CiAgICAgICAgaWYgKE1hdGguYWJzKGVkZ2VEeSkgPiBOdW1iZXIuRVBTSUxPTikgewogICAgICAgICAgaWYgKGVkZ2VEeSA8IDApIHsKICAgICAgICAgICAgZWRnZUxvd1B0ID0gaW5Qb2x5Z29uW3FdOwogICAgICAgICAgICBlZGdlRHggPSAtZWRnZUR4OwogICAgICAgICAgICBlZGdlSGlnaFB0ID0gaW5Qb2x5Z29uW3BdOwogICAgICAgICAgICBlZGdlRHkgPSAtZWRnZUR5OwogICAgICAgICAgfQogICAgICAgICAgaWYgKGluUHQueSA8IGVkZ2VMb3dQdC55IHx8IGluUHQueSA+IGVkZ2VIaWdoUHQueSkKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICBpZiAoaW5QdC55ID09PSBlZGdlTG93UHQueSkgewogICAgICAgICAgICBpZiAoaW5QdC54ID09PSBlZGdlTG93UHQueCkKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IHBlcnBFZGdlID0gZWRnZUR5ICogKGluUHQueCAtIGVkZ2VMb3dQdC54KSAtIGVkZ2VEeCAqIChpblB0LnkgLSBlZGdlTG93UHQueSk7CiAgICAgICAgICAgIGlmIChwZXJwRWRnZSA9PT0gMCkKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgaWYgKHBlcnBFZGdlIDwgMCkKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgaW5zaWRlID0gIWluc2lkZTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKGluUHQueSAhPT0gZWRnZUxvd1B0LnkpCiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgaWYgKGVkZ2VIaWdoUHQueCA8PSBpblB0LnggJiYgaW5QdC54IDw9IGVkZ2VMb3dQdC54IHx8IGVkZ2VMb3dQdC54IDw9IGluUHQueCAmJiBpblB0LnggPD0gZWRnZUhpZ2hQdC54KQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGluc2lkZTsKICAgIH0KICAgIGNvbnN0IGlzQ2xvY2tXaXNlID0gU2hhcGVVdGlscy5pc0Nsb2NrV2lzZTsKICAgIGNvbnN0IHN1YlBhdGhzID0gdGhpcy5zdWJQYXRoczsKICAgIGlmIChzdWJQYXRocy5sZW5ndGggPT09IDApCiAgICAgIHJldHVybiBbXTsKICAgIGlmIChub0hvbGVzID09PSB0cnVlKQogICAgICByZXR1cm4gdG9TaGFwZXNOb0hvbGVzKHN1YlBhdGhzKTsKICAgIGxldCBzb2xpZCwgdG1wUGF0aCwgdG1wU2hhcGU7CiAgICBjb25zdCBzaGFwZXMgPSBbXTsKICAgIGlmIChzdWJQYXRocy5sZW5ndGggPT09IDEpIHsKICAgICAgdG1wUGF0aCA9IHN1YlBhdGhzWzBdOwogICAgICB0bXBTaGFwZSA9IG5ldyBTaGFwZSgpOwogICAgICB0bXBTaGFwZS5jdXJ2ZXMgPSB0bXBQYXRoLmN1cnZlczsKICAgICAgc2hhcGVzLnB1c2godG1wU2hhcGUpOwogICAgICByZXR1cm4gc2hhcGVzOwogICAgfQogICAgbGV0IGhvbGVzRmlyc3QgPSAhaXNDbG9ja1dpc2Uoc3ViUGF0aHNbMF0uZ2V0UG9pbnRzKCkpOwogICAgaG9sZXNGaXJzdCA9IGlzQ0NXID8gIWhvbGVzRmlyc3QgOiBob2xlc0ZpcnN0OwogICAgY29uc3QgYmV0dGVyU2hhcGVIb2xlcyA9IFtdOwogICAgY29uc3QgbmV3U2hhcGVzID0gW107CiAgICBsZXQgbmV3U2hhcGVIb2xlcyA9IFtdOwogICAgbGV0IG1haW5JZHggPSAwOwogICAgbGV0IHRtcFBvaW50czsKICAgIG5ld1NoYXBlc1ttYWluSWR4XSA9IHZvaWQgMDsKICAgIG5ld1NoYXBlSG9sZXNbbWFpbklkeF0gPSBbXTsKICAgIGZvciAobGV0IGkgPSAwLCBsID0gc3ViUGF0aHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIHRtcFBhdGggPSBzdWJQYXRoc1tpXTsKICAgICAgdG1wUG9pbnRzID0gdG1wUGF0aC5nZXRQb2ludHMoKTsKICAgICAgc29saWQgPSBpc0Nsb2NrV2lzZSh0bXBQb2ludHMpOwogICAgICBzb2xpZCA9IGlzQ0NXID8gIXNvbGlkIDogc29saWQ7CiAgICAgIGlmIChzb2xpZCkgewogICAgICAgIGlmICghaG9sZXNGaXJzdCAmJiBuZXdTaGFwZXNbbWFpbklkeF0pCiAgICAgICAgICBtYWluSWR4Kys7CiAgICAgICAgbmV3U2hhcGVzW21haW5JZHhdID0geyBzOiBuZXcgU2hhcGUoKSwgcDogdG1wUG9pbnRzIH07CiAgICAgICAgbmV3U2hhcGVzW21haW5JZHhdLnMuY3VydmVzID0gdG1wUGF0aC5jdXJ2ZXM7CiAgICAgICAgaWYgKGhvbGVzRmlyc3QpCiAgICAgICAgICBtYWluSWR4Kys7CiAgICAgICAgbmV3U2hhcGVIb2xlc1ttYWluSWR4XSA9IFtdOwogICAgICB9IGVsc2UgewogICAgICAgIG5ld1NoYXBlSG9sZXNbbWFpbklkeF0ucHVzaCh7IGg6IHRtcFBhdGgsIHA6IHRtcFBvaW50c1swXSB9KTsKICAgICAgfQogICAgfQogICAgaWYgKCFuZXdTaGFwZXNbMF0pCiAgICAgIHJldHVybiB0b1NoYXBlc05vSG9sZXMoc3ViUGF0aHMpOwogICAgaWYgKG5ld1NoYXBlcy5sZW5ndGggPiAxKSB7CiAgICAgIGxldCBhbWJpZ3VvdXMgPSBmYWxzZTsKICAgICAgY29uc3QgdG9DaGFuZ2UgPSBbXTsKICAgICAgZm9yIChsZXQgc0lkeCA9IDAsIHNMZW4gPSBuZXdTaGFwZXMubGVuZ3RoOyBzSWR4IDwgc0xlbjsgc0lkeCsrKSB7CiAgICAgICAgYmV0dGVyU2hhcGVIb2xlc1tzSWR4XSA9IFtdOwogICAgICB9CiAgICAgIGZvciAobGV0IHNJZHggPSAwLCBzTGVuID0gbmV3U2hhcGVzLmxlbmd0aDsgc0lkeCA8IHNMZW47IHNJZHgrKykgewogICAgICAgIGNvbnN0IHNobyA9IG5ld1NoYXBlSG9sZXNbc0lkeF07CiAgICAgICAgZm9yIChsZXQgaElkeCA9IDA7IGhJZHggPCBzaG8ubGVuZ3RoOyBoSWR4KyspIHsKICAgICAgICAgIGNvbnN0IGhvID0gc2hvW2hJZHhdOwogICAgICAgICAgbGV0IGhvbGVfdW5hc3NpZ25lZCA9IHRydWU7CiAgICAgICAgICBmb3IgKGxldCBzMklkeCA9IDA7IHMySWR4IDwgbmV3U2hhcGVzLmxlbmd0aDsgczJJZHgrKykgewogICAgICAgICAgICBpZiAoaXNQb2ludEluc2lkZVBvbHlnb24oaG8ucCwgbmV3U2hhcGVzW3MySWR4XS5wKSkgewogICAgICAgICAgICAgIGlmIChzSWR4ICE9PSBzMklkeCkKICAgICAgICAgICAgICAgIHRvQ2hhbmdlLnB1c2goeyBmcm9tczogc0lkeCwgdG9zOiBzMklkeCwgaG9sZTogaElkeCB9KTsKICAgICAgICAgICAgICBpZiAoaG9sZV91bmFzc2lnbmVkKSB7CiAgICAgICAgICAgICAgICBob2xlX3VuYXNzaWduZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGJldHRlclNoYXBlSG9sZXNbczJJZHhdLnB1c2goaG8pOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBhbWJpZ3VvdXMgPSB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKGhvbGVfdW5hc3NpZ25lZCkgewogICAgICAgICAgICBiZXR0ZXJTaGFwZUhvbGVzW3NJZHhdLnB1c2goaG8pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodG9DaGFuZ2UubGVuZ3RoID4gMCkgewogICAgICAgIGlmICghYW1iaWd1b3VzKQogICAgICAgICAgbmV3U2hhcGVIb2xlcyA9IGJldHRlclNoYXBlSG9sZXM7CiAgICAgIH0KICAgIH0KICAgIGxldCB0bXBIb2xlczsKICAgIGZvciAobGV0IGkgPSAwLCBpbCA9IG5ld1NoYXBlcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgIHRtcFNoYXBlID0gbmV3U2hhcGVzW2ldLnM7CiAgICAgIHNoYXBlcy5wdXNoKHRtcFNoYXBlKTsKICAgICAgdG1wSG9sZXMgPSBuZXdTaGFwZUhvbGVzW2ldOwogICAgICBmb3IgKGxldCBqID0gMCwgamwgPSB0bXBIb2xlcy5sZW5ndGg7IGogPCBqbDsgaisrKSB7CiAgICAgICAgdG1wU2hhcGUuaG9sZXMucHVzaCh0bXBIb2xlc1tqXS5oKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHNoYXBlczsKICB9Cn0KY29uc3QgX2Zsb2F0VmlldyA9IG5ldyBGbG9hdDMyQXJyYXkoMSk7CmNvbnN0IF9pbnQzMlZpZXcgPSBuZXcgSW50MzJBcnJheShfZmxvYXRWaWV3LmJ1ZmZlcik7CmNsYXNzIERhdGFVdGlscyB7CiAgc3RhdGljIHRvSGFsZkZsb2F0KHZhbCkgewogICAgaWYgKHZhbCA+IDY1NTA0KSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuRGF0YVV0aWxzLnRvSGFsZkZsb2F0KCk6IHZhbHVlIGV4Y2VlZHMgNjU1MDQuIik7CiAgICAgIHZhbCA9IDY1NTA0OwogICAgfQogICAgX2Zsb2F0Vmlld1swXSA9IHZhbDsKICAgIGNvbnN0IHggPSBfaW50MzJWaWV3WzBdOwogICAgbGV0IGJpdHMgPSB4ID4+IDE2ICYgMzI3Njg7CiAgICBsZXQgbSA9IHggPj4gMTIgJiAyMDQ3OwogICAgY29uc3QgZSA9IHggPj4gMjMgJiAyNTU7CiAgICBpZiAoZSA8IDEwMykKICAgICAgcmV0dXJuIGJpdHM7CiAgICBpZiAoZSA+IDE0MikgewogICAgICBiaXRzIHw9IDMxNzQ0OwogICAgICBiaXRzIHw9IChlID09IDI1NSA/IDAgOiAxKSAmJiB4ICYgODM4ODYwNzsKICAgICAgcmV0dXJuIGJpdHM7CiAgICB9CiAgICBpZiAoZSA8IDExMykgewogICAgICBtIHw9IDIwNDg7CiAgICAgIGJpdHMgfD0gKG0gPj4gMTE0IC0gZSkgKyAobSA+PiAxMTMgLSBlICYgMSk7CiAgICAgIHJldHVybiBiaXRzOwogICAgfQogICAgYml0cyB8PSBlIC0gMTEyIDw8IDEwIHwgbSA+PiAxOwogICAgYml0cyArPSBtICYgMTsKICAgIHJldHVybiBiaXRzOwogIH0KfQpjb25zdCBMaW5lU3RyaXAgPSAwOwpjb25zdCBMaW5lUGllY2VzID0gMTsKY29uc3QgTm9Db2xvcnMgPSAwOwpjb25zdCBGYWNlQ29sb3JzID0gMTsKY29uc3QgVmVydGV4Q29sb3JzID0gMjsKZnVuY3Rpb24gTWVzaEZhY2VNYXRlcmlhbChtYXRlcmlhbHMpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLk1lc2hGYWNlTWF0ZXJpYWwgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIGFuIEFycmF5IGluc3RlYWQuIik7CiAgcmV0dXJuIG1hdGVyaWFsczsKfQpmdW5jdGlvbiBNdWx0aU1hdGVyaWFsKG1hdGVyaWFscyA9IFtdKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5NdWx0aU1hdGVyaWFsIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBhbiBBcnJheSBpbnN0ZWFkLiIpOwogIG1hdGVyaWFscy5pc011bHRpTWF0ZXJpYWwgPSB0cnVlOwogIG1hdGVyaWFscy5tYXRlcmlhbHMgPSBtYXRlcmlhbHM7CiAgbWF0ZXJpYWxzLmNsb25lID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gbWF0ZXJpYWxzLnNsaWNlKCk7CiAgfTsKICByZXR1cm4gbWF0ZXJpYWxzOwp9CmZ1bmN0aW9uIFBvaW50Q2xvdWQoZ2VvbWV0cnksIG1hdGVyaWFsKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5Qb2ludENsb3VkIGhhcyBiZWVuIHJlbmFtZWQgdG8gVEhSRUUuUG9pbnRzLiIpOwogIHJldHVybiBuZXcgUG9pbnRzKGdlb21ldHJ5LCBtYXRlcmlhbCk7Cn0KZnVuY3Rpb24gUGFydGljbGUobWF0ZXJpYWwpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlBhcnRpY2xlIGhhcyBiZWVuIHJlbmFtZWQgdG8gVEhSRUUuU3ByaXRlLiIpOwogIHJldHVybiBuZXcgU3ByaXRlKG1hdGVyaWFsKTsKfQpmdW5jdGlvbiBQYXJ0aWNsZVN5c3RlbShnZW9tZXRyeSwgbWF0ZXJpYWwpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlBhcnRpY2xlU3lzdGVtIGhhcyBiZWVuIHJlbmFtZWQgdG8gVEhSRUUuUG9pbnRzLiIpOwogIHJldHVybiBuZXcgUG9pbnRzKGdlb21ldHJ5LCBtYXRlcmlhbCk7Cn0KZnVuY3Rpb24gUG9pbnRDbG91ZE1hdGVyaWFsKHBhcmFtZXRlcnMpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlBvaW50Q2xvdWRNYXRlcmlhbCBoYXMgYmVlbiByZW5hbWVkIHRvIFRIUkVFLlBvaW50c01hdGVyaWFsLiIpOwogIHJldHVybiBuZXcgUG9pbnRzTWF0ZXJpYWwocGFyYW1ldGVycyk7Cn0KZnVuY3Rpb24gUGFydGljbGVCYXNpY01hdGVyaWFsKHBhcmFtZXRlcnMpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlBhcnRpY2xlQmFzaWNNYXRlcmlhbCBoYXMgYmVlbiByZW5hbWVkIHRvIFRIUkVFLlBvaW50c01hdGVyaWFsLiIpOwogIHJldHVybiBuZXcgUG9pbnRzTWF0ZXJpYWwocGFyYW1ldGVycyk7Cn0KZnVuY3Rpb24gUGFydGljbGVTeXN0ZW1NYXRlcmlhbChwYXJhbWV0ZXJzKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5QYXJ0aWNsZVN5c3RlbU1hdGVyaWFsIGhhcyBiZWVuIHJlbmFtZWQgdG8gVEhSRUUuUG9pbnRzTWF0ZXJpYWwuIik7CiAgcmV0dXJuIG5ldyBQb2ludHNNYXRlcmlhbChwYXJhbWV0ZXJzKTsKfQpmdW5jdGlvbiBWZXJ0ZXgoeCwgeSwgeikgewogIGNvbnNvbGUud2FybigiVEhSRUUuVmVydGV4IGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBUSFJFRS5WZWN0b3IzIGluc3RlYWQuIik7CiAgcmV0dXJuIG5ldyBWZWN0b3IzKHgsIHksIHopOwp9CmZ1bmN0aW9uIER5bmFtaWNCdWZmZXJBdHRyaWJ1dGUoYXJyYXksIGl0ZW1TaXplKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5EeW5hbWljQnVmZmVyQXR0cmlidXRlIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKCkuc2V0VXNhZ2UoIFRIUkVFLkR5bmFtaWNEcmF3VXNhZ2UgKSBpbnN0ZWFkLiIpOwogIHJldHVybiBuZXcgQnVmZmVyQXR0cmlidXRlKGFycmF5LCBpdGVtU2l6ZSkuc2V0VXNhZ2UoRHluYW1pY0RyYXdVc2FnZSk7Cn0KZnVuY3Rpb24gSW50OEF0dHJpYnV0ZShhcnJheSwgaXRlbVNpemUpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkludDhBdHRyaWJ1dGUgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIG5ldyBUSFJFRS5JbnQ4QnVmZmVyQXR0cmlidXRlKCkgaW5zdGVhZC4iKTsKICByZXR1cm4gbmV3IEludDhCdWZmZXJBdHRyaWJ1dGUoYXJyYXksIGl0ZW1TaXplKTsKfQpmdW5jdGlvbiBVaW50OEF0dHJpYnV0ZShhcnJheSwgaXRlbVNpemUpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlVpbnQ4QXR0cmlidXRlIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBuZXcgVEhSRUUuVWludDhCdWZmZXJBdHRyaWJ1dGUoKSBpbnN0ZWFkLiIpOwogIHJldHVybiBuZXcgVWludDhCdWZmZXJBdHRyaWJ1dGUoYXJyYXksIGl0ZW1TaXplKTsKfQpmdW5jdGlvbiBVaW50OENsYW1wZWRBdHRyaWJ1dGUoYXJyYXksIGl0ZW1TaXplKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5VaW50OENsYW1wZWRBdHRyaWJ1dGUgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIG5ldyBUSFJFRS5VaW50OENsYW1wZWRCdWZmZXJBdHRyaWJ1dGUoKSBpbnN0ZWFkLiIpOwogIHJldHVybiBuZXcgVWludDhDbGFtcGVkQnVmZmVyQXR0cmlidXRlKGFycmF5LCBpdGVtU2l6ZSk7Cn0KZnVuY3Rpb24gSW50MTZBdHRyaWJ1dGUoYXJyYXksIGl0ZW1TaXplKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5JbnQxNkF0dHJpYnV0ZSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgbmV3IFRIUkVFLkludDE2QnVmZmVyQXR0cmlidXRlKCkgaW5zdGVhZC4iKTsKICByZXR1cm4gbmV3IEludDE2QnVmZmVyQXR0cmlidXRlKGFycmF5LCBpdGVtU2l6ZSk7Cn0KZnVuY3Rpb24gVWludDE2QXR0cmlidXRlKGFycmF5LCBpdGVtU2l6ZSkgewogIGNvbnNvbGUud2FybigiVEhSRUUuVWludDE2QXR0cmlidXRlIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBuZXcgVEhSRUUuVWludDE2QnVmZmVyQXR0cmlidXRlKCkgaW5zdGVhZC4iKTsKICByZXR1cm4gbmV3IFVpbnQxNkJ1ZmZlckF0dHJpYnV0ZShhcnJheSwgaXRlbVNpemUpOwp9CmZ1bmN0aW9uIEludDMyQXR0cmlidXRlKGFycmF5LCBpdGVtU2l6ZSkgewogIGNvbnNvbGUud2FybigiVEhSRUUuSW50MzJBdHRyaWJ1dGUgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIG5ldyBUSFJFRS5JbnQzMkJ1ZmZlckF0dHJpYnV0ZSgpIGluc3RlYWQuIik7CiAgcmV0dXJuIG5ldyBJbnQzMkJ1ZmZlckF0dHJpYnV0ZShhcnJheSwgaXRlbVNpemUpOwp9CmZ1bmN0aW9uIFVpbnQzMkF0dHJpYnV0ZShhcnJheSwgaXRlbVNpemUpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlVpbnQzMkF0dHJpYnV0ZSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgbmV3IFRIUkVFLlVpbnQzMkJ1ZmZlckF0dHJpYnV0ZSgpIGluc3RlYWQuIik7CiAgcmV0dXJuIG5ldyBVaW50MzJCdWZmZXJBdHRyaWJ1dGUoYXJyYXksIGl0ZW1TaXplKTsKfQpmdW5jdGlvbiBGbG9hdDMyQXR0cmlidXRlKGFycmF5LCBpdGVtU2l6ZSkgewogIGNvbnNvbGUud2FybigiVEhSRUUuRmxvYXQzMkF0dHJpYnV0ZSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgbmV3IFRIUkVFLkZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUoKSBpbnN0ZWFkLiIpOwogIHJldHVybiBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShhcnJheSwgaXRlbVNpemUpOwp9CmZ1bmN0aW9uIEZsb2F0NjRBdHRyaWJ1dGUoYXJyYXksIGl0ZW1TaXplKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5GbG9hdDY0QXR0cmlidXRlIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBuZXcgVEhSRUUuRmxvYXQ2NEJ1ZmZlckF0dHJpYnV0ZSgpIGluc3RlYWQuIik7CiAgcmV0dXJuIG5ldyBGbG9hdDY0QnVmZmVyQXR0cmlidXRlKGFycmF5LCBpdGVtU2l6ZSk7Cn0KQ3VydmUuY3JlYXRlID0gZnVuY3Rpb24oY29uc3RydWN0LCBnZXRQb2ludCkgewogIGNvbnNvbGUubG9nKCJUSFJFRS5DdXJ2ZS5jcmVhdGUoKSBoYXMgYmVlbiBkZXByZWNhdGVkIik7CiAgY29uc3RydWN0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQ3VydmUucHJvdG90eXBlKTsKICBjb25zdHJ1Y3QucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gY29uc3RydWN0OwogIGNvbnN0cnVjdC5wcm90b3R5cGUuZ2V0UG9pbnQgPSBnZXRQb2ludDsKICByZXR1cm4gY29uc3RydWN0Owp9OwpQYXRoLnByb3RvdHlwZS5mcm9tUG9pbnRzID0gZnVuY3Rpb24ocG9pbnRzKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5QYXRoOiAuZnJvbVBvaW50cygpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLnNldEZyb21Qb2ludHMoKS4iKTsKICByZXR1cm4gdGhpcy5zZXRGcm9tUG9pbnRzKHBvaW50cyk7Cn07CmZ1bmN0aW9uIEF4aXNIZWxwZXIoc2l6ZSkgewogIGNvbnNvbGUud2FybigiVEhSRUUuQXhpc0hlbHBlciBoYXMgYmVlbiByZW5hbWVkIHRvIFRIUkVFLkF4ZXNIZWxwZXIuIik7CiAgcmV0dXJuIG5ldyBBeGVzSGVscGVyKHNpemUpOwp9CmZ1bmN0aW9uIEJvdW5kaW5nQm94SGVscGVyKG9iamVjdCwgY29sb3IpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkJvdW5kaW5nQm94SGVscGVyIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIENyZWF0aW5nIGEgVEhSRUUuQm94SGVscGVyIGluc3RlYWQuIik7CiAgcmV0dXJuIG5ldyBCb3hIZWxwZXIob2JqZWN0LCBjb2xvcik7Cn0KZnVuY3Rpb24gRWRnZXNIZWxwZXIob2JqZWN0LCBoZXgpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkVkZ2VzSGVscGVyIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBUSFJFRS5FZGdlc0dlb21ldHJ5IGluc3RlYWQuIik7CiAgcmV0dXJuIG5ldyBMaW5lU2VnbWVudHMobmV3IEVkZ2VzR2VvbWV0cnkob2JqZWN0Lmdlb21ldHJ5KSwgbmV3IExpbmVCYXNpY01hdGVyaWFsKHsgY29sb3I6IGhleCAhPT0gdm9pZCAwID8gaGV4IDogMTY3NzcyMTUgfSkpOwp9CkdyaWRIZWxwZXIucHJvdG90eXBlLnNldENvbG9ycyA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUuZXJyb3IoIlRIUkVFLkdyaWRIZWxwZXI6IHNldENvbG9ycygpIGhhcyBiZWVuIGRlcHJlY2F0ZWQsIHBhc3MgdGhlbSBpbiB0aGUgY29uc3RydWN0b3IgaW5zdGVhZC4iKTsKfTsKU2tlbGV0b25IZWxwZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUuZXJyb3IoIlRIUkVFLlNrZWxldG9uSGVscGVyOiB1cGRhdGUoKSBubyBsb25nZXIgbmVlZHMgdG8gYmUgY2FsbGVkLiIpOwp9OwpmdW5jdGlvbiBXaXJlZnJhbWVIZWxwZXIob2JqZWN0LCBoZXgpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLldpcmVmcmFtZUhlbHBlciBoYXMgYmVlbiByZW1vdmVkLiBVc2UgVEhSRUUuV2lyZWZyYW1lR2VvbWV0cnkgaW5zdGVhZC4iKTsKICByZXR1cm4gbmV3IExpbmVTZWdtZW50cyhuZXcgV2lyZWZyYW1lR2VvbWV0cnkob2JqZWN0Lmdlb21ldHJ5KSwgbmV3IExpbmVCYXNpY01hdGVyaWFsKHsgY29sb3I6IGhleCAhPT0gdm9pZCAwID8gaGV4IDogMTY3NzcyMTUgfSkpOwp9CkxvYWRlci5wcm90b3R5cGUuZXh0cmFjdFVybEJhc2UgPSBmdW5jdGlvbih1cmwpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkxvYWRlcjogLmV4dHJhY3RVcmxCYXNlKCkgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIFRIUkVFLkxvYWRlclV0aWxzLmV4dHJhY3RVcmxCYXNlKCkgaW5zdGVhZC4iKTsKICByZXR1cm4gTG9hZGVyVXRpbHMuZXh0cmFjdFVybEJhc2UodXJsKTsKfTsKTG9hZGVyLkhhbmRsZXJzID0gewogIGFkZDogZnVuY3Rpb24oKSB7CiAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5Mb2FkZXI6IEhhbmRsZXJzLmFkZCgpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBMb2FkaW5nTWFuYWdlci5hZGRIYW5kbGVyKCkgaW5zdGVhZC4iKTsKICB9LAogIGdldDogZnVuY3Rpb24oKSB7CiAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5Mb2FkZXI6IEhhbmRsZXJzLmdldCgpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBMb2FkaW5nTWFuYWdlci5nZXRIYW5kbGVyKCkgaW5zdGVhZC4iKTsKICB9Cn07CmZ1bmN0aW9uIFhIUkxvYWRlcihtYW5hZ2VyKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5YSFJMb2FkZXIgaGFzIGJlZW4gcmVuYW1lZCB0byBUSFJFRS5GaWxlTG9hZGVyLiIpOwogIHJldHVybiBuZXcgRmlsZUxvYWRlcihtYW5hZ2VyKTsKfQpmdW5jdGlvbiBCaW5hcnlUZXh0dXJlTG9hZGVyKG1hbmFnZXIpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkJpbmFyeVRleHR1cmVMb2FkZXIgaGFzIGJlZW4gcmVuYW1lZCB0byBUSFJFRS5EYXRhVGV4dHVyZUxvYWRlci4iKTsKICByZXR1cm4gbmV3IERhdGFUZXh0dXJlTG9hZGVyKG1hbmFnZXIpOwp9CkJveDIucHJvdG90eXBlLmNlbnRlciA9IGZ1bmN0aW9uKG9wdGlvbmFsVGFyZ2V0KSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5Cb3gyOiAuY2VudGVyKCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuZ2V0Q2VudGVyKCkuIik7CiAgcmV0dXJuIHRoaXMuZ2V0Q2VudGVyKG9wdGlvbmFsVGFyZ2V0KTsKfTsKQm94Mi5wcm90b3R5cGUuZW1wdHkgPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkJveDI6IC5lbXB0eSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmlzRW1wdHkoKS4iKTsKICByZXR1cm4gdGhpcy5pc0VtcHR5KCk7Cn07CkJveDIucHJvdG90eXBlLmlzSW50ZXJzZWN0aW9uQm94ID0gZnVuY3Rpb24oYm94KSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5Cb3gyOiAuaXNJbnRlcnNlY3Rpb25Cb3goKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5pbnRlcnNlY3RzQm94KCkuIik7CiAgcmV0dXJuIHRoaXMuaW50ZXJzZWN0c0JveChib3gpOwp9OwpCb3gyLnByb3RvdHlwZS5zaXplID0gZnVuY3Rpb24ob3B0aW9uYWxUYXJnZXQpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkJveDI6IC5zaXplKCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuZ2V0U2l6ZSgpLiIpOwogIHJldHVybiB0aGlzLmdldFNpemUob3B0aW9uYWxUYXJnZXQpOwp9OwpCb3gzLnByb3RvdHlwZS5jZW50ZXIgPSBmdW5jdGlvbihvcHRpb25hbFRhcmdldCkgewogIGNvbnNvbGUud2FybigiVEhSRUUuQm94MzogLmNlbnRlcigpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmdldENlbnRlcigpLiIpOwogIHJldHVybiB0aGlzLmdldENlbnRlcihvcHRpb25hbFRhcmdldCk7Cn07CkJveDMucHJvdG90eXBlLmVtcHR5ID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5Cb3gzOiAuZW1wdHkoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5pc0VtcHR5KCkuIik7CiAgcmV0dXJuIHRoaXMuaXNFbXB0eSgpOwp9OwpCb3gzLnByb3RvdHlwZS5pc0ludGVyc2VjdGlvbkJveCA9IGZ1bmN0aW9uKGJveCkgewogIGNvbnNvbGUud2FybigiVEhSRUUuQm94MzogLmlzSW50ZXJzZWN0aW9uQm94KCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuaW50ZXJzZWN0c0JveCgpLiIpOwogIHJldHVybiB0aGlzLmludGVyc2VjdHNCb3goYm94KTsKfTsKQm94My5wcm90b3R5cGUuaXNJbnRlcnNlY3Rpb25TcGhlcmUgPSBmdW5jdGlvbihzcGhlcmUpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkJveDM6IC5pc0ludGVyc2VjdGlvblNwaGVyZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmludGVyc2VjdHNTcGhlcmUoKS4iKTsKICByZXR1cm4gdGhpcy5pbnRlcnNlY3RzU3BoZXJlKHNwaGVyZSk7Cn07CkJveDMucHJvdG90eXBlLnNpemUgPSBmdW5jdGlvbihvcHRpb25hbFRhcmdldCkgewogIGNvbnNvbGUud2FybigiVEhSRUUuQm94MzogLnNpemUoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5nZXRTaXplKCkuIik7CiAgcmV0dXJuIHRoaXMuZ2V0U2l6ZShvcHRpb25hbFRhcmdldCk7Cn07ClNwaGVyZS5wcm90b3R5cGUuZW1wdHkgPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlNwaGVyZTogLmVtcHR5KCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuaXNFbXB0eSgpLiIpOwogIHJldHVybiB0aGlzLmlzRW1wdHkoKTsKfTsKRnJ1c3R1bS5wcm90b3R5cGUuc2V0RnJvbU1hdHJpeCA9IGZ1bmN0aW9uKG0pIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkZydXN0dW06IC5zZXRGcm9tTWF0cml4KCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuc2V0RnJvbVByb2plY3Rpb25NYXRyaXgoKS4iKTsKICByZXR1cm4gdGhpcy5zZXRGcm9tUHJvamVjdGlvbk1hdHJpeChtKTsKfTsKTGluZTMucHJvdG90eXBlLmNlbnRlciA9IGZ1bmN0aW9uKG9wdGlvbmFsVGFyZ2V0KSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5MaW5lMzogLmNlbnRlcigpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmdldENlbnRlcigpLiIpOwogIHJldHVybiB0aGlzLmdldENlbnRlcihvcHRpb25hbFRhcmdldCk7Cn07Ck1hdHJpeDMucHJvdG90eXBlLmZsYXR0ZW5Ub0FycmF5T2Zmc2V0ID0gZnVuY3Rpb24oYXJyYXksIG9mZnNldCkgewogIGNvbnNvbGUud2FybigiVEhSRUUuTWF0cml4MzogLmZsYXR0ZW5Ub0FycmF5T2Zmc2V0KCkgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIC50b0FycmF5KCkgaW5zdGVhZC4iKTsKICByZXR1cm4gdGhpcy50b0FycmF5KGFycmF5LCBvZmZzZXQpOwp9OwpNYXRyaXgzLnByb3RvdHlwZS5tdWx0aXBseVZlY3RvcjMgPSBmdW5jdGlvbih2ZWN0b3IpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLk1hdHJpeDM6IC5tdWx0aXBseVZlY3RvcjMoKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgdmVjdG9yLmFwcGx5TWF0cml4MyggbWF0cml4ICkgaW5zdGVhZC4iKTsKICByZXR1cm4gdmVjdG9yLmFwcGx5TWF0cml4Myh0aGlzKTsKfTsKTWF0cml4My5wcm90b3R5cGUubXVsdGlwbHlWZWN0b3IzQXJyYXkgPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLmVycm9yKCJUSFJFRS5NYXRyaXgzOiAubXVsdGlwbHlWZWN0b3IzQXJyYXkoKSBoYXMgYmVlbiByZW1vdmVkLiIpOwp9OwpNYXRyaXgzLnByb3RvdHlwZS5hcHBseVRvQnVmZmVyQXR0cmlidXRlID0gZnVuY3Rpb24oYXR0cmlidXRlKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5NYXRyaXgzOiAuYXBwbHlUb0J1ZmZlckF0dHJpYnV0ZSgpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBhdHRyaWJ1dGUuYXBwbHlNYXRyaXgzKCBtYXRyaXggKSBpbnN0ZWFkLiIpOwogIHJldHVybiBhdHRyaWJ1dGUuYXBwbHlNYXRyaXgzKHRoaXMpOwp9OwpNYXRyaXgzLnByb3RvdHlwZS5hcHBseVRvVmVjdG9yM0FycmF5ID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS5lcnJvcigiVEhSRUUuTWF0cml4MzogLmFwcGx5VG9WZWN0b3IzQXJyYXkoKSBoYXMgYmVlbiByZW1vdmVkLiIpOwp9OwpNYXRyaXgzLnByb3RvdHlwZS5nZXRJbnZlcnNlID0gZnVuY3Rpb24obWF0cml4KSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5NYXRyaXgzOiAuZ2V0SW52ZXJzZSgpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBtYXRyaXhJbnYuY29weSggbWF0cml4ICkuaW52ZXJ0KCk7IGluc3RlYWQuIik7CiAgcmV0dXJuIHRoaXMuY29weShtYXRyaXgpLmludmVydCgpOwp9OwpNYXRyaXg0LnByb3RvdHlwZS5leHRyYWN0UG9zaXRpb24gPSBmdW5jdGlvbihtKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5NYXRyaXg0OiAuZXh0cmFjdFBvc2l0aW9uKCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuY29weVBvc2l0aW9uKCkuIik7CiAgcmV0dXJuIHRoaXMuY29weVBvc2l0aW9uKG0pOwp9OwpNYXRyaXg0LnByb3RvdHlwZS5mbGF0dGVuVG9BcnJheU9mZnNldCA9IGZ1bmN0aW9uKGFycmF5LCBvZmZzZXQpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLk1hdHJpeDQ6IC5mbGF0dGVuVG9BcnJheU9mZnNldCgpIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAudG9BcnJheSgpIGluc3RlYWQuIik7CiAgcmV0dXJuIHRoaXMudG9BcnJheShhcnJheSwgb2Zmc2V0KTsKfTsKTWF0cml4NC5wcm90b3R5cGUuZ2V0UG9zaXRpb24gPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLk1hdHJpeDQ6IC5nZXRQb3NpdGlvbigpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBWZWN0b3IzLnNldEZyb21NYXRyaXhQb3NpdGlvbiggbWF0cml4ICkgaW5zdGVhZC4iKTsKICByZXR1cm4gbmV3IFZlY3RvcjMoKS5zZXRGcm9tTWF0cml4Q29sdW1uKHRoaXMsIDMpOwp9OwpNYXRyaXg0LnByb3RvdHlwZS5zZXRSb3RhdGlvbkZyb21RdWF0ZXJuaW9uID0gZnVuY3Rpb24ocSkgewogIGNvbnNvbGUud2FybigiVEhSRUUuTWF0cml4NDogLnNldFJvdGF0aW9uRnJvbVF1YXRlcm5pb24oKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5tYWtlUm90YXRpb25Gcm9tUXVhdGVybmlvbigpLiIpOwogIHJldHVybiB0aGlzLm1ha2VSb3RhdGlvbkZyb21RdWF0ZXJuaW9uKHEpOwp9OwpNYXRyaXg0LnByb3RvdHlwZS5tdWx0aXBseVRvQXJyYXkgPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLk1hdHJpeDQ6IC5tdWx0aXBseVRvQXJyYXkoKSBoYXMgYmVlbiByZW1vdmVkLiIpOwp9OwpNYXRyaXg0LnByb3RvdHlwZS5tdWx0aXBseVZlY3RvcjMgPSBmdW5jdGlvbih2ZWN0b3IpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLk1hdHJpeDQ6IC5tdWx0aXBseVZlY3RvcjMoKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgdmVjdG9yLmFwcGx5TWF0cml4NCggbWF0cml4ICkgaW5zdGVhZC4iKTsKICByZXR1cm4gdmVjdG9yLmFwcGx5TWF0cml4NCh0aGlzKTsKfTsKTWF0cml4NC5wcm90b3R5cGUubXVsdGlwbHlWZWN0b3I0ID0gZnVuY3Rpb24odmVjdG9yKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5NYXRyaXg0OiAubXVsdGlwbHlWZWN0b3I0KCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIHZlY3Rvci5hcHBseU1hdHJpeDQoIG1hdHJpeCApIGluc3RlYWQuIik7CiAgcmV0dXJuIHZlY3Rvci5hcHBseU1hdHJpeDQodGhpcyk7Cn07Ck1hdHJpeDQucHJvdG90eXBlLm11bHRpcGx5VmVjdG9yM0FycmF5ID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS5lcnJvcigiVEhSRUUuTWF0cml4NDogLm11bHRpcGx5VmVjdG9yM0FycmF5KCkgaGFzIGJlZW4gcmVtb3ZlZC4iKTsKfTsKTWF0cml4NC5wcm90b3R5cGUucm90YXRlQXhpcyA9IGZ1bmN0aW9uKHYpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLk1hdHJpeDQ6IC5yb3RhdGVBeGlzKCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIFZlY3RvcjMudHJhbnNmb3JtRGlyZWN0aW9uKCBtYXRyaXggKSBpbnN0ZWFkLiIpOwogIHYudHJhbnNmb3JtRGlyZWN0aW9uKHRoaXMpOwp9OwpNYXRyaXg0LnByb3RvdHlwZS5jcm9zc1ZlY3RvciA9IGZ1bmN0aW9uKHZlY3RvcikgewogIGNvbnNvbGUud2FybigiVEhSRUUuTWF0cml4NDogLmNyb3NzVmVjdG9yKCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIHZlY3Rvci5hcHBseU1hdHJpeDQoIG1hdHJpeCApIGluc3RlYWQuIik7CiAgcmV0dXJuIHZlY3Rvci5hcHBseU1hdHJpeDQodGhpcyk7Cn07Ck1hdHJpeDQucHJvdG90eXBlLnRyYW5zbGF0ZSA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUuZXJyb3IoIlRIUkVFLk1hdHJpeDQ6IC50cmFuc2xhdGUoKSBoYXMgYmVlbiByZW1vdmVkLiIpOwp9OwpNYXRyaXg0LnByb3RvdHlwZS5yb3RhdGVYID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS5lcnJvcigiVEhSRUUuTWF0cml4NDogLnJvdGF0ZVgoKSBoYXMgYmVlbiByZW1vdmVkLiIpOwp9OwpNYXRyaXg0LnByb3RvdHlwZS5yb3RhdGVZID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS5lcnJvcigiVEhSRUUuTWF0cml4NDogLnJvdGF0ZVkoKSBoYXMgYmVlbiByZW1vdmVkLiIpOwp9OwpNYXRyaXg0LnByb3RvdHlwZS5yb3RhdGVaID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS5lcnJvcigiVEhSRUUuTWF0cml4NDogLnJvdGF0ZVooKSBoYXMgYmVlbiByZW1vdmVkLiIpOwp9OwpNYXRyaXg0LnByb3RvdHlwZS5yb3RhdGVCeUF4aXMgPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLmVycm9yKCJUSFJFRS5NYXRyaXg0OiAucm90YXRlQnlBeGlzKCkgaGFzIGJlZW4gcmVtb3ZlZC4iKTsKfTsKTWF0cml4NC5wcm90b3R5cGUuYXBwbHlUb0J1ZmZlckF0dHJpYnV0ZSA9IGZ1bmN0aW9uKGF0dHJpYnV0ZSkgewogIGNvbnNvbGUud2FybigiVEhSRUUuTWF0cml4NDogLmFwcGx5VG9CdWZmZXJBdHRyaWJ1dGUoKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgYXR0cmlidXRlLmFwcGx5TWF0cml4NCggbWF0cml4ICkgaW5zdGVhZC4iKTsKICByZXR1cm4gYXR0cmlidXRlLmFwcGx5TWF0cml4NCh0aGlzKTsKfTsKTWF0cml4NC5wcm90b3R5cGUuYXBwbHlUb1ZlY3RvcjNBcnJheSA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUuZXJyb3IoIlRIUkVFLk1hdHJpeDQ6IC5hcHBseVRvVmVjdG9yM0FycmF5KCkgaGFzIGJlZW4gcmVtb3ZlZC4iKTsKfTsKTWF0cml4NC5wcm90b3R5cGUubWFrZUZydXN0dW0gPSBmdW5jdGlvbihsZWZ0LCByaWdodCwgYm90dG9tLCB0b3AsIG5lYXIsIGZhcikgewogIGNvbnNvbGUud2FybigiVEhSRUUuTWF0cml4NDogLm1ha2VGcnVzdHVtKCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIC5tYWtlUGVyc3BlY3RpdmUoIGxlZnQsIHJpZ2h0LCB0b3AsIGJvdHRvbSwgbmVhciwgZmFyICkgaW5zdGVhZC4iKTsKICByZXR1cm4gdGhpcy5tYWtlUGVyc3BlY3RpdmUobGVmdCwgcmlnaHQsIHRvcCwgYm90dG9tLCBuZWFyLCBmYXIpOwp9OwpNYXRyaXg0LnByb3RvdHlwZS5nZXRJbnZlcnNlID0gZnVuY3Rpb24obWF0cml4KSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5NYXRyaXg0OiAuZ2V0SW52ZXJzZSgpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBtYXRyaXhJbnYuY29weSggbWF0cml4ICkuaW52ZXJ0KCk7IGluc3RlYWQuIik7CiAgcmV0dXJuIHRoaXMuY29weShtYXRyaXgpLmludmVydCgpOwp9OwpQbGFuZS5wcm90b3R5cGUuaXNJbnRlcnNlY3Rpb25MaW5lID0gZnVuY3Rpb24obGluZSkgewogIGNvbnNvbGUud2FybigiVEhSRUUuUGxhbmU6IC5pc0ludGVyc2VjdGlvbkxpbmUoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5pbnRlcnNlY3RzTGluZSgpLiIpOwogIHJldHVybiB0aGlzLmludGVyc2VjdHNMaW5lKGxpbmUpOwp9OwpRdWF0ZXJuaW9uLnByb3RvdHlwZS5tdWx0aXBseVZlY3RvcjMgPSBmdW5jdGlvbih2ZWN0b3IpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlF1YXRlcm5pb246IC5tdWx0aXBseVZlY3RvcjMoKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgaXMgbm93IHZlY3Rvci5hcHBseVF1YXRlcm5pb24oIHF1YXRlcm5pb24gKSBpbnN0ZWFkLiIpOwogIHJldHVybiB2ZWN0b3IuYXBwbHlRdWF0ZXJuaW9uKHRoaXMpOwp9OwpRdWF0ZXJuaW9uLnByb3RvdHlwZS5pbnZlcnNlID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5RdWF0ZXJuaW9uOiAuaW52ZXJzZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gaW52ZXJ0KCkuIik7CiAgcmV0dXJuIHRoaXMuaW52ZXJ0KCk7Cn07ClJheS5wcm90b3R5cGUuaXNJbnRlcnNlY3Rpb25Cb3ggPSBmdW5jdGlvbihib3gpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlJheTogLmlzSW50ZXJzZWN0aW9uQm94KCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuaW50ZXJzZWN0c0JveCgpLiIpOwogIHJldHVybiB0aGlzLmludGVyc2VjdHNCb3goYm94KTsKfTsKUmF5LnByb3RvdHlwZS5pc0ludGVyc2VjdGlvblBsYW5lID0gZnVuY3Rpb24ocGxhbmUpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlJheTogLmlzSW50ZXJzZWN0aW9uUGxhbmUoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5pbnRlcnNlY3RzUGxhbmUoKS4iKTsKICByZXR1cm4gdGhpcy5pbnRlcnNlY3RzUGxhbmUocGxhbmUpOwp9OwpSYXkucHJvdG90eXBlLmlzSW50ZXJzZWN0aW9uU3BoZXJlID0gZnVuY3Rpb24oc3BoZXJlKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5SYXk6IC5pc0ludGVyc2VjdGlvblNwaGVyZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmludGVyc2VjdHNTcGhlcmUoKS4iKTsKICByZXR1cm4gdGhpcy5pbnRlcnNlY3RzU3BoZXJlKHNwaGVyZSk7Cn07ClRyaWFuZ2xlLnByb3RvdHlwZS5hcmVhID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5UcmlhbmdsZTogLmFyZWEoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5nZXRBcmVhKCkuIik7CiAgcmV0dXJuIHRoaXMuZ2V0QXJlYSgpOwp9OwpUcmlhbmdsZS5wcm90b3R5cGUuYmFyeWNvb3JkRnJvbVBvaW50ID0gZnVuY3Rpb24ocG9pbnQsIHRhcmdldCkgewogIGNvbnNvbGUud2FybigiVEhSRUUuVHJpYW5nbGU6IC5iYXJ5Y29vcmRGcm9tUG9pbnQoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5nZXRCYXJ5Y29vcmQoKS4iKTsKICByZXR1cm4gdGhpcy5nZXRCYXJ5Y29vcmQocG9pbnQsIHRhcmdldCk7Cn07ClRyaWFuZ2xlLnByb3RvdHlwZS5taWRwb2ludCA9IGZ1bmN0aW9uKHRhcmdldCkgewogIGNvbnNvbGUud2FybigiVEhSRUUuVHJpYW5nbGU6IC5taWRwb2ludCgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmdldE1pZHBvaW50KCkuIik7CiAgcmV0dXJuIHRoaXMuZ2V0TWlkcG9pbnQodGFyZ2V0KTsKfTsKVHJpYW5nbGUucHJvdG90eXBlbm9ybWFsID0gZnVuY3Rpb24odGFyZ2V0KSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5UcmlhbmdsZTogLm5vcm1hbCgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmdldE5vcm1hbCgpLiIpOwogIHJldHVybiB0aGlzLmdldE5vcm1hbCh0YXJnZXQpOwp9OwpUcmlhbmdsZS5wcm90b3R5cGUucGxhbmUgPSBmdW5jdGlvbih0YXJnZXQpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlRyaWFuZ2xlOiAucGxhbmUoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5nZXRQbGFuZSgpLiIpOwogIHJldHVybiB0aGlzLmdldFBsYW5lKHRhcmdldCk7Cn07ClRyaWFuZ2xlLmJhcnljb29yZEZyb21Qb2ludCA9IGZ1bmN0aW9uKHBvaW50LCBhLCBiLCBjLCB0YXJnZXQpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlRyaWFuZ2xlOiAuYmFyeWNvb3JkRnJvbVBvaW50KCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuZ2V0QmFyeWNvb3JkKCkuIik7CiAgcmV0dXJuIFRyaWFuZ2xlLmdldEJhcnljb29yZChwb2ludCwgYSwgYiwgYywgdGFyZ2V0KTsKfTsKVHJpYW5nbGUubm9ybWFsID0gZnVuY3Rpb24oYSwgYiwgYywgdGFyZ2V0KSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5UcmlhbmdsZTogLm5vcm1hbCgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmdldE5vcm1hbCgpLiIpOwogIHJldHVybiBUcmlhbmdsZS5nZXROb3JtYWwoYSwgYiwgYywgdGFyZ2V0KTsKfTsKU2hhcGUucHJvdG90eXBlLmV4dHJhY3RBbGxQb2ludHMgPSBmdW5jdGlvbihkaXZpc2lvbnMpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlNoYXBlOiAuZXh0cmFjdEFsbFBvaW50cygpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSAuZXh0cmFjdFBvaW50cygpIGluc3RlYWQuIik7CiAgcmV0dXJuIHRoaXMuZXh0cmFjdFBvaW50cyhkaXZpc2lvbnMpOwp9OwpTaGFwZS5wcm90b3R5cGUuZXh0cnVkZSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlNoYXBlOiAuZXh0cnVkZSgpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBFeHRydWRlR2VvbWV0cnkoKSBpbnN0ZWFkLiIpOwogIHJldHVybiBuZXcgRXh0cnVkZUdlb21ldHJ5KHRoaXMsIG9wdGlvbnMpOwp9OwpTaGFwZS5wcm90b3R5cGUubWFrZUdlb21ldHJ5ID0gZnVuY3Rpb24ob3B0aW9ucykgewogIGNvbnNvbGUud2FybigiVEhSRUUuU2hhcGU6IC5tYWtlR2VvbWV0cnkoKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgU2hhcGVHZW9tZXRyeSgpIGluc3RlYWQuIik7CiAgcmV0dXJuIG5ldyBTaGFwZUdlb21ldHJ5KHRoaXMsIG9wdGlvbnMpOwp9OwpWZWN0b3IyLnByb3RvdHlwZS5mcm9tQXR0cmlidXRlID0gZnVuY3Rpb24oYXR0cmlidXRlLCBpbmRleCwgb2Zmc2V0KSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5WZWN0b3IyOiAuZnJvbUF0dHJpYnV0ZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmZyb21CdWZmZXJBdHRyaWJ1dGUoKS4iKTsKICByZXR1cm4gdGhpcy5mcm9tQnVmZmVyQXR0cmlidXRlKGF0dHJpYnV0ZSwgaW5kZXgsIG9mZnNldCk7Cn07ClZlY3RvcjIucHJvdG90eXBlLmRpc3RhbmNlVG9NYW5oYXR0YW4gPSBmdW5jdGlvbih2KSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5WZWN0b3IyOiAuZGlzdGFuY2VUb01hbmhhdHRhbigpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLm1hbmhhdHRhbkRpc3RhbmNlVG8oKS4iKTsKICByZXR1cm4gdGhpcy5tYW5oYXR0YW5EaXN0YW5jZVRvKHYpOwp9OwpWZWN0b3IyLnByb3RvdHlwZS5sZW5ndGhNYW5oYXR0YW4gPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlZlY3RvcjI6IC5sZW5ndGhNYW5oYXR0YW4oKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5tYW5oYXR0YW5MZW5ndGgoKS4iKTsKICByZXR1cm4gdGhpcy5tYW5oYXR0YW5MZW5ndGgoKTsKfTsKVmVjdG9yMy5wcm90b3R5cGUuc2V0RXVsZXJGcm9tUm90YXRpb25NYXRyaXggPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLmVycm9yKCJUSFJFRS5WZWN0b3IzOiAuc2V0RXVsZXJGcm9tUm90YXRpb25NYXRyaXgoKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgRXVsZXIuc2V0RnJvbVJvdGF0aW9uTWF0cml4KCkgaW5zdGVhZC4iKTsKfTsKVmVjdG9yMy5wcm90b3R5cGUuc2V0RXVsZXJGcm9tUXVhdGVybmlvbiA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUuZXJyb3IoIlRIUkVFLlZlY3RvcjM6IC5zZXRFdWxlckZyb21RdWF0ZXJuaW9uKCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIEV1bGVyLnNldEZyb21RdWF0ZXJuaW9uKCkgaW5zdGVhZC4iKTsKfTsKVmVjdG9yMy5wcm90b3R5cGUuZ2V0UG9zaXRpb25Gcm9tTWF0cml4ID0gZnVuY3Rpb24obSkgewogIGNvbnNvbGUud2FybigiVEhSRUUuVmVjdG9yMzogLmdldFBvc2l0aW9uRnJvbU1hdHJpeCgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLnNldEZyb21NYXRyaXhQb3NpdGlvbigpLiIpOwogIHJldHVybiB0aGlzLnNldEZyb21NYXRyaXhQb3NpdGlvbihtKTsKfTsKVmVjdG9yMy5wcm90b3R5cGUuZ2V0U2NhbGVGcm9tTWF0cml4ID0gZnVuY3Rpb24obSkgewogIGNvbnNvbGUud2FybigiVEhSRUUuVmVjdG9yMzogLmdldFNjYWxlRnJvbU1hdHJpeCgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLnNldEZyb21NYXRyaXhTY2FsZSgpLiIpOwogIHJldHVybiB0aGlzLnNldEZyb21NYXRyaXhTY2FsZShtKTsKfTsKVmVjdG9yMy5wcm90b3R5cGUuZ2V0Q29sdW1uRnJvbU1hdHJpeCA9IGZ1bmN0aW9uKGluZGV4LCBtYXRyaXgpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlZlY3RvcjM6IC5nZXRDb2x1bW5Gcm9tTWF0cml4KCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuc2V0RnJvbU1hdHJpeENvbHVtbigpLiIpOwogIHJldHVybiB0aGlzLnNldEZyb21NYXRyaXhDb2x1bW4obWF0cml4LCBpbmRleCk7Cn07ClZlY3RvcjMucHJvdG90eXBlLmFwcGx5UHJvamVjdGlvbiA9IGZ1bmN0aW9uKG0pIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlZlY3RvcjM6IC5hcHBseVByb2plY3Rpb24oKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgLmFwcGx5TWF0cml4NCggbSApIGluc3RlYWQuIik7CiAgcmV0dXJuIHRoaXMuYXBwbHlNYXRyaXg0KG0pOwp9OwpWZWN0b3IzLnByb3RvdHlwZS5mcm9tQXR0cmlidXRlID0gZnVuY3Rpb24oYXR0cmlidXRlLCBpbmRleCwgb2Zmc2V0KSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5WZWN0b3IzOiAuZnJvbUF0dHJpYnV0ZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmZyb21CdWZmZXJBdHRyaWJ1dGUoKS4iKTsKICByZXR1cm4gdGhpcy5mcm9tQnVmZmVyQXR0cmlidXRlKGF0dHJpYnV0ZSwgaW5kZXgsIG9mZnNldCk7Cn07ClZlY3RvcjMucHJvdG90eXBlLmRpc3RhbmNlVG9NYW5oYXR0YW4gPSBmdW5jdGlvbih2KSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5WZWN0b3IzOiAuZGlzdGFuY2VUb01hbmhhdHRhbigpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLm1hbmhhdHRhbkRpc3RhbmNlVG8oKS4iKTsKICByZXR1cm4gdGhpcy5tYW5oYXR0YW5EaXN0YW5jZVRvKHYpOwp9OwpWZWN0b3IzLnByb3RvdHlwZS5sZW5ndGhNYW5oYXR0YW4gPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlZlY3RvcjM6IC5sZW5ndGhNYW5oYXR0YW4oKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5tYW5oYXR0YW5MZW5ndGgoKS4iKTsKICByZXR1cm4gdGhpcy5tYW5oYXR0YW5MZW5ndGgoKTsKfTsKVmVjdG9yNC5wcm90b3R5cGUuZnJvbUF0dHJpYnV0ZSA9IGZ1bmN0aW9uKGF0dHJpYnV0ZSwgaW5kZXgsIG9mZnNldCkgewogIGNvbnNvbGUud2FybigiVEhSRUUuVmVjdG9yNDogLmZyb21BdHRyaWJ1dGUoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5mcm9tQnVmZmVyQXR0cmlidXRlKCkuIik7CiAgcmV0dXJuIHRoaXMuZnJvbUJ1ZmZlckF0dHJpYnV0ZShhdHRyaWJ1dGUsIGluZGV4LCBvZmZzZXQpOwp9OwpWZWN0b3I0LnByb3RvdHlwZS5sZW5ndGhNYW5oYXR0YW4gPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLlZlY3RvcjQ6IC5sZW5ndGhNYW5oYXR0YW4oKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5tYW5oYXR0YW5MZW5ndGgoKS4iKTsKICByZXR1cm4gdGhpcy5tYW5oYXR0YW5MZW5ndGgoKTsKfTsKT2JqZWN0M0QucHJvdG90eXBlLmdldENoaWxkQnlOYW1lID0gZnVuY3Rpb24obmFtZSkgewogIGNvbnNvbGUud2FybigiVEhSRUUuT2JqZWN0M0Q6IC5nZXRDaGlsZEJ5TmFtZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmdldE9iamVjdEJ5TmFtZSgpLiIpOwogIHJldHVybiB0aGlzLmdldE9iamVjdEJ5TmFtZShuYW1lKTsKfTsKT2JqZWN0M0QucHJvdG90eXBlLnJlbmRlckRlcHRoID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5PYmplY3QzRDogLnJlbmRlckRlcHRoIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSAucmVuZGVyT3JkZXIsIGluc3RlYWQuIik7Cn07Ck9iamVjdDNELnByb3RvdHlwZS50cmFuc2xhdGUgPSBmdW5jdGlvbihkaXN0YW5jZSwgYXhpcykgewogIGNvbnNvbGUud2FybigiVEhSRUUuT2JqZWN0M0Q6IC50cmFuc2xhdGUoKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgLnRyYW5zbGF0ZU9uQXhpcyggYXhpcywgZGlzdGFuY2UgKSBpbnN0ZWFkLiIpOwogIHJldHVybiB0aGlzLnRyYW5zbGF0ZU9uQXhpcyhheGlzLCBkaXN0YW5jZSk7Cn07Ck9iamVjdDNELnByb3RvdHlwZS5nZXRXb3JsZFJvdGF0aW9uID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS5lcnJvcigiVEhSRUUuT2JqZWN0M0Q6IC5nZXRXb3JsZFJvdGF0aW9uKCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIFRIUkVFLk9iamVjdDNELmdldFdvcmxkUXVhdGVybmlvbiggdGFyZ2V0ICkgaW5zdGVhZC4iKTsKfTsKT2JqZWN0M0QucHJvdG90eXBlLmFwcGx5TWF0cml4ID0gZnVuY3Rpb24obWF0cml4KSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5PYmplY3QzRDogLmFwcGx5TWF0cml4KCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuYXBwbHlNYXRyaXg0KCkuIik7CiAgcmV0dXJuIHRoaXMuYXBwbHlNYXRyaXg0KG1hdHJpeCk7Cn07Ck9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKE9iamVjdDNELnByb3RvdHlwZSwgewogIGV1bGVyT3JkZXI6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuT2JqZWN0M0Q6IC5ldWxlck9yZGVyIGlzIG5vdyAucm90YXRpb24ub3JkZXIuIik7CiAgICAgIHJldHVybiB0aGlzLnJvdGF0aW9uLm9yZGVyOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5PYmplY3QzRDogLmV1bGVyT3JkZXIgaXMgbm93IC5yb3RhdGlvbi5vcmRlci4iKTsKICAgICAgdGhpcy5yb3RhdGlvbi5vcmRlciA9IHZhbHVlOwogICAgfQogIH0sCiAgdXNlUXVhdGVybmlvbjogewogICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5PYmplY3QzRDogLnVzZVF1YXRlcm5pb24gaGFzIGJlZW4gcmVtb3ZlZC4gVGhlIGxpYnJhcnkgbm93IHVzZXMgcXVhdGVybmlvbnMgYnkgZGVmYXVsdC4iKTsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLk9iamVjdDNEOiAudXNlUXVhdGVybmlvbiBoYXMgYmVlbiByZW1vdmVkLiBUaGUgbGlicmFyeSBub3cgdXNlcyBxdWF0ZXJuaW9ucyBieSBkZWZhdWx0LiIpOwogICAgfQogIH0KfSk7Ck1lc2gucHJvdG90eXBlLnNldERyYXdNb2RlID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS5lcnJvcigiVEhSRUUuTWVzaDogLnNldERyYXdNb2RlKCkgaGFzIGJlZW4gcmVtb3ZlZC4gVGhlIHJlbmRlcmVyIG5vdyBhbHdheXMgYXNzdW1lcyBUSFJFRS5UcmlhbmdsZXNEcmF3TW9kZS4gVHJhbnNmb3JtIHlvdXIgZ2VvbWV0cnkgdmlhIEJ1ZmZlckdlb21ldHJ5VXRpbHMudG9UcmlhbmdsZXNEcmF3TW9kZSgpIGlmIG5lY2Vzc2FyeS4iKTsKfTsKT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoTWVzaC5wcm90b3R5cGUsIHsKICBkcmF3TW9kZTogewogICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgY29uc29sZS5lcnJvcigiVEhSRUUuTWVzaDogLmRyYXdNb2RlIGhhcyBiZWVuIHJlbW92ZWQuIFRoZSByZW5kZXJlciBub3cgYWx3YXlzIGFzc3VtZXMgVEhSRUUuVHJpYW5nbGVzRHJhd01vZGUuIik7CiAgICAgIHJldHVybiBUcmlhbmdsZXNEcmF3TW9kZTsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5NZXNoOiAuZHJhd01vZGUgaGFzIGJlZW4gcmVtb3ZlZC4gVGhlIHJlbmRlcmVyIG5vdyBhbHdheXMgYXNzdW1lcyBUSFJFRS5UcmlhbmdsZXNEcmF3TW9kZS4gVHJhbnNmb3JtIHlvdXIgZ2VvbWV0cnkgdmlhIEJ1ZmZlckdlb21ldHJ5VXRpbHMudG9UcmlhbmdsZXNEcmF3TW9kZSgpIGlmIG5lY2Vzc2FyeS4iKTsKICAgIH0KICB9Cn0pOwpTa2lubmVkTWVzaC5wcm90b3R5cGUuaW5pdEJvbmVzID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS5lcnJvcigiVEhSRUUuU2tpbm5lZE1lc2g6IGluaXRCb25lcygpIGhhcyBiZWVuIHJlbW92ZWQuIik7Cn07ClBlcnNwZWN0aXZlQ2FtZXJhLnByb3RvdHlwZS5zZXRMZW5zID0gZnVuY3Rpb24oZm9jYWxMZW5ndGgsIGZpbG1HYXVnZSkgewogIGNvbnNvbGUud2FybigiVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEuc2V0TGVucyBpcyBkZXByZWNhdGVkLiBVc2UgLnNldEZvY2FsTGVuZ3RoIGFuZCAuZmlsbUdhdWdlIGZvciBhIHBob3RvZ3JhcGhpYyBzZXR1cC4iKTsKICBpZiAoZmlsbUdhdWdlICE9PSB2b2lkIDApCiAgICB0aGlzLmZpbG1HYXVnZSA9IGZpbG1HYXVnZTsKICB0aGlzLnNldEZvY2FsTGVuZ3RoKGZvY2FsTGVuZ3RoKTsKfTsKT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoTGlnaHQucHJvdG90eXBlLCB7CiAgb25seVNoYWRvdzogewogICAgc2V0OiBmdW5jdGlvbigpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5MaWdodDogLm9ubHlTaGFkb3cgaGFzIGJlZW4gcmVtb3ZlZC4iKTsKICAgIH0KICB9LAogIHNoYWRvd0NhbWVyYUZvdjogewogICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkxpZ2h0OiAuc2hhZG93Q2FtZXJhRm92IGlzIG5vdyAuc2hhZG93LmNhbWVyYS5mb3YuIik7CiAgICAgIHRoaXMuc2hhZG93LmNhbWVyYS5mb3YgPSB2YWx1ZTsKICAgIH0KICB9LAogIHNoYWRvd0NhbWVyYUxlZnQ6IHsKICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5MaWdodDogLnNoYWRvd0NhbWVyYUxlZnQgaXMgbm93IC5zaGFkb3cuY2FtZXJhLmxlZnQuIik7CiAgICAgIHRoaXMuc2hhZG93LmNhbWVyYS5sZWZ0ID0gdmFsdWU7CiAgICB9CiAgfSwKICBzaGFkb3dDYW1lcmFSaWdodDogewogICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkxpZ2h0OiAuc2hhZG93Q2FtZXJhUmlnaHQgaXMgbm93IC5zaGFkb3cuY2FtZXJhLnJpZ2h0LiIpOwogICAgICB0aGlzLnNoYWRvdy5jYW1lcmEucmlnaHQgPSB2YWx1ZTsKICAgIH0KICB9LAogIHNoYWRvd0NhbWVyYVRvcDogewogICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkxpZ2h0OiAuc2hhZG93Q2FtZXJhVG9wIGlzIG5vdyAuc2hhZG93LmNhbWVyYS50b3AuIik7CiAgICAgIHRoaXMuc2hhZG93LmNhbWVyYS50b3AgPSB2YWx1ZTsKICAgIH0KICB9LAogIHNoYWRvd0NhbWVyYUJvdHRvbTogewogICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkxpZ2h0OiAuc2hhZG93Q2FtZXJhQm90dG9tIGlzIG5vdyAuc2hhZG93LmNhbWVyYS5ib3R0b20uIik7CiAgICAgIHRoaXMuc2hhZG93LmNhbWVyYS5ib3R0b20gPSB2YWx1ZTsKICAgIH0KICB9LAogIHNoYWRvd0NhbWVyYU5lYXI6IHsKICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5MaWdodDogLnNoYWRvd0NhbWVyYU5lYXIgaXMgbm93IC5zaGFkb3cuY2FtZXJhLm5lYXIuIik7CiAgICAgIHRoaXMuc2hhZG93LmNhbWVyYS5uZWFyID0gdmFsdWU7CiAgICB9CiAgfSwKICBzaGFkb3dDYW1lcmFGYXI6IHsKICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5MaWdodDogLnNoYWRvd0NhbWVyYUZhciBpcyBub3cgLnNoYWRvdy5jYW1lcmEuZmFyLiIpOwogICAgICB0aGlzLnNoYWRvdy5jYW1lcmEuZmFyID0gdmFsdWU7CiAgICB9CiAgfSwKICBzaGFkb3dDYW1lcmFWaXNpYmxlOiB7CiAgICBzZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkxpZ2h0OiAuc2hhZG93Q2FtZXJhVmlzaWJsZSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgbmV3IFRIUkVFLkNhbWVyYUhlbHBlciggbGlnaHQuc2hhZG93LmNhbWVyYSApIGluc3RlYWQuIik7CiAgICB9CiAgfSwKICBzaGFkb3dCaWFzOiB7CiAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuTGlnaHQ6IC5zaGFkb3dCaWFzIGlzIG5vdyAuc2hhZG93LmJpYXMuIik7CiAgICAgIHRoaXMuc2hhZG93LmJpYXMgPSB2YWx1ZTsKICAgIH0KICB9LAogIHNoYWRvd0RhcmtuZXNzOiB7CiAgICBzZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkxpZ2h0OiAuc2hhZG93RGFya25lc3MgaGFzIGJlZW4gcmVtb3ZlZC4iKTsKICAgIH0KICB9LAogIHNoYWRvd01hcFdpZHRoOiB7CiAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuTGlnaHQ6IC5zaGFkb3dNYXBXaWR0aCBpcyBub3cgLnNoYWRvdy5tYXBTaXplLndpZHRoLiIpOwogICAgICB0aGlzLnNoYWRvdy5tYXBTaXplLndpZHRoID0gdmFsdWU7CiAgICB9CiAgfSwKICBzaGFkb3dNYXBIZWlnaHQ6IHsKICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5MaWdodDogLnNoYWRvd01hcEhlaWdodCBpcyBub3cgLnNoYWRvdy5tYXBTaXplLmhlaWdodC4iKTsKICAgICAgdGhpcy5zaGFkb3cubWFwU2l6ZS5oZWlnaHQgPSB2YWx1ZTsKICAgIH0KICB9Cn0pOwpPYmplY3QuZGVmaW5lUHJvcGVydGllcyhCdWZmZXJBdHRyaWJ1dGUucHJvdG90eXBlLCB7CiAgbGVuZ3RoOiB7CiAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLkJ1ZmZlckF0dHJpYnV0ZTogLmxlbmd0aCBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLmNvdW50IGluc3RlYWQuIik7CiAgICAgIHJldHVybiB0aGlzLmFycmF5Lmxlbmd0aDsKICAgIH0KICB9LAogIGR5bmFtaWM6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuQnVmZmVyQXR0cmlidXRlOiAuZHluYW1pYyBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLnVzYWdlIGluc3RlYWQuIik7CiAgICAgIHJldHVybiB0aGlzLnVzYWdlID09PSBEeW5hbWljRHJhd1VzYWdlOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuQnVmZmVyQXR0cmlidXRlOiAuZHluYW1pYyBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLnVzYWdlIGluc3RlYWQuIik7CiAgICAgIHRoaXMuc2V0VXNhZ2UoRHluYW1pY0RyYXdVc2FnZSk7CiAgICB9CiAgfQp9KTsKQnVmZmVyQXR0cmlidXRlLnByb3RvdHlwZS5zZXREeW5hbWljID0gZnVuY3Rpb24odmFsdWUpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkJ1ZmZlckF0dHJpYnV0ZTogLnNldER5bmFtaWMoKSBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLnNldFVzYWdlKCkgaW5zdGVhZC4iKTsKICB0aGlzLnNldFVzYWdlKHZhbHVlID09PSB0cnVlID8gRHluYW1pY0RyYXdVc2FnZSA6IFN0YXRpY0RyYXdVc2FnZSk7CiAgcmV0dXJuIHRoaXM7Cn07CkJ1ZmZlckF0dHJpYnV0ZS5wcm90b3R5cGUuY29weUluZGljZXNBcnJheSA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUuZXJyb3IoIlRIUkVFLkJ1ZmZlckF0dHJpYnV0ZTogLmNvcHlJbmRpY2VzQXJyYXkoKSBoYXMgYmVlbiByZW1vdmVkLiIpOwp9LCBCdWZmZXJBdHRyaWJ1dGUucHJvdG90eXBlLnNldEFycmF5ID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS5lcnJvcigiVEhSRUUuQnVmZmVyQXR0cmlidXRlOiAuc2V0QXJyYXkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIEJ1ZmZlckdlb21ldHJ5IC5zZXRBdHRyaWJ1dGUgdG8gcmVwbGFjZS9yZXNpemUgYXR0cmlidXRlIGJ1ZmZlcnMiKTsKfTsKQnVmZmVyR2VvbWV0cnkucHJvdG90eXBlLmFkZEluZGV4ID0gZnVuY3Rpb24oaW5kZXgpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkJ1ZmZlckdlb21ldHJ5OiAuYWRkSW5kZXgoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5zZXRJbmRleCgpLiIpOwogIHRoaXMuc2V0SW5kZXgoaW5kZXgpOwp9OwpCdWZmZXJHZW9tZXRyeS5wcm90b3R5cGUuYWRkQXR0cmlidXRlID0gZnVuY3Rpb24obmFtZSwgYXR0cmlidXRlKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5CdWZmZXJHZW9tZXRyeTogLmFkZEF0dHJpYnV0ZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLnNldEF0dHJpYnV0ZSgpLiIpOwogIGlmICghKGF0dHJpYnV0ZSAmJiBhdHRyaWJ1dGUuaXNCdWZmZXJBdHRyaWJ1dGUpICYmICEoYXR0cmlidXRlICYmIGF0dHJpYnV0ZS5pc0ludGVybGVhdmVkQnVmZmVyQXR0cmlidXRlKSkgewogICAgY29uc29sZS53YXJuKCJUSFJFRS5CdWZmZXJHZW9tZXRyeTogLmFkZEF0dHJpYnV0ZSgpIG5vdyBleHBlY3RzICggbmFtZSwgYXR0cmlidXRlICkuIik7CiAgICByZXR1cm4gdGhpcy5zZXRBdHRyaWJ1dGUobmFtZSwgbmV3IEJ1ZmZlckF0dHJpYnV0ZShhcmd1bWVudHNbMV0sIGFyZ3VtZW50c1syXSkpOwogIH0KICBpZiAobmFtZSA9PT0gImluZGV4IikgewogICAgY29uc29sZS53YXJuKCJUSFJFRS5CdWZmZXJHZW9tZXRyeS5hZGRBdHRyaWJ1dGU6IFVzZSAuc2V0SW5kZXgoKSBmb3IgaW5kZXggYXR0cmlidXRlLiIpOwogICAgdGhpcy5zZXRJbmRleChhdHRyaWJ1dGUpOwogICAgcmV0dXJuIHRoaXM7CiAgfQogIHJldHVybiB0aGlzLnNldEF0dHJpYnV0ZShuYW1lLCBhdHRyaWJ1dGUpOwp9OwpCdWZmZXJHZW9tZXRyeS5wcm90b3R5cGUuYWRkRHJhd0NhbGwgPSBmdW5jdGlvbihzdGFydCwgY291bnQsIGluZGV4T2Zmc2V0KSB7CiAgaWYgKGluZGV4T2Zmc2V0ICE9PSB2b2lkIDApIHsKICAgIGNvbnNvbGUud2FybigiVEhSRUUuQnVmZmVyR2VvbWV0cnk6IC5hZGREcmF3Q2FsbCgpIG5vIGxvbmdlciBzdXBwb3J0cyBpbmRleE9mZnNldC4iKTsKICB9CiAgY29uc29sZS53YXJuKCJUSFJFRS5CdWZmZXJHZW9tZXRyeTogLmFkZERyYXdDYWxsKCkgaXMgbm93IC5hZGRHcm91cCgpLiIpOwogIHRoaXMuYWRkR3JvdXAoc3RhcnQsIGNvdW50KTsKfTsKQnVmZmVyR2VvbWV0cnkucHJvdG90eXBlLmNsZWFyRHJhd0NhbGxzID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5CdWZmZXJHZW9tZXRyeTogLmNsZWFyRHJhd0NhbGxzKCkgaXMgbm93IC5jbGVhckdyb3VwcygpLiIpOwogIHRoaXMuY2xlYXJHcm91cHMoKTsKfTsKQnVmZmVyR2VvbWV0cnkucHJvdG90eXBlLmNvbXB1dGVPZmZzZXRzID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5CdWZmZXJHZW9tZXRyeTogLmNvbXB1dGVPZmZzZXRzKCkgaGFzIGJlZW4gcmVtb3ZlZC4iKTsKfTsKQnVmZmVyR2VvbWV0cnkucHJvdG90eXBlLnJlbW92ZUF0dHJpYnV0ZSA9IGZ1bmN0aW9uKG5hbWUpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkJ1ZmZlckdlb21ldHJ5OiAucmVtb3ZlQXR0cmlidXRlKCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuZGVsZXRlQXR0cmlidXRlKCkuIik7CiAgcmV0dXJuIHRoaXMuZGVsZXRlQXR0cmlidXRlKG5hbWUpOwp9OwpCdWZmZXJHZW9tZXRyeS5wcm90b3R5cGUuYXBwbHlNYXRyaXggPSBmdW5jdGlvbihtYXRyaXgpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkJ1ZmZlckdlb21ldHJ5OiAuYXBwbHlNYXRyaXgoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5hcHBseU1hdHJpeDQoKS4iKTsKICByZXR1cm4gdGhpcy5hcHBseU1hdHJpeDQobWF0cml4KTsKfTsKT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoQnVmZmVyR2VvbWV0cnkucHJvdG90eXBlLCB7CiAgZHJhd2NhbGxzOiB7CiAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5CdWZmZXJHZW9tZXRyeTogLmRyYXdjYWxscyBoYXMgYmVlbiByZW5hbWVkIHRvIC5ncm91cHMuIik7CiAgICAgIHJldHVybiB0aGlzLmdyb3VwczsKICAgIH0KICB9LAogIG9mZnNldHM6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuQnVmZmVyR2VvbWV0cnk6IC5vZmZzZXRzIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmdyb3Vwcy4iKTsKICAgICAgcmV0dXJuIHRoaXMuZ3JvdXBzOwogICAgfQogIH0KfSk7CkludGVybGVhdmVkQnVmZmVyLnByb3RvdHlwZS5zZXREeW5hbWljID0gZnVuY3Rpb24odmFsdWUpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkludGVybGVhdmVkQnVmZmVyOiAuc2V0RHluYW1pYygpIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAuc2V0VXNhZ2UoKSBpbnN0ZWFkLiIpOwogIHRoaXMuc2V0VXNhZ2UodmFsdWUgPT09IHRydWUgPyBEeW5hbWljRHJhd1VzYWdlIDogU3RhdGljRHJhd1VzYWdlKTsKICByZXR1cm4gdGhpczsKfTsKSW50ZXJsZWF2ZWRCdWZmZXIucHJvdG90eXBlLnNldEFycmF5ID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS5lcnJvcigiVEhSRUUuSW50ZXJsZWF2ZWRCdWZmZXI6IC5zZXRBcnJheSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgQnVmZmVyR2VvbWV0cnkgLnNldEF0dHJpYnV0ZSB0byByZXBsYWNlL3Jlc2l6ZSBhdHRyaWJ1dGUgYnVmZmVycyIpOwp9OwpFeHRydWRlR2VvbWV0cnkucHJvdG90eXBlLmdldEFycmF5cyA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUuZXJyb3IoIlRIUkVFLkV4dHJ1ZGVHZW9tZXRyeTogLmdldEFycmF5cygpIGhhcyBiZWVuIHJlbW92ZWQuIik7Cn07CkV4dHJ1ZGVHZW9tZXRyeS5wcm90b3R5cGUuYWRkU2hhcGVMaXN0ID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS5lcnJvcigiVEhSRUUuRXh0cnVkZUdlb21ldHJ5OiAuYWRkU2hhcGVMaXN0KCkgaGFzIGJlZW4gcmVtb3ZlZC4iKTsKfTsKRXh0cnVkZUdlb21ldHJ5LnByb3RvdHlwZS5hZGRTaGFwZSA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUuZXJyb3IoIlRIUkVFLkV4dHJ1ZGVHZW9tZXRyeTogLmFkZFNoYXBlKCkgaGFzIGJlZW4gcmVtb3ZlZC4iKTsKfTsKU2NlbmUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLmVycm9yKCJUSFJFRS5TY2VuZTogLmRpc3Bvc2UoKSBoYXMgYmVlbiByZW1vdmVkLiIpOwp9OwpVbmlmb3JtLnByb3RvdHlwZS5vblVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUud2FybigiVEhSRUUuVW5pZm9ybTogLm9uVXBkYXRlKCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIG9iamVjdC5vbkJlZm9yZVJlbmRlcigpIGluc3RlYWQuIik7CiAgcmV0dXJuIHRoaXM7Cn07Ck9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKE1hdGVyaWFsLnByb3RvdHlwZSwgewogIHdyYXBBcm91bmQ6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuTWF0ZXJpYWw6IC53cmFwQXJvdW5kIGhhcyBiZWVuIHJlbW92ZWQuIik7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbigpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5NYXRlcmlhbDogLndyYXBBcm91bmQgaGFzIGJlZW4gcmVtb3ZlZC4iKTsKICAgIH0KICB9LAogIG92ZXJkcmF3OiB7CiAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLk1hdGVyaWFsOiAub3ZlcmRyYXcgaGFzIGJlZW4gcmVtb3ZlZC4iKTsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLk1hdGVyaWFsOiAub3ZlcmRyYXcgaGFzIGJlZW4gcmVtb3ZlZC4iKTsKICAgIH0KICB9LAogIHdyYXBSR0I6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuTWF0ZXJpYWw6IC53cmFwUkdCIGhhcyBiZWVuIHJlbW92ZWQuIik7CiAgICAgIHJldHVybiBuZXcgQ29sb3IoKTsKICAgIH0KICB9LAogIHNoYWRpbmc6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLiIgKyB0aGlzLnR5cGUgKyAiOiAuc2hhZGluZyBoYXMgYmVlbiByZW1vdmVkLiBVc2UgdGhlIGJvb2xlYW4gLmZsYXRTaGFkaW5nIGluc3RlYWQuIik7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLiIgKyB0aGlzLnR5cGUgKyAiOiAuc2hhZGluZyBoYXMgYmVlbiByZW1vdmVkLiBVc2UgdGhlIGJvb2xlYW4gLmZsYXRTaGFkaW5nIGluc3RlYWQuIik7CiAgICAgIHRoaXMuZmxhdFNoYWRpbmcgPSB2YWx1ZSA9PT0gRmxhdFNoYWRpbmc7CiAgICB9CiAgfSwKICBzdGVuY2lsTWFzazogewogICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS4iICsgdGhpcy50eXBlICsgIjogLnN0ZW5jaWxNYXNrIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSAuc3RlbmNpbEZ1bmNNYXNrIGluc3RlYWQuIik7CiAgICAgIHJldHVybiB0aGlzLnN0ZW5jaWxGdW5jTWFzazsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuIiArIHRoaXMudHlwZSArICI6IC5zdGVuY2lsTWFzayBoYXMgYmVlbiByZW1vdmVkLiBVc2UgLnN0ZW5jaWxGdW5jTWFzayBpbnN0ZWFkLiIpOwogICAgICB0aGlzLnN0ZW5jaWxGdW5jTWFzayA9IHZhbHVlOwogICAgfQogIH0sCiAgdmVydGV4VGFuZ2VudHM6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuIiArIHRoaXMudHlwZSArICI6IC52ZXJ0ZXhUYW5nZW50cyBoYXMgYmVlbiByZW1vdmVkLiIpOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuIiArIHRoaXMudHlwZSArICI6IC52ZXJ0ZXhUYW5nZW50cyBoYXMgYmVlbiByZW1vdmVkLiIpOwogICAgfQogIH0KfSk7Ck9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFNoYWRlck1hdGVyaWFsLnByb3RvdHlwZSwgewogIGRlcml2YXRpdmVzOiB7CiAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLlNoYWRlck1hdGVyaWFsOiAuZGVyaXZhdGl2ZXMgaGFzIGJlZW4gbW92ZWQgdG8gLmV4dGVuc2lvbnMuZGVyaXZhdGl2ZXMuIik7CiAgICAgIHJldHVybiB0aGlzLmV4dGVuc2lvbnMuZGVyaXZhdGl2ZXM7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLiBTaGFkZXJNYXRlcmlhbDogLmRlcml2YXRpdmVzIGhhcyBiZWVuIG1vdmVkIHRvIC5leHRlbnNpb25zLmRlcml2YXRpdmVzLiIpOwogICAgICB0aGlzLmV4dGVuc2lvbnMuZGVyaXZhdGl2ZXMgPSB2YWx1ZTsKICAgIH0KICB9Cn0pOwpXZWJHTFJlbmRlcmVyLnByb3RvdHlwZS5jbGVhclRhcmdldCA9IGZ1bmN0aW9uKHJlbmRlclRhcmdldCwgY29sb3IsIGRlcHRoLCBzdGVuY2lsKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuY2xlYXJUYXJnZXQoKSBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLnNldFJlbmRlclRhcmdldCgpIGFuZCAuY2xlYXIoKSBpbnN0ZWFkLiIpOwogIHRoaXMuc2V0UmVuZGVyVGFyZ2V0KHJlbmRlclRhcmdldCk7CiAgdGhpcy5jbGVhcihjb2xvciwgZGVwdGgsIHN0ZW5jaWwpOwp9OwpXZWJHTFJlbmRlcmVyLnByb3RvdHlwZS5hbmltYXRlID0gZnVuY3Rpb24oY2FsbGJhY2spIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5hbmltYXRlKCkgaXMgbm93IC5zZXRBbmltYXRpb25Mb29wKCkuIik7CiAgdGhpcy5zZXRBbmltYXRpb25Mb29wKGNhbGxiYWNrKTsKfTsKV2ViR0xSZW5kZXJlci5wcm90b3R5cGUuZ2V0Q3VycmVudFJlbmRlclRhcmdldCA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLmdldEN1cnJlbnRSZW5kZXJUYXJnZXQoKSBpcyBub3cgLmdldFJlbmRlclRhcmdldCgpLiIpOwogIHJldHVybiB0aGlzLmdldFJlbmRlclRhcmdldCgpOwp9OwpXZWJHTFJlbmRlcmVyLnByb3RvdHlwZS5nZXRNYXhBbmlzb3Ryb3B5ID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuZ2V0TWF4QW5pc290cm9weSgpIGlzIG5vdyAuY2FwYWJpbGl0aWVzLmdldE1heEFuaXNvdHJvcHkoKS4iKTsKICByZXR1cm4gdGhpcy5jYXBhYmlsaXRpZXMuZ2V0TWF4QW5pc290cm9weSgpOwp9OwpXZWJHTFJlbmRlcmVyLnByb3RvdHlwZS5nZXRQcmVjaXNpb24gPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5nZXRQcmVjaXNpb24oKSBpcyBub3cgLmNhcGFiaWxpdGllcy5wcmVjaXNpb24uIik7CiAgcmV0dXJuIHRoaXMuY2FwYWJpbGl0aWVzLnByZWNpc2lvbjsKfTsKV2ViR0xSZW5kZXJlci5wcm90b3R5cGUucmVzZXRHTFN0YXRlID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAucmVzZXRHTFN0YXRlKCkgaXMgbm93IC5zdGF0ZS5yZXNldCgpLiIpOwogIHJldHVybiB0aGlzLnN0YXRlLnJlc2V0KCk7Cn07CldlYkdMUmVuZGVyZXIucHJvdG90eXBlLnN1cHBvcnRzRmxvYXRUZXh0dXJlcyA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnN1cHBvcnRzRmxvYXRUZXh0dXJlcygpIGlzIG5vdyAuZXh0ZW5zaW9ucy5nZXQoICdPRVNfdGV4dHVyZV9mbG9hdCcgKS4iKTsKICByZXR1cm4gdGhpcy5leHRlbnNpb25zLmdldCgiT0VTX3RleHR1cmVfZmxvYXQiKTsKfTsKV2ViR0xSZW5kZXJlci5wcm90b3R5cGUuc3VwcG9ydHNIYWxmRmxvYXRUZXh0dXJlcyA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnN1cHBvcnRzSGFsZkZsb2F0VGV4dHVyZXMoKSBpcyBub3cgLmV4dGVuc2lvbnMuZ2V0KCAnT0VTX3RleHR1cmVfaGFsZl9mbG9hdCcgKS4iKTsKICByZXR1cm4gdGhpcy5leHRlbnNpb25zLmdldCgiT0VTX3RleHR1cmVfaGFsZl9mbG9hdCIpOwp9OwpXZWJHTFJlbmRlcmVyLnByb3RvdHlwZS5zdXBwb3J0c1N0YW5kYXJkRGVyaXZhdGl2ZXMgPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zdXBwb3J0c1N0YW5kYXJkRGVyaXZhdGl2ZXMoKSBpcyBub3cgLmV4dGVuc2lvbnMuZ2V0KCAnT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzJyApLiIpOwogIHJldHVybiB0aGlzLmV4dGVuc2lvbnMuZ2V0KCJPRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXMiKTsKfTsKV2ViR0xSZW5kZXJlci5wcm90b3R5cGUuc3VwcG9ydHNDb21wcmVzc2VkVGV4dHVyZVMzVEMgPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zdXBwb3J0c0NvbXByZXNzZWRUZXh0dXJlUzNUQygpIGlzIG5vdyAuZXh0ZW5zaW9ucy5nZXQoICdXRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfczN0YycgKS4iKTsKICByZXR1cm4gdGhpcy5leHRlbnNpb25zLmdldCgiV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX3MzdGMiKTsKfTsKV2ViR0xSZW5kZXJlci5wcm90b3R5cGUuc3VwcG9ydHNDb21wcmVzc2VkVGV4dHVyZVBWUlRDID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuc3VwcG9ydHNDb21wcmVzc2VkVGV4dHVyZVBWUlRDKCkgaXMgbm93IC5leHRlbnNpb25zLmdldCggJ1dFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9wdnJ0YycgKS4iKTsKICByZXR1cm4gdGhpcy5leHRlbnNpb25zLmdldCgiV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX3B2cnRjIik7Cn07CldlYkdMUmVuZGVyZXIucHJvdG90eXBlLnN1cHBvcnRzQmxlbmRNaW5NYXggPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zdXBwb3J0c0JsZW5kTWluTWF4KCkgaXMgbm93IC5leHRlbnNpb25zLmdldCggJ0VYVF9ibGVuZF9taW5tYXgnICkuIik7CiAgcmV0dXJuIHRoaXMuZXh0ZW5zaW9ucy5nZXQoIkVYVF9ibGVuZF9taW5tYXgiKTsKfTsKV2ViR0xSZW5kZXJlci5wcm90b3R5cGUuc3VwcG9ydHNWZXJ0ZXhUZXh0dXJlcyA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnN1cHBvcnRzVmVydGV4VGV4dHVyZXMoKSBpcyBub3cgLmNhcGFiaWxpdGllcy52ZXJ0ZXhUZXh0dXJlcy4iKTsKICByZXR1cm4gdGhpcy5jYXBhYmlsaXRpZXMudmVydGV4VGV4dHVyZXM7Cn07CldlYkdMUmVuZGVyZXIucHJvdG90eXBlLnN1cHBvcnRzSW5zdGFuY2VkQXJyYXlzID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuc3VwcG9ydHNJbnN0YW5jZWRBcnJheXMoKSBpcyBub3cgLmV4dGVuc2lvbnMuZ2V0KCAnQU5HTEVfaW5zdGFuY2VkX2FycmF5cycgKS4iKTsKICByZXR1cm4gdGhpcy5leHRlbnNpb25zLmdldCgiQU5HTEVfaW5zdGFuY2VkX2FycmF5cyIpOwp9OwpXZWJHTFJlbmRlcmVyLnByb3RvdHlwZS5lbmFibGVTY2lzc29yVGVzdCA9IGZ1bmN0aW9uKGJvb2xlYW4pIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5lbmFibGVTY2lzc29yVGVzdCgpIGlzIG5vdyAuc2V0U2Npc3NvclRlc3QoKS4iKTsKICB0aGlzLnNldFNjaXNzb3JUZXN0KGJvb2xlYW4pOwp9OwpXZWJHTFJlbmRlcmVyLnByb3RvdHlwZS5pbml0TWF0ZXJpYWwgPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5pbml0TWF0ZXJpYWwoKSBoYXMgYmVlbiByZW1vdmVkLiIpOwp9OwpXZWJHTFJlbmRlcmVyLnByb3RvdHlwZS5hZGRQcmVQbHVnaW4gPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5hZGRQcmVQbHVnaW4oKSBoYXMgYmVlbiByZW1vdmVkLiIpOwp9OwpXZWJHTFJlbmRlcmVyLnByb3RvdHlwZS5hZGRQb3N0UGx1Z2luID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuYWRkUG9zdFBsdWdpbigpIGhhcyBiZWVuIHJlbW92ZWQuIik7Cn07CldlYkdMUmVuZGVyZXIucHJvdG90eXBlLnVwZGF0ZVNoYWRvd01hcCA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnVwZGF0ZVNoYWRvd01hcCgpIGhhcyBiZWVuIHJlbW92ZWQuIik7Cn07CldlYkdMUmVuZGVyZXIucHJvdG90eXBlLnNldEZhY2VDdWxsaW5nID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuc2V0RmFjZUN1bGxpbmcoKSBoYXMgYmVlbiByZW1vdmVkLiIpOwp9OwpXZWJHTFJlbmRlcmVyLnByb3RvdHlwZS5hbGxvY1RleHR1cmVVbml0ID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuYWxsb2NUZXh0dXJlVW5pdCgpIGhhcyBiZWVuIHJlbW92ZWQuIik7Cn07CldlYkdMUmVuZGVyZXIucHJvdG90eXBlLnNldFRleHR1cmUgPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zZXRUZXh0dXJlKCkgaGFzIGJlZW4gcmVtb3ZlZC4iKTsKfTsKV2ViR0xSZW5kZXJlci5wcm90b3R5cGUuc2V0VGV4dHVyZTJEID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuc2V0VGV4dHVyZTJEKCkgaGFzIGJlZW4gcmVtb3ZlZC4iKTsKfTsKV2ViR0xSZW5kZXJlci5wcm90b3R5cGUuc2V0VGV4dHVyZUN1YmUgPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zZXRUZXh0dXJlQ3ViZSgpIGhhcyBiZWVuIHJlbW92ZWQuIik7Cn07CldlYkdMUmVuZGVyZXIucHJvdG90eXBlLmdldEFjdGl2ZU1pcE1hcExldmVsID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuZ2V0QWN0aXZlTWlwTWFwTGV2ZWwoKSBpcyBub3cgLmdldEFjdGl2ZU1pcG1hcExldmVsKCkuIik7CiAgcmV0dXJuIHRoaXMuZ2V0QWN0aXZlTWlwbWFwTGV2ZWwoKTsKfTsKT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoV2ViR0xSZW5kZXJlci5wcm90b3R5cGUsIHsKICBzaGFkb3dNYXBFbmFibGVkOiB7CiAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5zaGFkb3dNYXAuZW5hYmxlZDsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnNoYWRvd01hcEVuYWJsZWQgaXMgbm93IC5zaGFkb3dNYXAuZW5hYmxlZC4iKTsKICAgICAgdGhpcy5zaGFkb3dNYXAuZW5hYmxlZCA9IHZhbHVlOwogICAgfQogIH0sCiAgc2hhZG93TWFwVHlwZTogewogICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuc2hhZG93TWFwLnR5cGU7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zaGFkb3dNYXBUeXBlIGlzIG5vdyAuc2hhZG93TWFwLnR5cGUuIik7CiAgICAgIHRoaXMuc2hhZG93TWFwLnR5cGUgPSB2YWx1ZTsKICAgIH0KICB9LAogIHNoYWRvd01hcEN1bGxGYWNlOiB7CiAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zaGFkb3dNYXBDdWxsRmFjZSBoYXMgYmVlbiByZW1vdmVkLiBTZXQgTWF0ZXJpYWwuc2hhZG93U2lkZSBpbnN0ZWFkLiIpOwogICAgICByZXR1cm4gdm9pZCAwOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnNoYWRvd01hcEN1bGxGYWNlIGhhcyBiZWVuIHJlbW92ZWQuIFNldCBNYXRlcmlhbC5zaGFkb3dTaWRlIGluc3RlYWQuIik7CiAgICB9CiAgfSwKICBjb250ZXh0OiB7CiAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5jb250ZXh0IGhhcyBiZWVuIHJlbW92ZWQuIFVzZSAuZ2V0Q29udGV4dCgpIGluc3RlYWQuIik7CiAgICAgIHJldHVybiB0aGlzLmdldENvbnRleHQoKTsKICAgIH0KICB9LAogIHZyOiB7CiAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC52ciBoYXMgYmVlbiByZW5hbWVkIHRvIC54ciIpOwogICAgICByZXR1cm4gdGhpcy54cjsKICAgIH0KICB9LAogIGdhbW1hSW5wdXQ6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLmdhbW1hSW5wdXQgaGFzIGJlZW4gcmVtb3ZlZC4gU2V0IHRoZSBlbmNvZGluZyBmb3IgdGV4dHVyZXMgdmlhIFRleHR1cmUuZW5jb2RpbmcgaW5zdGVhZC4iKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLmdhbW1hSW5wdXQgaGFzIGJlZW4gcmVtb3ZlZC4gU2V0IHRoZSBlbmNvZGluZyBmb3IgdGV4dHVyZXMgdmlhIFRleHR1cmUuZW5jb2RpbmcgaW5zdGVhZC4iKTsKICAgIH0KICB9LAogIGdhbW1hT3V0cHV0OiB7CiAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5nYW1tYU91dHB1dCBoYXMgYmVlbiByZW1vdmVkLiBTZXQgV2ViR0xSZW5kZXJlci5vdXRwdXRFbmNvZGluZyBpbnN0ZWFkLiIpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5nYW1tYU91dHB1dCBoYXMgYmVlbiByZW1vdmVkLiBTZXQgV2ViR0xSZW5kZXJlci5vdXRwdXRFbmNvZGluZyBpbnN0ZWFkLiIpOwogICAgICB0aGlzLm91dHB1dEVuY29kaW5nID0gdmFsdWUgPT09IHRydWUgPyBzUkdCRW5jb2RpbmcgOiBMaW5lYXJFbmNvZGluZzsKICAgIH0KICB9LAogIHRvbmVNYXBwaW5nV2hpdGVQb2ludDogewogICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAudG9uZU1hcHBpbmdXaGl0ZVBvaW50IGhhcyBiZWVuIHJlbW92ZWQuIik7CiAgICAgIHJldHVybiAxOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnRvbmVNYXBwaW5nV2hpdGVQb2ludCBoYXMgYmVlbiByZW1vdmVkLiIpOwogICAgfQogIH0sCiAgZ2FtbWFGYWN0b3I6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLmdhbW1hRmFjdG9yIGhhcyBiZWVuIHJlbW92ZWQuIik7CiAgICAgIHJldHVybiAyOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLmdhbW1hRmFjdG9yIGhhcyBiZWVuIHJlbW92ZWQuIik7CiAgICB9CiAgfQp9KTsKT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoV2ViR0xTaGFkb3dNYXAucHJvdG90eXBlLCB7CiAgY3VsbEZhY2U6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnNoYWRvd01hcC5jdWxsRmFjZSBoYXMgYmVlbiByZW1vdmVkLiBTZXQgTWF0ZXJpYWwuc2hhZG93U2lkZSBpbnN0ZWFkLiIpOwogICAgICByZXR1cm4gdm9pZCAwOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnNoYWRvd01hcC5jdWxsRmFjZSBoYXMgYmVlbiByZW1vdmVkLiBTZXQgTWF0ZXJpYWwuc2hhZG93U2lkZSBpbnN0ZWFkLiIpOwogICAgfQogIH0sCiAgcmVuZGVyUmV2ZXJzZVNpZGVkOiB7CiAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zaGFkb3dNYXAucmVuZGVyUmV2ZXJzZVNpZGVkIGhhcyBiZWVuIHJlbW92ZWQuIFNldCBNYXRlcmlhbC5zaGFkb3dTaWRlIGluc3RlYWQuIik7CiAgICAgIHJldHVybiB2b2lkIDA7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbigpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuc2hhZG93TWFwLnJlbmRlclJldmVyc2VTaWRlZCBoYXMgYmVlbiByZW1vdmVkLiBTZXQgTWF0ZXJpYWwuc2hhZG93U2lkZSBpbnN0ZWFkLiIpOwogICAgfQogIH0sCiAgcmVuZGVyU2luZ2xlU2lkZWQ6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnNoYWRvd01hcC5yZW5kZXJTaW5nbGVTaWRlZCBoYXMgYmVlbiByZW1vdmVkLiBTZXQgTWF0ZXJpYWwuc2hhZG93U2lkZSBpbnN0ZWFkLiIpOwogICAgICByZXR1cm4gdm9pZCAwOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnNoYWRvd01hcC5yZW5kZXJTaW5nbGVTaWRlZCBoYXMgYmVlbiByZW1vdmVkLiBTZXQgTWF0ZXJpYWwuc2hhZG93U2lkZSBpbnN0ZWFkLiIpOwogICAgfQogIH0KfSk7CmZ1bmN0aW9uIFdlYkdMUmVuZGVyVGFyZ2V0Q3ViZSh3aWR0aCwgaGVpZ2h0LCBvcHRpb25zKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlclRhcmdldEN1YmUoIHdpZHRoLCBoZWlnaHQsIG9wdGlvbnMgKSBpcyBub3cgV2ViR0xDdWJlUmVuZGVyVGFyZ2V0KCBzaXplLCBvcHRpb25zICkuIik7CiAgcmV0dXJuIG5ldyBXZWJHTEN1YmVSZW5kZXJUYXJnZXQod2lkdGgsIG9wdGlvbnMpOwp9Ck9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFdlYkdMUmVuZGVyVGFyZ2V0LnByb3RvdHlwZSwgewogIHdyYXBTOiB7CiAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0OiAud3JhcFMgaXMgbm93IC50ZXh0dXJlLndyYXBTLiIpOwogICAgICByZXR1cm4gdGhpcy50ZXh0dXJlLndyYXBTOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlclRhcmdldDogLndyYXBTIGlzIG5vdyAudGV4dHVyZS53cmFwUy4iKTsKICAgICAgdGhpcy50ZXh0dXJlLndyYXBTID0gdmFsdWU7CiAgICB9CiAgfSwKICB3cmFwVDogewogICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlclRhcmdldDogLndyYXBUIGlzIG5vdyAudGV4dHVyZS53cmFwVC4iKTsKICAgICAgcmV0dXJuIHRoaXMudGV4dHVyZS53cmFwVDsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC53cmFwVCBpcyBub3cgLnRleHR1cmUud3JhcFQuIik7CiAgICAgIHRoaXMudGV4dHVyZS53cmFwVCA9IHZhbHVlOwogICAgfQogIH0sCiAgbWFnRmlsdGVyOiB7CiAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0OiAubWFnRmlsdGVyIGlzIG5vdyAudGV4dHVyZS5tYWdGaWx0ZXIuIik7CiAgICAgIHJldHVybiB0aGlzLnRleHR1cmUubWFnRmlsdGVyOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlclRhcmdldDogLm1hZ0ZpbHRlciBpcyBub3cgLnRleHR1cmUubWFnRmlsdGVyLiIpOwogICAgICB0aGlzLnRleHR1cmUubWFnRmlsdGVyID0gdmFsdWU7CiAgICB9CiAgfSwKICBtaW5GaWx0ZXI6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC5taW5GaWx0ZXIgaXMgbm93IC50ZXh0dXJlLm1pbkZpbHRlci4iKTsKICAgICAgcmV0dXJuIHRoaXMudGV4dHVyZS5taW5GaWx0ZXI7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0OiAubWluRmlsdGVyIGlzIG5vdyAudGV4dHVyZS5taW5GaWx0ZXIuIik7CiAgICAgIHRoaXMudGV4dHVyZS5taW5GaWx0ZXIgPSB2YWx1ZTsKICAgIH0KICB9LAogIGFuaXNvdHJvcHk6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC5hbmlzb3Ryb3B5IGlzIG5vdyAudGV4dHVyZS5hbmlzb3Ryb3B5LiIpOwogICAgICByZXR1cm4gdGhpcy50ZXh0dXJlLmFuaXNvdHJvcHk7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0OiAuYW5pc290cm9weSBpcyBub3cgLnRleHR1cmUuYW5pc290cm9weS4iKTsKICAgICAgdGhpcy50ZXh0dXJlLmFuaXNvdHJvcHkgPSB2YWx1ZTsKICAgIH0KICB9LAogIG9mZnNldDogewogICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlclRhcmdldDogLm9mZnNldCBpcyBub3cgLnRleHR1cmUub2Zmc2V0LiIpOwogICAgICByZXR1cm4gdGhpcy50ZXh0dXJlLm9mZnNldDsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC5vZmZzZXQgaXMgbm93IC50ZXh0dXJlLm9mZnNldC4iKTsKICAgICAgdGhpcy50ZXh0dXJlLm9mZnNldCA9IHZhbHVlOwogICAgfQogIH0sCiAgcmVwZWF0OiB7CiAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0OiAucmVwZWF0IGlzIG5vdyAudGV4dHVyZS5yZXBlYXQuIik7CiAgICAgIHJldHVybiB0aGlzLnRleHR1cmUucmVwZWF0OwogICAgfSwKICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlclRhcmdldDogLnJlcGVhdCBpcyBub3cgLnRleHR1cmUucmVwZWF0LiIpOwogICAgICB0aGlzLnRleHR1cmUucmVwZWF0ID0gdmFsdWU7CiAgICB9CiAgfSwKICBmb3JtYXQ6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC5mb3JtYXQgaXMgbm93IC50ZXh0dXJlLmZvcm1hdC4iKTsKICAgICAgcmV0dXJuIHRoaXMudGV4dHVyZS5mb3JtYXQ7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0OiAuZm9ybWF0IGlzIG5vdyAudGV4dHVyZS5mb3JtYXQuIik7CiAgICAgIHRoaXMudGV4dHVyZS5mb3JtYXQgPSB2YWx1ZTsKICAgIH0KICB9LAogIHR5cGU6IHsKICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC50eXBlIGlzIG5vdyAudGV4dHVyZS50eXBlLiIpOwogICAgICByZXR1cm4gdGhpcy50ZXh0dXJlLnR5cGU7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICBjb25zb2xlLndhcm4oIlRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0OiAudHlwZSBpcyBub3cgLnRleHR1cmUudHlwZS4iKTsKICAgICAgdGhpcy50ZXh0dXJlLnR5cGUgPSB2YWx1ZTsKICAgIH0KICB9LAogIGdlbmVyYXRlTWlwbWFwczogewogICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgY29uc29sZS53YXJuKCJUSFJFRS5XZWJHTFJlbmRlclRhcmdldDogLmdlbmVyYXRlTWlwbWFwcyBpcyBub3cgLnRleHR1cmUuZ2VuZXJhdGVNaXBtYXBzLiIpOwogICAgICByZXR1cm4gdGhpcy50ZXh0dXJlLmdlbmVyYXRlTWlwbWFwczsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGNvbnNvbGUud2FybigiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC5nZW5lcmF0ZU1pcG1hcHMgaXMgbm93IC50ZXh0dXJlLmdlbmVyYXRlTWlwbWFwcy4iKTsKICAgICAgdGhpcy50ZXh0dXJlLmdlbmVyYXRlTWlwbWFwcyA9IHZhbHVlOwogICAgfQogIH0KfSk7CkF1ZGlvLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24oZmlsZSkgewogIGNvbnNvbGUud2FybigiVEhSRUUuQXVkaW86IC5sb2FkIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSBUSFJFRS5BdWRpb0xvYWRlciBpbnN0ZWFkLiIpOwogIGNvbnN0IHNjb3BlID0gdGhpczsKICBjb25zdCBhdWRpb0xvYWRlciA9IG5ldyBBdWRpb0xvYWRlcigpOwogIGF1ZGlvTG9hZGVyLmxvYWQoZmlsZSwgZnVuY3Rpb24oYnVmZmVyKSB7CiAgICBzY29wZS5zZXRCdWZmZXIoYnVmZmVyKTsKICB9KTsKICByZXR1cm4gdGhpczsKfTsKQXVkaW9BbmFseXNlci5wcm90b3R5cGUuZ2V0RGF0YSA9IGZ1bmN0aW9uKCkgewogIGNvbnNvbGUud2FybigiVEhSRUUuQXVkaW9BbmFseXNlcjogLmdldERhdGEoKSBpcyBub3cgLmdldEZyZXF1ZW5jeURhdGEoKS4iKTsKICByZXR1cm4gdGhpcy5nZXRGcmVxdWVuY3lEYXRhKCk7Cn07CkN1YmVDYW1lcmEucHJvdG90eXBlLnVwZGF0ZUN1YmVNYXAgPSBmdW5jdGlvbihyZW5kZXJlciwgc2NlbmUpIHsKICBjb25zb2xlLndhcm4oIlRIUkVFLkN1YmVDYW1lcmE6IC51cGRhdGVDdWJlTWFwKCkgaXMgbm93IC51cGRhdGUoKS4iKTsKICByZXR1cm4gdGhpcy51cGRhdGUocmVuZGVyZXIsIHNjZW5lKTsKfTsKQ3ViZUNhbWVyYS5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbihyZW5kZXJlciwgY29sb3IsIGRlcHRoLCBzdGVuY2lsKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5DdWJlQ2FtZXJhOiAuY2xlYXIoKSBpcyBub3cgLnJlbmRlclRhcmdldC5jbGVhcigpLiIpOwogIHJldHVybiB0aGlzLnJlbmRlclRhcmdldC5jbGVhcihyZW5kZXJlciwgY29sb3IsIGRlcHRoLCBzdGVuY2lsKTsKfTsKSW1hZ2VVdGlscy5jcm9zc09yaWdpbiA9IHZvaWQgMDsKSW1hZ2VVdGlscy5sb2FkVGV4dHVyZSA9IGZ1bmN0aW9uKHVybCwgbWFwcGluZywgb25Mb2FkLCBvbkVycm9yKSB7CiAgY29uc29sZS53YXJuKCJUSFJFRS5JbWFnZVV0aWxzLmxvYWRUZXh0dXJlIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSBUSFJFRS5UZXh0dXJlTG9hZGVyKCkgaW5zdGVhZC4iKTsKICBjb25zdCBsb2FkZXIgPSBuZXcgVGV4dHVyZUxvYWRlcigpOwogIGxvYWRlci5zZXRDcm9zc09yaWdpbih0aGlzLmNyb3NzT3JpZ2luKTsKICBjb25zdCB0ZXh0dXJlID0gbG9hZGVyLmxvYWQodXJsLCBvbkxvYWQsIHZvaWQgMCwgb25FcnJvcik7CiAgaWYgKG1hcHBpbmcpCiAgICB0ZXh0dXJlLm1hcHBpbmcgPSBtYXBwaW5nOwogIHJldHVybiB0ZXh0dXJlOwp9OwpJbWFnZVV0aWxzLmxvYWRUZXh0dXJlQ3ViZSA9IGZ1bmN0aW9uKHVybHMsIG1hcHBpbmcsIG9uTG9hZCwgb25FcnJvcikgewogIGNvbnNvbGUud2FybigiVEhSRUUuSW1hZ2VVdGlscy5sb2FkVGV4dHVyZUN1YmUgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIFRIUkVFLkN1YmVUZXh0dXJlTG9hZGVyKCkgaW5zdGVhZC4iKTsKICBjb25zdCBsb2FkZXIgPSBuZXcgQ3ViZVRleHR1cmVMb2FkZXIoKTsKICBsb2FkZXIuc2V0Q3Jvc3NPcmlnaW4odGhpcy5jcm9zc09yaWdpbik7CiAgY29uc3QgdGV4dHVyZSA9IGxvYWRlci5sb2FkKHVybHMsIG9uTG9hZCwgdm9pZCAwLCBvbkVycm9yKTsKICBpZiAobWFwcGluZykKICAgIHRleHR1cmUubWFwcGluZyA9IG1hcHBpbmc7CiAgcmV0dXJuIHRleHR1cmU7Cn07CkltYWdlVXRpbHMubG9hZENvbXByZXNzZWRUZXh0dXJlID0gZnVuY3Rpb24oKSB7CiAgY29uc29sZS5lcnJvcigiVEhSRUUuSW1hZ2VVdGlscy5sb2FkQ29tcHJlc3NlZFRleHR1cmUgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIFRIUkVFLkREU0xvYWRlciBpbnN0ZWFkLiIpOwp9OwpJbWFnZVV0aWxzLmxvYWRDb21wcmVzc2VkVGV4dHVyZUN1YmUgPSBmdW5jdGlvbigpIHsKICBjb25zb2xlLmVycm9yKCJUSFJFRS5JbWFnZVV0aWxzLmxvYWRDb21wcmVzc2VkVGV4dHVyZUN1YmUgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIFRIUkVFLkREU0xvYWRlciBpbnN0ZWFkLiIpOwp9OwpmdW5jdGlvbiBDYW52YXNSZW5kZXJlcigpIHsKICBjb25zb2xlLmVycm9yKCJUSFJFRS5DYW52YXNSZW5kZXJlciBoYXMgYmVlbiByZW1vdmVkIik7Cn0KZnVuY3Rpb24gSlNPTkxvYWRlcigpIHsKICBjb25zb2xlLmVycm9yKCJUSFJFRS5KU09OTG9hZGVyIGhhcyBiZWVuIHJlbW92ZWQuIik7Cn0KY29uc3QgU2NlbmVVdGlscyA9IHsKICBjcmVhdGVNdWx0aU1hdGVyaWFsT2JqZWN0OiBmdW5jdGlvbigpIHsKICAgIGNvbnNvbGUuZXJyb3IoIlRIUkVFLlNjZW5lVXRpbHMgaGFzIGJlZW4gbW92ZWQgdG8gL2V4YW1wbGVzL2pzbS91dGlscy9TY2VuZVV0aWxzLmpzIik7CiAgfSwKICBkZXRhY2g6IGZ1bmN0aW9uKCkgewogICAgY29uc29sZS5lcnJvcigiVEhSRUUuU2NlbmVVdGlscyBoYXMgYmVlbiBtb3ZlZCB0byAvZXhhbXBsZXMvanNtL3V0aWxzL1NjZW5lVXRpbHMuanMiKTsKICB9LAogIGF0dGFjaDogZnVuY3Rpb24oKSB7CiAgICBjb25zb2xlLmVycm9yKCJUSFJFRS5TY2VuZVV0aWxzIGhhcyBiZWVuIG1vdmVkIHRvIC9leGFtcGxlcy9qc20vdXRpbHMvU2NlbmVVdGlscy5qcyIpOwogIH0KfTsKZnVuY3Rpb24gTGVuc0ZsYXJlKCkgewogIGNvbnNvbGUuZXJyb3IoIlRIUkVFLkxlbnNGbGFyZSBoYXMgYmVlbiBtb3ZlZCB0byAvZXhhbXBsZXMvanNtL29iamVjdHMvTGVuc2ZsYXJlLmpzIik7Cn0KZnVuY3Rpb24gUGFyYW1ldHJpY0dlb21ldHJ5KCkgewogIGNvbnNvbGUuZXJyb3IoIlRIUkVFLlBhcmFtZXRyaWNHZW9tZXRyeSBoYXMgYmVlbiBtb3ZlZCB0byAvZXhhbXBsZXMvanNtL2dlb21ldHJpZXMvUGFyYW1ldHJpY0dlb21ldHJ5LmpzIik7CiAgcmV0dXJuIG5ldyBCdWZmZXJHZW9tZXRyeSgpOwp9CmZ1bmN0aW9uIFRleHRHZW9tZXRyeSgpIHsKICBjb25zb2xlLmVycm9yKCJUSFJFRS5UZXh0R2VvbWV0cnkgaGFzIGJlZW4gbW92ZWQgdG8gL2V4YW1wbGVzL2pzbS9nZW9tZXRyaWVzL1RleHRHZW9tZXRyeS5qcyIpOwogIHJldHVybiBuZXcgQnVmZmVyR2VvbWV0cnkoKTsKfQpmdW5jdGlvbiBGb250TG9hZGVyKCkgewogIGNvbnNvbGUuZXJyb3IoIlRIUkVFLkZvbnRMb2FkZXIgaGFzIGJlZW4gbW92ZWQgdG8gL2V4YW1wbGVzL2pzbS9sb2FkZXJzL0ZvbnRMb2FkZXIuanMiKTsKfQpmdW5jdGlvbiBGb250KCkgewogIGNvbnNvbGUuZXJyb3IoIlRIUkVFLkZvbnQgaGFzIGJlZW4gbW92ZWQgdG8gL2V4YW1wbGVzL2pzbS9sb2FkZXJzL0ZvbnRMb2FkZXIuanMiKTsKfQpmdW5jdGlvbiBJbW1lZGlhdGVSZW5kZXJPYmplY3QoKSB7CiAgY29uc29sZS5lcnJvcigiVEhSRUUuSW1tZWRpYXRlUmVuZGVyT2JqZWN0IGhhcyBiZWVuIHJlbW92ZWQuIik7Cn0KaWYgKHR5cGVvZiBfX1RIUkVFX0RFVlRPT0xTX18gIT09ICJ1bmRlZmluZWQiKSB7CiAgX19USFJFRV9ERVZUT09MU19fLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJyZWdpc3RlciIsIHsgZGV0YWlsOiB7CiAgICByZXZpc2lvbjogUkVWSVNJT04KICB9IH0pKTsKfQppZiAodHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIpIHsKICBpZiAod2luZG93Ll9fVEhSRUVfXykgewogICAgY29uc29sZS53YXJuKCJXQVJOSU5HOiBNdWx0aXBsZSBpbnN0YW5jZXMgb2YgVGhyZWUuanMgYmVpbmcgaW1wb3J0ZWQuIik7CiAgfSBlbHNlIHsKICAgIHdpbmRvdy5fX1RIUkVFX18gPSBSRVZJU0lPTjsKICB9Cn0KZXhwb3J0IHsgQUNFU0ZpbG1pY1RvbmVNYXBwaW5nLCBBZGRFcXVhdGlvbiwgQWRkT3BlcmF0aW9uLCBBZGRpdGl2ZUFuaW1hdGlvbkJsZW5kTW9kZSwgQWRkaXRpdmVCbGVuZGluZywgQWxwaGFGb3JtYXQsIEFsd2F5c0RlcHRoLCBBbHdheXNTdGVuY2lsRnVuYywgQW1iaWVudExpZ2h0LCBBbWJpZW50TGlnaHRQcm9iZSwgQW5pbWF0aW9uQ2xpcCwgQW5pbWF0aW9uTG9hZGVyLCBBbmltYXRpb25NaXhlciwgQW5pbWF0aW9uT2JqZWN0R3JvdXAsIEFuaW1hdGlvblV0aWxzLCBBcmNDdXJ2ZSwgQXJyYXlDYW1lcmEsIEFycm93SGVscGVyLCBBdWRpbywgQXVkaW9BbmFseXNlciwgQXVkaW9Db250ZXh0LCBBdWRpb0xpc3RlbmVyLCBBdWRpb0xvYWRlciwgQXhlc0hlbHBlciwgQXhpc0hlbHBlciwgQmFja1NpZGUsIEJhc2ljRGVwdGhQYWNraW5nLCBCYXNpY1NoYWRvd01hcCwgQmluYXJ5VGV4dHVyZUxvYWRlciwgQm9uZSwgQm9vbGVhbktleWZyYW1lVHJhY2ssIEJvdW5kaW5nQm94SGVscGVyLCBCb3gyLCBCb3gzLCBCb3gzSGVscGVyLCBCb3hHZW9tZXRyeSBhcyBCb3hCdWZmZXJHZW9tZXRyeSwgQm94R2VvbWV0cnksIEJveEhlbHBlciwgQnVmZmVyQXR0cmlidXRlLCBCdWZmZXJHZW9tZXRyeSwgQnVmZmVyR2VvbWV0cnlMb2FkZXIsIEJ5dGVUeXBlLCBDYWNoZSwgQ2FtZXJhLCBDYW1lcmFIZWxwZXIsIENhbnZhc1JlbmRlcmVyLCBDYW52YXNUZXh0dXJlLCBDYXRtdWxsUm9tQ3VydmUzLCBDaW5lb25Ub25lTWFwcGluZywgQ2lyY2xlR2VvbWV0cnkgYXMgQ2lyY2xlQnVmZmVyR2VvbWV0cnksIENpcmNsZUdlb21ldHJ5LCBDbGFtcFRvRWRnZVdyYXBwaW5nLCBDbG9jaywgQ29sb3IsIENvbG9yS2V5ZnJhbWVUcmFjaywgQ29tcHJlc3NlZFRleHR1cmUsIENvbXByZXNzZWRUZXh0dXJlTG9hZGVyLCBDb25lR2VvbWV0cnkgYXMgQ29uZUJ1ZmZlckdlb21ldHJ5LCBDb25lR2VvbWV0cnksIEN1YmVDYW1lcmEsIEN1YmVSZWZsZWN0aW9uTWFwcGluZywgQ3ViZVJlZnJhY3Rpb25NYXBwaW5nLCBDdWJlVGV4dHVyZSwgQ3ViZVRleHR1cmVMb2FkZXIsIEN1YmVVVlJlZmxlY3Rpb25NYXBwaW5nLCBDdWJlVVZSZWZyYWN0aW9uTWFwcGluZywgQ3ViaWNCZXppZXJDdXJ2ZSwgQ3ViaWNCZXppZXJDdXJ2ZTMsIEN1YmljSW50ZXJwb2xhbnQsIEN1bGxGYWNlQmFjaywgQ3VsbEZhY2VGcm9udCwgQ3VsbEZhY2VGcm9udEJhY2ssIEN1bGxGYWNlTm9uZSwgQ3VydmUsIEN1cnZlUGF0aCwgQ3VzdG9tQmxlbmRpbmcsIEN1c3RvbVRvbmVNYXBwaW5nLCBDeWxpbmRlckdlb21ldHJ5IGFzIEN5bGluZGVyQnVmZmVyR2VvbWV0cnksIEN5bGluZGVyR2VvbWV0cnksIEN5bGluZHJpY2FsLCBEYXRhVGV4dHVyZSwgRGF0YVRleHR1cmUyREFycmF5LCBEYXRhVGV4dHVyZTNELCBEYXRhVGV4dHVyZUxvYWRlciwgRGF0YVV0aWxzLCBEZWNyZW1lbnRTdGVuY2lsT3AsIERlY3JlbWVudFdyYXBTdGVuY2lsT3AsIERlZmF1bHRMb2FkaW5nTWFuYWdlciwgRGVwdGhGb3JtYXQsIERlcHRoU3RlbmNpbEZvcm1hdCwgRGVwdGhUZXh0dXJlLCBEaXJlY3Rpb25hbExpZ2h0LCBEaXJlY3Rpb25hbExpZ2h0SGVscGVyLCBEaXNjcmV0ZUludGVycG9sYW50LCBEb2RlY2FoZWRyb25HZW9tZXRyeSBhcyBEb2RlY2FoZWRyb25CdWZmZXJHZW9tZXRyeSwgRG9kZWNhaGVkcm9uR2VvbWV0cnksIERvdWJsZVNpZGUsIERzdEFscGhhRmFjdG9yLCBEc3RDb2xvckZhY3RvciwgRHluYW1pY0J1ZmZlckF0dHJpYnV0ZSwgRHluYW1pY0NvcHlVc2FnZSwgRHluYW1pY0RyYXdVc2FnZSwgRHluYW1pY1JlYWRVc2FnZSwgRWRnZXNHZW9tZXRyeSwgRWRnZXNIZWxwZXIsIEVsbGlwc2VDdXJ2ZSwgRXF1YWxEZXB0aCwgRXF1YWxTdGVuY2lsRnVuYywgRXF1aXJlY3Rhbmd1bGFyUmVmbGVjdGlvbk1hcHBpbmcsIEVxdWlyZWN0YW5ndWxhclJlZnJhY3Rpb25NYXBwaW5nLCBFdWxlciwgRXZlbnREaXNwYXRjaGVyLCBFeHRydWRlR2VvbWV0cnkgYXMgRXh0cnVkZUJ1ZmZlckdlb21ldHJ5LCBFeHRydWRlR2VvbWV0cnksIEZhY2VDb2xvcnMsIEZpbGVMb2FkZXIsIEZsYXRTaGFkaW5nLCBGbG9hdDE2QnVmZmVyQXR0cmlidXRlLCBGbG9hdDMyQXR0cmlidXRlLCBGbG9hdDMyQnVmZmVyQXR0cmlidXRlLCBGbG9hdDY0QXR0cmlidXRlLCBGbG9hdDY0QnVmZmVyQXR0cmlidXRlLCBGbG9hdFR5cGUsIEZvZywgRm9nRXhwMiwgRm9udCwgRm9udExvYWRlciwgRnJhbWVidWZmZXJUZXh0dXJlLCBGcm9udFNpZGUsIEZydXN0dW0sIEdMQnVmZmVyQXR0cmlidXRlLCBHTFNMMSwgR0xTTDMsIEdyZWF0ZXJEZXB0aCwgR3JlYXRlckVxdWFsRGVwdGgsIEdyZWF0ZXJFcXVhbFN0ZW5jaWxGdW5jLCBHcmVhdGVyU3RlbmNpbEZ1bmMsIEdyaWRIZWxwZXIsIEdyb3VwLCBIYWxmRmxvYXRUeXBlLCBIZW1pc3BoZXJlTGlnaHQsIEhlbWlzcGhlcmVMaWdodEhlbHBlciwgSGVtaXNwaGVyZUxpZ2h0UHJvYmUsIEljb3NhaGVkcm9uR2VvbWV0cnkgYXMgSWNvc2FoZWRyb25CdWZmZXJHZW9tZXRyeSwgSWNvc2FoZWRyb25HZW9tZXRyeSwgSW1hZ2VCaXRtYXBMb2FkZXIsIEltYWdlTG9hZGVyLCBJbWFnZVV0aWxzLCBJbW1lZGlhdGVSZW5kZXJPYmplY3QsIEluY3JlbWVudFN0ZW5jaWxPcCwgSW5jcmVtZW50V3JhcFN0ZW5jaWxPcCwgSW5zdGFuY2VkQnVmZmVyQXR0cmlidXRlLCBJbnN0YW5jZWRCdWZmZXJHZW9tZXRyeSwgSW5zdGFuY2VkSW50ZXJsZWF2ZWRCdWZmZXIsIEluc3RhbmNlZE1lc2gsIEludDE2QXR0cmlidXRlLCBJbnQxNkJ1ZmZlckF0dHJpYnV0ZSwgSW50MzJBdHRyaWJ1dGUsIEludDMyQnVmZmVyQXR0cmlidXRlLCBJbnQ4QXR0cmlidXRlLCBJbnQ4QnVmZmVyQXR0cmlidXRlLCBJbnRUeXBlLCBJbnRlcmxlYXZlZEJ1ZmZlciwgSW50ZXJsZWF2ZWRCdWZmZXJBdHRyaWJ1dGUsIEludGVycG9sYW50LCBJbnRlcnBvbGF0ZURpc2NyZXRlLCBJbnRlcnBvbGF0ZUxpbmVhciwgSW50ZXJwb2xhdGVTbW9vdGgsIEludmVydFN0ZW5jaWxPcCwgSlNPTkxvYWRlciwgS2VlcFN0ZW5jaWxPcCwgS2V5ZnJhbWVUcmFjaywgTE9ELCBMYXRoZUdlb21ldHJ5IGFzIExhdGhlQnVmZmVyR2VvbWV0cnksIExhdGhlR2VvbWV0cnksIExheWVycywgTGVuc0ZsYXJlLCBMZXNzRGVwdGgsIExlc3NFcXVhbERlcHRoLCBMZXNzRXF1YWxTdGVuY2lsRnVuYywgTGVzc1N0ZW5jaWxGdW5jLCBMaWdodCwgTGlnaHRQcm9iZSwgTGluZSwgTGluZTMsIExpbmVCYXNpY01hdGVyaWFsLCBMaW5lQ3VydmUsIExpbmVDdXJ2ZTMsIExpbmVEYXNoZWRNYXRlcmlhbCwgTGluZUxvb3AsIExpbmVQaWVjZXMsIExpbmVTZWdtZW50cywgTGluZVN0cmlwLCBMaW5lYXJFbmNvZGluZywgTGluZWFyRmlsdGVyLCBMaW5lYXJJbnRlcnBvbGFudCwgTGluZWFyTWlwTWFwTGluZWFyRmlsdGVyLCBMaW5lYXJNaXBNYXBOZWFyZXN0RmlsdGVyLCBMaW5lYXJNaXBtYXBMaW5lYXJGaWx0ZXIsIExpbmVhck1pcG1hcE5lYXJlc3RGaWx0ZXIsIExpbmVhclRvbmVNYXBwaW5nLCBMb2FkZXIsIExvYWRlclV0aWxzLCBMb2FkaW5nTWFuYWdlciwgTG9vcE9uY2UsIExvb3BQaW5nUG9uZywgTG9vcFJlcGVhdCwgTHVtaW5hbmNlQWxwaGFGb3JtYXQsIEx1bWluYW5jZUZvcm1hdCwgTU9VU0UsIE1hdGVyaWFsLCBNYXRlcmlhbExvYWRlciwgTWF0aFV0aWxzIGFzIE1hdGgsIE1hdGhVdGlscywgTWF0cml4MywgTWF0cml4NCwgTWF4RXF1YXRpb24sIE1lc2gsIE1lc2hCYXNpY01hdGVyaWFsLCBNZXNoRGVwdGhNYXRlcmlhbCwgTWVzaERpc3RhbmNlTWF0ZXJpYWwsIE1lc2hGYWNlTWF0ZXJpYWwsIE1lc2hMYW1iZXJ0TWF0ZXJpYWwsIE1lc2hNYXRjYXBNYXRlcmlhbCwgTWVzaE5vcm1hbE1hdGVyaWFsLCBNZXNoUGhvbmdNYXRlcmlhbCwgTWVzaFBoeXNpY2FsTWF0ZXJpYWwsIE1lc2hTdGFuZGFyZE1hdGVyaWFsLCBNZXNoVG9vbk1hdGVyaWFsLCBNaW5FcXVhdGlvbiwgTWlycm9yZWRSZXBlYXRXcmFwcGluZywgTWl4T3BlcmF0aW9uLCBNdWx0aU1hdGVyaWFsLCBNdWx0aXBseUJsZW5kaW5nLCBNdWx0aXBseU9wZXJhdGlvbiwgTmVhcmVzdEZpbHRlciwgTmVhcmVzdE1pcE1hcExpbmVhckZpbHRlciwgTmVhcmVzdE1pcE1hcE5lYXJlc3RGaWx0ZXIsIE5lYXJlc3RNaXBtYXBMaW5lYXJGaWx0ZXIsIE5lYXJlc3RNaXBtYXBOZWFyZXN0RmlsdGVyLCBOZXZlckRlcHRoLCBOZXZlclN0ZW5jaWxGdW5jLCBOb0JsZW5kaW5nLCBOb0NvbG9ycywgTm9Ub25lTWFwcGluZywgTm9ybWFsQW5pbWF0aW9uQmxlbmRNb2RlLCBOb3JtYWxCbGVuZGluZywgTm90RXF1YWxEZXB0aCwgTm90RXF1YWxTdGVuY2lsRnVuYywgTnVtYmVyS2V5ZnJhbWVUcmFjaywgT2JqZWN0M0QsIE9iamVjdExvYWRlciwgT2JqZWN0U3BhY2VOb3JtYWxNYXAsIE9jdGFoZWRyb25HZW9tZXRyeSBhcyBPY3RhaGVkcm9uQnVmZmVyR2VvbWV0cnksIE9jdGFoZWRyb25HZW9tZXRyeSwgT25lRmFjdG9yLCBPbmVNaW51c0RzdEFscGhhRmFjdG9yLCBPbmVNaW51c0RzdENvbG9yRmFjdG9yLCBPbmVNaW51c1NyY0FscGhhRmFjdG9yLCBPbmVNaW51c1NyY0NvbG9yRmFjdG9yLCBPcnRob2dyYXBoaWNDYW1lcmEsIFBDRlNoYWRvd01hcCwgUENGU29mdFNoYWRvd01hcCwgUE1SRU1HZW5lcmF0b3IsIFBhcmFtZXRyaWNHZW9tZXRyeSwgUGFydGljbGUsIFBhcnRpY2xlQmFzaWNNYXRlcmlhbCwgUGFydGljbGVTeXN0ZW0sIFBhcnRpY2xlU3lzdGVtTWF0ZXJpYWwsIFBhdGgsIFBlcnNwZWN0aXZlQ2FtZXJhLCBQbGFuZSwgUGxhbmVHZW9tZXRyeSBhcyBQbGFuZUJ1ZmZlckdlb21ldHJ5LCBQbGFuZUdlb21ldHJ5LCBQbGFuZUhlbHBlciwgUG9pbnRDbG91ZCwgUG9pbnRDbG91ZE1hdGVyaWFsLCBQb2ludExpZ2h0LCBQb2ludExpZ2h0SGVscGVyLCBQb2ludHMsIFBvaW50c01hdGVyaWFsLCBQb2xhckdyaWRIZWxwZXIsIFBvbHloZWRyb25HZW9tZXRyeSBhcyBQb2x5aGVkcm9uQnVmZmVyR2VvbWV0cnksIFBvbHloZWRyb25HZW9tZXRyeSwgUG9zaXRpb25hbEF1ZGlvLCBQcm9wZXJ0eUJpbmRpbmcsIFByb3BlcnR5TWl4ZXIsIFF1YWRyYXRpY0JlemllckN1cnZlLCBRdWFkcmF0aWNCZXppZXJDdXJ2ZTMsIFF1YXRlcm5pb24sIFF1YXRlcm5pb25LZXlmcmFtZVRyYWNrLCBRdWF0ZXJuaW9uTGluZWFySW50ZXJwb2xhbnQsIFJFVklTSU9OLCBSR0JBRGVwdGhQYWNraW5nLCBSR0JBRm9ybWF0LCBSR0JBSW50ZWdlckZvcm1hdCwgUkdCQV9BU1RDXzEweDEwX0Zvcm1hdCwgUkdCQV9BU1RDXzEweDVfRm9ybWF0LCBSR0JBX0FTVENfMTB4Nl9Gb3JtYXQsIFJHQkFfQVNUQ18xMHg4X0Zvcm1hdCwgUkdCQV9BU1RDXzEyeDEwX0Zvcm1hdCwgUkdCQV9BU1RDXzEyeDEyX0Zvcm1hdCwgUkdCQV9BU1RDXzR4NF9Gb3JtYXQsIFJHQkFfQVNUQ181eDRfRm9ybWF0LCBSR0JBX0FTVENfNXg1X0Zvcm1hdCwgUkdCQV9BU1RDXzZ4NV9Gb3JtYXQsIFJHQkFfQVNUQ182eDZfRm9ybWF0LCBSR0JBX0FTVENfOHg1X0Zvcm1hdCwgUkdCQV9BU1RDXzh4Nl9Gb3JtYXQsIFJHQkFfQVNUQ184eDhfRm9ybWF0LCBSR0JBX0JQVENfRm9ybWF0LCBSR0JBX0VUQzJfRUFDX0Zvcm1hdCwgUkdCQV9QVlJUQ18yQlBQVjFfRm9ybWF0LCBSR0JBX1BWUlRDXzRCUFBWMV9Gb3JtYXQsIFJHQkFfUzNUQ19EWFQxX0Zvcm1hdCwgUkdCQV9TM1RDX0RYVDNfRm9ybWF0LCBSR0JBX1MzVENfRFhUNV9Gb3JtYXQsIFJHQkZvcm1hdCwgUkdCX0VUQzFfRm9ybWF0LCBSR0JfRVRDMl9Gb3JtYXQsIFJHQl9QVlJUQ18yQlBQVjFfRm9ybWF0LCBSR0JfUFZSVENfNEJQUFYxX0Zvcm1hdCwgUkdCX1MzVENfRFhUMV9Gb3JtYXQsIFJHRm9ybWF0LCBSR0ludGVnZXJGb3JtYXQsIFJhd1NoYWRlck1hdGVyaWFsLCBSYXksIFJheWNhc3RlciwgUmVjdEFyZWFMaWdodCwgUmVkRm9ybWF0LCBSZWRJbnRlZ2VyRm9ybWF0LCBSZWluaGFyZFRvbmVNYXBwaW5nLCBSZXBlYXRXcmFwcGluZywgUmVwbGFjZVN0ZW5jaWxPcCwgUmV2ZXJzZVN1YnRyYWN0RXF1YXRpb24sIFJpbmdHZW9tZXRyeSBhcyBSaW5nQnVmZmVyR2VvbWV0cnksIFJpbmdHZW9tZXRyeSwgU2NlbmUsIFNjZW5lVXRpbHMsIFNoYWRlckNodW5rLCBTaGFkZXJMaWIsIFNoYWRlck1hdGVyaWFsLCBTaGFkb3dNYXRlcmlhbCwgU2hhcGUsIFNoYXBlR2VvbWV0cnkgYXMgU2hhcGVCdWZmZXJHZW9tZXRyeSwgU2hhcGVHZW9tZXRyeSwgU2hhcGVQYXRoLCBTaGFwZVV0aWxzLCBTaG9ydFR5cGUsIFNrZWxldG9uLCBTa2VsZXRvbkhlbHBlciwgU2tpbm5lZE1lc2gsIFNtb290aFNoYWRpbmcsIFNwaGVyZSwgU3BoZXJlR2VvbWV0cnkgYXMgU3BoZXJlQnVmZmVyR2VvbWV0cnksIFNwaGVyZUdlb21ldHJ5LCBTcGhlcmljYWwsIFNwaGVyaWNhbEhhcm1vbmljczMsIFNwbGluZUN1cnZlLCBTcG90TGlnaHQsIFNwb3RMaWdodEhlbHBlciwgU3ByaXRlLCBTcHJpdGVNYXRlcmlhbCwgU3JjQWxwaGFGYWN0b3IsIFNyY0FscGhhU2F0dXJhdGVGYWN0b3IsIFNyY0NvbG9yRmFjdG9yLCBTdGF0aWNDb3B5VXNhZ2UsIFN0YXRpY0RyYXdVc2FnZSwgU3RhdGljUmVhZFVzYWdlLCBTdGVyZW9DYW1lcmEsIFN0cmVhbUNvcHlVc2FnZSwgU3RyZWFtRHJhd1VzYWdlLCBTdHJlYW1SZWFkVXNhZ2UsIFN0cmluZ0tleWZyYW1lVHJhY2ssIFN1YnRyYWN0RXF1YXRpb24sIFN1YnRyYWN0aXZlQmxlbmRpbmcsIFRPVUNILCBUYW5nZW50U3BhY2VOb3JtYWxNYXAsIFRldHJhaGVkcm9uR2VvbWV0cnkgYXMgVGV0cmFoZWRyb25CdWZmZXJHZW9tZXRyeSwgVGV0cmFoZWRyb25HZW9tZXRyeSwgVGV4dEdlb21ldHJ5LCBUZXh0dXJlLCBUZXh0dXJlTG9hZGVyLCBUb3J1c0dlb21ldHJ5IGFzIFRvcnVzQnVmZmVyR2VvbWV0cnksIFRvcnVzR2VvbWV0cnksIFRvcnVzS25vdEdlb21ldHJ5IGFzIFRvcnVzS25vdEJ1ZmZlckdlb21ldHJ5LCBUb3J1c0tub3RHZW9tZXRyeSwgVHJpYW5nbGUsIFRyaWFuZ2xlRmFuRHJhd01vZGUsIFRyaWFuZ2xlU3RyaXBEcmF3TW9kZSwgVHJpYW5nbGVzRHJhd01vZGUsIFR1YmVHZW9tZXRyeSBhcyBUdWJlQnVmZmVyR2VvbWV0cnksIFR1YmVHZW9tZXRyeSwgVVZNYXBwaW5nLCBVaW50MTZBdHRyaWJ1dGUsIFVpbnQxNkJ1ZmZlckF0dHJpYnV0ZSwgVWludDMyQXR0cmlidXRlLCBVaW50MzJCdWZmZXJBdHRyaWJ1dGUsIFVpbnQ4QXR0cmlidXRlLCBVaW50OEJ1ZmZlckF0dHJpYnV0ZSwgVWludDhDbGFtcGVkQXR0cmlidXRlLCBVaW50OENsYW1wZWRCdWZmZXJBdHRyaWJ1dGUsIFVuaWZvcm0sIFVuaWZvcm1zTGliLCBVbmlmb3Jtc1V0aWxzLCBVbnNpZ25lZEJ5dGVUeXBlLCBVbnNpZ25lZEludDI0OFR5cGUsIFVuc2lnbmVkSW50VHlwZSwgVW5zaWduZWRTaG9ydDQ0NDRUeXBlLCBVbnNpZ25lZFNob3J0NTU1MVR5cGUsIFVuc2lnbmVkU2hvcnRUeXBlLCBWU01TaGFkb3dNYXAsIFZlY3RvcjIsIFZlY3RvcjMsIFZlY3RvcjQsIFZlY3RvcktleWZyYW1lVHJhY2ssIFZlcnRleCwgVmVydGV4Q29sb3JzLCBWaWRlb1RleHR1cmUsIFdlYkdMMVJlbmRlcmVyLCBXZWJHTEN1YmVSZW5kZXJUYXJnZXQsIFdlYkdMTXVsdGlwbGVSZW5kZXJUYXJnZXRzLCBXZWJHTE11bHRpc2FtcGxlUmVuZGVyVGFyZ2V0LCBXZWJHTFJlbmRlclRhcmdldCwgV2ViR0xSZW5kZXJUYXJnZXRDdWJlLCBXZWJHTFJlbmRlcmVyLCBXZWJHTFV0aWxzLCBXaXJlZnJhbWVHZW9tZXRyeSwgV2lyZWZyYW1lSGVscGVyLCBXcmFwQXJvdW5kRW5kaW5nLCBYSFJMb2FkZXIsIFplcm9DdXJ2YXR1cmVFbmRpbmcsIFplcm9GYWN0b3IsIFplcm9TbG9wZUVuZGluZywgWmVyb1N0ZW5jaWxPcCwgX1NSR0JBRm9ybWF0LCBzUkdCRW5jb2RpbmcgfTsK"},{"version":3,"sources":["/home/diane/Documents/MDT/portfolio/node_modules/three/build/three.module.js"],"sourcesContent":["/**\n * @license\n * Copyright 2010-2022 Three.js Authors\n * SPDX-License-Identifier: MIT\n */\nconst REVISION = '137';\nconst MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2, ROTATE: 0, DOLLY: 1, PAN: 2 };\nconst TOUCH = { ROTATE: 0, PAN: 1, DOLLY_PAN: 2, DOLLY_ROTATE: 3 };\nconst CullFaceNone = 0;\nconst CullFaceBack = 1;\nconst CullFaceFront = 2;\nconst CullFaceFrontBack = 3;\nconst BasicShadowMap = 0;\nconst PCFShadowMap = 1;\nconst PCFSoftShadowMap = 2;\nconst VSMShadowMap = 3;\nconst FrontSide = 0;\nconst BackSide = 1;\nconst DoubleSide = 2;\nconst FlatShading = 1;\nconst SmoothShading = 2;\nconst NoBlending = 0;\nconst NormalBlending = 1;\nconst AdditiveBlending = 2;\nconst SubtractiveBlending = 3;\nconst MultiplyBlending = 4;\nconst CustomBlending = 5;\nconst AddEquation = 100;\nconst SubtractEquation = 101;\nconst ReverseSubtractEquation = 102;\nconst MinEquation = 103;\nconst MaxEquation = 104;\nconst ZeroFactor = 200;\nconst OneFactor = 201;\nconst SrcColorFactor = 202;\nconst OneMinusSrcColorFactor = 203;\nconst SrcAlphaFactor = 204;\nconst OneMinusSrcAlphaFactor = 205;\nconst DstAlphaFactor = 206;\nconst OneMinusDstAlphaFactor = 207;\nconst DstColorFactor = 208;\nconst OneMinusDstColorFactor = 209;\nconst SrcAlphaSaturateFactor = 210;\nconst NeverDepth = 0;\nconst AlwaysDepth = 1;\nconst LessDepth = 2;\nconst LessEqualDepth = 3;\nconst EqualDepth = 4;\nconst GreaterEqualDepth = 5;\nconst GreaterDepth = 6;\nconst NotEqualDepth = 7;\nconst MultiplyOperation = 0;\nconst MixOperation = 1;\nconst AddOperation = 2;\nconst NoToneMapping = 0;\nconst LinearToneMapping = 1;\nconst ReinhardToneMapping = 2;\nconst CineonToneMapping = 3;\nconst ACESFilmicToneMapping = 4;\nconst CustomToneMapping = 5;\n\nconst UVMapping = 300;\nconst CubeReflectionMapping = 301;\nconst CubeRefractionMapping = 302;\nconst EquirectangularReflectionMapping = 303;\nconst EquirectangularRefractionMapping = 304;\nconst CubeUVReflectionMapping = 306;\nconst CubeUVRefractionMapping = 307;\nconst RepeatWrapping = 1000;\nconst ClampToEdgeWrapping = 1001;\nconst MirroredRepeatWrapping = 1002;\nconst NearestFilter = 1003;\nconst NearestMipmapNearestFilter = 1004;\nconst NearestMipMapNearestFilter = 1004;\nconst NearestMipmapLinearFilter = 1005;\nconst NearestMipMapLinearFilter = 1005;\nconst LinearFilter = 1006;\nconst LinearMipmapNearestFilter = 1007;\nconst LinearMipMapNearestFilter = 1007;\nconst LinearMipmapLinearFilter = 1008;\nconst LinearMipMapLinearFilter = 1008;\nconst UnsignedByteType = 1009;\nconst ByteType = 1010;\nconst ShortType = 1011;\nconst UnsignedShortType = 1012;\nconst IntType = 1013;\nconst UnsignedIntType = 1014;\nconst FloatType = 1015;\nconst HalfFloatType = 1016;\nconst UnsignedShort4444Type = 1017;\nconst UnsignedShort5551Type = 1018;\nconst UnsignedInt248Type = 1020;\nconst AlphaFormat = 1021;\nconst RGBFormat = 1022;\nconst RGBAFormat = 1023;\nconst LuminanceFormat = 1024;\nconst LuminanceAlphaFormat = 1025;\nconst DepthFormat = 1026;\nconst DepthStencilFormat = 1027;\nconst RedFormat = 1028;\nconst RedIntegerFormat = 1029;\nconst RGFormat = 1030;\nconst RGIntegerFormat = 1031;\nconst RGBAIntegerFormat = 1033;\n\nconst RGB_S3TC_DXT1_Format = 33776;\nconst RGBA_S3TC_DXT1_Format = 33777;\nconst RGBA_S3TC_DXT3_Format = 33778;\nconst RGBA_S3TC_DXT5_Format = 33779;\nconst RGB_PVRTC_4BPPV1_Format = 35840;\nconst RGB_PVRTC_2BPPV1_Format = 35841;\nconst RGBA_PVRTC_4BPPV1_Format = 35842;\nconst RGBA_PVRTC_2BPPV1_Format = 35843;\nconst RGB_ETC1_Format = 36196;\nconst RGB_ETC2_Format = 37492;\nconst RGBA_ETC2_EAC_Format = 37496;\nconst RGBA_ASTC_4x4_Format = 37808;\nconst RGBA_ASTC_5x4_Format = 37809;\nconst RGBA_ASTC_5x5_Format = 37810;\nconst RGBA_ASTC_6x5_Format = 37811;\nconst RGBA_ASTC_6x6_Format = 37812;\nconst RGBA_ASTC_8x5_Format = 37813;\nconst RGBA_ASTC_8x6_Format = 37814;\nconst RGBA_ASTC_8x8_Format = 37815;\nconst RGBA_ASTC_10x5_Format = 37816;\nconst RGBA_ASTC_10x6_Format = 37817;\nconst RGBA_ASTC_10x8_Format = 37818;\nconst RGBA_ASTC_10x10_Format = 37819;\nconst RGBA_ASTC_12x10_Format = 37820;\nconst RGBA_ASTC_12x12_Format = 37821;\nconst RGBA_BPTC_Format = 36492;\nconst LoopOnce = 2200;\nconst LoopRepeat = 2201;\nconst LoopPingPong = 2202;\nconst InterpolateDiscrete = 2300;\nconst InterpolateLinear = 2301;\nconst InterpolateSmooth = 2302;\nconst ZeroCurvatureEnding = 2400;\nconst ZeroSlopeEnding = 2401;\nconst WrapAroundEnding = 2402;\nconst NormalAnimationBlendMode = 2500;\nconst AdditiveAnimationBlendMode = 2501;\nconst TrianglesDrawMode = 0;\nconst TriangleStripDrawMode = 1;\nconst TriangleFanDrawMode = 2;\nconst LinearEncoding = 3000;\nconst sRGBEncoding = 3001;\nconst BasicDepthPacking = 3200;\nconst RGBADepthPacking = 3201;\nconst TangentSpaceNormalMap = 0;\nconst ObjectSpaceNormalMap = 1;\n\nconst ZeroStencilOp = 0;\nconst KeepStencilOp = 7680;\nconst ReplaceStencilOp = 7681;\nconst IncrementStencilOp = 7682;\nconst DecrementStencilOp = 7683;\nconst IncrementWrapStencilOp = 34055;\nconst DecrementWrapStencilOp = 34056;\nconst InvertStencilOp = 5386;\n\nconst NeverStencilFunc = 512;\nconst LessStencilFunc = 513;\nconst EqualStencilFunc = 514;\nconst LessEqualStencilFunc = 515;\nconst GreaterStencilFunc = 516;\nconst NotEqualStencilFunc = 517;\nconst GreaterEqualStencilFunc = 518;\nconst AlwaysStencilFunc = 519;\n\nconst StaticDrawUsage = 35044;\nconst DynamicDrawUsage = 35048;\nconst StreamDrawUsage = 35040;\nconst StaticReadUsage = 35045;\nconst DynamicReadUsage = 35049;\nconst StreamReadUsage = 35041;\nconst StaticCopyUsage = 35046;\nconst DynamicCopyUsage = 35050;\nconst StreamCopyUsage = 35042;\n\nconst GLSL1 = '100';\nconst GLSL3 = '300 es';\n\nconst _SRGBAFormat = 1035; // fallback for WebGL 1\n\n/**\n * https://github.com/mrdoob/eventdispatcher.js/\n */\n\nclass EventDispatcher {\n\n\taddEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) this._listeners = {};\n\n\t\tconst listeners = this._listeners;\n\n\t\tif ( listeners[ type ] === undefined ) {\n\n\t\t\tlisteners[ type ] = [];\n\n\t\t}\n\n\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\n\n\t\t\tlisteners[ type ].push( listener );\n\n\t\t}\n\n\t}\n\n\thasEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) return false;\n\n\t\tconst listeners = this._listeners;\n\n\t\treturn listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1;\n\n\t}\n\n\tremoveEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) return;\n\n\t\tconst listeners = this._listeners;\n\t\tconst listenerArray = listeners[ type ];\n\n\t\tif ( listenerArray !== undefined ) {\n\n\t\t\tconst index = listenerArray.indexOf( listener );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\tlistenerArray.splice( index, 1 );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tdispatchEvent( event ) {\n\n\t\tif ( this._listeners === undefined ) return;\n\n\t\tconst listeners = this._listeners;\n\t\tconst listenerArray = listeners[ event.type ];\n\n\t\tif ( listenerArray !== undefined ) {\n\n\t\t\tevent.target = this;\n\n\t\t\t// Make a copy, in case listeners are removed while iterating.\n\t\t\tconst array = listenerArray.slice( 0 );\n\n\t\t\tfor ( let i = 0, l = array.length; i < l; i ++ ) {\n\n\t\t\t\tarray[ i ].call( this, event );\n\n\t\t\t}\n\n\t\t\tevent.target = null;\n\n\t\t}\n\n\t}\n\n}\n\nconst _lut = [];\n\nfor ( let i = 0; i < 256; i ++ ) {\n\n\t_lut[ i ] = ( i < 16 ? '0' : '' ) + ( i ).toString( 16 );\n\n}\n\nlet _seed = 1234567;\n\n\nconst DEG2RAD = Math.PI / 180;\nconst RAD2DEG = 180 / Math.PI;\n\n// http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\nfunction generateUUID() {\n\n\tconst d0 = Math.random() * 0xffffffff | 0;\n\tconst d1 = Math.random() * 0xffffffff | 0;\n\tconst d2 = Math.random() * 0xffffffff | 0;\n\tconst d3 = Math.random() * 0xffffffff | 0;\n\tconst uuid = _lut[ d0 & 0xff ] + _lut[ d0 >> 8 & 0xff ] + _lut[ d0 >> 16 & 0xff ] + _lut[ d0 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d1 & 0xff ] + _lut[ d1 >> 8 & 0xff ] + '-' + _lut[ d1 >> 16 & 0x0f | 0x40 ] + _lut[ d1 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d2 & 0x3f | 0x80 ] + _lut[ d2 >> 8 & 0xff ] + '-' + _lut[ d2 >> 16 & 0xff ] + _lut[ d2 >> 24 & 0xff ] +\n\t\t\t_lut[ d3 & 0xff ] + _lut[ d3 >> 8 & 0xff ] + _lut[ d3 >> 16 & 0xff ] + _lut[ d3 >> 24 & 0xff ];\n\n\t// .toUpperCase() here flattens concatenated strings to save heap memory space.\n\treturn uuid.toUpperCase();\n\n}\n\nfunction clamp( value, min, max ) {\n\n\treturn Math.max( min, Math.min( max, value ) );\n\n}\n\n// compute euclidian modulo of m % n\n// https://en.wikipedia.org/wiki/Modulo_operation\nfunction euclideanModulo( n, m ) {\n\n\treturn ( ( n % m ) + m ) % m;\n\n}\n\n// Linear mapping from range <a1, a2> to range <b1, b2>\nfunction mapLinear( x, a1, a2, b1, b2 ) {\n\n\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\n\n}\n\n// https://www.gamedev.net/tutorials/programming/general-and-gameplay-programming/inverse-lerp-a-super-useful-yet-often-overlooked-function-r5230/\nfunction inverseLerp( x, y, value ) {\n\n\tif ( x !== y ) {\n\n\t\treturn ( value - x ) / ( y - x );\n\n\t} else {\n\n\t\treturn 0;\n\n\t}\n\n}\n\n// https://en.wikipedia.org/wiki/Linear_interpolation\nfunction lerp( x, y, t ) {\n\n\treturn ( 1 - t ) * x + t * y;\n\n}\n\n// http://www.rorydriscoll.com/2016/03/07/frame-rate-independent-damping-using-lerp/\nfunction damp( x, y, lambda, dt ) {\n\n\treturn lerp( x, y, 1 - Math.exp( - lambda * dt ) );\n\n}\n\n// https://www.desmos.com/calculator/vcsjnyz7x4\nfunction pingpong( x, length = 1 ) {\n\n\treturn length - Math.abs( euclideanModulo( x, length * 2 ) - length );\n\n}\n\n// http://en.wikipedia.org/wiki/Smoothstep\nfunction smoothstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * ( 3 - 2 * x );\n\n}\n\nfunction smootherstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\n\n}\n\n// Random integer from <low, high> interval\nfunction randInt( low, high ) {\n\n\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\n\n}\n\n// Random float from <low, high> interval\nfunction randFloat( low, high ) {\n\n\treturn low + Math.random() * ( high - low );\n\n}\n\n// Random float from <-range/2, range/2> interval\nfunction randFloatSpread( range ) {\n\n\treturn range * ( 0.5 - Math.random() );\n\n}\n\n// Deterministic pseudo-random float in the interval [ 0, 1 ]\nfunction seededRandom( s ) {\n\n\tif ( s !== undefined ) _seed = s % 2147483647;\n\n\t// Park-Miller algorithm\n\n\t_seed = _seed * 16807 % 2147483647;\n\n\treturn ( _seed - 1 ) / 2147483646;\n\n}\n\nfunction degToRad( degrees ) {\n\n\treturn degrees * DEG2RAD;\n\n}\n\nfunction radToDeg( radians ) {\n\n\treturn radians * RAD2DEG;\n\n}\n\nfunction isPowerOfTwo( value ) {\n\n\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\n\n}\n\nfunction ceilPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.ceil( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction floorPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.floor( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction setQuaternionFromProperEuler( q, a, b, c, order ) {\n\n\t// Intrinsic Proper Euler Angles - see https://en.wikipedia.org/wiki/Euler_angles\n\n\t// rotations are applied to the axes in the order specified by 'order'\n\t// rotation by angle 'a' is applied first, then by angle 'b', then by angle 'c'\n\t// angles are in radians\n\n\tconst cos = Math.cos;\n\tconst sin = Math.sin;\n\n\tconst c2 = cos( b / 2 );\n\tconst s2 = sin( b / 2 );\n\n\tconst c13 = cos( ( a + c ) / 2 );\n\tconst s13 = sin( ( a + c ) / 2 );\n\n\tconst c1_3 = cos( ( a - c ) / 2 );\n\tconst s1_3 = sin( ( a - c ) / 2 );\n\n\tconst c3_1 = cos( ( c - a ) / 2 );\n\tconst s3_1 = sin( ( c - a ) / 2 );\n\n\tswitch ( order ) {\n\n\t\tcase 'XYX':\n\t\t\tq.set( c2 * s13, s2 * c1_3, s2 * s1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YZY':\n\t\t\tq.set( s2 * s1_3, c2 * s13, s2 * c1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZXZ':\n\t\t\tq.set( s2 * c1_3, s2 * s1_3, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'XZX':\n\t\t\tq.set( c2 * s13, s2 * s3_1, s2 * c3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YXY':\n\t\t\tq.set( s2 * c3_1, c2 * s13, s2 * s3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZYZ':\n\t\t\tq.set( s2 * s3_1, s2 * c3_1, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tconsole.warn( 'THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: ' + order );\n\n\t}\n\n}\n\nvar MathUtils = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tDEG2RAD: DEG2RAD,\n\tRAD2DEG: RAD2DEG,\n\tgenerateUUID: generateUUID,\n\tclamp: clamp,\n\teuclideanModulo: euclideanModulo,\n\tmapLinear: mapLinear,\n\tinverseLerp: inverseLerp,\n\tlerp: lerp,\n\tdamp: damp,\n\tpingpong: pingpong,\n\tsmoothstep: smoothstep,\n\tsmootherstep: smootherstep,\n\trandInt: randInt,\n\trandFloat: randFloat,\n\trandFloatSpread: randFloatSpread,\n\tseededRandom: seededRandom,\n\tdegToRad: degToRad,\n\tradToDeg: radToDeg,\n\tisPowerOfTwo: isPowerOfTwo,\n\tceilPowerOfTwo: ceilPowerOfTwo,\n\tfloorPowerOfTwo: floorPowerOfTwo,\n\tsetQuaternionFromProperEuler: setQuaternionFromProperEuler\n});\n\nclass Vector2 {\n\n\tconstructor( x = 0, y = 0 ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\n\t}\n\n\tget width() {\n\n\t\treturn this.x;\n\n\t}\n\n\tset width( value ) {\n\n\t\tthis.x = value;\n\n\t}\n\n\tget height() {\n\n\t\treturn this.y;\n\n\t}\n\n\tset height( value ) {\n\n\t\tthis.y = value;\n\n\t}\n\n\tset( x, y ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\treturn this.addVectors( v, w );\n\n\t\t}\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\treturn this.subVectors( v, w );\n\n\t\t}\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tdivide( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tconst x = this.x, y = this.y;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ];\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ];\n\n\t\treturn this;\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y;\n\n\t}\n\n\tcross( v ) {\n\n\t\treturn this.x * v.y - this.y * v.x;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tangle() {\n\n\t\t// computes the angle in radians with respect to the positive x-axis\n\n\t\tconst angle = Math.atan2( - this.y, - this.x ) + Math.PI;\n\n\t\treturn angle;\n\n\t}\n\n\tdistanceTo( v ) {\n\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t}\n\n\tdistanceToSquared( v ) {\n\n\t\tconst dx = this.x - v.x, dy = this.y - v.y;\n\t\treturn dx * dx + dy * dy;\n\n\t}\n\n\tmanhattanDistanceTo( v ) {\n\n\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index, offset ) {\n\n\t\tif ( offset !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector2: offset has been removed from .fromBufferAttribute().' );\n\n\t\t}\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\n\t\treturn this;\n\n\t}\n\n\trotateAround( center, angle ) {\n\n\t\tconst c = Math.cos( angle ), s = Math.sin( angle );\n\n\t\tconst x = this.x - center.x;\n\t\tconst y = this.y - center.y;\n\n\t\tthis.x = x * c - y * s + center.x;\n\t\tthis.y = x * s + y * c + center.y;\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\n\t}\n\n}\n\nVector2.prototype.isVector2 = true;\n\nclass Matrix3 {\n\n\tconstructor() {\n\n\t\tthis.elements = [\n\n\t\t\t1, 0, 0,\n\t\t\t0, 1, 0,\n\t\t\t0, 0, 1\n\n\t\t];\n\n\t\tif ( arguments.length > 0 ) {\n\n\t\t\tconsole.error( 'THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.' );\n\n\t\t}\n\n\t}\n\n\tset( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 1 ] = n21; te[ 2 ] = n31;\n\t\tte[ 3 ] = n12; te[ 4 ] = n22; te[ 5 ] = n32;\n\t\tte[ 6 ] = n13; te[ 7 ] = n23; te[ 8 ] = n33;\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0,\n\t\t\t0, 1, 0,\n\t\t\t0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tcopy( m ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ];\n\t\tte[ 3 ] = me[ 3 ]; te[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ];\n\t\tte[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ]; te[ 8 ] = me[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\textractBasis( xAxis, yAxis, zAxis ) {\n\n\t\txAxis.setFromMatrix3Column( this, 0 );\n\t\tyAxis.setFromMatrix3Column( this, 1 );\n\t\tzAxis.setFromMatrix3Column( this, 2 );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrix4( m ) {\n\n\t\tconst me = m.elements;\n\n\t\tthis.set(\n\n\t\t\tme[ 0 ], me[ 4 ], me[ 8 ],\n\t\t\tme[ 1 ], me[ 5 ], me[ 9 ],\n\t\t\tme[ 2 ], me[ 6 ], me[ 10 ]\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( m ) {\n\n\t\treturn this.multiplyMatrices( this, m );\n\n\t}\n\n\tpremultiply( m ) {\n\n\t\treturn this.multiplyMatrices( m, this );\n\n\t}\n\n\tmultiplyMatrices( a, b ) {\n\n\t\tconst ae = a.elements;\n\t\tconst be = b.elements;\n\t\tconst te = this.elements;\n\n\t\tconst a11 = ae[ 0 ], a12 = ae[ 3 ], a13 = ae[ 6 ];\n\t\tconst a21 = ae[ 1 ], a22 = ae[ 4 ], a23 = ae[ 7 ];\n\t\tconst a31 = ae[ 2 ], a32 = ae[ 5 ], a33 = ae[ 8 ];\n\n\t\tconst b11 = be[ 0 ], b12 = be[ 3 ], b13 = be[ 6 ];\n\t\tconst b21 = be[ 1 ], b22 = be[ 4 ], b23 = be[ 7 ];\n\t\tconst b31 = be[ 2 ], b32 = be[ 5 ], b33 = be[ 8 ];\n\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31;\n\t\tte[ 3 ] = a11 * b12 + a12 * b22 + a13 * b32;\n\t\tte[ 6 ] = a11 * b13 + a12 * b23 + a13 * b33;\n\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31;\n\t\tte[ 4 ] = a21 * b12 + a22 * b22 + a23 * b32;\n\t\tte[ 7 ] = a21 * b13 + a22 * b23 + a23 * b33;\n\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31;\n\t\tte[ 5 ] = a31 * b12 + a32 * b22 + a33 * b32;\n\t\tte[ 8 ] = a31 * b13 + a32 * b23 + a33 * b33;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\n\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\n\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\n\n\t\treturn this;\n\n\t}\n\n\tdeterminant() {\n\n\t\tconst te = this.elements;\n\n\t\tconst a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\n\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\n\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\n\n\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\n\n\t}\n\n\tinvert() {\n\n\t\tconst te = this.elements,\n\n\t\t\tn11 = te[ 0 ], n21 = te[ 1 ], n31 = te[ 2 ],\n\t\t\tn12 = te[ 3 ], n22 = te[ 4 ], n32 = te[ 5 ],\n\t\t\tn13 = te[ 6 ], n23 = te[ 7 ], n33 = te[ 8 ],\n\n\t\t\tt11 = n33 * n22 - n32 * n23,\n\t\t\tt12 = n32 * n13 - n33 * n12,\n\t\t\tt13 = n23 * n12 - n22 * n13,\n\n\t\t\tdet = n11 * t11 + n21 * t12 + n31 * t13;\n\n\t\tif ( det === 0 ) return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0 );\n\n\t\tconst detInv = 1 / det;\n\n\t\tte[ 0 ] = t11 * detInv;\n\t\tte[ 1 ] = ( n31 * n23 - n33 * n21 ) * detInv;\n\t\tte[ 2 ] = ( n32 * n21 - n31 * n22 ) * detInv;\n\n\t\tte[ 3 ] = t12 * detInv;\n\t\tte[ 4 ] = ( n33 * n11 - n31 * n13 ) * detInv;\n\t\tte[ 5 ] = ( n31 * n12 - n32 * n11 ) * detInv;\n\n\t\tte[ 6 ] = t13 * detInv;\n\t\tte[ 7 ] = ( n21 * n13 - n23 * n11 ) * detInv;\n\t\tte[ 8 ] = ( n22 * n11 - n21 * n12 ) * detInv;\n\n\t\treturn this;\n\n\t}\n\n\ttranspose() {\n\n\t\tlet tmp;\n\t\tconst m = this.elements;\n\n\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\n\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\n\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\n\n\t\treturn this;\n\n\t}\n\n\tgetNormalMatrix( matrix4 ) {\n\n\t\treturn this.setFromMatrix4( matrix4 ).invert().transpose();\n\n\t}\n\n\ttransposeIntoArray( r ) {\n\n\t\tconst m = this.elements;\n\n\t\tr[ 0 ] = m[ 0 ];\n\t\tr[ 1 ] = m[ 3 ];\n\t\tr[ 2 ] = m[ 6 ];\n\t\tr[ 3 ] = m[ 1 ];\n\t\tr[ 4 ] = m[ 4 ];\n\t\tr[ 5 ] = m[ 7 ];\n\t\tr[ 6 ] = m[ 2 ];\n\t\tr[ 7 ] = m[ 5 ];\n\t\tr[ 8 ] = m[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetUvTransform( tx, ty, sx, sy, rotation, cx, cy ) {\n\n\t\tconst c = Math.cos( rotation );\n\t\tconst s = Math.sin( rotation );\n\n\t\tthis.set(\n\t\t\tsx * c, sx * s, - sx * ( c * cx + s * cy ) + cx + tx,\n\t\t\t- sy * s, sy * c, - sy * ( - s * cx + c * cy ) + cy + ty,\n\t\t\t0, 0, 1\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tscale( sx, sy ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= sx; te[ 3 ] *= sx; te[ 6 ] *= sx;\n\t\tte[ 1 ] *= sy; te[ 4 ] *= sy; te[ 7 ] *= sy;\n\n\t\treturn this;\n\n\t}\n\n\trotate( theta ) {\n\n\t\tconst c = Math.cos( theta );\n\t\tconst s = Math.sin( theta );\n\n\t\tconst te = this.elements;\n\n\t\tconst a11 = te[ 0 ], a12 = te[ 3 ], a13 = te[ 6 ];\n\t\tconst a21 = te[ 1 ], a22 = te[ 4 ], a23 = te[ 7 ];\n\n\t\tte[ 0 ] = c * a11 + s * a21;\n\t\tte[ 3 ] = c * a12 + s * a22;\n\t\tte[ 6 ] = c * a13 + s * a23;\n\n\t\tte[ 1 ] = - s * a11 + c * a21;\n\t\tte[ 4 ] = - s * a12 + c * a22;\n\t\tte[ 7 ] = - s * a13 + c * a23;\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( tx, ty ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] += tx * te[ 2 ]; te[ 3 ] += tx * te[ 5 ]; te[ 6 ] += tx * te[ 8 ];\n\t\tte[ 1 ] += ty * te[ 2 ]; te[ 4 ] += ty * te[ 5 ]; te[ 7 ] += ty * te[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\tequals( matrix ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = matrix.elements;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst te = this.elements;\n\n\t\tarray[ offset ] = te[ 0 ];\n\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\tarray[ offset + 2 ] = te[ 2 ];\n\n\t\tarray[ offset + 3 ] = te[ 3 ];\n\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\tarray[ offset + 5 ] = te[ 5 ];\n\n\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\tarray[ offset + 7 ] = te[ 7 ];\n\t\tarray[ offset + 8 ] = te[ 8 ];\n\n\t\treturn array;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().fromArray( this.elements );\n\n\t}\n\n}\n\nMatrix3.prototype.isMatrix3 = true;\n\nfunction arrayNeedsUint32( array ) {\n\n\t// assumes larger values usually on last\n\n\tfor ( let i = array.length - 1; i >= 0; -- i ) {\n\n\t\tif ( array[ i ] > 65535 ) return true;\n\n\t}\n\n\treturn false;\n\n}\n\nconst TYPED_ARRAYS = {\n\tInt8Array: Int8Array,\n\tUint8Array: Uint8Array,\n\tUint8ClampedArray: Uint8ClampedArray,\n\tInt16Array: Int16Array,\n\tUint16Array: Uint16Array,\n\tInt32Array: Int32Array,\n\tUint32Array: Uint32Array,\n\tFloat32Array: Float32Array,\n\tFloat64Array: Float64Array\n};\n\nfunction getTypedArray( type, buffer ) {\n\n\treturn new TYPED_ARRAYS[ type ]( buffer );\n\n}\n\nfunction createElementNS( name ) {\n\n\treturn document.createElementNS( 'http://www.w3.org/1999/xhtml', name );\n\n}\n\nconst _colorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\n\t'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\n\t'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\n\t'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\n\t'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\n\t'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\n\t'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\n\t'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\n\t'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\n\t'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\n\t'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\n\t'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\n\t'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\n\t'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\n\t'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\n\t'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\n\t'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\n\t'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\n\t'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\n\t'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'rebeccapurple': 0x663399, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\n\t'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\n\t'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\n\t'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\n\t'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\n\nconst _hslA = { h: 0, s: 0, l: 0 };\nconst _hslB = { h: 0, s: 0, l: 0 };\n\nfunction hue2rgb( p, q, t ) {\n\n\tif ( t < 0 ) t += 1;\n\tif ( t > 1 ) t -= 1;\n\tif ( t < 1 / 6 ) return p + ( q - p ) * 6 * t;\n\tif ( t < 1 / 2 ) return q;\n\tif ( t < 2 / 3 ) return p + ( q - p ) * 6 * ( 2 / 3 - t );\n\treturn p;\n\n}\n\nfunction SRGBToLinear( c ) {\n\n\treturn ( c < 0.04045 ) ? c * 0.0773993808 : Math.pow( c * 0.9478672986 + 0.0521327014, 2.4 );\n\n}\n\nfunction LinearToSRGB( c ) {\n\n\treturn ( c < 0.0031308 ) ? c * 12.92 : 1.055 * ( Math.pow( c, 0.41666 ) ) - 0.055;\n\n}\n\nclass Color {\n\n\tconstructor( r, g, b ) {\n\n\t\tif ( g === undefined && b === undefined ) {\n\n\t\t\t// r is THREE.Color, hex or string\n\t\t\treturn this.set( r );\n\n\t\t}\n\n\t\treturn this.setRGB( r, g, b );\n\n\t}\n\n\tset( value ) {\n\n\t\tif ( value && value.isColor ) {\n\n\t\t\tthis.copy( value );\n\n\t\t} else if ( typeof value === 'number' ) {\n\n\t\t\tthis.setHex( value );\n\n\t\t} else if ( typeof value === 'string' ) {\n\n\t\t\tthis.setStyle( value );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.r = scalar;\n\t\tthis.g = scalar;\n\t\tthis.b = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetHex( hex ) {\n\n\t\thex = Math.floor( hex );\n\n\t\tthis.r = ( hex >> 16 & 255 ) / 255;\n\t\tthis.g = ( hex >> 8 & 255 ) / 255;\n\t\tthis.b = ( hex & 255 ) / 255;\n\n\t\treturn this;\n\n\t}\n\n\tsetRGB( r, g, b ) {\n\n\t\tthis.r = r;\n\t\tthis.g = g;\n\t\tthis.b = b;\n\n\t\treturn this;\n\n\t}\n\n\tsetHSL( h, s, l ) {\n\n\t\t// h,s,l ranges are in 0.0 - 1.0\n\t\th = euclideanModulo( h, 1 );\n\t\ts = clamp( s, 0, 1 );\n\t\tl = clamp( l, 0, 1 );\n\n\t\tif ( s === 0 ) {\n\n\t\t\tthis.r = this.g = this.b = l;\n\n\t\t} else {\n\n\t\t\tconst p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\n\t\t\tconst q = ( 2 * l ) - p;\n\n\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\n\t\t\tthis.g = hue2rgb( q, p, h );\n\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetStyle( style ) {\n\n\t\tfunction handleAlpha( string ) {\n\n\t\t\tif ( string === undefined ) return;\n\n\t\t\tif ( parseFloat( string ) < 1 ) {\n\n\t\t\t\tconsole.warn( 'THREE.Color: Alpha component of ' + style + ' will be ignored.' );\n\n\t\t\t}\n\n\t\t}\n\n\n\t\tlet m;\n\n\t\tif ( m = /^((?:rgb|hsl)a?)\\(([^\\)]*)\\)/.exec( style ) ) {\n\n\t\t\t// rgb / hsl\n\n\t\t\tlet color;\n\t\t\tconst name = m[ 1 ];\n\t\t\tconst components = m[ 2 ];\n\n\t\t\tswitch ( name ) {\n\n\t\t\t\tcase 'rgb':\n\t\t\t\tcase 'rgba':\n\n\t\t\t\t\tif ( color = /^\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgb(255,0,0) rgba(255,0,0,0.5)\n\t\t\t\t\t\tthis.r = Math.min( 255, parseInt( color[ 1 ], 10 ) ) / 255;\n\t\t\t\t\t\tthis.g = Math.min( 255, parseInt( color[ 2 ], 10 ) ) / 255;\n\t\t\t\t\t\tthis.b = Math.min( 255, parseInt( color[ 3 ], 10 ) ) / 255;\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( color = /^\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgb(100%,0%,0%) rgba(100%,0%,0%,0.5)\n\t\t\t\t\t\tthis.r = Math.min( 100, parseInt( color[ 1 ], 10 ) ) / 100;\n\t\t\t\t\t\tthis.g = Math.min( 100, parseInt( color[ 2 ], 10 ) ) / 100;\n\t\t\t\t\t\tthis.b = Math.min( 100, parseInt( color[ 3 ], 10 ) ) / 100;\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'hsl':\n\t\t\t\tcase 'hsla':\n\n\t\t\t\t\tif ( color = /^\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// hsl(120,50%,50%) hsla(120,50%,50%,0.5)\n\t\t\t\t\t\tconst h = parseFloat( color[ 1 ] ) / 360;\n\t\t\t\t\t\tconst s = parseInt( color[ 2 ], 10 ) / 100;\n\t\t\t\t\t\tconst l = parseInt( color[ 3 ], 10 ) / 100;\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this.setHSL( h, s, l );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t} else if ( m = /^\\#([A-Fa-f\\d]+)$/.exec( style ) ) {\n\n\t\t\t// hex color\n\n\t\t\tconst hex = m[ 1 ];\n\t\t\tconst size = hex.length;\n\n\t\t\tif ( size === 3 ) {\n\n\t\t\t\t// #ff0\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 0 ), 16 ) / 255;\n\t\t\t\tthis.g = parseInt( hex.charAt( 1 ) + hex.charAt( 1 ), 16 ) / 255;\n\t\t\t\tthis.b = parseInt( hex.charAt( 2 ) + hex.charAt( 2 ), 16 ) / 255;\n\n\t\t\t\treturn this;\n\n\t\t\t} else if ( size === 6 ) {\n\n\t\t\t\t// #ff0000\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 1 ), 16 ) / 255;\n\t\t\t\tthis.g = parseInt( hex.charAt( 2 ) + hex.charAt( 3 ), 16 ) / 255;\n\t\t\t\tthis.b = parseInt( hex.charAt( 4 ) + hex.charAt( 5 ), 16 ) / 255;\n\n\t\t\t\treturn this;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( style && style.length > 0 ) {\n\n\t\t\treturn this.setColorName( style );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetColorName( style ) {\n\n\t\t// color keywords\n\t\tconst hex = _colorKeywords[ style.toLowerCase() ];\n\n\t\tif ( hex !== undefined ) {\n\n\t\t\t// red\n\t\t\tthis.setHex( hex );\n\n\t\t} else {\n\n\t\t\t// unknown color\n\t\t\tconsole.warn( 'THREE.Color: Unknown color ' + style );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.r, this.g, this.b );\n\n\t}\n\n\tcopy( color ) {\n\n\t\tthis.r = color.r;\n\t\tthis.g = color.g;\n\t\tthis.b = color.b;\n\n\t\treturn this;\n\n\t}\n\n\tcopySRGBToLinear( color ) {\n\n\t\tthis.r = SRGBToLinear( color.r );\n\t\tthis.g = SRGBToLinear( color.g );\n\t\tthis.b = SRGBToLinear( color.b );\n\n\t\treturn this;\n\n\t}\n\n\tcopyLinearToSRGB( color ) {\n\n\t\tthis.r = LinearToSRGB( color.r );\n\t\tthis.g = LinearToSRGB( color.g );\n\t\tthis.b = LinearToSRGB( color.b );\n\n\t\treturn this;\n\n\t}\n\n\tconvertSRGBToLinear() {\n\n\t\tthis.copySRGBToLinear( this );\n\n\t\treturn this;\n\n\t}\n\n\tconvertLinearToSRGB() {\n\n\t\tthis.copyLinearToSRGB( this );\n\n\t\treturn this;\n\n\t}\n\n\tgetHex() {\n\n\t\treturn ( this.r * 255 ) << 16 ^ ( this.g * 255 ) << 8 ^ ( this.b * 255 ) << 0;\n\n\t}\n\n\tgetHexString() {\n\n\t\treturn ( '000000' + this.getHex().toString( 16 ) ).slice( - 6 );\n\n\t}\n\n\tgetHSL( target ) {\n\n\t\t// h,s,l ranges are in 0.0 - 1.0\n\n\t\tconst r = this.r, g = this.g, b = this.b;\n\n\t\tconst max = Math.max( r, g, b );\n\t\tconst min = Math.min( r, g, b );\n\n\t\tlet hue, saturation;\n\t\tconst lightness = ( min + max ) / 2.0;\n\n\t\tif ( min === max ) {\n\n\t\t\thue = 0;\n\t\t\tsaturation = 0;\n\n\t\t} else {\n\n\t\t\tconst delta = max - min;\n\n\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\n\n\t\t\tswitch ( max ) {\n\n\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\n\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\n\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\n\n\t\t\t}\n\n\t\t\thue /= 6;\n\n\t\t}\n\n\t\ttarget.h = hue;\n\t\ttarget.s = saturation;\n\t\ttarget.l = lightness;\n\n\t\treturn target;\n\n\t}\n\n\tgetStyle() {\n\n\t\treturn 'rgb(' + ( ( this.r * 255 ) | 0 ) + ',' + ( ( this.g * 255 ) | 0 ) + ',' + ( ( this.b * 255 ) | 0 ) + ')';\n\n\t}\n\n\toffsetHSL( h, s, l ) {\n\n\t\tthis.getHSL( _hslA );\n\n\t\t_hslA.h += h; _hslA.s += s; _hslA.l += l;\n\n\t\tthis.setHSL( _hslA.h, _hslA.s, _hslA.l );\n\n\t\treturn this;\n\n\t}\n\n\tadd( color ) {\n\n\t\tthis.r += color.r;\n\t\tthis.g += color.g;\n\t\tthis.b += color.b;\n\n\t\treturn this;\n\n\t}\n\n\taddColors( color1, color2 ) {\n\n\t\tthis.r = color1.r + color2.r;\n\t\tthis.g = color1.g + color2.g;\n\t\tthis.b = color1.b + color2.b;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.r += s;\n\t\tthis.g += s;\n\t\tthis.b += s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( color ) {\n\n\t\tthis.r = Math.max( 0, this.r - color.r );\n\t\tthis.g = Math.max( 0, this.g - color.g );\n\t\tthis.b = Math.max( 0, this.b - color.b );\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( color ) {\n\n\t\tthis.r *= color.r;\n\t\tthis.g *= color.g;\n\t\tthis.b *= color.b;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tthis.r *= s;\n\t\tthis.g *= s;\n\t\tthis.b *= s;\n\n\t\treturn this;\n\n\t}\n\n\tlerp( color, alpha ) {\n\n\t\tthis.r += ( color.r - this.r ) * alpha;\n\t\tthis.g += ( color.g - this.g ) * alpha;\n\t\tthis.b += ( color.b - this.b ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpColors( color1, color2, alpha ) {\n\n\t\tthis.r = color1.r + ( color2.r - color1.r ) * alpha;\n\t\tthis.g = color1.g + ( color2.g - color1.g ) * alpha;\n\t\tthis.b = color1.b + ( color2.b - color1.b ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpHSL( color, alpha ) {\n\n\t\tthis.getHSL( _hslA );\n\t\tcolor.getHSL( _hslB );\n\n\t\tconst h = lerp( _hslA.h, _hslB.h, alpha );\n\t\tconst s = lerp( _hslA.s, _hslB.s, alpha );\n\t\tconst l = lerp( _hslA.l, _hslB.l, alpha );\n\n\t\tthis.setHSL( h, s, l );\n\n\t\treturn this;\n\n\t}\n\n\tequals( c ) {\n\n\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.r = array[ offset ];\n\t\tthis.g = array[ offset + 1 ];\n\t\tthis.b = array[ offset + 2 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.r;\n\t\tarray[ offset + 1 ] = this.g;\n\t\tarray[ offset + 2 ] = this.b;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.r = attribute.getX( index );\n\t\tthis.g = attribute.getY( index );\n\t\tthis.b = attribute.getZ( index );\n\n\t\tif ( attribute.normalized === true ) {\n\n\t\t\t// assuming Uint8Array\n\n\t\t\tthis.r /= 255;\n\t\t\tthis.g /= 255;\n\t\t\tthis.b /= 255;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\treturn this.getHex();\n\n\t}\n\n}\n\nColor.NAMES = _colorKeywords;\n\nColor.prototype.isColor = true;\nColor.prototype.r = 1;\nColor.prototype.g = 1;\nColor.prototype.b = 1;\n\nlet _canvas;\n\nclass ImageUtils {\n\n\tstatic getDataURL( image ) {\n\n\t\tif ( /^data:/i.test( image.src ) ) {\n\n\t\t\treturn image.src;\n\n\t\t}\n\n\t\tif ( typeof HTMLCanvasElement == 'undefined' ) {\n\n\t\t\treturn image.src;\n\n\t\t}\n\n\t\tlet canvas;\n\n\t\tif ( image instanceof HTMLCanvasElement ) {\n\n\t\t\tcanvas = image;\n\n\t\t} else {\n\n\t\t\tif ( _canvas === undefined ) _canvas = createElementNS( 'canvas' );\n\n\t\t\t_canvas.width = image.width;\n\t\t\t_canvas.height = image.height;\n\n\t\t\tconst context = _canvas.getContext( '2d' );\n\n\t\t\tif ( image instanceof ImageData ) {\n\n\t\t\t\tcontext.putImageData( image, 0, 0 );\n\n\t\t\t} else {\n\n\t\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\t}\n\n\t\t\tcanvas = _canvas;\n\n\t\t}\n\n\t\tif ( canvas.width > 2048 || canvas.height > 2048 ) {\n\n\t\t\tconsole.warn( 'THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons', image );\n\n\t\t\treturn canvas.toDataURL( 'image/jpeg', 0.6 );\n\n\t\t} else {\n\n\t\t\treturn canvas.toDataURL( 'image/png' );\n\n\t\t}\n\n\t}\n\n\tstatic sRGBToLinear( image ) {\n\n\t\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t\tconst canvas = createElementNS( 'canvas' );\n\n\t\t\tcanvas.width = image.width;\n\t\t\tcanvas.height = image.height;\n\n\t\t\tconst context = canvas.getContext( '2d' );\n\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\tconst imageData = context.getImageData( 0, 0, image.width, image.height );\n\t\t\tconst data = imageData.data;\n\n\t\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\t\tdata[ i ] = SRGBToLinear( data[ i ] / 255 ) * 255;\n\n\t\t\t}\n\n\t\t\tcontext.putImageData( imageData, 0, 0 );\n\n\t\t\treturn canvas;\n\n\t\t} else if ( image.data ) {\n\n\t\t\tconst data = image.data.slice( 0 );\n\n\t\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\t\tif ( data instanceof Uint8Array || data instanceof Uint8ClampedArray ) {\n\n\t\t\t\t\tdata[ i ] = Math.floor( SRGBToLinear( data[ i ] / 255 ) * 255 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// assuming float\n\n\t\t\t\t\tdata[ i ] = SRGBToLinear( data[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdata: data,\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied.' );\n\t\t\treturn image;\n\n\t\t}\n\n\t}\n\n}\n\nlet textureId = 0;\n\nclass Texture extends EventDispatcher {\n\n\tconstructor( image = Texture.DEFAULT_IMAGE, mapping = Texture.DEFAULT_MAPPING, wrapS = ClampToEdgeWrapping, wrapT = ClampToEdgeWrapping, magFilter = LinearFilter, minFilter = LinearMipmapLinearFilter, format = RGBAFormat, type = UnsignedByteType, anisotropy = 1, encoding = LinearEncoding ) {\n\n\t\tsuper();\n\n\t\tObject.defineProperty( this, 'id', { value: textureId ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\n\t\tthis.image = image;\n\t\tthis.mipmaps = [];\n\n\t\tthis.mapping = mapping;\n\n\t\tthis.wrapS = wrapS;\n\t\tthis.wrapT = wrapT;\n\n\t\tthis.magFilter = magFilter;\n\t\tthis.minFilter = minFilter;\n\n\t\tthis.anisotropy = anisotropy;\n\n\t\tthis.format = format;\n\t\tthis.internalFormat = null;\n\t\tthis.type = type;\n\n\t\tthis.offset = new Vector2( 0, 0 );\n\t\tthis.repeat = new Vector2( 1, 1 );\n\t\tthis.center = new Vector2( 0, 0 );\n\t\tthis.rotation = 0;\n\n\t\tthis.matrixAutoUpdate = true;\n\t\tthis.matrix = new Matrix3();\n\n\t\tthis.generateMipmaps = true;\n\t\tthis.premultiplyAlpha = false;\n\t\tthis.flipY = true;\n\t\tthis.unpackAlignment = 4;\t// valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\n\n\t\t// Values of encoding !== THREE.LinearEncoding only supported on map, envMap and emissiveMap.\n\t\t//\n\t\t// Also changing the encoding after already used by a Material will not automatically make the Material\n\t\t// update. You need to explicitly call Material.needsUpdate to trigger it to recompile.\n\t\tthis.encoding = encoding;\n\n\t\tthis.userData = {};\n\n\t\tthis.version = 0;\n\t\tthis.onUpdate = null;\n\n\t\tthis.isRenderTargetTexture = false; // indicates whether a texture belongs to a render target or not\n\t\tthis.needsPMREMUpdate = false; // indicates whether this texture should be processed by PMREMGenerator or not (only relevant for render target textures)\n\n\t}\n\n\tupdateMatrix() {\n\n\t\tthis.matrix.setUvTransform( this.offset.x, this.offset.y, this.repeat.x, this.repeat.y, this.rotation, this.center.x, this.center.y );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.image = source.image;\n\t\tthis.mipmaps = source.mipmaps.slice( 0 );\n\n\t\tthis.mapping = source.mapping;\n\n\t\tthis.wrapS = source.wrapS;\n\t\tthis.wrapT = source.wrapT;\n\n\t\tthis.magFilter = source.magFilter;\n\t\tthis.minFilter = source.minFilter;\n\n\t\tthis.anisotropy = source.anisotropy;\n\n\t\tthis.format = source.format;\n\t\tthis.internalFormat = source.internalFormat;\n\t\tthis.type = source.type;\n\n\t\tthis.offset.copy( source.offset );\n\t\tthis.repeat.copy( source.repeat );\n\t\tthis.center.copy( source.center );\n\t\tthis.rotation = source.rotation;\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\t\tthis.matrix.copy( source.matrix );\n\n\t\tthis.generateMipmaps = source.generateMipmaps;\n\t\tthis.premultiplyAlpha = source.premultiplyAlpha;\n\t\tthis.flipY = source.flipY;\n\t\tthis.unpackAlignment = source.unpackAlignment;\n\t\tthis.encoding = source.encoding;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( ! isRootObject && meta.textures[ this.uuid ] !== undefined ) {\n\n\t\t\treturn meta.textures[ this.uuid ];\n\n\t\t}\n\n\t\tconst output = {\n\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Texture',\n\t\t\t\tgenerator: 'Texture.toJSON'\n\t\t\t},\n\n\t\t\tuuid: this.uuid,\n\t\t\tname: this.name,\n\n\t\t\tmapping: this.mapping,\n\n\t\t\trepeat: [ this.repeat.x, this.repeat.y ],\n\t\t\toffset: [ this.offset.x, this.offset.y ],\n\t\t\tcenter: [ this.center.x, this.center.y ],\n\t\t\trotation: this.rotation,\n\n\t\t\twrap: [ this.wrapS, this.wrapT ],\n\n\t\t\tformat: this.format,\n\t\t\ttype: this.type,\n\t\t\tencoding: this.encoding,\n\n\t\t\tminFilter: this.minFilter,\n\t\t\tmagFilter: this.magFilter,\n\t\t\tanisotropy: this.anisotropy,\n\n\t\t\tflipY: this.flipY,\n\n\t\t\tpremultiplyAlpha: this.premultiplyAlpha,\n\t\t\tunpackAlignment: this.unpackAlignment\n\n\t\t};\n\n\t\tif ( this.image !== undefined ) {\n\n\t\t\t// TODO: Move to THREE.Image\n\n\t\t\tconst image = this.image;\n\n\t\t\tif ( image.uuid === undefined ) {\n\n\t\t\t\timage.uuid = generateUUID(); // UGH\n\n\t\t\t}\n\n\t\t\tif ( ! isRootObject && meta.images[ image.uuid ] === undefined ) {\n\n\t\t\t\tlet url;\n\n\t\t\t\tif ( Array.isArray( image ) ) {\n\n\t\t\t\t\t// process array of images e.g. CubeTexture\n\n\t\t\t\t\turl = [];\n\n\t\t\t\t\tfor ( let i = 0, l = image.length; i < l; i ++ ) {\n\n\t\t\t\t\t\t// check cube texture with data textures\n\n\t\t\t\t\t\tif ( image[ i ].isDataTexture ) {\n\n\t\t\t\t\t\t\turl.push( serializeImage( image[ i ].image ) );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\turl.push( serializeImage( image[ i ] ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// process single image\n\n\t\t\t\t\turl = serializeImage( image );\n\n\t\t\t\t}\n\n\t\t\t\tmeta.images[ image.uuid ] = {\n\t\t\t\t\tuuid: image.uuid,\n\t\t\t\t\turl: url\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\toutput.image = image.uuid;\n\n\t\t}\n\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) output.userData = this.userData;\n\n\t\tif ( ! isRootObject ) {\n\n\t\t\tmeta.textures[ this.uuid ] = output;\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\ttransformUv( uv ) {\n\n\t\tif ( this.mapping !== UVMapping ) return uv;\n\n\t\tuv.applyMatrix3( this.matrix );\n\n\t\tif ( uv.x < 0 || uv.x > 1 ) {\n\n\t\t\tswitch ( this.wrapS ) {\n\n\t\t\t\tcase RepeatWrapping:\n\n\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ClampToEdgeWrapping:\n\n\t\t\t\t\tuv.x = uv.x < 0 ? 0 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MirroredRepeatWrapping:\n\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.x ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\tuv.x = Math.ceil( uv.x ) - uv.x;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( uv.y < 0 || uv.y > 1 ) {\n\n\t\t\tswitch ( this.wrapT ) {\n\n\t\t\t\tcase RepeatWrapping:\n\n\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ClampToEdgeWrapping:\n\n\t\t\t\t\tuv.y = uv.y < 0 ? 0 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MirroredRepeatWrapping:\n\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.y ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\tuv.y = Math.ceil( uv.y ) - uv.y;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.flipY ) {\n\n\t\t\tuv.y = 1 - uv.y;\n\n\t\t}\n\n\t\treturn uv;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n}\n\nTexture.DEFAULT_IMAGE = undefined;\nTexture.DEFAULT_MAPPING = UVMapping;\n\nTexture.prototype.isTexture = true;\n\nfunction serializeImage( image ) {\n\n\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t// default images\n\n\t\treturn ImageUtils.getDataURL( image );\n\n\t} else {\n\n\t\tif ( image.data ) {\n\n\t\t\t// images of DataTexture\n\n\t\t\treturn {\n\t\t\t\tdata: Array.prototype.slice.call( image.data ),\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height,\n\t\t\t\ttype: image.data.constructor.name\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.Texture: Unable to serialize Texture.' );\n\t\t\treturn {};\n\n\t\t}\n\n\t}\n\n}\n\nclass Vector4 {\n\n\tconstructor( x = 0, y = 0, z = 0, w = 1 ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.w = w;\n\n\t}\n\n\tget width() {\n\n\t\treturn this.z;\n\n\t}\n\n\tset width( value ) {\n\n\t\tthis.z = value;\n\n\t}\n\n\tget height() {\n\n\t\treturn this.w;\n\n\t}\n\n\tset height( value ) {\n\n\t\tthis.w = value;\n\n\t}\n\n\tset( x, y, z, w ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.w = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\t\tthis.z = scalar;\n\t\tthis.w = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( z ) {\n\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetW( w ) {\n\n\t\tthis.w = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tcase 2: this.z = value; break;\n\t\t\tcase 3: this.w = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tcase 2: return this.z;\n\t\t\tcase 3: return this.w;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y, this.z, this.w );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t\tthis.z = v.z;\n\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\treturn this.addVectors( v, w );\n\n\t\t}\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t\tthis.z += v.z;\n\t\tthis.w += v.w;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\t\tthis.z += s;\n\t\tthis.w += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\t\tthis.z = a.z + b.z;\n\t\tthis.w = a.w + b.w;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\t\tthis.z += v.z * s;\n\t\tthis.w += v.w * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\treturn this.subVectors( v, w );\n\n\t\t}\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\t\tthis.z -= v.z;\n\t\tthis.w -= v.w;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\t\tthis.z -= s;\n\t\tthis.w -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\t\tthis.z = a.z - b.z;\n\t\tthis.w = a.w - b.w;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t\tthis.z *= v.z;\n\t\tthis.w *= v.w;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\tthis.z *= scalar;\n\t\tthis.w *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z, w = this.w;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\n\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tsetAxisAngleFromQuaternion( q ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\n\n\t\t// q is assumed to be normalized\n\n\t\tthis.w = 2 * Math.acos( q.w );\n\n\t\tconst s = Math.sqrt( 1 - q.w * q.w );\n\n\t\tif ( s < 0.0001 ) {\n\n\t\t\tthis.x = 1;\n\t\t\tthis.y = 0;\n\t\t\tthis.z = 0;\n\n\t\t} else {\n\n\t\t\tthis.x = q.x / s;\n\t\t\tthis.y = q.y / s;\n\t\t\tthis.z = q.z / s;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetAxisAngleFromRotationMatrix( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tlet angle, x, y, z; // variables for result\n\t\tconst epsilon = 0.01,\t\t// margin to allow for rounding errors\n\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\n\n\t\t\tte = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\tif ( ( Math.abs( m12 - m21 ) < epsilon ) &&\n\t\t     ( Math.abs( m13 - m31 ) < epsilon ) &&\n\t\t     ( Math.abs( m23 - m32 ) < epsilon ) ) {\n\n\t\t\t// singularity found\n\t\t\t// first check for identity matrix which must have +1 for all terms\n\t\t\t// in leading diagonal and zero in other terms\n\n\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m13 + m31 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m23 + m32 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\n\n\t\t\t\t// this singularity is identity matrix so angle = 0\n\n\t\t\t\tthis.set( 1, 0, 0, 0 );\n\n\t\t\t\treturn this; // zero angle, arbitrary axis\n\n\t\t\t}\n\n\t\t\t// otherwise this singularity is angle = 180\n\n\t\t\tangle = Math.PI;\n\n\t\t\tconst xx = ( m11 + 1 ) / 2;\n\t\t\tconst yy = ( m22 + 1 ) / 2;\n\t\t\tconst zz = ( m33 + 1 ) / 2;\n\t\t\tconst xy = ( m12 + m21 ) / 4;\n\t\t\tconst xz = ( m13 + m31 ) / 4;\n\t\t\tconst yz = ( m23 + m32 ) / 4;\n\n\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) {\n\n\t\t\t\t// m11 is the largest diagonal term\n\n\t\t\t\tif ( xx < epsilon ) {\n\n\t\t\t\t\tx = 0;\n\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tx = Math.sqrt( xx );\n\t\t\t\t\ty = xy / x;\n\t\t\t\t\tz = xz / x;\n\n\t\t\t\t}\n\n\t\t\t} else if ( yy > zz ) {\n\n\t\t\t\t// m22 is the largest diagonal term\n\n\t\t\t\tif ( yy < epsilon ) {\n\n\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\ty = 0;\n\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t} else {\n\n\t\t\t\t\ty = Math.sqrt( yy );\n\t\t\t\t\tx = xy / y;\n\t\t\t\t\tz = yz / y;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// m33 is the largest diagonal term so base result on this\n\n\t\t\t\tif ( zz < epsilon ) {\n\n\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\tz = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tz = Math.sqrt( zz );\n\t\t\t\t\tx = xz / z;\n\t\t\t\t\ty = yz / z;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.set( x, y, z, angle );\n\n\t\t\treturn this; // return 180 deg rotation\n\n\t\t}\n\n\t\t// as we have reached here there are no singularities so we can handle normally\n\n\t\tlet s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 ) +\n\t\t\t( m13 - m31 ) * ( m13 - m31 ) +\n\t\t\t( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\n\n\t\tif ( Math.abs( s ) < 0.001 ) s = 1;\n\n\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\n\t\t// caught by singularity test above, but I've left it in just in case\n\n\t\tthis.x = ( m32 - m23 ) / s;\n\t\tthis.y = ( m13 - m31 ) / s;\n\t\tthis.z = ( m21 - m12 ) / s;\n\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\n\n\t\treturn this;\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\t\tthis.z = Math.min( this.z, v.z );\n\t\tthis.w = Math.min( this.w, v.w );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\t\tthis.z = Math.max( this.z, v.z );\n\t\tthis.w = Math.max( this.w, v.w );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\n\t\tthis.w = Math.max( min.w, Math.min( max.w, this.w ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\t\tthis.z = Math.max( minVal, Math.min( maxVal, this.z ) );\n\t\tthis.w = Math.max( minVal, Math.min( maxVal, this.w ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\t\tthis.z = Math.floor( this.z );\n\t\tthis.w = Math.floor( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\t\tthis.z = Math.ceil( this.z );\n\t\tthis.w = Math.ceil( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\t\tthis.z = Math.round( this.z );\n\t\tthis.w = Math.round( this.w );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\n\t\tthis.w = ( this.w < 0 ) ? Math.ceil( this.w ) : Math.floor( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\t\tthis.z = - this.z;\n\t\tthis.w = - this.w;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\tthis.z += ( v.z - this.z ) * alpha;\n\t\tthis.w += ( v.w - this.w ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\t\tthis.z = v1.z + ( v2.z - v1.z ) * alpha;\n\t\tthis.w = v1.w + ( v2.w - v1.w ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\t\tthis.z = array[ offset + 2 ];\n\t\tthis.w = array[ offset + 3 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\t\tarray[ offset + 2 ] = this.z;\n\t\tarray[ offset + 3 ] = this.w;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index, offset ) {\n\n\t\tif ( offset !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector4: offset has been removed from .fromBufferAttribute().' );\n\n\t\t}\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\t\tthis.z = attribute.getZ( index );\n\t\tthis.w = attribute.getW( index );\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\t\tthis.z = Math.random();\n\t\tthis.w = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\t\tyield this.z;\n\t\tyield this.w;\n\n\t}\n\n}\n\nVector4.prototype.isVector4 = true;\n\n/*\n In options, we can specify:\n * Texture parameters for an auto-generated target texture\n * depthBuffer/stencilBuffer: Booleans to indicate if we should generate these buffers\n*/\nclass WebGLRenderTarget extends EventDispatcher {\n\n\tconstructor( width, height, options = {} ) {\n\n\t\tsuper();\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.depth = 1;\n\n\t\tthis.scissor = new Vector4( 0, 0, width, height );\n\t\tthis.scissorTest = false;\n\n\t\tthis.viewport = new Vector4( 0, 0, width, height );\n\n\t\tthis.texture = new Texture( undefined, options.mapping, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.encoding );\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t\tthis.texture.image = { width: width, height: height, depth: 1 };\n\n\t\tthis.texture.generateMipmaps = options.generateMipmaps !== undefined ? options.generateMipmaps : false;\n\t\tthis.texture.internalFormat = options.internalFormat !== undefined ? options.internalFormat : null;\n\t\tthis.texture.minFilter = options.minFilter !== undefined ? options.minFilter : LinearFilter;\n\n\t\tthis.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\n\t\tthis.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : false;\n\t\tthis.depthTexture = options.depthTexture !== undefined ? options.depthTexture : null;\n\n\t}\n\n\tsetTexture( texture ) {\n\n\t\ttexture.image = {\n\t\t\twidth: this.width,\n\t\t\theight: this.height,\n\t\t\tdepth: this.depth\n\t\t};\n\n\t\tthis.texture = texture;\n\n\t}\n\n\tsetSize( width, height, depth = 1 ) {\n\n\t\tif ( this.width !== width || this.height !== height || this.depth !== depth ) {\n\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t\tthis.depth = depth;\n\n\t\t\tthis.texture.image.width = width;\n\t\t\tthis.texture.image.height = height;\n\t\t\tthis.texture.image.depth = depth;\n\n\t\t\tthis.dispose();\n\n\t\t}\n\n\t\tthis.viewport.set( 0, 0, width, height );\n\t\tthis.scissor.set( 0, 0, width, height );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.width = source.width;\n\t\tthis.height = source.height;\n\t\tthis.depth = source.depth;\n\n\t\tthis.viewport.copy( source.viewport );\n\n\t\tthis.texture = source.texture.clone();\n\n\t\t// ensure image object is not shared, see #20328\n\n\t\tthis.texture.image = Object.assign( {}, source.texture.image );\n\n\t\tthis.depthBuffer = source.depthBuffer;\n\t\tthis.stencilBuffer = source.stencilBuffer;\n\t\tthis.depthTexture = source.depthTexture;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n}\n\nWebGLRenderTarget.prototype.isWebGLRenderTarget = true;\n\nclass WebGLMultipleRenderTargets extends WebGLRenderTarget {\n\n\tconstructor( width, height, count ) {\n\n\t\tsuper( width, height );\n\n\t\tconst texture = this.texture;\n\n\t\tthis.texture = [];\n\n\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\tthis.texture[ i ] = texture.clone();\n\n\t\t}\n\n\t}\n\n\tsetSize( width, height, depth = 1 ) {\n\n\t\tif ( this.width !== width || this.height !== height || this.depth !== depth ) {\n\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t\tthis.depth = depth;\n\n\t\t\tfor ( let i = 0, il = this.texture.length; i < il; i ++ ) {\n\n\t\t\t\tthis.texture[ i ].image.width = width;\n\t\t\t\tthis.texture[ i ].image.height = height;\n\t\t\t\tthis.texture[ i ].image.depth = depth;\n\n\t\t\t}\n\n\t\t\tthis.dispose();\n\n\t\t}\n\n\t\tthis.viewport.set( 0, 0, width, height );\n\t\tthis.scissor.set( 0, 0, width, height );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.dispose();\n\n\t\tthis.width = source.width;\n\t\tthis.height = source.height;\n\t\tthis.depth = source.depth;\n\n\t\tthis.viewport.set( 0, 0, this.width, this.height );\n\t\tthis.scissor.set( 0, 0, this.width, this.height );\n\n\t\tthis.depthBuffer = source.depthBuffer;\n\t\tthis.stencilBuffer = source.stencilBuffer;\n\t\tthis.depthTexture = source.depthTexture;\n\n\t\tthis.texture.length = 0;\n\n\t\tfor ( let i = 0, il = source.texture.length; i < il; i ++ ) {\n\n\t\t\tthis.texture[ i ] = source.texture[ i ].clone();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nWebGLMultipleRenderTargets.prototype.isWebGLMultipleRenderTargets = true;\n\nclass WebGLMultisampleRenderTarget extends WebGLRenderTarget {\n\n\tconstructor( width, height, options = {} ) {\n\n\t\tsuper( width, height, options );\n\n\t\tthis.samples = 4;\n\n\t\tthis.ignoreDepthForMultisampleCopy = options.ignoreDepth !== undefined ? options.ignoreDepth : true;\n\t\tthis.useRenderToTexture = ( options.useRenderToTexture !== undefined ) ? options.useRenderToTexture : false;\n\t\tthis.useRenderbuffer = this.useRenderToTexture === false;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy.call( this, source );\n\n\t\tthis.samples = source.samples;\n\t\tthis.useRenderToTexture = source.useRenderToTexture;\n\t\tthis.useRenderbuffer = source.useRenderbuffer;\n\n\t\treturn this;\n\n\t}\n\n}\n\nWebGLMultisampleRenderTarget.prototype.isWebGLMultisampleRenderTarget = true;\n\nclass Quaternion {\n\n\tconstructor( x = 0, y = 0, z = 0, w = 1 ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t}\n\n\tstatic slerp( qa, qb, qm, t ) {\n\n\t\tconsole.warn( 'THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead.' );\n\t\treturn qm.slerpQuaternions( qa, qb, t );\n\n\t}\n\n\tstatic slerpFlat( dst, dstOffset, src0, srcOffset0, src1, srcOffset1, t ) {\n\n\t\t// fuzz-free, array-based Quaternion SLERP operation\n\n\t\tlet x0 = src0[ srcOffset0 + 0 ],\n\t\t\ty0 = src0[ srcOffset0 + 1 ],\n\t\t\tz0 = src0[ srcOffset0 + 2 ],\n\t\t\tw0 = src0[ srcOffset0 + 3 ];\n\n\t\tconst x1 = src1[ srcOffset1 + 0 ],\n\t\t\ty1 = src1[ srcOffset1 + 1 ],\n\t\t\tz1 = src1[ srcOffset1 + 2 ],\n\t\t\tw1 = src1[ srcOffset1 + 3 ];\n\n\t\tif ( t === 0 ) {\n\n\t\t\tdst[ dstOffset + 0 ] = x0;\n\t\t\tdst[ dstOffset + 1 ] = y0;\n\t\t\tdst[ dstOffset + 2 ] = z0;\n\t\t\tdst[ dstOffset + 3 ] = w0;\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( t === 1 ) {\n\n\t\t\tdst[ dstOffset + 0 ] = x1;\n\t\t\tdst[ dstOffset + 1 ] = y1;\n\t\t\tdst[ dstOffset + 2 ] = z1;\n\t\t\tdst[ dstOffset + 3 ] = w1;\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( w0 !== w1 || x0 !== x1 || y0 !== y1 || z0 !== z1 ) {\n\n\t\t\tlet s = 1 - t;\n\t\t\tconst cos = x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1,\n\t\t\t\tdir = ( cos >= 0 ? 1 : - 1 ),\n\t\t\t\tsqrSin = 1 - cos * cos;\n\n\t\t\t// Skip the Slerp for tiny steps to avoid numeric problems:\n\t\t\tif ( sqrSin > Number.EPSILON ) {\n\n\t\t\t\tconst sin = Math.sqrt( sqrSin ),\n\t\t\t\t\tlen = Math.atan2( sin, cos * dir );\n\n\t\t\t\ts = Math.sin( s * len ) / sin;\n\t\t\t\tt = Math.sin( t * len ) / sin;\n\n\t\t\t}\n\n\t\t\tconst tDir = t * dir;\n\n\t\t\tx0 = x0 * s + x1 * tDir;\n\t\t\ty0 = y0 * s + y1 * tDir;\n\t\t\tz0 = z0 * s + z1 * tDir;\n\t\t\tw0 = w0 * s + w1 * tDir;\n\n\t\t\t// Normalize in case we just did a lerp:\n\t\t\tif ( s === 1 - t ) {\n\n\t\t\t\tconst f = 1 / Math.sqrt( x0 * x0 + y0 * y0 + z0 * z0 + w0 * w0 );\n\n\t\t\t\tx0 *= f;\n\t\t\t\ty0 *= f;\n\t\t\t\tz0 *= f;\n\t\t\t\tw0 *= f;\n\n\t\t\t}\n\n\t\t}\n\n\t\tdst[ dstOffset ] = x0;\n\t\tdst[ dstOffset + 1 ] = y0;\n\t\tdst[ dstOffset + 2 ] = z0;\n\t\tdst[ dstOffset + 3 ] = w0;\n\n\t}\n\n\tstatic multiplyQuaternionsFlat( dst, dstOffset, src0, srcOffset0, src1, srcOffset1 ) {\n\n\t\tconst x0 = src0[ srcOffset0 ];\n\t\tconst y0 = src0[ srcOffset0 + 1 ];\n\t\tconst z0 = src0[ srcOffset0 + 2 ];\n\t\tconst w0 = src0[ srcOffset0 + 3 ];\n\n\t\tconst x1 = src1[ srcOffset1 ];\n\t\tconst y1 = src1[ srcOffset1 + 1 ];\n\t\tconst z1 = src1[ srcOffset1 + 2 ];\n\t\tconst w1 = src1[ srcOffset1 + 3 ];\n\n\t\tdst[ dstOffset ] = x0 * w1 + w0 * x1 + y0 * z1 - z0 * y1;\n\t\tdst[ dstOffset + 1 ] = y0 * w1 + w0 * y1 + z0 * x1 - x0 * z1;\n\t\tdst[ dstOffset + 2 ] = z0 * w1 + w0 * z1 + x0 * y1 - y0 * x1;\n\t\tdst[ dstOffset + 3 ] = w0 * w1 - x0 * x1 - y0 * y1 - z0 * z1;\n\n\t\treturn dst;\n\n\t}\n\n\tget x() {\n\n\t\treturn this._x;\n\n\t}\n\n\tset x( value ) {\n\n\t\tthis._x = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget y() {\n\n\t\treturn this._y;\n\n\t}\n\n\tset y( value ) {\n\n\t\tthis._y = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget z() {\n\n\t\treturn this._z;\n\n\t}\n\n\tset z( value ) {\n\n\t\tthis._z = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget w() {\n\n\t\treturn this._w;\n\n\t}\n\n\tset w( value ) {\n\n\t\tthis._w = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tset( x, y, z, w ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\n\n\t}\n\n\tcopy( quaternion ) {\n\n\t\tthis._x = quaternion.x;\n\t\tthis._y = quaternion.y;\n\t\tthis._z = quaternion.z;\n\t\tthis._w = quaternion.w;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromEuler( euler, update ) {\n\n\t\tif ( ! ( euler && euler.isEuler ) ) {\n\n\t\t\tthrow new Error( 'THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.' );\n\n\t\t}\n\n\t\tconst x = euler._x, y = euler._y, z = euler._z, order = euler._order;\n\n\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\n\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\n\t\t//\tcontent/SpinCalc.m\n\n\t\tconst cos = Math.cos;\n\t\tconst sin = Math.sin;\n\n\t\tconst c1 = cos( x / 2 );\n\t\tconst c2 = cos( y / 2 );\n\t\tconst c3 = cos( z / 2 );\n\n\t\tconst s1 = sin( x / 2 );\n\t\tconst s2 = sin( y / 2 );\n\t\tconst s3 = sin( z / 2 );\n\n\t\tswitch ( order ) {\n\n\t\t\tcase 'XYZ':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'YXZ':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZXY':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZYX':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'YZX':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'XZY':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.warn( 'THREE.Quaternion: .setFromEuler() encountered an unknown order: ' + order );\n\n\t\t}\n\n\t\tif ( update !== false ) this._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromAxisAngle( axis, angle ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\n\n\t\t// assumes axis is normalized\n\n\t\tconst halfAngle = angle / 2, s = Math.sin( halfAngle );\n\n\t\tthis._x = axis.x * s;\n\t\tthis._y = axis.y * s;\n\t\tthis._z = axis.z * s;\n\t\tthis._w = Math.cos( halfAngle );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromRotationMatrix( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tconst te = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\n\n\t\t\ttrace = m11 + m22 + m33;\n\n\t\tif ( trace > 0 ) {\n\n\t\t\tconst s = 0.5 / Math.sqrt( trace + 1.0 );\n\n\t\t\tthis._w = 0.25 / s;\n\t\t\tthis._x = ( m32 - m23 ) * s;\n\t\t\tthis._y = ( m13 - m31 ) * s;\n\t\t\tthis._z = ( m21 - m12 ) * s;\n\n\t\t} else if ( m11 > m22 && m11 > m33 ) {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\n\n\t\t\tthis._w = ( m32 - m23 ) / s;\n\t\t\tthis._x = 0.25 * s;\n\t\t\tthis._y = ( m12 + m21 ) / s;\n\t\t\tthis._z = ( m13 + m31 ) / s;\n\n\t\t} else if ( m22 > m33 ) {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\n\n\t\t\tthis._w = ( m13 - m31 ) / s;\n\t\t\tthis._x = ( m12 + m21 ) / s;\n\t\t\tthis._y = 0.25 * s;\n\t\t\tthis._z = ( m23 + m32 ) / s;\n\n\t\t} else {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\n\n\t\t\tthis._w = ( m21 - m12 ) / s;\n\t\t\tthis._x = ( m13 + m31 ) / s;\n\t\t\tthis._y = ( m23 + m32 ) / s;\n\t\t\tthis._z = 0.25 * s;\n\n\t\t}\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromUnitVectors( vFrom, vTo ) {\n\n\t\t// assumes direction vectors vFrom and vTo are normalized\n\n\t\tlet r = vFrom.dot( vTo ) + 1;\n\n\t\tif ( r < Number.EPSILON ) {\n\n\t\t\t// vFrom and vTo point in opposite directions\n\n\t\t\tr = 0;\n\n\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\n\n\t\t\t\tthis._x = - vFrom.y;\n\t\t\t\tthis._y = vFrom.x;\n\t\t\t\tthis._z = 0;\n\t\t\t\tthis._w = r;\n\n\t\t\t} else {\n\n\t\t\t\tthis._x = 0;\n\t\t\t\tthis._y = - vFrom.z;\n\t\t\t\tthis._z = vFrom.y;\n\t\t\t\tthis._w = r;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// crossVectors( vFrom, vTo ); // inlined to avoid cyclic dependency on Vector3\n\n\t\t\tthis._x = vFrom.y * vTo.z - vFrom.z * vTo.y;\n\t\t\tthis._y = vFrom.z * vTo.x - vFrom.x * vTo.z;\n\t\t\tthis._z = vFrom.x * vTo.y - vFrom.y * vTo.x;\n\t\t\tthis._w = r;\n\n\t\t}\n\n\t\treturn this.normalize();\n\n\t}\n\n\tangleTo( q ) {\n\n\t\treturn 2 * Math.acos( Math.abs( clamp( this.dot( q ), - 1, 1 ) ) );\n\n\t}\n\n\trotateTowards( q, step ) {\n\n\t\tconst angle = this.angleTo( q );\n\n\t\tif ( angle === 0 ) return this;\n\n\t\tconst t = Math.min( 1, step / angle );\n\n\t\tthis.slerp( q, t );\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\treturn this.set( 0, 0, 0, 1 );\n\n\t}\n\n\tinvert() {\n\n\t\t// quaternion is assumed to have unit length\n\n\t\treturn this.conjugate();\n\n\t}\n\n\tconjugate() {\n\n\t\tthis._x *= - 1;\n\t\tthis._y *= - 1;\n\t\tthis._z *= - 1;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\n\n\t}\n\n\tnormalize() {\n\n\t\tlet l = this.length();\n\n\t\tif ( l === 0 ) {\n\n\t\t\tthis._x = 0;\n\t\t\tthis._y = 0;\n\t\t\tthis._z = 0;\n\t\t\tthis._w = 1;\n\n\t\t} else {\n\n\t\t\tl = 1 / l;\n\n\t\t\tthis._x = this._x * l;\n\t\t\tthis._y = this._y * l;\n\t\t\tthis._z = this._z * l;\n\t\t\tthis._w = this._w * l;\n\n\t\t}\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( q, p ) {\n\n\t\tif ( p !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.' );\n\t\t\treturn this.multiplyQuaternions( q, p );\n\n\t\t}\n\n\t\treturn this.multiplyQuaternions( this, q );\n\n\t}\n\n\tpremultiply( q ) {\n\n\t\treturn this.multiplyQuaternions( q, this );\n\n\t}\n\n\tmultiplyQuaternions( a, b ) {\n\n\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\n\n\t\tconst qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\n\t\tconst qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\n\n\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tslerp( qb, t ) {\n\n\t\tif ( t === 0 ) return this;\n\t\tif ( t === 1 ) return this.copy( qb );\n\n\t\tconst x = this._x, y = this._y, z = this._z, w = this._w;\n\n\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\n\n\t\tlet cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\n\n\t\tif ( cosHalfTheta < 0 ) {\n\n\t\t\tthis._w = - qb._w;\n\t\t\tthis._x = - qb._x;\n\t\t\tthis._y = - qb._y;\n\t\t\tthis._z = - qb._z;\n\n\t\t\tcosHalfTheta = - cosHalfTheta;\n\n\t\t} else {\n\n\t\t\tthis.copy( qb );\n\n\t\t}\n\n\t\tif ( cosHalfTheta >= 1.0 ) {\n\n\t\t\tthis._w = w;\n\t\t\tthis._x = x;\n\t\t\tthis._y = y;\n\t\t\tthis._z = z;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst sqrSinHalfTheta = 1.0 - cosHalfTheta * cosHalfTheta;\n\n\t\tif ( sqrSinHalfTheta <= Number.EPSILON ) {\n\n\t\t\tconst s = 1 - t;\n\t\t\tthis._w = s * w + t * this._w;\n\t\t\tthis._x = s * x + t * this._x;\n\t\t\tthis._y = s * y + t * this._y;\n\t\t\tthis._z = s * z + t * this._z;\n\n\t\t\tthis.normalize();\n\t\t\tthis._onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst sinHalfTheta = Math.sqrt( sqrSinHalfTheta );\n\t\tconst halfTheta = Math.atan2( sinHalfTheta, cosHalfTheta );\n\t\tconst ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\n\t\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\n\n\t\tthis._w = ( w * ratioA + this._w * ratioB );\n\t\tthis._x = ( x * ratioA + this._x * ratioB );\n\t\tthis._y = ( y * ratioA + this._y * ratioB );\n\t\tthis._z = ( z * ratioA + this._z * ratioB );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tslerpQuaternions( qa, qb, t ) {\n\n\t\treturn this.copy( qa ).slerp( qb, t );\n\n\t}\n\n\trandom() {\n\n\t\t// Derived from http://planning.cs.uiuc.edu/node198.html\n\t\t// Note, this source uses w, x, y, z ordering,\n\t\t// so we swap the order below.\n\n\t\tconst u1 = Math.random();\n\t\tconst sqrt1u1 = Math.sqrt( 1 - u1 );\n\t\tconst sqrtu1 = Math.sqrt( u1 );\n\n\t\tconst u2 = 2 * Math.PI * Math.random();\n\n\t\tconst u3 = 2 * Math.PI * Math.random();\n\n\t\treturn this.set(\n\t\t\tsqrt1u1 * Math.cos( u2 ),\n\t\t\tsqrtu1 * Math.sin( u3 ),\n\t\t\tsqrtu1 * Math.cos( u3 ),\n\t\t\tsqrt1u1 * Math.sin( u2 ),\n\t\t);\n\n\t}\n\n\tequals( quaternion ) {\n\n\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis._x = array[ offset ];\n\t\tthis._y = array[ offset + 1 ];\n\t\tthis._z = array[ offset + 2 ];\n\t\tthis._w = array[ offset + 3 ];\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._w;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis._x = attribute.getX( index );\n\t\tthis._y = attribute.getY( index );\n\t\tthis._z = attribute.getZ( index );\n\t\tthis._w = attribute.getW( index );\n\n\t\treturn this;\n\n\t}\n\n\t_onChange( callback ) {\n\n\t\tthis._onChangeCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\t_onChangeCallback() {}\n\n}\n\nQuaternion.prototype.isQuaternion = true;\n\nclass Vector3 {\n\n\tconstructor( x = 0, y = 0, z = 0 ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\n\t}\n\n\tset( x, y, z ) {\n\n\t\tif ( z === undefined ) z = this.z; // sprite.scale.set(x,y)\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\t\tthis.z = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( z ) {\n\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tcase 2: this.z = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tcase 2: return this.z;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y, this.z );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t\tthis.z = v.z;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\treturn this.addVectors( v, w );\n\n\t\t}\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t\tthis.z += v.z;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\t\tthis.z += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\t\tthis.z = a.z + b.z;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\t\tthis.z += v.z * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\treturn this.subVectors( v, w );\n\n\t\t}\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\t\tthis.z -= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\t\tthis.z -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\t\tthis.z = a.z - b.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.' );\n\t\t\treturn this.multiplyVectors( v, w );\n\n\t\t}\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t\tthis.z *= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\tthis.z *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyVectors( a, b ) {\n\n\t\tthis.x = a.x * b.x;\n\t\tthis.y = a.y * b.y;\n\t\tthis.z = a.z * b.z;\n\n\t\treturn this;\n\n\t}\n\n\tapplyEuler( euler ) {\n\n\t\tif ( ! ( euler && euler.isEuler ) ) {\n\n\t\t\tconsole.error( 'THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.' );\n\n\t\t}\n\n\t\treturn this.applyQuaternion( _quaternion$4.setFromEuler( euler ) );\n\n\t}\n\n\tapplyAxisAngle( axis, angle ) {\n\n\t\treturn this.applyQuaternion( _quaternion$4.setFromAxisAngle( axis, angle ) );\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\n\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\treturn this.applyMatrix3( m ).normalize();\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tconst w = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] );\n\n\t\tthis.x = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] ) * w;\n\t\tthis.y = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] ) * w;\n\t\tthis.z = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * w;\n\n\t\treturn this;\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst qx = q.x, qy = q.y, qz = q.z, qw = q.w;\n\n\t\t// calculate quat * vector\n\n\t\tconst ix = qw * x + qy * z - qz * y;\n\t\tconst iy = qw * y + qz * x - qx * z;\n\t\tconst iz = qw * z + qx * y - qy * x;\n\t\tconst iw = - qx * x - qy * y - qz * z;\n\n\t\t// calculate result * inverse quat\n\n\t\tthis.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\n\t\tthis.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\n\t\tthis.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\n\n\t\treturn this;\n\n\t}\n\n\tproject( camera ) {\n\n\t\treturn this.applyMatrix4( camera.matrixWorldInverse ).applyMatrix4( camera.projectionMatrix );\n\n\t}\n\n\tunproject( camera ) {\n\n\t\treturn this.applyMatrix4( camera.projectionMatrixInverse ).applyMatrix4( camera.matrixWorld );\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\t// input: THREE.Matrix4 affine matrix\n\t\t// vector interpreted as a direction\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z;\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z;\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\n\n\t\treturn this.normalize();\n\n\t}\n\n\tdivide( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\t\tthis.z /= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\t\tthis.z = Math.min( this.z, v.z );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\t\tthis.z = Math.max( this.z, v.z );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\t\tthis.z = Math.max( minVal, Math.min( maxVal, this.z ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\t\tthis.z = Math.floor( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\t\tthis.z = Math.ceil( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\t\tthis.z = Math.round( this.z );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\t\tthis.z = - this.z;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\n\n\t}\n\n\t// TODO lengthSquared?\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\tthis.z += ( v.z - this.z ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\t\tthis.z = v1.z + ( v2.z - v1.z ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tcross( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.' );\n\t\t\treturn this.crossVectors( v, w );\n\n\t\t}\n\n\t\treturn this.crossVectors( this, v );\n\n\t}\n\n\tcrossVectors( a, b ) {\n\n\t\tconst ax = a.x, ay = a.y, az = a.z;\n\t\tconst bx = b.x, by = b.y, bz = b.z;\n\n\t\tthis.x = ay * bz - az * by;\n\t\tthis.y = az * bx - ax * bz;\n\t\tthis.z = ax * by - ay * bx;\n\n\t\treturn this;\n\n\t}\n\n\tprojectOnVector( v ) {\n\n\t\tconst denominator = v.lengthSq();\n\n\t\tif ( denominator === 0 ) return this.set( 0, 0, 0 );\n\n\t\tconst scalar = v.dot( this ) / denominator;\n\n\t\treturn this.copy( v ).multiplyScalar( scalar );\n\n\t}\n\n\tprojectOnPlane( planeNormal ) {\n\n\t\t_vector$c.copy( this ).projectOnVector( planeNormal );\n\n\t\treturn this.sub( _vector$c );\n\n\t}\n\n\treflect( normal ) {\n\n\t\t// reflect incident vector off plane orthogonal to normal\n\t\t// normal is assumed to have unit length\n\n\t\treturn this.sub( _vector$c.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\n\n\t}\n\n\tangleTo( v ) {\n\n\t\tconst denominator = Math.sqrt( this.lengthSq() * v.lengthSq() );\n\n\t\tif ( denominator === 0 ) return Math.PI / 2;\n\n\t\tconst theta = this.dot( v ) / denominator;\n\n\t\t// clamp, to handle numerical problems\n\n\t\treturn Math.acos( clamp( theta, - 1, 1 ) );\n\n\t}\n\n\tdistanceTo( v ) {\n\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t}\n\n\tdistanceToSquared( v ) {\n\n\t\tconst dx = this.x - v.x, dy = this.y - v.y, dz = this.z - v.z;\n\n\t\treturn dx * dx + dy * dy + dz * dz;\n\n\t}\n\n\tmanhattanDistanceTo( v ) {\n\n\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y ) + Math.abs( this.z - v.z );\n\n\t}\n\n\tsetFromSpherical( s ) {\n\n\t\treturn this.setFromSphericalCoords( s.radius, s.phi, s.theta );\n\n\t}\n\n\tsetFromSphericalCoords( radius, phi, theta ) {\n\n\t\tconst sinPhiRadius = Math.sin( phi ) * radius;\n\n\t\tthis.x = sinPhiRadius * Math.sin( theta );\n\t\tthis.y = Math.cos( phi ) * radius;\n\t\tthis.z = sinPhiRadius * Math.cos( theta );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCylindrical( c ) {\n\n\t\treturn this.setFromCylindricalCoords( c.radius, c.theta, c.y );\n\n\t}\n\n\tsetFromCylindricalCoords( radius, theta, y ) {\n\n\t\tthis.x = radius * Math.sin( theta );\n\t\tthis.y = y;\n\t\tthis.z = radius * Math.cos( theta );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixPosition( m ) {\n\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 12 ];\n\t\tthis.y = e[ 13 ];\n\t\tthis.z = e[ 14 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixScale( m ) {\n\n\t\tconst sx = this.setFromMatrixColumn( m, 0 ).length();\n\t\tconst sy = this.setFromMatrixColumn( m, 1 ).length();\n\t\tconst sz = this.setFromMatrixColumn( m, 2 ).length();\n\n\t\tthis.x = sx;\n\t\tthis.y = sy;\n\t\tthis.z = sz;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixColumn( m, index ) {\n\n\t\treturn this.fromArray( m.elements, index * 4 );\n\n\t}\n\n\tsetFromMatrix3Column( m, index ) {\n\n\t\treturn this.fromArray( m.elements, index * 3 );\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\t\tthis.z = array[ offset + 2 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\t\tarray[ offset + 2 ] = this.z;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index, offset ) {\n\n\t\tif ( offset !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: offset has been removed from .fromBufferAttribute().' );\n\n\t\t}\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\t\tthis.z = attribute.getZ( index );\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\t\tthis.z = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\trandomDirection() {\n\n\t\t// Derived from https://mathworld.wolfram.com/SpherePointPicking.html\n\n\t\tconst u = ( Math.random() - 0.5 ) * 2;\n\t\tconst t = Math.random() * Math.PI * 2;\n\t\tconst f = Math.sqrt( 1 - u ** 2 );\n\n\t\tthis.x = f * Math.cos( t );\n\t\tthis.y = f * Math.sin( t );\n\t\tthis.z = u;\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\t\tyield this.z;\n\n\t}\n\n}\n\nVector3.prototype.isVector3 = true;\n\nconst _vector$c = /*@__PURE__*/ new Vector3();\nconst _quaternion$4 = /*@__PURE__*/ new Quaternion();\n\nclass Box3 {\n\n\tconstructor( min = new Vector3( + Infinity, + Infinity, + Infinity ), max = new Vector3( - Infinity, - Infinity, - Infinity ) ) {\n\n\t\tthis.min = min;\n\t\tthis.max = max;\n\n\t}\n\n\tset( min, max ) {\n\n\t\tthis.min.copy( min );\n\t\tthis.max.copy( max );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromArray( array ) {\n\n\t\tlet minX = + Infinity;\n\t\tlet minY = + Infinity;\n\t\tlet minZ = + Infinity;\n\n\t\tlet maxX = - Infinity;\n\t\tlet maxY = - Infinity;\n\t\tlet maxZ = - Infinity;\n\n\t\tfor ( let i = 0, l = array.length; i < l; i += 3 ) {\n\n\t\t\tconst x = array[ i ];\n\t\t\tconst y = array[ i + 1 ];\n\t\t\tconst z = array[ i + 2 ];\n\n\t\t\tif ( x < minX ) minX = x;\n\t\t\tif ( y < minY ) minY = y;\n\t\t\tif ( z < minZ ) minZ = z;\n\n\t\t\tif ( x > maxX ) maxX = x;\n\t\t\tif ( y > maxY ) maxY = y;\n\t\t\tif ( z > maxZ ) maxZ = z;\n\n\t\t}\n\n\t\tthis.min.set( minX, minY, minZ );\n\t\tthis.max.set( maxX, maxY, maxZ );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromBufferAttribute( attribute ) {\n\n\t\tlet minX = + Infinity;\n\t\tlet minY = + Infinity;\n\t\tlet minZ = + Infinity;\n\n\t\tlet maxX = - Infinity;\n\t\tlet maxY = - Infinity;\n\t\tlet maxZ = - Infinity;\n\n\t\tfor ( let i = 0, l = attribute.count; i < l; i ++ ) {\n\n\t\t\tconst x = attribute.getX( i );\n\t\t\tconst y = attribute.getY( i );\n\t\t\tconst z = attribute.getZ( i );\n\n\t\t\tif ( x < minX ) minX = x;\n\t\t\tif ( y < minY ) minY = y;\n\t\t\tif ( z < minZ ) minZ = z;\n\n\t\t\tif ( x > maxX ) maxX = x;\n\t\t\tif ( y > maxY ) maxY = y;\n\t\t\tif ( z > maxZ ) maxZ = z;\n\n\t\t}\n\n\t\tthis.min.set( minX, minY, minZ );\n\t\tthis.max.set( maxX, maxY, maxZ );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tthis.expandByPoint( points[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCenterAndSize( center, size ) {\n\n\t\tconst halfSize = _vector$b.copy( size ).multiplyScalar( 0.5 );\n\n\t\tthis.min.copy( center ).sub( halfSize );\n\t\tthis.max.copy( center ).add( halfSize );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromObject( object, precise = false ) {\n\n\t\tthis.makeEmpty();\n\n\t\treturn this.expandByObject( object, precise );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( box ) {\n\n\t\tthis.min.copy( box.min );\n\t\tthis.max.copy( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.min.x = this.min.y = this.min.z = + Infinity;\n\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\n\n\t}\n\n\tgetCenter( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\n\n\t}\n\n\tgetSize( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.subVectors( this.max, this.min );\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\tthis.min.min( point );\n\t\tthis.max.max( point );\n\n\t\treturn this;\n\n\t}\n\n\texpandByVector( vector ) {\n\n\t\tthis.min.sub( vector );\n\t\tthis.max.add( vector );\n\n\t\treturn this;\n\n\t}\n\n\texpandByScalar( scalar ) {\n\n\t\tthis.min.addScalar( - scalar );\n\t\tthis.max.addScalar( scalar );\n\n\t\treturn this;\n\n\t}\n\n\texpandByObject( object, precise = false ) {\n\n\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\n\t\t// accounting for both the object's, and children's, world transforms\n\n\t\tobject.updateWorldMatrix( false, false );\n\n\t\tconst geometry = object.geometry;\n\n\t\tif ( geometry !== undefined ) {\n\n\t\t\tif ( precise && geometry.attributes != undefined && geometry.attributes.position !== undefined ) {\n\n\t\t\t\tconst position = geometry.attributes.position;\n\t\t\t\tfor ( let i = 0, l = position.count; i < l; i ++ ) {\n\n\t\t\t\t\t_vector$b.fromBufferAttribute( position, i ).applyMatrix4( object.matrixWorld );\n\t\t\t\t\tthis.expandByPoint( _vector$b );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( geometry.boundingBox === null ) {\n\n\t\t\t\t\tgeometry.computeBoundingBox();\n\n\t\t\t\t}\n\n\t\t\t\t_box$3.copy( geometry.boundingBox );\n\t\t\t\t_box$3.applyMatrix4( object.matrixWorld );\n\n\t\t\t\tthis.union( _box$3 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tthis.expandByObject( children[ i ], precise );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn point.x < this.min.x || point.x > this.max.x ||\n\t\t\tpoint.y < this.min.y || point.y > this.max.y ||\n\t\t\tpoint.z < this.min.z || point.z > this.max.z ? false : true;\n\n\t}\n\n\tcontainsBox( box ) {\n\n\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\n\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y &&\n\t\t\tthis.min.z <= box.min.z && box.max.z <= this.max.z;\n\n\t}\n\n\tgetParameter( point, target ) {\n\n\t\t// This can potentially have a divide by zero if the box\n\t\t// has a size dimension of 0.\n\n\t\treturn target.set(\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\n\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\n\t\t);\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\t// using 6 splitting planes to rule out intersections.\n\t\treturn box.max.x < this.min.x || box.min.x > this.max.x ||\n\t\t\tbox.max.y < this.min.y || box.min.y > this.max.y ||\n\t\t\tbox.max.z < this.min.z || box.min.z > this.max.z ? false : true;\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\t// Find the point on the AABB closest to the sphere center.\n\t\tthis.clampPoint( sphere.center, _vector$b );\n\n\t\t// If that point is inside the sphere, the AABB and sphere intersect.\n\t\treturn _vector$b.distanceToSquared( sphere.center ) <= ( sphere.radius * sphere.radius );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\t// We compute the minimum and maximum dot product values. If those values\n\t\t// are on the same side (back or front) of the plane, then there is no intersection.\n\n\t\tlet min, max;\n\n\t\tif ( plane.normal.x > 0 ) {\n\n\t\t\tmin = plane.normal.x * this.min.x;\n\t\t\tmax = plane.normal.x * this.max.x;\n\n\t\t} else {\n\n\t\t\tmin = plane.normal.x * this.max.x;\n\t\t\tmax = plane.normal.x * this.min.x;\n\n\t\t}\n\n\t\tif ( plane.normal.y > 0 ) {\n\n\t\t\tmin += plane.normal.y * this.min.y;\n\t\t\tmax += plane.normal.y * this.max.y;\n\n\t\t} else {\n\n\t\t\tmin += plane.normal.y * this.max.y;\n\t\t\tmax += plane.normal.y * this.min.y;\n\n\t\t}\n\n\t\tif ( plane.normal.z > 0 ) {\n\n\t\t\tmin += plane.normal.z * this.min.z;\n\t\t\tmax += plane.normal.z * this.max.z;\n\n\t\t} else {\n\n\t\t\tmin += plane.normal.z * this.max.z;\n\t\t\tmax += plane.normal.z * this.min.z;\n\n\t\t}\n\n\t\treturn ( min <= - plane.constant && max >= - plane.constant );\n\n\t}\n\n\tintersectsTriangle( triangle ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// compute box center and extents\n\t\tthis.getCenter( _center );\n\t\t_extents.subVectors( this.max, _center );\n\n\t\t// translate triangle to aabb origin\n\t\t_v0$2.subVectors( triangle.a, _center );\n\t\t_v1$7.subVectors( triangle.b, _center );\n\t\t_v2$3.subVectors( triangle.c, _center );\n\n\t\t// compute edge vectors for triangle\n\t\t_f0.subVectors( _v1$7, _v0$2 );\n\t\t_f1.subVectors( _v2$3, _v1$7 );\n\t\t_f2.subVectors( _v0$2, _v2$3 );\n\n\t\t// test against axes that are given by cross product combinations of the edges of the triangle and the edges of the aabb\n\t\t// make an axis testing of each of the 3 sides of the aabb against each of the 3 sides of the triangle = 9 axis of separation\n\t\t// axis_ij = u_i x f_j (u0, u1, u2 = face normals of aabb = x,y,z axes vectors since aabb is axis aligned)\n\t\tlet axes = [\n\t\t\t0, - _f0.z, _f0.y, 0, - _f1.z, _f1.y, 0, - _f2.z, _f2.y,\n\t\t\t_f0.z, 0, - _f0.x, _f1.z, 0, - _f1.x, _f2.z, 0, - _f2.x,\n\t\t\t- _f0.y, _f0.x, 0, - _f1.y, _f1.x, 0, - _f2.y, _f2.x, 0\n\t\t];\n\t\tif ( ! satForAxes( axes, _v0$2, _v1$7, _v2$3, _extents ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// test 3 face normals from the aabb\n\t\taxes = [ 1, 0, 0, 0, 1, 0, 0, 0, 1 ];\n\t\tif ( ! satForAxes( axes, _v0$2, _v1$7, _v2$3, _extents ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// finally testing the face normal of the triangle\n\t\t// use already existing triangle edge vectors here\n\t\t_triangleNormal.crossVectors( _f0, _f1 );\n\t\taxes = [ _triangleNormal.x, _triangleNormal.y, _triangleNormal.z ];\n\n\t\treturn satForAxes( axes, _v0$2, _v1$7, _v2$3, _extents );\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\treturn target.copy( point ).clamp( this.min, this.max );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\tconst clampedPoint = _vector$b.copy( point ).clamp( this.min, this.max );\n\n\t\treturn clampedPoint.sub( point ).length();\n\n\t}\n\n\tgetBoundingSphere( target ) {\n\n\t\tthis.getCenter( target.center );\n\n\t\ttarget.radius = this.getSize( _vector$b ).length() * 0.5;\n\n\t\treturn target;\n\n\t}\n\n\tintersect( box ) {\n\n\t\tthis.min.max( box.min );\n\t\tthis.max.min( box.max );\n\n\t\t// ensure that if there is no overlap, the result is fully empty, not slightly empty with non-inf/+inf values that will cause subsequence intersects to erroneously return valid values.\n\t\tif ( this.isEmpty() ) this.makeEmpty();\n\n\t\treturn this;\n\n\t}\n\n\tunion( box ) {\n\n\t\tthis.min.min( box.min );\n\t\tthis.max.max( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\t// transform of empty box is an empty box.\n\t\tif ( this.isEmpty() ) return this;\n\n\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\n\t\t_points[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\n\t\t_points[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\n\t\t_points[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\n\t\t_points[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\n\t\t_points[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\n\t\t_points[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\n\t\t_points[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\n\t\t_points[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 111\n\n\t\tthis.setFromPoints( _points );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.min.add( offset );\n\t\tthis.max.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\tequals( box ) {\n\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\n\n\t}\n\n}\n\nBox3.prototype.isBox3 = true;\n\nconst _points = [\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3()\n];\n\nconst _vector$b = /*@__PURE__*/ new Vector3();\n\nconst _box$3 = /*@__PURE__*/ new Box3();\n\n// triangle centered vertices\n\nconst _v0$2 = /*@__PURE__*/ new Vector3();\nconst _v1$7 = /*@__PURE__*/ new Vector3();\nconst _v2$3 = /*@__PURE__*/ new Vector3();\n\n// triangle edge vectors\n\nconst _f0 = /*@__PURE__*/ new Vector3();\nconst _f1 = /*@__PURE__*/ new Vector3();\nconst _f2 = /*@__PURE__*/ new Vector3();\n\nconst _center = /*@__PURE__*/ new Vector3();\nconst _extents = /*@__PURE__*/ new Vector3();\nconst _triangleNormal = /*@__PURE__*/ new Vector3();\nconst _testAxis = /*@__PURE__*/ new Vector3();\n\nfunction satForAxes( axes, v0, v1, v2, extents ) {\n\n\tfor ( let i = 0, j = axes.length - 3; i <= j; i += 3 ) {\n\n\t\t_testAxis.fromArray( axes, i );\n\t\t// project the aabb onto the seperating axis\n\t\tconst r = extents.x * Math.abs( _testAxis.x ) + extents.y * Math.abs( _testAxis.y ) + extents.z * Math.abs( _testAxis.z );\n\t\t// project all 3 vertices of the triangle onto the seperating axis\n\t\tconst p0 = v0.dot( _testAxis );\n\t\tconst p1 = v1.dot( _testAxis );\n\t\tconst p2 = v2.dot( _testAxis );\n\t\t// actual test, basically see if either of the most extreme of the triangle points intersects r\n\t\tif ( Math.max( - Math.max( p0, p1, p2 ), Math.min( p0, p1, p2 ) ) > r ) {\n\n\t\t\t// points of the projected triangle are outside the projected half-length of the aabb\n\t\t\t// the axis is seperating and we can exit\n\t\t\treturn false;\n\n\t\t}\n\n\t}\n\n\treturn true;\n\n}\n\nconst _box$2 = /*@__PURE__*/ new Box3();\nconst _v1$6 = /*@__PURE__*/ new Vector3();\nconst _toFarthestPoint = /*@__PURE__*/ new Vector3();\nconst _toPoint = /*@__PURE__*/ new Vector3();\n\nclass Sphere {\n\n\tconstructor( center = new Vector3(), radius = - 1 ) {\n\n\t\tthis.center = center;\n\t\tthis.radius = radius;\n\n\t}\n\n\tset( center, radius ) {\n\n\t\tthis.center.copy( center );\n\t\tthis.radius = radius;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points, optionalCenter ) {\n\n\t\tconst center = this.center;\n\n\t\tif ( optionalCenter !== undefined ) {\n\n\t\t\tcenter.copy( optionalCenter );\n\n\t\t} else {\n\n\t\t\t_box$2.setFromPoints( points ).getCenter( center );\n\n\t\t}\n\n\t\tlet maxRadiusSq = 0;\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\n\n\t\t}\n\n\t\tthis.radius = Math.sqrt( maxRadiusSq );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( sphere ) {\n\n\t\tthis.center.copy( sphere.center );\n\t\tthis.radius = sphere.radius;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\treturn ( this.radius < 0 );\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.center.set( 0, 0, 0 );\n\t\tthis.radius = - 1;\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn ( point.distanceTo( this.center ) - this.radius );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\tconst radiusSum = this.radius + sphere.radius;\n\n\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsSphere( this );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\treturn Math.abs( plane.distanceToPoint( this.center ) ) <= this.radius;\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\tconst deltaLengthSq = this.center.distanceToSquared( point );\n\n\t\ttarget.copy( point );\n\n\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\n\n\t\t\ttarget.sub( this.center ).normalize();\n\t\t\ttarget.multiplyScalar( this.radius ).add( this.center );\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\tgetBoundingBox( target ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\t// Empty sphere produces empty bounding box\n\t\t\ttarget.makeEmpty();\n\t\t\treturn target;\n\n\t\t}\n\n\t\ttarget.set( this.center, this.center );\n\t\ttarget.expandByScalar( this.radius );\n\n\t\treturn target;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tthis.center.applyMatrix4( matrix );\n\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.center.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\t// from https://github.com/juj/MathGeoLib/blob/2940b99b99cfe575dd45103ef20f4019dee15b54/src/Geometry/Sphere.cpp#L649-L671\n\n\t\t_toPoint.subVectors( point, this.center );\n\n\t\tconst lengthSq = _toPoint.lengthSq();\n\n\t\tif ( lengthSq > ( this.radius * this.radius ) ) {\n\n\t\t\tconst length = Math.sqrt( lengthSq );\n\t\t\tconst missingRadiusHalf = ( length - this.radius ) * 0.5;\n\n\t\t\t// Nudge this sphere towards the target point. Add half the missing distance to radius,\n\t\t\t// and the other half to position. This gives a tighter enclosure, instead of if\n\t\t\t// the whole missing distance were just added to radius.\n\n\t\t\tthis.center.add( _toPoint.multiplyScalar( missingRadiusHalf / length ) );\n\t\t\tthis.radius += missingRadiusHalf;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunion( sphere ) {\n\n\t\t// from https://github.com/juj/MathGeoLib/blob/2940b99b99cfe575dd45103ef20f4019dee15b54/src/Geometry/Sphere.cpp#L759-L769\n\n\t\t// To enclose another sphere into this sphere, we only need to enclose two points:\n\t\t// 1) Enclose the farthest point on the other sphere into this sphere.\n\t\t// 2) Enclose the opposite point of the farthest point into this sphere.\n\n\t\t if ( this.center.equals( sphere.center ) === true ) {\n\n\t\t\t _toFarthestPoint.set( 0, 0, 1 ).multiplyScalar( sphere.radius );\n\n\n\t\t} else {\n\n\t\t\t_toFarthestPoint.subVectors( sphere.center, this.center ).normalize().multiplyScalar( sphere.radius );\n\n\t\t}\n\n\t\tthis.expandByPoint( _v1$6.copy( sphere.center ).add( _toFarthestPoint ) );\n\t\tthis.expandByPoint( _v1$6.copy( sphere.center ).sub( _toFarthestPoint ) );\n\n\t\treturn this;\n\n\t}\n\n\tequals( sphere ) {\n\n\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _vector$a = /*@__PURE__*/ new Vector3();\nconst _segCenter = /*@__PURE__*/ new Vector3();\nconst _segDir = /*@__PURE__*/ new Vector3();\nconst _diff = /*@__PURE__*/ new Vector3();\n\nconst _edge1 = /*@__PURE__*/ new Vector3();\nconst _edge2 = /*@__PURE__*/ new Vector3();\nconst _normal$1 = /*@__PURE__*/ new Vector3();\n\nclass Ray {\n\n\tconstructor( origin = new Vector3(), direction = new Vector3( 0, 0, - 1 ) ) {\n\n\t\tthis.origin = origin;\n\t\tthis.direction = direction;\n\n\t}\n\n\tset( origin, direction ) {\n\n\t\tthis.origin.copy( origin );\n\t\tthis.direction.copy( direction );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( ray ) {\n\n\t\tthis.origin.copy( ray.origin );\n\t\tthis.direction.copy( ray.direction );\n\n\t\treturn this;\n\n\t}\n\n\tat( t, target ) {\n\n\t\treturn target.copy( this.direction ).multiplyScalar( t ).add( this.origin );\n\n\t}\n\n\tlookAt( v ) {\n\n\t\tthis.direction.copy( v ).sub( this.origin ).normalize();\n\n\t\treturn this;\n\n\t}\n\n\trecast( t ) {\n\n\t\tthis.origin.copy( this.at( t, _vector$a ) );\n\n\t\treturn this;\n\n\t}\n\n\tclosestPointToPoint( point, target ) {\n\n\t\ttarget.subVectors( point, this.origin );\n\n\t\tconst directionDistance = target.dot( this.direction );\n\n\t\tif ( directionDistance < 0 ) {\n\n\t\t\treturn target.copy( this.origin );\n\n\t\t}\n\n\t\treturn target.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn Math.sqrt( this.distanceSqToPoint( point ) );\n\n\t}\n\n\tdistanceSqToPoint( point ) {\n\n\t\tconst directionDistance = _vector$a.subVectors( point, this.origin ).dot( this.direction );\n\n\t\t// point behind the ray\n\n\t\tif ( directionDistance < 0 ) {\n\n\t\t\treturn this.origin.distanceToSquared( point );\n\n\t\t}\n\n\t\t_vector$a.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\n\n\t\treturn _vector$a.distanceToSquared( point );\n\n\t}\n\n\tdistanceSqToSegment( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\n\n\t\t// from https://github.com/pmjoniak/GeometricTools/blob/master/GTEngine/Include/Mathematics/GteDistRaySegment.h\n\t\t// It returns the min distance between the ray and the segment\n\t\t// defined by v0 and v1\n\t\t// It can also set two optional targets :\n\t\t// - The closest point on the ray\n\t\t// - The closest point on the segment\n\n\t\t_segCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\n\t\t_segDir.copy( v1 ).sub( v0 ).normalize();\n\t\t_diff.copy( this.origin ).sub( _segCenter );\n\n\t\tconst segExtent = v0.distanceTo( v1 ) * 0.5;\n\t\tconst a01 = - this.direction.dot( _segDir );\n\t\tconst b0 = _diff.dot( this.direction );\n\t\tconst b1 = - _diff.dot( _segDir );\n\t\tconst c = _diff.lengthSq();\n\t\tconst det = Math.abs( 1 - a01 * a01 );\n\t\tlet s0, s1, sqrDist, extDet;\n\n\t\tif ( det > 0 ) {\n\n\t\t\t// The ray and segment are not parallel.\n\n\t\t\ts0 = a01 * b1 - b0;\n\t\t\ts1 = a01 * b0 - b1;\n\t\t\textDet = segExtent * det;\n\n\t\t\tif ( s0 >= 0 ) {\n\n\t\t\t\tif ( s1 >= - extDet ) {\n\n\t\t\t\t\tif ( s1 <= extDet ) {\n\n\t\t\t\t\t\t// region 0\n\t\t\t\t\t\t// Minimum at interior points of ray and segment.\n\n\t\t\t\t\t\tconst invDet = 1 / det;\n\t\t\t\t\t\ts0 *= invDet;\n\t\t\t\t\t\ts1 *= invDet;\n\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// region 1\n\n\t\t\t\t\t\ts1 = segExtent;\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// region 5\n\n\t\t\t\t\ts1 = - segExtent;\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( s1 <= - extDet ) {\n\n\t\t\t\t\t// region 4\n\n\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\n\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t} else if ( s1 <= extDet ) {\n\n\t\t\t\t\t// region 3\n\n\t\t\t\t\ts0 = 0;\n\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// region 2\n\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\n\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// Ray and segment are parallel.\n\n\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\n\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t}\n\n\t\tif ( optionalPointOnRay ) {\n\n\t\t\toptionalPointOnRay.copy( this.direction ).multiplyScalar( s0 ).add( this.origin );\n\n\t\t}\n\n\t\tif ( optionalPointOnSegment ) {\n\n\t\t\toptionalPointOnSegment.copy( _segDir ).multiplyScalar( s1 ).add( _segCenter );\n\n\t\t}\n\n\t\treturn sqrDist;\n\n\t}\n\n\tintersectSphere( sphere, target ) {\n\n\t\t_vector$a.subVectors( sphere.center, this.origin );\n\t\tconst tca = _vector$a.dot( this.direction );\n\t\tconst d2 = _vector$a.dot( _vector$a ) - tca * tca;\n\t\tconst radius2 = sphere.radius * sphere.radius;\n\n\t\tif ( d2 > radius2 ) return null;\n\n\t\tconst thc = Math.sqrt( radius2 - d2 );\n\n\t\t// t0 = first intersect point - entrance on front of sphere\n\t\tconst t0 = tca - thc;\n\n\t\t// t1 = second intersect point - exit point on back of sphere\n\t\tconst t1 = tca + thc;\n\n\t\t// test to see if both t0 and t1 are behind the ray - if so, return null\n\t\tif ( t0 < 0 && t1 < 0 ) return null;\n\n\t\t// test to see if t0 is behind the ray:\n\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\n\t\t// in order to always return an intersect point that is in front of the ray.\n\t\tif ( t0 < 0 ) return this.at( t1, target );\n\n\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0\n\t\treturn this.at( t0, target );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\treturn this.distanceSqToPoint( sphere.center ) <= ( sphere.radius * sphere.radius );\n\n\t}\n\n\tdistanceToPlane( plane ) {\n\n\t\tconst denominator = plane.normal.dot( this.direction );\n\n\t\tif ( denominator === 0 ) {\n\n\t\t\t// line is coplanar, return origin\n\t\t\tif ( plane.distanceToPoint( this.origin ) === 0 ) {\n\n\t\t\t\treturn 0;\n\n\t\t\t}\n\n\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\n\n\t\t// Return if the ray never intersects the plane\n\n\t\treturn t >= 0 ? t : null;\n\n\t}\n\n\tintersectPlane( plane, target ) {\n\n\t\tconst t = this.distanceToPlane( plane );\n\n\t\tif ( t === null ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn this.at( t, target );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\t// check if the ray lies on the plane first\n\n\t\tconst distToPoint = plane.distanceToPoint( this.origin );\n\n\t\tif ( distToPoint === 0 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\tconst denominator = plane.normal.dot( this.direction );\n\n\t\tif ( denominator * distToPoint < 0 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\t// ray origin is behind the plane (and is pointing behind it)\n\n\t\treturn false;\n\n\t}\n\n\tintersectBox( box, target ) {\n\n\t\tlet tmin, tmax, tymin, tymax, tzmin, tzmax;\n\n\t\tconst invdirx = 1 / this.direction.x,\n\t\t\tinvdiry = 1 / this.direction.y,\n\t\t\tinvdirz = 1 / this.direction.z;\n\n\t\tconst origin = this.origin;\n\n\t\tif ( invdirx >= 0 ) {\n\n\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\n\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\n\n\t\t} else {\n\n\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\n\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\n\n\t\t}\n\n\t\tif ( invdiry >= 0 ) {\n\n\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\n\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\n\n\t\t} else {\n\n\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\n\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\n\n\t\t}\n\n\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) return null;\n\n\t\t// These lines also handle the case where tmin or tmax is NaN\n\t\t// (result of 0 * Infinity). x !== x returns true if x is NaN\n\n\t\tif ( tymin > tmin || tmin !== tmin ) tmin = tymin;\n\n\t\tif ( tymax < tmax || tmax !== tmax ) tmax = tymax;\n\n\t\tif ( invdirz >= 0 ) {\n\n\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\n\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\n\n\t\t} else {\n\n\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\n\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\n\n\t\t}\n\n\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) return null;\n\n\t\tif ( tzmin > tmin || tmin !== tmin ) tmin = tzmin;\n\n\t\tif ( tzmax < tmax || tmax !== tmax ) tmax = tzmax;\n\n\t\t//return point closest to the ray (positive side)\n\n\t\tif ( tmax < 0 ) return null;\n\n\t\treturn this.at( tmin >= 0 ? tmin : tmax, target );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn this.intersectBox( box, _vector$a ) !== null;\n\n\t}\n\n\tintersectTriangle( a, b, c, backfaceCulling, target ) {\n\n\t\t// Compute the offset origin, edges, and normal.\n\n\t\t// from https://github.com/pmjoniak/GeometricTools/blob/master/GTEngine/Include/Mathematics/GteIntrRay3Triangle3.h\n\n\t\t_edge1.subVectors( b, a );\n\t\t_edge2.subVectors( c, a );\n\t\t_normal$1.crossVectors( _edge1, _edge2 );\n\n\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\n\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\n\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\n\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\n\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\n\t\tlet DdN = this.direction.dot( _normal$1 );\n\t\tlet sign;\n\n\t\tif ( DdN > 0 ) {\n\n\t\t\tif ( backfaceCulling ) return null;\n\t\t\tsign = 1;\n\n\t\t} else if ( DdN < 0 ) {\n\n\t\t\tsign = - 1;\n\t\t\tDdN = - DdN;\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t_diff.subVectors( this.origin, a );\n\t\tconst DdQxE2 = sign * this.direction.dot( _edge2.crossVectors( _diff, _edge2 ) );\n\n\t\t// b1 < 0, no intersection\n\t\tif ( DdQxE2 < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst DdE1xQ = sign * this.direction.dot( _edge1.cross( _diff ) );\n\n\t\t// b2 < 0, no intersection\n\t\tif ( DdE1xQ < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// b1+b2 > 1, no intersection\n\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// Line intersects triangle, check if ray does.\n\t\tconst QdN = - sign * _diff.dot( _normal$1 );\n\n\t\t// t < 0, no intersection\n\t\tif ( QdN < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// Ray intersects triangle.\n\t\treturn this.at( QdN / DdN, target );\n\n\t}\n\n\tapplyMatrix4( matrix4 ) {\n\n\t\tthis.origin.applyMatrix4( matrix4 );\n\t\tthis.direction.transformDirection( matrix4 );\n\n\t\treturn this;\n\n\t}\n\n\tequals( ray ) {\n\n\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nclass Matrix4 {\n\n\tconstructor() {\n\n\t\tthis.elements = [\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t];\n\n\t\tif ( arguments.length > 0 ) {\n\n\t\t\tconsole.error( 'THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.' );\n\n\t\t}\n\n\t}\n\n\tset( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\n\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\n\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\n\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new Matrix4().fromArray( this.elements );\n\n\t}\n\n\tcopy( m ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ]; te[ 3 ] = me[ 3 ];\n\t\tte[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ]; te[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ];\n\t\tte[ 8 ] = me[ 8 ]; te[ 9 ] = me[ 9 ]; te[ 10 ] = me[ 10 ]; te[ 11 ] = me[ 11 ];\n\t\tte[ 12 ] = me[ 12 ]; te[ 13 ] = me[ 13 ]; te[ 14 ] = me[ 14 ]; te[ 15 ] = me[ 15 ];\n\n\t\treturn this;\n\n\t}\n\n\tcopyPosition( m ) {\n\n\t\tconst te = this.elements, me = m.elements;\n\n\t\tte[ 12 ] = me[ 12 ];\n\t\tte[ 13 ] = me[ 13 ];\n\t\tte[ 14 ] = me[ 14 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrix3( m ) {\n\n\t\tconst me = m.elements;\n\n\t\tthis.set(\n\n\t\t\tme[ 0 ], me[ 3 ], me[ 6 ], 0,\n\t\t\tme[ 1 ], me[ 4 ], me[ 7 ], 0,\n\t\t\tme[ 2 ], me[ 5 ], me[ 8 ], 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\textractBasis( xAxis, yAxis, zAxis ) {\n\n\t\txAxis.setFromMatrixColumn( this, 0 );\n\t\tyAxis.setFromMatrixColumn( this, 1 );\n\t\tzAxis.setFromMatrixColumn( this, 2 );\n\n\t\treturn this;\n\n\t}\n\n\tmakeBasis( xAxis, yAxis, zAxis ) {\n\n\t\tthis.set(\n\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\n\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\n\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\n\t\t\t0, 0, 0, 1\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\textractRotation( m ) {\n\n\t\t// this method does not support reflection matrices\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tconst scaleX = 1 / _v1$5.setFromMatrixColumn( m, 0 ).length();\n\t\tconst scaleY = 1 / _v1$5.setFromMatrixColumn( m, 1 ).length();\n\t\tconst scaleZ = 1 / _v1$5.setFromMatrixColumn( m, 2 ).length();\n\n\t\tte[ 0 ] = me[ 0 ] * scaleX;\n\t\tte[ 1 ] = me[ 1 ] * scaleX;\n\t\tte[ 2 ] = me[ 2 ] * scaleX;\n\t\tte[ 3 ] = 0;\n\n\t\tte[ 4 ] = me[ 4 ] * scaleY;\n\t\tte[ 5 ] = me[ 5 ] * scaleY;\n\t\tte[ 6 ] = me[ 6 ] * scaleY;\n\t\tte[ 7 ] = 0;\n\n\t\tte[ 8 ] = me[ 8 ] * scaleZ;\n\t\tte[ 9 ] = me[ 9 ] * scaleZ;\n\t\tte[ 10 ] = me[ 10 ] * scaleZ;\n\t\tte[ 11 ] = 0;\n\n\t\tte[ 12 ] = 0;\n\t\tte[ 13 ] = 0;\n\t\tte[ 14 ] = 0;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationFromEuler( euler ) {\n\n\t\tif ( ! ( euler && euler.isEuler ) ) {\n\n\t\t\tconsole.error( 'THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\n\n\t\t}\n\n\t\tconst te = this.elements;\n\n\t\tconst x = euler.x, y = euler.y, z = euler.z;\n\t\tconst a = Math.cos( x ), b = Math.sin( x );\n\t\tconst c = Math.cos( y ), d = Math.sin( y );\n\t\tconst e = Math.cos( z ), f = Math.sin( z );\n\n\t\tif ( euler.order === 'XYZ' ) {\n\n\t\t\tconst ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = - c * f;\n\t\t\tte[ 8 ] = d;\n\n\t\t\tte[ 1 ] = af + be * d;\n\t\t\tte[ 5 ] = ae - bf * d;\n\t\t\tte[ 9 ] = - b * c;\n\n\t\t\tte[ 2 ] = bf - ae * d;\n\t\t\tte[ 6 ] = be + af * d;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'YXZ' ) {\n\n\t\t\tconst ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\tte[ 0 ] = ce + df * b;\n\t\t\tte[ 4 ] = de * b - cf;\n\t\t\tte[ 8 ] = a * d;\n\n\t\t\tte[ 1 ] = a * f;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = - b;\n\n\t\t\tte[ 2 ] = cf * b - de;\n\t\t\tte[ 6 ] = df + ce * b;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'ZXY' ) {\n\n\t\t\tconst ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\tte[ 0 ] = ce - df * b;\n\t\t\tte[ 4 ] = - a * f;\n\t\t\tte[ 8 ] = de + cf * b;\n\n\t\t\tte[ 1 ] = cf + de * b;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = df - ce * b;\n\n\t\t\tte[ 2 ] = - a * d;\n\t\t\tte[ 6 ] = b;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'ZYX' ) {\n\n\t\t\tconst ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = be * d - af;\n\t\t\tte[ 8 ] = ae * d + bf;\n\n\t\t\tte[ 1 ] = c * f;\n\t\t\tte[ 5 ] = bf * d + ae;\n\t\t\tte[ 9 ] = af * d - be;\n\n\t\t\tte[ 2 ] = - d;\n\t\t\tte[ 6 ] = b * c;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'YZX' ) {\n\n\t\t\tconst ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = bd - ac * f;\n\t\t\tte[ 8 ] = bc * f + ad;\n\n\t\t\tte[ 1 ] = f;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = - b * e;\n\n\t\t\tte[ 2 ] = - d * e;\n\t\t\tte[ 6 ] = ad * f + bc;\n\t\t\tte[ 10 ] = ac - bd * f;\n\n\t\t} else if ( euler.order === 'XZY' ) {\n\n\t\t\tconst ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = - f;\n\t\t\tte[ 8 ] = d * e;\n\n\t\t\tte[ 1 ] = ac * f + bd;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = ad * f - bc;\n\n\t\t\tte[ 2 ] = bc * f - ad;\n\t\t\tte[ 6 ] = b * e;\n\t\t\tte[ 10 ] = bd * f + ac;\n\n\t\t}\n\n\t\t// bottom row\n\t\tte[ 3 ] = 0;\n\t\tte[ 7 ] = 0;\n\t\tte[ 11 ] = 0;\n\n\t\t// last column\n\t\tte[ 12 ] = 0;\n\t\tte[ 13 ] = 0;\n\t\tte[ 14 ] = 0;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationFromQuaternion( q ) {\n\n\t\treturn this.compose( _zero, q, _one );\n\n\t}\n\n\tlookAt( eye, target, up ) {\n\n\t\tconst te = this.elements;\n\n\t\t_z.subVectors( eye, target );\n\n\t\tif ( _z.lengthSq() === 0 ) {\n\n\t\t\t// eye and target are in the same position\n\n\t\t\t_z.z = 1;\n\n\t\t}\n\n\t\t_z.normalize();\n\t\t_x.crossVectors( up, _z );\n\n\t\tif ( _x.lengthSq() === 0 ) {\n\n\t\t\t// up and z are parallel\n\n\t\t\tif ( Math.abs( up.z ) === 1 ) {\n\n\t\t\t\t_z.x += 0.0001;\n\n\t\t\t} else {\n\n\t\t\t\t_z.z += 0.0001;\n\n\t\t\t}\n\n\t\t\t_z.normalize();\n\t\t\t_x.crossVectors( up, _z );\n\n\t\t}\n\n\t\t_x.normalize();\n\t\t_y.crossVectors( _z, _x );\n\n\t\tte[ 0 ] = _x.x; te[ 4 ] = _y.x; te[ 8 ] = _z.x;\n\t\tte[ 1 ] = _x.y; te[ 5 ] = _y.y; te[ 9 ] = _z.y;\n\t\tte[ 2 ] = _x.z; te[ 6 ] = _y.z; te[ 10 ] = _z.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( m, n ) {\n\n\t\tif ( n !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.' );\n\t\t\treturn this.multiplyMatrices( m, n );\n\n\t\t}\n\n\t\treturn this.multiplyMatrices( this, m );\n\n\t}\n\n\tpremultiply( m ) {\n\n\t\treturn this.multiplyMatrices( m, this );\n\n\t}\n\n\tmultiplyMatrices( a, b ) {\n\n\t\tconst ae = a.elements;\n\t\tconst be = b.elements;\n\t\tconst te = this.elements;\n\n\t\tconst a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\n\t\tconst a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\n\t\tconst a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\n\t\tconst a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\n\n\t\tconst b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\n\t\tconst b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\n\t\tconst b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\n\t\tconst b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\n\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\n\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\n\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\n\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\n\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\n\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\n\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\n\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\n\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\n\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\n\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\n\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\n\n\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\n\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\n\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\n\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\n\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\n\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\n\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\n\n\t\treturn this;\n\n\t}\n\n\tdeterminant() {\n\n\t\tconst te = this.elements;\n\n\t\tconst n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\n\t\tconst n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\n\t\tconst n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\n\t\tconst n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\n\n\t\t//TODO: make this more efficient\n\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\n\n\t\treturn (\n\t\t\tn41 * (\n\t\t\t\t+ n14 * n23 * n32\n\t\t\t\t - n13 * n24 * n32\n\t\t\t\t - n14 * n22 * n33\n\t\t\t\t + n12 * n24 * n33\n\t\t\t\t + n13 * n22 * n34\n\t\t\t\t - n12 * n23 * n34\n\t\t\t) +\n\t\t\tn42 * (\n\t\t\t\t+ n11 * n23 * n34\n\t\t\t\t - n11 * n24 * n33\n\t\t\t\t + n14 * n21 * n33\n\t\t\t\t - n13 * n21 * n34\n\t\t\t\t + n13 * n24 * n31\n\t\t\t\t - n14 * n23 * n31\n\t\t\t) +\n\t\t\tn43 * (\n\t\t\t\t+ n11 * n24 * n32\n\t\t\t\t - n11 * n22 * n34\n\t\t\t\t - n14 * n21 * n32\n\t\t\t\t + n12 * n21 * n34\n\t\t\t\t + n14 * n22 * n31\n\t\t\t\t - n12 * n24 * n31\n\t\t\t) +\n\t\t\tn44 * (\n\t\t\t\t- n13 * n22 * n31\n\t\t\t\t - n11 * n23 * n32\n\t\t\t\t + n11 * n22 * n33\n\t\t\t\t + n13 * n21 * n32\n\t\t\t\t - n12 * n21 * n33\n\t\t\t\t + n12 * n23 * n31\n\t\t\t)\n\n\t\t);\n\n\t}\n\n\ttranspose() {\n\n\t\tconst te = this.elements;\n\t\tlet tmp;\n\n\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\n\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\n\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\n\n\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\n\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\n\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\n\n\t\treturn this;\n\n\t}\n\n\tsetPosition( x, y, z ) {\n\n\t\tconst te = this.elements;\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\tte[ 12 ] = x.x;\n\t\t\tte[ 13 ] = x.y;\n\t\t\tte[ 14 ] = x.z;\n\n\t\t} else {\n\n\t\t\tte[ 12 ] = x;\n\t\t\tte[ 13 ] = y;\n\t\t\tte[ 14 ] = z;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tinvert() {\n\n\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\n\t\tconst te = this.elements,\n\n\t\t\tn11 = te[ 0 ], n21 = te[ 1 ], n31 = te[ 2 ], n41 = te[ 3 ],\n\t\t\tn12 = te[ 4 ], n22 = te[ 5 ], n32 = te[ 6 ], n42 = te[ 7 ],\n\t\t\tn13 = te[ 8 ], n23 = te[ 9 ], n33 = te[ 10 ], n43 = te[ 11 ],\n\t\t\tn14 = te[ 12 ], n24 = te[ 13 ], n34 = te[ 14 ], n44 = te[ 15 ],\n\n\t\t\tt11 = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44,\n\t\t\tt12 = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44,\n\t\t\tt13 = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44,\n\t\t\tt14 = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\n\n\t\tconst det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;\n\n\t\tif ( det === 0 ) return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );\n\n\t\tconst detInv = 1 / det;\n\n\t\tte[ 0 ] = t11 * detInv;\n\t\tte[ 1 ] = ( n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44 ) * detInv;\n\t\tte[ 2 ] = ( n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44 ) * detInv;\n\t\tte[ 3 ] = ( n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43 ) * detInv;\n\n\t\tte[ 4 ] = t12 * detInv;\n\t\tte[ 5 ] = ( n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44 ) * detInv;\n\t\tte[ 6 ] = ( n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44 ) * detInv;\n\t\tte[ 7 ] = ( n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43 ) * detInv;\n\n\t\tte[ 8 ] = t13 * detInv;\n\t\tte[ 9 ] = ( n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44 ) * detInv;\n\t\tte[ 10 ] = ( n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44 ) * detInv;\n\t\tte[ 11 ] = ( n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43 ) * detInv;\n\n\t\tte[ 12 ] = t14 * detInv;\n\t\tte[ 13 ] = ( n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34 ) * detInv;\n\t\tte[ 14 ] = ( n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34 ) * detInv;\n\t\tte[ 15 ] = ( n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33 ) * detInv;\n\n\t\treturn this;\n\n\t}\n\n\tscale( v ) {\n\n\t\tconst te = this.elements;\n\t\tconst x = v.x, y = v.y, z = v.z;\n\n\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\n\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\n\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\n\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\n\n\t\treturn this;\n\n\t}\n\n\tgetMaxScaleOnAxis() {\n\n\t\tconst te = this.elements;\n\n\t\tconst scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\n\t\tconst scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\n\t\tconst scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\n\n\t\treturn Math.sqrt( Math.max( scaleXSq, scaleYSq, scaleZSq ) );\n\n\t}\n\n\tmakeTranslation( x, y, z ) {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, x,\n\t\t\t0, 1, 0, y,\n\t\t\t0, 0, 1, z,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationX( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, c, - s, 0,\n\t\t\t0, s, c, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationY( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\t c, 0, s, 0,\n\t\t\t 0, 1, 0, 0,\n\t\t\t- s, 0, c, 0,\n\t\t\t 0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationZ( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\tc, - s, 0, 0,\n\t\t\ts, c, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationAxis( axis, angle ) {\n\n\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\n\n\t\tconst c = Math.cos( angle );\n\t\tconst s = Math.sin( angle );\n\t\tconst t = 1 - c;\n\t\tconst x = axis.x, y = axis.y, z = axis.z;\n\t\tconst tx = t * x, ty = t * y;\n\n\t\tthis.set(\n\n\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\n\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\n\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeScale( x, y, z ) {\n\n\t\tthis.set(\n\n\t\t\tx, 0, 0, 0,\n\t\t\t0, y, 0, 0,\n\t\t\t0, 0, z, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeShear( xy, xz, yx, yz, zx, zy ) {\n\n\t\tthis.set(\n\n\t\t\t1, yx, zx, 0,\n\t\t\txy, 1, zy, 0,\n\t\t\txz, yz, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tcompose( position, quaternion, scale ) {\n\n\t\tconst te = this.elements;\n\n\t\tconst x = quaternion._x, y = quaternion._y, z = quaternion._z, w = quaternion._w;\n\t\tconst x2 = x + x,\ty2 = y + y, z2 = z + z;\n\t\tconst xx = x * x2, xy = x * y2, xz = x * z2;\n\t\tconst yy = y * y2, yz = y * z2, zz = z * z2;\n\t\tconst wx = w * x2, wy = w * y2, wz = w * z2;\n\n\t\tconst sx = scale.x, sy = scale.y, sz = scale.z;\n\n\t\tte[ 0 ] = ( 1 - ( yy + zz ) ) * sx;\n\t\tte[ 1 ] = ( xy + wz ) * sx;\n\t\tte[ 2 ] = ( xz - wy ) * sx;\n\t\tte[ 3 ] = 0;\n\n\t\tte[ 4 ] = ( xy - wz ) * sy;\n\t\tte[ 5 ] = ( 1 - ( xx + zz ) ) * sy;\n\t\tte[ 6 ] = ( yz + wx ) * sy;\n\t\tte[ 7 ] = 0;\n\n\t\tte[ 8 ] = ( xz + wy ) * sz;\n\t\tte[ 9 ] = ( yz - wx ) * sz;\n\t\tte[ 10 ] = ( 1 - ( xx + yy ) ) * sz;\n\t\tte[ 11 ] = 0;\n\n\t\tte[ 12 ] = position.x;\n\t\tte[ 13 ] = position.y;\n\t\tte[ 14 ] = position.z;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tdecompose( position, quaternion, scale ) {\n\n\t\tconst te = this.elements;\n\n\t\tlet sx = _v1$5.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\n\t\tconst sy = _v1$5.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\n\t\tconst sz = _v1$5.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\n\n\t\t// if determine is negative, we need to invert one scale\n\t\tconst det = this.determinant();\n\t\tif ( det < 0 ) sx = - sx;\n\n\t\tposition.x = te[ 12 ];\n\t\tposition.y = te[ 13 ];\n\t\tposition.z = te[ 14 ];\n\n\t\t// scale the rotation part\n\t\t_m1$2.copy( this );\n\n\t\tconst invSX = 1 / sx;\n\t\tconst invSY = 1 / sy;\n\t\tconst invSZ = 1 / sz;\n\n\t\t_m1$2.elements[ 0 ] *= invSX;\n\t\t_m1$2.elements[ 1 ] *= invSX;\n\t\t_m1$2.elements[ 2 ] *= invSX;\n\n\t\t_m1$2.elements[ 4 ] *= invSY;\n\t\t_m1$2.elements[ 5 ] *= invSY;\n\t\t_m1$2.elements[ 6 ] *= invSY;\n\n\t\t_m1$2.elements[ 8 ] *= invSZ;\n\t\t_m1$2.elements[ 9 ] *= invSZ;\n\t\t_m1$2.elements[ 10 ] *= invSZ;\n\n\t\tquaternion.setFromRotationMatrix( _m1$2 );\n\n\t\tscale.x = sx;\n\t\tscale.y = sy;\n\t\tscale.z = sz;\n\n\t\treturn this;\n\n\t}\n\n\tmakePerspective( left, right, top, bottom, near, far ) {\n\n\t\tif ( far === undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.' );\n\n\t\t}\n\n\t\tconst te = this.elements;\n\t\tconst x = 2 * near / ( right - left );\n\t\tconst y = 2 * near / ( top - bottom );\n\n\t\tconst a = ( right + left ) / ( right - left );\n\t\tconst b = ( top + bottom ) / ( top - bottom );\n\t\tconst c = - ( far + near ) / ( far - near );\n\t\tconst d = - 2 * far * near / ( far - near );\n\n\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a;\tte[ 12 ] = 0;\n\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b;\tte[ 13 ] = 0;\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c;\tte[ 14 ] = d;\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\n\n\t\treturn this;\n\n\t}\n\n\tmakeOrthographic( left, right, top, bottom, near, far ) {\n\n\t\tconst te = this.elements;\n\t\tconst w = 1.0 / ( right - left );\n\t\tconst h = 1.0 / ( top - bottom );\n\t\tconst p = 1.0 / ( far - near );\n\n\t\tconst x = ( right + left ) * w;\n\t\tconst y = ( top + bottom ) * h;\n\t\tconst z = ( far + near ) * p;\n\n\t\tte[ 0 ] = 2 * w;\tte[ 4 ] = 0;\tte[ 8 ] = 0;\tte[ 12 ] = - x;\n\t\tte[ 1 ] = 0;\tte[ 5 ] = 2 * h;\tte[ 9 ] = 0;\tte[ 13 ] = - y;\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = - 2 * p;\tte[ 14 ] = - z;\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = 0;\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tequals( matrix ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = matrix.elements;\n\n\t\tfor ( let i = 0; i < 16; i ++ ) {\n\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tfor ( let i = 0; i < 16; i ++ ) {\n\n\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst te = this.elements;\n\n\t\tarray[ offset ] = te[ 0 ];\n\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\tarray[ offset + 2 ] = te[ 2 ];\n\t\tarray[ offset + 3 ] = te[ 3 ];\n\n\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\tarray[ offset + 5 ] = te[ 5 ];\n\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\tarray[ offset + 7 ] = te[ 7 ];\n\n\t\tarray[ offset + 8 ] = te[ 8 ];\n\t\tarray[ offset + 9 ] = te[ 9 ];\n\t\tarray[ offset + 10 ] = te[ 10 ];\n\t\tarray[ offset + 11 ] = te[ 11 ];\n\n\t\tarray[ offset + 12 ] = te[ 12 ];\n\t\tarray[ offset + 13 ] = te[ 13 ];\n\t\tarray[ offset + 14 ] = te[ 14 ];\n\t\tarray[ offset + 15 ] = te[ 15 ];\n\n\t\treturn array;\n\n\t}\n\n}\n\nMatrix4.prototype.isMatrix4 = true;\n\nconst _v1$5 = /*@__PURE__*/ new Vector3();\nconst _m1$2 = /*@__PURE__*/ new Matrix4();\nconst _zero = /*@__PURE__*/ new Vector3( 0, 0, 0 );\nconst _one = /*@__PURE__*/ new Vector3( 1, 1, 1 );\nconst _x = /*@__PURE__*/ new Vector3();\nconst _y = /*@__PURE__*/ new Vector3();\nconst _z = /*@__PURE__*/ new Vector3();\n\nconst _matrix$1 = /*@__PURE__*/ new Matrix4();\nconst _quaternion$3 = /*@__PURE__*/ new Quaternion();\n\nclass Euler {\n\n\tconstructor( x = 0, y = 0, z = 0, order = Euler.DefaultOrder ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._order = order;\n\n\t}\n\n\tget x() {\n\n\t\treturn this._x;\n\n\t}\n\n\tset x( value ) {\n\n\t\tthis._x = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget y() {\n\n\t\treturn this._y;\n\n\t}\n\n\tset y( value ) {\n\n\t\tthis._y = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget z() {\n\n\t\treturn this._z;\n\n\t}\n\n\tset z( value ) {\n\n\t\tthis._z = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget order() {\n\n\t\treturn this._order;\n\n\t}\n\n\tset order( value ) {\n\n\t\tthis._order = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tset( x, y, z, order = this._order ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._order = order;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._order );\n\n\t}\n\n\tcopy( euler ) {\n\n\t\tthis._x = euler._x;\n\t\tthis._y = euler._y;\n\t\tthis._z = euler._z;\n\t\tthis._order = euler._order;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromRotationMatrix( m, order = this._order, update = true ) {\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tconst te = m.elements;\n\t\tconst m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\n\t\tconst m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\n\t\tconst m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\tswitch ( order ) {\n\n\t\t\tcase 'XYZ':\n\n\t\t\t\tthis._y = Math.asin( clamp( m13, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m13 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\t\tthis._z = Math.atan2( - m12, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\t\tthis._z = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'YXZ':\n\n\t\t\t\tthis._x = Math.asin( - clamp( m23, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m23 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\t\t\t\t\tthis._z = Math.atan2( m21, m22 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\t\t\t\t\tthis._z = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZXY':\n\n\t\t\t\tthis._x = Math.asin( clamp( m32, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m32 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._y = Math.atan2( - m31, m33 );\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._y = 0;\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZYX':\n\n\t\t\t\tthis._y = Math.asin( - clamp( m31, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m31 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m33 );\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = 0;\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'YZX':\n\n\t\t\t\tthis._z = Math.asin( clamp( m21, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m21 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m22 );\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = 0;\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'XZY':\n\n\t\t\t\tthis._z = Math.asin( - clamp( m12, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m12 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\t\tthis._y = Math.atan2( m13, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\t\tthis._y = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tconsole.warn( 'THREE.Euler: .setFromRotationMatrix() encountered an unknown order: ' + order );\n\n\t\t}\n\n\t\tthis._order = order;\n\n\t\tif ( update === true ) this._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromQuaternion( q, order, update ) {\n\n\t\t_matrix$1.makeRotationFromQuaternion( q );\n\n\t\treturn this.setFromRotationMatrix( _matrix$1, order, update );\n\n\t}\n\n\tsetFromVector3( v, order = this._order ) {\n\n\t\treturn this.set( v.x, v.y, v.z, order );\n\n\t}\n\n\treorder( newOrder ) {\n\n\t\t// WARNING: this discards revolution information -bhouston\n\n\t\t_quaternion$3.setFromEuler( this );\n\n\t\treturn this.setFromQuaternion( _quaternion$3, newOrder );\n\n\t}\n\n\tequals( euler ) {\n\n\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\n\n\t}\n\n\tfromArray( array ) {\n\n\t\tthis._x = array[ 0 ];\n\t\tthis._y = array[ 1 ];\n\t\tthis._z = array[ 2 ];\n\t\tif ( array[ 3 ] !== undefined ) this._order = array[ 3 ];\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._order;\n\n\t\treturn array;\n\n\t}\n\n\ttoVector3( optionalResult ) {\n\n\t\tif ( optionalResult ) {\n\n\t\t\treturn optionalResult.set( this._x, this._y, this._z );\n\n\t\t} else {\n\n\t\t\treturn new Vector3( this._x, this._y, this._z );\n\n\t\t}\n\n\t}\n\n\t_onChange( callback ) {\n\n\t\tthis._onChangeCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\t_onChangeCallback() {}\n\n}\n\nEuler.prototype.isEuler = true;\n\nEuler.DefaultOrder = 'XYZ';\nEuler.RotationOrders = [ 'XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX' ];\n\nclass Layers {\n\n\tconstructor() {\n\n\t\tthis.mask = 1 | 0;\n\n\t}\n\n\tset( channel ) {\n\n\t\tthis.mask = ( 1 << channel | 0 ) >>> 0;\n\n\t}\n\n\tenable( channel ) {\n\n\t\tthis.mask |= 1 << channel | 0;\n\n\t}\n\n\tenableAll() {\n\n\t\tthis.mask = 0xffffffff | 0;\n\n\t}\n\n\ttoggle( channel ) {\n\n\t\tthis.mask ^= 1 << channel | 0;\n\n\t}\n\n\tdisable( channel ) {\n\n\t\tthis.mask &= ~ ( 1 << channel | 0 );\n\n\t}\n\n\tdisableAll() {\n\n\t\tthis.mask = 0;\n\n\t}\n\n\ttest( layers ) {\n\n\t\treturn ( this.mask & layers.mask ) !== 0;\n\n\t}\n\n\tisEnabled( channel ) {\n\n\t\treturn ( this.mask & ( 1 << channel | 0 ) ) !== 0;\n\n\t}\n\n}\n\nlet _object3DId = 0;\n\nconst _v1$4 = /*@__PURE__*/ new Vector3();\nconst _q1 = /*@__PURE__*/ new Quaternion();\nconst _m1$1 = /*@__PURE__*/ new Matrix4();\nconst _target = /*@__PURE__*/ new Vector3();\n\nconst _position$3 = /*@__PURE__*/ new Vector3();\nconst _scale$2 = /*@__PURE__*/ new Vector3();\nconst _quaternion$2 = /*@__PURE__*/ new Quaternion();\n\nconst _xAxis = /*@__PURE__*/ new Vector3( 1, 0, 0 );\nconst _yAxis = /*@__PURE__*/ new Vector3( 0, 1, 0 );\nconst _zAxis = /*@__PURE__*/ new Vector3( 0, 0, 1 );\n\nconst _addedEvent = { type: 'added' };\nconst _removedEvent = { type: 'removed' };\n\nclass Object3D extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tObject.defineProperty( this, 'id', { value: _object3DId ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Object3D';\n\n\t\tthis.parent = null;\n\t\tthis.children = [];\n\n\t\tthis.up = Object3D.DefaultUp.clone();\n\n\t\tconst position = new Vector3();\n\t\tconst rotation = new Euler();\n\t\tconst quaternion = new Quaternion();\n\t\tconst scale = new Vector3( 1, 1, 1 );\n\n\t\tfunction onRotationChange() {\n\n\t\t\tquaternion.setFromEuler( rotation, false );\n\n\t\t}\n\n\t\tfunction onQuaternionChange() {\n\n\t\t\trotation.setFromQuaternion( quaternion, undefined, false );\n\n\t\t}\n\n\t\trotation._onChange( onRotationChange );\n\t\tquaternion._onChange( onQuaternionChange );\n\n\t\tObject.defineProperties( this, {\n\t\t\tposition: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: position\n\t\t\t},\n\t\t\trotation: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: rotation\n\t\t\t},\n\t\t\tquaternion: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: quaternion\n\t\t\t},\n\t\t\tscale: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: scale\n\t\t\t},\n\t\t\tmodelViewMatrix: {\n\t\t\t\tvalue: new Matrix4()\n\t\t\t},\n\t\t\tnormalMatrix: {\n\t\t\t\tvalue: new Matrix3()\n\t\t\t}\n\t\t} );\n\n\t\tthis.matrix = new Matrix4();\n\t\tthis.matrixWorld = new Matrix4();\n\n\t\tthis.matrixAutoUpdate = Object3D.DefaultMatrixAutoUpdate;\n\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\tthis.layers = new Layers();\n\t\tthis.visible = true;\n\n\t\tthis.castShadow = false;\n\t\tthis.receiveShadow = false;\n\n\t\tthis.frustumCulled = true;\n\t\tthis.renderOrder = 0;\n\n\t\tthis.animations = [];\n\n\t\tthis.userData = {};\n\n\t}\n\n\tonBeforeRender( /* renderer, scene, camera, geometry, material, group */ ) {}\n\n\tonAfterRender( /* renderer, scene, camera, geometry, material, group */ ) {}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tthis.matrix.premultiply( matrix );\n\n\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\tthis.quaternion.premultiply( q );\n\n\t\treturn this;\n\n\t}\n\n\tsetRotationFromAxisAngle( axis, angle ) {\n\n\t\t// assumes axis is normalized\n\n\t\tthis.quaternion.setFromAxisAngle( axis, angle );\n\n\t}\n\n\tsetRotationFromEuler( euler ) {\n\n\t\tthis.quaternion.setFromEuler( euler, true );\n\n\t}\n\n\tsetRotationFromMatrix( m ) {\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tthis.quaternion.setFromRotationMatrix( m );\n\n\t}\n\n\tsetRotationFromQuaternion( q ) {\n\n\t\t// assumes q is normalized\n\n\t\tthis.quaternion.copy( q );\n\n\t}\n\n\trotateOnAxis( axis, angle ) {\n\n\t\t// rotate object on axis in object space\n\t\t// axis is assumed to be normalized\n\n\t\t_q1.setFromAxisAngle( axis, angle );\n\n\t\tthis.quaternion.multiply( _q1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateOnWorldAxis( axis, angle ) {\n\n\t\t// rotate object on axis in world space\n\t\t// axis is assumed to be normalized\n\t\t// method assumes no rotated parent\n\n\t\t_q1.setFromAxisAngle( axis, angle );\n\n\t\tthis.quaternion.premultiply( _q1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateX( angle ) {\n\n\t\treturn this.rotateOnAxis( _xAxis, angle );\n\n\t}\n\n\trotateY( angle ) {\n\n\t\treturn this.rotateOnAxis( _yAxis, angle );\n\n\t}\n\n\trotateZ( angle ) {\n\n\t\treturn this.rotateOnAxis( _zAxis, angle );\n\n\t}\n\n\ttranslateOnAxis( axis, distance ) {\n\n\t\t// translate object by distance along axis in object space\n\t\t// axis is assumed to be normalized\n\n\t\t_v1$4.copy( axis ).applyQuaternion( this.quaternion );\n\n\t\tthis.position.add( _v1$4.multiplyScalar( distance ) );\n\n\t\treturn this;\n\n\t}\n\n\ttranslateX( distance ) {\n\n\t\treturn this.translateOnAxis( _xAxis, distance );\n\n\t}\n\n\ttranslateY( distance ) {\n\n\t\treturn this.translateOnAxis( _yAxis, distance );\n\n\t}\n\n\ttranslateZ( distance ) {\n\n\t\treturn this.translateOnAxis( _zAxis, distance );\n\n\t}\n\n\tlocalToWorld( vector ) {\n\n\t\treturn vector.applyMatrix4( this.matrixWorld );\n\n\t}\n\n\tworldToLocal( vector ) {\n\n\t\treturn vector.applyMatrix4( _m1$1.copy( this.matrixWorld ).invert() );\n\n\t}\n\n\tlookAt( x, y, z ) {\n\n\t\t// This method does not support objects having non-uniformly-scaled parent(s)\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\t_target.copy( x );\n\n\t\t} else {\n\n\t\t\t_target.set( x, y, z );\n\n\t\t}\n\n\t\tconst parent = this.parent;\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\t_position$3.setFromMatrixPosition( this.matrixWorld );\n\n\t\tif ( this.isCamera || this.isLight ) {\n\n\t\t\t_m1$1.lookAt( _position$3, _target, this.up );\n\n\t\t} else {\n\n\t\t\t_m1$1.lookAt( _target, _position$3, this.up );\n\n\t\t}\n\n\t\tthis.quaternion.setFromRotationMatrix( _m1$1 );\n\n\t\tif ( parent ) {\n\n\t\t\t_m1$1.extractRotation( parent.matrixWorld );\n\t\t\t_q1.setFromRotationMatrix( _m1$1 );\n\t\t\tthis.quaternion.premultiply( _q1.invert() );\n\n\t\t}\n\n\t}\n\n\tadd( object ) {\n\n\t\tif ( arguments.length > 1 ) {\n\n\t\t\tfor ( let i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\tthis.add( arguments[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( object === this ) {\n\n\t\t\tconsole.error( 'THREE.Object3D.add: object can\\'t be added as a child of itself.', object );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( object && object.isObject3D ) {\n\n\t\t\tif ( object.parent !== null ) {\n\n\t\t\t\tobject.parent.remove( object );\n\n\t\t\t}\n\n\t\t\tobject.parent = this;\n\t\t\tthis.children.push( object );\n\n\t\t\tobject.dispatchEvent( _addedEvent );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Object3D.add: object not an instance of THREE.Object3D.', object );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremove( object ) {\n\n\t\tif ( arguments.length > 1 ) {\n\n\t\t\tfor ( let i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\tthis.remove( arguments[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst index = this.children.indexOf( object );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\tobject.parent = null;\n\t\t\tthis.children.splice( index, 1 );\n\n\t\t\tobject.dispatchEvent( _removedEvent );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremoveFromParent() {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( parent !== null ) {\n\n\t\t\tparent.remove( this );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclear() {\n\n\t\tfor ( let i = 0; i < this.children.length; i ++ ) {\n\n\t\t\tconst object = this.children[ i ];\n\n\t\t\tobject.parent = null;\n\n\t\t\tobject.dispatchEvent( _removedEvent );\n\n\t\t}\n\n\t\tthis.children.length = 0;\n\n\t\treturn this;\n\n\n\t}\n\n\tattach( object ) {\n\n\t\t// adds object as a child of this, while maintaining the object's world transform\n\n\t\t// Note: This method does not support scene graphs having non-uniformly-scaled nodes(s)\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\t_m1$1.copy( this.matrixWorld ).invert();\n\n\t\tif ( object.parent !== null ) {\n\n\t\t\tobject.parent.updateWorldMatrix( true, false );\n\n\t\t\t_m1$1.multiply( object.parent.matrixWorld );\n\n\t\t}\n\n\t\tobject.applyMatrix4( _m1$1 );\n\n\t\tthis.add( object );\n\n\t\tobject.updateWorldMatrix( false, true );\n\n\t\treturn this;\n\n\t}\n\n\tgetObjectById( id ) {\n\n\t\treturn this.getObjectByProperty( 'id', id );\n\n\t}\n\n\tgetObjectByName( name ) {\n\n\t\treturn this.getObjectByProperty( 'name', name );\n\n\t}\n\n\tgetObjectByProperty( name, value ) {\n\n\t\tif ( this[ name ] === value ) return this;\n\n\t\tfor ( let i = 0, l = this.children.length; i < l; i ++ ) {\n\n\t\t\tconst child = this.children[ i ];\n\t\t\tconst object = child.getObjectByProperty( name, value );\n\n\t\t\tif ( object !== undefined ) {\n\n\t\t\t\treturn object;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn undefined;\n\n\t}\n\n\tgetWorldPosition( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\treturn target.setFromMatrixPosition( this.matrixWorld );\n\n\t}\n\n\tgetWorldQuaternion( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tthis.matrixWorld.decompose( _position$3, target, _scale$2 );\n\n\t\treturn target;\n\n\t}\n\n\tgetWorldScale( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tthis.matrixWorld.decompose( _position$3, _quaternion$2, target );\n\n\t\treturn target;\n\n\t}\n\n\tgetWorldDirection( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tconst e = this.matrixWorld.elements;\n\n\t\treturn target.set( e[ 8 ], e[ 9 ], e[ 10 ] ).normalize();\n\n\t}\n\n\traycast( /* raycaster, intersects */ ) {}\n\n\ttraverse( callback ) {\n\n\t\tcallback( this );\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].traverse( callback );\n\n\t\t}\n\n\t}\n\n\ttraverseVisible( callback ) {\n\n\t\tif ( this.visible === false ) return;\n\n\t\tcallback( this );\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].traverseVisible( callback );\n\n\t\t}\n\n\t}\n\n\ttraverseAncestors( callback ) {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( parent !== null ) {\n\n\t\t\tcallback( parent );\n\n\t\t\tparent.traverseAncestors( callback );\n\n\t\t}\n\n\t}\n\n\tupdateMatrix() {\n\n\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\n\n\t\tthis.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tif ( this.matrixWorldNeedsUpdate || force ) {\n\n\t\t\tif ( this.parent === null ) {\n\n\t\t\t\tthis.matrixWorld.copy( this.matrix );\n\n\t\t\t} else {\n\n\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\n\n\t\t\t}\n\n\t\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\t\tforce = true;\n\n\t\t}\n\n\t\t// update children\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].updateMatrixWorld( force );\n\n\t\t}\n\n\t}\n\n\tupdateWorldMatrix( updateParents, updateChildren ) {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( updateParents === true && parent !== null ) {\n\n\t\t\tparent.updateWorldMatrix( true, false );\n\n\t\t}\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tif ( this.parent === null ) {\n\n\t\t\tthis.matrixWorld.copy( this.matrix );\n\n\t\t} else {\n\n\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\n\n\t\t}\n\n\t\t// update children\n\n\t\tif ( updateChildren === true ) {\n\n\t\t\tconst children = this.children;\n\n\t\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tchildren[ i ].updateWorldMatrix( false, true );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\t// meta is a string when called from JSON.stringify\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tconst output = {};\n\n\t\t// meta is a hash used to collect geometries, materials.\n\t\t// not providing it implies that this is the root object\n\t\t// being serialized.\n\t\tif ( isRootObject ) {\n\n\t\t\t// initialize meta obj\n\t\t\tmeta = {\n\t\t\t\tgeometries: {},\n\t\t\t\tmaterials: {},\n\t\t\t\ttextures: {},\n\t\t\t\timages: {},\n\t\t\t\tshapes: {},\n\t\t\t\tskeletons: {},\n\t\t\t\tanimations: {}\n\t\t\t};\n\n\t\t\toutput.metadata = {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Object',\n\t\t\t\tgenerator: 'Object3D.toJSON'\n\t\t\t};\n\n\t\t}\n\n\t\t// standard Object3D serialization\n\n\t\tconst object = {};\n\n\t\tobject.uuid = this.uuid;\n\t\tobject.type = this.type;\n\n\t\tif ( this.name !== '' ) object.name = this.name;\n\t\tif ( this.castShadow === true ) object.castShadow = true;\n\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\n\t\tif ( this.visible === false ) object.visible = false;\n\t\tif ( this.frustumCulled === false ) object.frustumCulled = false;\n\t\tif ( this.renderOrder !== 0 ) object.renderOrder = this.renderOrder;\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) object.userData = this.userData;\n\n\t\tobject.layers = this.layers.mask;\n\t\tobject.matrix = this.matrix.toArray();\n\n\t\tif ( this.matrixAutoUpdate === false ) object.matrixAutoUpdate = false;\n\n\t\t// object specific properties\n\n\t\tif ( this.isInstancedMesh ) {\n\n\t\t\tobject.type = 'InstancedMesh';\n\t\t\tobject.count = this.count;\n\t\t\tobject.instanceMatrix = this.instanceMatrix.toJSON();\n\t\t\tif ( this.instanceColor !== null ) object.instanceColor = this.instanceColor.toJSON();\n\n\t\t}\n\n\t\t//\n\n\t\tfunction serialize( library, element ) {\n\n\t\t\tif ( library[ element.uuid ] === undefined ) {\n\n\t\t\t\tlibrary[ element.uuid ] = element.toJSON( meta );\n\n\t\t\t}\n\n\t\t\treturn element.uuid;\n\n\t\t}\n\n\t\tif ( this.isScene ) {\n\n\t\t\tif ( this.background ) {\n\n\t\t\t\tif ( this.background.isColor ) {\n\n\t\t\t\t\tobject.background = this.background.toJSON();\n\n\t\t\t\t} else if ( this.background.isTexture ) {\n\n\t\t\t\t\tobject.background = this.background.toJSON( meta ).uuid;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.environment && this.environment.isTexture ) {\n\n\t\t\t\tobject.environment = this.environment.toJSON( meta ).uuid;\n\n\t\t\t}\n\n\t\t} else if ( this.isMesh || this.isLine || this.isPoints ) {\n\n\t\t\tobject.geometry = serialize( meta.geometries, this.geometry );\n\n\t\t\tconst parameters = this.geometry.parameters;\n\n\t\t\tif ( parameters !== undefined && parameters.shapes !== undefined ) {\n\n\t\t\t\tconst shapes = parameters.shapes;\n\n\t\t\t\tif ( Array.isArray( shapes ) ) {\n\n\t\t\t\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\t\t\t\tconst shape = shapes[ i ];\n\n\t\t\t\t\t\tserialize( meta.shapes, shape );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tserialize( meta.shapes, shapes );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.isSkinnedMesh ) {\n\n\t\t\tobject.bindMode = this.bindMode;\n\t\t\tobject.bindMatrix = this.bindMatrix.toArray();\n\n\t\t\tif ( this.skeleton !== undefined ) {\n\n\t\t\t\tserialize( meta.skeletons, this.skeleton );\n\n\t\t\t\tobject.skeleton = this.skeleton.uuid;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.material !== undefined ) {\n\n\t\t\tif ( Array.isArray( this.material ) ) {\n\n\t\t\t\tconst uuids = [];\n\n\t\t\t\tfor ( let i = 0, l = this.material.length; i < l; i ++ ) {\n\n\t\t\t\t\tuuids.push( serialize( meta.materials, this.material[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t\tobject.material = uuids;\n\n\t\t\t} else {\n\n\t\t\t\tobject.material = serialize( meta.materials, this.material );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.children.length > 0 ) {\n\n\t\t\tobject.children = [];\n\n\t\t\tfor ( let i = 0; i < this.children.length; i ++ ) {\n\n\t\t\t\tobject.children.push( this.children[ i ].toJSON( meta ).object );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.animations.length > 0 ) {\n\n\t\t\tobject.animations = [];\n\n\t\t\tfor ( let i = 0; i < this.animations.length; i ++ ) {\n\n\t\t\t\tconst animation = this.animations[ i ];\n\n\t\t\t\tobject.animations.push( serialize( meta.animations, animation ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( isRootObject ) {\n\n\t\t\tconst geometries = extractFromCache( meta.geometries );\n\t\t\tconst materials = extractFromCache( meta.materials );\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\t\t\tconst shapes = extractFromCache( meta.shapes );\n\t\t\tconst skeletons = extractFromCache( meta.skeletons );\n\t\t\tconst animations = extractFromCache( meta.animations );\n\n\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\n\t\t\tif ( materials.length > 0 ) output.materials = materials;\n\t\t\tif ( textures.length > 0 ) output.textures = textures;\n\t\t\tif ( images.length > 0 ) output.images = images;\n\t\t\tif ( shapes.length > 0 ) output.shapes = shapes;\n\t\t\tif ( skeletons.length > 0 ) output.skeletons = skeletons;\n\t\t\tif ( animations.length > 0 ) output.animations = animations;\n\n\t\t}\n\n\t\toutput.object = object;\n\n\t\treturn output;\n\n\t\t// extract data from the cache hash\n\t\t// remove metadata on each item\n\t\t// and return as array\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t}\n\n\tclone( recursive ) {\n\n\t\treturn new this.constructor().copy( this, recursive );\n\n\t}\n\n\tcopy( source, recursive = true ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.up.copy( source.up );\n\n\t\tthis.position.copy( source.position );\n\t\tthis.rotation.order = source.rotation.order;\n\t\tthis.quaternion.copy( source.quaternion );\n\t\tthis.scale.copy( source.scale );\n\n\t\tthis.matrix.copy( source.matrix );\n\t\tthis.matrixWorld.copy( source.matrixWorld );\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\t\tthis.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\n\n\t\tthis.layers.mask = source.layers.mask;\n\t\tthis.visible = source.visible;\n\n\t\tthis.castShadow = source.castShadow;\n\t\tthis.receiveShadow = source.receiveShadow;\n\n\t\tthis.frustumCulled = source.frustumCulled;\n\t\tthis.renderOrder = source.renderOrder;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\tif ( recursive === true ) {\n\n\t\t\tfor ( let i = 0; i < source.children.length; i ++ ) {\n\n\t\t\t\tconst child = source.children[ i ];\n\t\t\t\tthis.add( child.clone() );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nObject3D.DefaultUp = new Vector3( 0, 1, 0 );\nObject3D.DefaultMatrixAutoUpdate = true;\n\nObject3D.prototype.isObject3D = true;\n\nconst _v0$1 = /*@__PURE__*/ new Vector3();\nconst _v1$3 = /*@__PURE__*/ new Vector3();\nconst _v2$2 = /*@__PURE__*/ new Vector3();\nconst _v3$1 = /*@__PURE__*/ new Vector3();\n\nconst _vab = /*@__PURE__*/ new Vector3();\nconst _vac = /*@__PURE__*/ new Vector3();\nconst _vbc = /*@__PURE__*/ new Vector3();\nconst _vap = /*@__PURE__*/ new Vector3();\nconst _vbp = /*@__PURE__*/ new Vector3();\nconst _vcp = /*@__PURE__*/ new Vector3();\n\nclass Triangle {\n\n\tconstructor( a = new Vector3(), b = new Vector3(), c = new Vector3() ) {\n\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.c = c;\n\n\t}\n\n\tstatic getNormal( a, b, c, target ) {\n\n\t\ttarget.subVectors( c, b );\n\t\t_v0$1.subVectors( a, b );\n\t\ttarget.cross( _v0$1 );\n\n\t\tconst targetLengthSq = target.lengthSq();\n\t\tif ( targetLengthSq > 0 ) {\n\n\t\t\treturn target.multiplyScalar( 1 / Math.sqrt( targetLengthSq ) );\n\n\t\t}\n\n\t\treturn target.set( 0, 0, 0 );\n\n\t}\n\n\t// static/instance method to calculate barycentric coordinates\n\t// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\n\tstatic getBarycoord( point, a, b, c, target ) {\n\n\t\t_v0$1.subVectors( c, a );\n\t\t_v1$3.subVectors( b, a );\n\t\t_v2$2.subVectors( point, a );\n\n\t\tconst dot00 = _v0$1.dot( _v0$1 );\n\t\tconst dot01 = _v0$1.dot( _v1$3 );\n\t\tconst dot02 = _v0$1.dot( _v2$2 );\n\t\tconst dot11 = _v1$3.dot( _v1$3 );\n\t\tconst dot12 = _v1$3.dot( _v2$2 );\n\n\t\tconst denom = ( dot00 * dot11 - dot01 * dot01 );\n\n\t\t// collinear or singular triangle\n\t\tif ( denom === 0 ) {\n\n\t\t\t// arbitrary location outside of triangle?\n\t\t\t// not sure if this is the best idea, maybe should be returning undefined\n\t\t\treturn target.set( - 2, - 1, - 1 );\n\n\t\t}\n\n\t\tconst invDenom = 1 / denom;\n\t\tconst u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\n\t\tconst v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\n\n\t\t// barycentric coordinates must always sum to 1\n\t\treturn target.set( 1 - u - v, v, u );\n\n\t}\n\n\tstatic containsPoint( point, a, b, c ) {\n\n\t\tthis.getBarycoord( point, a, b, c, _v3$1 );\n\n\t\treturn ( _v3$1.x >= 0 ) && ( _v3$1.y >= 0 ) && ( ( _v3$1.x + _v3$1.y ) <= 1 );\n\n\t}\n\n\tstatic getUV( point, p1, p2, p3, uv1, uv2, uv3, target ) {\n\n\t\tthis.getBarycoord( point, p1, p2, p3, _v3$1 );\n\n\t\ttarget.set( 0, 0 );\n\t\ttarget.addScaledVector( uv1, _v3$1.x );\n\t\ttarget.addScaledVector( uv2, _v3$1.y );\n\t\ttarget.addScaledVector( uv3, _v3$1.z );\n\n\t\treturn target;\n\n\t}\n\n\tstatic isFrontFacing( a, b, c, direction ) {\n\n\t\t_v0$1.subVectors( c, b );\n\t\t_v1$3.subVectors( a, b );\n\n\t\t// strictly front facing\n\t\treturn ( _v0$1.cross( _v1$3 ).dot( direction ) < 0 ) ? true : false;\n\n\t}\n\n\tset( a, b, c ) {\n\n\t\tthis.a.copy( a );\n\t\tthis.b.copy( b );\n\t\tthis.c.copy( c );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPointsAndIndices( points, i0, i1, i2 ) {\n\n\t\tthis.a.copy( points[ i0 ] );\n\t\tthis.b.copy( points[ i1 ] );\n\t\tthis.c.copy( points[ i2 ] );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromAttributeAndIndices( attribute, i0, i1, i2 ) {\n\n\t\tthis.a.fromBufferAttribute( attribute, i0 );\n\t\tthis.b.fromBufferAttribute( attribute, i1 );\n\t\tthis.c.fromBufferAttribute( attribute, i2 );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( triangle ) {\n\n\t\tthis.a.copy( triangle.a );\n\t\tthis.b.copy( triangle.b );\n\t\tthis.c.copy( triangle.c );\n\n\t\treturn this;\n\n\t}\n\n\tgetArea() {\n\n\t\t_v0$1.subVectors( this.c, this.b );\n\t\t_v1$3.subVectors( this.a, this.b );\n\n\t\treturn _v0$1.cross( _v1$3 ).length() * 0.5;\n\n\t}\n\n\tgetMidpoint( target ) {\n\n\t\treturn target.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\n\n\t}\n\n\tgetNormal( target ) {\n\n\t\treturn Triangle.getNormal( this.a, this.b, this.c, target );\n\n\t}\n\n\tgetPlane( target ) {\n\n\t\treturn target.setFromCoplanarPoints( this.a, this.b, this.c );\n\n\t}\n\n\tgetBarycoord( point, target ) {\n\n\t\treturn Triangle.getBarycoord( point, this.a, this.b, this.c, target );\n\n\t}\n\n\tgetUV( point, uv1, uv2, uv3, target ) {\n\n\t\treturn Triangle.getUV( point, this.a, this.b, this.c, uv1, uv2, uv3, target );\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn Triangle.containsPoint( point, this.a, this.b, this.c );\n\n\t}\n\n\tisFrontFacing( direction ) {\n\n\t\treturn Triangle.isFrontFacing( this.a, this.b, this.c, direction );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsTriangle( this );\n\n\t}\n\n\tclosestPointToPoint( p, target ) {\n\n\t\tconst a = this.a, b = this.b, c = this.c;\n\t\tlet v, w;\n\n\t\t// algorithm thanks to Real-Time Collision Detection by Christer Ericson,\n\t\t// published by Morgan Kaufmann Publishers, (c) 2005 Elsevier Inc.,\n\t\t// under the accompanying license; see chapter 5.1.5 for detailed explanation.\n\t\t// basically, we're distinguishing which of the voronoi regions of the triangle\n\t\t// the point lies in with the minimum amount of redundant computation.\n\n\t\t_vab.subVectors( b, a );\n\t\t_vac.subVectors( c, a );\n\t\t_vap.subVectors( p, a );\n\t\tconst d1 = _vab.dot( _vap );\n\t\tconst d2 = _vac.dot( _vap );\n\t\tif ( d1 <= 0 && d2 <= 0 ) {\n\n\t\t\t// vertex region of A; barycentric coords (1, 0, 0)\n\t\t\treturn target.copy( a );\n\n\t\t}\n\n\t\t_vbp.subVectors( p, b );\n\t\tconst d3 = _vab.dot( _vbp );\n\t\tconst d4 = _vac.dot( _vbp );\n\t\tif ( d3 >= 0 && d4 <= d3 ) {\n\n\t\t\t// vertex region of B; barycentric coords (0, 1, 0)\n\t\t\treturn target.copy( b );\n\n\t\t}\n\n\t\tconst vc = d1 * d4 - d3 * d2;\n\t\tif ( vc <= 0 && d1 >= 0 && d3 <= 0 ) {\n\n\t\t\tv = d1 / ( d1 - d3 );\n\t\t\t// edge region of AB; barycentric coords (1-v, v, 0)\n\t\t\treturn target.copy( a ).addScaledVector( _vab, v );\n\n\t\t}\n\n\t\t_vcp.subVectors( p, c );\n\t\tconst d5 = _vab.dot( _vcp );\n\t\tconst d6 = _vac.dot( _vcp );\n\t\tif ( d6 >= 0 && d5 <= d6 ) {\n\n\t\t\t// vertex region of C; barycentric coords (0, 0, 1)\n\t\t\treturn target.copy( c );\n\n\t\t}\n\n\t\tconst vb = d5 * d2 - d1 * d6;\n\t\tif ( vb <= 0 && d2 >= 0 && d6 <= 0 ) {\n\n\t\t\tw = d2 / ( d2 - d6 );\n\t\t\t// edge region of AC; barycentric coords (1-w, 0, w)\n\t\t\treturn target.copy( a ).addScaledVector( _vac, w );\n\n\t\t}\n\n\t\tconst va = d3 * d6 - d5 * d4;\n\t\tif ( va <= 0 && ( d4 - d3 ) >= 0 && ( d5 - d6 ) >= 0 ) {\n\n\t\t\t_vbc.subVectors( c, b );\n\t\t\tw = ( d4 - d3 ) / ( ( d4 - d3 ) + ( d5 - d6 ) );\n\t\t\t// edge region of BC; barycentric coords (0, 1-w, w)\n\t\t\treturn target.copy( b ).addScaledVector( _vbc, w ); // edge region of BC\n\n\t\t}\n\n\t\t// face region\n\t\tconst denom = 1 / ( va + vb + vc );\n\t\t// u = va * denom\n\t\tv = vb * denom;\n\t\tw = vc * denom;\n\n\t\treturn target.copy( a ).addScaledVector( _vab, v ).addScaledVector( _vac, w );\n\n\t}\n\n\tequals( triangle ) {\n\n\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\n\n\t}\n\n}\n\nlet materialId = 0;\n\nclass Material extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tObject.defineProperty( this, 'id', { value: materialId ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Material';\n\n\t\tthis.fog = true;\n\n\t\tthis.blending = NormalBlending;\n\t\tthis.side = FrontSide;\n\t\tthis.vertexColors = false;\n\n\t\tthis.opacity = 1;\n\t\tthis.transparent = false;\n\n\t\tthis.blendSrc = SrcAlphaFactor;\n\t\tthis.blendDst = OneMinusSrcAlphaFactor;\n\t\tthis.blendEquation = AddEquation;\n\t\tthis.blendSrcAlpha = null;\n\t\tthis.blendDstAlpha = null;\n\t\tthis.blendEquationAlpha = null;\n\n\t\tthis.depthFunc = LessEqualDepth;\n\t\tthis.depthTest = true;\n\t\tthis.depthWrite = true;\n\n\t\tthis.stencilWriteMask = 0xff;\n\t\tthis.stencilFunc = AlwaysStencilFunc;\n\t\tthis.stencilRef = 0;\n\t\tthis.stencilFuncMask = 0xff;\n\t\tthis.stencilFail = KeepStencilOp;\n\t\tthis.stencilZFail = KeepStencilOp;\n\t\tthis.stencilZPass = KeepStencilOp;\n\t\tthis.stencilWrite = false;\n\n\t\tthis.clippingPlanes = null;\n\t\tthis.clipIntersection = false;\n\t\tthis.clipShadows = false;\n\n\t\tthis.shadowSide = null;\n\n\t\tthis.colorWrite = true;\n\n\t\tthis.precision = null; // override the renderer's default precision for this material\n\n\t\tthis.polygonOffset = false;\n\t\tthis.polygonOffsetFactor = 0;\n\t\tthis.polygonOffsetUnits = 0;\n\n\t\tthis.dithering = false;\n\n\t\tthis.alphaToCoverage = false;\n\t\tthis.premultipliedAlpha = false;\n\n\t\tthis.visible = true;\n\n\t\tthis.toneMapped = true;\n\n\t\tthis.userData = {};\n\n\t\tthis.version = 0;\n\n\t\tthis._alphaTest = 0;\n\n\t}\n\n\tget alphaTest() {\n\n\t\treturn this._alphaTest;\n\n\t}\n\n\tset alphaTest( value ) {\n\n\t\tif ( this._alphaTest > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._alphaTest = value;\n\n\t}\n\n\tonBuild( /* shaderobject, renderer */ ) {}\n\n\tonBeforeRender( /* renderer, scene, camera, geometry, object, group */ ) {}\n\n\tonBeforeCompile( /* shaderobject, renderer */ ) {}\n\n\tcustomProgramCacheKey() {\n\n\t\treturn this.onBeforeCompile.toString();\n\n\t}\n\n\tsetValues( values ) {\n\n\t\tif ( values === undefined ) return;\n\n\t\tfor ( const key in values ) {\n\n\t\t\tconst newValue = values[ key ];\n\n\t\t\tif ( newValue === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Material: \\'' + key + '\\' parameter is undefined.' );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\t// for backward compatability if shading is set in the constructor\n\t\t\tif ( key === 'shading' ) {\n\n\t\t\t\tconsole.warn( 'THREE.' + this.type + ': .shading has been removed. Use the boolean .flatShading instead.' );\n\t\t\t\tthis.flatShading = ( newValue === FlatShading ) ? true : false;\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tconst currentValue = this[ key ];\n\n\t\t\tif ( currentValue === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.' + this.type + ': \\'' + key + '\\' is not a property of this material.' );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tif ( currentValue && currentValue.isColor ) {\n\n\t\t\t\tcurrentValue.set( newValue );\n\n\t\t\t} else if ( ( currentValue && currentValue.isVector3 ) && ( newValue && newValue.isVector3 ) ) {\n\n\t\t\t\tcurrentValue.copy( newValue );\n\n\t\t\t} else {\n\n\t\t\t\tthis[ key ] = newValue;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRoot = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( isRoot ) {\n\n\t\t\tmeta = {\n\t\t\t\ttextures: {},\n\t\t\t\timages: {}\n\t\t\t};\n\n\t\t}\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Material',\n\t\t\t\tgenerator: 'Material.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard Material serialization\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\n\t\tif ( this.name !== '' ) data.name = this.name;\n\n\t\tif ( this.color && this.color.isColor ) data.color = this.color.getHex();\n\n\t\tif ( this.roughness !== undefined ) data.roughness = this.roughness;\n\t\tif ( this.metalness !== undefined ) data.metalness = this.metalness;\n\n\t\tif ( this.sheen !== undefined ) data.sheen = this.sheen;\n\t\tif ( this.sheenColor && this.sheenColor.isColor ) data.sheenColor = this.sheenColor.getHex();\n\t\tif ( this.sheenRoughness !== undefined ) data.sheenRoughness = this.sheenRoughness;\n\t\tif ( this.emissive && this.emissive.isColor ) data.emissive = this.emissive.getHex();\n\t\tif ( this.emissiveIntensity && this.emissiveIntensity !== 1 ) data.emissiveIntensity = this.emissiveIntensity;\n\n\t\tif ( this.specular && this.specular.isColor ) data.specular = this.specular.getHex();\n\t\tif ( this.specularIntensity !== undefined ) data.specularIntensity = this.specularIntensity;\n\t\tif ( this.specularColor && this.specularColor.isColor ) data.specularColor = this.specularColor.getHex();\n\t\tif ( this.shininess !== undefined ) data.shininess = this.shininess;\n\t\tif ( this.clearcoat !== undefined ) data.clearcoat = this.clearcoat;\n\t\tif ( this.clearcoatRoughness !== undefined ) data.clearcoatRoughness = this.clearcoatRoughness;\n\n\t\tif ( this.clearcoatMap && this.clearcoatMap.isTexture ) {\n\n\t\t\tdata.clearcoatMap = this.clearcoatMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.clearcoatRoughnessMap && this.clearcoatRoughnessMap.isTexture ) {\n\n\t\t\tdata.clearcoatRoughnessMap = this.clearcoatRoughnessMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.clearcoatNormalMap && this.clearcoatNormalMap.isTexture ) {\n\n\t\t\tdata.clearcoatNormalMap = this.clearcoatNormalMap.toJSON( meta ).uuid;\n\t\t\tdata.clearcoatNormalScale = this.clearcoatNormalScale.toArray();\n\n\t\t}\n\n\t\tif ( this.map && this.map.isTexture ) data.map = this.map.toJSON( meta ).uuid;\n\t\tif ( this.matcap && this.matcap.isTexture ) data.matcap = this.matcap.toJSON( meta ).uuid;\n\t\tif ( this.alphaMap && this.alphaMap.isTexture ) data.alphaMap = this.alphaMap.toJSON( meta ).uuid;\n\n\t\tif ( this.lightMap && this.lightMap.isTexture ) {\n\n\t\t\tdata.lightMap = this.lightMap.toJSON( meta ).uuid;\n\t\t\tdata.lightMapIntensity = this.lightMapIntensity;\n\n\t\t}\n\n\t\tif ( this.aoMap && this.aoMap.isTexture ) {\n\n\t\t\tdata.aoMap = this.aoMap.toJSON( meta ).uuid;\n\t\t\tdata.aoMapIntensity = this.aoMapIntensity;\n\n\t\t}\n\n\t\tif ( this.bumpMap && this.bumpMap.isTexture ) {\n\n\t\t\tdata.bumpMap = this.bumpMap.toJSON( meta ).uuid;\n\t\t\tdata.bumpScale = this.bumpScale;\n\n\t\t}\n\n\t\tif ( this.normalMap && this.normalMap.isTexture ) {\n\n\t\t\tdata.normalMap = this.normalMap.toJSON( meta ).uuid;\n\t\t\tdata.normalMapType = this.normalMapType;\n\t\t\tdata.normalScale = this.normalScale.toArray();\n\n\t\t}\n\n\t\tif ( this.displacementMap && this.displacementMap.isTexture ) {\n\n\t\t\tdata.displacementMap = this.displacementMap.toJSON( meta ).uuid;\n\t\t\tdata.displacementScale = this.displacementScale;\n\t\t\tdata.displacementBias = this.displacementBias;\n\n\t\t}\n\n\t\tif ( this.roughnessMap && this.roughnessMap.isTexture ) data.roughnessMap = this.roughnessMap.toJSON( meta ).uuid;\n\t\tif ( this.metalnessMap && this.metalnessMap.isTexture ) data.metalnessMap = this.metalnessMap.toJSON( meta ).uuid;\n\n\t\tif ( this.emissiveMap && this.emissiveMap.isTexture ) data.emissiveMap = this.emissiveMap.toJSON( meta ).uuid;\n\t\tif ( this.specularMap && this.specularMap.isTexture ) data.specularMap = this.specularMap.toJSON( meta ).uuid;\n\t\tif ( this.specularIntensityMap && this.specularIntensityMap.isTexture ) data.specularIntensityMap = this.specularIntensityMap.toJSON( meta ).uuid;\n\t\tif ( this.specularColorMap && this.specularColorMap.isTexture ) data.specularColorMap = this.specularColorMap.toJSON( meta ).uuid;\n\n\t\tif ( this.envMap && this.envMap.isTexture ) {\n\n\t\t\tdata.envMap = this.envMap.toJSON( meta ).uuid;\n\n\t\t\tif ( this.combine !== undefined ) data.combine = this.combine;\n\n\t\t}\n\n\t\tif ( this.envMapIntensity !== undefined ) data.envMapIntensity = this.envMapIntensity;\n\t\tif ( this.reflectivity !== undefined ) data.reflectivity = this.reflectivity;\n\t\tif ( this.refractionRatio !== undefined ) data.refractionRatio = this.refractionRatio;\n\n\t\tif ( this.gradientMap && this.gradientMap.isTexture ) {\n\n\t\t\tdata.gradientMap = this.gradientMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.transmission !== undefined ) data.transmission = this.transmission;\n\t\tif ( this.transmissionMap && this.transmissionMap.isTexture ) data.transmissionMap = this.transmissionMap.toJSON( meta ).uuid;\n\t\tif ( this.thickness !== undefined ) data.thickness = this.thickness;\n\t\tif ( this.thicknessMap && this.thicknessMap.isTexture ) data.thicknessMap = this.thicknessMap.toJSON( meta ).uuid;\n\t\tif ( this.attenuationDistance !== undefined ) data.attenuationDistance = this.attenuationDistance;\n\t\tif ( this.attenuationColor !== undefined ) data.attenuationColor = this.attenuationColor.getHex();\n\n\t\tif ( this.size !== undefined ) data.size = this.size;\n\t\tif ( this.shadowSide !== null ) data.shadowSide = this.shadowSide;\n\t\tif ( this.sizeAttenuation !== undefined ) data.sizeAttenuation = this.sizeAttenuation;\n\n\t\tif ( this.blending !== NormalBlending ) data.blending = this.blending;\n\t\tif ( this.side !== FrontSide ) data.side = this.side;\n\t\tif ( this.vertexColors ) data.vertexColors = true;\n\n\t\tif ( this.opacity < 1 ) data.opacity = this.opacity;\n\t\tif ( this.transparent === true ) data.transparent = this.transparent;\n\n\t\tdata.depthFunc = this.depthFunc;\n\t\tdata.depthTest = this.depthTest;\n\t\tdata.depthWrite = this.depthWrite;\n\t\tdata.colorWrite = this.colorWrite;\n\n\t\tdata.stencilWrite = this.stencilWrite;\n\t\tdata.stencilWriteMask = this.stencilWriteMask;\n\t\tdata.stencilFunc = this.stencilFunc;\n\t\tdata.stencilRef = this.stencilRef;\n\t\tdata.stencilFuncMask = this.stencilFuncMask;\n\t\tdata.stencilFail = this.stencilFail;\n\t\tdata.stencilZFail = this.stencilZFail;\n\t\tdata.stencilZPass = this.stencilZPass;\n\n\t\t// rotation (SpriteMaterial)\n\t\tif ( this.rotation && this.rotation !== 0 ) data.rotation = this.rotation;\n\n\t\tif ( this.polygonOffset === true ) data.polygonOffset = true;\n\t\tif ( this.polygonOffsetFactor !== 0 ) data.polygonOffsetFactor = this.polygonOffsetFactor;\n\t\tif ( this.polygonOffsetUnits !== 0 ) data.polygonOffsetUnits = this.polygonOffsetUnits;\n\n\t\tif ( this.linewidth && this.linewidth !== 1 ) data.linewidth = this.linewidth;\n\t\tif ( this.dashSize !== undefined ) data.dashSize = this.dashSize;\n\t\tif ( this.gapSize !== undefined ) data.gapSize = this.gapSize;\n\t\tif ( this.scale !== undefined ) data.scale = this.scale;\n\n\t\tif ( this.dithering === true ) data.dithering = true;\n\n\t\tif ( this.alphaTest > 0 ) data.alphaTest = this.alphaTest;\n\t\tif ( this.alphaToCoverage === true ) data.alphaToCoverage = this.alphaToCoverage;\n\t\tif ( this.premultipliedAlpha === true ) data.premultipliedAlpha = this.premultipliedAlpha;\n\n\t\tif ( this.wireframe === true ) data.wireframe = this.wireframe;\n\t\tif ( this.wireframeLinewidth > 1 ) data.wireframeLinewidth = this.wireframeLinewidth;\n\t\tif ( this.wireframeLinecap !== 'round' ) data.wireframeLinecap = this.wireframeLinecap;\n\t\tif ( this.wireframeLinejoin !== 'round' ) data.wireframeLinejoin = this.wireframeLinejoin;\n\n\t\tif ( this.flatShading === true ) data.flatShading = this.flatShading;\n\n\t\tif ( this.visible === false ) data.visible = false;\n\n\t\tif ( this.toneMapped === false ) data.toneMapped = false;\n\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) data.userData = this.userData;\n\n\t\t// TODO: Copied from Object3D.toJSON\n\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t\tif ( isRoot ) {\n\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\n\t\t\tif ( textures.length > 0 ) data.textures = textures;\n\t\t\tif ( images.length > 0 ) data.images = images;\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.fog = source.fog;\n\n\t\tthis.blending = source.blending;\n\t\tthis.side = source.side;\n\t\tthis.vertexColors = source.vertexColors;\n\n\t\tthis.opacity = source.opacity;\n\t\tthis.transparent = source.transparent;\n\n\t\tthis.blendSrc = source.blendSrc;\n\t\tthis.blendDst = source.blendDst;\n\t\tthis.blendEquation = source.blendEquation;\n\t\tthis.blendSrcAlpha = source.blendSrcAlpha;\n\t\tthis.blendDstAlpha = source.blendDstAlpha;\n\t\tthis.blendEquationAlpha = source.blendEquationAlpha;\n\n\t\tthis.depthFunc = source.depthFunc;\n\t\tthis.depthTest = source.depthTest;\n\t\tthis.depthWrite = source.depthWrite;\n\n\t\tthis.stencilWriteMask = source.stencilWriteMask;\n\t\tthis.stencilFunc = source.stencilFunc;\n\t\tthis.stencilRef = source.stencilRef;\n\t\tthis.stencilFuncMask = source.stencilFuncMask;\n\t\tthis.stencilFail = source.stencilFail;\n\t\tthis.stencilZFail = source.stencilZFail;\n\t\tthis.stencilZPass = source.stencilZPass;\n\t\tthis.stencilWrite = source.stencilWrite;\n\n\t\tconst srcPlanes = source.clippingPlanes;\n\t\tlet dstPlanes = null;\n\n\t\tif ( srcPlanes !== null ) {\n\n\t\t\tconst n = srcPlanes.length;\n\t\t\tdstPlanes = new Array( n );\n\n\t\t\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\t\t\tdstPlanes[ i ] = srcPlanes[ i ].clone();\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.clippingPlanes = dstPlanes;\n\t\tthis.clipIntersection = source.clipIntersection;\n\t\tthis.clipShadows = source.clipShadows;\n\n\t\tthis.shadowSide = source.shadowSide;\n\n\t\tthis.colorWrite = source.colorWrite;\n\n\t\tthis.precision = source.precision;\n\n\t\tthis.polygonOffset = source.polygonOffset;\n\t\tthis.polygonOffsetFactor = source.polygonOffsetFactor;\n\t\tthis.polygonOffsetUnits = source.polygonOffsetUnits;\n\n\t\tthis.dithering = source.dithering;\n\n\t\tthis.alphaTest = source.alphaTest;\n\t\tthis.alphaToCoverage = source.alphaToCoverage;\n\t\tthis.premultipliedAlpha = source.premultipliedAlpha;\n\n\t\tthis.visible = source.visible;\n\n\t\tthis.toneMapped = source.toneMapped;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n}\n\nMaterial.prototype.isMaterial = true;\n\n/**\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *  map: new THREE.Texture( <Image> ),\n *\n *  lightMap: new THREE.Texture( <Image> ),\n *  lightMapIntensity: <float>\n *\n *  aoMap: new THREE.Texture( <Image> ),\n *  aoMapIntensity: <float>\n *\n *  specularMap: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\n *  combine: THREE.Multiply,\n *  reflectivity: <float>,\n *  refractionRatio: <float>,\n *\n *  depthTest: <bool>,\n *  depthWrite: <bool>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n * }\n */\n\nclass MeshBasicMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshBasicMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // emissive\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshBasicMaterial.prototype.isMeshBasicMaterial = true;\n\nconst _vector$9 = /*@__PURE__*/ new Vector3();\nconst _vector2$1 = /*@__PURE__*/ new Vector2();\n\nclass BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tif ( Array.isArray( array ) ) {\n\n\t\t\tthrow new TypeError( 'THREE.BufferAttribute: array should be a Typed Array.' );\n\n\t\t}\n\n\t\tthis.name = '';\n\n\t\tthis.array = array;\n\t\tthis.itemSize = itemSize;\n\t\tthis.count = array !== undefined ? array.length / itemSize : 0;\n\t\tthis.normalized = normalized === true;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.updateRange = { offset: 0, count: - 1 };\n\n\t\tthis.version = 0;\n\n\t}\n\n\tonUploadCallback() {}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.itemSize = source.itemSize;\n\t\tthis.count = source.count;\n\t\tthis.normalized = source.normalized;\n\n\t\tthis.usage = source.usage;\n\n\t\treturn this;\n\n\t}\n\n\tcopyAt( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.itemSize;\n\t\tindex2 *= attribute.itemSize;\n\n\t\tfor ( let i = 0, l = this.itemSize; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyArray( array ) {\n\n\t\tthis.array.set( array );\n\n\t\treturn this;\n\n\t}\n\n\tcopyColorsArray( colors ) {\n\n\t\tconst array = this.array;\n\t\tlet offset = 0;\n\n\t\tfor ( let i = 0, l = colors.length; i < l; i ++ ) {\n\n\t\t\tlet color = colors[ i ];\n\n\t\t\tif ( color === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyColorsArray(): color is undefined', i );\n\t\t\t\tcolor = new Color();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = color.r;\n\t\t\tarray[ offset ++ ] = color.g;\n\t\t\tarray[ offset ++ ] = color.b;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyVector2sArray( vectors ) {\n\n\t\tconst array = this.array;\n\t\tlet offset = 0;\n\n\t\tfor ( let i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\tlet vector = vectors[ i ];\n\n\t\t\tif ( vector === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector2sArray(): vector is undefined', i );\n\t\t\t\tvector = new Vector2();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\tarray[ offset ++ ] = vector.y;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyVector3sArray( vectors ) {\n\n\t\tconst array = this.array;\n\t\tlet offset = 0;\n\n\t\tfor ( let i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\tlet vector = vectors[ i ];\n\n\t\t\tif ( vector === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector3sArray(): vector is undefined', i );\n\t\t\t\tvector = new Vector3();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\tarray[ offset ++ ] = vector.y;\n\t\t\tarray[ offset ++ ] = vector.z;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyVector4sArray( vectors ) {\n\n\t\tconst array = this.array;\n\t\tlet offset = 0;\n\n\t\tfor ( let i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\tlet vector = vectors[ i ];\n\n\t\t\tif ( vector === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector4sArray(): vector is undefined', i );\n\t\t\t\tvector = new Vector4();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\tarray[ offset ++ ] = vector.y;\n\t\t\tarray[ offset ++ ] = vector.z;\n\t\t\tarray[ offset ++ ] = vector.w;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tif ( this.itemSize === 2 ) {\n\n\t\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t\t_vector2$1.fromBufferAttribute( this, i );\n\t\t\t\t_vector2$1.applyMatrix3( m );\n\n\t\t\t\tthis.setXY( i, _vector2$1.x, _vector2$1.y );\n\n\t\t\t}\n\n\t\t} else if ( this.itemSize === 3 ) {\n\n\t\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t\t_vector$9.fromBufferAttribute( this, i );\n\t\t\t\t_vector$9.applyMatrix3( m );\n\n\t\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$9.x = this.getX( i );\n\t\t\t_vector$9.y = this.getY( i );\n\t\t\t_vector$9.z = this.getZ( i );\n\n\t\t\t_vector$9.applyMatrix4( m );\n\n\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$9.x = this.getX( i );\n\t\t\t_vector$9.y = this.getY( i );\n\t\t\t_vector$9.z = this.getZ( i );\n\n\t\t\t_vector$9.applyNormalMatrix( m );\n\n\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$9.x = this.getX( i );\n\t\t\t_vector$9.y = this.getY( i );\n\t\t\t_vector$9.z = this.getZ( i );\n\n\t\t\t_vector$9.transformDirection( m );\n\n\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tset( value, offset = 0 ) {\n\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t}\n\n\tgetX( index ) {\n\n\t\treturn this.array[ index * this.itemSize ];\n\n\t}\n\n\tsetX( index, x ) {\n\n\t\tthis.array[ index * this.itemSize ] = x;\n\n\t\treturn this;\n\n\t}\n\n\tgetY( index ) {\n\n\t\treturn this.array[ index * this.itemSize + 1 ];\n\n\t}\n\n\tsetY( index, y ) {\n\n\t\tthis.array[ index * this.itemSize + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tgetZ( index ) {\n\n\t\treturn this.array[ index * this.itemSize + 2 ];\n\n\t}\n\n\tsetZ( index, z ) {\n\n\t\tthis.array[ index * this.itemSize + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tgetW( index ) {\n\n\t\treturn this.array[ index * this.itemSize + 3 ];\n\n\t}\n\n\tsetW( index, w ) {\n\n\t\tthis.array[ index * this.itemSize + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetXY( index, x, y ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZ( index, x, y, z ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\t\tthis.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZW( index, x, y, z, w ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\t\tthis.array[ index + 2 ] = z;\n\t\tthis.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tonUpload( callback ) {\n\n\t\tthis.onUploadCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.array, this.itemSize ).copy( this );\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\titemSize: this.itemSize,\n\t\t\ttype: this.array.constructor.name,\n\t\t\tarray: Array.prototype.slice.call( this.array ),\n\t\t\tnormalized: this.normalized\n\t\t};\n\n\t\tif ( this.name !== '' ) data.name = this.name;\n\t\tif ( this.usage !== StaticDrawUsage ) data.usage = this.usage;\n\t\tif ( this.updateRange.offset !== 0 || this.updateRange.count !== - 1 ) data.updateRange = this.updateRange;\n\n\t\treturn data;\n\n\t}\n\n}\n\nBufferAttribute.prototype.isBufferAttribute = true;\n\n//\n\nclass Int8BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int8Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint8BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint8Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint8ClampedBufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint8ClampedArray( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Int16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Int32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Float16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nFloat16BufferAttribute.prototype.isFloat16BufferAttribute = true;\n\nclass Float32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Float32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Float64BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Float64Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nlet _id$1 = 0;\n\nconst _m1 = /*@__PURE__*/ new Matrix4();\nconst _obj = /*@__PURE__*/ new Object3D();\nconst _offset = /*@__PURE__*/ new Vector3();\nconst _box$1 = /*@__PURE__*/ new Box3();\nconst _boxMorphTargets = /*@__PURE__*/ new Box3();\nconst _vector$8 = /*@__PURE__*/ new Vector3();\n\nclass BufferGeometry extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tObject.defineProperty( this, 'id', { value: _id$1 ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'BufferGeometry';\n\n\t\tthis.index = null;\n\t\tthis.attributes = {};\n\n\t\tthis.morphAttributes = {};\n\t\tthis.morphTargetsRelative = false;\n\n\t\tthis.groups = [];\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\tthis.drawRange = { start: 0, count: Infinity };\n\n\t\tthis.userData = {};\n\n\t}\n\n\tgetIndex() {\n\n\t\treturn this.index;\n\n\t}\n\n\tsetIndex( index ) {\n\n\t\tif ( Array.isArray( index ) ) {\n\n\t\t\tthis.index = new ( arrayNeedsUint32( index ) ? Uint32BufferAttribute : Uint16BufferAttribute )( index, 1 );\n\n\t\t} else {\n\n\t\t\tthis.index = index;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetAttribute( name ) {\n\n\t\treturn this.attributes[ name ];\n\n\t}\n\n\tsetAttribute( name, attribute ) {\n\n\t\tthis.attributes[ name ] = attribute;\n\n\t\treturn this;\n\n\t}\n\n\tdeleteAttribute( name ) {\n\n\t\tdelete this.attributes[ name ];\n\n\t\treturn this;\n\n\t}\n\n\thasAttribute( name ) {\n\n\t\treturn this.attributes[ name ] !== undefined;\n\n\t}\n\n\taddGroup( start, count, materialIndex = 0 ) {\n\n\t\tthis.groups.push( {\n\n\t\t\tstart: start,\n\t\t\tcount: count,\n\t\t\tmaterialIndex: materialIndex\n\n\t\t} );\n\n\t}\n\n\tclearGroups() {\n\n\t\tthis.groups = [];\n\n\t}\n\n\tsetDrawRange( start, count ) {\n\n\t\tthis.drawRange.start = start;\n\t\tthis.drawRange.count = count;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tconst position = this.attributes.position;\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tposition.applyMatrix4( matrix );\n\n\t\t\tposition.needsUpdate = true;\n\n\t\t}\n\n\t\tconst normal = this.attributes.normal;\n\n\t\tif ( normal !== undefined ) {\n\n\t\t\tconst normalMatrix = new Matrix3().getNormalMatrix( matrix );\n\n\t\t\tnormal.applyNormalMatrix( normalMatrix );\n\n\t\t\tnormal.needsUpdate = true;\n\n\t\t}\n\n\t\tconst tangent = this.attributes.tangent;\n\n\t\tif ( tangent !== undefined ) {\n\n\t\t\ttangent.transformDirection( matrix );\n\n\t\t\ttangent.needsUpdate = true;\n\n\t\t}\n\n\t\tif ( this.boundingBox !== null ) {\n\n\t\t\tthis.computeBoundingBox();\n\n\t\t}\n\n\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\tthis.computeBoundingSphere();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\t_m1.makeRotationFromQuaternion( q );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateX( angle ) {\n\n\t\t// rotate geometry around world x-axis\n\n\t\t_m1.makeRotationX( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateY( angle ) {\n\n\t\t// rotate geometry around world y-axis\n\n\t\t_m1.makeRotationY( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateZ( angle ) {\n\n\t\t// rotate geometry around world z-axis\n\n\t\t_m1.makeRotationZ( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( x, y, z ) {\n\n\t\t// translate geometry\n\n\t\t_m1.makeTranslation( x, y, z );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\tscale( x, y, z ) {\n\n\t\t// scale geometry\n\n\t\t_m1.makeScale( x, y, z );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\tlookAt( vector ) {\n\n\t\t_obj.lookAt( vector );\n\n\t\t_obj.updateMatrix();\n\n\t\tthis.applyMatrix4( _obj.matrix );\n\n\t\treturn this;\n\n\t}\n\n\tcenter() {\n\n\t\tthis.computeBoundingBox();\n\n\t\tthis.boundingBox.getCenter( _offset ).negate();\n\n\t\tthis.translate( _offset.x, _offset.y, _offset.z );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tconst position = [];\n\n\t\tfor ( let i = 0, l = points.length; i < l; i ++ ) {\n\n\t\t\tconst point = points[ i ];\n\t\t\tposition.push( point.x, point.y, point.z || 0 );\n\n\t\t}\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( position, 3 ) );\n\n\t\treturn this;\n\n\t}\n\n\tcomputeBoundingBox() {\n\n\t\tif ( this.boundingBox === null ) {\n\n\t\t\tthis.boundingBox = new Box3();\n\n\t\t}\n\n\t\tconst position = this.attributes.position;\n\t\tconst morphAttributesPosition = this.morphAttributes.position;\n\n\t\tif ( position && position.isGLBufferAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set \"mesh.frustumCulled\" to \"false\".', this );\n\n\t\t\tthis.boundingBox.set(\n\t\t\t\tnew Vector3( - Infinity, - Infinity, - Infinity ),\n\t\t\t\tnew Vector3( + Infinity, + Infinity, + Infinity )\n\t\t\t);\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tthis.boundingBox.setFromBufferAttribute( position );\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\t_box$1.setFromBufferAttribute( morphAttribute );\n\n\t\t\t\t\tif ( this.morphTargetsRelative ) {\n\n\t\t\t\t\t\t_vector$8.addVectors( this.boundingBox.min, _box$1.min );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector$8 );\n\n\t\t\t\t\t\t_vector$8.addVectors( this.boundingBox.max, _box$1.max );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector$8 );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box$1.min );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box$1.max );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis.boundingBox.makeEmpty();\n\n\t\t}\n\n\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingSphere() {\n\n\t\tif ( this.boundingSphere === null ) {\n\n\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tconst position = this.attributes.position;\n\t\tconst morphAttributesPosition = this.morphAttributes.position;\n\n\t\tif ( position && position.isGLBufferAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set \"mesh.frustumCulled\" to \"false\".', this );\n\n\t\t\tthis.boundingSphere.set( new Vector3(), Infinity );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( position ) {\n\n\t\t\t// first, find the center of the bounding sphere\n\n\t\t\tconst center = this.boundingSphere.center;\n\n\t\t\t_box$1.setFromBufferAttribute( position );\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\t_boxMorphTargets.setFromBufferAttribute( morphAttribute );\n\n\t\t\t\t\tif ( this.morphTargetsRelative ) {\n\n\t\t\t\t\t\t_vector$8.addVectors( _box$1.min, _boxMorphTargets.min );\n\t\t\t\t\t\t_box$1.expandByPoint( _vector$8 );\n\n\t\t\t\t\t\t_vector$8.addVectors( _box$1.max, _boxMorphTargets.max );\n\t\t\t\t\t\t_box$1.expandByPoint( _vector$8 );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t_box$1.expandByPoint( _boxMorphTargets.min );\n\t\t\t\t\t\t_box$1.expandByPoint( _boxMorphTargets.max );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_box$1.getCenter( center );\n\n\t\t\t// second, try to find a boundingSphere with a radius smaller than the\n\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\n\n\t\t\tlet maxRadiusSq = 0;\n\n\t\t\tfor ( let i = 0, il = position.count; i < il; i ++ ) {\n\n\t\t\t\t_vector$8.fromBufferAttribute( position, i );\n\n\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector$8 ) );\n\n\t\t\t}\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\tconst morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t\t\t\tfor ( let j = 0, jl = morphAttribute.count; j < jl; j ++ ) {\n\n\t\t\t\t\t\t_vector$8.fromBufferAttribute( morphAttribute, j );\n\n\t\t\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t\t\t_offset.fromBufferAttribute( position, j );\n\t\t\t\t\t\t\t_vector$8.add( _offset );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector$8 ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\n\n\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcomputeTangents() {\n\n\t\tconst index = this.index;\n\t\tconst attributes = this.attributes;\n\n\t\t// based on http://www.terathon.com/code/tangent.html\n\t\t// (per vertex tangents)\n\n\t\tif ( index === null ||\n\t\t\t attributes.position === undefined ||\n\t\t\t attributes.normal === undefined ||\n\t\t\t attributes.uv === undefined ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst indices = index.array;\n\t\tconst positions = attributes.position.array;\n\t\tconst normals = attributes.normal.array;\n\t\tconst uvs = attributes.uv.array;\n\n\t\tconst nVertices = positions.length / 3;\n\n\t\tif ( attributes.tangent === undefined ) {\n\n\t\t\tthis.setAttribute( 'tangent', new BufferAttribute( new Float32Array( 4 * nVertices ), 4 ) );\n\n\t\t}\n\n\t\tconst tangents = attributes.tangent.array;\n\n\t\tconst tan1 = [], tan2 = [];\n\n\t\tfor ( let i = 0; i < nVertices; i ++ ) {\n\n\t\t\ttan1[ i ] = new Vector3();\n\t\t\ttan2[ i ] = new Vector3();\n\n\t\t}\n\n\t\tconst vA = new Vector3(),\n\t\t\tvB = new Vector3(),\n\t\t\tvC = new Vector3(),\n\n\t\t\tuvA = new Vector2(),\n\t\t\tuvB = new Vector2(),\n\t\t\tuvC = new Vector2(),\n\n\t\t\tsdir = new Vector3(),\n\t\t\ttdir = new Vector3();\n\n\t\tfunction handleTriangle( a, b, c ) {\n\n\t\t\tvA.fromArray( positions, a * 3 );\n\t\t\tvB.fromArray( positions, b * 3 );\n\t\t\tvC.fromArray( positions, c * 3 );\n\n\t\t\tuvA.fromArray( uvs, a * 2 );\n\t\t\tuvB.fromArray( uvs, b * 2 );\n\t\t\tuvC.fromArray( uvs, c * 2 );\n\n\t\t\tvB.sub( vA );\n\t\t\tvC.sub( vA );\n\n\t\t\tuvB.sub( uvA );\n\t\t\tuvC.sub( uvA );\n\n\t\t\tconst r = 1.0 / ( uvB.x * uvC.y - uvC.x * uvB.y );\n\n\t\t\t// silently ignore degenerate uv triangles having coincident or colinear vertices\n\n\t\t\tif ( ! isFinite( r ) ) return;\n\n\t\t\tsdir.copy( vB ).multiplyScalar( uvC.y ).addScaledVector( vC, - uvB.y ).multiplyScalar( r );\n\t\t\ttdir.copy( vC ).multiplyScalar( uvB.x ).addScaledVector( vB, - uvC.x ).multiplyScalar( r );\n\n\t\t\ttan1[ a ].add( sdir );\n\t\t\ttan1[ b ].add( sdir );\n\t\t\ttan1[ c ].add( sdir );\n\n\t\t\ttan2[ a ].add( tdir );\n\t\t\ttan2[ b ].add( tdir );\n\t\t\ttan2[ c ].add( tdir );\n\n\t\t}\n\n\t\tlet groups = this.groups;\n\n\t\tif ( groups.length === 0 ) {\n\n\t\t\tgroups = [ {\n\t\t\t\tstart: 0,\n\t\t\t\tcount: indices.length\n\t\t\t} ];\n\n\t\t}\n\n\t\tfor ( let i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tconst group = groups[ i ];\n\n\t\t\tconst start = group.start;\n\t\t\tconst count = group.count;\n\n\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleTriangle(\n\t\t\t\t\tindices[ j + 0 ],\n\t\t\t\t\tindices[ j + 1 ],\n\t\t\t\t\tindices[ j + 2 ]\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst tmp = new Vector3(), tmp2 = new Vector3();\n\t\tconst n = new Vector3(), n2 = new Vector3();\n\n\t\tfunction handleVertex( v ) {\n\n\t\t\tn.fromArray( normals, v * 3 );\n\t\t\tn2.copy( n );\n\n\t\t\tconst t = tan1[ v ];\n\n\t\t\t// Gram-Schmidt orthogonalize\n\n\t\t\ttmp.copy( t );\n\t\t\ttmp.sub( n.multiplyScalar( n.dot( t ) ) ).normalize();\n\n\t\t\t// Calculate handedness\n\n\t\t\ttmp2.crossVectors( n2, t );\n\t\t\tconst test = tmp2.dot( tan2[ v ] );\n\t\t\tconst w = ( test < 0.0 ) ? - 1.0 : 1.0;\n\n\t\t\ttangents[ v * 4 ] = tmp.x;\n\t\t\ttangents[ v * 4 + 1 ] = tmp.y;\n\t\t\ttangents[ v * 4 + 2 ] = tmp.z;\n\t\t\ttangents[ v * 4 + 3 ] = w;\n\n\t\t}\n\n\t\tfor ( let i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tconst group = groups[ i ];\n\n\t\t\tconst start = group.start;\n\t\t\tconst count = group.count;\n\n\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleVertex( indices[ j + 0 ] );\n\t\t\t\thandleVertex( indices[ j + 1 ] );\n\t\t\t\thandleVertex( indices[ j + 2 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcomputeVertexNormals() {\n\n\t\tconst index = this.index;\n\t\tconst positionAttribute = this.getAttribute( 'position' );\n\n\t\tif ( positionAttribute !== undefined ) {\n\n\t\t\tlet normalAttribute = this.getAttribute( 'normal' );\n\n\t\t\tif ( normalAttribute === undefined ) {\n\n\t\t\t\tnormalAttribute = new BufferAttribute( new Float32Array( positionAttribute.count * 3 ), 3 );\n\t\t\t\tthis.setAttribute( 'normal', normalAttribute );\n\n\t\t\t} else {\n\n\t\t\t\t// reset existing normals to zero\n\n\t\t\t\tfor ( let i = 0, il = normalAttribute.count; i < il; i ++ ) {\n\n\t\t\t\t\tnormalAttribute.setXYZ( i, 0, 0, 0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst pA = new Vector3(), pB = new Vector3(), pC = new Vector3();\n\t\t\tconst nA = new Vector3(), nB = new Vector3(), nC = new Vector3();\n\t\t\tconst cb = new Vector3(), ab = new Vector3();\n\n\t\t\t// indexed elements\n\n\t\t\tif ( index ) {\n\n\t\t\t\tfor ( let i = 0, il = index.count; i < il; i += 3 ) {\n\n\t\t\t\t\tconst vA = index.getX( i + 0 );\n\t\t\t\t\tconst vB = index.getX( i + 1 );\n\t\t\t\t\tconst vC = index.getX( i + 2 );\n\n\t\t\t\t\tpA.fromBufferAttribute( positionAttribute, vA );\n\t\t\t\t\tpB.fromBufferAttribute( positionAttribute, vB );\n\t\t\t\t\tpC.fromBufferAttribute( positionAttribute, vC );\n\n\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\tnA.fromBufferAttribute( normalAttribute, vA );\n\t\t\t\t\tnB.fromBufferAttribute( normalAttribute, vB );\n\t\t\t\t\tnC.fromBufferAttribute( normalAttribute, vC );\n\n\t\t\t\t\tnA.add( cb );\n\t\t\t\t\tnB.add( cb );\n\t\t\t\t\tnC.add( cb );\n\n\t\t\t\t\tnormalAttribute.setXYZ( vA, nA.x, nA.y, nA.z );\n\t\t\t\t\tnormalAttribute.setXYZ( vB, nB.x, nB.y, nB.z );\n\t\t\t\t\tnormalAttribute.setXYZ( vC, nC.x, nC.y, nC.z );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// non-indexed elements (unconnected triangle soup)\n\n\t\t\t\tfor ( let i = 0, il = positionAttribute.count; i < il; i += 3 ) {\n\n\t\t\t\t\tpA.fromBufferAttribute( positionAttribute, i + 0 );\n\t\t\t\t\tpB.fromBufferAttribute( positionAttribute, i + 1 );\n\t\t\t\t\tpC.fromBufferAttribute( positionAttribute, i + 2 );\n\n\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\tnormalAttribute.setXYZ( i + 0, cb.x, cb.y, cb.z );\n\t\t\t\t\tnormalAttribute.setXYZ( i + 1, cb.x, cb.y, cb.z );\n\t\t\t\t\tnormalAttribute.setXYZ( i + 2, cb.x, cb.y, cb.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.normalizeNormals();\n\n\t\t\tnormalAttribute.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\tmerge( geometry, offset ) {\n\n\t\tif ( ! ( geometry && geometry.isBufferGeometry ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( offset === undefined ) {\n\n\t\t\toffset = 0;\n\n\t\t\tconsole.warn(\n\t\t\t\t'THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. '\n\t\t\t\t+ 'Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge.'\n\t\t\t);\n\n\t\t}\n\n\t\tconst attributes = this.attributes;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tif ( geometry.attributes[ key ] === undefined ) continue;\n\n\t\t\tconst attribute1 = attributes[ key ];\n\t\t\tconst attributeArray1 = attribute1.array;\n\n\t\t\tconst attribute2 = geometry.attributes[ key ];\n\t\t\tconst attributeArray2 = attribute2.array;\n\n\t\t\tconst attributeOffset = attribute2.itemSize * offset;\n\t\t\tconst length = Math.min( attributeArray2.length, attributeArray1.length - attributeOffset );\n\n\t\t\tfor ( let i = 0, j = attributeOffset; i < length; i ++, j ++ ) {\n\n\t\t\t\tattributeArray1[ j ] = attributeArray2[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tnormalizeNormals() {\n\n\t\tconst normals = this.attributes.normal;\n\n\t\tfor ( let i = 0, il = normals.count; i < il; i ++ ) {\n\n\t\t\t_vector$8.fromBufferAttribute( normals, i );\n\n\t\t\t_vector$8.normalize();\n\n\t\t\tnormals.setXYZ( i, _vector$8.x, _vector$8.y, _vector$8.z );\n\n\t\t}\n\n\t}\n\n\ttoNonIndexed() {\n\n\t\tfunction convertBufferAttribute( attribute, indices ) {\n\n\t\t\tconst array = attribute.array;\n\t\t\tconst itemSize = attribute.itemSize;\n\t\t\tconst normalized = attribute.normalized;\n\n\t\t\tconst array2 = new array.constructor( indices.length * itemSize );\n\n\t\t\tlet index = 0, index2 = 0;\n\n\t\t\tfor ( let i = 0, l = indices.length; i < l; i ++ ) {\n\n\t\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\t\tindex = indices[ i ] * attribute.data.stride + attribute.offset;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tindex = indices[ i ] * itemSize;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let j = 0; j < itemSize; j ++ ) {\n\n\t\t\t\t\tarray2[ index2 ++ ] = array[ index ++ ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new BufferAttribute( array2, itemSize, normalized );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.index === null ) {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed.' );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst geometry2 = new BufferGeometry();\n\n\t\tconst indices = this.index.array;\n\t\tconst attributes = this.attributes;\n\n\t\t// attributes\n\n\t\tfor ( const name in attributes ) {\n\n\t\t\tconst attribute = attributes[ name ];\n\n\t\t\tconst newAttribute = convertBufferAttribute( attribute, indices );\n\n\t\t\tgeometry2.setAttribute( name, newAttribute );\n\n\t\t}\n\n\t\t// morph attributes\n\n\t\tconst morphAttributes = this.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst morphArray = [];\n\t\t\tconst morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\n\n\t\t\tfor ( let i = 0, il = morphAttribute.length; i < il; i ++ ) {\n\n\t\t\t\tconst attribute = morphAttribute[ i ];\n\n\t\t\t\tconst newAttribute = convertBufferAttribute( attribute, indices );\n\n\t\t\t\tmorphArray.push( newAttribute );\n\n\t\t\t}\n\n\t\t\tgeometry2.morphAttributes[ name ] = morphArray;\n\n\t\t}\n\n\t\tgeometry2.morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t// groups\n\n\t\tconst groups = this.groups;\n\n\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\tconst group = groups[ i ];\n\t\t\tgeometry2.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t}\n\n\t\treturn geometry2;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'BufferGeometry',\n\t\t\t\tgenerator: 'BufferGeometry.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard BufferGeometry serialization\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\t\tif ( this.name !== '' ) data.name = this.name;\n\t\tif ( Object.keys( this.userData ).length > 0 ) data.userData = this.userData;\n\n\t\tif ( this.parameters !== undefined ) {\n\n\t\t\tconst parameters = this.parameters;\n\n\t\t\tfor ( const key in parameters ) {\n\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\t// for simplicity the code assumes attributes are not shared across geometries, see #15811\n\n\t\tdata.data = { attributes: {} };\n\n\t\tconst index = this.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tdata.data.index = {\n\t\t\t\ttype: index.array.constructor.name,\n\t\t\t\tarray: Array.prototype.slice.call( index.array )\n\t\t\t};\n\n\t\t}\n\n\t\tconst attributes = this.attributes;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tconst attribute = attributes[ key ];\n\n\t\t\tdata.data.attributes[ key ] = attribute.toJSON( data.data );\n\n\t\t}\n\n\t\tconst morphAttributes = {};\n\t\tlet hasMorphAttributes = false;\n\n\t\tfor ( const key in this.morphAttributes ) {\n\n\t\t\tconst attributeArray = this.morphAttributes[ key ];\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0, il = attributeArray.length; i < il; i ++ ) {\n\n\t\t\t\tconst attribute = attributeArray[ i ];\n\n\t\t\t\tarray.push( attribute.toJSON( data.data ) );\n\n\t\t\t}\n\n\t\t\tif ( array.length > 0 ) {\n\n\t\t\t\tmorphAttributes[ key ] = array;\n\n\t\t\t\thasMorphAttributes = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( hasMorphAttributes ) {\n\n\t\t\tdata.data.morphAttributes = morphAttributes;\n\t\t\tdata.data.morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t}\n\n\t\tconst groups = this.groups;\n\n\t\tif ( groups.length > 0 ) {\n\n\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\n\n\t\t}\n\n\t\tconst boundingSphere = this.boundingSphere;\n\n\t\tif ( boundingSphere !== null ) {\n\n\t\t\tdata.data.boundingSphere = {\n\t\t\t\tcenter: boundingSphere.center.toArray(),\n\t\t\t\tradius: boundingSphere.radius\n\t\t\t};\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tclone() {\n\n\t\t return new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\t// reset\n\n\t\tthis.index = null;\n\t\tthis.attributes = {};\n\t\tthis.morphAttributes = {};\n\t\tthis.groups = [];\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\t// used for storing cloned, shared data\n\n\t\tconst data = {};\n\n\t\t// name\n\n\t\tthis.name = source.name;\n\n\t\t// index\n\n\t\tconst index = source.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tthis.setIndex( index.clone( data ) );\n\n\t\t}\n\n\t\t// attributes\n\n\t\tconst attributes = source.attributes;\n\n\t\tfor ( const name in attributes ) {\n\n\t\t\tconst attribute = attributes[ name ];\n\t\t\tthis.setAttribute( name, attribute.clone( data ) );\n\n\t\t}\n\n\t\t// morph attributes\n\n\t\tconst morphAttributes = source.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst array = [];\n\t\t\tconst morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\n\n\t\t\tfor ( let i = 0, l = morphAttribute.length; i < l; i ++ ) {\n\n\t\t\t\tarray.push( morphAttribute[ i ].clone( data ) );\n\n\t\t\t}\n\n\t\t\tthis.morphAttributes[ name ] = array;\n\n\t\t}\n\n\t\tthis.morphTargetsRelative = source.morphTargetsRelative;\n\n\t\t// groups\n\n\t\tconst groups = source.groups;\n\n\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\tconst group = groups[ i ];\n\t\t\tthis.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t}\n\n\t\t// bounding box\n\n\t\tconst boundingBox = source.boundingBox;\n\n\t\tif ( boundingBox !== null ) {\n\n\t\t\tthis.boundingBox = boundingBox.clone();\n\n\t\t}\n\n\t\t// bounding sphere\n\n\t\tconst boundingSphere = source.boundingSphere;\n\n\t\tif ( boundingSphere !== null ) {\n\n\t\t\tthis.boundingSphere = boundingSphere.clone();\n\n\t\t}\n\n\t\t// draw range\n\n\t\tthis.drawRange.start = source.drawRange.start;\n\t\tthis.drawRange.count = source.drawRange.count;\n\n\t\t// user data\n\n\t\tthis.userData = source.userData;\n\n\t\t// geometry generator parameters\n\n\t\tif ( source.parameters !== undefined ) this.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n}\n\nBufferGeometry.prototype.isBufferGeometry = true;\n\nconst _inverseMatrix$2 = /*@__PURE__*/ new Matrix4();\nconst _ray$2 = /*@__PURE__*/ new Ray();\nconst _sphere$3 = /*@__PURE__*/ new Sphere();\n\nconst _vA$1 = /*@__PURE__*/ new Vector3();\nconst _vB$1 = /*@__PURE__*/ new Vector3();\nconst _vC$1 = /*@__PURE__*/ new Vector3();\n\nconst _tempA = /*@__PURE__*/ new Vector3();\nconst _tempB = /*@__PURE__*/ new Vector3();\nconst _tempC = /*@__PURE__*/ new Vector3();\n\nconst _morphA = /*@__PURE__*/ new Vector3();\nconst _morphB = /*@__PURE__*/ new Vector3();\nconst _morphC = /*@__PURE__*/ new Vector3();\n\nconst _uvA$1 = /*@__PURE__*/ new Vector2();\nconst _uvB$1 = /*@__PURE__*/ new Vector2();\nconst _uvC$1 = /*@__PURE__*/ new Vector2();\n\nconst _intersectionPoint = /*@__PURE__*/ new Vector3();\nconst _intersectionPointWorld = /*@__PURE__*/ new Vector3();\n\nclass Mesh extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new MeshBasicMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Mesh';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tif ( source.morphTargetInfluences !== undefined ) {\n\n\t\t\tthis.morphTargetInfluences = source.morphTargetInfluences.slice();\n\n\t\t}\n\n\t\tif ( source.morphTargetDictionary !== undefined ) {\n\n\t\t\tthis.morphTargetDictionary = Object.assign( {}, source.morphTargetDictionary );\n\n\t\t}\n\n\t\tthis.material = source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst morphAttributes = geometry.morphAttributes;\n\t\t\tconst keys = Object.keys( morphAttributes );\n\n\t\t\tif ( keys.length > 0 ) {\n\n\t\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst morphTargets = geometry.morphTargets;\n\n\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\n\n\t\t\t\tconsole.error( 'THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst material = this.material;\n\t\tconst matrixWorld = this.matrixWorld;\n\n\t\tif ( material === undefined ) return;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere$3.copy( geometry.boundingSphere );\n\t\t_sphere$3.applyMatrix4( matrixWorld );\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere$3 ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix$2.copy( matrixWorld ).invert();\n\t\t_ray$2.copy( raycaster.ray ).applyMatrix4( _inverseMatrix$2 );\n\n\t\t// Check boundingBox before continuing\n\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tif ( _ray$2.intersectsBox( geometry.boundingBox ) === false ) return;\n\n\t\t}\n\n\t\tlet intersection;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst position = geometry.attributes.position;\n\t\t\tconst morphPosition = geometry.morphAttributes.position;\n\t\t\tconst morphTargetsRelative = geometry.morphTargetsRelative;\n\t\t\tconst uv = geometry.attributes.uv;\n\t\t\tconst uv2 = geometry.attributes.uv2;\n\t\t\tconst groups = geometry.groups;\n\t\t\tconst drawRange = geometry.drawRange;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\t// indexed buffer geometry\n\n\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\tfor ( let i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\t\tconst start = Math.max( group.start, drawRange.start );\n\t\t\t\t\t\tconst end = Math.min( index.count, Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) ) );\n\n\t\t\t\t\t\tfor ( let j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\t\t\tconst a = index.getX( j );\n\t\t\t\t\t\t\tconst b = index.getX( j + 1 );\n\t\t\t\t\t\t\tconst c = index.getX( j + 2 );\n\n\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, groupMaterial, raycaster, _ray$2, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\n\n\t\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in indexed buffer semantics\n\t\t\t\t\t\t\t\tintersection.face.materialIndex = group.materialIndex;\n\t\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\t\tfor ( let i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\t\t\tconst a = index.getX( i );\n\t\t\t\t\t\tconst b = index.getX( i + 1 );\n\t\t\t\t\t\tconst c = index.getX( i + 2 );\n\n\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, material, raycaster, _ray$2, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\n\n\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in indexed buffer semantics\n\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( position !== undefined ) {\n\n\t\t\t\t// non-indexed buffer geometry\n\n\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\tfor ( let i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\t\tconst start = Math.max( group.start, drawRange.start );\n\t\t\t\t\t\tconst end = Math.min( position.count, Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) ) );\n\n\t\t\t\t\t\tfor ( let j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\t\t\tconst a = j;\n\t\t\t\t\t\t\tconst b = j + 1;\n\t\t\t\t\t\t\tconst c = j + 2;\n\n\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, groupMaterial, raycaster, _ray$2, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\n\n\t\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in non-indexed buffer semantics\n\t\t\t\t\t\t\t\tintersection.face.materialIndex = group.materialIndex;\n\t\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\t\tconst end = Math.min( position.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\t\tfor ( let i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\t\t\tconst a = i;\n\t\t\t\t\t\tconst b = i + 1;\n\t\t\t\t\t\tconst c = i + 2;\n\n\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, material, raycaster, _ray$2, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\n\n\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in non-indexed buffer semantics\n\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconsole.error( 'THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t}\n\n}\n\nMesh.prototype.isMesh = true;\n\nfunction checkIntersection( object, material, raycaster, ray, pA, pB, pC, point ) {\n\n\tlet intersect;\n\n\tif ( material.side === BackSide ) {\n\n\t\tintersect = ray.intersectTriangle( pC, pB, pA, true, point );\n\n\t} else {\n\n\t\tintersect = ray.intersectTriangle( pA, pB, pC, material.side !== DoubleSide, point );\n\n\t}\n\n\tif ( intersect === null ) return null;\n\n\t_intersectionPointWorld.copy( point );\n\t_intersectionPointWorld.applyMatrix4( object.matrixWorld );\n\n\tconst distance = raycaster.ray.origin.distanceTo( _intersectionPointWorld );\n\n\tif ( distance < raycaster.near || distance > raycaster.far ) return null;\n\n\treturn {\n\t\tdistance: distance,\n\t\tpoint: _intersectionPointWorld.clone(),\n\t\tobject: object\n\t};\n\n}\n\nfunction checkBufferGeometryIntersection( object, material, raycaster, ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c ) {\n\n\t_vA$1.fromBufferAttribute( position, a );\n\t_vB$1.fromBufferAttribute( position, b );\n\t_vC$1.fromBufferAttribute( position, c );\n\n\tconst morphInfluences = object.morphTargetInfluences;\n\n\tif ( morphPosition && morphInfluences ) {\n\n\t\t_morphA.set( 0, 0, 0 );\n\t\t_morphB.set( 0, 0, 0 );\n\t\t_morphC.set( 0, 0, 0 );\n\n\t\tfor ( let i = 0, il = morphPosition.length; i < il; i ++ ) {\n\n\t\t\tconst influence = morphInfluences[ i ];\n\t\t\tconst morphAttribute = morphPosition[ i ];\n\n\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t_tempA.fromBufferAttribute( morphAttribute, a );\n\t\t\t_tempB.fromBufferAttribute( morphAttribute, b );\n\t\t\t_tempC.fromBufferAttribute( morphAttribute, c );\n\n\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t_morphA.addScaledVector( _tempA, influence );\n\t\t\t\t_morphB.addScaledVector( _tempB, influence );\n\t\t\t\t_morphC.addScaledVector( _tempC, influence );\n\n\t\t\t} else {\n\n\t\t\t\t_morphA.addScaledVector( _tempA.sub( _vA$1 ), influence );\n\t\t\t\t_morphB.addScaledVector( _tempB.sub( _vB$1 ), influence );\n\t\t\t\t_morphC.addScaledVector( _tempC.sub( _vC$1 ), influence );\n\n\t\t\t}\n\n\t\t}\n\n\t\t_vA$1.add( _morphA );\n\t\t_vB$1.add( _morphB );\n\t\t_vC$1.add( _morphC );\n\n\t}\n\n\tif ( object.isSkinnedMesh ) {\n\n\t\tobject.boneTransform( a, _vA$1 );\n\t\tobject.boneTransform( b, _vB$1 );\n\t\tobject.boneTransform( c, _vC$1 );\n\n\t}\n\n\tconst intersection = checkIntersection( object, material, raycaster, ray, _vA$1, _vB$1, _vC$1, _intersectionPoint );\n\n\tif ( intersection ) {\n\n\t\tif ( uv ) {\n\n\t\t\t_uvA$1.fromBufferAttribute( uv, a );\n\t\t\t_uvB$1.fromBufferAttribute( uv, b );\n\t\t\t_uvC$1.fromBufferAttribute( uv, c );\n\n\t\t\tintersection.uv = Triangle.getUV( _intersectionPoint, _vA$1, _vB$1, _vC$1, _uvA$1, _uvB$1, _uvC$1, new Vector2() );\n\n\t\t}\n\n\t\tif ( uv2 ) {\n\n\t\t\t_uvA$1.fromBufferAttribute( uv2, a );\n\t\t\t_uvB$1.fromBufferAttribute( uv2, b );\n\t\t\t_uvC$1.fromBufferAttribute( uv2, c );\n\n\t\t\tintersection.uv2 = Triangle.getUV( _intersectionPoint, _vA$1, _vB$1, _vC$1, _uvA$1, _uvB$1, _uvC$1, new Vector2() );\n\n\t\t}\n\n\t\tconst face = {\n\t\t\ta: a,\n\t\t\tb: b,\n\t\t\tc: c,\n\t\t\tnormal: new Vector3(),\n\t\t\tmaterialIndex: 0\n\t\t};\n\n\t\tTriangle.getNormal( _vA$1, _vB$1, _vC$1, face.normal );\n\n\t\tintersection.face = face;\n\n\t}\n\n\treturn intersection;\n\n}\n\nclass BoxGeometry extends BufferGeometry {\n\n\tconstructor( width = 1, height = 1, depth = 1, widthSegments = 1, heightSegments = 1, depthSegments = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'BoxGeometry';\n\n\t\tthis.parameters = {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\tdepth: depth,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\tdepthSegments: depthSegments\n\t\t};\n\n\t\tconst scope = this;\n\n\t\t// segments\n\n\t\twidthSegments = Math.floor( widthSegments );\n\t\theightSegments = Math.floor( heightSegments );\n\t\tdepthSegments = Math.floor( depthSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tlet numberOfVertices = 0;\n\t\tlet groupStart = 0;\n\n\t\t// build each side of the box geometry\n\n\t\tbuildPlane( 'z', 'y', 'x', - 1, - 1, depth, height, width, depthSegments, heightSegments, 0 ); // px\n\t\tbuildPlane( 'z', 'y', 'x', 1, - 1, depth, height, - width, depthSegments, heightSegments, 1 ); // nx\n\t\tbuildPlane( 'x', 'z', 'y', 1, 1, width, depth, height, widthSegments, depthSegments, 2 ); // py\n\t\tbuildPlane( 'x', 'z', 'y', 1, - 1, width, depth, - height, widthSegments, depthSegments, 3 ); // ny\n\t\tbuildPlane( 'x', 'y', 'z', 1, - 1, width, height, depth, widthSegments, heightSegments, 4 ); // pz\n\t\tbuildPlane( 'x', 'y', 'z', - 1, - 1, width, height, - depth, widthSegments, heightSegments, 5 ); // nz\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\tfunction buildPlane( u, v, w, udir, vdir, width, height, depth, gridX, gridY, materialIndex ) {\n\n\t\t\tconst segmentWidth = width / gridX;\n\t\t\tconst segmentHeight = height / gridY;\n\n\t\t\tconst widthHalf = width / 2;\n\t\t\tconst heightHalf = height / 2;\n\t\t\tconst depthHalf = depth / 2;\n\n\t\t\tconst gridX1 = gridX + 1;\n\t\t\tconst gridY1 = gridY + 1;\n\n\t\t\tlet vertexCounter = 0;\n\t\t\tlet groupCount = 0;\n\n\t\t\tconst vector = new Vector3();\n\n\t\t\t// generate vertices, normals and uvs\n\n\t\t\tfor ( let iy = 0; iy < gridY1; iy ++ ) {\n\n\t\t\t\tconst y = iy * segmentHeight - heightHalf;\n\n\t\t\t\tfor ( let ix = 0; ix < gridX1; ix ++ ) {\n\n\t\t\t\t\tconst x = ix * segmentWidth - widthHalf;\n\n\t\t\t\t\t// set values to correct vector component\n\n\t\t\t\t\tvector[ u ] = x * udir;\n\t\t\t\t\tvector[ v ] = y * vdir;\n\t\t\t\t\tvector[ w ] = depthHalf;\n\n\t\t\t\t\t// now apply vector to vertex buffer\n\n\t\t\t\t\tvertices.push( vector.x, vector.y, vector.z );\n\n\t\t\t\t\t// set values to correct vector component\n\n\t\t\t\t\tvector[ u ] = 0;\n\t\t\t\t\tvector[ v ] = 0;\n\t\t\t\t\tvector[ w ] = depth > 0 ? 1 : - 1;\n\n\t\t\t\t\t// now apply vector to normal buffer\n\n\t\t\t\t\tnormals.push( vector.x, vector.y, vector.z );\n\n\t\t\t\t\t// uvs\n\n\t\t\t\t\tuvs.push( ix / gridX );\n\t\t\t\t\tuvs.push( 1 - ( iy / gridY ) );\n\n\t\t\t\t\t// counters\n\n\t\t\t\t\tvertexCounter += 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// indices\n\n\t\t\t// 1. you need three indices to draw a single face\n\t\t\t// 2. a single segment consists of two faces\n\t\t\t// 3. so we need to generate six (2*3) indices per segment\n\n\t\t\tfor ( let iy = 0; iy < gridY; iy ++ ) {\n\n\t\t\t\tfor ( let ix = 0; ix < gridX; ix ++ ) {\n\n\t\t\t\t\tconst a = numberOfVertices + ix + gridX1 * iy;\n\t\t\t\t\tconst b = numberOfVertices + ix + gridX1 * ( iy + 1 );\n\t\t\t\t\tconst c = numberOfVertices + ( ix + 1 ) + gridX1 * ( iy + 1 );\n\t\t\t\t\tconst d = numberOfVertices + ( ix + 1 ) + gridX1 * iy;\n\n\t\t\t\t\t// faces\n\n\t\t\t\t\tindices.push( a, b, d );\n\t\t\t\t\tindices.push( b, c, d );\n\n\t\t\t\t\t// increase counter\n\n\t\t\t\t\tgroupCount += 6;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\n\t\t\tscope.addGroup( groupStart, groupCount, materialIndex );\n\n\t\t\t// calculate new start value for groups\n\n\t\t\tgroupStart += groupCount;\n\n\t\t\t// update total number of vertices\n\n\t\t\tnumberOfVertices += vertexCounter;\n\n\t\t}\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new BoxGeometry( data.width, data.height, data.depth, data.widthSegments, data.heightSegments, data.depthSegments );\n\n\t}\n\n}\n\n/**\n * Uniform Utilities\n */\n\nfunction cloneUniforms( src ) {\n\n\tconst dst = {};\n\n\tfor ( const u in src ) {\n\n\t\tdst[ u ] = {};\n\n\t\tfor ( const p in src[ u ] ) {\n\n\t\t\tconst property = src[ u ][ p ];\n\n\t\t\tif ( property && ( property.isColor ||\n\t\t\t\tproperty.isMatrix3 || property.isMatrix4 ||\n\t\t\t\tproperty.isVector2 || property.isVector3 || property.isVector4 ||\n\t\t\t\tproperty.isTexture || property.isQuaternion ) ) {\n\n\t\t\t\tdst[ u ][ p ] = property.clone();\n\n\t\t\t} else if ( Array.isArray( property ) ) {\n\n\t\t\t\tdst[ u ][ p ] = property.slice();\n\n\t\t\t} else {\n\n\t\t\t\tdst[ u ][ p ] = property;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn dst;\n\n}\n\nfunction mergeUniforms( uniforms ) {\n\n\tconst merged = {};\n\n\tfor ( let u = 0; u < uniforms.length; u ++ ) {\n\n\t\tconst tmp = cloneUniforms( uniforms[ u ] );\n\n\t\tfor ( const p in tmp ) {\n\n\t\t\tmerged[ p ] = tmp[ p ];\n\n\t\t}\n\n\t}\n\n\treturn merged;\n\n}\n\n// Legacy\n\nconst UniformsUtils = { clone: cloneUniforms, merge: mergeUniforms };\n\nvar default_vertex = \"void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}\";\n\nvar default_fragment = \"void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}\";\n\n/**\n * parameters = {\n *  defines: { \"label\" : \"value\" },\n *  uniforms: { \"parameter1\": { value: 1.0 }, \"parameter2\": { value2: 2 } },\n *\n *  fragmentShader: <string>,\n *  vertexShader: <string>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n *\n *  lights: <bool>\n * }\n */\n\nclass ShaderMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ShaderMaterial';\n\n\t\tthis.defines = {};\n\t\tthis.uniforms = {};\n\n\t\tthis.vertexShader = default_vertex;\n\t\tthis.fragmentShader = default_fragment;\n\n\t\tthis.linewidth = 1;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false; // set to use scene fog\n\t\tthis.lights = false; // set to use scene lights\n\t\tthis.clipping = false; // set to use user-defined clipping planes\n\n\t\tthis.extensions = {\n\t\t\tderivatives: false, // set to use derivatives\n\t\t\tfragDepth: false, // set to use fragment depth values\n\t\t\tdrawBuffers: false, // set to use draw buffers\n\t\t\tshaderTextureLOD: false // set to use shader texture LOD\n\t\t};\n\n\t\t// When rendered geometry doesn't include these attributes but the material does,\n\t\t// use these default values in WebGL. This avoids errors when buffer data is missing.\n\t\tthis.defaultAttributeValues = {\n\t\t\t'color': [ 1, 1, 1 ],\n\t\t\t'uv': [ 0, 0 ],\n\t\t\t'uv2': [ 0, 0 ]\n\t\t};\n\n\t\tthis.index0AttributeName = undefined;\n\t\tthis.uniformsNeedUpdate = false;\n\n\t\tthis.glslVersion = null;\n\n\t\tif ( parameters !== undefined ) {\n\n\t\t\tif ( parameters.attributes !== undefined ) {\n\n\t\t\t\tconsole.error( 'THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t\tthis.setValues( parameters );\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.fragmentShader = source.fragmentShader;\n\t\tthis.vertexShader = source.vertexShader;\n\n\t\tthis.uniforms = cloneUniforms( source.uniforms );\n\n\t\tthis.defines = Object.assign( {}, source.defines );\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.lights = source.lights;\n\t\tthis.clipping = source.clipping;\n\n\t\tthis.extensions = Object.assign( {}, source.extensions );\n\n\t\tthis.glslVersion = source.glslVersion;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.glslVersion = this.glslVersion;\n\t\tdata.uniforms = {};\n\n\t\tfor ( const name in this.uniforms ) {\n\n\t\t\tconst uniform = this.uniforms[ name ];\n\t\t\tconst value = uniform.value;\n\n\t\t\tif ( value && value.isTexture ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 't',\n\t\t\t\t\tvalue: value.toJSON( meta ).uuid\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isColor ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'c',\n\t\t\t\t\tvalue: value.getHex()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector2 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v2',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector3 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v3',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector4 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v4',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isMatrix3 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'm3',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isMatrix4 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'm4',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\tvalue: value\n\t\t\t\t};\n\n\t\t\t\t// note: the array variants v2v, v3v, v4v, m4v and tv are not supported so far\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( Object.keys( this.defines ).length > 0 ) data.defines = this.defines;\n\n\t\tdata.vertexShader = this.vertexShader;\n\t\tdata.fragmentShader = this.fragmentShader;\n\n\t\tconst extensions = {};\n\n\t\tfor ( const key in this.extensions ) {\n\n\t\t\tif ( this.extensions[ key ] === true ) extensions[ key ] = true;\n\n\t\t}\n\n\t\tif ( Object.keys( extensions ).length > 0 ) data.extensions = extensions;\n\n\t\treturn data;\n\n\t}\n\n}\n\nShaderMaterial.prototype.isShaderMaterial = true;\n\nclass Camera extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'Camera';\n\n\t\tthis.matrixWorldInverse = new Matrix4();\n\n\t\tthis.projectionMatrix = new Matrix4();\n\t\tthis.projectionMatrixInverse = new Matrix4();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.matrixWorldInverse.copy( source.matrixWorldInverse );\n\n\t\tthis.projectionMatrix.copy( source.projectionMatrix );\n\t\tthis.projectionMatrixInverse.copy( source.projectionMatrixInverse );\n\n\t\treturn this;\n\n\t}\n\n\tgetWorldDirection( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tconst e = this.matrixWorld.elements;\n\n\t\treturn target.set( - e[ 8 ], - e[ 9 ], - e[ 10 ] ).normalize();\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tthis.matrixWorldInverse.copy( this.matrixWorld ).invert();\n\n\t}\n\n\tupdateWorldMatrix( updateParents, updateChildren ) {\n\n\t\tsuper.updateWorldMatrix( updateParents, updateChildren );\n\n\t\tthis.matrixWorldInverse.copy( this.matrixWorld ).invert();\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nCamera.prototype.isCamera = true;\n\nclass PerspectiveCamera extends Camera {\n\n\tconstructor( fov = 50, aspect = 1, near = 0.1, far = 2000 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'PerspectiveCamera';\n\n\t\tthis.fov = fov;\n\t\tthis.zoom = 1;\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\t\tthis.focus = 10;\n\n\t\tthis.aspect = aspect;\n\t\tthis.view = null;\n\n\t\tthis.filmGauge = 35;\t// width of the film (default in millimeters)\n\t\tthis.filmOffset = 0;\t// horizontal film offset (same unit as gauge)\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.fov = source.fov;\n\t\tthis.zoom = source.zoom;\n\n\t\tthis.near = source.near;\n\t\tthis.far = source.far;\n\t\tthis.focus = source.focus;\n\n\t\tthis.aspect = source.aspect;\n\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\tthis.filmGauge = source.filmGauge;\n\t\tthis.filmOffset = source.filmOffset;\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Sets the FOV by focal length in respect to the current .filmGauge.\n\t *\n\t * The default film gauge is 35, so that the focal length can be specified for\n\t * a 35mm (full frame) camera.\n\t *\n\t * Values for focal length and film gauge must have the same unit.\n\t */\n\tsetFocalLength( focalLength ) {\n\n\t\t/** see {@link http://www.bobatkins.com/photography/technical/field_of_view.html} */\n\t\tconst vExtentSlope = 0.5 * this.getFilmHeight() / focalLength;\n\n\t\tthis.fov = RAD2DEG * 2 * Math.atan( vExtentSlope );\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\t/**\n\t * Calculates the focal length from the current .fov and .filmGauge.\n\t */\n\tgetFocalLength() {\n\n\t\tconst vExtentSlope = Math.tan( DEG2RAD * 0.5 * this.fov );\n\n\t\treturn 0.5 * this.getFilmHeight() / vExtentSlope;\n\n\t}\n\n\tgetEffectiveFOV() {\n\n\t\treturn RAD2DEG * 2 * Math.atan(\n\t\t\tMath.tan( DEG2RAD * 0.5 * this.fov ) / this.zoom );\n\n\t}\n\n\tgetFilmWidth() {\n\n\t\t// film not completely covered in portrait format (aspect < 1)\n\t\treturn this.filmGauge * Math.min( this.aspect, 1 );\n\n\t}\n\n\tgetFilmHeight() {\n\n\t\t// film not completely covered in landscape format (aspect > 1)\n\t\treturn this.filmGauge / Math.max( this.aspect, 1 );\n\n\t}\n\n\t/**\n\t * Sets an offset in a larger frustum. This is useful for multi-window or\n\t * multi-monitor/multi-machine setups.\n\t *\n\t * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\n\t * the monitors are in grid like this\n\t *\n\t *   +---+---+---+\n\t *   | A | B | C |\n\t *   +---+---+---+\n\t *   | D | E | F |\n\t *   +---+---+---+\n\t *\n\t * then for each monitor you would call it like this\n\t *\n\t *   const w = 1920;\n\t *   const h = 1080;\n\t *   const fullWidth = w * 3;\n\t *   const fullHeight = h * 2;\n\t *\n\t *   --A--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\n\t *   --B--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\n\t *   --C--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\n\t *   --D--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\n\t *   --E--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\n\t *   --F--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\n\t *\n\t *   Note there is no reason monitors have to be the same size or in a grid.\n\t */\n\tsetViewOffset( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\tthis.aspect = fullWidth / fullHeight;\n\n\t\tif ( this.view === null ) {\n\n\t\t\tthis.view = {\n\t\t\t\tenabled: true,\n\t\t\t\tfullWidth: 1,\n\t\t\t\tfullHeight: 1,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\twidth: 1,\n\t\t\t\theight: 1\n\t\t\t};\n\n\t\t}\n\n\t\tthis.view.enabled = true;\n\t\tthis.view.fullWidth = fullWidth;\n\t\tthis.view.fullHeight = fullHeight;\n\t\tthis.view.offsetX = x;\n\t\tthis.view.offsetY = y;\n\t\tthis.view.width = width;\n\t\tthis.view.height = height;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tclearViewOffset() {\n\n\t\tif ( this.view !== null ) {\n\n\t\t\tthis.view.enabled = false;\n\n\t\t}\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tupdateProjectionMatrix() {\n\n\t\tconst near = this.near;\n\t\tlet top = near * Math.tan( DEG2RAD * 0.5 * this.fov ) / this.zoom;\n\t\tlet height = 2 * top;\n\t\tlet width = this.aspect * height;\n\t\tlet left = - 0.5 * width;\n\t\tconst view = this.view;\n\n\t\tif ( this.view !== null && this.view.enabled ) {\n\n\t\t\tconst fullWidth = view.fullWidth,\n\t\t\t\tfullHeight = view.fullHeight;\n\n\t\t\tleft += view.offsetX * width / fullWidth;\n\t\t\ttop -= view.offsetY * height / fullHeight;\n\t\t\twidth *= view.width / fullWidth;\n\t\t\theight *= view.height / fullHeight;\n\n\t\t}\n\n\t\tconst skew = this.filmOffset;\n\t\tif ( skew !== 0 ) left += near * skew / this.getFilmWidth();\n\n\t\tthis.projectionMatrix.makePerspective( left, left + width, top, top - height, near, this.far );\n\n\t\tthis.projectionMatrixInverse.copy( this.projectionMatrix ).invert();\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.fov = this.fov;\n\t\tdata.object.zoom = this.zoom;\n\n\t\tdata.object.near = this.near;\n\t\tdata.object.far = this.far;\n\t\tdata.object.focus = this.focus;\n\n\t\tdata.object.aspect = this.aspect;\n\n\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\tdata.object.filmGauge = this.filmGauge;\n\t\tdata.object.filmOffset = this.filmOffset;\n\n\t\treturn data;\n\n\t}\n\n}\n\nPerspectiveCamera.prototype.isPerspectiveCamera = true;\n\nconst fov = 90, aspect = 1;\n\nclass CubeCamera extends Object3D {\n\n\tconstructor( near, far, renderTarget ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CubeCamera';\n\n\t\tif ( renderTarget.isWebGLCubeRenderTarget !== true ) {\n\n\t\t\tconsole.error( 'THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.renderTarget = renderTarget;\n\n\t\tconst cameraPX = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPX.layers = this.layers;\n\t\tcameraPX.up.set( 0, - 1, 0 );\n\t\tcameraPX.lookAt( new Vector3( 1, 0, 0 ) );\n\t\tthis.add( cameraPX );\n\n\t\tconst cameraNX = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNX.layers = this.layers;\n\t\tcameraNX.up.set( 0, - 1, 0 );\n\t\tcameraNX.lookAt( new Vector3( - 1, 0, 0 ) );\n\t\tthis.add( cameraNX );\n\n\t\tconst cameraPY = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPY.layers = this.layers;\n\t\tcameraPY.up.set( 0, 0, 1 );\n\t\tcameraPY.lookAt( new Vector3( 0, 1, 0 ) );\n\t\tthis.add( cameraPY );\n\n\t\tconst cameraNY = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNY.layers = this.layers;\n\t\tcameraNY.up.set( 0, 0, - 1 );\n\t\tcameraNY.lookAt( new Vector3( 0, - 1, 0 ) );\n\t\tthis.add( cameraNY );\n\n\t\tconst cameraPZ = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPZ.layers = this.layers;\n\t\tcameraPZ.up.set( 0, - 1, 0 );\n\t\tcameraPZ.lookAt( new Vector3( 0, 0, 1 ) );\n\t\tthis.add( cameraPZ );\n\n\t\tconst cameraNZ = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNZ.layers = this.layers;\n\t\tcameraNZ.up.set( 0, - 1, 0 );\n\t\tcameraNZ.lookAt( new Vector3( 0, 0, - 1 ) );\n\t\tthis.add( cameraNZ );\n\n\t}\n\n\tupdate( renderer, scene ) {\n\n\t\tif ( this.parent === null ) this.updateMatrixWorld();\n\n\t\tconst renderTarget = this.renderTarget;\n\n\t\tconst [ cameraPX, cameraNX, cameraPY, cameraNY, cameraPZ, cameraNZ ] = this.children;\n\n\t\tconst currentXrEnabled = renderer.xr.enabled;\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\trenderer.xr.enabled = false;\n\n\t\tconst generateMipmaps = renderTarget.texture.generateMipmaps;\n\n\t\trenderTarget.texture.generateMipmaps = false;\n\n\t\trenderer.setRenderTarget( renderTarget, 0 );\n\t\trenderer.render( scene, cameraPX );\n\n\t\trenderer.setRenderTarget( renderTarget, 1 );\n\t\trenderer.render( scene, cameraNX );\n\n\t\trenderer.setRenderTarget( renderTarget, 2 );\n\t\trenderer.render( scene, cameraPY );\n\n\t\trenderer.setRenderTarget( renderTarget, 3 );\n\t\trenderer.render( scene, cameraNY );\n\n\t\trenderer.setRenderTarget( renderTarget, 4 );\n\t\trenderer.render( scene, cameraPZ );\n\n\t\trenderTarget.texture.generateMipmaps = generateMipmaps;\n\n\t\trenderer.setRenderTarget( renderTarget, 5 );\n\t\trenderer.render( scene, cameraNZ );\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\trenderer.xr.enabled = currentXrEnabled;\n\n\t\trenderTarget.texture.needsPMREMUpdate = true;\n\n\t}\n\n}\n\nclass CubeTexture extends Texture {\n\n\tconstructor( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding ) {\n\n\t\timages = images !== undefined ? images : [];\n\t\tmapping = mapping !== undefined ? mapping : CubeReflectionMapping;\n\n\t\tsuper( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\n\n\t\tthis.flipY = false;\n\n\t}\n\n\tget images() {\n\n\t\treturn this.image;\n\n\t}\n\n\tset images( value ) {\n\n\t\tthis.image = value;\n\n\t}\n\n}\n\nCubeTexture.prototype.isCubeTexture = true;\n\nclass WebGLCubeRenderTarget extends WebGLRenderTarget {\n\n\tconstructor( size, options, dummy ) {\n\n\t\tif ( Number.isInteger( options ) ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )' );\n\n\t\t\toptions = dummy;\n\n\t\t}\n\n\t\tsuper( size, size, options );\n\n\t\toptions = options || {};\n\n\t\t// By convention -- likely based on the RenderMan spec from the 1990's -- cube maps are specified by WebGL (and three.js)\n\t\t// in a coordinate system in which positive-x is to the right when looking up the positive-z axis -- in other words,\n\t\t// in a left-handed coordinate system. By continuing this convention, preexisting cube maps continued to render correctly.\n\n\t\t// three.js uses a right-handed coordinate system. So environment maps used in three.js appear to have px and nx swapped\n\t\t// and the flag isRenderTargetTexture controls this conversion. The flip is not required when using WebGLCubeRenderTarget.texture\n\t\t// as a cube texture (this is detected when isRenderTargetTexture is set to true for cube textures).\n\n\t\tthis.texture = new CubeTexture( undefined, options.mapping, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.encoding );\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t\tthis.texture.generateMipmaps = options.generateMipmaps !== undefined ? options.generateMipmaps : false;\n\t\tthis.texture.minFilter = options.minFilter !== undefined ? options.minFilter : LinearFilter;\n\n\t}\n\n\tfromEquirectangularTexture( renderer, texture ) {\n\n\t\tthis.texture.type = texture.type;\n\t\tthis.texture.format = RGBAFormat; // see #18859\n\t\tthis.texture.encoding = texture.encoding;\n\n\t\tthis.texture.generateMipmaps = texture.generateMipmaps;\n\t\tthis.texture.minFilter = texture.minFilter;\n\t\tthis.texture.magFilter = texture.magFilter;\n\n\t\tconst shader = {\n\n\t\t\tuniforms: {\n\t\t\t\ttEquirect: { value: null },\n\t\t\t},\n\n\t\t\tvertexShader: /* glsl */`\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t`,\n\n\t\t\tfragmentShader: /* glsl */`\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t`\n\t\t};\n\n\t\tconst geometry = new BoxGeometry( 5, 5, 5 );\n\n\t\tconst material = new ShaderMaterial( {\n\n\t\t\tname: 'CubemapFromEquirect',\n\n\t\t\tuniforms: cloneUniforms( shader.uniforms ),\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader,\n\t\t\tside: BackSide,\n\t\t\tblending: NoBlending\n\n\t\t} );\n\n\t\tmaterial.uniforms.tEquirect.value = texture;\n\n\t\tconst mesh = new Mesh( geometry, material );\n\n\t\tconst currentMinFilter = texture.minFilter;\n\n\t\t// Avoid blurred poles\n\t\tif ( texture.minFilter === LinearMipmapLinearFilter ) texture.minFilter = LinearFilter;\n\n\t\tconst camera = new CubeCamera( 1, 10, this );\n\t\tcamera.update( renderer, mesh );\n\n\t\ttexture.minFilter = currentMinFilter;\n\n\t\tmesh.geometry.dispose();\n\t\tmesh.material.dispose();\n\n\t\treturn this;\n\n\t}\n\n\tclear( renderer, color, depth, stencil ) {\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\trenderer.setRenderTarget( this, i );\n\n\t\t\trenderer.clear( color, depth, stencil );\n\n\t\t}\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t}\n\n}\n\nWebGLCubeRenderTarget.prototype.isWebGLCubeRenderTarget = true;\n\nconst _vector1 = /*@__PURE__*/ new Vector3();\nconst _vector2 = /*@__PURE__*/ new Vector3();\nconst _normalMatrix = /*@__PURE__*/ new Matrix3();\n\nclass Plane {\n\n\tconstructor( normal = new Vector3( 1, 0, 0 ), constant = 0 ) {\n\n\t\t// normal is assumed to be normalized\n\n\t\tthis.normal = normal;\n\t\tthis.constant = constant;\n\n\t}\n\n\tset( normal, constant ) {\n\n\t\tthis.normal.copy( normal );\n\t\tthis.constant = constant;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponents( x, y, z, w ) {\n\n\t\tthis.normal.set( x, y, z );\n\t\tthis.constant = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromNormalAndCoplanarPoint( normal, point ) {\n\n\t\tthis.normal.copy( normal );\n\t\tthis.constant = - point.dot( this.normal );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCoplanarPoints( a, b, c ) {\n\n\t\tconst normal = _vector1.subVectors( c, b ).cross( _vector2.subVectors( a, b ) ).normalize();\n\n\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\n\n\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( plane ) {\n\n\t\tthis.normal.copy( plane.normal );\n\t\tthis.constant = plane.constant;\n\n\t\treturn this;\n\n\t}\n\n\tnormalize() {\n\n\t\t// Note: will lead to a divide by zero if the plane is invalid.\n\n\t\tconst inverseNormalLength = 1.0 / this.normal.length();\n\t\tthis.normal.multiplyScalar( inverseNormalLength );\n\t\tthis.constant *= inverseNormalLength;\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.constant *= - 1;\n\t\tthis.normal.negate();\n\n\t\treturn this;\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn this.normal.dot( point ) + this.constant;\n\n\t}\n\n\tdistanceToSphere( sphere ) {\n\n\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\n\n\t}\n\n\tprojectPoint( point, target ) {\n\n\t\treturn target.copy( this.normal ).multiplyScalar( - this.distanceToPoint( point ) ).add( point );\n\n\t}\n\n\tintersectLine( line, target ) {\n\n\t\tconst direction = line.delta( _vector1 );\n\n\t\tconst denominator = this.normal.dot( direction );\n\n\t\tif ( denominator === 0 ) {\n\n\t\t\t// line is coplanar, return origin\n\t\t\tif ( this.distanceToPoint( line.start ) === 0 ) {\n\n\t\t\t\treturn target.copy( line.start );\n\n\t\t\t}\n\n\t\t\t// Unsure if this is the correct method to handle this case.\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\n\n\t\tif ( t < 0 || t > 1 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn target.copy( direction ).multiplyScalar( t ).add( line.start );\n\n\t}\n\n\tintersectsLine( line ) {\n\n\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\n\n\t\tconst startSign = this.distanceToPoint( line.start );\n\t\tconst endSign = this.distanceToPoint( line.end );\n\n\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsPlane( this );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\treturn sphere.intersectsPlane( this );\n\n\t}\n\n\tcoplanarPoint( target ) {\n\n\t\treturn target.copy( this.normal ).multiplyScalar( - this.constant );\n\n\t}\n\n\tapplyMatrix4( matrix, optionalNormalMatrix ) {\n\n\t\tconst normalMatrix = optionalNormalMatrix || _normalMatrix.getNormalMatrix( matrix );\n\n\t\tconst referencePoint = this.coplanarPoint( _vector1 ).applyMatrix4( matrix );\n\n\t\tconst normal = this.normal.applyMatrix3( normalMatrix ).normalize();\n\n\t\tthis.constant = - referencePoint.dot( normal );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.constant -= offset.dot( this.normal );\n\n\t\treturn this;\n\n\t}\n\n\tequals( plane ) {\n\n\t\treturn plane.normal.equals( this.normal ) && ( plane.constant === this.constant );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nPlane.prototype.isPlane = true;\n\nconst _sphere$2 = /*@__PURE__*/ new Sphere();\nconst _vector$7 = /*@__PURE__*/ new Vector3();\n\nclass Frustum {\n\n\tconstructor( p0 = new Plane(), p1 = new Plane(), p2 = new Plane(), p3 = new Plane(), p4 = new Plane(), p5 = new Plane() ) {\n\n\t\tthis.planes = [ p0, p1, p2, p3, p4, p5 ];\n\n\t}\n\n\tset( p0, p1, p2, p3, p4, p5 ) {\n\n\t\tconst planes = this.planes;\n\n\t\tplanes[ 0 ].copy( p0 );\n\t\tplanes[ 1 ].copy( p1 );\n\t\tplanes[ 2 ].copy( p2 );\n\t\tplanes[ 3 ].copy( p3 );\n\t\tplanes[ 4 ].copy( p4 );\n\t\tplanes[ 5 ].copy( p5 );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( frustum ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromProjectionMatrix( m ) {\n\n\t\tconst planes = this.planes;\n\t\tconst me = m.elements;\n\t\tconst me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\n\t\tconst me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\n\t\tconst me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\n\t\tconst me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\n\n\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\n\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\n\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\n\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\n\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\n\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\n\n\t\treturn this;\n\n\t}\n\n\tintersectsObject( object ) {\n\n\t\tconst geometry = object.geometry;\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere$2.copy( geometry.boundingSphere ).applyMatrix4( object.matrixWorld );\n\n\t\treturn this.intersectsSphere( _sphere$2 );\n\n\t}\n\n\tintersectsSprite( sprite ) {\n\n\t\t_sphere$2.center.set( 0, 0, 0 );\n\t\t_sphere$2.radius = 0.7071067811865476;\n\t\t_sphere$2.applyMatrix4( sprite.matrixWorld );\n\n\t\treturn this.intersectsSphere( _sphere$2 );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\tconst planes = this.planes;\n\t\tconst center = sphere.center;\n\t\tconst negRadius = - sphere.radius;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst distance = planes[ i ].distanceToPoint( center );\n\n\t\t\tif ( distance < negRadius ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst plane = planes[ i ];\n\n\t\t\t// corner at max distance\n\n\t\t\t_vector$7.x = plane.normal.x > 0 ? box.max.x : box.min.x;\n\t\t\t_vector$7.y = plane.normal.y > 0 ? box.max.y : box.min.y;\n\t\t\t_vector$7.z = plane.normal.z > 0 ? box.max.z : box.min.z;\n\n\t\t\tif ( plane.distanceToPoint( _vector$7 ) < 0 ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nfunction WebGLAnimation() {\n\n\tlet context = null;\n\tlet isAnimating = false;\n\tlet animationLoop = null;\n\tlet requestId = null;\n\n\tfunction onAnimationFrame( time, frame ) {\n\n\t\tanimationLoop( time, frame );\n\n\t\trequestId = context.requestAnimationFrame( onAnimationFrame );\n\n\t}\n\n\treturn {\n\n\t\tstart: function () {\n\n\t\t\tif ( isAnimating === true ) return;\n\t\t\tif ( animationLoop === null ) return;\n\n\t\t\trequestId = context.requestAnimationFrame( onAnimationFrame );\n\n\t\t\tisAnimating = true;\n\n\t\t},\n\n\t\tstop: function () {\n\n\t\t\tcontext.cancelAnimationFrame( requestId );\n\n\t\t\tisAnimating = false;\n\n\t\t},\n\n\t\tsetAnimationLoop: function ( callback ) {\n\n\t\t\tanimationLoop = callback;\n\n\t\t},\n\n\t\tsetContext: function ( value ) {\n\n\t\t\tcontext = value;\n\n\t\t}\n\n\t};\n\n}\n\nfunction WebGLAttributes( gl, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tconst buffers = new WeakMap();\n\n\tfunction createBuffer( attribute, bufferType ) {\n\n\t\tconst array = attribute.array;\n\t\tconst usage = attribute.usage;\n\n\t\tconst buffer = gl.createBuffer();\n\n\t\tgl.bindBuffer( bufferType, buffer );\n\t\tgl.bufferData( bufferType, array, usage );\n\n\t\tattribute.onUploadCallback();\n\n\t\tlet type = 5126;\n\n\t\tif ( array instanceof Float32Array ) {\n\n\t\t\ttype = 5126;\n\n\t\t} else if ( array instanceof Float64Array ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.' );\n\n\t\t} else if ( array instanceof Uint16Array ) {\n\n\t\t\tif ( attribute.isFloat16BufferAttribute ) {\n\n\t\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\t\ttype = 5131;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.' );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\ttype = 5123;\n\n\t\t\t}\n\n\t\t} else if ( array instanceof Int16Array ) {\n\n\t\t\ttype = 5122;\n\n\t\t} else if ( array instanceof Uint32Array ) {\n\n\t\t\ttype = 5125;\n\n\t\t} else if ( array instanceof Int32Array ) {\n\n\t\t\ttype = 5124;\n\n\t\t} else if ( array instanceof Int8Array ) {\n\n\t\t\ttype = 5120;\n\n\t\t} else if ( array instanceof Uint8Array ) {\n\n\t\t\ttype = 5121;\n\n\t\t} else if ( array instanceof Uint8ClampedArray ) {\n\n\t\t\ttype = 5121;\n\n\t\t}\n\n\t\treturn {\n\t\t\tbuffer: buffer,\n\t\t\ttype: type,\n\t\t\tbytesPerElement: array.BYTES_PER_ELEMENT,\n\t\t\tversion: attribute.version\n\t\t};\n\n\t}\n\n\tfunction updateBuffer( buffer, attribute, bufferType ) {\n\n\t\tconst array = attribute.array;\n\t\tconst updateRange = attribute.updateRange;\n\n\t\tgl.bindBuffer( bufferType, buffer );\n\n\t\tif ( updateRange.count === - 1 ) {\n\n\t\t\t// Not using update ranges\n\n\t\t\tgl.bufferSubData( bufferType, 0, array );\n\n\t\t} else {\n\n\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\tgl.bufferSubData( bufferType, updateRange.offset * array.BYTES_PER_ELEMENT,\n\t\t\t\t\tarray, updateRange.offset, updateRange.count );\n\n\t\t\t} else {\n\n\t\t\t\tgl.bufferSubData( bufferType, updateRange.offset * array.BYTES_PER_ELEMENT,\n\t\t\t\t\tarray.subarray( updateRange.offset, updateRange.offset + updateRange.count ) );\n\n\t\t\t}\n\n\t\t\tupdateRange.count = - 1; // reset range\n\n\t\t}\n\n\t}\n\n\t//\n\n\tfunction get( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\treturn buffers.get( attribute );\n\n\t}\n\n\tfunction remove( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\tconst data = buffers.get( attribute );\n\n\t\tif ( data ) {\n\n\t\t\tgl.deleteBuffer( data.buffer );\n\n\t\t\tbuffers.delete( attribute );\n\n\t\t}\n\n\t}\n\n\tfunction update( attribute, bufferType ) {\n\n\t\tif ( attribute.isGLBufferAttribute ) {\n\n\t\t\tconst cached = buffers.get( attribute );\n\n\t\t\tif ( ! cached || cached.version < attribute.version ) {\n\n\t\t\t\tbuffers.set( attribute, {\n\t\t\t\t\tbuffer: attribute.buffer,\n\t\t\t\t\ttype: attribute.type,\n\t\t\t\t\tbytesPerElement: attribute.elementSize,\n\t\t\t\t\tversion: attribute.version\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\tconst data = buffers.get( attribute );\n\n\t\tif ( data === undefined ) {\n\n\t\t\tbuffers.set( attribute, createBuffer( attribute, bufferType ) );\n\n\t\t} else if ( data.version < attribute.version ) {\n\n\t\t\tupdateBuffer( data.buffer, attribute, bufferType );\n\n\t\t\tdata.version = attribute.version;\n\n\t\t}\n\n\t}\n\n\treturn {\n\n\t\tget: get,\n\t\tremove: remove,\n\t\tupdate: update\n\n\t};\n\n}\n\nclass PlaneGeometry extends BufferGeometry {\n\n\tconstructor( width = 1, height = 1, widthSegments = 1, heightSegments = 1 ) {\n\n\t\tsuper();\n\t\tthis.type = 'PlaneGeometry';\n\n\t\tthis.parameters = {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments\n\t\t};\n\n\t\tconst width_half = width / 2;\n\t\tconst height_half = height / 2;\n\n\t\tconst gridX = Math.floor( widthSegments );\n\t\tconst gridY = Math.floor( heightSegments );\n\n\t\tconst gridX1 = gridX + 1;\n\t\tconst gridY1 = gridY + 1;\n\n\t\tconst segment_width = width / gridX;\n\t\tconst segment_height = height / gridY;\n\n\t\t//\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\tfor ( let iy = 0; iy < gridY1; iy ++ ) {\n\n\t\t\tconst y = iy * segment_height - height_half;\n\n\t\t\tfor ( let ix = 0; ix < gridX1; ix ++ ) {\n\n\t\t\t\tconst x = ix * segment_width - width_half;\n\n\t\t\t\tvertices.push( x, - y, 0 );\n\n\t\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t\tuvs.push( ix / gridX );\n\t\t\t\tuvs.push( 1 - ( iy / gridY ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( let iy = 0; iy < gridY; iy ++ ) {\n\n\t\t\tfor ( let ix = 0; ix < gridX; ix ++ ) {\n\n\t\t\t\tconst a = ix + gridX1 * iy;\n\t\t\t\tconst b = ix + gridX1 * ( iy + 1 );\n\t\t\t\tconst c = ( ix + 1 ) + gridX1 * ( iy + 1 );\n\t\t\t\tconst d = ( ix + 1 ) + gridX1 * iy;\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new PlaneGeometry( data.width, data.height, data.widthSegments, data.heightSegments );\n\n\t}\n\n}\n\nvar alphamap_fragment = \"#ifdef USE_ALPHAMAP\\n\\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n#endif\";\n\nvar alphamap_pars_fragment = \"#ifdef USE_ALPHAMAP\\n\\tuniform sampler2D alphaMap;\\n#endif\";\n\nvar alphatest_fragment = \"#ifdef USE_ALPHATEST\\n\\tif ( diffuseColor.a < alphaTest ) discard;\\n#endif\";\n\nvar alphatest_pars_fragment = \"#ifdef USE_ALPHATEST\\n\\tuniform float alphaTest;\\n#endif\";\n\nvar aomap_fragment = \"#ifdef USE_AOMAP\\n\\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\\n\\treflectedLight.indirectDiffuse *= ambientOcclusion;\\n\\t#if defined( USE_ENVMAP ) && defined( STANDARD )\\n\\t\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\\t\\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\\n\\t#endif\\n#endif\";\n\nvar aomap_pars_fragment = \"#ifdef USE_AOMAP\\n\\tuniform sampler2D aoMap;\\n\\tuniform float aoMapIntensity;\\n#endif\";\n\nvar begin_vertex = \"vec3 transformed = vec3( position );\";\n\nvar beginnormal_vertex = \"vec3 objectNormal = vec3( normal );\\n#ifdef USE_TANGENT\\n\\tvec3 objectTangent = vec3( tangent.xyz );\\n#endif\";\n\nvar bsdfs = \"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\\n\\treturn RECIPROCAL_PI * diffuseColor;\\n}\\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\\n\\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\\n\\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\\n}\\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\n\\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\n\\treturn 0.5 / max( gv + gl, EPSILON );\\n}\\nfloat D_GGX( const in float alpha, const in float dotNH ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\\n\\treturn RECIPROCAL_PI * a2 / pow2( denom );\\n}\\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\\n\\tfloat alpha = pow2( roughness );\\n\\tvec3 halfDir = normalize( lightDir + viewDir );\\n\\tfloat dotNL = saturate( dot( normal, lightDir ) );\\n\\tfloat dotNV = saturate( dot( normal, viewDir ) );\\n\\tfloat dotNH = saturate( dot( normal, halfDir ) );\\n\\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\\n\\tvec3 F = F_Schlick( f0, f90, dotVH );\\n\\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\\n\\tfloat D = D_GGX( alpha, dotNH );\\n\\treturn F * ( V * D );\\n}\\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\\n\\tconst float LUT_SIZE = 64.0;\\n\\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\\n\\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\\n\\tfloat dotNV = saturate( dot( N, V ) );\\n\\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\\n\\tuv = uv * LUT_SCALE + LUT_BIAS;\\n\\treturn uv;\\n}\\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\\n\\tfloat l = length( f );\\n\\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\\n}\\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\\n\\tfloat x = dot( v1, v2 );\\n\\tfloat y = abs( x );\\n\\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\\n\\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\\n\\tfloat v = a / b;\\n\\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\\n\\treturn cross( v1, v2 ) * theta_sintheta;\\n}\\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\\n\\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\\n\\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\\n\\tvec3 lightNormal = cross( v1, v2 );\\n\\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\\n\\tvec3 T1, T2;\\n\\tT1 = normalize( V - N * dot( V, N ) );\\n\\tT2 = - cross( N, T1 );\\n\\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\\n\\tvec3 coords[ 4 ];\\n\\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\\n\\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\\n\\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\\n\\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\\n\\tcoords[ 0 ] = normalize( coords[ 0 ] );\\n\\tcoords[ 1 ] = normalize( coords[ 1 ] );\\n\\tcoords[ 2 ] = normalize( coords[ 2 ] );\\n\\tcoords[ 3 ] = normalize( coords[ 3 ] );\\n\\tvec3 vectorFormFactor = vec3( 0.0 );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\\n\\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\\n\\treturn vec3( result );\\n}\\nfloat G_BlinnPhong_Implicit( ) {\\n\\treturn 0.25;\\n}\\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\\n\\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\\n}\\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\\n\\tvec3 halfDir = normalize( lightDir + viewDir );\\n\\tfloat dotNH = saturate( dot( normal, halfDir ) );\\n\\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\\n\\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\\n\\tfloat G = G_BlinnPhong_Implicit( );\\n\\tfloat D = D_BlinnPhong( shininess, dotNH );\\n\\treturn F * ( G * D );\\n}\\n#if defined( USE_SHEEN )\\nfloat D_Charlie( float roughness, float dotNH ) {\\n\\tfloat alpha = pow2( roughness );\\n\\tfloat invAlpha = 1.0 / alpha;\\n\\tfloat cos2h = dotNH * dotNH;\\n\\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\\n\\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\\n}\\nfloat V_Neubelt( float dotNV, float dotNL ) {\\n\\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\\n}\\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\\n\\tvec3 halfDir = normalize( lightDir + viewDir );\\n\\tfloat dotNL = saturate( dot( normal, lightDir ) );\\n\\tfloat dotNV = saturate( dot( normal, viewDir ) );\\n\\tfloat dotNH = saturate( dot( normal, halfDir ) );\\n\\tfloat D = D_Charlie( sheenRoughness, dotNH );\\n\\tfloat V = V_Neubelt( dotNV, dotNL );\\n\\treturn sheenColor * ( D * V );\\n}\\n#endif\";\n\nvar bumpmap_pars_fragment = \"#ifdef USE_BUMPMAP\\n\\tuniform sampler2D bumpMap;\\n\\tuniform float bumpScale;\\n\\tvec2 dHdxy_fwd() {\\n\\t\\tvec2 dSTdx = dFdx( vUv );\\n\\t\\tvec2 dSTdy = dFdy( vUv );\\n\\t\\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\\t\\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\\t\\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\t\\treturn vec2( dBx, dBy );\\n\\t}\\n\\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\\n\\t\\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\\n\\t\\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\\n\\t\\tvec3 vN = surf_norm;\\n\\t\\tvec3 R1 = cross( vSigmaY, vN );\\n\\t\\tvec3 R2 = cross( vN, vSigmaX );\\n\\t\\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\\n\\t\\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\\t\\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\t}\\n#endif\";\n\nvar clipping_planes_fragment = \"#if NUM_CLIPPING_PLANES > 0\\n\\tvec4 plane;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\\n\\t\\tplane = clippingPlanes[ i ];\\n\\t\\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\\n\\t\\tbool clipped = true;\\n\\t\\t#pragma unroll_loop_start\\n\\t\\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\\n\\t\\t\\tplane = clippingPlanes[ i ];\\n\\t\\t\\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\\n\\t\\t}\\n\\t\\t#pragma unroll_loop_end\\n\\t\\tif ( clipped ) discard;\\n\\t#endif\\n#endif\";\n\nvar clipping_planes_pars_fragment = \"#if NUM_CLIPPING_PLANES > 0\\n\\tvarying vec3 vClipPosition;\\n\\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\\n#endif\";\n\nvar clipping_planes_pars_vertex = \"#if NUM_CLIPPING_PLANES > 0\\n\\tvarying vec3 vClipPosition;\\n#endif\";\n\nvar clipping_planes_vertex = \"#if NUM_CLIPPING_PLANES > 0\\n\\tvClipPosition = - mvPosition.xyz;\\n#endif\";\n\nvar color_fragment = \"#if defined( USE_COLOR_ALPHA )\\n\\tdiffuseColor *= vColor;\\n#elif defined( USE_COLOR )\\n\\tdiffuseColor.rgb *= vColor;\\n#endif\";\n\nvar color_pars_fragment = \"#if defined( USE_COLOR_ALPHA )\\n\\tvarying vec4 vColor;\\n#elif defined( USE_COLOR )\\n\\tvarying vec3 vColor;\\n#endif\";\n\nvar color_pars_vertex = \"#if defined( USE_COLOR_ALPHA )\\n\\tvarying vec4 vColor;\\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\\n\\tvarying vec3 vColor;\\n#endif\";\n\nvar color_vertex = \"#if defined( USE_COLOR_ALPHA )\\n\\tvColor = vec4( 1.0 );\\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\\n\\tvColor = vec3( 1.0 );\\n#endif\\n#ifdef USE_COLOR\\n\\tvColor *= color;\\n#endif\\n#ifdef USE_INSTANCING_COLOR\\n\\tvColor.xyz *= instanceColor.xyz;\\n#endif\";\n\nvar common = \"#define PI 3.141592653589793\\n#define PI2 6.283185307179586\\n#define PI_HALF 1.5707963267948966\\n#define RECIPROCAL_PI 0.3183098861837907\\n#define RECIPROCAL_PI2 0.15915494309189535\\n#define EPSILON 1e-6\\n#ifndef saturate\\n#define saturate( a ) clamp( a, 0.0, 1.0 )\\n#endif\\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\\nfloat pow2( const in float x ) { return x*x; }\\nfloat pow3( const in float x ) { return x*x*x; }\\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\\nhighp float rand( const in vec2 uv ) {\\n\\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\\n\\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\\n\\treturn fract( sin( sn ) * c );\\n}\\n#ifdef HIGH_PRECISION\\n\\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\\n#else\\n\\tfloat precisionSafeLength( vec3 v ) {\\n\\t\\tfloat maxComponent = max3( abs( v ) );\\n\\t\\treturn length( v / maxComponent ) * maxComponent;\\n\\t}\\n#endif\\nstruct IncidentLight {\\n\\tvec3 color;\\n\\tvec3 direction;\\n\\tbool visible;\\n};\\nstruct ReflectedLight {\\n\\tvec3 directDiffuse;\\n\\tvec3 directSpecular;\\n\\tvec3 indirectDiffuse;\\n\\tvec3 indirectSpecular;\\n};\\nstruct GeometricContext {\\n\\tvec3 position;\\n\\tvec3 normal;\\n\\tvec3 viewDir;\\n#ifdef USE_CLEARCOAT\\n\\tvec3 clearcoatNormal;\\n#endif\\n};\\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\\n\\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\\n}\\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\\n\\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\\n}\\nmat3 transposeMat3( const in mat3 m ) {\\n\\tmat3 tmp;\\n\\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\\n\\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\\n\\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\\n\\treturn tmp;\\n}\\nfloat linearToRelativeLuminance( const in vec3 color ) {\\n\\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\\n\\treturn dot( weights, color.rgb );\\n}\\nbool isPerspectiveMatrix( mat4 m ) {\\n\\treturn m[ 2 ][ 3 ] == - 1.0;\\n}\\nvec2 equirectUv( in vec3 dir ) {\\n\\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\\n\\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\\n\\treturn vec2( u, v );\\n}\";\n\nvar cube_uv_reflection_fragment = \"#ifdef ENVMAP_TYPE_CUBE_UV\\n\\t#define cubeUV_maxMipLevel 8.0\\n\\t#define cubeUV_minMipLevel 4.0\\n\\t#define cubeUV_maxTileSize 256.0\\n\\t#define cubeUV_minTileSize 16.0\\n\\tfloat getFace( vec3 direction ) {\\n\\t\\tvec3 absDirection = abs( direction );\\n\\t\\tfloat face = - 1.0;\\n\\t\\tif ( absDirection.x > absDirection.z ) {\\n\\t\\t\\tif ( absDirection.x > absDirection.y )\\n\\t\\t\\t\\tface = direction.x > 0.0 ? 0.0 : 3.0;\\n\\t\\t\\telse\\n\\t\\t\\t\\tface = direction.y > 0.0 ? 1.0 : 4.0;\\n\\t\\t} else {\\n\\t\\t\\tif ( absDirection.z > absDirection.y )\\n\\t\\t\\t\\tface = direction.z > 0.0 ? 2.0 : 5.0;\\n\\t\\t\\telse\\n\\t\\t\\t\\tface = direction.y > 0.0 ? 1.0 : 4.0;\\n\\t\\t}\\n\\t\\treturn face;\\n\\t}\\n\\tvec2 getUV( vec3 direction, float face ) {\\n\\t\\tvec2 uv;\\n\\t\\tif ( face == 0.0 ) {\\n\\t\\t\\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\\n\\t\\t} else if ( face == 1.0 ) {\\n\\t\\t\\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\\n\\t\\t} else if ( face == 2.0 ) {\\n\\t\\t\\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\\n\\t\\t} else if ( face == 3.0 ) {\\n\\t\\t\\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\\n\\t\\t} else if ( face == 4.0 ) {\\n\\t\\t\\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\\n\\t\\t} else {\\n\\t\\t\\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\\n\\t\\t}\\n\\t\\treturn 0.5 * ( uv + 1.0 );\\n\\t}\\n\\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\\n\\t\\tfloat face = getFace( direction );\\n\\t\\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\\n\\t\\tmipInt = max( mipInt, cubeUV_minMipLevel );\\n\\t\\tfloat faceSize = exp2( mipInt );\\n\\t\\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\\n\\t\\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\\n\\t\\tif ( face > 2.0 ) {\\n\\t\\t\\tuv.y += faceSize;\\n\\t\\t\\tface -= 3.0;\\n\\t\\t}\\n\\t\\tuv.x += face * faceSize;\\n\\t\\tif ( mipInt < cubeUV_maxMipLevel ) {\\n\\t\\t\\tuv.y += 2.0 * cubeUV_maxTileSize;\\n\\t\\t}\\n\\t\\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\\n\\t\\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\\n\\t\\tuv *= texelSize;\\n\\t\\treturn texture2D( envMap, uv ).rgb;\\n\\t}\\n\\t#define r0 1.0\\n\\t#define v0 0.339\\n\\t#define m0 - 2.0\\n\\t#define r1 0.8\\n\\t#define v1 0.276\\n\\t#define m1 - 1.0\\n\\t#define r4 0.4\\n\\t#define v4 0.046\\n\\t#define m4 2.0\\n\\t#define r5 0.305\\n\\t#define v5 0.016\\n\\t#define m5 3.0\\n\\t#define r6 0.21\\n\\t#define v6 0.0038\\n\\t#define m6 4.0\\n\\tfloat roughnessToMip( float roughness ) {\\n\\t\\tfloat mip = 0.0;\\n\\t\\tif ( roughness >= r1 ) {\\n\\t\\t\\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\\n\\t\\t} else if ( roughness >= r4 ) {\\n\\t\\t\\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\\n\\t\\t} else if ( roughness >= r5 ) {\\n\\t\\t\\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\\n\\t\\t} else if ( roughness >= r6 ) {\\n\\t\\t\\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\\n\\t\\t} else {\\n\\t\\t\\tmip = - 2.0 * log2( 1.16 * roughness );\\t\\t}\\n\\t\\treturn mip;\\n\\t}\\n\\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\\n\\t\\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\\n\\t\\tfloat mipF = fract( mip );\\n\\t\\tfloat mipInt = floor( mip );\\n\\t\\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\\n\\t\\tif ( mipF == 0.0 ) {\\n\\t\\t\\treturn vec4( color0, 1.0 );\\n\\t\\t} else {\\n\\t\\t\\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\\n\\t\\t\\treturn vec4( mix( color0, color1, mipF ), 1.0 );\\n\\t\\t}\\n\\t}\\n#endif\";\n\nvar defaultnormal_vertex = \"vec3 transformedNormal = objectNormal;\\n#ifdef USE_INSTANCING\\n\\tmat3 m = mat3( instanceMatrix );\\n\\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\\n\\ttransformedNormal = m * transformedNormal;\\n#endif\\ntransformedNormal = normalMatrix * transformedNormal;\\n#ifdef FLIP_SIDED\\n\\ttransformedNormal = - transformedNormal;\\n#endif\\n#ifdef USE_TANGENT\\n\\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\\n\\t#ifdef FLIP_SIDED\\n\\t\\ttransformedTangent = - transformedTangent;\\n\\t#endif\\n#endif\";\n\nvar displacementmap_pars_vertex = \"#ifdef USE_DISPLACEMENTMAP\\n\\tuniform sampler2D displacementMap;\\n\\tuniform float displacementScale;\\n\\tuniform float displacementBias;\\n#endif\";\n\nvar displacementmap_vertex = \"#ifdef USE_DISPLACEMENTMAP\\n\\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\\n#endif\";\n\nvar emissivemap_fragment = \"#ifdef USE_EMISSIVEMAP\\n\\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\\n\\ttotalEmissiveRadiance *= emissiveColor.rgb;\\n#endif\";\n\nvar emissivemap_pars_fragment = \"#ifdef USE_EMISSIVEMAP\\n\\tuniform sampler2D emissiveMap;\\n#endif\";\n\nvar encodings_fragment = \"gl_FragColor = linearToOutputTexel( gl_FragColor );\";\n\nvar encodings_pars_fragment = \"vec4 LinearToLinear( in vec4 value ) {\\n\\treturn value;\\n}\\nvec4 LinearTosRGB( in vec4 value ) {\\n\\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\\n}\";\n\nvar envmap_fragment = \"#ifdef USE_ENVMAP\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\tvec3 cameraToFrag;\\n\\t\\tif ( isOrthographic ) {\\n\\t\\t\\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\\n\\t\\t} else {\\n\\t\\t\\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\\n\\t\\t}\\n\\t\\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\\n\\t\\t#else\\n\\t\\t\\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\\n\\t\\t#endif\\n\\t#else\\n\\t\\tvec3 reflectVec = vReflect;\\n\\t#endif\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\\n\\t#else\\n\\t\\tvec4 envColor = vec4( 0.0 );\\n\\t#endif\\n\\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\t\\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\t\\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\t\\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\t#endif\\n#endif\";\n\nvar envmap_common_pars_fragment = \"#ifdef USE_ENVMAP\\n\\tuniform float envMapIntensity;\\n\\tuniform float flipEnvMap;\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tuniform samplerCube envMap;\\n\\t#else\\n\\t\\tuniform sampler2D envMap;\\n\\t#endif\\n\\t\\n#endif\";\n\nvar envmap_pars_fragment = \"#ifdef USE_ENVMAP\\n\\tuniform float reflectivity;\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\t\\t#define ENV_WORLDPOS\\n\\t#endif\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\tvarying vec3 vWorldPosition;\\n\\t\\tuniform float refractionRatio;\\n\\t#else\\n\\t\\tvarying vec3 vReflect;\\n\\t#endif\\n#endif\";\n\nvar envmap_pars_vertex = \"#ifdef USE_ENVMAP\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\\n\\t\\t#define ENV_WORLDPOS\\n\\t#endif\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\t\\n\\t\\tvarying vec3 vWorldPosition;\\n\\t#else\\n\\t\\tvarying vec3 vReflect;\\n\\t\\tuniform float refractionRatio;\\n\\t#endif\\n#endif\";\n\nvar envmap_vertex = \"#ifdef USE_ENVMAP\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\tvWorldPosition = worldPosition.xyz;\\n\\t#else\\n\\t\\tvec3 cameraToVertex;\\n\\t\\tif ( isOrthographic ) {\\n\\t\\t\\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\\n\\t\\t} else {\\n\\t\\t\\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\t\\t}\\n\\t\\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\t\\t#else\\n\\t\\t\\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\t\\t#endif\\n\\t#endif\\n#endif\";\n\nvar fog_vertex = \"#ifdef USE_FOG\\n\\tvFogDepth = - mvPosition.z;\\n#endif\";\n\nvar fog_pars_vertex = \"#ifdef USE_FOG\\n\\tvarying float vFogDepth;\\n#endif\";\n\nvar fog_fragment = \"#ifdef USE_FOG\\n\\t#ifdef FOG_EXP2\\n\\t\\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\\n\\t#else\\n\\t\\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\\n\\t#endif\\n\\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\\n#endif\";\n\nvar fog_pars_fragment = \"#ifdef USE_FOG\\n\\tuniform vec3 fogColor;\\n\\tvarying float vFogDepth;\\n\\t#ifdef FOG_EXP2\\n\\t\\tuniform float fogDensity;\\n\\t#else\\n\\t\\tuniform float fogNear;\\n\\t\\tuniform float fogFar;\\n\\t#endif\\n#endif\";\n\nvar gradientmap_pars_fragment = \"#ifdef USE_GRADIENTMAP\\n\\tuniform sampler2D gradientMap;\\n#endif\\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\\n\\tfloat dotNL = dot( normal, lightDirection );\\n\\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\\n\\t#ifdef USE_GRADIENTMAP\\n\\t\\treturn vec3( texture2D( gradientMap, coord ).r );\\n\\t#else\\n\\t\\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\\n\\t#endif\\n}\";\n\nvar lightmap_fragment = \"#ifdef USE_LIGHTMAP\\n\\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\\n\\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tlightMapIrradiance *= PI;\\n\\t#endif\\n\\treflectedLight.indirectDiffuse += lightMapIrradiance;\\n#endif\";\n\nvar lightmap_pars_fragment = \"#ifdef USE_LIGHTMAP\\n\\tuniform sampler2D lightMap;\\n\\tuniform float lightMapIntensity;\\n#endif\";\n\nvar lights_lambert_vertex = \"vec3 diffuse = vec3( 1.0 );\\nGeometricContext geometry;\\ngeometry.position = mvPosition.xyz;\\ngeometry.normal = normalize( transformedNormal );\\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\\nGeometricContext backGeometry;\\nbackGeometry.position = geometry.position;\\nbackGeometry.normal = -geometry.normal;\\nbackGeometry.viewDir = geometry.viewDir;\\nvLightFront = vec3( 0.0 );\\nvIndirectFront = vec3( 0.0 );\\n#ifdef DOUBLE_SIDED\\n\\tvLightBack = vec3( 0.0 );\\n\\tvIndirectBack = vec3( 0.0 );\\n#endif\\nIncidentLight directLight;\\nfloat dotNL;\\nvec3 directLightColor_Diffuse;\\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\\n#ifdef DOUBLE_SIDED\\n\\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\\n\\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\\n#endif\\n#if NUM_POINT_LIGHTS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if NUM_DIR_LIGHTS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\\t\\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\\n\\t\\t#endif\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\";\n\nvar lights_pars_begin = \"uniform bool receiveShadow;\\nuniform vec3 ambientLightColor;\\nuniform vec3 lightProbe[ 9 ];\\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\\n\\tfloat x = normal.x, y = normal.y, z = normal.z;\\n\\tvec3 result = shCoefficients[ 0 ] * 0.886227;\\n\\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\\n\\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\\n\\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\\n\\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\\n\\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\\n\\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\\n\\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\\n\\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\\n\\treturn result;\\n}\\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\\n\\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\\n\\treturn irradiance;\\n}\\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\\n\\tvec3 irradiance = ambientLightColor;\\n\\treturn irradiance;\\n}\\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\\n\\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\\n\\t\\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\\n\\t\\tif ( cutoffDistance > 0.0 ) {\\n\\t\\t\\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\\n\\t\\t}\\n\\t\\treturn distanceFalloff;\\n\\t#else\\n\\t\\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\\n\\t\\t\\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\\n\\t\\t}\\n\\t\\treturn 1.0;\\n\\t#endif\\n}\\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\\n\\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\\n}\\n#if NUM_DIR_LIGHTS > 0\\n\\tstruct DirectionalLight {\\n\\t\\tvec3 direction;\\n\\t\\tvec3 color;\\n\\t};\\n\\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\\n\\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\\n\\t\\tlight.color = directionalLight.color;\\n\\t\\tlight.direction = directionalLight.direction;\\n\\t\\tlight.visible = true;\\n\\t}\\n#endif\\n#if NUM_POINT_LIGHTS > 0\\n\\tstruct PointLight {\\n\\t\\tvec3 position;\\n\\t\\tvec3 color;\\n\\t\\tfloat distance;\\n\\t\\tfloat decay;\\n\\t};\\n\\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\\n\\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\\n\\t\\tvec3 lVector = pointLight.position - geometry.position;\\n\\t\\tlight.direction = normalize( lVector );\\n\\t\\tfloat lightDistance = length( lVector );\\n\\t\\tlight.color = pointLight.color;\\n\\t\\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\\n\\t\\tlight.visible = ( light.color != vec3( 0.0 ) );\\n\\t}\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\\tstruct SpotLight {\\n\\t\\tvec3 position;\\n\\t\\tvec3 direction;\\n\\t\\tvec3 color;\\n\\t\\tfloat distance;\\n\\t\\tfloat decay;\\n\\t\\tfloat coneCos;\\n\\t\\tfloat penumbraCos;\\n\\t};\\n\\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\\n\\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\\n\\t\\tvec3 lVector = spotLight.position - geometry.position;\\n\\t\\tlight.direction = normalize( lVector );\\n\\t\\tfloat angleCos = dot( light.direction, spotLight.direction );\\n\\t\\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\\n\\t\\tif ( spotAttenuation > 0.0 ) {\\n\\t\\t\\tfloat lightDistance = length( lVector );\\n\\t\\t\\tlight.color = spotLight.color * spotAttenuation;\\n\\t\\t\\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\\n\\t\\t\\tlight.visible = ( light.color != vec3( 0.0 ) );\\n\\t\\t} else {\\n\\t\\t\\tlight.color = vec3( 0.0 );\\n\\t\\t\\tlight.visible = false;\\n\\t\\t}\\n\\t}\\n#endif\\n#if NUM_RECT_AREA_LIGHTS > 0\\n\\tstruct RectAreaLight {\\n\\t\\tvec3 color;\\n\\t\\tvec3 position;\\n\\t\\tvec3 halfWidth;\\n\\t\\tvec3 halfHeight;\\n\\t};\\n\\tuniform sampler2D ltc_1;\\tuniform sampler2D ltc_2;\\n\\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\\tstruct HemisphereLight {\\n\\t\\tvec3 direction;\\n\\t\\tvec3 skyColor;\\n\\t\\tvec3 groundColor;\\n\\t};\\n\\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\\n\\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\\n\\t\\tfloat dotNL = dot( normal, hemiLight.direction );\\n\\t\\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\\n\\t\\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\\n\\t\\treturn irradiance;\\n\\t}\\n#endif\";\n\nvar envmap_physical_pars_fragment = \"#if defined( USE_ENVMAP )\\n\\t#ifdef ENVMAP_MODE_REFRACTION\\n\\t\\tuniform float refractionRatio;\\n\\t#endif\\n\\tvec3 getIBLIrradiance( const in vec3 normal ) {\\n\\t\\t#if defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\t\\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\t\\t\\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\\n\\t\\t\\treturn PI * envMapColor.rgb * envMapIntensity;\\n\\t\\t#else\\n\\t\\t\\treturn vec3( 0.0 );\\n\\t\\t#endif\\n\\t}\\n\\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\\n\\t\\t#if defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\t\\tvec3 reflectVec;\\n\\t\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\t\\treflectVec = reflect( - viewDir, normal );\\n\\t\\t\\t\\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\\n\\t\\t\\t#else\\n\\t\\t\\t\\treflectVec = refract( - viewDir, normal, refractionRatio );\\n\\t\\t\\t#endif\\n\\t\\t\\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\\n\\t\\t\\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\\n\\t\\t\\treturn envMapColor.rgb * envMapIntensity;\\n\\t\\t#else\\n\\t\\t\\treturn vec3( 0.0 );\\n\\t\\t#endif\\n\\t}\\n#endif\";\n\nvar lights_toon_fragment = \"ToonMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb;\";\n\nvar lights_toon_pars_fragment = \"varying vec3 vViewPosition;\\nstruct ToonMaterial {\\n\\tvec3 diffuseColor;\\n};\\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_Toon\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_Toon\\n#define Material_LightProbeLOD( material )\\t(0)\";\n\nvar lights_phong_fragment = \"BlinnPhongMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb;\\nmaterial.specularColor = specular;\\nmaterial.specularShininess = shininess;\\nmaterial.specularStrength = specularStrength;\";\n\nvar lights_phong_pars_fragment = \"varying vec3 vViewPosition;\\nstruct BlinnPhongMaterial {\\n\\tvec3 diffuseColor;\\n\\tvec3 specularColor;\\n\\tfloat specularShininess;\\n\\tfloat specularStrength;\\n};\\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\\tvec3 irradiance = dotNL * directLight.color;\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n\\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\\n}\\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_BlinnPhong\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_BlinnPhong\\n#define Material_LightProbeLOD( material )\\t(0)\";\n\nvar lights_physical_fragment = \"PhysicalMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\\nmaterial.roughness = min( material.roughness, 1.0 );\\n#ifdef IOR\\n\\t#ifdef SPECULAR\\n\\t\\tfloat specularIntensityFactor = specularIntensity;\\n\\t\\tvec3 specularColorFactor = specularColor;\\n\\t\\t#ifdef USE_SPECULARINTENSITYMAP\\n\\t\\t\\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\\n\\t\\t#endif\\n\\t\\t#ifdef USE_SPECULARCOLORMAP\\n\\t\\t\\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\\n\\t\\t#endif\\n\\t\\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\\n\\t#else\\n\\t\\tfloat specularIntensityFactor = 1.0;\\n\\t\\tvec3 specularColorFactor = vec3( 1.0 );\\n\\t\\tmaterial.specularF90 = 1.0;\\n\\t#endif\\n\\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\\n#else\\n\\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\\n\\tmaterial.specularF90 = 1.0;\\n#endif\\n#ifdef USE_CLEARCOAT\\n\\tmaterial.clearcoat = clearcoat;\\n\\tmaterial.clearcoatRoughness = clearcoatRoughness;\\n\\tmaterial.clearcoatF0 = vec3( 0.04 );\\n\\tmaterial.clearcoatF90 = 1.0;\\n\\t#ifdef USE_CLEARCOATMAP\\n\\t\\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\\n\\t#endif\\n\\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\\n\\t\\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\\n\\t#endif\\n\\tmaterial.clearcoat = saturate( material.clearcoat );\\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\\n\\tmaterial.clearcoatRoughness += geometryRoughness;\\n\\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\\n#endif\\n#ifdef USE_SHEEN\\n\\tmaterial.sheenColor = sheenColor;\\n\\t#ifdef USE_SHEENCOLORMAP\\n\\t\\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\\n\\t#endif\\n\\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\\n\\t#ifdef USE_SHEENROUGHNESSMAP\\n\\t\\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\\n\\t#endif\\n#endif\";\n\nvar lights_physical_pars_fragment = \"struct PhysicalMaterial {\\n\\tvec3 diffuseColor;\\n\\tfloat roughness;\\n\\tvec3 specularColor;\\n\\tfloat specularF90;\\n\\t#ifdef USE_CLEARCOAT\\n\\t\\tfloat clearcoat;\\n\\t\\tfloat clearcoatRoughness;\\n\\t\\tvec3 clearcoatF0;\\n\\t\\tfloat clearcoatF90;\\n\\t#endif\\n\\t#ifdef USE_SHEEN\\n\\t\\tvec3 sheenColor;\\n\\t\\tfloat sheenRoughness;\\n\\t#endif\\n};\\nvec3 clearcoatSpecular = vec3( 0.0 );\\nvec3 sheenSpecular = vec3( 0.0 );\\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\\n\\tfloat dotNV = saturate( dot( normal, viewDir ) );\\n\\tfloat r2 = roughness * roughness;\\n\\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\\n\\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\\n\\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\\n\\treturn saturate( DG * RECIPROCAL_PI );\\n}\\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\\n\\tfloat dotNV = saturate( dot( normal, viewDir ) );\\n\\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\\n\\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\\n\\tvec4 r = roughness * c0 + c1;\\n\\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\\n\\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\\n\\treturn fab;\\n}\\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\\n\\tvec2 fab = DFGApprox( normal, viewDir, roughness );\\n\\treturn specularColor * fab.x + specularF90 * fab.y;\\n}\\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\\n\\tvec2 fab = DFGApprox( normal, viewDir, roughness );\\n\\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\\n\\tfloat Ess = fab.x + fab.y;\\n\\tfloat Ems = 1.0 - Ess;\\n\\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\\n\\tsingleScatter += FssEss;\\n\\tmultiScatter += Fms * Ems;\\n}\\n#if NUM_RECT_AREA_LIGHTS > 0\\n\\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\t\\tvec3 normal = geometry.normal;\\n\\t\\tvec3 viewDir = geometry.viewDir;\\n\\t\\tvec3 position = geometry.position;\\n\\t\\tvec3 lightPos = rectAreaLight.position;\\n\\t\\tvec3 halfWidth = rectAreaLight.halfWidth;\\n\\t\\tvec3 halfHeight = rectAreaLight.halfHeight;\\n\\t\\tvec3 lightColor = rectAreaLight.color;\\n\\t\\tfloat roughness = material.roughness;\\n\\t\\tvec3 rectCoords[ 4 ];\\n\\t\\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\\t\\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\\n\\t\\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\\n\\t\\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\\n\\t\\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\\n\\t\\tvec4 t1 = texture2D( ltc_1, uv );\\n\\t\\tvec4 t2 = texture2D( ltc_2, uv );\\n\\t\\tmat3 mInv = mat3(\\n\\t\\t\\tvec3( t1.x, 0, t1.y ),\\n\\t\\t\\tvec3(    0, 1,    0 ),\\n\\t\\t\\tvec3( t1.z, 0, t1.w )\\n\\t\\t);\\n\\t\\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\\n\\t\\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\\n\\t\\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\\n\\t}\\n#endif\\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\\tvec3 irradiance = dotNL * directLight.color;\\n\\t#ifdef USE_CLEARCOAT\\n\\t\\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\\n\\t\\tvec3 ccIrradiance = dotNLcc * directLight.color;\\n\\t\\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\\n\\t#endif\\n\\t#ifdef USE_SHEEN\\n\\t\\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\\n\\t#endif\\n\\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\\n\\t#ifdef USE_CLEARCOAT\\n\\t\\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\\n\\t#endif\\n\\t#ifdef USE_SHEEN\\n\\t\\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\\n\\t#endif\\n\\tvec3 singleScattering = vec3( 0.0 );\\n\\tvec3 multiScattering = vec3( 0.0 );\\n\\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\\n\\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\\n\\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\\n\\treflectedLight.indirectSpecular += radiance * singleScattering;\\n\\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\\n\\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_Physical\\n#define RE_Direct_RectArea\\t\\tRE_Direct_RectArea_Physical\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_Physical\\n#define RE_IndirectSpecular\\t\\tRE_IndirectSpecular_Physical\\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\\n\\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\\n}\";\n\nvar lights_fragment_begin = \"\\nGeometricContext geometry;\\ngeometry.position = - vViewPosition;\\ngeometry.normal = normal;\\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\\n#ifdef USE_CLEARCOAT\\n\\tgeometry.clearcoatNormal = clearcoatNormal;\\n#endif\\nIncidentLight directLight;\\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tPointLight pointLight;\\n\\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\\n\\tPointLightShadow pointLightShadow;\\n\\t#endif\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tpointLight = pointLights[ i ];\\n\\t\\tgetPointLightInfo( pointLight, geometry, directLight );\\n\\t\\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\\n\\t\\tpointLightShadow = pointLightShadows[ i ];\\n\\t\\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tSpotLight spotLight;\\n\\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\\n\\tSpotLightShadow spotLightShadow;\\n\\t#endif\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tspotLight = spotLights[ i ];\\n\\t\\tgetSpotLightInfo( spotLight, geometry, directLight );\\n\\t\\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\\n\\t\\tspotLightShadow = spotLightShadows[ i ];\\n\\t\\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tDirectionalLight directionalLight;\\n\\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\\n\\tDirectionalLightShadow directionalLightShadow;\\n\\t#endif\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tdirectionalLight = directionalLights[ i ];\\n\\t\\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\\n\\t\\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\\n\\t\\tdirectionalLightShadow = directionalLightShadows[ i ];\\n\\t\\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\\n\\tRectAreaLight rectAreaLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\\n\\t\\trectAreaLight = rectAreaLights[ i ];\\n\\t\\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if defined( RE_IndirectDiffuse )\\n\\tvec3 iblIrradiance = vec3( 0.0 );\\n\\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\\n\\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\\n\\t#if ( NUM_HEMI_LIGHTS > 0 )\\n\\t\\t#pragma unroll_loop_start\\n\\t\\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\\t\\t\\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\\n\\t\\t}\\n\\t\\t#pragma unroll_loop_end\\n\\t#endif\\n#endif\\n#if defined( RE_IndirectSpecular )\\n\\tvec3 radiance = vec3( 0.0 );\\n\\tvec3 clearcoatRadiance = vec3( 0.0 );\\n#endif\";\n\nvar lights_fragment_maps = \"#if defined( RE_IndirectDiffuse )\\n\\t#ifdef USE_LIGHTMAP\\n\\t\\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\\n\\t\\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\\n\\t\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\t\\tlightMapIrradiance *= PI;\\n\\t\\t#endif\\n\\t\\tirradiance += lightMapIrradiance;\\n\\t#endif\\n\\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\tiblIrradiance += getIBLIrradiance( geometry.normal );\\n\\t#endif\\n#endif\\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\\n\\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\\n\\t#ifdef USE_CLEARCOAT\\n\\t\\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\\n\\t#endif\\n#endif\";\n\nvar lights_fragment_end = \"#if defined( RE_IndirectDiffuse )\\n\\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\\n#endif\\n#if defined( RE_IndirectSpecular )\\n\\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\\n#endif\";\n\nvar logdepthbuf_fragment = \"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\\n\\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\\n#endif\";\n\nvar logdepthbuf_pars_fragment = \"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\\n\\tuniform float logDepthBufFC;\\n\\tvarying float vFragDepth;\\n\\tvarying float vIsPerspective;\\n#endif\";\n\nvar logdepthbuf_pars_vertex = \"#ifdef USE_LOGDEPTHBUF\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\t\\tvarying float vFragDepth;\\n\\t\\tvarying float vIsPerspective;\\n\\t#else\\n\\t\\tuniform float logDepthBufFC;\\n\\t#endif\\n#endif\";\n\nvar logdepthbuf_vertex = \"#ifdef USE_LOGDEPTHBUF\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\t\\tvFragDepth = 1.0 + gl_Position.w;\\n\\t\\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\\n\\t#else\\n\\t\\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\\n\\t\\t\\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\\n\\t\\t\\tgl_Position.z *= gl_Position.w;\\n\\t\\t}\\n\\t#endif\\n#endif\";\n\nvar map_fragment = \"#ifdef USE_MAP\\n\\tvec4 sampledDiffuseColor = texture2D( map, vUv );\\n\\t#ifdef DECODE_VIDEO_TEXTURE\\n\\t\\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\\n\\t#endif\\n\\tdiffuseColor *= sampledDiffuseColor;\\n#endif\";\n\nvar map_pars_fragment = \"#ifdef USE_MAP\\n\\tuniform sampler2D map;\\n#endif\";\n\nvar map_particle_fragment = \"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\\n\\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\\n#endif\\n#ifdef USE_MAP\\n\\tdiffuseColor *= texture2D( map, uv );\\n#endif\\n#ifdef USE_ALPHAMAP\\n\\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\\n#endif\";\n\nvar map_particle_pars_fragment = \"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\\n\\tuniform mat3 uvTransform;\\n#endif\\n#ifdef USE_MAP\\n\\tuniform sampler2D map;\\n#endif\\n#ifdef USE_ALPHAMAP\\n\\tuniform sampler2D alphaMap;\\n#endif\";\n\nvar metalnessmap_fragment = \"float metalnessFactor = metalness;\\n#ifdef USE_METALNESSMAP\\n\\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\\n\\tmetalnessFactor *= texelMetalness.b;\\n#endif\";\n\nvar metalnessmap_pars_fragment = \"#ifdef USE_METALNESSMAP\\n\\tuniform sampler2D metalnessMap;\\n#endif\";\n\nvar morphnormal_vertex = \"#ifdef USE_MORPHNORMALS\\n\\tobjectNormal *= morphTargetBaseInfluence;\\n\\t#ifdef MORPHTARGETS_TEXTURE\\n\\t\\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\\n\\t\\t\\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\\n\\t\\t}\\n\\t#else\\n\\t\\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\\n\\t\\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\\n\\t\\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\\n\\t\\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\\n\\t#endif\\n#endif\";\n\nvar morphtarget_pars_vertex = \"#ifdef USE_MORPHTARGETS\\n\\tuniform float morphTargetBaseInfluence;\\n\\t#ifdef MORPHTARGETS_TEXTURE\\n\\t\\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\\n\\t\\tuniform sampler2DArray morphTargetsTexture;\\n\\t\\tuniform vec2 morphTargetsTextureSize;\\n\\t\\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\\n\\t\\t\\tfloat texelIndex = float( vertexIndex * stride + offset );\\n\\t\\t\\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\\n\\t\\t\\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\\n\\t\\t\\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\\n\\t\\t\\treturn texture( morphTargetsTexture, morphUV ).xyz;\\n\\t\\t}\\n\\t#else\\n\\t\\t#ifndef USE_MORPHNORMALS\\n\\t\\t\\tuniform float morphTargetInfluences[ 8 ];\\n\\t\\t#else\\n\\t\\t\\tuniform float morphTargetInfluences[ 4 ];\\n\\t\\t#endif\\n\\t#endif\\n#endif\";\n\nvar morphtarget_vertex = \"#ifdef USE_MORPHTARGETS\\n\\ttransformed *= morphTargetBaseInfluence;\\n\\t#ifdef MORPHTARGETS_TEXTURE\\n\\t\\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\\n\\t\\t\\t#ifndef USE_MORPHNORMALS\\n\\t\\t\\t\\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\\n\\t\\t\\t#else\\n\\t\\t\\t\\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\\n\\t\\t\\t#endif\\n\\t\\t}\\n\\t#else\\n\\t\\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\\n\\t\\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\\n\\t\\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\\n\\t\\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\\n\\t\\t#ifndef USE_MORPHNORMALS\\n\\t\\t\\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\\n\\t\\t\\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\\n\\t\\t\\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\\n\\t\\t\\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\\n\\t\\t#endif\\n\\t#endif\\n#endif\";\n\nvar normal_fragment_begin = \"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\\n#ifdef FLAT_SHADED\\n\\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\\n\\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\\n\\tvec3 normal = normalize( cross( fdx, fdy ) );\\n#else\\n\\tvec3 normal = normalize( vNormal );\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\tnormal = normal * faceDirection;\\n\\t#endif\\n\\t#ifdef USE_TANGENT\\n\\t\\tvec3 tangent = normalize( vTangent );\\n\\t\\tvec3 bitangent = normalize( vBitangent );\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\ttangent = tangent * faceDirection;\\n\\t\\t\\tbitangent = bitangent * faceDirection;\\n\\t\\t#endif\\n\\t\\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\\n\\t\\t\\tmat3 vTBN = mat3( tangent, bitangent, normal );\\n\\t\\t#endif\\n\\t#endif\\n#endif\\nvec3 geometryNormal = normal;\";\n\nvar normal_fragment_maps = \"#ifdef OBJECTSPACE_NORMALMAP\\n\\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\\t#ifdef FLIP_SIDED\\n\\t\\tnormal = - normal;\\n\\t#endif\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\tnormal = normal * faceDirection;\\n\\t#endif\\n\\tnormal = normalize( normalMatrix * normal );\\n#elif defined( TANGENTSPACE_NORMALMAP )\\n\\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\\tmapN.xy *= normalScale;\\n\\t#ifdef USE_TANGENT\\n\\t\\tnormal = normalize( vTBN * mapN );\\n\\t#else\\n\\t\\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\\n\\t#endif\\n#elif defined( USE_BUMPMAP )\\n\\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\\n#endif\";\n\nvar normal_pars_fragment = \"#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n\\t#ifdef USE_TANGENT\\n\\t\\tvarying vec3 vTangent;\\n\\t\\tvarying vec3 vBitangent;\\n\\t#endif\\n#endif\";\n\nvar normal_pars_vertex = \"#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n\\t#ifdef USE_TANGENT\\n\\t\\tvarying vec3 vTangent;\\n\\t\\tvarying vec3 vBitangent;\\n\\t#endif\\n#endif\";\n\nvar normal_vertex = \"#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n\\t#ifdef USE_TANGENT\\n\\t\\tvTangent = normalize( transformedTangent );\\n\\t\\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\\n\\t#endif\\n#endif\";\n\nvar normalmap_pars_fragment = \"#ifdef USE_NORMALMAP\\n\\tuniform sampler2D normalMap;\\n\\tuniform vec2 normalScale;\\n#endif\\n#ifdef OBJECTSPACE_NORMALMAP\\n\\tuniform mat3 normalMatrix;\\n#endif\\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\\n\\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\\n\\t\\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\\n\\t\\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\\n\\t\\tvec2 st0 = dFdx( vUv.st );\\n\\t\\tvec2 st1 = dFdy( vUv.st );\\n\\t\\tvec3 N = surf_norm;\\n\\t\\tvec3 q1perp = cross( q1, N );\\n\\t\\tvec3 q0perp = cross( N, q0 );\\n\\t\\tvec3 T = q1perp * st0.x + q0perp * st1.x;\\n\\t\\tvec3 B = q1perp * st0.y + q0perp * st1.y;\\n\\t\\tfloat det = max( dot( T, T ), dot( B, B ) );\\n\\t\\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\\n\\t\\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\\n\\t}\\n#endif\";\n\nvar clearcoat_normal_fragment_begin = \"#ifdef USE_CLEARCOAT\\n\\tvec3 clearcoatNormal = geometryNormal;\\n#endif\";\n\nvar clearcoat_normal_fragment_maps = \"#ifdef USE_CLEARCOAT_NORMALMAP\\n\\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\\n\\tclearcoatMapN.xy *= clearcoatNormalScale;\\n\\t#ifdef USE_TANGENT\\n\\t\\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\\n\\t#else\\n\\t\\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\\n\\t#endif\\n#endif\";\n\nvar clearcoat_pars_fragment = \"#ifdef USE_CLEARCOATMAP\\n\\tuniform sampler2D clearcoatMap;\\n#endif\\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\\n\\tuniform sampler2D clearcoatRoughnessMap;\\n#endif\\n#ifdef USE_CLEARCOAT_NORMALMAP\\n\\tuniform sampler2D clearcoatNormalMap;\\n\\tuniform vec2 clearcoatNormalScale;\\n#endif\";\n\nvar output_fragment = \"#ifdef OPAQUE\\ndiffuseColor.a = 1.0;\\n#endif\\n#ifdef USE_TRANSMISSION\\ndiffuseColor.a *= transmissionAlpha + 0.1;\\n#endif\\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );\";\n\nvar packing = \"vec3 packNormalToRGB( const in vec3 normal ) {\\n\\treturn normalize( normal ) * 0.5 + 0.5;\\n}\\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\\n\\treturn 2.0 * rgb.xyz - 1.0;\\n}\\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\\nconst float ShiftRight8 = 1. / 256.;\\nvec4 packDepthToRGBA( const in float v ) {\\n\\tvec4 r = vec4( fract( v * PackFactors ), v );\\n\\tr.yzw -= r.xyz * ShiftRight8;\\treturn r * PackUpscale;\\n}\\nfloat unpackRGBAToDepth( const in vec4 v ) {\\n\\treturn dot( v, UnpackFactors );\\n}\\nvec4 pack2HalfToRGBA( vec2 v ) {\\n\\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\\n\\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\\n}\\nvec2 unpackRGBATo2Half( vec4 v ) {\\n\\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\\n}\\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\\n\\treturn ( viewZ + near ) / ( near - far );\\n}\\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\\n\\treturn linearClipZ * ( near - far ) - near;\\n}\\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\\n\\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\\n}\\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\\n\\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\\n}\";\n\nvar premultiplied_alpha_fragment = \"#ifdef PREMULTIPLIED_ALPHA\\n\\tgl_FragColor.rgb *= gl_FragColor.a;\\n#endif\";\n\nvar project_vertex = \"vec4 mvPosition = vec4( transformed, 1.0 );\\n#ifdef USE_INSTANCING\\n\\tmvPosition = instanceMatrix * mvPosition;\\n#endif\\nmvPosition = modelViewMatrix * mvPosition;\\ngl_Position = projectionMatrix * mvPosition;\";\n\nvar dithering_fragment = \"#ifdef DITHERING\\n\\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\\n#endif\";\n\nvar dithering_pars_fragment = \"#ifdef DITHERING\\n\\tvec3 dithering( vec3 color ) {\\n\\t\\tfloat grid_position = rand( gl_FragCoord.xy );\\n\\t\\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\\n\\t\\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\\n\\t\\treturn color + dither_shift_RGB;\\n\\t}\\n#endif\";\n\nvar roughnessmap_fragment = \"float roughnessFactor = roughness;\\n#ifdef USE_ROUGHNESSMAP\\n\\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\\n\\troughnessFactor *= texelRoughness.g;\\n#endif\";\n\nvar roughnessmap_pars_fragment = \"#ifdef USE_ROUGHNESSMAP\\n\\tuniform sampler2D roughnessMap;\\n#endif\";\n\nvar shadowmap_pars_fragment = \"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\t\\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t\\tstruct DirectionalLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t};\\n\\t\\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\t\\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t\\tstruct SpotLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t};\\n\\t\\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\t\\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t\\tstruct PointLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t\\tfloat shadowCameraNear;\\n\\t\\t\\tfloat shadowCameraFar;\\n\\t\\t};\\n\\t\\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t#endif\\n\\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\\n\\t\\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\\n\\t}\\n\\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\\n\\t\\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\\n\\t}\\n\\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\\n\\t\\tfloat occlusion = 1.0;\\n\\t\\tvec2 distribution = texture2DDistribution( shadow, uv );\\n\\t\\tfloat hard_shadow = step( compare , distribution.x );\\n\\t\\tif (hard_shadow != 1.0 ) {\\n\\t\\t\\tfloat distance = compare - distribution.x ;\\n\\t\\t\\tfloat variance = max( 0.00000, distribution.y * distribution.y );\\n\\t\\t\\tfloat softness_probability = variance / (variance + distance * distance );\\t\\t\\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\\t\\t\\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\\n\\t\\t}\\n\\t\\treturn occlusion;\\n\\t}\\n\\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\\n\\t\\tfloat shadow = 1.0;\\n\\t\\tshadowCoord.xyz /= shadowCoord.w;\\n\\t\\tshadowCoord.z += shadowBias;\\n\\t\\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\\t\\tbool inFrustum = all( inFrustumVec );\\n\\t\\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\\t\\tbool frustumTest = all( frustumTestVec );\\n\\t\\tif ( frustumTest ) {\\n\\t\\t#if defined( SHADOWMAP_TYPE_PCF )\\n\\t\\t\\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\n\\t\\t\\tfloat dx0 = - texelSize.x * shadowRadius;\\n\\t\\t\\tfloat dy0 = - texelSize.y * shadowRadius;\\n\\t\\t\\tfloat dx1 = + texelSize.x * shadowRadius;\\n\\t\\t\\tfloat dy1 = + texelSize.y * shadowRadius;\\n\\t\\t\\tfloat dx2 = dx0 / 2.0;\\n\\t\\t\\tfloat dy2 = dy0 / 2.0;\\n\\t\\t\\tfloat dx3 = dx1 / 2.0;\\n\\t\\t\\tfloat dy3 = dy1 / 2.0;\\n\\t\\t\\tshadow = (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\\n\\t\\t\\t) * ( 1.0 / 17.0 );\\n\\t\\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\t\\t\\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\n\\t\\t\\tfloat dx = texelSize.x;\\n\\t\\t\\tfloat dy = texelSize.y;\\n\\t\\t\\tvec2 uv = shadowCoord.xy;\\n\\t\\t\\tvec2 f = fract( uv * shadowMapSize + 0.5 );\\n\\t\\t\\tuv -= f * texelSize;\\n\\t\\t\\tshadow = (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.x ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.x ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.y ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.y ) +\\n\\t\\t\\t\\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t\\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t\\t  f.x ),\\n\\t\\t\\t\\t\\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t\\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t\\t  f.x ),\\n\\t\\t\\t\\t\\t f.y )\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\n\\t\\t#elif defined( SHADOWMAP_TYPE_VSM )\\n\\t\\t\\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\\n\\t\\t#else\\n\\t\\t\\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\\n\\t\\t#endif\\n\\t\\t}\\n\\t\\treturn shadow;\\n\\t}\\n\\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\\n\\t\\tvec3 absV = abs( v );\\n\\t\\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\\n\\t\\tabsV *= scaleToCube;\\n\\t\\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\\n\\t\\tvec2 planar = v.xy;\\n\\t\\tfloat almostATexel = 1.5 * texelSizeY;\\n\\t\\tfloat almostOne = 1.0 - almostATexel;\\n\\t\\tif ( absV.z >= almostOne ) {\\n\\t\\t\\tif ( v.z > 0.0 )\\n\\t\\t\\t\\tplanar.x = 4.0 - v.x;\\n\\t\\t} else if ( absV.x >= almostOne ) {\\n\\t\\t\\tfloat signX = sign( v.x );\\n\\t\\t\\tplanar.x = v.z * signX + 2.0 * signX;\\n\\t\\t} else if ( absV.y >= almostOne ) {\\n\\t\\t\\tfloat signY = sign( v.y );\\n\\t\\t\\tplanar.x = v.x + 2.0 * signY + 2.0;\\n\\t\\t\\tplanar.y = v.z * signY - 2.0;\\n\\t\\t}\\n\\t\\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\\n\\t}\\n\\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\\n\\t\\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\\n\\t\\tvec3 lightToPosition = shadowCoord.xyz;\\n\\t\\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\\t\\tdp += shadowBias;\\n\\t\\tvec3 bd3D = normalize( lightToPosition );\\n\\t\\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\\n\\t\\t\\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\\n\\t\\t\\treturn (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\n\\t\\t#else\\n\\t\\t\\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\\n\\t\\t#endif\\n\\t}\\n#endif\";\n\nvar shadowmap_pars_vertex = \"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\t\\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t\\tstruct DirectionalLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t};\\n\\t\\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\t\\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t\\tstruct SpotLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t};\\n\\t\\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\t\\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t\\tstruct PointLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t\\tfloat shadowCameraNear;\\n\\t\\t\\tfloat shadowCameraFar;\\n\\t\\t};\\n\\t\\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t#endif\\n#endif\";\n\nvar shadowmap_vertex = \"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\\n\\t\\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\\n\\t\\tvec4 shadowWorldPosition;\\n\\t#endif\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\\n\\t\\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\\n\\t\\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\\n\\t\\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n#endif\";\n\nvar shadowmask_pars_fragment = \"float getShadowMask() {\\n\\tfloat shadow = 1.0;\\n\\t#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\tDirectionalLightShadow directionalLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tdirectionalLight = directionalLightShadows[ i ];\\n\\t\\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\tSpotLightShadow spotLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tspotLight = spotLightShadows[ i ];\\n\\t\\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\tPointLightShadow pointLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tpointLight = pointLightShadows[ i ];\\n\\t\\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#endif\\n\\treturn shadow;\\n}\";\n\nvar skinbase_vertex = \"#ifdef USE_SKINNING\\n\\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n#endif\";\n\nvar skinning_pars_vertex = \"#ifdef USE_SKINNING\\n\\tuniform mat4 bindMatrix;\\n\\tuniform mat4 bindMatrixInverse;\\n\\t#ifdef BONE_TEXTURE\\n\\t\\tuniform highp sampler2D boneTexture;\\n\\t\\tuniform int boneTextureSize;\\n\\t\\tmat4 getBoneMatrix( const in float i ) {\\n\\t\\t\\tfloat j = i * 4.0;\\n\\t\\t\\tfloat x = mod( j, float( boneTextureSize ) );\\n\\t\\t\\tfloat y = floor( j / float( boneTextureSize ) );\\n\\t\\t\\tfloat dx = 1.0 / float( boneTextureSize );\\n\\t\\t\\tfloat dy = 1.0 / float( boneTextureSize );\\n\\t\\t\\ty = dy * ( y + 0.5 );\\n\\t\\t\\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\\t\\t\\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\\t\\t\\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\\t\\t\\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\t\\t\\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\t\\t\\treturn bone;\\n\\t\\t}\\n\\t#else\\n\\t\\tuniform mat4 boneMatrices[ MAX_BONES ];\\n\\t\\tmat4 getBoneMatrix( const in float i ) {\\n\\t\\t\\tmat4 bone = boneMatrices[ int(i) ];\\n\\t\\t\\treturn bone;\\n\\t\\t}\\n\\t#endif\\n#endif\";\n\nvar skinning_vertex = \"#ifdef USE_SKINNING\\n\\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\\n\\tvec4 skinned = vec4( 0.0 );\\n\\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\\ttransformed = ( bindMatrixInverse * skinned ).xyz;\\n#endif\";\n\nvar skinnormal_vertex = \"#ifdef USE_SKINNING\\n\\tmat4 skinMatrix = mat4( 0.0 );\\n\\tskinMatrix += skinWeight.x * boneMatX;\\n\\tskinMatrix += skinWeight.y * boneMatY;\\n\\tskinMatrix += skinWeight.z * boneMatZ;\\n\\tskinMatrix += skinWeight.w * boneMatW;\\n\\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\\n\\t#ifdef USE_TANGENT\\n\\t\\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\\n\\t#endif\\n#endif\";\n\nvar specularmap_fragment = \"float specularStrength;\\n#ifdef USE_SPECULARMAP\\n\\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\\tspecularStrength = texelSpecular.r;\\n#else\\n\\tspecularStrength = 1.0;\\n#endif\";\n\nvar specularmap_pars_fragment = \"#ifdef USE_SPECULARMAP\\n\\tuniform sampler2D specularMap;\\n#endif\";\n\nvar tonemapping_fragment = \"#if defined( TONE_MAPPING )\\n\\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\\n#endif\";\n\nvar tonemapping_pars_fragment = \"#ifndef saturate\\n#define saturate( a ) clamp( a, 0.0, 1.0 )\\n#endif\\nuniform float toneMappingExposure;\\nvec3 LinearToneMapping( vec3 color ) {\\n\\treturn toneMappingExposure * color;\\n}\\nvec3 ReinhardToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\treturn saturate( color / ( vec3( 1.0 ) + color ) );\\n}\\nvec3 OptimizedCineonToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\tcolor = max( vec3( 0.0 ), color - 0.004 );\\n\\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\\n}\\nvec3 RRTAndODTFit( vec3 v ) {\\n\\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\\n\\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\\n\\treturn a / b;\\n}\\nvec3 ACESFilmicToneMapping( vec3 color ) {\\n\\tconst mat3 ACESInputMat = mat3(\\n\\t\\tvec3( 0.59719, 0.07600, 0.02840 ),\\t\\tvec3( 0.35458, 0.90834, 0.13383 ),\\n\\t\\tvec3( 0.04823, 0.01566, 0.83777 )\\n\\t);\\n\\tconst mat3 ACESOutputMat = mat3(\\n\\t\\tvec3(  1.60475, -0.10208, -0.00327 ),\\t\\tvec3( -0.53108,  1.10813, -0.07276 ),\\n\\t\\tvec3( -0.07367, -0.00605,  1.07602 )\\n\\t);\\n\\tcolor *= toneMappingExposure / 0.6;\\n\\tcolor = ACESInputMat * color;\\n\\tcolor = RRTAndODTFit( color );\\n\\tcolor = ACESOutputMat * color;\\n\\treturn saturate( color );\\n}\\nvec3 CustomToneMapping( vec3 color ) { return color; }\";\n\nvar transmission_fragment = \"#ifdef USE_TRANSMISSION\\n\\tfloat transmissionAlpha = 1.0;\\n\\tfloat transmissionFactor = transmission;\\n\\tfloat thicknessFactor = thickness;\\n\\t#ifdef USE_TRANSMISSIONMAP\\n\\t\\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\\n\\t#endif\\n\\t#ifdef USE_THICKNESSMAP\\n\\t\\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\\n\\t#endif\\n\\tvec3 pos = vWorldPosition;\\n\\tvec3 v = normalize( cameraPosition - pos );\\n\\tvec3 n = inverseTransformDirection( normal, viewMatrix );\\n\\tvec4 transmission = getIBLVolumeRefraction(\\n\\t\\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\\n\\t\\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\\n\\t\\tattenuationColor, attenuationDistance );\\n\\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\\n\\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\\n#endif\";\n\nvar transmission_pars_fragment = \"#ifdef USE_TRANSMISSION\\n\\tuniform float transmission;\\n\\tuniform float thickness;\\n\\tuniform float attenuationDistance;\\n\\tuniform vec3 attenuationColor;\\n\\t#ifdef USE_TRANSMISSIONMAP\\n\\t\\tuniform sampler2D transmissionMap;\\n\\t#endif\\n\\t#ifdef USE_THICKNESSMAP\\n\\t\\tuniform sampler2D thicknessMap;\\n\\t#endif\\n\\tuniform vec2 transmissionSamplerSize;\\n\\tuniform sampler2D transmissionSamplerMap;\\n\\tuniform mat4 modelMatrix;\\n\\tuniform mat4 projectionMatrix;\\n\\tvarying vec3 vWorldPosition;\\n\\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\\n\\t\\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\\n\\t\\tvec3 modelScale;\\n\\t\\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\\n\\t\\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\\n\\t\\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\\n\\t\\treturn normalize( refractionVector ) * thickness * modelScale;\\n\\t}\\n\\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\\n\\t\\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\\n\\t}\\n\\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\\n\\t\\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\\n\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\\n\\t\\t#else\\n\\t\\t\\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\\n\\t\\t#endif\\n\\t}\\n\\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\\n\\t\\tif ( attenuationDistance == 0.0 ) {\\n\\t\\t\\treturn radiance;\\n\\t\\t} else {\\n\\t\\t\\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\\n\\t\\t\\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\\t\\t\\treturn transmittance * radiance;\\n\\t\\t}\\n\\t}\\n\\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\\n\\t\\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\\n\\t\\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\\n\\t\\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\\n\\t\\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\\n\\t\\tvec3 refractedRayExit = position + transmissionRay;\\n\\t\\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\\n\\t\\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\\n\\t\\trefractionCoords += 1.0;\\n\\t\\trefractionCoords /= 2.0;\\n\\t\\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\\n\\t\\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\\n\\t\\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\\n\\t\\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\\n\\t}\\n#endif\";\n\nvar uv_pars_fragment = \"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\\n\\tvarying vec2 vUv;\\n#endif\";\n\nvar uv_pars_vertex = \"#ifdef USE_UV\\n\\t#ifdef UVS_VERTEX_ONLY\\n\\t\\tvec2 vUv;\\n\\t#else\\n\\t\\tvarying vec2 vUv;\\n\\t#endif\\n\\tuniform mat3 uvTransform;\\n#endif\";\n\nvar uv_vertex = \"#ifdef USE_UV\\n\\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\\n#endif\";\n\nvar uv2_pars_fragment = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tvarying vec2 vUv2;\\n#endif\";\n\nvar uv2_pars_vertex = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tattribute vec2 uv2;\\n\\tvarying vec2 vUv2;\\n\\tuniform mat3 uv2Transform;\\n#endif\";\n\nvar uv2_vertex = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\\n#endif\";\n\nvar worldpos_vertex = \"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\\n\\tvec4 worldPosition = vec4( transformed, 1.0 );\\n\\t#ifdef USE_INSTANCING\\n\\t\\tworldPosition = instanceMatrix * worldPosition;\\n\\t#endif\\n\\tworldPosition = modelMatrix * worldPosition;\\n#endif\";\n\nconst vertex$g = \"varying vec2 vUv;\\nuniform mat3 uvTransform;\\nvoid main() {\\n\\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\\n\\tgl_Position = vec4( position.xy, 1.0, 1.0 );\\n}\";\n\nconst fragment$g = \"uniform sampler2D t2D;\\nvarying vec2 vUv;\\nvoid main() {\\n\\tgl_FragColor = texture2D( t2D, vUv );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n}\";\n\nconst vertex$f = \"varying vec3 vWorldDirection;\\n#include <common>\\nvoid main() {\\n\\tvWorldDirection = transformDirection( position, modelMatrix );\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n\\tgl_Position.z = gl_Position.w;\\n}\";\n\nconst fragment$f = \"#include <envmap_common_pars_fragment>\\nuniform float opacity;\\nvarying vec3 vWorldDirection;\\n#include <cube_uv_reflection_fragment>\\nvoid main() {\\n\\tvec3 vReflect = vWorldDirection;\\n\\t#include <envmap_fragment>\\n\\tgl_FragColor = envColor;\\n\\tgl_FragColor.a *= opacity;\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n}\";\n\nconst vertex$e = \"#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvarying vec2 vHighPrecisionZW;\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#ifdef USE_DISPLACEMENTMAP\\n\\t\\t#include <beginnormal_vertex>\\n\\t\\t#include <morphnormal_vertex>\\n\\t\\t#include <skinnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvHighPrecisionZW = gl_Position.zw;\\n}\";\n\nconst fragment$e = \"#if DEPTH_PACKING == 3200\\n\\tuniform float opacity;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvarying vec2 vHighPrecisionZW;\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( 1.0 );\\n\\t#if DEPTH_PACKING == 3200\\n\\t\\tdiffuseColor.a = opacity;\\n\\t#endif\\n\\t#include <map_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <logdepthbuf_fragment>\\n\\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\\n\\t#if DEPTH_PACKING == 3200\\n\\t\\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\\n\\t#elif DEPTH_PACKING == 3201\\n\\t\\tgl_FragColor = packDepthToRGBA( fragCoordZ );\\n\\t#endif\\n}\";\n\nconst vertex$d = \"#define DISTANCE\\nvarying vec3 vWorldPosition;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#ifdef USE_DISPLACEMENTMAP\\n\\t\\t#include <beginnormal_vertex>\\n\\t\\t#include <morphnormal_vertex>\\n\\t\\t#include <skinnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvWorldPosition = worldPosition.xyz;\\n}\";\n\nconst fragment$d = \"#define DISTANCE\\nuniform vec3 referencePosition;\\nuniform float nearDistance;\\nuniform float farDistance;\\nvarying vec3 vWorldPosition;\\n#include <common>\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main () {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( 1.0 );\\n\\t#include <map_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\tfloat dist = length( vWorldPosition - referencePosition );\\n\\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\\n\\tdist = saturate( dist );\\n\\tgl_FragColor = packDepthToRGBA( dist );\\n}\";\n\nconst vertex$c = \"varying vec3 vWorldDirection;\\n#include <common>\\nvoid main() {\\n\\tvWorldDirection = transformDirection( position, modelMatrix );\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n}\";\n\nconst fragment$c = \"uniform sampler2D tEquirect;\\nvarying vec3 vWorldDirection;\\n#include <common>\\nvoid main() {\\n\\tvec3 direction = normalize( vWorldDirection );\\n\\tvec2 sampleUV = equirectUv( direction );\\n\\tgl_FragColor = texture2D( tEquirect, sampleUV );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n}\";\n\nconst vertex$b = \"uniform float scale;\\nattribute float lineDistance;\\nvarying float vLineDistance;\\n#include <common>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\tvLineDistance = scale * lineDistance;\\n\\t#include <color_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$b = \"uniform vec3 diffuse;\\nuniform float opacity;\\nuniform float dashSize;\\nuniform float totalSize;\\nvarying float vLineDistance;\\n#include <common>\\n#include <color_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\\n\\t\\tdiscard;\\n\\t}\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <color_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n}\";\n\nconst vertex$a = \"#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\\n\\t\\t#include <beginnormal_vertex>\\n\\t\\t#include <morphnormal_vertex>\\n\\t\\t#include <skinbase_vertex>\\n\\t\\t#include <skinnormal_vertex>\\n\\t\\t#include <defaultnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$a = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <cube_uv_reflection_fragment>\\n#include <fog_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\t#ifdef USE_LIGHTMAP\\n\\t\\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\\n\\t\\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\\n\\t#else\\n\\t\\treflectedLight.indirectDiffuse += vec3( 1.0 );\\n\\t#endif\\n\\t#include <aomap_fragment>\\n\\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\\n\\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\\n\\t#include <envmap_fragment>\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\n\nconst vertex$9 = \"#define LAMBERT\\nvarying vec3 vLightFront;\\nvarying vec3 vIndirectFront;\\n#ifdef DOUBLE_SIDED\\n\\tvarying vec3 vLightBack;\\n\\tvarying vec3 vIndirectBack;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <lights_lambert_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$9 = \"uniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float opacity;\\nvarying vec3 vLightFront;\\nvarying vec3 vIndirectFront;\\n#ifdef DOUBLE_SIDED\\n\\tvarying vec3 vLightBack;\\n\\tvarying vec3 vIndirectBack;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <cube_uv_reflection_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <fog_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <shadowmask_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\t#include <emissivemap_fragment>\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\\n\\t#else\\n\\t\\treflectedLight.indirectDiffuse += vIndirectFront;\\n\\t#endif\\n\\t#include <lightmap_fragment>\\n\\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\\n\\t#else\\n\\t\\treflectedLight.directDiffuse = vLightFront;\\n\\t#endif\\n\\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\\n\\t#include <envmap_fragment>\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\n\nconst vertex$8 = \"#define MATCAP\\nvarying vec3 vViewPosition;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <color_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <normal_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <normal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <fog_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n}\";\n\nconst fragment$8 = \"#define MATCAP\\nuniform vec3 diffuse;\\nuniform float opacity;\\nuniform sampler2D matcap;\\nvarying vec3 vViewPosition;\\n#include <common>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <normal_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\tvec3 viewDir = normalize( vViewPosition );\\n\\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\\n\\tvec3 y = cross( viewDir, x );\\n\\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\\n\\t#ifdef USE_MATCAP\\n\\t\\tvec4 matcapColor = texture2D( matcap, uv );\\n\\t#else\\n\\t\\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\\n\\t#endif\\n\\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\n\nconst vertex$7 = \"#define NORMAL\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\\n\\tvarying vec3 vViewPosition;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <normal_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <normal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\\n\\tvViewPosition = - mvPosition.xyz;\\n#endif\\n}\";\n\nconst fragment$7 = \"#define NORMAL\\nuniform float opacity;\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\\n\\tvarying vec3 vViewPosition;\\n#endif\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <normal_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\\n\\t#ifdef OPAQUE\\n\\t\\tgl_FragColor.a = 1.0;\\n\\t#endif\\n}\";\n\nconst vertex$6 = \"#define PHONG\\nvarying vec3 vViewPosition;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <normal_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <normal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$6 = \"#define PHONG\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform vec3 specular;\\nuniform float shininess;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <cube_uv_reflection_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <normal_pars_fragment>\\n#include <lights_phong_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <lights_phong_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\\t#include <envmap_fragment>\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\n\nconst vertex$5 = \"#define STANDARD\\nvarying vec3 vViewPosition;\\n#ifdef USE_TRANSMISSION\\n\\tvarying vec3 vWorldPosition;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <normal_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <normal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n#ifdef USE_TRANSMISSION\\n\\tvWorldPosition = worldPosition.xyz;\\n#endif\\n}\";\n\nconst fragment$5 = \"#define STANDARD\\n#ifdef PHYSICAL\\n\\t#define IOR\\n\\t#define SPECULAR\\n#endif\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float roughness;\\nuniform float metalness;\\nuniform float opacity;\\n#ifdef IOR\\n\\tuniform float ior;\\n#endif\\n#ifdef SPECULAR\\n\\tuniform float specularIntensity;\\n\\tuniform vec3 specularColor;\\n\\t#ifdef USE_SPECULARINTENSITYMAP\\n\\t\\tuniform sampler2D specularIntensityMap;\\n\\t#endif\\n\\t#ifdef USE_SPECULARCOLORMAP\\n\\t\\tuniform sampler2D specularColorMap;\\n\\t#endif\\n#endif\\n#ifdef USE_CLEARCOAT\\n\\tuniform float clearcoat;\\n\\tuniform float clearcoatRoughness;\\n#endif\\n#ifdef USE_SHEEN\\n\\tuniform vec3 sheenColor;\\n\\tuniform float sheenRoughness;\\n\\t#ifdef USE_SHEENCOLORMAP\\n\\t\\tuniform sampler2D sheenColorMap;\\n\\t#endif\\n\\t#ifdef USE_SHEENROUGHNESSMAP\\n\\t\\tuniform sampler2D sheenRoughnessMap;\\n\\t#endif\\n#endif\\nvarying vec3 vViewPosition;\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <bsdfs>\\n#include <cube_uv_reflection_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_physical_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <lights_pars_begin>\\n#include <normal_pars_fragment>\\n#include <lights_physical_pars_fragment>\\n#include <transmission_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <clearcoat_pars_fragment>\\n#include <roughnessmap_pars_fragment>\\n#include <metalnessmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <roughnessmap_fragment>\\n\\t#include <metalnessmap_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <clearcoat_normal_fragment_begin>\\n\\t#include <clearcoat_normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <lights_physical_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\\n\\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\\n\\t#include <transmission_fragment>\\n\\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\\n\\t#ifdef USE_SHEEN\\n\\t\\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\\n\\t\\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\\n\\t#endif\\n\\t#ifdef USE_CLEARCOAT\\n\\t\\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\\n\\t\\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\\n\\t\\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\\n\\t#endif\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\n\nconst vertex$4 = \"#define TOON\\nvarying vec3 vViewPosition;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <normal_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <normal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$4 = \"#define TOON\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <gradientmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <normal_pars_fragment>\\n#include <lights_toon_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <lights_toon_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\n\nconst vertex$3 = \"uniform float size;\\nuniform float scale;\\n#include <common>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <color_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <project_vertex>\\n\\tgl_PointSize = size;\\n\\t#ifdef USE_SIZEATTENUATION\\n\\t\\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\\n\\t\\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\\n\\t#endif\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$3 = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#include <common>\\n#include <color_pars_fragment>\\n#include <map_particle_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_particle_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphatest_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n}\";\n\nconst vertex$2 = \"#include <common>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\nvoid main() {\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <project_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$2 = \"uniform vec3 color;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <shadowmap_pars_fragment>\\n#include <shadowmask_pars_fragment>\\nvoid main() {\\n\\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n}\";\n\nconst vertex$1 = \"uniform float rotation;\\nuniform vec2 center;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\\n\\tvec2 scale;\\n\\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\\n\\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\\n\\t#ifndef USE_SIZEATTENUATION\\n\\t\\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\\n\\t\\tif ( isPerspective ) scale *= - mvPosition.z;\\n\\t#endif\\n\\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\\n\\tvec2 rotatedPosition;\\n\\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\\n\\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\\n\\tmvPosition.xy += rotatedPosition;\\n\\tgl_Position = projectionMatrix * mvPosition;\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$1 = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#include <common>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n}\";\n\nconst ShaderChunk = {\n\talphamap_fragment: alphamap_fragment,\n\talphamap_pars_fragment: alphamap_pars_fragment,\n\talphatest_fragment: alphatest_fragment,\n\talphatest_pars_fragment: alphatest_pars_fragment,\n\taomap_fragment: aomap_fragment,\n\taomap_pars_fragment: aomap_pars_fragment,\n\tbegin_vertex: begin_vertex,\n\tbeginnormal_vertex: beginnormal_vertex,\n\tbsdfs: bsdfs,\n\tbumpmap_pars_fragment: bumpmap_pars_fragment,\n\tclipping_planes_fragment: clipping_planes_fragment,\n\tclipping_planes_pars_fragment: clipping_planes_pars_fragment,\n\tclipping_planes_pars_vertex: clipping_planes_pars_vertex,\n\tclipping_planes_vertex: clipping_planes_vertex,\n\tcolor_fragment: color_fragment,\n\tcolor_pars_fragment: color_pars_fragment,\n\tcolor_pars_vertex: color_pars_vertex,\n\tcolor_vertex: color_vertex,\n\tcommon: common,\n\tcube_uv_reflection_fragment: cube_uv_reflection_fragment,\n\tdefaultnormal_vertex: defaultnormal_vertex,\n\tdisplacementmap_pars_vertex: displacementmap_pars_vertex,\n\tdisplacementmap_vertex: displacementmap_vertex,\n\temissivemap_fragment: emissivemap_fragment,\n\temissivemap_pars_fragment: emissivemap_pars_fragment,\n\tencodings_fragment: encodings_fragment,\n\tencodings_pars_fragment: encodings_pars_fragment,\n\tenvmap_fragment: envmap_fragment,\n\tenvmap_common_pars_fragment: envmap_common_pars_fragment,\n\tenvmap_pars_fragment: envmap_pars_fragment,\n\tenvmap_pars_vertex: envmap_pars_vertex,\n\tenvmap_physical_pars_fragment: envmap_physical_pars_fragment,\n\tenvmap_vertex: envmap_vertex,\n\tfog_vertex: fog_vertex,\n\tfog_pars_vertex: fog_pars_vertex,\n\tfog_fragment: fog_fragment,\n\tfog_pars_fragment: fog_pars_fragment,\n\tgradientmap_pars_fragment: gradientmap_pars_fragment,\n\tlightmap_fragment: lightmap_fragment,\n\tlightmap_pars_fragment: lightmap_pars_fragment,\n\tlights_lambert_vertex: lights_lambert_vertex,\n\tlights_pars_begin: lights_pars_begin,\n\tlights_toon_fragment: lights_toon_fragment,\n\tlights_toon_pars_fragment: lights_toon_pars_fragment,\n\tlights_phong_fragment: lights_phong_fragment,\n\tlights_phong_pars_fragment: lights_phong_pars_fragment,\n\tlights_physical_fragment: lights_physical_fragment,\n\tlights_physical_pars_fragment: lights_physical_pars_fragment,\n\tlights_fragment_begin: lights_fragment_begin,\n\tlights_fragment_maps: lights_fragment_maps,\n\tlights_fragment_end: lights_fragment_end,\n\tlogdepthbuf_fragment: logdepthbuf_fragment,\n\tlogdepthbuf_pars_fragment: logdepthbuf_pars_fragment,\n\tlogdepthbuf_pars_vertex: logdepthbuf_pars_vertex,\n\tlogdepthbuf_vertex: logdepthbuf_vertex,\n\tmap_fragment: map_fragment,\n\tmap_pars_fragment: map_pars_fragment,\n\tmap_particle_fragment: map_particle_fragment,\n\tmap_particle_pars_fragment: map_particle_pars_fragment,\n\tmetalnessmap_fragment: metalnessmap_fragment,\n\tmetalnessmap_pars_fragment: metalnessmap_pars_fragment,\n\tmorphnormal_vertex: morphnormal_vertex,\n\tmorphtarget_pars_vertex: morphtarget_pars_vertex,\n\tmorphtarget_vertex: morphtarget_vertex,\n\tnormal_fragment_begin: normal_fragment_begin,\n\tnormal_fragment_maps: normal_fragment_maps,\n\tnormal_pars_fragment: normal_pars_fragment,\n\tnormal_pars_vertex: normal_pars_vertex,\n\tnormal_vertex: normal_vertex,\n\tnormalmap_pars_fragment: normalmap_pars_fragment,\n\tclearcoat_normal_fragment_begin: clearcoat_normal_fragment_begin,\n\tclearcoat_normal_fragment_maps: clearcoat_normal_fragment_maps,\n\tclearcoat_pars_fragment: clearcoat_pars_fragment,\n\toutput_fragment: output_fragment,\n\tpacking: packing,\n\tpremultiplied_alpha_fragment: premultiplied_alpha_fragment,\n\tproject_vertex: project_vertex,\n\tdithering_fragment: dithering_fragment,\n\tdithering_pars_fragment: dithering_pars_fragment,\n\troughnessmap_fragment: roughnessmap_fragment,\n\troughnessmap_pars_fragment: roughnessmap_pars_fragment,\n\tshadowmap_pars_fragment: shadowmap_pars_fragment,\n\tshadowmap_pars_vertex: shadowmap_pars_vertex,\n\tshadowmap_vertex: shadowmap_vertex,\n\tshadowmask_pars_fragment: shadowmask_pars_fragment,\n\tskinbase_vertex: skinbase_vertex,\n\tskinning_pars_vertex: skinning_pars_vertex,\n\tskinning_vertex: skinning_vertex,\n\tskinnormal_vertex: skinnormal_vertex,\n\tspecularmap_fragment: specularmap_fragment,\n\tspecularmap_pars_fragment: specularmap_pars_fragment,\n\ttonemapping_fragment: tonemapping_fragment,\n\ttonemapping_pars_fragment: tonemapping_pars_fragment,\n\ttransmission_fragment: transmission_fragment,\n\ttransmission_pars_fragment: transmission_pars_fragment,\n\tuv_pars_fragment: uv_pars_fragment,\n\tuv_pars_vertex: uv_pars_vertex,\n\tuv_vertex: uv_vertex,\n\tuv2_pars_fragment: uv2_pars_fragment,\n\tuv2_pars_vertex: uv2_pars_vertex,\n\tuv2_vertex: uv2_vertex,\n\tworldpos_vertex: worldpos_vertex,\n\n\tbackground_vert: vertex$g,\n\tbackground_frag: fragment$g,\n\tcube_vert: vertex$f,\n\tcube_frag: fragment$f,\n\tdepth_vert: vertex$e,\n\tdepth_frag: fragment$e,\n\tdistanceRGBA_vert: vertex$d,\n\tdistanceRGBA_frag: fragment$d,\n\tequirect_vert: vertex$c,\n\tequirect_frag: fragment$c,\n\tlinedashed_vert: vertex$b,\n\tlinedashed_frag: fragment$b,\n\tmeshbasic_vert: vertex$a,\n\tmeshbasic_frag: fragment$a,\n\tmeshlambert_vert: vertex$9,\n\tmeshlambert_frag: fragment$9,\n\tmeshmatcap_vert: vertex$8,\n\tmeshmatcap_frag: fragment$8,\n\tmeshnormal_vert: vertex$7,\n\tmeshnormal_frag: fragment$7,\n\tmeshphong_vert: vertex$6,\n\tmeshphong_frag: fragment$6,\n\tmeshphysical_vert: vertex$5,\n\tmeshphysical_frag: fragment$5,\n\tmeshtoon_vert: vertex$4,\n\tmeshtoon_frag: fragment$4,\n\tpoints_vert: vertex$3,\n\tpoints_frag: fragment$3,\n\tshadow_vert: vertex$2,\n\tshadow_frag: fragment$2,\n\tsprite_vert: vertex$1,\n\tsprite_frag: fragment$1\n};\n\n/**\n * Uniforms library for shared webgl shaders\n */\n\nconst UniformsLib = {\n\n\tcommon: {\n\n\t\tdiffuse: { value: new Color( 0xffffff ) },\n\t\topacity: { value: 1.0 },\n\n\t\tmap: { value: null },\n\t\tuvTransform: { value: new Matrix3() },\n\t\tuv2Transform: { value: new Matrix3() },\n\n\t\talphaMap: { value: null },\n\t\talphaTest: { value: 0 }\n\n\t},\n\n\tspecularmap: {\n\n\t\tspecularMap: { value: null },\n\n\t},\n\n\tenvmap: {\n\n\t\tenvMap: { value: null },\n\t\tflipEnvMap: { value: - 1 },\n\t\treflectivity: { value: 1.0 }, // basic, lambert, phong\n\t\tior: { value: 1.5 }, // standard, physical\n\t\trefractionRatio: { value: 0.98 }\n\n\t},\n\n\taomap: {\n\n\t\taoMap: { value: null },\n\t\taoMapIntensity: { value: 1 }\n\n\t},\n\n\tlightmap: {\n\n\t\tlightMap: { value: null },\n\t\tlightMapIntensity: { value: 1 }\n\n\t},\n\n\temissivemap: {\n\n\t\temissiveMap: { value: null }\n\n\t},\n\n\tbumpmap: {\n\n\t\tbumpMap: { value: null },\n\t\tbumpScale: { value: 1 }\n\n\t},\n\n\tnormalmap: {\n\n\t\tnormalMap: { value: null },\n\t\tnormalScale: { value: new Vector2( 1, 1 ) }\n\n\t},\n\n\tdisplacementmap: {\n\n\t\tdisplacementMap: { value: null },\n\t\tdisplacementScale: { value: 1 },\n\t\tdisplacementBias: { value: 0 }\n\n\t},\n\n\troughnessmap: {\n\n\t\troughnessMap: { value: null }\n\n\t},\n\n\tmetalnessmap: {\n\n\t\tmetalnessMap: { value: null }\n\n\t},\n\n\tgradientmap: {\n\n\t\tgradientMap: { value: null }\n\n\t},\n\n\tfog: {\n\n\t\tfogDensity: { value: 0.00025 },\n\t\tfogNear: { value: 1 },\n\t\tfogFar: { value: 2000 },\n\t\tfogColor: { value: new Color( 0xffffff ) }\n\n\t},\n\n\tlights: {\n\n\t\tambientLightColor: { value: [] },\n\n\t\tlightProbe: { value: [] },\n\n\t\tdirectionalLights: { value: [], properties: {\n\t\t\tdirection: {},\n\t\t\tcolor: {}\n\t\t} },\n\n\t\tdirectionalLightShadows: { value: [], properties: {\n\t\t\tshadowBias: {},\n\t\t\tshadowNormalBias: {},\n\t\t\tshadowRadius: {},\n\t\t\tshadowMapSize: {}\n\t\t} },\n\n\t\tdirectionalShadowMap: { value: [] },\n\t\tdirectionalShadowMatrix: { value: [] },\n\n\t\tspotLights: { value: [], properties: {\n\t\t\tcolor: {},\n\t\t\tposition: {},\n\t\t\tdirection: {},\n\t\t\tdistance: {},\n\t\t\tconeCos: {},\n\t\t\tpenumbraCos: {},\n\t\t\tdecay: {}\n\t\t} },\n\n\t\tspotLightShadows: { value: [], properties: {\n\t\t\tshadowBias: {},\n\t\t\tshadowNormalBias: {},\n\t\t\tshadowRadius: {},\n\t\t\tshadowMapSize: {}\n\t\t} },\n\n\t\tspotShadowMap: { value: [] },\n\t\tspotShadowMatrix: { value: [] },\n\n\t\tpointLights: { value: [], properties: {\n\t\t\tcolor: {},\n\t\t\tposition: {},\n\t\t\tdecay: {},\n\t\t\tdistance: {}\n\t\t} },\n\n\t\tpointLightShadows: { value: [], properties: {\n\t\t\tshadowBias: {},\n\t\t\tshadowNormalBias: {},\n\t\t\tshadowRadius: {},\n\t\t\tshadowMapSize: {},\n\t\t\tshadowCameraNear: {},\n\t\t\tshadowCameraFar: {}\n\t\t} },\n\n\t\tpointShadowMap: { value: [] },\n\t\tpointShadowMatrix: { value: [] },\n\n\t\themisphereLights: { value: [], properties: {\n\t\t\tdirection: {},\n\t\t\tskyColor: {},\n\t\t\tgroundColor: {}\n\t\t} },\n\n\t\t// TODO (abelnation): RectAreaLight BRDF data needs to be moved from example to main src\n\t\trectAreaLights: { value: [], properties: {\n\t\t\tcolor: {},\n\t\t\tposition: {},\n\t\t\twidth: {},\n\t\t\theight: {}\n\t\t} },\n\n\t\tltc_1: { value: null },\n\t\tltc_2: { value: null }\n\n\t},\n\n\tpoints: {\n\n\t\tdiffuse: { value: new Color( 0xffffff ) },\n\t\topacity: { value: 1.0 },\n\t\tsize: { value: 1.0 },\n\t\tscale: { value: 1.0 },\n\t\tmap: { value: null },\n\t\talphaMap: { value: null },\n\t\talphaTest: { value: 0 },\n\t\tuvTransform: { value: new Matrix3() }\n\n\t},\n\n\tsprite: {\n\n\t\tdiffuse: { value: new Color( 0xffffff ) },\n\t\topacity: { value: 1.0 },\n\t\tcenter: { value: new Vector2( 0.5, 0.5 ) },\n\t\trotation: { value: 0.0 },\n\t\tmap: { value: null },\n\t\talphaMap: { value: null },\n\t\talphaTest: { value: 0 },\n\t\tuvTransform: { value: new Matrix3() }\n\n\t}\n\n};\n\nconst ShaderLib = {\n\n\tbasic: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.specularmap,\n\t\t\tUniformsLib.envmap,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.fog\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshbasic_vert,\n\t\tfragmentShader: ShaderChunk.meshbasic_frag\n\n\t},\n\n\tlambert: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.specularmap,\n\t\t\tUniformsLib.envmap,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.emissivemap,\n\t\t\tUniformsLib.fog,\n\t\t\tUniformsLib.lights,\n\t\t\t{\n\t\t\t\temissive: { value: new Color( 0x000000 ) }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshlambert_vert,\n\t\tfragmentShader: ShaderChunk.meshlambert_frag\n\n\t},\n\n\tphong: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.specularmap,\n\t\t\tUniformsLib.envmap,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.emissivemap,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\tUniformsLib.fog,\n\t\t\tUniformsLib.lights,\n\t\t\t{\n\t\t\t\temissive: { value: new Color( 0x000000 ) },\n\t\t\t\tspecular: { value: new Color( 0x111111 ) },\n\t\t\t\tshininess: { value: 30 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshphong_vert,\n\t\tfragmentShader: ShaderChunk.meshphong_frag\n\n\t},\n\n\tstandard: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.envmap,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.emissivemap,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\tUniformsLib.roughnessmap,\n\t\t\tUniformsLib.metalnessmap,\n\t\t\tUniformsLib.fog,\n\t\t\tUniformsLib.lights,\n\t\t\t{\n\t\t\t\temissive: { value: new Color( 0x000000 ) },\n\t\t\t\troughness: { value: 1.0 },\n\t\t\t\tmetalness: { value: 0.0 },\n\t\t\t\tenvMapIntensity: { value: 1 } // temporary\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshphysical_vert,\n\t\tfragmentShader: ShaderChunk.meshphysical_frag\n\n\t},\n\n\ttoon: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.emissivemap,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\tUniformsLib.gradientmap,\n\t\t\tUniformsLib.fog,\n\t\t\tUniformsLib.lights,\n\t\t\t{\n\t\t\t\temissive: { value: new Color( 0x000000 ) }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshtoon_vert,\n\t\tfragmentShader: ShaderChunk.meshtoon_frag\n\n\t},\n\n\tmatcap: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\tUniformsLib.fog,\n\t\t\t{\n\t\t\t\tmatcap: { value: null }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshmatcap_vert,\n\t\tfragmentShader: ShaderChunk.meshmatcap_frag\n\n\t},\n\n\tpoints: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.points,\n\t\t\tUniformsLib.fog\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.points_vert,\n\t\tfragmentShader: ShaderChunk.points_frag\n\n\t},\n\n\tdashed: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.fog,\n\t\t\t{\n\t\t\t\tscale: { value: 1 },\n\t\t\t\tdashSize: { value: 1 },\n\t\t\t\ttotalSize: { value: 2 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.linedashed_vert,\n\t\tfragmentShader: ShaderChunk.linedashed_frag\n\n\t},\n\n\tdepth: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.displacementmap\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.depth_vert,\n\t\tfragmentShader: ShaderChunk.depth_frag\n\n\t},\n\n\tnormal: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\t{\n\t\t\t\topacity: { value: 1.0 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshnormal_vert,\n\t\tfragmentShader: ShaderChunk.meshnormal_frag\n\n\t},\n\n\tsprite: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.sprite,\n\t\t\tUniformsLib.fog\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.sprite_vert,\n\t\tfragmentShader: ShaderChunk.sprite_frag\n\n\t},\n\n\tbackground: {\n\n\t\tuniforms: {\n\t\t\tuvTransform: { value: new Matrix3() },\n\t\t\tt2D: { value: null },\n\t\t},\n\n\t\tvertexShader: ShaderChunk.background_vert,\n\t\tfragmentShader: ShaderChunk.background_frag\n\n\t},\n\t/* -------------------------------------------------------------------------\n\t//\tCube map shader\n\t ------------------------------------------------------------------------- */\n\n\tcube: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.envmap,\n\t\t\t{\n\t\t\t\topacity: { value: 1.0 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.cube_vert,\n\t\tfragmentShader: ShaderChunk.cube_frag\n\n\t},\n\n\tequirect: {\n\n\t\tuniforms: {\n\t\t\ttEquirect: { value: null },\n\t\t},\n\n\t\tvertexShader: ShaderChunk.equirect_vert,\n\t\tfragmentShader: ShaderChunk.equirect_frag\n\n\t},\n\n\tdistanceRGBA: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.displacementmap,\n\t\t\t{\n\t\t\t\treferencePosition: { value: new Vector3() },\n\t\t\t\tnearDistance: { value: 1 },\n\t\t\t\tfarDistance: { value: 1000 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.distanceRGBA_vert,\n\t\tfragmentShader: ShaderChunk.distanceRGBA_frag\n\n\t},\n\n\tshadow: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.lights,\n\t\t\tUniformsLib.fog,\n\t\t\t{\n\t\t\t\tcolor: { value: new Color( 0x00000 ) },\n\t\t\t\topacity: { value: 1.0 }\n\t\t\t},\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.shadow_vert,\n\t\tfragmentShader: ShaderChunk.shadow_frag\n\n\t}\n\n};\n\nShaderLib.physical = {\n\n\tuniforms: mergeUniforms( [\n\t\tShaderLib.standard.uniforms,\n\t\t{\n\t\t\tclearcoat: { value: 0 },\n\t\t\tclearcoatMap: { value: null },\n\t\t\tclearcoatRoughness: { value: 0 },\n\t\t\tclearcoatRoughnessMap: { value: null },\n\t\t\tclearcoatNormalScale: { value: new Vector2( 1, 1 ) },\n\t\t\tclearcoatNormalMap: { value: null },\n\t\t\tsheen: { value: 0 },\n\t\t\tsheenColor: { value: new Color( 0x000000 ) },\n\t\t\tsheenColorMap: { value: null },\n\t\t\tsheenRoughness: { value: 1 },\n\t\t\tsheenRoughnessMap: { value: null },\n\t\t\ttransmission: { value: 0 },\n\t\t\ttransmissionMap: { value: null },\n\t\t\ttransmissionSamplerSize: { value: new Vector2() },\n\t\t\ttransmissionSamplerMap: { value: null },\n\t\t\tthickness: { value: 0 },\n\t\t\tthicknessMap: { value: null },\n\t\t\tattenuationDistance: { value: 0 },\n\t\t\tattenuationColor: { value: new Color( 0x000000 ) },\n\t\t\tspecularIntensity: { value: 1 },\n\t\t\tspecularIntensityMap: { value: null },\n\t\t\tspecularColor: { value: new Color( 1, 1, 1 ) },\n\t\t\tspecularColorMap: { value: null },\n\t\t}\n\t] ),\n\n\tvertexShader: ShaderChunk.meshphysical_vert,\n\tfragmentShader: ShaderChunk.meshphysical_frag\n\n};\n\nfunction WebGLBackground( renderer, cubemaps, state, objects, alpha, premultipliedAlpha ) {\n\n\tconst clearColor = new Color( 0x000000 );\n\tlet clearAlpha = alpha === true ? 0 : 1;\n\n\tlet planeMesh;\n\tlet boxMesh;\n\n\tlet currentBackground = null;\n\tlet currentBackgroundVersion = 0;\n\tlet currentTonemapping = null;\n\n\tfunction render( renderList, scene ) {\n\n\t\tlet forceClear = false;\n\t\tlet background = scene.isScene === true ? scene.background : null;\n\n\t\tif ( background && background.isTexture ) {\n\n\t\t\tbackground = cubemaps.get( background );\n\n\t\t}\n\n\t\t// Ignore background in AR\n\t\t// TODO: Reconsider this.\n\n\t\tconst xr = renderer.xr;\n\t\tconst session = xr.getSession && xr.getSession();\n\n\t\tif ( session && session.environmentBlendMode === 'additive' ) {\n\n\t\t\tbackground = null;\n\n\t\t}\n\n\t\tif ( background === null ) {\n\n\t\t\tsetClear( clearColor, clearAlpha );\n\n\t\t} else if ( background && background.isColor ) {\n\n\t\t\tsetClear( background, 1 );\n\t\t\tforceClear = true;\n\n\t\t}\n\n\t\tif ( renderer.autoClear || forceClear ) {\n\n\t\t\trenderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\n\t\t}\n\n\t\tif ( background && ( background.isCubeTexture || background.mapping === CubeUVReflectionMapping ) ) {\n\n\t\t\tif ( boxMesh === undefined ) {\n\n\t\t\t\tboxMesh = new Mesh(\n\t\t\t\t\tnew BoxGeometry( 1, 1, 1 ),\n\t\t\t\t\tnew ShaderMaterial( {\n\t\t\t\t\t\tname: 'BackgroundCubeMaterial',\n\t\t\t\t\t\tuniforms: cloneUniforms( ShaderLib.cube.uniforms ),\n\t\t\t\t\t\tvertexShader: ShaderLib.cube.vertexShader,\n\t\t\t\t\t\tfragmentShader: ShaderLib.cube.fragmentShader,\n\t\t\t\t\t\tside: BackSide,\n\t\t\t\t\t\tdepthTest: false,\n\t\t\t\t\t\tdepthWrite: false,\n\t\t\t\t\t\tfog: false\n\t\t\t\t\t} )\n\t\t\t\t);\n\n\t\t\t\tboxMesh.geometry.deleteAttribute( 'normal' );\n\t\t\t\tboxMesh.geometry.deleteAttribute( 'uv' );\n\n\t\t\t\tboxMesh.onBeforeRender = function ( renderer, scene, camera ) {\n\n\t\t\t\t\tthis.matrixWorld.copyPosition( camera.matrixWorld );\n\n\t\t\t\t};\n\n\t\t\t\t// enable code injection for non-built-in material\n\t\t\t\tObject.defineProperty( boxMesh.material, 'envMap', {\n\n\t\t\t\t\tget: function () {\n\n\t\t\t\t\t\treturn this.uniforms.envMap.value;\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tobjects.update( boxMesh );\n\n\t\t\t}\n\n\t\t\tboxMesh.material.uniforms.envMap.value = background;\n\t\t\tboxMesh.material.uniforms.flipEnvMap.value = ( background.isCubeTexture && background.isRenderTargetTexture === false ) ? - 1 : 1;\n\n\t\t\tif ( currentBackground !== background ||\n\t\t\t\tcurrentBackgroundVersion !== background.version ||\n\t\t\t\tcurrentTonemapping !== renderer.toneMapping ) {\n\n\t\t\t\tboxMesh.material.needsUpdate = true;\n\n\t\t\t\tcurrentBackground = background;\n\t\t\t\tcurrentBackgroundVersion = background.version;\n\t\t\t\tcurrentTonemapping = renderer.toneMapping;\n\n\t\t\t}\n\n\t\t\t// push to the pre-sorted opaque render list\n\t\t\trenderList.unshift( boxMesh, boxMesh.geometry, boxMesh.material, 0, 0, null );\n\n\t\t} else if ( background && background.isTexture ) {\n\n\t\t\tif ( planeMesh === undefined ) {\n\n\t\t\t\tplaneMesh = new Mesh(\n\t\t\t\t\tnew PlaneGeometry( 2, 2 ),\n\t\t\t\t\tnew ShaderMaterial( {\n\t\t\t\t\t\tname: 'BackgroundMaterial',\n\t\t\t\t\t\tuniforms: cloneUniforms( ShaderLib.background.uniforms ),\n\t\t\t\t\t\tvertexShader: ShaderLib.background.vertexShader,\n\t\t\t\t\t\tfragmentShader: ShaderLib.background.fragmentShader,\n\t\t\t\t\t\tside: FrontSide,\n\t\t\t\t\t\tdepthTest: false,\n\t\t\t\t\t\tdepthWrite: false,\n\t\t\t\t\t\tfog: false\n\t\t\t\t\t} )\n\t\t\t\t);\n\n\t\t\t\tplaneMesh.geometry.deleteAttribute( 'normal' );\n\n\t\t\t\t// enable code injection for non-built-in material\n\t\t\t\tObject.defineProperty( planeMesh.material, 'map', {\n\n\t\t\t\t\tget: function () {\n\n\t\t\t\t\t\treturn this.uniforms.t2D.value;\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tobjects.update( planeMesh );\n\n\t\t\t}\n\n\t\t\tplaneMesh.material.uniforms.t2D.value = background;\n\n\t\t\tif ( background.matrixAutoUpdate === true ) {\n\n\t\t\t\tbackground.updateMatrix();\n\n\t\t\t}\n\n\t\t\tplaneMesh.material.uniforms.uvTransform.value.copy( background.matrix );\n\n\t\t\tif ( currentBackground !== background ||\n\t\t\t\tcurrentBackgroundVersion !== background.version ||\n\t\t\t\tcurrentTonemapping !== renderer.toneMapping ) {\n\n\t\t\t\tplaneMesh.material.needsUpdate = true;\n\n\t\t\t\tcurrentBackground = background;\n\t\t\t\tcurrentBackgroundVersion = background.version;\n\t\t\t\tcurrentTonemapping = renderer.toneMapping;\n\n\t\t\t}\n\n\n\t\t\t// push to the pre-sorted opaque render list\n\t\t\trenderList.unshift( planeMesh, planeMesh.geometry, planeMesh.material, 0, 0, null );\n\n\t\t}\n\n\t}\n\n\tfunction setClear( color, alpha ) {\n\n\t\tstate.buffers.color.setClear( color.r, color.g, color.b, alpha, premultipliedAlpha );\n\n\t}\n\n\treturn {\n\n\t\tgetClearColor: function () {\n\n\t\t\treturn clearColor;\n\n\t\t},\n\t\tsetClearColor: function ( color, alpha = 1 ) {\n\n\t\t\tclearColor.set( color );\n\t\t\tclearAlpha = alpha;\n\t\t\tsetClear( clearColor, clearAlpha );\n\n\t\t},\n\t\tgetClearAlpha: function () {\n\n\t\t\treturn clearAlpha;\n\n\t\t},\n\t\tsetClearAlpha: function ( alpha ) {\n\n\t\t\tclearAlpha = alpha;\n\t\t\tsetClear( clearColor, clearAlpha );\n\n\t\t},\n\t\trender: render\n\n\t};\n\n}\n\nfunction WebGLBindingStates( gl, extensions, attributes, capabilities ) {\n\n\tconst maxVertexAttributes = gl.getParameter( 34921 );\n\n\tconst extension = capabilities.isWebGL2 ? null : extensions.get( 'OES_vertex_array_object' );\n\tconst vaoAvailable = capabilities.isWebGL2 || extension !== null;\n\n\tconst bindingStates = {};\n\n\tconst defaultState = createBindingState( null );\n\tlet currentState = defaultState;\n\n\tfunction setup( object, material, program, geometry, index ) {\n\n\t\tlet updateBuffers = false;\n\n\t\tif ( vaoAvailable ) {\n\n\t\t\tconst state = getBindingState( geometry, program, material );\n\n\t\t\tif ( currentState !== state ) {\n\n\t\t\t\tcurrentState = state;\n\t\t\t\tbindVertexArrayObject( currentState.object );\n\n\t\t\t}\n\n\t\t\tupdateBuffers = needsUpdate( geometry, index );\n\n\t\t\tif ( updateBuffers ) saveCache( geometry, index );\n\n\t\t} else {\n\n\t\t\tconst wireframe = ( material.wireframe === true );\n\n\t\t\tif ( currentState.geometry !== geometry.id ||\n\t\t\t\tcurrentState.program !== program.id ||\n\t\t\t\tcurrentState.wireframe !== wireframe ) {\n\n\t\t\t\tcurrentState.geometry = geometry.id;\n\t\t\t\tcurrentState.program = program.id;\n\t\t\t\tcurrentState.wireframe = wireframe;\n\n\t\t\t\tupdateBuffers = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( object.isInstancedMesh === true ) {\n\n\t\t\tupdateBuffers = true;\n\n\t\t}\n\n\t\tif ( index !== null ) {\n\n\t\t\tattributes.update( index, 34963 );\n\n\t\t}\n\n\t\tif ( updateBuffers ) {\n\n\t\t\tsetupVertexAttributes( object, material, program, geometry );\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tgl.bindBuffer( 34963, attributes.get( index ).buffer );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction createVertexArrayObject() {\n\n\t\tif ( capabilities.isWebGL2 ) return gl.createVertexArray();\n\n\t\treturn extension.createVertexArrayOES();\n\n\t}\n\n\tfunction bindVertexArrayObject( vao ) {\n\n\t\tif ( capabilities.isWebGL2 ) return gl.bindVertexArray( vao );\n\n\t\treturn extension.bindVertexArrayOES( vao );\n\n\t}\n\n\tfunction deleteVertexArrayObject( vao ) {\n\n\t\tif ( capabilities.isWebGL2 ) return gl.deleteVertexArray( vao );\n\n\t\treturn extension.deleteVertexArrayOES( vao );\n\n\t}\n\n\tfunction getBindingState( geometry, program, material ) {\n\n\t\tconst wireframe = ( material.wireframe === true );\n\n\t\tlet programMap = bindingStates[ geometry.id ];\n\n\t\tif ( programMap === undefined ) {\n\n\t\t\tprogramMap = {};\n\t\t\tbindingStates[ geometry.id ] = programMap;\n\n\t\t}\n\n\t\tlet stateMap = programMap[ program.id ];\n\n\t\tif ( stateMap === undefined ) {\n\n\t\t\tstateMap = {};\n\t\t\tprogramMap[ program.id ] = stateMap;\n\n\t\t}\n\n\t\tlet state = stateMap[ wireframe ];\n\n\t\tif ( state === undefined ) {\n\n\t\t\tstate = createBindingState( createVertexArrayObject() );\n\t\t\tstateMap[ wireframe ] = state;\n\n\t\t}\n\n\t\treturn state;\n\n\t}\n\n\tfunction createBindingState( vao ) {\n\n\t\tconst newAttributes = [];\n\t\tconst enabledAttributes = [];\n\t\tconst attributeDivisors = [];\n\n\t\tfor ( let i = 0; i < maxVertexAttributes; i ++ ) {\n\n\t\t\tnewAttributes[ i ] = 0;\n\t\t\tenabledAttributes[ i ] = 0;\n\t\t\tattributeDivisors[ i ] = 0;\n\n\t\t}\n\n\t\treturn {\n\n\t\t\t// for backward compatibility on non-VAO support browser\n\t\t\tgeometry: null,\n\t\t\tprogram: null,\n\t\t\twireframe: false,\n\n\t\t\tnewAttributes: newAttributes,\n\t\t\tenabledAttributes: enabledAttributes,\n\t\t\tattributeDivisors: attributeDivisors,\n\t\t\tobject: vao,\n\t\t\tattributes: {},\n\t\t\tindex: null\n\n\t\t};\n\n\t}\n\n\tfunction needsUpdate( geometry, index ) {\n\n\t\tconst cachedAttributes = currentState.attributes;\n\t\tconst geometryAttributes = geometry.attributes;\n\n\t\tlet attributesNum = 0;\n\n\t\tfor ( const key in geometryAttributes ) {\n\n\t\t\tconst cachedAttribute = cachedAttributes[ key ];\n\t\t\tconst geometryAttribute = geometryAttributes[ key ];\n\n\t\t\tif ( cachedAttribute === undefined ) return true;\n\n\t\t\tif ( cachedAttribute.attribute !== geometryAttribute ) return true;\n\n\t\t\tif ( cachedAttribute.data !== geometryAttribute.data ) return true;\n\n\t\t\tattributesNum ++;\n\n\t\t}\n\n\t\tif ( currentState.attributesNum !== attributesNum ) return true;\n\n\t\tif ( currentState.index !== index ) return true;\n\n\t\treturn false;\n\n\t}\n\n\tfunction saveCache( geometry, index ) {\n\n\t\tconst cache = {};\n\t\tconst attributes = geometry.attributes;\n\t\tlet attributesNum = 0;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tconst attribute = attributes[ key ];\n\n\t\t\tconst data = {};\n\t\t\tdata.attribute = attribute;\n\n\t\t\tif ( attribute.data ) {\n\n\t\t\t\tdata.data = attribute.data;\n\n\t\t\t}\n\n\t\t\tcache[ key ] = data;\n\n\t\t\tattributesNum ++;\n\n\t\t}\n\n\t\tcurrentState.attributes = cache;\n\t\tcurrentState.attributesNum = attributesNum;\n\n\t\tcurrentState.index = index;\n\n\t}\n\n\tfunction initAttributes() {\n\n\t\tconst newAttributes = currentState.newAttributes;\n\n\t\tfor ( let i = 0, il = newAttributes.length; i < il; i ++ ) {\n\n\t\t\tnewAttributes[ i ] = 0;\n\n\t\t}\n\n\t}\n\n\tfunction enableAttribute( attribute ) {\n\n\t\tenableAttributeAndDivisor( attribute, 0 );\n\n\t}\n\n\tfunction enableAttributeAndDivisor( attribute, meshPerAttribute ) {\n\n\t\tconst newAttributes = currentState.newAttributes;\n\t\tconst enabledAttributes = currentState.enabledAttributes;\n\t\tconst attributeDivisors = currentState.attributeDivisors;\n\n\t\tnewAttributes[ attribute ] = 1;\n\n\t\tif ( enabledAttributes[ attribute ] === 0 ) {\n\n\t\t\tgl.enableVertexAttribArray( attribute );\n\t\t\tenabledAttributes[ attribute ] = 1;\n\n\t\t}\n\n\t\tif ( attributeDivisors[ attribute ] !== meshPerAttribute ) {\n\n\t\t\tconst extension = capabilities.isWebGL2 ? gl : extensions.get( 'ANGLE_instanced_arrays' );\n\n\t\t\textension[ capabilities.isWebGL2 ? 'vertexAttribDivisor' : 'vertexAttribDivisorANGLE' ]( attribute, meshPerAttribute );\n\t\t\tattributeDivisors[ attribute ] = meshPerAttribute;\n\n\t\t}\n\n\t}\n\n\tfunction disableUnusedAttributes() {\n\n\t\tconst newAttributes = currentState.newAttributes;\n\t\tconst enabledAttributes = currentState.enabledAttributes;\n\n\t\tfor ( let i = 0, il = enabledAttributes.length; i < il; i ++ ) {\n\n\t\t\tif ( enabledAttributes[ i ] !== newAttributes[ i ] ) {\n\n\t\t\t\tgl.disableVertexAttribArray( i );\n\t\t\t\tenabledAttributes[ i ] = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction vertexAttribPointer( index, size, type, normalized, stride, offset ) {\n\n\t\tif ( capabilities.isWebGL2 === true && ( type === 5124 || type === 5125 ) ) {\n\n\t\t\tgl.vertexAttribIPointer( index, size, type, stride, offset );\n\n\t\t} else {\n\n\t\t\tgl.vertexAttribPointer( index, size, type, normalized, stride, offset );\n\n\t\t}\n\n\t}\n\n\tfunction setupVertexAttributes( object, material, program, geometry ) {\n\n\t\tif ( capabilities.isWebGL2 === false && ( object.isInstancedMesh || geometry.isInstancedBufferGeometry ) ) {\n\n\t\t\tif ( extensions.get( 'ANGLE_instanced_arrays' ) === null ) return;\n\n\t\t}\n\n\t\tinitAttributes();\n\n\t\tconst geometryAttributes = geometry.attributes;\n\n\t\tconst programAttributes = program.getAttributes();\n\n\t\tconst materialDefaultAttributeValues = material.defaultAttributeValues;\n\n\t\tfor ( const name in programAttributes ) {\n\n\t\t\tconst programAttribute = programAttributes[ name ];\n\n\t\t\tif ( programAttribute.location >= 0 ) {\n\n\t\t\t\tlet geometryAttribute = geometryAttributes[ name ];\n\n\t\t\t\tif ( geometryAttribute === undefined ) {\n\n\t\t\t\t\tif ( name === 'instanceMatrix' && object.instanceMatrix ) geometryAttribute = object.instanceMatrix;\n\t\t\t\t\tif ( name === 'instanceColor' && object.instanceColor ) geometryAttribute = object.instanceColor;\n\n\t\t\t\t}\n\n\t\t\t\tif ( geometryAttribute !== undefined ) {\n\n\t\t\t\t\tconst normalized = geometryAttribute.normalized;\n\t\t\t\t\tconst size = geometryAttribute.itemSize;\n\n\t\t\t\t\tconst attribute = attributes.get( geometryAttribute );\n\n\t\t\t\t\t// TODO Attribute may not be available on context restore\n\n\t\t\t\t\tif ( attribute === undefined ) continue;\n\n\t\t\t\t\tconst buffer = attribute.buffer;\n\t\t\t\t\tconst type = attribute.type;\n\t\t\t\t\tconst bytesPerElement = attribute.bytesPerElement;\n\n\t\t\t\t\tif ( geometryAttribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\t\t\tconst data = geometryAttribute.data;\n\t\t\t\t\t\tconst stride = data.stride;\n\t\t\t\t\t\tconst offset = geometryAttribute.offset;\n\n\t\t\t\t\t\tif ( data && data.isInstancedInterleavedBuffer ) {\n\n\t\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\t\tenableAttributeAndDivisor( programAttribute.location + i, data.meshPerAttribute );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( object.isInstancedMesh !== true && geometry._maxInstanceCount === undefined ) {\n\n\t\t\t\t\t\t\t\tgeometry._maxInstanceCount = data.meshPerAttribute * data.count;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\t\tenableAttribute( programAttribute.location + i );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tgl.bindBuffer( 34962, buffer );\n\n\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\tvertexAttribPointer(\n\t\t\t\t\t\t\t\tprogramAttribute.location + i,\n\t\t\t\t\t\t\t\tsize / programAttribute.locationSize,\n\t\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\t\tnormalized,\n\t\t\t\t\t\t\t\tstride * bytesPerElement,\n\t\t\t\t\t\t\t\t( offset + ( size / programAttribute.locationSize ) * i ) * bytesPerElement\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( geometryAttribute.isInstancedBufferAttribute ) {\n\n\t\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\t\tenableAttributeAndDivisor( programAttribute.location + i, geometryAttribute.meshPerAttribute );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( object.isInstancedMesh !== true && geometry._maxInstanceCount === undefined ) {\n\n\t\t\t\t\t\t\t\tgeometry._maxInstanceCount = geometryAttribute.meshPerAttribute * geometryAttribute.count;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\t\tenableAttribute( programAttribute.location + i );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tgl.bindBuffer( 34962, buffer );\n\n\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\tvertexAttribPointer(\n\t\t\t\t\t\t\t\tprogramAttribute.location + i,\n\t\t\t\t\t\t\t\tsize / programAttribute.locationSize,\n\t\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\t\tnormalized,\n\t\t\t\t\t\t\t\tsize * bytesPerElement,\n\t\t\t\t\t\t\t\t( size / programAttribute.locationSize ) * i * bytesPerElement\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( materialDefaultAttributeValues !== undefined ) {\n\n\t\t\t\t\tconst value = materialDefaultAttributeValues[ name ];\n\n\t\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\t\tswitch ( value.length ) {\n\n\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\tgl.vertexAttrib2fv( programAttribute.location, value );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\t\tgl.vertexAttrib3fv( programAttribute.location, value );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\t\tgl.vertexAttrib4fv( programAttribute.location, value );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tgl.vertexAttrib1fv( programAttribute.location, value );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tdisableUnusedAttributes();\n\n\t}\n\n\tfunction dispose() {\n\n\t\treset();\n\n\t\tfor ( const geometryId in bindingStates ) {\n\n\t\t\tconst programMap = bindingStates[ geometryId ];\n\n\t\t\tfor ( const programId in programMap ) {\n\n\t\t\t\tconst stateMap = programMap[ programId ];\n\n\t\t\t\tfor ( const wireframe in stateMap ) {\n\n\t\t\t\t\tdeleteVertexArrayObject( stateMap[ wireframe ].object );\n\n\t\t\t\t\tdelete stateMap[ wireframe ];\n\n\t\t\t\t}\n\n\t\t\t\tdelete programMap[ programId ];\n\n\t\t\t}\n\n\t\t\tdelete bindingStates[ geometryId ];\n\n\t\t}\n\n\t}\n\n\tfunction releaseStatesOfGeometry( geometry ) {\n\n\t\tif ( bindingStates[ geometry.id ] === undefined ) return;\n\n\t\tconst programMap = bindingStates[ geometry.id ];\n\n\t\tfor ( const programId in programMap ) {\n\n\t\t\tconst stateMap = programMap[ programId ];\n\n\t\t\tfor ( const wireframe in stateMap ) {\n\n\t\t\t\tdeleteVertexArrayObject( stateMap[ wireframe ].object );\n\n\t\t\t\tdelete stateMap[ wireframe ];\n\n\t\t\t}\n\n\t\t\tdelete programMap[ programId ];\n\n\t\t}\n\n\t\tdelete bindingStates[ geometry.id ];\n\n\t}\n\n\tfunction releaseStatesOfProgram( program ) {\n\n\t\tfor ( const geometryId in bindingStates ) {\n\n\t\t\tconst programMap = bindingStates[ geometryId ];\n\n\t\t\tif ( programMap[ program.id ] === undefined ) continue;\n\n\t\t\tconst stateMap = programMap[ program.id ];\n\n\t\t\tfor ( const wireframe in stateMap ) {\n\n\t\t\t\tdeleteVertexArrayObject( stateMap[ wireframe ].object );\n\n\t\t\t\tdelete stateMap[ wireframe ];\n\n\t\t\t}\n\n\t\t\tdelete programMap[ program.id ];\n\n\t\t}\n\n\t}\n\n\tfunction reset() {\n\n\t\tresetDefaultState();\n\n\t\tif ( currentState === defaultState ) return;\n\n\t\tcurrentState = defaultState;\n\t\tbindVertexArrayObject( currentState.object );\n\n\t}\n\n\t// for backward-compatilibity\n\n\tfunction resetDefaultState() {\n\n\t\tdefaultState.geometry = null;\n\t\tdefaultState.program = null;\n\t\tdefaultState.wireframe = false;\n\n\t}\n\n\treturn {\n\n\t\tsetup: setup,\n\t\treset: reset,\n\t\tresetDefaultState: resetDefaultState,\n\t\tdispose: dispose,\n\t\treleaseStatesOfGeometry: releaseStatesOfGeometry,\n\t\treleaseStatesOfProgram: releaseStatesOfProgram,\n\n\t\tinitAttributes: initAttributes,\n\t\tenableAttribute: enableAttribute,\n\t\tdisableUnusedAttributes: disableUnusedAttributes\n\n\t};\n\n}\n\nfunction WebGLBufferRenderer( gl, extensions, info, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tlet mode;\n\n\tfunction setMode( value ) {\n\n\t\tmode = value;\n\n\t}\n\n\tfunction render( start, count ) {\n\n\t\tgl.drawArrays( mode, start, count );\n\n\t\tinfo.update( count, mode, 1 );\n\n\t}\n\n\tfunction renderInstances( start, count, primcount ) {\n\n\t\tif ( primcount === 0 ) return;\n\n\t\tlet extension, methodName;\n\n\t\tif ( isWebGL2 ) {\n\n\t\t\textension = gl;\n\t\t\tmethodName = 'drawArraysInstanced';\n\n\t\t} else {\n\n\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\n\t\t\tmethodName = 'drawArraysInstancedANGLE';\n\n\t\t\tif ( extension === null ) {\n\n\t\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\textension[ methodName ]( mode, start, count, primcount );\n\n\t\tinfo.update( count, mode, primcount );\n\n\t}\n\n\t//\n\n\tthis.setMode = setMode;\n\tthis.render = render;\n\tthis.renderInstances = renderInstances;\n\n}\n\nfunction WebGLCapabilities( gl, extensions, parameters ) {\n\n\tlet maxAnisotropy;\n\n\tfunction getMaxAnisotropy() {\n\n\t\tif ( maxAnisotropy !== undefined ) return maxAnisotropy;\n\n\t\tif ( extensions.has( 'EXT_texture_filter_anisotropic' ) === true ) {\n\n\t\t\tconst extension = extensions.get( 'EXT_texture_filter_anisotropic' );\n\n\t\t\tmaxAnisotropy = gl.getParameter( extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT );\n\n\t\t} else {\n\n\t\t\tmaxAnisotropy = 0;\n\n\t\t}\n\n\t\treturn maxAnisotropy;\n\n\t}\n\n\tfunction getMaxPrecision( precision ) {\n\n\t\tif ( precision === 'highp' ) {\n\n\t\t\tif ( gl.getShaderPrecisionFormat( 35633, 36338 ).precision > 0 &&\n\t\t\t\tgl.getShaderPrecisionFormat( 35632, 36338 ).precision > 0 ) {\n\n\t\t\t\treturn 'highp';\n\n\t\t\t}\n\n\t\t\tprecision = 'mediump';\n\n\t\t}\n\n\t\tif ( precision === 'mediump' ) {\n\n\t\t\tif ( gl.getShaderPrecisionFormat( 35633, 36337 ).precision > 0 &&\n\t\t\t\tgl.getShaderPrecisionFormat( 35632, 36337 ).precision > 0 ) {\n\n\t\t\t\treturn 'mediump';\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn 'lowp';\n\n\t}\n\n\tconst isWebGL2 = ( typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext ) ||\n\t\t( typeof WebGL2ComputeRenderingContext !== 'undefined' && gl instanceof WebGL2ComputeRenderingContext );\n\n\tlet precision = parameters.precision !== undefined ? parameters.precision : 'highp';\n\tconst maxPrecision = getMaxPrecision( precision );\n\n\tif ( maxPrecision !== precision ) {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer:', precision, 'not supported, using', maxPrecision, 'instead.' );\n\t\tprecision = maxPrecision;\n\n\t}\n\n\tconst drawBuffers = isWebGL2 || extensions.has( 'WEBGL_draw_buffers' );\n\n\tconst logarithmicDepthBuffer = parameters.logarithmicDepthBuffer === true;\n\n\tconst maxTextures = gl.getParameter( 34930 );\n\tconst maxVertexTextures = gl.getParameter( 35660 );\n\tconst maxTextureSize = gl.getParameter( 3379 );\n\tconst maxCubemapSize = gl.getParameter( 34076 );\n\n\tconst maxAttributes = gl.getParameter( 34921 );\n\tconst maxVertexUniforms = gl.getParameter( 36347 );\n\tconst maxVaryings = gl.getParameter( 36348 );\n\tconst maxFragmentUniforms = gl.getParameter( 36349 );\n\n\tconst vertexTextures = maxVertexTextures > 0;\n\tconst floatFragmentTextures = isWebGL2 || extensions.has( 'OES_texture_float' );\n\tconst floatVertexTextures = vertexTextures && floatFragmentTextures;\n\n\tconst maxSamples = isWebGL2 ? gl.getParameter( 36183 ) : 0;\n\n\treturn {\n\n\t\tisWebGL2: isWebGL2,\n\n\t\tdrawBuffers: drawBuffers,\n\n\t\tgetMaxAnisotropy: getMaxAnisotropy,\n\t\tgetMaxPrecision: getMaxPrecision,\n\n\t\tprecision: precision,\n\t\tlogarithmicDepthBuffer: logarithmicDepthBuffer,\n\n\t\tmaxTextures: maxTextures,\n\t\tmaxVertexTextures: maxVertexTextures,\n\t\tmaxTextureSize: maxTextureSize,\n\t\tmaxCubemapSize: maxCubemapSize,\n\n\t\tmaxAttributes: maxAttributes,\n\t\tmaxVertexUniforms: maxVertexUniforms,\n\t\tmaxVaryings: maxVaryings,\n\t\tmaxFragmentUniforms: maxFragmentUniforms,\n\n\t\tvertexTextures: vertexTextures,\n\t\tfloatFragmentTextures: floatFragmentTextures,\n\t\tfloatVertexTextures: floatVertexTextures,\n\n\t\tmaxSamples: maxSamples\n\n\t};\n\n}\n\nfunction WebGLClipping( properties ) {\n\n\tconst scope = this;\n\n\tlet globalState = null,\n\t\tnumGlobalPlanes = 0,\n\t\tlocalClippingEnabled = false,\n\t\trenderingShadows = false;\n\n\tconst plane = new Plane(),\n\t\tviewNormalMatrix = new Matrix3(),\n\n\t\tuniform = { value: null, needsUpdate: false };\n\n\tthis.uniform = uniform;\n\tthis.numPlanes = 0;\n\tthis.numIntersection = 0;\n\n\tthis.init = function ( planes, enableLocalClipping, camera ) {\n\n\t\tconst enabled =\n\t\t\tplanes.length !== 0 ||\n\t\t\tenableLocalClipping ||\n\t\t\t// enable state of previous frame - the clipping code has to\n\t\t\t// run another frame in order to reset the state:\n\t\t\tnumGlobalPlanes !== 0 ||\n\t\t\tlocalClippingEnabled;\n\n\t\tlocalClippingEnabled = enableLocalClipping;\n\n\t\tglobalState = projectPlanes( planes, camera, 0 );\n\t\tnumGlobalPlanes = planes.length;\n\n\t\treturn enabled;\n\n\t};\n\n\tthis.beginShadows = function () {\n\n\t\trenderingShadows = true;\n\t\tprojectPlanes( null );\n\n\t};\n\n\tthis.endShadows = function () {\n\n\t\trenderingShadows = false;\n\t\tresetGlobalState();\n\n\t};\n\n\tthis.setState = function ( material, camera, useCache ) {\n\n\t\tconst planes = material.clippingPlanes,\n\t\t\tclipIntersection = material.clipIntersection,\n\t\t\tclipShadows = material.clipShadows;\n\n\t\tconst materialProperties = properties.get( material );\n\n\t\tif ( ! localClippingEnabled || planes === null || planes.length === 0 || renderingShadows && ! clipShadows ) {\n\n\t\t\t// there's no local clipping\n\n\t\t\tif ( renderingShadows ) {\n\n\t\t\t\t// there's no global clipping\n\n\t\t\t\tprojectPlanes( null );\n\n\t\t\t} else {\n\n\t\t\t\tresetGlobalState();\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst nGlobal = renderingShadows ? 0 : numGlobalPlanes,\n\t\t\t\tlGlobal = nGlobal * 4;\n\n\t\t\tlet dstArray = materialProperties.clippingState || null;\n\n\t\t\tuniform.value = dstArray; // ensure unique state\n\n\t\t\tdstArray = projectPlanes( planes, camera, lGlobal, useCache );\n\n\t\t\tfor ( let i = 0; i !== lGlobal; ++ i ) {\n\n\t\t\t\tdstArray[ i ] = globalState[ i ];\n\n\t\t\t}\n\n\t\t\tmaterialProperties.clippingState = dstArray;\n\t\t\tthis.numIntersection = clipIntersection ? this.numPlanes : 0;\n\t\t\tthis.numPlanes += nGlobal;\n\n\t\t}\n\n\n\t};\n\n\tfunction resetGlobalState() {\n\n\t\tif ( uniform.value !== globalState ) {\n\n\t\t\tuniform.value = globalState;\n\t\t\tuniform.needsUpdate = numGlobalPlanes > 0;\n\n\t\t}\n\n\t\tscope.numPlanes = numGlobalPlanes;\n\t\tscope.numIntersection = 0;\n\n\t}\n\n\tfunction projectPlanes( planes, camera, dstOffset, skipTransform ) {\n\n\t\tconst nPlanes = planes !== null ? planes.length : 0;\n\t\tlet dstArray = null;\n\n\t\tif ( nPlanes !== 0 ) {\n\n\t\t\tdstArray = uniform.value;\n\n\t\t\tif ( skipTransform !== true || dstArray === null ) {\n\n\t\t\t\tconst flatSize = dstOffset + nPlanes * 4,\n\t\t\t\t\tviewMatrix = camera.matrixWorldInverse;\n\n\t\t\t\tviewNormalMatrix.getNormalMatrix( viewMatrix );\n\n\t\t\t\tif ( dstArray === null || dstArray.length < flatSize ) {\n\n\t\t\t\t\tdstArray = new Float32Array( flatSize );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0, i4 = dstOffset; i !== nPlanes; ++ i, i4 += 4 ) {\n\n\t\t\t\t\tplane.copy( planes[ i ] ).applyMatrix4( viewMatrix, viewNormalMatrix );\n\n\t\t\t\t\tplane.normal.toArray( dstArray, i4 );\n\t\t\t\t\tdstArray[ i4 + 3 ] = plane.constant;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tuniform.value = dstArray;\n\t\t\tuniform.needsUpdate = true;\n\n\t\t}\n\n\t\tscope.numPlanes = nPlanes;\n\t\tscope.numIntersection = 0;\n\n\t\treturn dstArray;\n\n\t}\n\n}\n\nfunction WebGLCubeMaps( renderer ) {\n\n\tlet cubemaps = new WeakMap();\n\n\tfunction mapTextureMapping( texture, mapping ) {\n\n\t\tif ( mapping === EquirectangularReflectionMapping ) {\n\n\t\t\ttexture.mapping = CubeReflectionMapping;\n\n\t\t} else if ( mapping === EquirectangularRefractionMapping ) {\n\n\t\t\ttexture.mapping = CubeRefractionMapping;\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tfunction get( texture ) {\n\n\t\tif ( texture && texture.isTexture && texture.isRenderTargetTexture === false ) {\n\n\t\t\tconst mapping = texture.mapping;\n\n\t\t\tif ( mapping === EquirectangularReflectionMapping || mapping === EquirectangularRefractionMapping ) {\n\n\t\t\t\tif ( cubemaps.has( texture ) ) {\n\n\t\t\t\t\tconst cubemap = cubemaps.get( texture ).texture;\n\t\t\t\t\treturn mapTextureMapping( cubemap, texture.mapping );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst image = texture.image;\n\n\t\t\t\t\tif ( image && image.height > 0 ) {\n\n\t\t\t\t\t\tconst renderTarget = new WebGLCubeRenderTarget( image.height / 2 );\n\t\t\t\t\t\trenderTarget.fromEquirectangularTexture( renderer, texture );\n\t\t\t\t\t\tcubemaps.set( texture, renderTarget );\n\n\t\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\t\t\t\treturn mapTextureMapping( renderTarget.texture, texture.mapping );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// image not yet ready. try the conversion next frame\n\n\t\t\t\t\t\treturn null;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tfunction onTextureDispose( event ) {\n\n\t\tconst texture = event.target;\n\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\n\n\t\tconst cubemap = cubemaps.get( texture );\n\n\t\tif ( cubemap !== undefined ) {\n\n\t\t\tcubemaps.delete( texture );\n\t\t\tcubemap.dispose();\n\n\t\t}\n\n\t}\n\n\tfunction dispose() {\n\n\t\tcubemaps = new WeakMap();\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tdispose: dispose\n\t};\n\n}\n\nclass OrthographicCamera extends Camera {\n\n\tconstructor( left = - 1, right = 1, top = 1, bottom = - 1, near = 0.1, far = 2000 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'OrthographicCamera';\n\n\t\tthis.zoom = 1;\n\t\tthis.view = null;\n\n\t\tthis.left = left;\n\t\tthis.right = right;\n\t\tthis.top = top;\n\t\tthis.bottom = bottom;\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.left = source.left;\n\t\tthis.right = source.right;\n\t\tthis.top = source.top;\n\t\tthis.bottom = source.bottom;\n\t\tthis.near = source.near;\n\t\tthis.far = source.far;\n\n\t\tthis.zoom = source.zoom;\n\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\treturn this;\n\n\t}\n\n\tsetViewOffset( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\tif ( this.view === null ) {\n\n\t\t\tthis.view = {\n\t\t\t\tenabled: true,\n\t\t\t\tfullWidth: 1,\n\t\t\t\tfullHeight: 1,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\twidth: 1,\n\t\t\t\theight: 1\n\t\t\t};\n\n\t\t}\n\n\t\tthis.view.enabled = true;\n\t\tthis.view.fullWidth = fullWidth;\n\t\tthis.view.fullHeight = fullHeight;\n\t\tthis.view.offsetX = x;\n\t\tthis.view.offsetY = y;\n\t\tthis.view.width = width;\n\t\tthis.view.height = height;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tclearViewOffset() {\n\n\t\tif ( this.view !== null ) {\n\n\t\t\tthis.view.enabled = false;\n\n\t\t}\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tupdateProjectionMatrix() {\n\n\t\tconst dx = ( this.right - this.left ) / ( 2 * this.zoom );\n\t\tconst dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\n\t\tconst cx = ( this.right + this.left ) / 2;\n\t\tconst cy = ( this.top + this.bottom ) / 2;\n\n\t\tlet left = cx - dx;\n\t\tlet right = cx + dx;\n\t\tlet top = cy + dy;\n\t\tlet bottom = cy - dy;\n\n\t\tif ( this.view !== null && this.view.enabled ) {\n\n\t\t\tconst scaleW = ( this.right - this.left ) / this.view.fullWidth / this.zoom;\n\t\t\tconst scaleH = ( this.top - this.bottom ) / this.view.fullHeight / this.zoom;\n\n\t\t\tleft += scaleW * this.view.offsetX;\n\t\t\tright = left + scaleW * this.view.width;\n\t\t\ttop -= scaleH * this.view.offsetY;\n\t\t\tbottom = top - scaleH * this.view.height;\n\n\t\t}\n\n\t\tthis.projectionMatrix.makeOrthographic( left, right, top, bottom, this.near, this.far );\n\n\t\tthis.projectionMatrixInverse.copy( this.projectionMatrix ).invert();\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.zoom = this.zoom;\n\t\tdata.object.left = this.left;\n\t\tdata.object.right = this.right;\n\t\tdata.object.top = this.top;\n\t\tdata.object.bottom = this.bottom;\n\t\tdata.object.near = this.near;\n\t\tdata.object.far = this.far;\n\n\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\treturn data;\n\n\t}\n\n}\n\nOrthographicCamera.prototype.isOrthographicCamera = true;\n\nclass RawShaderMaterial extends ShaderMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper( parameters );\n\n\t\tthis.type = 'RawShaderMaterial';\n\n\t}\n\n}\n\nRawShaderMaterial.prototype.isRawShaderMaterial = true;\n\nconst LOD_MIN = 4;\nconst LOD_MAX = 8;\nconst SIZE_MAX = Math.pow( 2, LOD_MAX );\n\n// The standard deviations (radians) associated with the extra mips. These are\n// chosen to approximate a Trowbridge-Reitz distribution function times the\n// geometric shadowing function. These sigma values squared must match the\n// variance #defines in cube_uv_reflection_fragment.glsl.js.\nconst EXTRA_LOD_SIGMA = [ 0.125, 0.215, 0.35, 0.446, 0.526, 0.582 ];\n\nconst TOTAL_LODS = LOD_MAX - LOD_MIN + 1 + EXTRA_LOD_SIGMA.length;\n\n// The maximum length of the blur for loop. Smaller sigmas will use fewer\n// samples and exit early, but not recompile the shader.\nconst MAX_SAMPLES = 20;\n\nconst _flatCamera = /*@__PURE__*/ new OrthographicCamera();\nconst { _lodPlanes, _sizeLods, _sigmas } = /*@__PURE__*/ _createPlanes();\nconst _clearColor = /*@__PURE__*/ new Color();\nlet _oldTarget = null;\n\n// Golden Ratio\nconst PHI = ( 1 + Math.sqrt( 5 ) ) / 2;\nconst INV_PHI = 1 / PHI;\n\n// Vertices of a dodecahedron (except the opposites, which represent the\n// same axis), used as axis directions evenly spread on a sphere.\nconst _axisDirections = [\n\t/*@__PURE__*/ new Vector3( 1, 1, 1 ),\n\t/*@__PURE__*/ new Vector3( - 1, 1, 1 ),\n\t/*@__PURE__*/ new Vector3( 1, 1, - 1 ),\n\t/*@__PURE__*/ new Vector3( - 1, 1, - 1 ),\n\t/*@__PURE__*/ new Vector3( 0, PHI, INV_PHI ),\n\t/*@__PURE__*/ new Vector3( 0, PHI, - INV_PHI ),\n\t/*@__PURE__*/ new Vector3( INV_PHI, 0, PHI ),\n\t/*@__PURE__*/ new Vector3( - INV_PHI, 0, PHI ),\n\t/*@__PURE__*/ new Vector3( PHI, INV_PHI, 0 ),\n\t/*@__PURE__*/ new Vector3( - PHI, INV_PHI, 0 ) ];\n\n/**\n * This class generates a Prefiltered, Mipmapped Radiance Environment Map\n * (PMREM) from a cubeMap environment texture. This allows different levels of\n * blur to be quickly accessed based on material roughness. It is packed into a\n * special CubeUV format that allows us to perform custom interpolation so that\n * we can support nonlinear formats such as RGBE. Unlike a traditional mipmap\n * chain, it only goes down to the LOD_MIN level (above), and then creates extra\n * even more filtered 'mips' at the same LOD_MIN resolution, associated with\n * higher roughness levels. In this way we maintain resolution to smoothly\n * interpolate diffuse lighting while limiting sampling computation.\n *\n * Paper: Fast, Accurate Image-Based Lighting\n * https://drive.google.com/file/d/15y8r_UpKlU9SvV4ILb0C3qCPecS8pvLz/view\n*/\n\nclass PMREMGenerator {\n\n\tconstructor( renderer ) {\n\n\t\tthis._renderer = renderer;\n\t\tthis._pingPongRenderTarget = null;\n\n\t\tthis._blurMaterial = _getBlurShader( MAX_SAMPLES );\n\t\tthis._equirectShader = null;\n\t\tthis._cubemapShader = null;\n\n\t\tthis._compileMaterial( this._blurMaterial );\n\n\t}\n\n\t/**\n\t * Generates a PMREM from a supplied Scene, which can be faster than using an\n\t * image if networking bandwidth is low. Optional sigma specifies a blur radius\n\t * in radians to be applied to the scene before PMREM generation. Optional near\n\t * and far planes ensure the scene is rendered in its entirety (the cubeCamera\n\t * is placed at the origin).\n\t */\n\tfromScene( scene, sigma = 0, near = 0.1, far = 100 ) {\n\n\t\t_oldTarget = this._renderer.getRenderTarget();\n\t\tconst cubeUVRenderTarget = this._allocateTargets();\n\n\t\tthis._sceneToCubeUV( scene, near, far, cubeUVRenderTarget );\n\t\tif ( sigma > 0 ) {\n\n\t\t\tthis._blur( cubeUVRenderTarget, 0, 0, sigma );\n\n\t\t}\n\n\t\tthis._applyPMREM( cubeUVRenderTarget );\n\t\tthis._cleanup( cubeUVRenderTarget );\n\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\t/**\n\t * Generates a PMREM from an equirectangular texture, which can be either LDR\n\t * or HDR. The ideal input image size is 1k (1024 x 512),\n\t * as this matches best with the 256 x 256 cubemap output.\n\t */\n\tfromEquirectangular( equirectangular, renderTarget = null ) {\n\n\t\treturn this._fromTexture( equirectangular, renderTarget );\n\n\t}\n\n\t/**\n\t * Generates a PMREM from an cubemap texture, which can be either LDR\n\t * or HDR. The ideal input cube size is 256 x 256,\n\t * as this matches best with the 256 x 256 cubemap output.\n\t */\n\tfromCubemap( cubemap, renderTarget = null ) {\n\n\t\treturn this._fromTexture( cubemap, renderTarget );\n\n\t}\n\n\t/**\n\t * Pre-compiles the cubemap shader. You can get faster start-up by invoking this method during\n\t * your texture's network fetch for increased concurrency.\n\t */\n\tcompileCubemapShader() {\n\n\t\tif ( this._cubemapShader === null ) {\n\n\t\t\tthis._cubemapShader = _getCubemapShader();\n\t\t\tthis._compileMaterial( this._cubemapShader );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Pre-compiles the equirectangular shader. You can get faster start-up by invoking this method during\n\t * your texture's network fetch for increased concurrency.\n\t */\n\tcompileEquirectangularShader() {\n\n\t\tif ( this._equirectShader === null ) {\n\n\t\t\tthis._equirectShader = _getEquirectShader();\n\t\t\tthis._compileMaterial( this._equirectShader );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Disposes of the PMREMGenerator's internal memory. Note that PMREMGenerator is a static class,\n\t * so you should not need more than one PMREMGenerator object. If you do, calling dispose() on\n\t * one of them will cause any others to also become unusable.\n\t */\n\tdispose() {\n\n\t\tthis._blurMaterial.dispose();\n\n\t\tif ( this._pingPongRenderTarget !== null ) this._pingPongRenderTarget.dispose();\n\n\t\tif ( this._cubemapShader !== null ) this._cubemapShader.dispose();\n\t\tif ( this._equirectShader !== null ) this._equirectShader.dispose();\n\n\t\tfor ( let i = 0; i < _lodPlanes.length; i ++ ) {\n\n\t\t\t_lodPlanes[ i ].dispose();\n\n\t\t}\n\n\t}\n\n\t// private interface\n\n\t_cleanup( outputTarget ) {\n\n\t\tthis._renderer.setRenderTarget( _oldTarget );\n\t\toutputTarget.scissorTest = false;\n\t\t_setViewport( outputTarget, 0, 0, outputTarget.width, outputTarget.height );\n\n\t}\n\n\t_fromTexture( texture, renderTarget ) {\n\n\t\t_oldTarget = this._renderer.getRenderTarget();\n\t\tconst cubeUVRenderTarget = renderTarget || this._allocateTargets( texture );\n\t\tthis._textureToCubeUV( texture, cubeUVRenderTarget );\n\t\tthis._applyPMREM( cubeUVRenderTarget );\n\t\tthis._cleanup( cubeUVRenderTarget );\n\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\t_allocateTargets( texture ) { // warning: null texture is valid\n\n\t\tconst params = {\n\t\t\tmagFilter: LinearFilter,\n\t\t\tminFilter: LinearFilter,\n\t\t\tgenerateMipmaps: false,\n\t\t\ttype: HalfFloatType,\n\t\t\tformat: RGBAFormat,\n\t\t\tencoding: LinearEncoding,\n\t\t\tdepthBuffer: false\n\t\t};\n\n\t\tconst cubeUVRenderTarget = _createRenderTarget( params );\n\t\tcubeUVRenderTarget.depthBuffer = texture ? false : true;\n\n\t\tif ( this._pingPongRenderTarget === null ) {\n\n\t\t\tthis._pingPongRenderTarget = _createRenderTarget( params );\n\n\t\t}\n\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\t_compileMaterial( material ) {\n\n\t\tconst tmpMesh = new Mesh( _lodPlanes[ 0 ], material );\n\t\tthis._renderer.compile( tmpMesh, _flatCamera );\n\n\t}\n\n\t_sceneToCubeUV( scene, near, far, cubeUVRenderTarget ) {\n\n\t\tconst fov = 90;\n\t\tconst aspect = 1;\n\t\tconst cubeCamera = new PerspectiveCamera( fov, aspect, near, far );\n\t\tconst upSign = [ 1, - 1, 1, 1, 1, 1 ];\n\t\tconst forwardSign = [ 1, 1, 1, - 1, - 1, - 1 ];\n\t\tconst renderer = this._renderer;\n\n\t\tconst originalAutoClear = renderer.autoClear;\n\t\tconst toneMapping = renderer.toneMapping;\n\t\trenderer.getClearColor( _clearColor );\n\n\t\trenderer.toneMapping = NoToneMapping;\n\t\trenderer.autoClear = false;\n\n\t\tconst backgroundMaterial = new MeshBasicMaterial( {\n\t\t\tname: 'PMREM.Background',\n\t\t\tside: BackSide,\n\t\t\tdepthWrite: false,\n\t\t\tdepthTest: false,\n\t\t} );\n\n\t\tconst backgroundBox = new Mesh( new BoxGeometry(), backgroundMaterial );\n\n\t\tlet useSolidColor = false;\n\t\tconst background = scene.background;\n\n\t\tif ( background ) {\n\n\t\t\tif ( background.isColor ) {\n\n\t\t\t\tbackgroundMaterial.color.copy( background );\n\t\t\t\tscene.background = null;\n\t\t\t\tuseSolidColor = true;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tbackgroundMaterial.color.copy( _clearColor );\n\t\t\tuseSolidColor = true;\n\n\t\t}\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst col = i % 3;\n\t\t\tif ( col === 0 ) {\n\n\t\t\t\tcubeCamera.up.set( 0, upSign[ i ], 0 );\n\t\t\t\tcubeCamera.lookAt( forwardSign[ i ], 0, 0 );\n\n\t\t\t} else if ( col === 1 ) {\n\n\t\t\t\tcubeCamera.up.set( 0, 0, upSign[ i ] );\n\t\t\t\tcubeCamera.lookAt( 0, forwardSign[ i ], 0 );\n\n\t\t\t} else {\n\n\t\t\t\tcubeCamera.up.set( 0, upSign[ i ], 0 );\n\t\t\t\tcubeCamera.lookAt( 0, 0, forwardSign[ i ] );\n\n\t\t\t}\n\n\t\t\t_setViewport( cubeUVRenderTarget,\n\t\t\t\tcol * SIZE_MAX, i > 2 ? SIZE_MAX : 0, SIZE_MAX, SIZE_MAX );\n\t\t\trenderer.setRenderTarget( cubeUVRenderTarget );\n\n\t\t\tif ( useSolidColor ) {\n\n\t\t\t\trenderer.render( backgroundBox, cubeCamera );\n\n\t\t\t}\n\n\t\t\trenderer.render( scene, cubeCamera );\n\n\t\t}\n\n\t\tbackgroundBox.geometry.dispose();\n\t\tbackgroundBox.material.dispose();\n\n\t\trenderer.toneMapping = toneMapping;\n\t\trenderer.autoClear = originalAutoClear;\n\t\tscene.background = background;\n\n\t}\n\n\t_textureToCubeUV( texture, cubeUVRenderTarget ) {\n\n\t\tconst renderer = this._renderer;\n\n\t\tconst isCubeTexture = ( texture.mapping === CubeReflectionMapping || texture.mapping === CubeRefractionMapping );\n\n\t\tif ( isCubeTexture ) {\n\n\t\t\tif ( this._cubemapShader === null ) {\n\n\t\t\t\tthis._cubemapShader = _getCubemapShader();\n\n\t\t\t}\n\n\t\t\tthis._cubemapShader.uniforms.flipEnvMap.value = ( texture.isRenderTargetTexture === false ) ? - 1 : 1;\n\n\t\t} else {\n\n\t\t\tif ( this._equirectShader === null ) {\n\n\t\t\t\tthis._equirectShader = _getEquirectShader();\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst material = isCubeTexture ? this._cubemapShader : this._equirectShader;\n\t\tconst mesh = new Mesh( _lodPlanes[ 0 ], material );\n\n\t\tconst uniforms = material.uniforms;\n\n\t\tuniforms[ 'envMap' ].value = texture;\n\n\t\tif ( ! isCubeTexture ) {\n\n\t\t\tuniforms[ 'texelSize' ].value.set( 1.0 / texture.image.width, 1.0 / texture.image.height );\n\n\t\t}\n\n\t\t_setViewport( cubeUVRenderTarget, 0, 0, 3 * SIZE_MAX, 2 * SIZE_MAX );\n\n\t\trenderer.setRenderTarget( cubeUVRenderTarget );\n\t\trenderer.render( mesh, _flatCamera );\n\n\t}\n\n\t_applyPMREM( cubeUVRenderTarget ) {\n\n\t\tconst renderer = this._renderer;\n\t\tconst autoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\tfor ( let i = 1; i < TOTAL_LODS; i ++ ) {\n\n\t\t\tconst sigma = Math.sqrt( _sigmas[ i ] * _sigmas[ i ] - _sigmas[ i - 1 ] * _sigmas[ i - 1 ] );\n\n\t\t\tconst poleAxis = _axisDirections[ ( i - 1 ) % _axisDirections.length ];\n\n\t\t\tthis._blur( cubeUVRenderTarget, i - 1, i, sigma, poleAxis );\n\n\t\t}\n\n\t\trenderer.autoClear = autoClear;\n\n\t}\n\n\t/**\n\t * This is a two-pass Gaussian blur for a cubemap. Normally this is done\n\t * vertically and horizontally, but this breaks down on a cube. Here we apply\n\t * the blur latitudinally (around the poles), and then longitudinally (towards\n\t * the poles) to approximate the orthogonally-separable blur. It is least\n\t * accurate at the poles, but still does a decent job.\n\t */\n\t_blur( cubeUVRenderTarget, lodIn, lodOut, sigma, poleAxis ) {\n\n\t\tconst pingPongRenderTarget = this._pingPongRenderTarget;\n\n\t\tthis._halfBlur(\n\t\t\tcubeUVRenderTarget,\n\t\t\tpingPongRenderTarget,\n\t\t\tlodIn,\n\t\t\tlodOut,\n\t\t\tsigma,\n\t\t\t'latitudinal',\n\t\t\tpoleAxis );\n\n\t\tthis._halfBlur(\n\t\t\tpingPongRenderTarget,\n\t\t\tcubeUVRenderTarget,\n\t\t\tlodOut,\n\t\t\tlodOut,\n\t\t\tsigma,\n\t\t\t'longitudinal',\n\t\t\tpoleAxis );\n\n\t}\n\n\t_halfBlur( targetIn, targetOut, lodIn, lodOut, sigmaRadians, direction, poleAxis ) {\n\n\t\tconst renderer = this._renderer;\n\t\tconst blurMaterial = this._blurMaterial;\n\n\t\tif ( direction !== 'latitudinal' && direction !== 'longitudinal' ) {\n\n\t\t\tconsole.error(\n\t\t\t\t'blur direction must be either latitudinal or longitudinal!' );\n\n\t\t}\n\n\t\t// Number of standard deviations at which to cut off the discrete approximation.\n\t\tconst STANDARD_DEVIATIONS = 3;\n\n\t\tconst blurMesh = new Mesh( _lodPlanes[ lodOut ], blurMaterial );\n\t\tconst blurUniforms = blurMaterial.uniforms;\n\n\t\tconst pixels = _sizeLods[ lodIn ] - 1;\n\t\tconst radiansPerPixel = isFinite( sigmaRadians ) ? Math.PI / ( 2 * pixels ) : 2 * Math.PI / ( 2 * MAX_SAMPLES - 1 );\n\t\tconst sigmaPixels = sigmaRadians / radiansPerPixel;\n\t\tconst samples = isFinite( sigmaRadians ) ? 1 + Math.floor( STANDARD_DEVIATIONS * sigmaPixels ) : MAX_SAMPLES;\n\n\t\tif ( samples > MAX_SAMPLES ) {\n\n\t\t\tconsole.warn( `sigmaRadians, ${\n\t\t\t\tsigmaRadians}, is too large and will clip, as it requested ${\n\t\t\t\tsamples} samples when the maximum is set to ${MAX_SAMPLES}` );\n\n\t\t}\n\n\t\tconst weights = [];\n\t\tlet sum = 0;\n\n\t\tfor ( let i = 0; i < MAX_SAMPLES; ++ i ) {\n\n\t\t\tconst x = i / sigmaPixels;\n\t\t\tconst weight = Math.exp( - x * x / 2 );\n\t\t\tweights.push( weight );\n\n\t\t\tif ( i === 0 ) {\n\n\t\t\t\tsum += weight;\n\n\t\t\t} else if ( i < samples ) {\n\n\t\t\t\tsum += 2 * weight;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( let i = 0; i < weights.length; i ++ ) {\n\n\t\t\tweights[ i ] = weights[ i ] / sum;\n\n\t\t}\n\n\t\tblurUniforms[ 'envMap' ].value = targetIn.texture;\n\t\tblurUniforms[ 'samples' ].value = samples;\n\t\tblurUniforms[ 'weights' ].value = weights;\n\t\tblurUniforms[ 'latitudinal' ].value = direction === 'latitudinal';\n\n\t\tif ( poleAxis ) {\n\n\t\t\tblurUniforms[ 'poleAxis' ].value = poleAxis;\n\n\t\t}\n\n\t\tblurUniforms[ 'dTheta' ].value = radiansPerPixel;\n\t\tblurUniforms[ 'mipInt' ].value = LOD_MAX - lodIn;\n\n\t\tconst outputSize = _sizeLods[ lodOut ];\n\t\tconst x = 3 * Math.max( 0, SIZE_MAX - 2 * outputSize );\n\t\tconst y = ( lodOut === 0 ? 0 : 2 * SIZE_MAX ) + 2 * outputSize * ( lodOut > LOD_MAX - LOD_MIN ? lodOut - LOD_MAX + LOD_MIN : 0 );\n\n\t\t_setViewport( targetOut, x, y, 3 * outputSize, 2 * outputSize );\n\t\trenderer.setRenderTarget( targetOut );\n\t\trenderer.render( blurMesh, _flatCamera );\n\n\t}\n\n}\n\nfunction _createPlanes() {\n\n\tconst _lodPlanes = [];\n\tconst _sizeLods = [];\n\tconst _sigmas = [];\n\n\tlet lod = LOD_MAX;\n\n\tfor ( let i = 0; i < TOTAL_LODS; i ++ ) {\n\n\t\tconst sizeLod = Math.pow( 2, lod );\n\t\t_sizeLods.push( sizeLod );\n\t\tlet sigma = 1.0 / sizeLod;\n\n\t\tif ( i > LOD_MAX - LOD_MIN ) {\n\n\t\t\tsigma = EXTRA_LOD_SIGMA[ i - LOD_MAX + LOD_MIN - 1 ];\n\n\t\t} else if ( i === 0 ) {\n\n\t\t\tsigma = 0;\n\n\t\t}\n\n\t\t_sigmas.push( sigma );\n\n\t\tconst texelSize = 1.0 / ( sizeLod - 1 );\n\t\tconst min = - texelSize / 2;\n\t\tconst max = 1 + texelSize / 2;\n\t\tconst uv1 = [ min, min, max, min, max, max, min, min, max, max, min, max ];\n\n\t\tconst cubeFaces = 6;\n\t\tconst vertices = 6;\n\t\tconst positionSize = 3;\n\t\tconst uvSize = 2;\n\t\tconst faceIndexSize = 1;\n\n\t\tconst position = new Float32Array( positionSize * vertices * cubeFaces );\n\t\tconst uv = new Float32Array( uvSize * vertices * cubeFaces );\n\t\tconst faceIndex = new Float32Array( faceIndexSize * vertices * cubeFaces );\n\n\t\tfor ( let face = 0; face < cubeFaces; face ++ ) {\n\n\t\t\tconst x = ( face % 3 ) * 2 / 3 - 1;\n\t\t\tconst y = face > 2 ? 0 : - 1;\n\t\t\tconst coordinates = [\n\t\t\t\tx, y, 0,\n\t\t\t\tx + 2 / 3, y, 0,\n\t\t\t\tx + 2 / 3, y + 1, 0,\n\t\t\t\tx, y, 0,\n\t\t\t\tx + 2 / 3, y + 1, 0,\n\t\t\t\tx, y + 1, 0\n\t\t\t];\n\t\t\tposition.set( coordinates, positionSize * vertices * face );\n\t\t\tuv.set( uv1, uvSize * vertices * face );\n\t\t\tconst fill = [ face, face, face, face, face, face ];\n\t\t\tfaceIndex.set( fill, faceIndexSize * vertices * face );\n\n\t\t}\n\n\t\tconst planes = new BufferGeometry();\n\t\tplanes.setAttribute( 'position', new BufferAttribute( position, positionSize ) );\n\t\tplanes.setAttribute( 'uv', new BufferAttribute( uv, uvSize ) );\n\t\tplanes.setAttribute( 'faceIndex', new BufferAttribute( faceIndex, faceIndexSize ) );\n\t\t_lodPlanes.push( planes );\n\n\t\tif ( lod > LOD_MIN ) {\n\n\t\t\tlod --;\n\n\t\t}\n\n\t}\n\n\treturn { _lodPlanes, _sizeLods, _sigmas };\n\n}\n\nfunction _createRenderTarget( params ) {\n\n\tconst cubeUVRenderTarget = new WebGLRenderTarget( 3 * SIZE_MAX, 3 * SIZE_MAX, params );\n\tcubeUVRenderTarget.texture.mapping = CubeUVReflectionMapping;\n\tcubeUVRenderTarget.texture.name = 'PMREM.cubeUv';\n\tcubeUVRenderTarget.scissorTest = true;\n\treturn cubeUVRenderTarget;\n\n}\n\nfunction _setViewport( target, x, y, width, height ) {\n\n\ttarget.viewport.set( x, y, width, height );\n\ttarget.scissor.set( x, y, width, height );\n\n}\n\nfunction _getBlurShader( maxSamples ) {\n\n\tconst weights = new Float32Array( maxSamples );\n\tconst poleAxis = new Vector3( 0, 1, 0 );\n\tconst shaderMaterial = new RawShaderMaterial( {\n\n\t\tname: 'SphericalGaussianBlur',\n\n\t\tdefines: { 'n': maxSamples },\n\n\t\tuniforms: {\n\t\t\t'envMap': { value: null },\n\t\t\t'samples': { value: 1 },\n\t\t\t'weights': { value: weights },\n\t\t\t'latitudinal': { value: false },\n\t\t\t'dTheta': { value: 0 },\n\t\t\t'mipInt': { value: 0 },\n\t\t\t'poleAxis': { value: poleAxis }\n\t\t},\n\n\t\tvertexShader: _getCommonVertexShader(),\n\n\t\tfragmentShader: /* glsl */`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t`,\n\n\t\tblending: NoBlending,\n\t\tdepthTest: false,\n\t\tdepthWrite: false\n\n\t} );\n\n\treturn shaderMaterial;\n\n}\n\nfunction _getEquirectShader() {\n\n\tconst texelSize = new Vector2( 1, 1 );\n\tconst shaderMaterial = new RawShaderMaterial( {\n\n\t\tname: 'EquirectangularToCubeUV',\n\n\t\tuniforms: {\n\t\t\t'envMap': { value: null },\n\t\t\t'texelSize': { value: texelSize }\n\t\t},\n\n\t\tvertexShader: _getCommonVertexShader(),\n\n\t\tfragmentShader: /* glsl */`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = texture2D ( envMap, uv ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t}\n\t\t`,\n\n\t\tblending: NoBlending,\n\t\tdepthTest: false,\n\t\tdepthWrite: false\n\n\t} );\n\n\treturn shaderMaterial;\n\n}\n\nfunction _getCubemapShader() {\n\n\tconst shaderMaterial = new RawShaderMaterial( {\n\n\t\tname: 'CubemapToCubeUV',\n\n\t\tuniforms: {\n\t\t\t'envMap': { value: null },\n\t\t\t'flipEnvMap': { value: - 1 }\n\t\t},\n\n\t\tvertexShader: _getCommonVertexShader(),\n\n\t\tfragmentShader: /* glsl */`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t`,\n\n\t\tblending: NoBlending,\n\t\tdepthTest: false,\n\t\tdepthWrite: false\n\n\t} );\n\n\treturn shaderMaterial;\n\n}\n\nfunction _getCommonVertexShader() {\n\n\treturn /* glsl */`\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t`;\n\n}\n\nfunction WebGLCubeUVMaps( renderer ) {\n\n\tlet cubeUVmaps = new WeakMap();\n\n\tlet pmremGenerator = null;\n\n\tfunction get( texture ) {\n\n\t\tif ( texture && texture.isTexture ) {\n\n\t\t\tconst mapping = texture.mapping;\n\n\t\t\tconst isEquirectMap = ( mapping === EquirectangularReflectionMapping || mapping === EquirectangularRefractionMapping );\n\t\t\tconst isCubeMap = ( mapping === CubeReflectionMapping || mapping === CubeRefractionMapping );\n\n\t\t\t// equirect/cube map to cubeUV conversion\n\n\t\t\tif ( isEquirectMap || isCubeMap ) {\n\n\t\t\t\tif ( texture.isRenderTargetTexture && texture.needsPMREMUpdate === true ) {\n\n\t\t\t\t\ttexture.needsPMREMUpdate = false;\n\n\t\t\t\t\tlet renderTarget = cubeUVmaps.get( texture );\n\n\t\t\t\t\tif ( pmremGenerator === null ) pmremGenerator = new PMREMGenerator( renderer );\n\n\t\t\t\t\trenderTarget = isEquirectMap ? pmremGenerator.fromEquirectangular( texture, renderTarget ) : pmremGenerator.fromCubemap( texture, renderTarget );\n\t\t\t\t\tcubeUVmaps.set( texture, renderTarget );\n\n\t\t\t\t\treturn renderTarget.texture;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( cubeUVmaps.has( texture ) ) {\n\n\t\t\t\t\t\treturn cubeUVmaps.get( texture ).texture;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst image = texture.image;\n\n\t\t\t\t\t\tif ( ( isEquirectMap && image && image.height > 0 ) || ( isCubeMap && image && isCubeTextureComplete( image ) ) ) {\n\n\t\t\t\t\t\t\tif ( pmremGenerator === null ) pmremGenerator = new PMREMGenerator( renderer );\n\n\t\t\t\t\t\t\tconst renderTarget = isEquirectMap ? pmremGenerator.fromEquirectangular( texture ) : pmremGenerator.fromCubemap( texture );\n\t\t\t\t\t\t\tcubeUVmaps.set( texture, renderTarget );\n\n\t\t\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\t\t\t\t\treturn renderTarget.texture;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// image not yet ready. try the conversion next frame\n\n\t\t\t\t\t\t\treturn null;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tfunction isCubeTextureComplete( image ) {\n\n\t\tlet count = 0;\n\t\tconst length = 6;\n\n\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\tif ( image[ i ] !== undefined ) count ++;\n\n\t\t}\n\n\t\treturn count === length;\n\n\n\t}\n\n\tfunction onTextureDispose( event ) {\n\n\t\tconst texture = event.target;\n\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\n\n\t\tconst cubemapUV = cubeUVmaps.get( texture );\n\n\t\tif ( cubemapUV !== undefined ) {\n\n\t\t\tcubeUVmaps.delete( texture );\n\t\t\tcubemapUV.dispose();\n\n\t\t}\n\n\t}\n\n\tfunction dispose() {\n\n\t\tcubeUVmaps = new WeakMap();\n\n\t\tif ( pmremGenerator !== null ) {\n\n\t\t\tpmremGenerator.dispose();\n\t\t\tpmremGenerator = null;\n\n\t\t}\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tdispose: dispose\n\t};\n\n}\n\nfunction WebGLExtensions( gl ) {\n\n\tconst extensions = {};\n\n\tfunction getExtension( name ) {\n\n\t\tif ( extensions[ name ] !== undefined ) {\n\n\t\t\treturn extensions[ name ];\n\n\t\t}\n\n\t\tlet extension;\n\n\t\tswitch ( name ) {\n\n\t\t\tcase 'WEBGL_depth_texture':\n\t\t\t\textension = gl.getExtension( 'WEBGL_depth_texture' ) || gl.getExtension( 'MOZ_WEBGL_depth_texture' ) || gl.getExtension( 'WEBKIT_WEBGL_depth_texture' );\n\t\t\t\tbreak;\n\n\t\t\tcase 'EXT_texture_filter_anisotropic':\n\t\t\t\textension = gl.getExtension( 'EXT_texture_filter_anisotropic' ) || gl.getExtension( 'MOZ_EXT_texture_filter_anisotropic' ) || gl.getExtension( 'WEBKIT_EXT_texture_filter_anisotropic' );\n\t\t\t\tbreak;\n\n\t\t\tcase 'WEBGL_compressed_texture_s3tc':\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'MOZ_WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_s3tc' );\n\t\t\t\tbreak;\n\n\t\t\tcase 'WEBGL_compressed_texture_pvrtc':\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_pvrtc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_pvrtc' );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\textension = gl.getExtension( name );\n\n\t\t}\n\n\t\textensions[ name ] = extension;\n\n\t\treturn extension;\n\n\t}\n\n\treturn {\n\n\t\thas: function ( name ) {\n\n\t\t\treturn getExtension( name ) !== null;\n\n\t\t},\n\n\t\tinit: function ( capabilities ) {\n\n\t\t\tif ( capabilities.isWebGL2 ) {\n\n\t\t\t\tgetExtension( 'EXT_color_buffer_float' );\n\n\t\t\t} else {\n\n\t\t\t\tgetExtension( 'WEBGL_depth_texture' );\n\t\t\t\tgetExtension( 'OES_texture_float' );\n\t\t\t\tgetExtension( 'OES_texture_half_float' );\n\t\t\t\tgetExtension( 'OES_texture_half_float_linear' );\n\t\t\t\tgetExtension( 'OES_standard_derivatives' );\n\t\t\t\tgetExtension( 'OES_element_index_uint' );\n\t\t\t\tgetExtension( 'OES_vertex_array_object' );\n\t\t\t\tgetExtension( 'ANGLE_instanced_arrays' );\n\n\t\t\t}\n\n\t\t\tgetExtension( 'OES_texture_float_linear' );\n\t\t\tgetExtension( 'EXT_color_buffer_half_float' );\n\t\t\tgetExtension( 'WEBGL_multisampled_render_to_texture' );\n\n\t\t},\n\n\t\tget: function ( name ) {\n\n\t\t\tconst extension = getExtension( name );\n\n\t\t\tif ( extension === null ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: ' + name + ' extension not supported.' );\n\n\t\t\t}\n\n\t\t\treturn extension;\n\n\t\t}\n\n\t};\n\n}\n\nfunction WebGLGeometries( gl, attributes, info, bindingStates ) {\n\n\tconst geometries = {};\n\tconst wireframeAttributes = new WeakMap();\n\n\tfunction onGeometryDispose( event ) {\n\n\t\tconst geometry = event.target;\n\n\t\tif ( geometry.index !== null ) {\n\n\t\t\tattributes.remove( geometry.index );\n\n\t\t}\n\n\t\tfor ( const name in geometry.attributes ) {\n\n\t\t\tattributes.remove( geometry.attributes[ name ] );\n\n\t\t}\n\n\t\tgeometry.removeEventListener( 'dispose', onGeometryDispose );\n\n\t\tdelete geometries[ geometry.id ];\n\n\t\tconst attribute = wireframeAttributes.get( geometry );\n\n\t\tif ( attribute ) {\n\n\t\t\tattributes.remove( attribute );\n\t\t\twireframeAttributes.delete( geometry );\n\n\t\t}\n\n\t\tbindingStates.releaseStatesOfGeometry( geometry );\n\n\t\tif ( geometry.isInstancedBufferGeometry === true ) {\n\n\t\t\tdelete geometry._maxInstanceCount;\n\n\t\t}\n\n\t\t//\n\n\t\tinfo.memory.geometries --;\n\n\t}\n\n\tfunction get( object, geometry ) {\n\n\t\tif ( geometries[ geometry.id ] === true ) return geometry;\n\n\t\tgeometry.addEventListener( 'dispose', onGeometryDispose );\n\n\t\tgeometries[ geometry.id ] = true;\n\n\t\tinfo.memory.geometries ++;\n\n\t\treturn geometry;\n\n\t}\n\n\tfunction update( geometry ) {\n\n\t\tconst geometryAttributes = geometry.attributes;\n\n\t\t// Updating index buffer in VAO now. See WebGLBindingStates.\n\n\t\tfor ( const name in geometryAttributes ) {\n\n\t\t\tattributes.update( geometryAttributes[ name ], 34962 );\n\n\t\t}\n\n\t\t// morph targets\n\n\t\tconst morphAttributes = geometry.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst array = morphAttributes[ name ];\n\n\t\t\tfor ( let i = 0, l = array.length; i < l; i ++ ) {\n\n\t\t\t\tattributes.update( array[ i ], 34962 );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction updateWireframeAttribute( geometry ) {\n\n\t\tconst indices = [];\n\n\t\tconst geometryIndex = geometry.index;\n\t\tconst geometryPosition = geometry.attributes.position;\n\t\tlet version = 0;\n\n\t\tif ( geometryIndex !== null ) {\n\n\t\t\tconst array = geometryIndex.array;\n\t\t\tversion = geometryIndex.version;\n\n\t\t\tfor ( let i = 0, l = array.length; i < l; i += 3 ) {\n\n\t\t\t\tconst a = array[ i + 0 ];\n\t\t\t\tconst b = array[ i + 1 ];\n\t\t\t\tconst c = array[ i + 2 ];\n\n\t\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst array = geometryPosition.array;\n\t\t\tversion = geometryPosition.version;\n\n\t\t\tfor ( let i = 0, l = ( array.length / 3 ) - 1; i < l; i += 3 ) {\n\n\t\t\t\tconst a = i + 0;\n\t\t\t\tconst b = i + 1;\n\t\t\t\tconst c = i + 2;\n\n\t\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst attribute = new ( arrayNeedsUint32( indices ) ? Uint32BufferAttribute : Uint16BufferAttribute )( indices, 1 );\n\t\tattribute.version = version;\n\n\t\t// Updating index buffer in VAO now. See WebGLBindingStates\n\n\t\t//\n\n\t\tconst previousAttribute = wireframeAttributes.get( geometry );\n\n\t\tif ( previousAttribute ) attributes.remove( previousAttribute );\n\n\t\t//\n\n\t\twireframeAttributes.set( geometry, attribute );\n\n\t}\n\n\tfunction getWireframeAttribute( geometry ) {\n\n\t\tconst currentAttribute = wireframeAttributes.get( geometry );\n\n\t\tif ( currentAttribute ) {\n\n\t\t\tconst geometryIndex = geometry.index;\n\n\t\t\tif ( geometryIndex !== null ) {\n\n\t\t\t\t// if the attribute is obsolete, create a new one\n\n\t\t\t\tif ( currentAttribute.version < geometryIndex.version ) {\n\n\t\t\t\t\tupdateWireframeAttribute( geometry );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tupdateWireframeAttribute( geometry );\n\n\t\t}\n\n\t\treturn wireframeAttributes.get( geometry );\n\n\t}\n\n\treturn {\n\n\t\tget: get,\n\t\tupdate: update,\n\n\t\tgetWireframeAttribute: getWireframeAttribute\n\n\t};\n\n}\n\nfunction WebGLIndexedBufferRenderer( gl, extensions, info, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tlet mode;\n\n\tfunction setMode( value ) {\n\n\t\tmode = value;\n\n\t}\n\n\tlet type, bytesPerElement;\n\n\tfunction setIndex( value ) {\n\n\t\ttype = value.type;\n\t\tbytesPerElement = value.bytesPerElement;\n\n\t}\n\n\tfunction render( start, count ) {\n\n\t\tgl.drawElements( mode, count, type, start * bytesPerElement );\n\n\t\tinfo.update( count, mode, 1 );\n\n\t}\n\n\tfunction renderInstances( start, count, primcount ) {\n\n\t\tif ( primcount === 0 ) return;\n\n\t\tlet extension, methodName;\n\n\t\tif ( isWebGL2 ) {\n\n\t\t\textension = gl;\n\t\t\tmethodName = 'drawElementsInstanced';\n\n\t\t} else {\n\n\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\n\t\t\tmethodName = 'drawElementsInstancedANGLE';\n\n\t\t\tif ( extension === null ) {\n\n\t\t\t\tconsole.error( 'THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\textension[ methodName ]( mode, count, type, start * bytesPerElement, primcount );\n\n\t\tinfo.update( count, mode, primcount );\n\n\t}\n\n\t//\n\n\tthis.setMode = setMode;\n\tthis.setIndex = setIndex;\n\tthis.render = render;\n\tthis.renderInstances = renderInstances;\n\n}\n\nfunction WebGLInfo( gl ) {\n\n\tconst memory = {\n\t\tgeometries: 0,\n\t\ttextures: 0\n\t};\n\n\tconst render = {\n\t\tframe: 0,\n\t\tcalls: 0,\n\t\ttriangles: 0,\n\t\tpoints: 0,\n\t\tlines: 0\n\t};\n\n\tfunction update( count, mode, instanceCount ) {\n\n\t\trender.calls ++;\n\n\t\tswitch ( mode ) {\n\n\t\t\tcase 4:\n\t\t\t\trender.triangles += instanceCount * ( count / 3 );\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\t\t\t\trender.lines += instanceCount * ( count / 2 );\n\t\t\t\tbreak;\n\n\t\t\tcase 3:\n\t\t\t\trender.lines += instanceCount * ( count - 1 );\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\t\t\t\trender.lines += instanceCount * count;\n\t\t\t\tbreak;\n\n\t\t\tcase 0:\n\t\t\t\trender.points += instanceCount * count;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'THREE.WebGLInfo: Unknown draw mode:', mode );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction reset() {\n\n\t\trender.frame ++;\n\t\trender.calls = 0;\n\t\trender.triangles = 0;\n\t\trender.points = 0;\n\t\trender.lines = 0;\n\n\t}\n\n\treturn {\n\t\tmemory: memory,\n\t\trender: render,\n\t\tprograms: null,\n\t\tautoReset: true,\n\t\treset: reset,\n\t\tupdate: update\n\t};\n\n}\n\nclass DataTexture2DArray extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, depth = 1 ) {\n\n\t\tsuper( null );\n\n\t\tthis.image = { data, width, height, depth };\n\n\t\tthis.magFilter = NearestFilter;\n\t\tthis.minFilter = NearestFilter;\n\n\t\tthis.wrapR = ClampToEdgeWrapping;\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t}\n\n}\n\nDataTexture2DArray.prototype.isDataTexture2DArray = true;\n\nfunction numericalSort( a, b ) {\n\n\treturn a[ 0 ] - b[ 0 ];\n\n}\n\nfunction absNumericalSort( a, b ) {\n\n\treturn Math.abs( b[ 1 ] ) - Math.abs( a[ 1 ] );\n\n}\n\nfunction denormalize( morph, attribute ) {\n\n\tlet denominator = 1;\n\tconst array = attribute.isInterleavedBufferAttribute ? attribute.data.array : attribute.array;\n\n\tif ( array instanceof Int8Array ) denominator = 127;\n\telse if ( array instanceof Int16Array ) denominator = 32767;\n\telse if ( array instanceof Int32Array ) denominator = 2147483647;\n\telse console.error( 'THREE.WebGLMorphtargets: Unsupported morph attribute data type: ', array );\n\n\tmorph.divideScalar( denominator );\n\n}\n\nfunction WebGLMorphtargets( gl, capabilities, textures ) {\n\n\tconst influencesList = {};\n\tconst morphInfluences = new Float32Array( 8 );\n\tconst morphTextures = new WeakMap();\n\tconst morph = new Vector3();\n\n\tconst workInfluences = [];\n\n\tfor ( let i = 0; i < 8; i ++ ) {\n\n\t\tworkInfluences[ i ] = [ i, 0 ];\n\n\t}\n\n\tfunction update( object, geometry, material, program ) {\n\n\t\tconst objectInfluences = object.morphTargetInfluences;\n\n\t\tif ( capabilities.isWebGL2 === true ) {\n\n\t\t\t// instead of using attributes, the WebGL 2 code path encodes morph targets\n\t\t\t// into an array of data textures. Each layer represents a single morph target.\n\n\t\t\tconst numberOfMorphTargets = geometry.morphAttributes.position.length;\n\n\t\t\tlet entry = morphTextures.get( geometry );\n\n\t\t\tif ( entry === undefined || entry.count !== numberOfMorphTargets ) {\n\n\t\t\t\tif ( entry !== undefined ) entry.texture.dispose();\n\n\t\t\t\tconst hasMorphNormals = geometry.morphAttributes.normal !== undefined;\n\n\t\t\t\tconst morphTargets = geometry.morphAttributes.position;\n\t\t\t\tconst morphNormals = geometry.morphAttributes.normal || [];\n\n\t\t\t\tconst numberOfVertices = geometry.attributes.position.count;\n\t\t\t\tconst numberOfVertexData = ( hasMorphNormals === true ) ? 2 : 1; // (v,n) vs. (v)\n\n\t\t\t\tlet width = numberOfVertices * numberOfVertexData;\n\t\t\t\tlet height = 1;\n\n\t\t\t\tif ( width > capabilities.maxTextureSize ) {\n\n\t\t\t\t\theight = Math.ceil( width / capabilities.maxTextureSize );\n\t\t\t\t\twidth = capabilities.maxTextureSize;\n\n\t\t\t\t}\n\n\t\t\t\tconst buffer = new Float32Array( width * height * 4 * numberOfMorphTargets );\n\n\t\t\t\tconst texture = new DataTexture2DArray( buffer, width, height, numberOfMorphTargets );\n\t\t\t\ttexture.format = RGBAFormat; // using RGBA since RGB might be emulated (and is thus slower)\n\t\t\t\ttexture.type = FloatType;\n\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t// fill buffer\n\n\t\t\t\tconst vertexDataStride = numberOfVertexData * 4;\n\n\t\t\t\tfor ( let i = 0; i < numberOfMorphTargets; i ++ ) {\n\n\t\t\t\t\tconst morphTarget = morphTargets[ i ];\n\t\t\t\t\tconst morphNormal = morphNormals[ i ];\n\n\t\t\t\t\tconst offset = width * height * 4 * i;\n\n\t\t\t\t\tfor ( let j = 0; j < morphTarget.count; j ++ ) {\n\n\t\t\t\t\t\tmorph.fromBufferAttribute( morphTarget, j );\n\n\t\t\t\t\t\tif ( morphTarget.normalized === true ) denormalize( morph, morphTarget );\n\n\t\t\t\t\t\tconst stride = j * vertexDataStride;\n\n\t\t\t\t\t\tbuffer[ offset + stride + 0 ] = morph.x;\n\t\t\t\t\t\tbuffer[ offset + stride + 1 ] = morph.y;\n\t\t\t\t\t\tbuffer[ offset + stride + 2 ] = morph.z;\n\t\t\t\t\t\tbuffer[ offset + stride + 3 ] = 0;\n\n\t\t\t\t\t\tif ( hasMorphNormals === true ) {\n\n\t\t\t\t\t\t\tmorph.fromBufferAttribute( morphNormal, j );\n\n\t\t\t\t\t\t\tif ( morphNormal.normalized === true ) denormalize( morph, morphNormal );\n\n\t\t\t\t\t\t\tbuffer[ offset + stride + 4 ] = morph.x;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 5 ] = morph.y;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 6 ] = morph.z;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 7 ] = 0;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tentry = {\n\t\t\t\t\tcount: numberOfMorphTargets,\n\t\t\t\t\ttexture: texture,\n\t\t\t\t\tsize: new Vector2( width, height )\n\t\t\t\t};\n\n\t\t\t\tmorphTextures.set( geometry, entry );\n\n\t\t\t\tfunction disposeTexture() {\n\n\t\t\t\t\ttexture.dispose();\n\n\t\t\t\t\tmorphTextures.delete( geometry );\n\n\t\t\t\t\tgeometry.removeEventListener( 'dispose', disposeTexture );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.addEventListener( 'dispose', disposeTexture );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tlet morphInfluencesSum = 0;\n\n\t\t\tfor ( let i = 0; i < objectInfluences.length; i ++ ) {\n\n\t\t\t\tmorphInfluencesSum += objectInfluences[ i ];\n\n\t\t\t}\n\n\t\t\tconst morphBaseInfluence = geometry.morphTargetsRelative ? 1 : 1 - morphInfluencesSum;\n\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetBaseInfluence', morphBaseInfluence );\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetInfluences', objectInfluences );\n\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetsTexture', entry.texture, textures );\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetsTextureSize', entry.size );\n\n\n\t\t} else {\n\n\t\t\t// When object doesn't have morph target influences defined, we treat it as a 0-length array\n\t\t\t// This is important to make sure we set up morphTargetBaseInfluence / morphTargetInfluences\n\n\t\t\tconst length = objectInfluences === undefined ? 0 : objectInfluences.length;\n\n\t\t\tlet influences = influencesList[ geometry.id ];\n\n\t\t\tif ( influences === undefined || influences.length !== length ) {\n\n\t\t\t\t// initialise list\n\n\t\t\t\tinfluences = [];\n\n\t\t\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\t\t\tinfluences[ i ] = [ i, 0 ];\n\n\t\t\t\t}\n\n\t\t\t\tinfluencesList[ geometry.id ] = influences;\n\n\t\t\t}\n\n\t\t\t// Collect influences\n\n\t\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\t\tconst influence = influences[ i ];\n\n\t\t\t\tinfluence[ 0 ] = i;\n\t\t\t\tinfluence[ 1 ] = objectInfluences[ i ];\n\n\t\t\t}\n\n\t\t\tinfluences.sort( absNumericalSort );\n\n\t\t\tfor ( let i = 0; i < 8; i ++ ) {\n\n\t\t\t\tif ( i < length && influences[ i ][ 1 ] ) {\n\n\t\t\t\t\tworkInfluences[ i ][ 0 ] = influences[ i ][ 0 ];\n\t\t\t\t\tworkInfluences[ i ][ 1 ] = influences[ i ][ 1 ];\n\n\t\t\t\t} else {\n\n\t\t\t\t\tworkInfluences[ i ][ 0 ] = Number.MAX_SAFE_INTEGER;\n\t\t\t\t\tworkInfluences[ i ][ 1 ] = 0;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tworkInfluences.sort( numericalSort );\n\n\t\t\tconst morphTargets = geometry.morphAttributes.position;\n\t\t\tconst morphNormals = geometry.morphAttributes.normal;\n\n\t\t\tlet morphInfluencesSum = 0;\n\n\t\t\tfor ( let i = 0; i < 8; i ++ ) {\n\n\t\t\t\tconst influence = workInfluences[ i ];\n\t\t\t\tconst index = influence[ 0 ];\n\t\t\t\tconst value = influence[ 1 ];\n\n\t\t\t\tif ( index !== Number.MAX_SAFE_INTEGER && value ) {\n\n\t\t\t\t\tif ( morphTargets && geometry.getAttribute( 'morphTarget' + i ) !== morphTargets[ index ] ) {\n\n\t\t\t\t\t\tgeometry.setAttribute( 'morphTarget' + i, morphTargets[ index ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( morphNormals && geometry.getAttribute( 'morphNormal' + i ) !== morphNormals[ index ] ) {\n\n\t\t\t\t\t\tgeometry.setAttribute( 'morphNormal' + i, morphNormals[ index ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmorphInfluences[ i ] = value;\n\t\t\t\t\tmorphInfluencesSum += value;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( morphTargets && geometry.hasAttribute( 'morphTarget' + i ) === true ) {\n\n\t\t\t\t\t\tgeometry.deleteAttribute( 'morphTarget' + i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( morphNormals && geometry.hasAttribute( 'morphNormal' + i ) === true ) {\n\n\t\t\t\t\t\tgeometry.deleteAttribute( 'morphNormal' + i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmorphInfluences[ i ] = 0;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// GLSL shader uses formula baseinfluence * base + sum(target * influence)\n\t\t\t// This allows us to switch between absolute morphs and relative morphs without changing shader code\n\t\t\t// When baseinfluence = 1 - sum(influence), the above is equivalent to sum((target - base) * influence)\n\t\t\tconst morphBaseInfluence = geometry.morphTargetsRelative ? 1 : 1 - morphInfluencesSum;\n\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetBaseInfluence', morphBaseInfluence );\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetInfluences', morphInfluences );\n\n\t\t}\n\n\t}\n\n\treturn {\n\n\t\tupdate: update\n\n\t};\n\n}\n\nfunction WebGLObjects( gl, geometries, attributes, info ) {\n\n\tlet updateMap = new WeakMap();\n\n\tfunction update( object ) {\n\n\t\tconst frame = info.render.frame;\n\n\t\tconst geometry = object.geometry;\n\t\tconst buffergeometry = geometries.get( object, geometry );\n\n\t\t// Update once per frame\n\n\t\tif ( updateMap.get( buffergeometry ) !== frame ) {\n\n\t\t\tgeometries.update( buffergeometry );\n\n\t\t\tupdateMap.set( buffergeometry, frame );\n\n\t\t}\n\n\t\tif ( object.isInstancedMesh ) {\n\n\t\t\tif ( object.hasEventListener( 'dispose', onInstancedMeshDispose ) === false ) {\n\n\t\t\t\tobject.addEventListener( 'dispose', onInstancedMeshDispose );\n\n\t\t\t}\n\n\t\t\tattributes.update( object.instanceMatrix, 34962 );\n\n\t\t\tif ( object.instanceColor !== null ) {\n\n\t\t\t\tattributes.update( object.instanceColor, 34962 );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn buffergeometry;\n\n\t}\n\n\tfunction dispose() {\n\n\t\tupdateMap = new WeakMap();\n\n\t}\n\n\tfunction onInstancedMeshDispose( event ) {\n\n\t\tconst instancedMesh = event.target;\n\n\t\tinstancedMesh.removeEventListener( 'dispose', onInstancedMeshDispose );\n\n\t\tattributes.remove( instancedMesh.instanceMatrix );\n\n\t\tif ( instancedMesh.instanceColor !== null ) attributes.remove( instancedMesh.instanceColor );\n\n\t}\n\n\treturn {\n\n\t\tupdate: update,\n\t\tdispose: dispose\n\n\t};\n\n}\n\nclass DataTexture3D extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, depth = 1 ) {\n\n\t\t// We're going to add .setXXX() methods for setting properties later.\n\t\t// Users can still set in DataTexture3D directly.\n\t\t//\n\t\t//\tconst texture = new THREE.DataTexture3D( data, width, height, depth );\n\t\t// \ttexture.anisotropy = 16;\n\t\t//\n\t\t// See #14839\n\n\t\tsuper( null );\n\n\t\tthis.image = { data, width, height, depth };\n\n\t\tthis.magFilter = NearestFilter;\n\t\tthis.minFilter = NearestFilter;\n\n\t\tthis.wrapR = ClampToEdgeWrapping;\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t}\n\n}\n\nDataTexture3D.prototype.isDataTexture3D = true;\n\n/**\n * Uniforms of a program.\n * Those form a tree structure with a special top-level container for the root,\n * which you get by calling 'new WebGLUniforms( gl, program )'.\n *\n *\n * Properties of inner nodes including the top-level container:\n *\n * .seq - array of nested uniforms\n * .map - nested uniforms by name\n *\n *\n * Methods of all nodes except the top-level container:\n *\n * .setValue( gl, value, [textures] )\n *\n * \t\tuploads a uniform value(s)\n *  \tthe 'textures' parameter is needed for sampler uniforms\n *\n *\n * Static methods of the top-level container (textures factorizations):\n *\n * .upload( gl, seq, values, textures )\n *\n * \t\tsets uniforms in 'seq' to 'values[id].value'\n *\n * .seqWithValue( seq, values ) : filteredSeq\n *\n * \t\tfilters 'seq' entries with corresponding entry in values\n *\n *\n * Methods of the top-level container (textures factorizations):\n *\n * .setValue( gl, name, value, textures )\n *\n * \t\tsets uniform with  name 'name' to 'value'\n *\n * .setOptional( gl, obj, prop )\n *\n * \t\tlike .set for an optional property of the object\n *\n */\n\nconst emptyTexture = new Texture();\nconst emptyTexture2dArray = new DataTexture2DArray();\nconst emptyTexture3d = new DataTexture3D();\nconst emptyCubeTexture = new CubeTexture();\n\n// --- Utilities ---\n\n// Array Caches (provide typed arrays for temporary by size)\n\nconst arrayCacheF32 = [];\nconst arrayCacheI32 = [];\n\n// Float32Array caches used for uploading Matrix uniforms\n\nconst mat4array = new Float32Array( 16 );\nconst mat3array = new Float32Array( 9 );\nconst mat2array = new Float32Array( 4 );\n\n// Flattening for arrays of vectors and matrices\n\nfunction flatten( array, nBlocks, blockSize ) {\n\n\tconst firstElem = array[ 0 ];\n\n\tif ( firstElem <= 0 || firstElem > 0 ) return array;\n\t// unoptimized: ! isNaN( firstElem )\n\t// see http://jacksondunstan.com/articles/983\n\n\tconst n = nBlocks * blockSize;\n\tlet r = arrayCacheF32[ n ];\n\n\tif ( r === undefined ) {\n\n\t\tr = new Float32Array( n );\n\t\tarrayCacheF32[ n ] = r;\n\n\t}\n\n\tif ( nBlocks !== 0 ) {\n\n\t\tfirstElem.toArray( r, 0 );\n\n\t\tfor ( let i = 1, offset = 0; i !== nBlocks; ++ i ) {\n\n\t\t\toffset += blockSize;\n\t\t\tarray[ i ].toArray( r, offset );\n\n\t\t}\n\n\t}\n\n\treturn r;\n\n}\n\nfunction arraysEqual( a, b ) {\n\n\tif ( a.length !== b.length ) return false;\n\n\tfor ( let i = 0, l = a.length; i < l; i ++ ) {\n\n\t\tif ( a[ i ] !== b[ i ] ) return false;\n\n\t}\n\n\treturn true;\n\n}\n\nfunction copyArray( a, b ) {\n\n\tfor ( let i = 0, l = b.length; i < l; i ++ ) {\n\n\t\ta[ i ] = b[ i ];\n\n\t}\n\n}\n\n// Texture unit allocation\n\nfunction allocTexUnits( textures, n ) {\n\n\tlet r = arrayCacheI32[ n ];\n\n\tif ( r === undefined ) {\n\n\t\tr = new Int32Array( n );\n\t\tarrayCacheI32[ n ] = r;\n\n\t}\n\n\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\tr[ i ] = textures.allocateTextureUnit();\n\n\t}\n\n\treturn r;\n\n}\n\n// --- Setters ---\n\n// Note: Defining these methods externally, because they come in a bunch\n// and this way their names minify.\n\n// Single scalar\n\nfunction setValueV1f( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( cache[ 0 ] === v ) return;\n\n\tgl.uniform1f( this.addr, v );\n\n\tcache[ 0 ] = v;\n\n}\n\n// Single float vector (from flat array or THREE.VectorN)\n\nfunction setValueV2f( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y ) {\n\n\t\t\tgl.uniform2f( this.addr, v.x, v.y );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform2fv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\nfunction setValueV3f( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y || cache[ 2 ] !== v.z ) {\n\n\t\t\tgl.uniform3f( this.addr, v.x, v.y, v.z );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\t\t\tcache[ 2 ] = v.z;\n\n\t\t}\n\n\t} else if ( v.r !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.r || cache[ 1 ] !== v.g || cache[ 2 ] !== v.b ) {\n\n\t\t\tgl.uniform3f( this.addr, v.r, v.g, v.b );\n\n\t\t\tcache[ 0 ] = v.r;\n\t\t\tcache[ 1 ] = v.g;\n\t\t\tcache[ 2 ] = v.b;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform3fv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\nfunction setValueV4f( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y || cache[ 2 ] !== v.z || cache[ 3 ] !== v.w ) {\n\n\t\t\tgl.uniform4f( this.addr, v.x, v.y, v.z, v.w );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\t\t\tcache[ 2 ] = v.z;\n\t\t\tcache[ 3 ] = v.w;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform4fv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\n// Single matrix (from flat array or THREE.MatrixN)\n\nfunction setValueM2( gl, v ) {\n\n\tconst cache = this.cache;\n\tconst elements = v.elements;\n\n\tif ( elements === undefined ) {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniformMatrix2fv( this.addr, false, v );\n\n\t\tcopyArray( cache, v );\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, elements ) ) return;\n\n\t\tmat2array.set( elements );\n\n\t\tgl.uniformMatrix2fv( this.addr, false, mat2array );\n\n\t\tcopyArray( cache, elements );\n\n\t}\n\n}\n\nfunction setValueM3( gl, v ) {\n\n\tconst cache = this.cache;\n\tconst elements = v.elements;\n\n\tif ( elements === undefined ) {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniformMatrix3fv( this.addr, false, v );\n\n\t\tcopyArray( cache, v );\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, elements ) ) return;\n\n\t\tmat3array.set( elements );\n\n\t\tgl.uniformMatrix3fv( this.addr, false, mat3array );\n\n\t\tcopyArray( cache, elements );\n\n\t}\n\n}\n\nfunction setValueM4( gl, v ) {\n\n\tconst cache = this.cache;\n\tconst elements = v.elements;\n\n\tif ( elements === undefined ) {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniformMatrix4fv( this.addr, false, v );\n\n\t\tcopyArray( cache, v );\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, elements ) ) return;\n\n\t\tmat4array.set( elements );\n\n\t\tgl.uniformMatrix4fv( this.addr, false, mat4array );\n\n\t\tcopyArray( cache, elements );\n\n\t}\n\n}\n\n// Single integer / boolean\n\nfunction setValueV1i( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( cache[ 0 ] === v ) return;\n\n\tgl.uniform1i( this.addr, v );\n\n\tcache[ 0 ] = v;\n\n}\n\n// Single integer / boolean vector (from flat array)\n\nfunction setValueV2i( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( arraysEqual( cache, v ) ) return;\n\n\tgl.uniform2iv( this.addr, v );\n\n\tcopyArray( cache, v );\n\n}\n\nfunction setValueV3i( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( arraysEqual( cache, v ) ) return;\n\n\tgl.uniform3iv( this.addr, v );\n\n\tcopyArray( cache, v );\n\n}\n\nfunction setValueV4i( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( arraysEqual( cache, v ) ) return;\n\n\tgl.uniform4iv( this.addr, v );\n\n\tcopyArray( cache, v );\n\n}\n\n// Single unsigned integer\n\nfunction setValueV1ui( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( cache[ 0 ] === v ) return;\n\n\tgl.uniform1ui( this.addr, v );\n\n\tcache[ 0 ] = v;\n\n}\n\n// Single unsigned integer vector (from flat array)\n\nfunction setValueV2ui( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( arraysEqual( cache, v ) ) return;\n\n\tgl.uniform2uiv( this.addr, v );\n\n\tcopyArray( cache, v );\n\n}\n\nfunction setValueV3ui( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( arraysEqual( cache, v ) ) return;\n\n\tgl.uniform3uiv( this.addr, v );\n\n\tcopyArray( cache, v );\n\n}\n\nfunction setValueV4ui( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( arraysEqual( cache, v ) ) return;\n\n\tgl.uniform4uiv( this.addr, v );\n\n\tcopyArray( cache, v );\n\n}\n\n\n// Single texture (2D / Cube)\n\nfunction setValueT1( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\tconst unit = textures.allocateTextureUnit();\n\n\tif ( cache[ 0 ] !== unit ) {\n\n\t\tgl.uniform1i( this.addr, unit );\n\t\tcache[ 0 ] = unit;\n\n\t}\n\n\ttextures.safeSetTexture2D( v || emptyTexture, unit );\n\n}\n\nfunction setValueT3D1( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\tconst unit = textures.allocateTextureUnit();\n\n\tif ( cache[ 0 ] !== unit ) {\n\n\t\tgl.uniform1i( this.addr, unit );\n\t\tcache[ 0 ] = unit;\n\n\t}\n\n\ttextures.setTexture3D( v || emptyTexture3d, unit );\n\n}\n\nfunction setValueT6( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\tconst unit = textures.allocateTextureUnit();\n\n\tif ( cache[ 0 ] !== unit ) {\n\n\t\tgl.uniform1i( this.addr, unit );\n\t\tcache[ 0 ] = unit;\n\n\t}\n\n\ttextures.safeSetTextureCube( v || emptyCubeTexture, unit );\n\n}\n\nfunction setValueT2DArray1( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\tconst unit = textures.allocateTextureUnit();\n\n\tif ( cache[ 0 ] !== unit ) {\n\n\t\tgl.uniform1i( this.addr, unit );\n\t\tcache[ 0 ] = unit;\n\n\t}\n\n\ttextures.setTexture2DArray( v || emptyTexture2dArray, unit );\n\n}\n\n// Helper to pick the right setter for the singular case\n\nfunction getSingularSetter( type ) {\n\n\tswitch ( type ) {\n\n\t\tcase 0x1406: return setValueV1f; // FLOAT\n\t\tcase 0x8b50: return setValueV2f; // _VEC2\n\t\tcase 0x8b51: return setValueV3f; // _VEC3\n\t\tcase 0x8b52: return setValueV4f; // _VEC4\n\n\t\tcase 0x8b5a: return setValueM2; // _MAT2\n\t\tcase 0x8b5b: return setValueM3; // _MAT3\n\t\tcase 0x8b5c: return setValueM4; // _MAT4\n\n\t\tcase 0x1404: case 0x8b56: return setValueV1i; // INT, BOOL\n\t\tcase 0x8b53: case 0x8b57: return setValueV2i; // _VEC2\n\t\tcase 0x8b54: case 0x8b58: return setValueV3i; // _VEC3\n\t\tcase 0x8b55: case 0x8b59: return setValueV4i; // _VEC4\n\n\t\tcase 0x1405: return setValueV1ui; // UINT\n\t\tcase 0x8dc6: return setValueV2ui; // _VEC2\n\t\tcase 0x8dc7: return setValueV3ui; // _VEC3\n\t\tcase 0x8dc8: return setValueV4ui; // _VEC4\n\n\t\tcase 0x8b5e: // SAMPLER_2D\n\t\tcase 0x8d66: // SAMPLER_EXTERNAL_OES\n\t\tcase 0x8dca: // INT_SAMPLER_2D\n\t\tcase 0x8dd2: // UNSIGNED_INT_SAMPLER_2D\n\t\tcase 0x8b62: // SAMPLER_2D_SHADOW\n\t\t\treturn setValueT1;\n\n\t\tcase 0x8b5f: // SAMPLER_3D\n\t\tcase 0x8dcb: // INT_SAMPLER_3D\n\t\tcase 0x8dd3: // UNSIGNED_INT_SAMPLER_3D\n\t\t\treturn setValueT3D1;\n\n\t\tcase 0x8b60: // SAMPLER_CUBE\n\t\tcase 0x8dcc: // INT_SAMPLER_CUBE\n\t\tcase 0x8dd4: // UNSIGNED_INT_SAMPLER_CUBE\n\t\tcase 0x8dc5: // SAMPLER_CUBE_SHADOW\n\t\t\treturn setValueT6;\n\n\t\tcase 0x8dc1: // SAMPLER_2D_ARRAY\n\t\tcase 0x8dcf: // INT_SAMPLER_2D_ARRAY\n\t\tcase 0x8dd7: // UNSIGNED_INT_SAMPLER_2D_ARRAY\n\t\tcase 0x8dc4: // SAMPLER_2D_ARRAY_SHADOW\n\t\t\treturn setValueT2DArray1;\n\n\t}\n\n}\n\n\n// Array of scalars\n\nfunction setValueV1fArray( gl, v ) {\n\n\tgl.uniform1fv( this.addr, v );\n\n}\n\n// Array of vectors (from flat array or array of THREE.VectorN)\n\nfunction setValueV2fArray( gl, v ) {\n\n\tconst data = flatten( v, this.size, 2 );\n\n\tgl.uniform2fv( this.addr, data );\n\n}\n\nfunction setValueV3fArray( gl, v ) {\n\n\tconst data = flatten( v, this.size, 3 );\n\n\tgl.uniform3fv( this.addr, data );\n\n}\n\nfunction setValueV4fArray( gl, v ) {\n\n\tconst data = flatten( v, this.size, 4 );\n\n\tgl.uniform4fv( this.addr, data );\n\n}\n\n// Array of matrices (from flat array or array of THREE.MatrixN)\n\nfunction setValueM2Array( gl, v ) {\n\n\tconst data = flatten( v, this.size, 4 );\n\n\tgl.uniformMatrix2fv( this.addr, false, data );\n\n}\n\nfunction setValueM3Array( gl, v ) {\n\n\tconst data = flatten( v, this.size, 9 );\n\n\tgl.uniformMatrix3fv( this.addr, false, data );\n\n}\n\nfunction setValueM4Array( gl, v ) {\n\n\tconst data = flatten( v, this.size, 16 );\n\n\tgl.uniformMatrix4fv( this.addr, false, data );\n\n}\n\n// Array of integer / boolean\n\nfunction setValueV1iArray( gl, v ) {\n\n\tgl.uniform1iv( this.addr, v );\n\n}\n\n// Array of integer / boolean vectors (from flat array)\n\nfunction setValueV2iArray( gl, v ) {\n\n\tgl.uniform2iv( this.addr, v );\n\n}\n\nfunction setValueV3iArray( gl, v ) {\n\n\tgl.uniform3iv( this.addr, v );\n\n}\n\nfunction setValueV4iArray( gl, v ) {\n\n\tgl.uniform4iv( this.addr, v );\n\n}\n\n// Array of unsigned integer\n\nfunction setValueV1uiArray( gl, v ) {\n\n\tgl.uniform1uiv( this.addr, v );\n\n}\n\n// Array of unsigned integer vectors (from flat array)\n\nfunction setValueV2uiArray( gl, v ) {\n\n\tgl.uniform2uiv( this.addr, v );\n\n}\n\nfunction setValueV3uiArray( gl, v ) {\n\n\tgl.uniform3uiv( this.addr, v );\n\n}\n\nfunction setValueV4uiArray( gl, v ) {\n\n\tgl.uniform4uiv( this.addr, v );\n\n}\n\n\n// Array of textures (2D / 3D / Cube / 2DArray)\n\nfunction setValueT1Array( gl, v, textures ) {\n\n\tconst n = v.length;\n\n\tconst units = allocTexUnits( textures, n );\n\n\tgl.uniform1iv( this.addr, units );\n\n\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\ttextures.safeSetTexture2D( v[ i ] || emptyTexture, units[ i ] );\n\n\t}\n\n}\n\nfunction setValueT3DArray( gl, v, textures ) {\n\n\tconst n = v.length;\n\n\tconst units = allocTexUnits( textures, n );\n\n\tgl.uniform1iv( this.addr, units );\n\n\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\ttextures.setTexture3D( v[ i ] || emptyTexture3d, units[ i ] );\n\n\t}\n\n}\n\nfunction setValueT6Array( gl, v, textures ) {\n\n\tconst n = v.length;\n\n\tconst units = allocTexUnits( textures, n );\n\n\tgl.uniform1iv( this.addr, units );\n\n\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\ttextures.safeSetTextureCube( v[ i ] || emptyCubeTexture, units[ i ] );\n\n\t}\n\n}\n\nfunction setValueT2DArrayArray( gl, v, textures ) {\n\n\tconst n = v.length;\n\n\tconst units = allocTexUnits( textures, n );\n\n\tgl.uniform1iv( this.addr, units );\n\n\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\ttextures.setTexture2DArray( v[ i ] || emptyTexture2dArray, units[ i ] );\n\n\t}\n\n}\n\n\n// Helper to pick the right setter for a pure (bottom-level) array\n\nfunction getPureArraySetter( type ) {\n\n\tswitch ( type ) {\n\n\t\tcase 0x1406: return setValueV1fArray; // FLOAT\n\t\tcase 0x8b50: return setValueV2fArray; // _VEC2\n\t\tcase 0x8b51: return setValueV3fArray; // _VEC3\n\t\tcase 0x8b52: return setValueV4fArray; // _VEC4\n\n\t\tcase 0x8b5a: return setValueM2Array; // _MAT2\n\t\tcase 0x8b5b: return setValueM3Array; // _MAT3\n\t\tcase 0x8b5c: return setValueM4Array; // _MAT4\n\n\t\tcase 0x1404: case 0x8b56: return setValueV1iArray; // INT, BOOL\n\t\tcase 0x8b53: case 0x8b57: return setValueV2iArray; // _VEC2\n\t\tcase 0x8b54: case 0x8b58: return setValueV3iArray; // _VEC3\n\t\tcase 0x8b55: case 0x8b59: return setValueV4iArray; // _VEC4\n\n\t\tcase 0x1405: return setValueV1uiArray; // UINT\n\t\tcase 0x8dc6: return setValueV2uiArray; // _VEC2\n\t\tcase 0x8dc7: return setValueV3uiArray; // _VEC3\n\t\tcase 0x8dc8: return setValueV4uiArray; // _VEC4\n\n\t\tcase 0x8b5e: // SAMPLER_2D\n\t\tcase 0x8d66: // SAMPLER_EXTERNAL_OES\n\t\tcase 0x8dca: // INT_SAMPLER_2D\n\t\tcase 0x8dd2: // UNSIGNED_INT_SAMPLER_2D\n\t\tcase 0x8b62: // SAMPLER_2D_SHADOW\n\t\t\treturn setValueT1Array;\n\n\t\tcase 0x8b5f: // SAMPLER_3D\n\t\tcase 0x8dcb: // INT_SAMPLER_3D\n\t\tcase 0x8dd3: // UNSIGNED_INT_SAMPLER_3D\n\t\t\treturn setValueT3DArray;\n\n\t\tcase 0x8b60: // SAMPLER_CUBE\n\t\tcase 0x8dcc: // INT_SAMPLER_CUBE\n\t\tcase 0x8dd4: // UNSIGNED_INT_SAMPLER_CUBE\n\t\tcase 0x8dc5: // SAMPLER_CUBE_SHADOW\n\t\t\treturn setValueT6Array;\n\n\t\tcase 0x8dc1: // SAMPLER_2D_ARRAY\n\t\tcase 0x8dcf: // INT_SAMPLER_2D_ARRAY\n\t\tcase 0x8dd7: // UNSIGNED_INT_SAMPLER_2D_ARRAY\n\t\tcase 0x8dc4: // SAMPLER_2D_ARRAY_SHADOW\n\t\t\treturn setValueT2DArrayArray;\n\n\t}\n\n}\n\n// --- Uniform Classes ---\n\nfunction SingleUniform( id, activeInfo, addr ) {\n\n\tthis.id = id;\n\tthis.addr = addr;\n\tthis.cache = [];\n\tthis.setValue = getSingularSetter( activeInfo.type );\n\n\t// this.path = activeInfo.name; // DEBUG\n\n}\n\nfunction PureArrayUniform( id, activeInfo, addr ) {\n\n\tthis.id = id;\n\tthis.addr = addr;\n\tthis.cache = [];\n\tthis.size = activeInfo.size;\n\tthis.setValue = getPureArraySetter( activeInfo.type );\n\n\t// this.path = activeInfo.name; // DEBUG\n\n}\n\nPureArrayUniform.prototype.updateCache = function ( data ) {\n\n\tconst cache = this.cache;\n\n\tif ( data instanceof Float32Array && cache.length !== data.length ) {\n\n\t\tthis.cache = new Float32Array( data.length );\n\n\t}\n\n\tcopyArray( cache, data );\n\n};\n\nfunction StructuredUniform( id ) {\n\n\tthis.id = id;\n\n\tthis.seq = [];\n\tthis.map = {};\n\n}\n\nStructuredUniform.prototype.setValue = function ( gl, value, textures ) {\n\n\tconst seq = this.seq;\n\n\tfor ( let i = 0, n = seq.length; i !== n; ++ i ) {\n\n\t\tconst u = seq[ i ];\n\t\tu.setValue( gl, value[ u.id ], textures );\n\n\t}\n\n};\n\n// --- Top-level ---\n\n// Parser - builds up the property tree from the path strings\n\nconst RePathPart = /(\\w+)(\\])?(\\[|\\.)?/g;\n\n// extracts\n// \t- the identifier (member name or array index)\n//  - followed by an optional right bracket (found when array index)\n//  - followed by an optional left bracket or dot (type of subscript)\n//\n// Note: These portions can be read in a non-overlapping fashion and\n// allow straightforward parsing of the hierarchy that WebGL encodes\n// in the uniform names.\n\nfunction addUniform( container, uniformObject ) {\n\n\tcontainer.seq.push( uniformObject );\n\tcontainer.map[ uniformObject.id ] = uniformObject;\n\n}\n\nfunction parseUniform( activeInfo, addr, container ) {\n\n\tconst path = activeInfo.name,\n\t\tpathLength = path.length;\n\n\t// reset RegExp object, because of the early exit of a previous run\n\tRePathPart.lastIndex = 0;\n\n\twhile ( true ) {\n\n\t\tconst match = RePathPart.exec( path ),\n\t\t\tmatchEnd = RePathPart.lastIndex;\n\n\t\tlet id = match[ 1 ];\n\t\tconst idIsIndex = match[ 2 ] === ']',\n\t\t\tsubscript = match[ 3 ];\n\n\t\tif ( idIsIndex ) id = id | 0; // convert to integer\n\n\t\tif ( subscript === undefined || subscript === '[' && matchEnd + 2 === pathLength ) {\n\n\t\t\t// bare name or \"pure\" bottom-level array \"[0]\" suffix\n\n\t\t\taddUniform( container, subscript === undefined ?\n\t\t\t\tnew SingleUniform( id, activeInfo, addr ) :\n\t\t\t\tnew PureArrayUniform( id, activeInfo, addr ) );\n\n\t\t\tbreak;\n\n\t\t} else {\n\n\t\t\t// step into inner node / create it in case it doesn't exist\n\n\t\t\tconst map = container.map;\n\t\t\tlet next = map[ id ];\n\n\t\t\tif ( next === undefined ) {\n\n\t\t\t\tnext = new StructuredUniform( id );\n\t\t\t\taddUniform( container, next );\n\n\t\t\t}\n\n\t\t\tcontainer = next;\n\n\t\t}\n\n\t}\n\n}\n\n// Root Container\n\nfunction WebGLUniforms( gl, program ) {\n\n\tthis.seq = [];\n\tthis.map = {};\n\n\tconst n = gl.getProgramParameter( program, 35718 );\n\n\tfor ( let i = 0; i < n; ++ i ) {\n\n\t\tconst info = gl.getActiveUniform( program, i ),\n\t\t\taddr = gl.getUniformLocation( program, info.name );\n\n\t\tparseUniform( info, addr, this );\n\n\t}\n\n}\n\nWebGLUniforms.prototype.setValue = function ( gl, name, value, textures ) {\n\n\tconst u = this.map[ name ];\n\n\tif ( u !== undefined ) u.setValue( gl, value, textures );\n\n};\n\nWebGLUniforms.prototype.setOptional = function ( gl, object, name ) {\n\n\tconst v = object[ name ];\n\n\tif ( v !== undefined ) this.setValue( gl, name, v );\n\n};\n\n\n// Static interface\n\nWebGLUniforms.upload = function ( gl, seq, values, textures ) {\n\n\tfor ( let i = 0, n = seq.length; i !== n; ++ i ) {\n\n\t\tconst u = seq[ i ],\n\t\t\tv = values[ u.id ];\n\n\t\tif ( v.needsUpdate !== false ) {\n\n\t\t\t// note: always updating when .needsUpdate is undefined\n\t\t\tu.setValue( gl, v.value, textures );\n\n\t\t}\n\n\t}\n\n};\n\nWebGLUniforms.seqWithValue = function ( seq, values ) {\n\n\tconst r = [];\n\n\tfor ( let i = 0, n = seq.length; i !== n; ++ i ) {\n\n\t\tconst u = seq[ i ];\n\t\tif ( u.id in values ) r.push( u );\n\n\t}\n\n\treturn r;\n\n};\n\nfunction WebGLShader( gl, type, string ) {\n\n\tconst shader = gl.createShader( type );\n\n\tgl.shaderSource( shader, string );\n\tgl.compileShader( shader );\n\n\treturn shader;\n\n}\n\nlet programIdCount = 0;\n\nfunction addLineNumbers( string ) {\n\n\tconst lines = string.split( '\\n' );\n\n\tfor ( let i = 0; i < lines.length; i ++ ) {\n\n\t\tlines[ i ] = ( i + 1 ) + ': ' + lines[ i ];\n\n\t}\n\n\treturn lines.join( '\\n' );\n\n}\n\nfunction getEncodingComponents( encoding ) {\n\n\tswitch ( encoding ) {\n\n\t\tcase LinearEncoding:\n\t\t\treturn [ 'Linear', '( value )' ];\n\t\tcase sRGBEncoding:\n\t\t\treturn [ 'sRGB', '( value )' ];\n\t\tdefault:\n\t\t\tconsole.warn( 'THREE.WebGLProgram: Unsupported encoding:', encoding );\n\t\t\treturn [ 'Linear', '( value )' ];\n\n\t}\n\n}\n\nfunction getShaderErrors( gl, shader, type ) {\n\n\tconst status = gl.getShaderParameter( shader, 35713 );\n\tconst errors = gl.getShaderInfoLog( shader ).trim();\n\n\tif ( status && errors === '' ) return '';\n\n\t// --enable-privileged-webgl-extension\n\t// console.log( '**' + type + '**', gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\n\n\treturn type.toUpperCase() + '\\n\\n' + errors + '\\n\\n' + addLineNumbers( gl.getShaderSource( shader ) );\n\n}\n\nfunction getTexelEncodingFunction( functionName, encoding ) {\n\n\tconst components = getEncodingComponents( encoding );\n\treturn 'vec4 ' + functionName + '( vec4 value ) { return LinearTo' + components[ 0 ] + components[ 1 ] + '; }';\n\n}\n\nfunction getToneMappingFunction( functionName, toneMapping ) {\n\n\tlet toneMappingName;\n\n\tswitch ( toneMapping ) {\n\n\t\tcase LinearToneMapping:\n\t\t\ttoneMappingName = 'Linear';\n\t\t\tbreak;\n\n\t\tcase ReinhardToneMapping:\n\t\t\ttoneMappingName = 'Reinhard';\n\t\t\tbreak;\n\n\t\tcase CineonToneMapping:\n\t\t\ttoneMappingName = 'OptimizedCineon';\n\t\t\tbreak;\n\n\t\tcase ACESFilmicToneMapping:\n\t\t\ttoneMappingName = 'ACESFilmic';\n\t\t\tbreak;\n\n\t\tcase CustomToneMapping:\n\t\t\ttoneMappingName = 'Custom';\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tconsole.warn( 'THREE.WebGLProgram: Unsupported toneMapping:', toneMapping );\n\t\t\ttoneMappingName = 'Linear';\n\n\t}\n\n\treturn 'vec3 ' + functionName + '( vec3 color ) { return ' + toneMappingName + 'ToneMapping( color ); }';\n\n}\n\nfunction generateExtensions( parameters ) {\n\n\tconst chunks = [\n\t\t( parameters.extensionDerivatives || parameters.envMapCubeUV || parameters.bumpMap || parameters.tangentSpaceNormalMap || parameters.clearcoatNormalMap || parameters.flatShading || parameters.shaderID === 'physical' ) ? '#extension GL_OES_standard_derivatives : enable' : '',\n\t\t( parameters.extensionFragDepth || parameters.logarithmicDepthBuffer ) && parameters.rendererExtensionFragDepth ? '#extension GL_EXT_frag_depth : enable' : '',\n\t\t( parameters.extensionDrawBuffers && parameters.rendererExtensionDrawBuffers ) ? '#extension GL_EXT_draw_buffers : require' : '',\n\t\t( parameters.extensionShaderTextureLOD || parameters.envMap || parameters.transmission ) && parameters.rendererExtensionShaderTextureLod ? '#extension GL_EXT_shader_texture_lod : enable' : ''\n\t];\n\n\treturn chunks.filter( filterEmptyLine ).join( '\\n' );\n\n}\n\nfunction generateDefines( defines ) {\n\n\tconst chunks = [];\n\n\tfor ( const name in defines ) {\n\n\t\tconst value = defines[ name ];\n\n\t\tif ( value === false ) continue;\n\n\t\tchunks.push( '#define ' + name + ' ' + value );\n\n\t}\n\n\treturn chunks.join( '\\n' );\n\n}\n\nfunction fetchAttributeLocations( gl, program ) {\n\n\tconst attributes = {};\n\n\tconst n = gl.getProgramParameter( program, 35721 );\n\n\tfor ( let i = 0; i < n; i ++ ) {\n\n\t\tconst info = gl.getActiveAttrib( program, i );\n\t\tconst name = info.name;\n\n\t\tlet locationSize = 1;\n\t\tif ( info.type === 35674 ) locationSize = 2;\n\t\tif ( info.type === 35675 ) locationSize = 3;\n\t\tif ( info.type === 35676 ) locationSize = 4;\n\n\t\t// console.log( 'THREE.WebGLProgram: ACTIVE VERTEX ATTRIBUTE:', name, i );\n\n\t\tattributes[ name ] = {\n\t\t\ttype: info.type,\n\t\t\tlocation: gl.getAttribLocation( program, name ),\n\t\t\tlocationSize: locationSize\n\t\t};\n\n\t}\n\n\treturn attributes;\n\n}\n\nfunction filterEmptyLine( string ) {\n\n\treturn string !== '';\n\n}\n\nfunction replaceLightNums( string, parameters ) {\n\n\treturn string\n\t\t.replace( /NUM_DIR_LIGHTS/g, parameters.numDirLights )\n\t\t.replace( /NUM_SPOT_LIGHTS/g, parameters.numSpotLights )\n\t\t.replace( /NUM_RECT_AREA_LIGHTS/g, parameters.numRectAreaLights )\n\t\t.replace( /NUM_POINT_LIGHTS/g, parameters.numPointLights )\n\t\t.replace( /NUM_HEMI_LIGHTS/g, parameters.numHemiLights )\n\t\t.replace( /NUM_DIR_LIGHT_SHADOWS/g, parameters.numDirLightShadows )\n\t\t.replace( /NUM_SPOT_LIGHT_SHADOWS/g, parameters.numSpotLightShadows )\n\t\t.replace( /NUM_POINT_LIGHT_SHADOWS/g, parameters.numPointLightShadows );\n\n}\n\nfunction replaceClippingPlaneNums( string, parameters ) {\n\n\treturn string\n\t\t.replace( /NUM_CLIPPING_PLANES/g, parameters.numClippingPlanes )\n\t\t.replace( /UNION_CLIPPING_PLANES/g, ( parameters.numClippingPlanes - parameters.numClipIntersection ) );\n\n}\n\n// Resolve Includes\n\nconst includePattern = /^[ \\t]*#include +<([\\w\\d./]+)>/gm;\n\nfunction resolveIncludes( string ) {\n\n\treturn string.replace( includePattern, includeReplacer );\n\n}\n\nfunction includeReplacer( match, include ) {\n\n\tconst string = ShaderChunk[ include ];\n\n\tif ( string === undefined ) {\n\n\t\tthrow new Error( 'Can not resolve #include <' + include + '>' );\n\n\t}\n\n\treturn resolveIncludes( string );\n\n}\n\n// Unroll Loops\n\nconst deprecatedUnrollLoopPattern = /#pragma unroll_loop[\\s]+?for \\( int i \\= (\\d+)\\; i < (\\d+)\\; i \\+\\+ \\) \\{([\\s\\S]+?)(?=\\})\\}/g;\nconst unrollLoopPattern = /#pragma unroll_loop_start\\s+for\\s*\\(\\s*int\\s+i\\s*=\\s*(\\d+)\\s*;\\s*i\\s*<\\s*(\\d+)\\s*;\\s*i\\s*\\+\\+\\s*\\)\\s*{([\\s\\S]+?)}\\s+#pragma unroll_loop_end/g;\n\nfunction unrollLoops( string ) {\n\n\treturn string\n\t\t.replace( unrollLoopPattern, loopReplacer )\n\t\t.replace( deprecatedUnrollLoopPattern, deprecatedLoopReplacer );\n\n}\n\nfunction deprecatedLoopReplacer( match, start, end, snippet ) {\n\n\tconsole.warn( 'WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead.' );\n\treturn loopReplacer( match, start, end, snippet );\n\n}\n\nfunction loopReplacer( match, start, end, snippet ) {\n\n\tlet string = '';\n\n\tfor ( let i = parseInt( start ); i < parseInt( end ); i ++ ) {\n\n\t\tstring += snippet\n\t\t\t.replace( /\\[\\s*i\\s*\\]/g, '[ ' + i + ' ]' )\n\t\t\t.replace( /UNROLLED_LOOP_INDEX/g, i );\n\n\t}\n\n\treturn string;\n\n}\n\n//\n\nfunction generatePrecision( parameters ) {\n\n\tlet precisionstring = 'precision ' + parameters.precision + ' float;\\nprecision ' + parameters.precision + ' int;';\n\n\tif ( parameters.precision === 'highp' ) {\n\n\t\tprecisionstring += '\\n#define HIGH_PRECISION';\n\n\t} else if ( parameters.precision === 'mediump' ) {\n\n\t\tprecisionstring += '\\n#define MEDIUM_PRECISION';\n\n\t} else if ( parameters.precision === 'lowp' ) {\n\n\t\tprecisionstring += '\\n#define LOW_PRECISION';\n\n\t}\n\n\treturn precisionstring;\n\n}\n\nfunction generateShadowMapTypeDefine( parameters ) {\n\n\tlet shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\n\n\tif ( parameters.shadowMapType === PCFShadowMap ) {\n\n\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\n\n\t} else if ( parameters.shadowMapType === PCFSoftShadowMap ) {\n\n\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\n\n\t} else if ( parameters.shadowMapType === VSMShadowMap ) {\n\n\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_VSM';\n\n\t}\n\n\treturn shadowMapTypeDefine;\n\n}\n\nfunction generateEnvMapTypeDefine( parameters ) {\n\n\tlet envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\n\n\tif ( parameters.envMap ) {\n\n\t\tswitch ( parameters.envMapMode ) {\n\n\t\t\tcase CubeReflectionMapping:\n\t\t\tcase CubeRefractionMapping:\n\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE';\n\t\t\t\tbreak;\n\n\t\t\tcase CubeUVReflectionMapping:\n\t\t\tcase CubeUVRefractionMapping:\n\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE_UV';\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn envMapTypeDefine;\n\n}\n\nfunction generateEnvMapModeDefine( parameters ) {\n\n\tlet envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\n\n\tif ( parameters.envMap ) {\n\n\t\tswitch ( parameters.envMapMode ) {\n\n\t\t\tcase CubeRefractionMapping:\n\t\t\tcase CubeUVRefractionMapping:\n\n\t\t\t\tenvMapModeDefine = 'ENVMAP_MODE_REFRACTION';\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn envMapModeDefine;\n\n}\n\nfunction generateEnvMapBlendingDefine( parameters ) {\n\n\tlet envMapBlendingDefine = 'ENVMAP_BLENDING_NONE';\n\n\tif ( parameters.envMap ) {\n\n\t\tswitch ( parameters.combine ) {\n\n\t\t\tcase MultiplyOperation:\n\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\n\t\t\t\tbreak;\n\n\t\t\tcase MixOperation:\n\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\n\t\t\t\tbreak;\n\n\t\t\tcase AddOperation:\n\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn envMapBlendingDefine;\n\n}\n\nfunction WebGLProgram( renderer, cacheKey, parameters, bindingStates ) {\n\n\t// TODO Send this event to Three.js DevTools\n\t// console.log( 'WebGLProgram', cacheKey );\n\n\tconst gl = renderer.getContext();\n\n\tconst defines = parameters.defines;\n\n\tlet vertexShader = parameters.vertexShader;\n\tlet fragmentShader = parameters.fragmentShader;\n\n\tconst shadowMapTypeDefine = generateShadowMapTypeDefine( parameters );\n\tconst envMapTypeDefine = generateEnvMapTypeDefine( parameters );\n\tconst envMapModeDefine = generateEnvMapModeDefine( parameters );\n\tconst envMapBlendingDefine = generateEnvMapBlendingDefine( parameters );\n\n\tconst customExtensions = parameters.isWebGL2 ? '' : generateExtensions( parameters );\n\n\tconst customDefines = generateDefines( defines );\n\n\tconst program = gl.createProgram();\n\n\tlet prefixVertex, prefixFragment;\n\tlet versionString = parameters.glslVersion ? '#version ' + parameters.glslVersion + '\\n' : '';\n\n\tif ( parameters.isRawShaderMaterial ) {\n\n\t\tprefixVertex = [\n\n\t\t\tcustomDefines\n\n\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t\tif ( prefixVertex.length > 0 ) {\n\n\t\t\tprefixVertex += '\\n';\n\n\t\t}\n\n\t\tprefixFragment = [\n\n\t\t\tcustomExtensions,\n\t\t\tcustomDefines\n\n\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t\tif ( prefixFragment.length > 0 ) {\n\n\t\t\tprefixFragment += '\\n';\n\n\t\t}\n\n\t} else {\n\n\t\tprefixVertex = [\n\n\t\t\tgeneratePrecision( parameters ),\n\n\t\t\t'#define SHADER_NAME ' + parameters.shaderName,\n\n\t\t\tcustomDefines,\n\n\t\t\tparameters.instancing ? '#define USE_INSTANCING' : '',\n\t\t\tparameters.instancingColor ? '#define USE_INSTANCING_COLOR' : '',\n\n\t\t\tparameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\n\n\t\t\t'#define MAX_BONES ' + parameters.maxBones,\n\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\n\t\t\t( parameters.useFog && parameters.fogExp2 ) ? '#define FOG_EXP2' : '',\n\n\t\t\tparameters.map ? '#define USE_MAP' : '',\n\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\n\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\n\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\n\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\n\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\n\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\n\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\n\t\t\t( parameters.normalMap && parameters.objectSpaceNormalMap ) ? '#define OBJECTSPACE_NORMALMAP' : '',\n\t\t\t( parameters.normalMap && parameters.tangentSpaceNormalMap ) ? '#define TANGENTSPACE_NORMALMAP' : '',\n\n\t\t\tparameters.clearcoatMap ? '#define USE_CLEARCOATMAP' : '',\n\t\t\tparameters.clearcoatRoughnessMap ? '#define USE_CLEARCOAT_ROUGHNESSMAP' : '',\n\t\t\tparameters.clearcoatNormalMap ? '#define USE_CLEARCOAT_NORMALMAP' : '',\n\n\t\t\tparameters.displacementMap && parameters.supportsVertexTextures ? '#define USE_DISPLACEMENTMAP' : '',\n\n\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\n\t\t\tparameters.specularIntensityMap ? '#define USE_SPECULARINTENSITYMAP' : '',\n\t\t\tparameters.specularColorMap ? '#define USE_SPECULARCOLORMAP' : '',\n\n\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\n\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\n\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\n\n\t\t\tparameters.transmission ? '#define USE_TRANSMISSION' : '',\n\t\t\tparameters.transmissionMap ? '#define USE_TRANSMISSIONMAP' : '',\n\t\t\tparameters.thicknessMap ? '#define USE_THICKNESSMAP' : '',\n\n\t\t\tparameters.sheenColorMap ? '#define USE_SHEENCOLORMAP' : '',\n\t\t\tparameters.sheenRoughnessMap ? '#define USE_SHEENROUGHNESSMAP' : '',\n\n\t\t\tparameters.vertexTangents ? '#define USE_TANGENT' : '',\n\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\n\t\t\tparameters.vertexAlphas ? '#define USE_COLOR_ALPHA' : '',\n\t\t\tparameters.vertexUvs ? '#define USE_UV' : '',\n\t\t\tparameters.uvsVertexOnly ? '#define UVS_VERTEX_ONLY' : '',\n\n\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\n\n\t\t\tparameters.skinning ? '#define USE_SKINNING' : '',\n\t\t\tparameters.useVertexTexture ? '#define BONE_TEXTURE' : '',\n\n\t\t\tparameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\n\t\t\tparameters.morphNormals && parameters.flatShading === false ? '#define USE_MORPHNORMALS' : '',\n\t\t\t( parameters.morphTargets && parameters.isWebGL2 ) ? '#define MORPHTARGETS_TEXTURE' : '',\n\t\t\t( parameters.morphTargets && parameters.isWebGL2 ) ? '#define MORPHTARGETS_COUNT ' + parameters.morphTargetsCount : '',\n\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\n\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\n\n\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\n\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\n\n\t\t\tparameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\n\n\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\n\t\t\t( parameters.logarithmicDepthBuffer && parameters.rendererExtensionFragDepth ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\n\n\t\t\t'uniform mat4 modelMatrix;',\n\t\t\t'uniform mat4 modelViewMatrix;',\n\t\t\t'uniform mat4 projectionMatrix;',\n\t\t\t'uniform mat4 viewMatrix;',\n\t\t\t'uniform mat3 normalMatrix;',\n\t\t\t'uniform vec3 cameraPosition;',\n\t\t\t'uniform bool isOrthographic;',\n\n\t\t\t'#ifdef USE_INSTANCING',\n\n\t\t\t'\tattribute mat4 instanceMatrix;',\n\n\t\t\t'#endif',\n\n\t\t\t'#ifdef USE_INSTANCING_COLOR',\n\n\t\t\t'\tattribute vec3 instanceColor;',\n\n\t\t\t'#endif',\n\n\t\t\t'attribute vec3 position;',\n\t\t\t'attribute vec3 normal;',\n\t\t\t'attribute vec2 uv;',\n\n\t\t\t'#ifdef USE_TANGENT',\n\n\t\t\t'\tattribute vec4 tangent;',\n\n\t\t\t'#endif',\n\n\t\t\t'#if defined( USE_COLOR_ALPHA )',\n\n\t\t\t'\tattribute vec4 color;',\n\n\t\t\t'#elif defined( USE_COLOR )',\n\n\t\t\t'\tattribute vec3 color;',\n\n\t\t\t'#endif',\n\n\t\t\t'#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )',\n\n\t\t\t'\tattribute vec3 morphTarget0;',\n\t\t\t'\tattribute vec3 morphTarget1;',\n\t\t\t'\tattribute vec3 morphTarget2;',\n\t\t\t'\tattribute vec3 morphTarget3;',\n\n\t\t\t'\t#ifdef USE_MORPHNORMALS',\n\n\t\t\t'\t\tattribute vec3 morphNormal0;',\n\t\t\t'\t\tattribute vec3 morphNormal1;',\n\t\t\t'\t\tattribute vec3 morphNormal2;',\n\t\t\t'\t\tattribute vec3 morphNormal3;',\n\n\t\t\t'\t#else',\n\n\t\t\t'\t\tattribute vec3 morphTarget4;',\n\t\t\t'\t\tattribute vec3 morphTarget5;',\n\t\t\t'\t\tattribute vec3 morphTarget6;',\n\t\t\t'\t\tattribute vec3 morphTarget7;',\n\n\t\t\t'\t#endif',\n\n\t\t\t'#endif',\n\n\t\t\t'#ifdef USE_SKINNING',\n\n\t\t\t'\tattribute vec4 skinIndex;',\n\t\t\t'\tattribute vec4 skinWeight;',\n\n\t\t\t'#endif',\n\n\t\t\t'\\n'\n\n\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t\tprefixFragment = [\n\n\t\t\tcustomExtensions,\n\n\t\t\tgeneratePrecision( parameters ),\n\n\t\t\t'#define SHADER_NAME ' + parameters.shaderName,\n\n\t\t\tcustomDefines,\n\n\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\n\t\t\t( parameters.useFog && parameters.fogExp2 ) ? '#define FOG_EXP2' : '',\n\n\t\t\tparameters.map ? '#define USE_MAP' : '',\n\t\t\tparameters.matcap ? '#define USE_MATCAP' : '',\n\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\n\t\t\tparameters.envMap ? '#define ' + envMapTypeDefine : '',\n\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\n\t\t\tparameters.envMap ? '#define ' + envMapBlendingDefine : '',\n\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\n\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\n\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\n\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\n\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\n\t\t\t( parameters.normalMap && parameters.objectSpaceNormalMap ) ? '#define OBJECTSPACE_NORMALMAP' : '',\n\t\t\t( parameters.normalMap && parameters.tangentSpaceNormalMap ) ? '#define TANGENTSPACE_NORMALMAP' : '',\n\n\t\t\tparameters.clearcoat ? '#define USE_CLEARCOAT' : '',\n\t\t\tparameters.clearcoatMap ? '#define USE_CLEARCOATMAP' : '',\n\t\t\tparameters.clearcoatRoughnessMap ? '#define USE_CLEARCOAT_ROUGHNESSMAP' : '',\n\t\t\tparameters.clearcoatNormalMap ? '#define USE_CLEARCOAT_NORMALMAP' : '',\n\n\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\n\t\t\tparameters.specularIntensityMap ? '#define USE_SPECULARINTENSITYMAP' : '',\n\t\t\tparameters.specularColorMap ? '#define USE_SPECULARCOLORMAP' : '',\n\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\n\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\n\n\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\n\t\t\tparameters.alphaTest ? '#define USE_ALPHATEST' : '',\n\n\t\t\tparameters.sheen ? '#define USE_SHEEN' : '',\n\t\t\tparameters.sheenColorMap ? '#define USE_SHEENCOLORMAP' : '',\n\t\t\tparameters.sheenRoughnessMap ? '#define USE_SHEENROUGHNESSMAP' : '',\n\n\t\t\tparameters.transmission ? '#define USE_TRANSMISSION' : '',\n\t\t\tparameters.transmissionMap ? '#define USE_TRANSMISSIONMAP' : '',\n\t\t\tparameters.thicknessMap ? '#define USE_THICKNESSMAP' : '',\n\n\t\t\tparameters.decodeVideoTexture ? '#define DECODE_VIDEO_TEXTURE' : '',\n\n\t\t\tparameters.vertexTangents ? '#define USE_TANGENT' : '',\n\t\t\tparameters.vertexColors || parameters.instancingColor ? '#define USE_COLOR' : '',\n\t\t\tparameters.vertexAlphas ? '#define USE_COLOR_ALPHA' : '',\n\t\t\tparameters.vertexUvs ? '#define USE_UV' : '',\n\t\t\tparameters.uvsVertexOnly ? '#define UVS_VERTEX_ONLY' : '',\n\n\t\t\tparameters.gradientMap ? '#define USE_GRADIENTMAP' : '',\n\n\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\n\n\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\n\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\n\n\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\n\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\n\n\t\t\tparameters.premultipliedAlpha ? '#define PREMULTIPLIED_ALPHA' : '',\n\n\t\t\tparameters.physicallyCorrectLights ? '#define PHYSICALLY_CORRECT_LIGHTS' : '',\n\n\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\n\t\t\t( parameters.logarithmicDepthBuffer && parameters.rendererExtensionFragDepth ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\n\n\t\t\t( ( parameters.extensionShaderTextureLOD || parameters.envMap ) && parameters.rendererExtensionShaderTextureLod ) ? '#define TEXTURE_LOD_EXT' : '',\n\n\t\t\t'uniform mat4 viewMatrix;',\n\t\t\t'uniform vec3 cameraPosition;',\n\t\t\t'uniform bool isOrthographic;',\n\n\t\t\t( parameters.toneMapping !== NoToneMapping ) ? '#define TONE_MAPPING' : '',\n\t\t\t( parameters.toneMapping !== NoToneMapping ) ? ShaderChunk[ 'tonemapping_pars_fragment' ] : '', // this code is required here because it is used by the toneMapping() function defined below\n\t\t\t( parameters.toneMapping !== NoToneMapping ) ? getToneMappingFunction( 'toneMapping', parameters.toneMapping ) : '',\n\n\t\t\tparameters.dithering ? '#define DITHERING' : '',\n\t\t\tparameters.transparent ? '' : '#define OPAQUE',\n\n\t\t\tShaderChunk[ 'encodings_pars_fragment' ], // this code is required here because it is used by the various encoding/decoding function defined below\n\t\t\tgetTexelEncodingFunction( 'linearToOutputTexel', parameters.outputEncoding ),\n\n\t\t\tparameters.depthPacking ? '#define DEPTH_PACKING ' + parameters.depthPacking : '',\n\n\t\t\t'\\n'\n\n\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t}\n\n\tvertexShader = resolveIncludes( vertexShader );\n\tvertexShader = replaceLightNums( vertexShader, parameters );\n\tvertexShader = replaceClippingPlaneNums( vertexShader, parameters );\n\n\tfragmentShader = resolveIncludes( fragmentShader );\n\tfragmentShader = replaceLightNums( fragmentShader, parameters );\n\tfragmentShader = replaceClippingPlaneNums( fragmentShader, parameters );\n\n\tvertexShader = unrollLoops( vertexShader );\n\tfragmentShader = unrollLoops( fragmentShader );\n\n\tif ( parameters.isWebGL2 && parameters.isRawShaderMaterial !== true ) {\n\n\t\t// GLSL 3.0 conversion for built-in materials and ShaderMaterial\n\n\t\tversionString = '#version 300 es\\n';\n\n\t\tprefixVertex = [\n\t\t\t'precision mediump sampler2DArray;',\n\t\t\t'#define attribute in',\n\t\t\t'#define varying out',\n\t\t\t'#define texture2D texture'\n\t\t].join( '\\n' ) + '\\n' + prefixVertex;\n\n\t\tprefixFragment = [\n\t\t\t'#define varying in',\n\t\t\t( parameters.glslVersion === GLSL3 ) ? '' : 'layout(location = 0) out highp vec4 pc_fragColor;',\n\t\t\t( parameters.glslVersion === GLSL3 ) ? '' : '#define gl_FragColor pc_fragColor',\n\t\t\t'#define gl_FragDepthEXT gl_FragDepth',\n\t\t\t'#define texture2D texture',\n\t\t\t'#define textureCube texture',\n\t\t\t'#define texture2DProj textureProj',\n\t\t\t'#define texture2DLodEXT textureLod',\n\t\t\t'#define texture2DProjLodEXT textureProjLod',\n\t\t\t'#define textureCubeLodEXT textureLod',\n\t\t\t'#define texture2DGradEXT textureGrad',\n\t\t\t'#define texture2DProjGradEXT textureProjGrad',\n\t\t\t'#define textureCubeGradEXT textureGrad'\n\t\t].join( '\\n' ) + '\\n' + prefixFragment;\n\n\t}\n\n\tconst vertexGlsl = versionString + prefixVertex + vertexShader;\n\tconst fragmentGlsl = versionString + prefixFragment + fragmentShader;\n\n\t// console.log( '*VERTEX*', vertexGlsl );\n\t// console.log( '*FRAGMENT*', fragmentGlsl );\n\n\tconst glVertexShader = WebGLShader( gl, 35633, vertexGlsl );\n\tconst glFragmentShader = WebGLShader( gl, 35632, fragmentGlsl );\n\n\tgl.attachShader( program, glVertexShader );\n\tgl.attachShader( program, glFragmentShader );\n\n\t// Force a particular attribute to index 0.\n\n\tif ( parameters.index0AttributeName !== undefined ) {\n\n\t\tgl.bindAttribLocation( program, 0, parameters.index0AttributeName );\n\n\t} else if ( parameters.morphTargets === true ) {\n\n\t\t// programs with morphTargets displace position out of attribute 0\n\t\tgl.bindAttribLocation( program, 0, 'position' );\n\n\t}\n\n\tgl.linkProgram( program );\n\n\t// check for link errors\n\tif ( renderer.debug.checkShaderErrors ) {\n\n\t\tconst programLog = gl.getProgramInfoLog( program ).trim();\n\t\tconst vertexLog = gl.getShaderInfoLog( glVertexShader ).trim();\n\t\tconst fragmentLog = gl.getShaderInfoLog( glFragmentShader ).trim();\n\n\t\tlet runnable = true;\n\t\tlet haveDiagnostics = true;\n\n\t\tif ( gl.getProgramParameter( program, 35714 ) === false ) {\n\n\t\t\trunnable = false;\n\n\t\t\tconst vertexErrors = getShaderErrors( gl, glVertexShader, 'vertex' );\n\t\t\tconst fragmentErrors = getShaderErrors( gl, glFragmentShader, 'fragment' );\n\n\t\t\tconsole.error(\n\t\t\t\t'THREE.WebGLProgram: Shader Error ' + gl.getError() + ' - ' +\n\t\t\t\t'VALIDATE_STATUS ' + gl.getProgramParameter( program, 35715 ) + '\\n\\n' +\n\t\t\t\t'Program Info Log: ' + programLog + '\\n' +\n\t\t\t\tvertexErrors + '\\n' +\n\t\t\t\tfragmentErrors\n\t\t\t);\n\n\t\t} else if ( programLog !== '' ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLProgram: Program Info Log:', programLog );\n\n\t\t} else if ( vertexLog === '' || fragmentLog === '' ) {\n\n\t\t\thaveDiagnostics = false;\n\n\t\t}\n\n\t\tif ( haveDiagnostics ) {\n\n\t\t\tthis.diagnostics = {\n\n\t\t\t\trunnable: runnable,\n\n\t\t\t\tprogramLog: programLog,\n\n\t\t\t\tvertexShader: {\n\n\t\t\t\t\tlog: vertexLog,\n\t\t\t\t\tprefix: prefixVertex\n\n\t\t\t\t},\n\n\t\t\t\tfragmentShader: {\n\n\t\t\t\t\tlog: fragmentLog,\n\t\t\t\t\tprefix: prefixFragment\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t}\n\n\t// Clean up\n\n\t// Crashes in iOS9 and iOS10. #18402\n\t// gl.detachShader( program, glVertexShader );\n\t// gl.detachShader( program, glFragmentShader );\n\n\tgl.deleteShader( glVertexShader );\n\tgl.deleteShader( glFragmentShader );\n\n\t// set up caching for uniform locations\n\n\tlet cachedUniforms;\n\n\tthis.getUniforms = function () {\n\n\t\tif ( cachedUniforms === undefined ) {\n\n\t\t\tcachedUniforms = new WebGLUniforms( gl, program );\n\n\t\t}\n\n\t\treturn cachedUniforms;\n\n\t};\n\n\t// set up caching for attribute locations\n\n\tlet cachedAttributes;\n\n\tthis.getAttributes = function () {\n\n\t\tif ( cachedAttributes === undefined ) {\n\n\t\t\tcachedAttributes = fetchAttributeLocations( gl, program );\n\n\t\t}\n\n\t\treturn cachedAttributes;\n\n\t};\n\n\t// free resource\n\n\tthis.destroy = function () {\n\n\t\tbindingStates.releaseStatesOfProgram( this );\n\n\t\tgl.deleteProgram( program );\n\t\tthis.program = undefined;\n\n\t};\n\n\t//\n\n\tthis.name = parameters.shaderName;\n\tthis.id = programIdCount ++;\n\tthis.cacheKey = cacheKey;\n\tthis.usedTimes = 1;\n\tthis.program = program;\n\tthis.vertexShader = glVertexShader;\n\tthis.fragmentShader = glFragmentShader;\n\n\treturn this;\n\n}\n\nlet _id = 0;\n\nclass WebGLShaderCache {\n\n\tconstructor() {\n\n\t\tthis.shaderCache = new Map();\n\t\tthis.materialCache = new Map();\n\n\t}\n\n\tupdate( material ) {\n\n\t\tconst vertexShader = material.vertexShader;\n\t\tconst fragmentShader = material.fragmentShader;\n\n\t\tconst vertexShaderStage = this._getShaderStage( vertexShader );\n\t\tconst fragmentShaderStage = this._getShaderStage( fragmentShader );\n\n\t\tconst materialShaders = this._getShaderCacheForMaterial( material );\n\n\t\tif ( materialShaders.has( vertexShaderStage ) === false ) {\n\n\t\t\tmaterialShaders.add( vertexShaderStage );\n\t\t\tvertexShaderStage.usedTimes ++;\n\n\t\t}\n\n\t\tif ( materialShaders.has( fragmentShaderStage ) === false ) {\n\n\t\t\tmaterialShaders.add( fragmentShaderStage );\n\t\t\tfragmentShaderStage.usedTimes ++;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremove( material ) {\n\n\t\tconst materialShaders = this.materialCache.get( material );\n\n\t\tfor ( const shaderStage of materialShaders ) {\n\n\t\t\tshaderStage.usedTimes --;\n\n\t\t\tif ( shaderStage.usedTimes === 0 ) this.shaderCache.delete( shaderStage );\n\n\t\t}\n\n\t\tthis.materialCache.delete( material );\n\n\t\treturn this;\n\n\t}\n\n\tgetVertexShaderID( material ) {\n\n\t\treturn this._getShaderStage( material.vertexShader ).id;\n\n\t}\n\n\tgetFragmentShaderID( material ) {\n\n\t\treturn this._getShaderStage( material.fragmentShader ).id;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shaderCache.clear();\n\t\tthis.materialCache.clear();\n\n\t}\n\n\t_getShaderCacheForMaterial( material ) {\n\n\t\tconst cache = this.materialCache;\n\n\t\tif ( cache.has( material ) === false ) {\n\n\t\t\tcache.set( material, new Set() );\n\n\t\t}\n\n\t\treturn cache.get( material );\n\n\t}\n\n\t_getShaderStage( code ) {\n\n\t\tconst cache = this.shaderCache;\n\n\t\tif ( cache.has( code ) === false ) {\n\n\t\t\tconst stage = new WebGLShaderStage();\n\t\t\tcache.set( code, stage );\n\n\t\t}\n\n\t\treturn cache.get( code );\n\n\t}\n\n}\n\nclass WebGLShaderStage {\n\n\tconstructor() {\n\n\t\tthis.id = _id ++;\n\n\t\tthis.usedTimes = 0;\n\n\t}\n\n}\n\nfunction WebGLPrograms( renderer, cubemaps, cubeuvmaps, extensions, capabilities, bindingStates, clipping ) {\n\n\tconst _programLayers = new Layers();\n\tconst _customShaders = new WebGLShaderCache();\n\tconst programs = [];\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\tconst logarithmicDepthBuffer = capabilities.logarithmicDepthBuffer;\n\tconst floatVertexTextures = capabilities.floatVertexTextures;\n\tconst maxVertexUniforms = capabilities.maxVertexUniforms;\n\tconst vertexTextures = capabilities.vertexTextures;\n\tlet precision = capabilities.precision;\n\n\tconst shaderIDs = {\n\t\tMeshDepthMaterial: 'depth',\n\t\tMeshDistanceMaterial: 'distanceRGBA',\n\t\tMeshNormalMaterial: 'normal',\n\t\tMeshBasicMaterial: 'basic',\n\t\tMeshLambertMaterial: 'lambert',\n\t\tMeshPhongMaterial: 'phong',\n\t\tMeshToonMaterial: 'toon',\n\t\tMeshStandardMaterial: 'physical',\n\t\tMeshPhysicalMaterial: 'physical',\n\t\tMeshMatcapMaterial: 'matcap',\n\t\tLineBasicMaterial: 'basic',\n\t\tLineDashedMaterial: 'dashed',\n\t\tPointsMaterial: 'points',\n\t\tShadowMaterial: 'shadow',\n\t\tSpriteMaterial: 'sprite'\n\t};\n\n\tfunction getMaxBones( object ) {\n\n\t\tconst skeleton = object.skeleton;\n\t\tconst bones = skeleton.bones;\n\n\t\tif ( floatVertexTextures ) {\n\n\t\t\treturn 1024;\n\n\t\t} else {\n\n\t\t\t// default for when object is not specified\n\t\t\t// ( for example when prebuilding shader to be used with multiple objects )\n\t\t\t//\n\t\t\t//  - leave some extra space for other uniforms\n\t\t\t//  - limit here is ANGLE's 254 max uniform vectors\n\t\t\t//    (up to 54 should be safe)\n\n\t\t\tconst nVertexUniforms = maxVertexUniforms;\n\t\t\tconst nVertexMatrices = Math.floor( ( nVertexUniforms - 20 ) / 4 );\n\n\t\t\tconst maxBones = Math.min( nVertexMatrices, bones.length );\n\n\t\t\tif ( maxBones < bones.length ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Skeleton has ' + bones.length + ' bones. This GPU supports ' + maxBones + '.' );\n\t\t\t\treturn 0;\n\n\t\t\t}\n\n\t\t\treturn maxBones;\n\n\t\t}\n\n\t}\n\n\tfunction getParameters( material, lights, shadows, scene, object ) {\n\n\t\tconst fog = scene.fog;\n\t\tconst environment = material.isMeshStandardMaterial ? scene.environment : null;\n\n\t\tconst envMap = ( material.isMeshStandardMaterial ? cubeuvmaps : cubemaps ).get( material.envMap || environment );\n\n\t\tconst shaderID = shaderIDs[ material.type ];\n\n\t\t// heuristics to create shader parameters according to lights in the scene\n\t\t// (not to blow over maxLights budget)\n\n\t\tconst maxBones = object.isSkinnedMesh ? getMaxBones( object ) : 0;\n\n\t\tif ( material.precision !== null ) {\n\n\t\t\tprecision = capabilities.getMaxPrecision( material.precision );\n\n\t\t\tif ( precision !== material.precision ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLProgram.getParameters:', material.precision, 'not supported, using', precision, 'instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet vertexShader, fragmentShader;\n\t\tlet customVertexShaderID, customFragmentShaderID;\n\n\t\tif ( shaderID ) {\n\n\t\t\tconst shader = ShaderLib[ shaderID ];\n\n\t\t\tvertexShader = shader.vertexShader;\n\t\t\tfragmentShader = shader.fragmentShader;\n\n\t\t} else {\n\n\t\t\tvertexShader = material.vertexShader;\n\t\t\tfragmentShader = material.fragmentShader;\n\n\t\t\t_customShaders.update( material );\n\n\t\t\tcustomVertexShaderID = _customShaders.getVertexShaderID( material );\n\t\t\tcustomFragmentShaderID = _customShaders.getFragmentShaderID( material );\n\n\t\t}\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\tconst useAlphaTest = material.alphaTest > 0;\n\t\tconst useClearcoat = material.clearcoat > 0;\n\n\t\tconst parameters = {\n\n\t\t\tisWebGL2: isWebGL2,\n\n\t\t\tshaderID: shaderID,\n\t\t\tshaderName: material.type,\n\n\t\t\tvertexShader: vertexShader,\n\t\t\tfragmentShader: fragmentShader,\n\t\t\tdefines: material.defines,\n\n\t\t\tcustomVertexShaderID: customVertexShaderID,\n\t\t\tcustomFragmentShaderID: customFragmentShaderID,\n\n\t\t\tisRawShaderMaterial: material.isRawShaderMaterial === true,\n\t\t\tglslVersion: material.glslVersion,\n\n\t\t\tprecision: precision,\n\n\t\t\tinstancing: object.isInstancedMesh === true,\n\t\t\tinstancingColor: object.isInstancedMesh === true && object.instanceColor !== null,\n\n\t\t\tsupportsVertexTextures: vertexTextures,\n\t\t\toutputEncoding: ( currentRenderTarget === null ) ? renderer.outputEncoding : ( currentRenderTarget.isXRRenderTarget === true ? currentRenderTarget.texture.encoding : LinearEncoding ),\n\t\t\tmap: !! material.map,\n\t\t\tmatcap: !! material.matcap,\n\t\t\tenvMap: !! envMap,\n\t\t\tenvMapMode: envMap && envMap.mapping,\n\t\t\tenvMapCubeUV: ( !! envMap ) && ( ( envMap.mapping === CubeUVReflectionMapping ) || ( envMap.mapping === CubeUVRefractionMapping ) ),\n\t\t\tlightMap: !! material.lightMap,\n\t\t\taoMap: !! material.aoMap,\n\t\t\temissiveMap: !! material.emissiveMap,\n\t\t\tbumpMap: !! material.bumpMap,\n\t\t\tnormalMap: !! material.normalMap,\n\t\t\tobjectSpaceNormalMap: material.normalMapType === ObjectSpaceNormalMap,\n\t\t\ttangentSpaceNormalMap: material.normalMapType === TangentSpaceNormalMap,\n\n\t\t\tdecodeVideoTexture: !! material.map && ( material.map.isVideoTexture === true ) && ( material.map.encoding === sRGBEncoding ),\n\n\t\t\tclearcoat: useClearcoat,\n\t\t\tclearcoatMap: useClearcoat && !! material.clearcoatMap,\n\t\t\tclearcoatRoughnessMap: useClearcoat && !! material.clearcoatRoughnessMap,\n\t\t\tclearcoatNormalMap: useClearcoat && !! material.clearcoatNormalMap,\n\n\t\t\tdisplacementMap: !! material.displacementMap,\n\t\t\troughnessMap: !! material.roughnessMap,\n\t\t\tmetalnessMap: !! material.metalnessMap,\n\t\t\tspecularMap: !! material.specularMap,\n\t\t\tspecularIntensityMap: !! material.specularIntensityMap,\n\t\t\tspecularColorMap: !! material.specularColorMap,\n\n\t\t\ttransparent: material.transparent,\n\n\t\t\talphaMap: !! material.alphaMap,\n\t\t\talphaTest: useAlphaTest,\n\n\t\t\tgradientMap: !! material.gradientMap,\n\n\t\t\tsheen: material.sheen > 0,\n\t\t\tsheenColorMap: !! material.sheenColorMap,\n\t\t\tsheenRoughnessMap: !! material.sheenRoughnessMap,\n\n\t\t\ttransmission: material.transmission > 0,\n\t\t\ttransmissionMap: !! material.transmissionMap,\n\t\t\tthicknessMap: !! material.thicknessMap,\n\n\t\t\tcombine: material.combine,\n\n\t\t\tvertexTangents: ( !! material.normalMap && !! object.geometry && !! object.geometry.attributes.tangent ),\n\t\t\tvertexColors: material.vertexColors,\n\t\t\tvertexAlphas: material.vertexColors === true && !! object.geometry && !! object.geometry.attributes.color && object.geometry.attributes.color.itemSize === 4,\n\t\t\tvertexUvs: !! material.map || !! material.bumpMap || !! material.normalMap || !! material.specularMap || !! material.alphaMap || !! material.emissiveMap || !! material.roughnessMap || !! material.metalnessMap || !! material.clearcoatMap || !! material.clearcoatRoughnessMap || !! material.clearcoatNormalMap || !! material.displacementMap || !! material.transmissionMap || !! material.thicknessMap || !! material.specularIntensityMap || !! material.specularColorMap || !! material.sheenColorMap || !! material.sheenRoughnessMap,\n\t\t\tuvsVertexOnly: ! ( !! material.map || !! material.bumpMap || !! material.normalMap || !! material.specularMap || !! material.alphaMap || !! material.emissiveMap || !! material.roughnessMap || !! material.metalnessMap || !! material.clearcoatNormalMap || material.transmission > 0 || !! material.transmissionMap || !! material.thicknessMap || !! material.specularIntensityMap || !! material.specularColorMap || material.sheen > 0 || !! material.sheenColorMap || !! material.sheenRoughnessMap ) && !! material.displacementMap,\n\n\t\t\tfog: !! fog,\n\t\t\tuseFog: material.fog,\n\t\t\tfogExp2: ( fog && fog.isFogExp2 ),\n\n\t\t\tflatShading: !! material.flatShading,\n\n\t\t\tsizeAttenuation: material.sizeAttenuation,\n\t\t\tlogarithmicDepthBuffer: logarithmicDepthBuffer,\n\n\t\t\tskinning: object.isSkinnedMesh === true && maxBones > 0,\n\t\t\tmaxBones: maxBones,\n\t\t\tuseVertexTexture: floatVertexTextures,\n\n\t\t\tmorphTargets: !! object.geometry && !! object.geometry.morphAttributes.position,\n\t\t\tmorphNormals: !! object.geometry && !! object.geometry.morphAttributes.normal,\n\t\t\tmorphTargetsCount: ( !! object.geometry && !! object.geometry.morphAttributes.position ) ? object.geometry.morphAttributes.position.length : 0,\n\n\t\t\tnumDirLights: lights.directional.length,\n\t\t\tnumPointLights: lights.point.length,\n\t\t\tnumSpotLights: lights.spot.length,\n\t\t\tnumRectAreaLights: lights.rectArea.length,\n\t\t\tnumHemiLights: lights.hemi.length,\n\n\t\t\tnumDirLightShadows: lights.directionalShadowMap.length,\n\t\t\tnumPointLightShadows: lights.pointShadowMap.length,\n\t\t\tnumSpotLightShadows: lights.spotShadowMap.length,\n\n\t\t\tnumClippingPlanes: clipping.numPlanes,\n\t\t\tnumClipIntersection: clipping.numIntersection,\n\n\t\t\tdithering: material.dithering,\n\n\t\t\tshadowMapEnabled: renderer.shadowMap.enabled && shadows.length > 0,\n\t\t\tshadowMapType: renderer.shadowMap.type,\n\n\t\t\ttoneMapping: material.toneMapped ? renderer.toneMapping : NoToneMapping,\n\t\t\tphysicallyCorrectLights: renderer.physicallyCorrectLights,\n\n\t\t\tpremultipliedAlpha: material.premultipliedAlpha,\n\n\t\t\tdoubleSided: material.side === DoubleSide,\n\t\t\tflipSided: material.side === BackSide,\n\n\t\t\tdepthPacking: ( material.depthPacking !== undefined ) ? material.depthPacking : false,\n\n\t\t\tindex0AttributeName: material.index0AttributeName,\n\n\t\t\textensionDerivatives: material.extensions && material.extensions.derivatives,\n\t\t\textensionFragDepth: material.extensions && material.extensions.fragDepth,\n\t\t\textensionDrawBuffers: material.extensions && material.extensions.drawBuffers,\n\t\t\textensionShaderTextureLOD: material.extensions && material.extensions.shaderTextureLOD,\n\n\t\t\trendererExtensionFragDepth: isWebGL2 || extensions.has( 'EXT_frag_depth' ),\n\t\t\trendererExtensionDrawBuffers: isWebGL2 || extensions.has( 'WEBGL_draw_buffers' ),\n\t\t\trendererExtensionShaderTextureLod: isWebGL2 || extensions.has( 'EXT_shader_texture_lod' ),\n\n\t\t\tcustomProgramCacheKey: material.customProgramCacheKey()\n\n\t\t};\n\n\t\treturn parameters;\n\n\t}\n\n\tfunction getProgramCacheKey( parameters ) {\n\n\t\tconst array = [];\n\n\t\tif ( parameters.shaderID ) {\n\n\t\t\tarray.push( parameters.shaderID );\n\n\t\t} else {\n\n\t\t\tarray.push( parameters.customVertexShaderID );\n\t\t\tarray.push( parameters.customFragmentShaderID );\n\n\t\t}\n\n\t\tif ( parameters.defines !== undefined ) {\n\n\t\t\tfor ( const name in parameters.defines ) {\n\n\t\t\t\tarray.push( name );\n\t\t\t\tarray.push( parameters.defines[ name ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( parameters.isRawShaderMaterial === false ) {\n\n\t\t\tgetProgramCacheKeyParameters( array, parameters );\n\t\t\tgetProgramCacheKeyBooleans( array, parameters );\n\t\t\tarray.push( renderer.outputEncoding );\n\n\t\t}\n\n\t\tarray.push( parameters.customProgramCacheKey );\n\n\t\treturn array.join();\n\n\t}\n\n\tfunction getProgramCacheKeyParameters( array, parameters ) {\n\n\t\tarray.push( parameters.precision );\n\t\tarray.push( parameters.outputEncoding );\n\t\tarray.push( parameters.envMapMode );\n\t\tarray.push( parameters.combine );\n\t\tarray.push( parameters.vertexUvs );\n\t\tarray.push( parameters.fogExp2 );\n\t\tarray.push( parameters.sizeAttenuation );\n\t\tarray.push( parameters.maxBones );\n\t\tarray.push( parameters.morphTargetsCount );\n\t\tarray.push( parameters.numDirLights );\n\t\tarray.push( parameters.numPointLights );\n\t\tarray.push( parameters.numSpotLights );\n\t\tarray.push( parameters.numHemiLights );\n\t\tarray.push( parameters.numRectAreaLights );\n\t\tarray.push( parameters.numDirLightShadows );\n\t\tarray.push( parameters.numPointLightShadows );\n\t\tarray.push( parameters.numSpotLightShadows );\n\t\tarray.push( parameters.shadowMapType );\n\t\tarray.push( parameters.toneMapping );\n\t\tarray.push( parameters.numClippingPlanes );\n\t\tarray.push( parameters.numClipIntersection );\n\n\t}\n\n\tfunction getProgramCacheKeyBooleans( array, parameters ) {\n\n\t\t_programLayers.disableAll();\n\n\t\tif ( parameters.isWebGL2 )\n\t\t\t_programLayers.enable( 0 );\n\t\tif ( parameters.supportsVertexTextures )\n\t\t\t_programLayers.enable( 1 );\n\t\tif ( parameters.instancing )\n\t\t\t_programLayers.enable( 2 );\n\t\tif ( parameters.instancingColor )\n\t\t\t_programLayers.enable( 3 );\n\t\tif ( parameters.map )\n\t\t\t_programLayers.enable( 4 );\n\t\tif ( parameters.matcap )\n\t\t\t_programLayers.enable( 5 );\n\t\tif ( parameters.envMap )\n\t\t\t_programLayers.enable( 6 );\n\t\tif ( parameters.envMapCubeUV )\n\t\t\t_programLayers.enable( 7 );\n\t\tif ( parameters.lightMap )\n\t\t\t_programLayers.enable( 8 );\n\t\tif ( parameters.aoMap )\n\t\t\t_programLayers.enable( 9 );\n\t\tif ( parameters.emissiveMap )\n\t\t\t_programLayers.enable( 10 );\n\t\tif ( parameters.bumpMap )\n\t\t\t_programLayers.enable( 11 );\n\t\tif ( parameters.normalMap )\n\t\t\t_programLayers.enable( 12 );\n\t\tif ( parameters.objectSpaceNormalMap )\n\t\t\t_programLayers.enable( 13 );\n\t\tif ( parameters.tangentSpaceNormalMap )\n\t\t\t_programLayers.enable( 14 );\n\t\tif ( parameters.clearcoat )\n\t\t\t_programLayers.enable( 15 );\n\t\tif ( parameters.clearcoatMap )\n\t\t\t_programLayers.enable( 16 );\n\t\tif ( parameters.clearcoatRoughnessMap )\n\t\t\t_programLayers.enable( 17 );\n\t\tif ( parameters.clearcoatNormalMap )\n\t\t\t_programLayers.enable( 18 );\n\t\tif ( parameters.displacementMap )\n\t\t\t_programLayers.enable( 19 );\n\t\tif ( parameters.specularMap )\n\t\t\t_programLayers.enable( 20 );\n\t\tif ( parameters.roughnessMap )\n\t\t\t_programLayers.enable( 21 );\n\t\tif ( parameters.metalnessMap )\n\t\t\t_programLayers.enable( 22 );\n\t\tif ( parameters.gradientMap )\n\t\t\t_programLayers.enable( 23 );\n\t\tif ( parameters.alphaMap )\n\t\t\t_programLayers.enable( 24 );\n\t\tif ( parameters.alphaTest )\n\t\t\t_programLayers.enable( 25 );\n\t\tif ( parameters.vertexColors )\n\t\t\t_programLayers.enable( 26 );\n\t\tif ( parameters.vertexAlphas )\n\t\t\t_programLayers.enable( 27 );\n\t\tif ( parameters.vertexUvs )\n\t\t\t_programLayers.enable( 28 );\n\t\tif ( parameters.vertexTangents )\n\t\t\t_programLayers.enable( 29 );\n\t\tif ( parameters.uvsVertexOnly )\n\t\t\t_programLayers.enable( 30 );\n\t\tif ( parameters.fog )\n\t\t\t_programLayers.enable( 31 );\n\n\t\tarray.push( _programLayers.mask );\n\t\t_programLayers.disableAll();\n\n\t\tif ( parameters.useFog )\n\t\t\t_programLayers.enable( 0 );\n\t\tif ( parameters.flatShading )\n\t\t\t_programLayers.enable( 1 );\n\t\tif ( parameters.logarithmicDepthBuffer )\n\t\t\t_programLayers.enable( 2 );\n\t\tif ( parameters.skinning )\n\t\t\t_programLayers.enable( 3 );\n\t\tif ( parameters.useVertexTexture )\n\t\t\t_programLayers.enable( 4 );\n\t\tif ( parameters.morphTargets )\n\t\t\t_programLayers.enable( 5 );\n\t\tif ( parameters.morphNormals )\n\t\t\t_programLayers.enable( 6 );\n\t\tif ( parameters.premultipliedAlpha )\n\t\t\t_programLayers.enable( 7 );\n\t\tif ( parameters.shadowMapEnabled )\n\t\t\t_programLayers.enable( 8 );\n\t\tif ( parameters.physicallyCorrectLights )\n\t\t\t_programLayers.enable( 9 );\n\t\tif ( parameters.doubleSided )\n\t\t\t_programLayers.enable( 10 );\n\t\tif ( parameters.flipSided )\n\t\t\t_programLayers.enable( 11 );\n\t\tif ( parameters.depthPacking )\n\t\t\t_programLayers.enable( 12 );\n\t\tif ( parameters.dithering )\n\t\t\t_programLayers.enable( 13 );\n\t\tif ( parameters.specularIntensityMap )\n\t\t\t_programLayers.enable( 14 );\n\t\tif ( parameters.specularColorMap )\n\t\t\t_programLayers.enable( 15 );\n\t\tif ( parameters.transmission )\n\t\t\t_programLayers.enable( 16 );\n\t\tif ( parameters.transmissionMap )\n\t\t\t_programLayers.enable( 17 );\n\t\tif ( parameters.thicknessMap )\n\t\t\t_programLayers.enable( 18 );\n\t\tif ( parameters.sheen )\n\t\t\t_programLayers.enable( 19 );\n\t\tif ( parameters.sheenColorMap )\n\t\t\t_programLayers.enable( 20 );\n\t\tif ( parameters.sheenRoughnessMap )\n\t\t\t_programLayers.enable( 21 );\n\t\tif ( parameters.decodeVideoTexture )\n\t\t\t_programLayers.enable( 22 );\n\t\tif ( parameters.transparent )\n\t\t\t_programLayers.enable( 23 );\n\n\t\tarray.push( _programLayers.mask );\n\n\t}\n\n\tfunction getUniforms( material ) {\n\n\t\tconst shaderID = shaderIDs[ material.type ];\n\t\tlet uniforms;\n\n\t\tif ( shaderID ) {\n\n\t\t\tconst shader = ShaderLib[ shaderID ];\n\t\t\tuniforms = UniformsUtils.clone( shader.uniforms );\n\n\t\t} else {\n\n\t\t\tuniforms = material.uniforms;\n\n\t\t}\n\n\t\treturn uniforms;\n\n\t}\n\n\tfunction acquireProgram( parameters, cacheKey ) {\n\n\t\tlet program;\n\n\t\t// Check if code has been already compiled\n\t\tfor ( let p = 0, pl = programs.length; p < pl; p ++ ) {\n\n\t\t\tconst preexistingProgram = programs[ p ];\n\n\t\t\tif ( preexistingProgram.cacheKey === cacheKey ) {\n\n\t\t\t\tprogram = preexistingProgram;\n\t\t\t\t++ program.usedTimes;\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( program === undefined ) {\n\n\t\t\tprogram = new WebGLProgram( renderer, cacheKey, parameters, bindingStates );\n\t\t\tprograms.push( program );\n\n\t\t}\n\n\t\treturn program;\n\n\t}\n\n\tfunction releaseProgram( program ) {\n\n\t\tif ( -- program.usedTimes === 0 ) {\n\n\t\t\t// Remove from unordered set\n\t\t\tconst i = programs.indexOf( program );\n\t\t\tprograms[ i ] = programs[ programs.length - 1 ];\n\t\t\tprograms.pop();\n\n\t\t\t// Free WebGL resources\n\t\t\tprogram.destroy();\n\n\t\t}\n\n\t}\n\n\tfunction releaseShaderCache( material ) {\n\n\t\t_customShaders.remove( material );\n\n\t}\n\n\tfunction dispose() {\n\n\t\t_customShaders.dispose();\n\n\t}\n\n\treturn {\n\t\tgetParameters: getParameters,\n\t\tgetProgramCacheKey: getProgramCacheKey,\n\t\tgetUniforms: getUniforms,\n\t\tacquireProgram: acquireProgram,\n\t\treleaseProgram: releaseProgram,\n\t\treleaseShaderCache: releaseShaderCache,\n\t\t// Exposed for resource monitoring & error feedback via renderer.info:\n\t\tprograms: programs,\n\t\tdispose: dispose\n\t};\n\n}\n\nfunction WebGLProperties() {\n\n\tlet properties = new WeakMap();\n\n\tfunction get( object ) {\n\n\t\tlet map = properties.get( object );\n\n\t\tif ( map === undefined ) {\n\n\t\t\tmap = {};\n\t\t\tproperties.set( object, map );\n\n\t\t}\n\n\t\treturn map;\n\n\t}\n\n\tfunction remove( object ) {\n\n\t\tproperties.delete( object );\n\n\t}\n\n\tfunction update( object, key, value ) {\n\n\t\tproperties.get( object )[ key ] = value;\n\n\t}\n\n\tfunction dispose() {\n\n\t\tproperties = new WeakMap();\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tremove: remove,\n\t\tupdate: update,\n\t\tdispose: dispose\n\t};\n\n}\n\nfunction painterSortStable( a, b ) {\n\n\tif ( a.groupOrder !== b.groupOrder ) {\n\n\t\treturn a.groupOrder - b.groupOrder;\n\n\t} else if ( a.renderOrder !== b.renderOrder ) {\n\n\t\treturn a.renderOrder - b.renderOrder;\n\n\t} else if ( a.material.id !== b.material.id ) {\n\n\t\treturn a.material.id - b.material.id;\n\n\t} else if ( a.z !== b.z ) {\n\n\t\treturn a.z - b.z;\n\n\t} else {\n\n\t\treturn a.id - b.id;\n\n\t}\n\n}\n\nfunction reversePainterSortStable( a, b ) {\n\n\tif ( a.groupOrder !== b.groupOrder ) {\n\n\t\treturn a.groupOrder - b.groupOrder;\n\n\t} else if ( a.renderOrder !== b.renderOrder ) {\n\n\t\treturn a.renderOrder - b.renderOrder;\n\n\t} else if ( a.z !== b.z ) {\n\n\t\treturn b.z - a.z;\n\n\t} else {\n\n\t\treturn a.id - b.id;\n\n\t}\n\n}\n\n\nfunction WebGLRenderList() {\n\n\tconst renderItems = [];\n\tlet renderItemsIndex = 0;\n\n\tconst opaque = [];\n\tconst transmissive = [];\n\tconst transparent = [];\n\n\tfunction init() {\n\n\t\trenderItemsIndex = 0;\n\n\t\topaque.length = 0;\n\t\ttransmissive.length = 0;\n\t\ttransparent.length = 0;\n\n\t}\n\n\tfunction getNextRenderItem( object, geometry, material, groupOrder, z, group ) {\n\n\t\tlet renderItem = renderItems[ renderItemsIndex ];\n\n\t\tif ( renderItem === undefined ) {\n\n\t\t\trenderItem = {\n\t\t\t\tid: object.id,\n\t\t\t\tobject: object,\n\t\t\t\tgeometry: geometry,\n\t\t\t\tmaterial: material,\n\t\t\t\tgroupOrder: groupOrder,\n\t\t\t\trenderOrder: object.renderOrder,\n\t\t\t\tz: z,\n\t\t\t\tgroup: group\n\t\t\t};\n\n\t\t\trenderItems[ renderItemsIndex ] = renderItem;\n\n\t\t} else {\n\n\t\t\trenderItem.id = object.id;\n\t\t\trenderItem.object = object;\n\t\t\trenderItem.geometry = geometry;\n\t\t\trenderItem.material = material;\n\t\t\trenderItem.groupOrder = groupOrder;\n\t\t\trenderItem.renderOrder = object.renderOrder;\n\t\t\trenderItem.z = z;\n\t\t\trenderItem.group = group;\n\n\t\t}\n\n\t\trenderItemsIndex ++;\n\n\t\treturn renderItem;\n\n\t}\n\n\tfunction push( object, geometry, material, groupOrder, z, group ) {\n\n\t\tconst renderItem = getNextRenderItem( object, geometry, material, groupOrder, z, group );\n\n\t\tif ( material.transmission > 0.0 ) {\n\n\t\t\ttransmissive.push( renderItem );\n\n\t\t} else if ( material.transparent === true ) {\n\n\t\t\ttransparent.push( renderItem );\n\n\t\t} else {\n\n\t\t\topaque.push( renderItem );\n\n\t\t}\n\n\t}\n\n\tfunction unshift( object, geometry, material, groupOrder, z, group ) {\n\n\t\tconst renderItem = getNextRenderItem( object, geometry, material, groupOrder, z, group );\n\n\t\tif ( material.transmission > 0.0 ) {\n\n\t\t\ttransmissive.unshift( renderItem );\n\n\t\t} else if ( material.transparent === true ) {\n\n\t\t\ttransparent.unshift( renderItem );\n\n\t\t} else {\n\n\t\t\topaque.unshift( renderItem );\n\n\t\t}\n\n\t}\n\n\tfunction sort( customOpaqueSort, customTransparentSort ) {\n\n\t\tif ( opaque.length > 1 ) opaque.sort( customOpaqueSort || painterSortStable );\n\t\tif ( transmissive.length > 1 ) transmissive.sort( customTransparentSort || reversePainterSortStable );\n\t\tif ( transparent.length > 1 ) transparent.sort( customTransparentSort || reversePainterSortStable );\n\n\t}\n\n\tfunction finish() {\n\n\t\t// Clear references from inactive renderItems in the list\n\n\t\tfor ( let i = renderItemsIndex, il = renderItems.length; i < il; i ++ ) {\n\n\t\t\tconst renderItem = renderItems[ i ];\n\n\t\t\tif ( renderItem.id === null ) break;\n\n\t\t\trenderItem.id = null;\n\t\t\trenderItem.object = null;\n\t\t\trenderItem.geometry = null;\n\t\t\trenderItem.material = null;\n\t\t\trenderItem.group = null;\n\n\t\t}\n\n\t}\n\n\treturn {\n\n\t\topaque: opaque,\n\t\ttransmissive: transmissive,\n\t\ttransparent: transparent,\n\n\t\tinit: init,\n\t\tpush: push,\n\t\tunshift: unshift,\n\t\tfinish: finish,\n\n\t\tsort: sort\n\t};\n\n}\n\nfunction WebGLRenderLists() {\n\n\tlet lists = new WeakMap();\n\n\tfunction get( scene, renderCallDepth ) {\n\n\t\tlet list;\n\n\t\tif ( lists.has( scene ) === false ) {\n\n\t\t\tlist = new WebGLRenderList();\n\t\t\tlists.set( scene, [ list ] );\n\n\t\t} else {\n\n\t\t\tif ( renderCallDepth >= lists.get( scene ).length ) {\n\n\t\t\t\tlist = new WebGLRenderList();\n\t\t\t\tlists.get( scene ).push( list );\n\n\t\t\t} else {\n\n\t\t\t\tlist = lists.get( scene )[ renderCallDepth ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn list;\n\n\t}\n\n\tfunction dispose() {\n\n\t\tlists = new WeakMap();\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tdispose: dispose\n\t};\n\n}\n\nfunction UniformsCache() {\n\n\tconst lights = {};\n\n\treturn {\n\n\t\tget: function ( light ) {\n\n\t\t\tif ( lights[ light.id ] !== undefined ) {\n\n\t\t\t\treturn lights[ light.id ];\n\n\t\t\t}\n\n\t\t\tlet uniforms;\n\n\t\t\tswitch ( light.type ) {\n\n\t\t\t\tcase 'DirectionalLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tdirection: new Vector3(),\n\t\t\t\t\t\tcolor: new Color()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'SpotLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tposition: new Vector3(),\n\t\t\t\t\t\tdirection: new Vector3(),\n\t\t\t\t\t\tcolor: new Color(),\n\t\t\t\t\t\tdistance: 0,\n\t\t\t\t\t\tconeCos: 0,\n\t\t\t\t\t\tpenumbraCos: 0,\n\t\t\t\t\t\tdecay: 0\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'PointLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tposition: new Vector3(),\n\t\t\t\t\t\tcolor: new Color(),\n\t\t\t\t\t\tdistance: 0,\n\t\t\t\t\t\tdecay: 0\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'HemisphereLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tdirection: new Vector3(),\n\t\t\t\t\t\tskyColor: new Color(),\n\t\t\t\t\t\tgroundColor: new Color()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'RectAreaLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tcolor: new Color(),\n\t\t\t\t\t\tposition: new Vector3(),\n\t\t\t\t\t\thalfWidth: new Vector3(),\n\t\t\t\t\t\thalfHeight: new Vector3()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tlights[ light.id ] = uniforms;\n\n\t\t\treturn uniforms;\n\n\t\t}\n\n\t};\n\n}\n\nfunction ShadowUniformsCache() {\n\n\tconst lights = {};\n\n\treturn {\n\n\t\tget: function ( light ) {\n\n\t\t\tif ( lights[ light.id ] !== undefined ) {\n\n\t\t\t\treturn lights[ light.id ];\n\n\t\t\t}\n\n\t\t\tlet uniforms;\n\n\t\t\tswitch ( light.type ) {\n\n\t\t\t\tcase 'DirectionalLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tshadowBias: 0,\n\t\t\t\t\t\tshadowNormalBias: 0,\n\t\t\t\t\t\tshadowRadius: 1,\n\t\t\t\t\t\tshadowMapSize: new Vector2()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'SpotLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tshadowBias: 0,\n\t\t\t\t\t\tshadowNormalBias: 0,\n\t\t\t\t\t\tshadowRadius: 1,\n\t\t\t\t\t\tshadowMapSize: new Vector2()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'PointLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tshadowBias: 0,\n\t\t\t\t\t\tshadowNormalBias: 0,\n\t\t\t\t\t\tshadowRadius: 1,\n\t\t\t\t\t\tshadowMapSize: new Vector2(),\n\t\t\t\t\t\tshadowCameraNear: 1,\n\t\t\t\t\t\tshadowCameraFar: 1000\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\t// TODO (abelnation): set RectAreaLight shadow uniforms\n\n\t\t\t}\n\n\t\t\tlights[ light.id ] = uniforms;\n\n\t\t\treturn uniforms;\n\n\t\t}\n\n\t};\n\n}\n\n\n\nlet nextVersion = 0;\n\nfunction shadowCastingLightsFirst( lightA, lightB ) {\n\n\treturn ( lightB.castShadow ? 1 : 0 ) - ( lightA.castShadow ? 1 : 0 );\n\n}\n\nfunction WebGLLights( extensions, capabilities ) {\n\n\tconst cache = new UniformsCache();\n\n\tconst shadowCache = ShadowUniformsCache();\n\n\tconst state = {\n\n\t\tversion: 0,\n\n\t\thash: {\n\t\t\tdirectionalLength: - 1,\n\t\t\tpointLength: - 1,\n\t\t\tspotLength: - 1,\n\t\t\trectAreaLength: - 1,\n\t\t\themiLength: - 1,\n\n\t\t\tnumDirectionalShadows: - 1,\n\t\t\tnumPointShadows: - 1,\n\t\t\tnumSpotShadows: - 1\n\t\t},\n\n\t\tambient: [ 0, 0, 0 ],\n\t\tprobe: [],\n\t\tdirectional: [],\n\t\tdirectionalShadow: [],\n\t\tdirectionalShadowMap: [],\n\t\tdirectionalShadowMatrix: [],\n\t\tspot: [],\n\t\tspotShadow: [],\n\t\tspotShadowMap: [],\n\t\tspotShadowMatrix: [],\n\t\trectArea: [],\n\t\trectAreaLTC1: null,\n\t\trectAreaLTC2: null,\n\t\tpoint: [],\n\t\tpointShadow: [],\n\t\tpointShadowMap: [],\n\t\tpointShadowMatrix: [],\n\t\themi: []\n\n\t};\n\n\tfor ( let i = 0; i < 9; i ++ ) state.probe.push( new Vector3() );\n\n\tconst vector3 = new Vector3();\n\tconst matrix4 = new Matrix4();\n\tconst matrix42 = new Matrix4();\n\n\tfunction setup( lights, physicallyCorrectLights ) {\n\n\t\tlet r = 0, g = 0, b = 0;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) state.probe[ i ].set( 0, 0, 0 );\n\n\t\tlet directionalLength = 0;\n\t\tlet pointLength = 0;\n\t\tlet spotLength = 0;\n\t\tlet rectAreaLength = 0;\n\t\tlet hemiLength = 0;\n\n\t\tlet numDirectionalShadows = 0;\n\t\tlet numPointShadows = 0;\n\t\tlet numSpotShadows = 0;\n\n\t\tlights.sort( shadowCastingLightsFirst );\n\n\t\t// artist-friendly light intensity scaling factor\n\t\tconst scaleFactor = ( physicallyCorrectLights !== true ) ? Math.PI : 1;\n\n\t\tfor ( let i = 0, l = lights.length; i < l; i ++ ) {\n\n\t\t\tconst light = lights[ i ];\n\n\t\t\tconst color = light.color;\n\t\t\tconst intensity = light.intensity;\n\t\t\tconst distance = light.distance;\n\n\t\t\tconst shadowMap = ( light.shadow && light.shadow.map ) ? light.shadow.map.texture : null;\n\n\t\t\tif ( light.isAmbientLight ) {\n\n\t\t\t\tr += color.r * intensity * scaleFactor;\n\t\t\t\tg += color.g * intensity * scaleFactor;\n\t\t\t\tb += color.b * intensity * scaleFactor;\n\n\t\t\t} else if ( light.isLightProbe ) {\n\n\t\t\t\tfor ( let j = 0; j < 9; j ++ ) {\n\n\t\t\t\t\tstate.probe[ j ].addScaledVector( light.sh.coefficients[ j ], intensity );\n\n\t\t\t\t}\n\n\t\t\t} else if ( light.isDirectionalLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity * scaleFactor );\n\n\t\t\t\tif ( light.castShadow ) {\n\n\t\t\t\t\tconst shadow = light.shadow;\n\n\t\t\t\t\tconst shadowUniforms = shadowCache.get( light );\n\n\t\t\t\t\tshadowUniforms.shadowBias = shadow.bias;\n\t\t\t\t\tshadowUniforms.shadowNormalBias = shadow.normalBias;\n\t\t\t\t\tshadowUniforms.shadowRadius = shadow.radius;\n\t\t\t\t\tshadowUniforms.shadowMapSize = shadow.mapSize;\n\n\t\t\t\t\tstate.directionalShadow[ directionalLength ] = shadowUniforms;\n\t\t\t\t\tstate.directionalShadowMap[ directionalLength ] = shadowMap;\n\t\t\t\t\tstate.directionalShadowMatrix[ directionalLength ] = light.shadow.matrix;\n\n\t\t\t\t\tnumDirectionalShadows ++;\n\n\t\t\t\t}\n\n\t\t\t\tstate.directional[ directionalLength ] = uniforms;\n\n\t\t\t\tdirectionalLength ++;\n\n\t\t\t} else if ( light.isSpotLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\n\t\t\t\tuniforms.color.copy( color ).multiplyScalar( intensity * scaleFactor );\n\t\t\t\tuniforms.distance = distance;\n\n\t\t\t\tuniforms.coneCos = Math.cos( light.angle );\n\t\t\t\tuniforms.penumbraCos = Math.cos( light.angle * ( 1 - light.penumbra ) );\n\t\t\t\tuniforms.decay = light.decay;\n\n\t\t\t\tif ( light.castShadow ) {\n\n\t\t\t\t\tconst shadow = light.shadow;\n\n\t\t\t\t\tconst shadowUniforms = shadowCache.get( light );\n\n\t\t\t\t\tshadowUniforms.shadowBias = shadow.bias;\n\t\t\t\t\tshadowUniforms.shadowNormalBias = shadow.normalBias;\n\t\t\t\t\tshadowUniforms.shadowRadius = shadow.radius;\n\t\t\t\t\tshadowUniforms.shadowMapSize = shadow.mapSize;\n\n\t\t\t\t\tstate.spotShadow[ spotLength ] = shadowUniforms;\n\t\t\t\t\tstate.spotShadowMap[ spotLength ] = shadowMap;\n\t\t\t\t\tstate.spotShadowMatrix[ spotLength ] = light.shadow.matrix;\n\n\t\t\t\t\tnumSpotShadows ++;\n\n\t\t\t\t}\n\n\t\t\t\tstate.spot[ spotLength ] = uniforms;\n\n\t\t\t\tspotLength ++;\n\n\t\t\t} else if ( light.isRectAreaLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\t// (a) intensity is the total visible light emitted\n\t\t\t\t//uniforms.color.copy( color ).multiplyScalar( intensity / ( light.width * light.height * Math.PI ) );\n\n\t\t\t\t// (b) intensity is the brightness of the light\n\t\t\t\tuniforms.color.copy( color ).multiplyScalar( intensity );\n\n\t\t\t\tuniforms.halfWidth.set( light.width * 0.5, 0.0, 0.0 );\n\t\t\t\tuniforms.halfHeight.set( 0.0, light.height * 0.5, 0.0 );\n\n\t\t\t\tstate.rectArea[ rectAreaLength ] = uniforms;\n\n\t\t\t\trectAreaLength ++;\n\n\t\t\t} else if ( light.isPointLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity * scaleFactor );\n\t\t\t\tuniforms.distance = light.distance;\n\t\t\t\tuniforms.decay = light.decay;\n\n\t\t\t\tif ( light.castShadow ) {\n\n\t\t\t\t\tconst shadow = light.shadow;\n\n\t\t\t\t\tconst shadowUniforms = shadowCache.get( light );\n\n\t\t\t\t\tshadowUniforms.shadowBias = shadow.bias;\n\t\t\t\t\tshadowUniforms.shadowNormalBias = shadow.normalBias;\n\t\t\t\t\tshadowUniforms.shadowRadius = shadow.radius;\n\t\t\t\t\tshadowUniforms.shadowMapSize = shadow.mapSize;\n\t\t\t\t\tshadowUniforms.shadowCameraNear = shadow.camera.near;\n\t\t\t\t\tshadowUniforms.shadowCameraFar = shadow.camera.far;\n\n\t\t\t\t\tstate.pointShadow[ pointLength ] = shadowUniforms;\n\t\t\t\t\tstate.pointShadowMap[ pointLength ] = shadowMap;\n\t\t\t\t\tstate.pointShadowMatrix[ pointLength ] = light.shadow.matrix;\n\n\t\t\t\t\tnumPointShadows ++;\n\n\t\t\t\t}\n\n\t\t\t\tstate.point[ pointLength ] = uniforms;\n\n\t\t\t\tpointLength ++;\n\n\t\t\t} else if ( light.isHemisphereLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\tuniforms.skyColor.copy( light.color ).multiplyScalar( intensity * scaleFactor );\n\t\t\t\tuniforms.groundColor.copy( light.groundColor ).multiplyScalar( intensity * scaleFactor );\n\n\t\t\t\tstate.hemi[ hemiLength ] = uniforms;\n\n\t\t\t\themiLength ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( rectAreaLength > 0 ) {\n\n\t\t\tif ( capabilities.isWebGL2 ) {\n\n\t\t\t\t// WebGL 2\n\n\t\t\t\tstate.rectAreaLTC1 = UniformsLib.LTC_FLOAT_1;\n\t\t\t\tstate.rectAreaLTC2 = UniformsLib.LTC_FLOAT_2;\n\n\t\t\t} else {\n\n\t\t\t\t// WebGL 1\n\n\t\t\t\tif ( extensions.has( 'OES_texture_float_linear' ) === true ) {\n\n\t\t\t\t\tstate.rectAreaLTC1 = UniformsLib.LTC_FLOAT_1;\n\t\t\t\t\tstate.rectAreaLTC2 = UniformsLib.LTC_FLOAT_2;\n\n\t\t\t\t} else if ( extensions.has( 'OES_texture_half_float_linear' ) === true ) {\n\n\t\t\t\t\tstate.rectAreaLTC1 = UniformsLib.LTC_HALF_1;\n\t\t\t\t\tstate.rectAreaLTC2 = UniformsLib.LTC_HALF_2;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.ambient[ 0 ] = r;\n\t\tstate.ambient[ 1 ] = g;\n\t\tstate.ambient[ 2 ] = b;\n\n\t\tconst hash = state.hash;\n\n\t\tif ( hash.directionalLength !== directionalLength ||\n\t\t\thash.pointLength !== pointLength ||\n\t\t\thash.spotLength !== spotLength ||\n\t\t\thash.rectAreaLength !== rectAreaLength ||\n\t\t\thash.hemiLength !== hemiLength ||\n\t\t\thash.numDirectionalShadows !== numDirectionalShadows ||\n\t\t\thash.numPointShadows !== numPointShadows ||\n\t\t\thash.numSpotShadows !== numSpotShadows ) {\n\n\t\t\tstate.directional.length = directionalLength;\n\t\t\tstate.spot.length = spotLength;\n\t\t\tstate.rectArea.length = rectAreaLength;\n\t\t\tstate.point.length = pointLength;\n\t\t\tstate.hemi.length = hemiLength;\n\n\t\t\tstate.directionalShadow.length = numDirectionalShadows;\n\t\t\tstate.directionalShadowMap.length = numDirectionalShadows;\n\t\t\tstate.pointShadow.length = numPointShadows;\n\t\t\tstate.pointShadowMap.length = numPointShadows;\n\t\t\tstate.spotShadow.length = numSpotShadows;\n\t\t\tstate.spotShadowMap.length = numSpotShadows;\n\t\t\tstate.directionalShadowMatrix.length = numDirectionalShadows;\n\t\t\tstate.pointShadowMatrix.length = numPointShadows;\n\t\t\tstate.spotShadowMatrix.length = numSpotShadows;\n\n\t\t\thash.directionalLength = directionalLength;\n\t\t\thash.pointLength = pointLength;\n\t\t\thash.spotLength = spotLength;\n\t\t\thash.rectAreaLength = rectAreaLength;\n\t\t\thash.hemiLength = hemiLength;\n\n\t\t\thash.numDirectionalShadows = numDirectionalShadows;\n\t\t\thash.numPointShadows = numPointShadows;\n\t\t\thash.numSpotShadows = numSpotShadows;\n\n\t\t\tstate.version = nextVersion ++;\n\n\t\t}\n\n\t}\n\n\tfunction setupView( lights, camera ) {\n\n\t\tlet directionalLength = 0;\n\t\tlet pointLength = 0;\n\t\tlet spotLength = 0;\n\t\tlet rectAreaLength = 0;\n\t\tlet hemiLength = 0;\n\n\t\tconst viewMatrix = camera.matrixWorldInverse;\n\n\t\tfor ( let i = 0, l = lights.length; i < l; i ++ ) {\n\n\t\t\tconst light = lights[ i ];\n\n\t\t\tif ( light.isDirectionalLight ) {\n\n\t\t\t\tconst uniforms = state.directional[ directionalLength ];\n\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tvector3.setFromMatrixPosition( light.target.matrixWorld );\n\t\t\t\tuniforms.direction.sub( vector3 );\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\n\n\t\t\t\tdirectionalLength ++;\n\n\t\t\t} else if ( light.isSpotLight ) {\n\n\t\t\t\tconst uniforms = state.spot[ spotLength ];\n\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\n\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tvector3.setFromMatrixPosition( light.target.matrixWorld );\n\t\t\t\tuniforms.direction.sub( vector3 );\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\n\n\t\t\t\tspotLength ++;\n\n\t\t\t} else if ( light.isRectAreaLight ) {\n\n\t\t\t\tconst uniforms = state.rectArea[ rectAreaLength ];\n\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\n\n\t\t\t\t// extract local rotation of light to derive width/height half vectors\n\t\t\t\tmatrix42.identity();\n\t\t\t\tmatrix4.copy( light.matrixWorld );\n\t\t\t\tmatrix4.premultiply( viewMatrix );\n\t\t\t\tmatrix42.extractRotation( matrix4 );\n\n\t\t\t\tuniforms.halfWidth.set( light.width * 0.5, 0.0, 0.0 );\n\t\t\t\tuniforms.halfHeight.set( 0.0, light.height * 0.5, 0.0 );\n\n\t\t\t\tuniforms.halfWidth.applyMatrix4( matrix42 );\n\t\t\t\tuniforms.halfHeight.applyMatrix4( matrix42 );\n\n\t\t\t\trectAreaLength ++;\n\n\t\t\t} else if ( light.isPointLight ) {\n\n\t\t\t\tconst uniforms = state.point[ pointLength ];\n\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\n\n\t\t\t\tpointLength ++;\n\n\t\t\t} else if ( light.isHemisphereLight ) {\n\n\t\t\t\tconst uniforms = state.hemi[ hemiLength ];\n\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\n\t\t\t\tuniforms.direction.normalize();\n\n\t\t\t\themiLength ++;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn {\n\t\tsetup: setup,\n\t\tsetupView: setupView,\n\t\tstate: state\n\t};\n\n}\n\nfunction WebGLRenderState( extensions, capabilities ) {\n\n\tconst lights = new WebGLLights( extensions, capabilities );\n\n\tconst lightsArray = [];\n\tconst shadowsArray = [];\n\n\tfunction init() {\n\n\t\tlightsArray.length = 0;\n\t\tshadowsArray.length = 0;\n\n\t}\n\n\tfunction pushLight( light ) {\n\n\t\tlightsArray.push( light );\n\n\t}\n\n\tfunction pushShadow( shadowLight ) {\n\n\t\tshadowsArray.push( shadowLight );\n\n\t}\n\n\tfunction setupLights( physicallyCorrectLights ) {\n\n\t\tlights.setup( lightsArray, physicallyCorrectLights );\n\n\t}\n\n\tfunction setupLightsView( camera ) {\n\n\t\tlights.setupView( lightsArray, camera );\n\n\t}\n\n\tconst state = {\n\t\tlightsArray: lightsArray,\n\t\tshadowsArray: shadowsArray,\n\n\t\tlights: lights\n\t};\n\n\treturn {\n\t\tinit: init,\n\t\tstate: state,\n\t\tsetupLights: setupLights,\n\t\tsetupLightsView: setupLightsView,\n\n\t\tpushLight: pushLight,\n\t\tpushShadow: pushShadow\n\t};\n\n}\n\nfunction WebGLRenderStates( extensions, capabilities ) {\n\n\tlet renderStates = new WeakMap();\n\n\tfunction get( scene, renderCallDepth = 0 ) {\n\n\t\tlet renderState;\n\n\t\tif ( renderStates.has( scene ) === false ) {\n\n\t\t\trenderState = new WebGLRenderState( extensions, capabilities );\n\t\t\trenderStates.set( scene, [ renderState ] );\n\n\t\t} else {\n\n\t\t\tif ( renderCallDepth >= renderStates.get( scene ).length ) {\n\n\t\t\t\trenderState = new WebGLRenderState( extensions, capabilities );\n\t\t\t\trenderStates.get( scene ).push( renderState );\n\n\t\t\t} else {\n\n\t\t\t\trenderState = renderStates.get( scene )[ renderCallDepth ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn renderState;\n\n\t}\n\n\tfunction dispose() {\n\n\t\trenderStates = new WeakMap();\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tdispose: dispose\n\t};\n\n}\n\n/**\n * parameters = {\n *\n *  opacity: <float>,\n *\n *  map: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  displacementMap: new THREE.Texture( <Image> ),\n *  displacementScale: <float>,\n *  displacementBias: <float>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>\n * }\n */\n\nclass MeshDepthMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshDepthMaterial';\n\n\t\tthis.depthPacking = BasicDepthPacking;\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.depthPacking = source.depthPacking;\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshDepthMaterial.prototype.isMeshDepthMaterial = true;\n\n/**\n * parameters = {\n *\n *  referencePosition: <float>,\n *  nearDistance: <float>,\n *  farDistance: <float>,\n *\n *  map: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  displacementMap: new THREE.Texture( <Image> ),\n *  displacementScale: <float>,\n *  displacementBias: <float>\n *\n * }\n */\n\nclass MeshDistanceMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshDistanceMaterial';\n\n\t\tthis.referencePosition = new Vector3();\n\t\tthis.nearDistance = 1;\n\t\tthis.farDistance = 1000;\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.fog = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.referencePosition.copy( source.referencePosition );\n\t\tthis.nearDistance = source.nearDistance;\n\t\tthis.farDistance = source.farDistance;\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshDistanceMaterial.prototype.isMeshDistanceMaterial = true;\n\nconst vertex = \"void main() {\\n\\tgl_Position = vec4( position, 1.0 );\\n}\";\n\nconst fragment = \"uniform sampler2D shadow_pass;\\nuniform vec2 resolution;\\nuniform float radius;\\n#include <packing>\\nvoid main() {\\n\\tconst float samples = float( VSM_SAMPLES );\\n\\tfloat mean = 0.0;\\n\\tfloat squared_mean = 0.0;\\n\\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\\n\\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\\n\\tfor ( float i = 0.0; i < samples; i ++ ) {\\n\\t\\tfloat uvOffset = uvStart + i * uvStride;\\n\\t\\t#ifdef HORIZONTAL_PASS\\n\\t\\t\\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\\n\\t\\t\\tmean += distribution.x;\\n\\t\\t\\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\\n\\t\\t#else\\n\\t\\t\\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\\n\\t\\t\\tmean += depth;\\n\\t\\t\\tsquared_mean += depth * depth;\\n\\t\\t#endif\\n\\t}\\n\\tmean = mean / samples;\\n\\tsquared_mean = squared_mean / samples;\\n\\tfloat std_dev = sqrt( squared_mean - mean * mean );\\n\\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\\n}\";\n\nfunction WebGLShadowMap( _renderer, _objects, _capabilities ) {\n\n\tlet _frustum = new Frustum();\n\n\tconst _shadowMapSize = new Vector2(),\n\t\t_viewportSize = new Vector2(),\n\n\t\t_viewport = new Vector4(),\n\n\t\t_depthMaterial = new MeshDepthMaterial( { depthPacking: RGBADepthPacking } ),\n\t\t_distanceMaterial = new MeshDistanceMaterial(),\n\n\t\t_materialCache = {},\n\n\t\t_maxTextureSize = _capabilities.maxTextureSize;\n\n\tconst shadowSide = { 0: BackSide, 1: FrontSide, 2: DoubleSide };\n\n\tconst shadowMaterialVertical = new ShaderMaterial( {\n\t\tdefines: {\n\t\t\tVSM_SAMPLES: 8\n\t\t},\n\t\tuniforms: {\n\t\t\tshadow_pass: { value: null },\n\t\t\tresolution: { value: new Vector2() },\n\t\t\tradius: { value: 4.0 }\n\t\t},\n\n\t\tvertexShader: vertex,\n\t\tfragmentShader: fragment\n\n\t} );\n\n\tconst shadowMaterialHorizontal = shadowMaterialVertical.clone();\n\tshadowMaterialHorizontal.defines.HORIZONTAL_PASS = 1;\n\n\tconst fullScreenTri = new BufferGeometry();\n\tfullScreenTri.setAttribute(\n\t\t'position',\n\t\tnew BufferAttribute(\n\t\t\tnew Float32Array( [ - 1, - 1, 0.5, 3, - 1, 0.5, - 1, 3, 0.5 ] ),\n\t\t\t3\n\t\t)\n\t);\n\n\tconst fullScreenMesh = new Mesh( fullScreenTri, shadowMaterialVertical );\n\n\tconst scope = this;\n\n\tthis.enabled = false;\n\n\tthis.autoUpdate = true;\n\tthis.needsUpdate = false;\n\n\tthis.type = PCFShadowMap;\n\n\tthis.render = function ( lights, scene, camera ) {\n\n\t\tif ( scope.enabled === false ) return;\n\t\tif ( scope.autoUpdate === false && scope.needsUpdate === false ) return;\n\n\t\tif ( lights.length === 0 ) return;\n\n\t\tconst currentRenderTarget = _renderer.getRenderTarget();\n\t\tconst activeCubeFace = _renderer.getActiveCubeFace();\n\t\tconst activeMipmapLevel = _renderer.getActiveMipmapLevel();\n\n\t\tconst _state = _renderer.state;\n\n\t\t// Set GL state for depth map.\n\t\t_state.setBlending( NoBlending );\n\t\t_state.buffers.color.setClear( 1, 1, 1, 1 );\n\t\t_state.buffers.depth.setTest( true );\n\t\t_state.setScissorTest( false );\n\n\t\t// render depth map\n\n\t\tfor ( let i = 0, il = lights.length; i < il; i ++ ) {\n\n\t\t\tconst light = lights[ i ];\n\t\t\tconst shadow = light.shadow;\n\n\t\t\tif ( shadow === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLShadowMap:', light, 'has no shadow.' );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tif ( shadow.autoUpdate === false && shadow.needsUpdate === false ) continue;\n\n\t\t\t_shadowMapSize.copy( shadow.mapSize );\n\n\t\t\tconst shadowFrameExtents = shadow.getFrameExtents();\n\n\t\t\t_shadowMapSize.multiply( shadowFrameExtents );\n\n\t\t\t_viewportSize.copy( shadow.mapSize );\n\n\t\t\tif ( _shadowMapSize.x > _maxTextureSize || _shadowMapSize.y > _maxTextureSize ) {\n\n\t\t\t\tif ( _shadowMapSize.x > _maxTextureSize ) {\n\n\t\t\t\t\t_viewportSize.x = Math.floor( _maxTextureSize / shadowFrameExtents.x );\n\t\t\t\t\t_shadowMapSize.x = _viewportSize.x * shadowFrameExtents.x;\n\t\t\t\t\tshadow.mapSize.x = _viewportSize.x;\n\n\t\t\t\t}\n\n\t\t\t\tif ( _shadowMapSize.y > _maxTextureSize ) {\n\n\t\t\t\t\t_viewportSize.y = Math.floor( _maxTextureSize / shadowFrameExtents.y );\n\t\t\t\t\t_shadowMapSize.y = _viewportSize.y * shadowFrameExtents.y;\n\t\t\t\t\tshadow.mapSize.y = _viewportSize.y;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( shadow.map === null && ! shadow.isPointLightShadow && this.type === VSMShadowMap ) {\n\n\t\t\t\tconst pars = { minFilter: LinearFilter, magFilter: LinearFilter, format: RGBAFormat };\n\n\t\t\t\tshadow.map = new WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y, pars );\n\t\t\t\tshadow.map.texture.name = light.name + '.shadowMap';\n\n\t\t\t\tshadow.mapPass = new WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y, pars );\n\n\t\t\t\tshadow.camera.updateProjectionMatrix();\n\n\t\t\t}\n\n\t\t\tif ( shadow.map === null ) {\n\n\t\t\t\tconst pars = { minFilter: NearestFilter, magFilter: NearestFilter, format: RGBAFormat };\n\n\t\t\t\tshadow.map = new WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y, pars );\n\t\t\t\tshadow.map.texture.name = light.name + '.shadowMap';\n\n\t\t\t\tshadow.camera.updateProjectionMatrix();\n\n\t\t\t}\n\n\t\t\t_renderer.setRenderTarget( shadow.map );\n\t\t\t_renderer.clear();\n\n\t\t\tconst viewportCount = shadow.getViewportCount();\n\n\t\t\tfor ( let vp = 0; vp < viewportCount; vp ++ ) {\n\n\t\t\t\tconst viewport = shadow.getViewport( vp );\n\n\t\t\t\t_viewport.set(\n\t\t\t\t\t_viewportSize.x * viewport.x,\n\t\t\t\t\t_viewportSize.y * viewport.y,\n\t\t\t\t\t_viewportSize.x * viewport.z,\n\t\t\t\t\t_viewportSize.y * viewport.w\n\t\t\t\t);\n\n\t\t\t\t_state.viewport( _viewport );\n\n\t\t\t\tshadow.updateMatrices( light, vp );\n\n\t\t\t\t_frustum = shadow.getFrustum();\n\n\t\t\t\trenderObject( scene, camera, shadow.camera, light, this.type );\n\n\t\t\t}\n\n\t\t\t// do blur pass for VSM\n\n\t\t\tif ( ! shadow.isPointLightShadow && this.type === VSMShadowMap ) {\n\n\t\t\t\tVSMPass( shadow, camera );\n\n\t\t\t}\n\n\t\t\tshadow.needsUpdate = false;\n\n\t\t}\n\n\t\tscope.needsUpdate = false;\n\n\t\t_renderer.setRenderTarget( currentRenderTarget, activeCubeFace, activeMipmapLevel );\n\n\t};\n\n\tfunction VSMPass( shadow, camera ) {\n\n\t\tconst geometry = _objects.update( fullScreenMesh );\n\n\t\tif ( shadowMaterialVertical.defines.VSM_SAMPLES !== shadow.blurSamples ) {\n\n\t\t\tshadowMaterialVertical.defines.VSM_SAMPLES = shadow.blurSamples;\n\t\t\tshadowMaterialHorizontal.defines.VSM_SAMPLES = shadow.blurSamples;\n\n\t\t\tshadowMaterialVertical.needsUpdate = true;\n\t\t\tshadowMaterialHorizontal.needsUpdate = true;\n\n\t\t}\n\n\t\t// vertical pass\n\n\t\tshadowMaterialVertical.uniforms.shadow_pass.value = shadow.map.texture;\n\t\tshadowMaterialVertical.uniforms.resolution.value = shadow.mapSize;\n\t\tshadowMaterialVertical.uniforms.radius.value = shadow.radius;\n\t\t_renderer.setRenderTarget( shadow.mapPass );\n\t\t_renderer.clear();\n\t\t_renderer.renderBufferDirect( camera, null, geometry, shadowMaterialVertical, fullScreenMesh, null );\n\n\t\t// horizontal pass\n\n\t\tshadowMaterialHorizontal.uniforms.shadow_pass.value = shadow.mapPass.texture;\n\t\tshadowMaterialHorizontal.uniforms.resolution.value = shadow.mapSize;\n\t\tshadowMaterialHorizontal.uniforms.radius.value = shadow.radius;\n\t\t_renderer.setRenderTarget( shadow.map );\n\t\t_renderer.clear();\n\t\t_renderer.renderBufferDirect( camera, null, geometry, shadowMaterialHorizontal, fullScreenMesh, null );\n\n\t}\n\n\tfunction getDepthMaterial( object, geometry, material, light, shadowCameraNear, shadowCameraFar, type ) {\n\n\t\tlet result = null;\n\n\t\tconst customMaterial = ( light.isPointLight === true ) ? object.customDistanceMaterial : object.customDepthMaterial;\n\n\t\tif ( customMaterial !== undefined ) {\n\n\t\t\tresult = customMaterial;\n\n\t\t} else {\n\n\t\t\tresult = ( light.isPointLight === true ) ? _distanceMaterial : _depthMaterial;\n\n\t\t}\n\n\t\tif ( ( _renderer.localClippingEnabled && material.clipShadows === true && material.clippingPlanes.length !== 0 ) ||\n\t\t\t( material.displacementMap && material.displacementScale !== 0 ) ||\n\t\t\t( material.alphaMap && material.alphaTest > 0 ) ) {\n\n\t\t\t// in this case we need a unique material instance reflecting the\n\t\t\t// appropriate state\n\n\t\t\tconst keyA = result.uuid, keyB = material.uuid;\n\n\t\t\tlet materialsForVariant = _materialCache[ keyA ];\n\n\t\t\tif ( materialsForVariant === undefined ) {\n\n\t\t\t\tmaterialsForVariant = {};\n\t\t\t\t_materialCache[ keyA ] = materialsForVariant;\n\n\t\t\t}\n\n\t\t\tlet cachedMaterial = materialsForVariant[ keyB ];\n\n\t\t\tif ( cachedMaterial === undefined ) {\n\n\t\t\t\tcachedMaterial = result.clone();\n\t\t\t\tmaterialsForVariant[ keyB ] = cachedMaterial;\n\n\t\t\t}\n\n\t\t\tresult = cachedMaterial;\n\n\t\t}\n\n\t\tresult.visible = material.visible;\n\t\tresult.wireframe = material.wireframe;\n\n\t\tif ( type === VSMShadowMap ) {\n\n\t\t\tresult.side = ( material.shadowSide !== null ) ? material.shadowSide : material.side;\n\n\t\t} else {\n\n\t\t\tresult.side = ( material.shadowSide !== null ) ? material.shadowSide : shadowSide[ material.side ];\n\n\t\t}\n\n\t\tresult.alphaMap = material.alphaMap;\n\t\tresult.alphaTest = material.alphaTest;\n\n\t\tresult.clipShadows = material.clipShadows;\n\t\tresult.clippingPlanes = material.clippingPlanes;\n\t\tresult.clipIntersection = material.clipIntersection;\n\n\t\tresult.displacementMap = material.displacementMap;\n\t\tresult.displacementScale = material.displacementScale;\n\t\tresult.displacementBias = material.displacementBias;\n\n\t\tresult.wireframeLinewidth = material.wireframeLinewidth;\n\t\tresult.linewidth = material.linewidth;\n\n\t\tif ( light.isPointLight === true && result.isMeshDistanceMaterial === true ) {\n\n\t\t\tresult.referencePosition.setFromMatrixPosition( light.matrixWorld );\n\t\t\tresult.nearDistance = shadowCameraNear;\n\t\t\tresult.farDistance = shadowCameraFar;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tfunction renderObject( object, camera, shadowCamera, light, type ) {\n\n\t\tif ( object.visible === false ) return;\n\n\t\tconst visible = object.layers.test( camera.layers );\n\n\t\tif ( visible && ( object.isMesh || object.isLine || object.isPoints ) ) {\n\n\t\t\tif ( ( object.castShadow || ( object.receiveShadow && type === VSMShadowMap ) ) && ( ! object.frustumCulled || _frustum.intersectsObject( object ) ) ) {\n\n\t\t\t\tobject.modelViewMatrix.multiplyMatrices( shadowCamera.matrixWorldInverse, object.matrixWorld );\n\n\t\t\t\tconst geometry = _objects.update( object );\n\t\t\t\tconst material = object.material;\n\n\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\tconst groups = geometry.groups;\n\n\t\t\t\t\tfor ( let k = 0, kl = groups.length; k < kl; k ++ ) {\n\n\t\t\t\t\t\tconst group = groups[ k ];\n\t\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\t\tif ( groupMaterial && groupMaterial.visible ) {\n\n\t\t\t\t\t\t\tconst depthMaterial = getDepthMaterial( object, geometry, groupMaterial, light, shadowCamera.near, shadowCamera.far, type );\n\n\t\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, group );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( material.visible ) {\n\n\t\t\t\t\tconst depthMaterial = getDepthMaterial( object, geometry, material, light, shadowCamera.near, shadowCamera.far, type );\n\n\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, null );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\trenderObject( children[ i ], camera, shadowCamera, light, type );\n\n\t\t}\n\n\t}\n\n}\n\nfunction WebGLState( gl, extensions, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tfunction ColorBuffer() {\n\n\t\tlet locked = false;\n\n\t\tconst color = new Vector4();\n\t\tlet currentColorMask = null;\n\t\tconst currentColorClear = new Vector4( 0, 0, 0, 0 );\n\n\t\treturn {\n\n\t\t\tsetMask: function ( colorMask ) {\n\n\t\t\t\tif ( currentColorMask !== colorMask && ! locked ) {\n\n\t\t\t\t\tgl.colorMask( colorMask, colorMask, colorMask, colorMask );\n\t\t\t\t\tcurrentColorMask = colorMask;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetLocked: function ( lock ) {\n\n\t\t\t\tlocked = lock;\n\n\t\t\t},\n\n\t\t\tsetClear: function ( r, g, b, a, premultipliedAlpha ) {\n\n\t\t\t\tif ( premultipliedAlpha === true ) {\n\n\t\t\t\t\tr *= a; g *= a; b *= a;\n\n\t\t\t\t}\n\n\t\t\t\tcolor.set( r, g, b, a );\n\n\t\t\t\tif ( currentColorClear.equals( color ) === false ) {\n\n\t\t\t\t\tgl.clearColor( r, g, b, a );\n\t\t\t\t\tcurrentColorClear.copy( color );\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\treset: function () {\n\n\t\t\t\tlocked = false;\n\n\t\t\t\tcurrentColorMask = null;\n\t\t\t\tcurrentColorClear.set( - 1, 0, 0, 0 ); // set to invalid state\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\tfunction DepthBuffer() {\n\n\t\tlet locked = false;\n\n\t\tlet currentDepthMask = null;\n\t\tlet currentDepthFunc = null;\n\t\tlet currentDepthClear = null;\n\n\t\treturn {\n\n\t\t\tsetTest: function ( depthTest ) {\n\n\t\t\t\tif ( depthTest ) {\n\n\t\t\t\t\tenable( 2929 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdisable( 2929 );\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetMask: function ( depthMask ) {\n\n\t\t\t\tif ( currentDepthMask !== depthMask && ! locked ) {\n\n\t\t\t\t\tgl.depthMask( depthMask );\n\t\t\t\t\tcurrentDepthMask = depthMask;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetFunc: function ( depthFunc ) {\n\n\t\t\t\tif ( currentDepthFunc !== depthFunc ) {\n\n\t\t\t\t\tif ( depthFunc ) {\n\n\t\t\t\t\t\tswitch ( depthFunc ) {\n\n\t\t\t\t\t\t\tcase NeverDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( 512 );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase AlwaysDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( 519 );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase LessDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( 513 );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase LessEqualDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( 515 );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase EqualDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( 514 );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase GreaterEqualDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( 518 );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase GreaterDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( 516 );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase NotEqualDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( 517 );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( 515 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tgl.depthFunc( 515 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrentDepthFunc = depthFunc;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetLocked: function ( lock ) {\n\n\t\t\t\tlocked = lock;\n\n\t\t\t},\n\n\t\t\tsetClear: function ( depth ) {\n\n\t\t\t\tif ( currentDepthClear !== depth ) {\n\n\t\t\t\t\tgl.clearDepth( depth );\n\t\t\t\t\tcurrentDepthClear = depth;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\treset: function () {\n\n\t\t\t\tlocked = false;\n\n\t\t\t\tcurrentDepthMask = null;\n\t\t\t\tcurrentDepthFunc = null;\n\t\t\t\tcurrentDepthClear = null;\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\tfunction StencilBuffer() {\n\n\t\tlet locked = false;\n\n\t\tlet currentStencilMask = null;\n\t\tlet currentStencilFunc = null;\n\t\tlet currentStencilRef = null;\n\t\tlet currentStencilFuncMask = null;\n\t\tlet currentStencilFail = null;\n\t\tlet currentStencilZFail = null;\n\t\tlet currentStencilZPass = null;\n\t\tlet currentStencilClear = null;\n\n\t\treturn {\n\n\t\t\tsetTest: function ( stencilTest ) {\n\n\t\t\t\tif ( ! locked ) {\n\n\t\t\t\t\tif ( stencilTest ) {\n\n\t\t\t\t\t\tenable( 2960 );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tdisable( 2960 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetMask: function ( stencilMask ) {\n\n\t\t\t\tif ( currentStencilMask !== stencilMask && ! locked ) {\n\n\t\t\t\t\tgl.stencilMask( stencilMask );\n\t\t\t\t\tcurrentStencilMask = stencilMask;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetFunc: function ( stencilFunc, stencilRef, stencilMask ) {\n\n\t\t\t\tif ( currentStencilFunc !== stencilFunc ||\n\t\t\t\t     currentStencilRef !== stencilRef ||\n\t\t\t\t     currentStencilFuncMask !== stencilMask ) {\n\n\t\t\t\t\tgl.stencilFunc( stencilFunc, stencilRef, stencilMask );\n\n\t\t\t\t\tcurrentStencilFunc = stencilFunc;\n\t\t\t\t\tcurrentStencilRef = stencilRef;\n\t\t\t\t\tcurrentStencilFuncMask = stencilMask;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetOp: function ( stencilFail, stencilZFail, stencilZPass ) {\n\n\t\t\t\tif ( currentStencilFail !== stencilFail ||\n\t\t\t\t     currentStencilZFail !== stencilZFail ||\n\t\t\t\t     currentStencilZPass !== stencilZPass ) {\n\n\t\t\t\t\tgl.stencilOp( stencilFail, stencilZFail, stencilZPass );\n\n\t\t\t\t\tcurrentStencilFail = stencilFail;\n\t\t\t\t\tcurrentStencilZFail = stencilZFail;\n\t\t\t\t\tcurrentStencilZPass = stencilZPass;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetLocked: function ( lock ) {\n\n\t\t\t\tlocked = lock;\n\n\t\t\t},\n\n\t\t\tsetClear: function ( stencil ) {\n\n\t\t\t\tif ( currentStencilClear !== stencil ) {\n\n\t\t\t\t\tgl.clearStencil( stencil );\n\t\t\t\t\tcurrentStencilClear = stencil;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\treset: function () {\n\n\t\t\t\tlocked = false;\n\n\t\t\t\tcurrentStencilMask = null;\n\t\t\t\tcurrentStencilFunc = null;\n\t\t\t\tcurrentStencilRef = null;\n\t\t\t\tcurrentStencilFuncMask = null;\n\t\t\t\tcurrentStencilFail = null;\n\t\t\t\tcurrentStencilZFail = null;\n\t\t\t\tcurrentStencilZPass = null;\n\t\t\t\tcurrentStencilClear = null;\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t//\n\n\tconst colorBuffer = new ColorBuffer();\n\tconst depthBuffer = new DepthBuffer();\n\tconst stencilBuffer = new StencilBuffer();\n\n\tlet enabledCapabilities = {};\n\n\tlet currentBoundFramebuffers = {};\n\tlet currentDrawbuffers = new WeakMap();\n\tlet defaultDrawbuffers = [];\n\n\tlet currentProgram = null;\n\n\tlet currentBlendingEnabled = false;\n\tlet currentBlending = null;\n\tlet currentBlendEquation = null;\n\tlet currentBlendSrc = null;\n\tlet currentBlendDst = null;\n\tlet currentBlendEquationAlpha = null;\n\tlet currentBlendSrcAlpha = null;\n\tlet currentBlendDstAlpha = null;\n\tlet currentPremultipledAlpha = false;\n\n\tlet currentFlipSided = null;\n\tlet currentCullFace = null;\n\n\tlet currentLineWidth = null;\n\n\tlet currentPolygonOffsetFactor = null;\n\tlet currentPolygonOffsetUnits = null;\n\n\tconst maxTextures = gl.getParameter( 35661 );\n\n\tlet lineWidthAvailable = false;\n\tlet version = 0;\n\tconst glVersion = gl.getParameter( 7938 );\n\n\tif ( glVersion.indexOf( 'WebGL' ) !== - 1 ) {\n\n\t\tversion = parseFloat( /^WebGL (\\d)/.exec( glVersion )[ 1 ] );\n\t\tlineWidthAvailable = ( version >= 1.0 );\n\n\t} else if ( glVersion.indexOf( 'OpenGL ES' ) !== - 1 ) {\n\n\t\tversion = parseFloat( /^OpenGL ES (\\d)/.exec( glVersion )[ 1 ] );\n\t\tlineWidthAvailable = ( version >= 2.0 );\n\n\t}\n\n\tlet currentTextureSlot = null;\n\tlet currentBoundTextures = {};\n\n\tconst scissorParam = gl.getParameter( 3088 );\n\tconst viewportParam = gl.getParameter( 2978 );\n\n\tconst currentScissor = new Vector4().fromArray( scissorParam );\n\tconst currentViewport = new Vector4().fromArray( viewportParam );\n\n\tfunction createTexture( type, target, count ) {\n\n\t\tconst data = new Uint8Array( 4 ); // 4 is required to match default unpack alignment of 4.\n\t\tconst texture = gl.createTexture();\n\n\t\tgl.bindTexture( type, texture );\n\t\tgl.texParameteri( type, 10241, 9728 );\n\t\tgl.texParameteri( type, 10240, 9728 );\n\n\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\tgl.texImage2D( target + i, 0, 6408, 1, 1, 0, 6408, 5121, data );\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tconst emptyTextures = {};\n\temptyTextures[ 3553 ] = createTexture( 3553, 3553, 1 );\n\temptyTextures[ 34067 ] = createTexture( 34067, 34069, 6 );\n\n\t// init\n\n\tcolorBuffer.setClear( 0, 0, 0, 1 );\n\tdepthBuffer.setClear( 1 );\n\tstencilBuffer.setClear( 0 );\n\n\tenable( 2929 );\n\tdepthBuffer.setFunc( LessEqualDepth );\n\n\tsetFlipSided( false );\n\tsetCullFace( CullFaceBack );\n\tenable( 2884 );\n\n\tsetBlending( NoBlending );\n\n\t//\n\n\tfunction enable( id ) {\n\n\t\tif ( enabledCapabilities[ id ] !== true ) {\n\n\t\t\tgl.enable( id );\n\t\t\tenabledCapabilities[ id ] = true;\n\n\t\t}\n\n\t}\n\n\tfunction disable( id ) {\n\n\t\tif ( enabledCapabilities[ id ] !== false ) {\n\n\t\t\tgl.disable( id );\n\t\t\tenabledCapabilities[ id ] = false;\n\n\t\t}\n\n\t}\n\n\tfunction bindFramebuffer( target, framebuffer ) {\n\n\t\tif ( currentBoundFramebuffers[ target ] !== framebuffer ) {\n\n\t\t\tgl.bindFramebuffer( target, framebuffer );\n\n\t\t\tcurrentBoundFramebuffers[ target ] = framebuffer;\n\n\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\t// 36009 is equivalent to 36160\n\n\t\t\t\tif ( target === 36009 ) {\n\n\t\t\t\t\tcurrentBoundFramebuffers[ 36160 ] = framebuffer;\n\n\t\t\t\t}\n\n\t\t\t\tif ( target === 36160 ) {\n\n\t\t\t\t\tcurrentBoundFramebuffers[ 36009 ] = framebuffer;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tfunction drawBuffers( renderTarget, framebuffer ) {\n\n\t\tlet drawBuffers = defaultDrawbuffers;\n\n\t\tlet needsUpdate = false;\n\n\t\tif ( renderTarget ) {\n\n\t\t\tdrawBuffers = currentDrawbuffers.get( framebuffer );\n\n\t\t\tif ( drawBuffers === undefined ) {\n\n\t\t\t\tdrawBuffers = [];\n\t\t\t\tcurrentDrawbuffers.set( framebuffer, drawBuffers );\n\n\t\t\t}\n\n\t\t\tif ( renderTarget.isWebGLMultipleRenderTargets ) {\n\n\t\t\t\tconst textures = renderTarget.texture;\n\n\t\t\t\tif ( drawBuffers.length !== textures.length || drawBuffers[ 0 ] !== 36064 ) {\n\n\t\t\t\t\tfor ( let i = 0, il = textures.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tdrawBuffers[ i ] = 36064 + i;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tdrawBuffers.length = textures.length;\n\n\t\t\t\t\tneedsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( drawBuffers[ 0 ] !== 36064 ) {\n\n\t\t\t\t\tdrawBuffers[ 0 ] = 36064;\n\n\t\t\t\t\tneedsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( drawBuffers[ 0 ] !== 1029 ) {\n\n\t\t\t\tdrawBuffers[ 0 ] = 1029;\n\n\t\t\t\tneedsUpdate = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( needsUpdate ) {\n\n\t\t\tif ( capabilities.isWebGL2 ) {\n\n\t\t\t\tgl.drawBuffers( drawBuffers );\n\n\t\t\t} else {\n\n\t\t\t\textensions.get( 'WEBGL_draw_buffers' ).drawBuffersWEBGL( drawBuffers );\n\n\t\t\t}\n\n\t\t}\n\n\n\t}\n\n\tfunction useProgram( program ) {\n\n\t\tif ( currentProgram !== program ) {\n\n\t\t\tgl.useProgram( program );\n\n\t\t\tcurrentProgram = program;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tconst equationToGL = {\n\t\t[ AddEquation ]: 32774,\n\t\t[ SubtractEquation ]: 32778,\n\t\t[ ReverseSubtractEquation ]: 32779\n\t};\n\n\tif ( isWebGL2 ) {\n\n\t\tequationToGL[ MinEquation ] = 32775;\n\t\tequationToGL[ MaxEquation ] = 32776;\n\n\t} else {\n\n\t\tconst extension = extensions.get( 'EXT_blend_minmax' );\n\n\t\tif ( extension !== null ) {\n\n\t\t\tequationToGL[ MinEquation ] = extension.MIN_EXT;\n\t\t\tequationToGL[ MaxEquation ] = extension.MAX_EXT;\n\n\t\t}\n\n\t}\n\n\tconst factorToGL = {\n\t\t[ ZeroFactor ]: 0,\n\t\t[ OneFactor ]: 1,\n\t\t[ SrcColorFactor ]: 768,\n\t\t[ SrcAlphaFactor ]: 770,\n\t\t[ SrcAlphaSaturateFactor ]: 776,\n\t\t[ DstColorFactor ]: 774,\n\t\t[ DstAlphaFactor ]: 772,\n\t\t[ OneMinusSrcColorFactor ]: 769,\n\t\t[ OneMinusSrcAlphaFactor ]: 771,\n\t\t[ OneMinusDstColorFactor ]: 775,\n\t\t[ OneMinusDstAlphaFactor ]: 773\n\t};\n\n\tfunction setBlending( blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha, premultipliedAlpha ) {\n\n\t\tif ( blending === NoBlending ) {\n\n\t\t\tif ( currentBlendingEnabled === true ) {\n\n\t\t\t\tdisable( 3042 );\n\t\t\t\tcurrentBlendingEnabled = false;\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( currentBlendingEnabled === false ) {\n\n\t\t\tenable( 3042 );\n\t\t\tcurrentBlendingEnabled = true;\n\n\t\t}\n\n\t\tif ( blending !== CustomBlending ) {\n\n\t\t\tif ( blending !== currentBlending || premultipliedAlpha !== currentPremultipledAlpha ) {\n\n\t\t\t\tif ( currentBlendEquation !== AddEquation || currentBlendEquationAlpha !== AddEquation ) {\n\n\t\t\t\t\tgl.blendEquation( 32774 );\n\n\t\t\t\t\tcurrentBlendEquation = AddEquation;\n\t\t\t\t\tcurrentBlendEquationAlpha = AddEquation;\n\n\t\t\t\t}\n\n\t\t\t\tif ( premultipliedAlpha ) {\n\n\t\t\t\t\tswitch ( blending ) {\n\n\t\t\t\t\t\tcase NormalBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( 1, 771, 1, 771 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase AdditiveBlending:\n\t\t\t\t\t\t\tgl.blendFunc( 1, 1 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase SubtractiveBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( 0, 769, 0, 1 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase MultiplyBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( 0, 768, 0, 770 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLState: Invalid blending: ', blending );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tswitch ( blending ) {\n\n\t\t\t\t\t\tcase NormalBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( 770, 771, 1, 771 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase AdditiveBlending:\n\t\t\t\t\t\t\tgl.blendFunc( 770, 1 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase SubtractiveBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( 0, 769, 0, 1 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase MultiplyBlending:\n\t\t\t\t\t\t\tgl.blendFunc( 0, 768 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLState: Invalid blending: ', blending );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tcurrentBlendSrc = null;\n\t\t\t\tcurrentBlendDst = null;\n\t\t\t\tcurrentBlendSrcAlpha = null;\n\t\t\t\tcurrentBlendDstAlpha = null;\n\n\t\t\t\tcurrentBlending = blending;\n\t\t\t\tcurrentPremultipledAlpha = premultipliedAlpha;\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// custom blending\n\n\t\tblendEquationAlpha = blendEquationAlpha || blendEquation;\n\t\tblendSrcAlpha = blendSrcAlpha || blendSrc;\n\t\tblendDstAlpha = blendDstAlpha || blendDst;\n\n\t\tif ( blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha ) {\n\n\t\t\tgl.blendEquationSeparate( equationToGL[ blendEquation ], equationToGL[ blendEquationAlpha ] );\n\n\t\t\tcurrentBlendEquation = blendEquation;\n\t\t\tcurrentBlendEquationAlpha = blendEquationAlpha;\n\n\t\t}\n\n\t\tif ( blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha ) {\n\n\t\t\tgl.blendFuncSeparate( factorToGL[ blendSrc ], factorToGL[ blendDst ], factorToGL[ blendSrcAlpha ], factorToGL[ blendDstAlpha ] );\n\n\t\t\tcurrentBlendSrc = blendSrc;\n\t\t\tcurrentBlendDst = blendDst;\n\t\t\tcurrentBlendSrcAlpha = blendSrcAlpha;\n\t\t\tcurrentBlendDstAlpha = blendDstAlpha;\n\n\t\t}\n\n\t\tcurrentBlending = blending;\n\t\tcurrentPremultipledAlpha = null;\n\n\t}\n\n\tfunction setMaterial( material, frontFaceCW ) {\n\n\t\tmaterial.side === DoubleSide\n\t\t\t? disable( 2884 )\n\t\t\t: enable( 2884 );\n\n\t\tlet flipSided = ( material.side === BackSide );\n\t\tif ( frontFaceCW ) flipSided = ! flipSided;\n\n\t\tsetFlipSided( flipSided );\n\n\t\t( material.blending === NormalBlending && material.transparent === false )\n\t\t\t? setBlending( NoBlending )\n\t\t\t: setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha, material.premultipliedAlpha );\n\n\t\tdepthBuffer.setFunc( material.depthFunc );\n\t\tdepthBuffer.setTest( material.depthTest );\n\t\tdepthBuffer.setMask( material.depthWrite );\n\t\tcolorBuffer.setMask( material.colorWrite );\n\n\t\tconst stencilWrite = material.stencilWrite;\n\t\tstencilBuffer.setTest( stencilWrite );\n\t\tif ( stencilWrite ) {\n\n\t\t\tstencilBuffer.setMask( material.stencilWriteMask );\n\t\t\tstencilBuffer.setFunc( material.stencilFunc, material.stencilRef, material.stencilFuncMask );\n\t\t\tstencilBuffer.setOp( material.stencilFail, material.stencilZFail, material.stencilZPass );\n\n\t\t}\n\n\t\tsetPolygonOffset( material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits );\n\n\t\tmaterial.alphaToCoverage === true\n\t\t\t? enable( 32926 )\n\t\t\t: disable( 32926 );\n\n\t}\n\n\t//\n\n\tfunction setFlipSided( flipSided ) {\n\n\t\tif ( currentFlipSided !== flipSided ) {\n\n\t\t\tif ( flipSided ) {\n\n\t\t\t\tgl.frontFace( 2304 );\n\n\t\t\t} else {\n\n\t\t\t\tgl.frontFace( 2305 );\n\n\t\t\t}\n\n\t\t\tcurrentFlipSided = flipSided;\n\n\t\t}\n\n\t}\n\n\tfunction setCullFace( cullFace ) {\n\n\t\tif ( cullFace !== CullFaceNone ) {\n\n\t\t\tenable( 2884 );\n\n\t\t\tif ( cullFace !== currentCullFace ) {\n\n\t\t\t\tif ( cullFace === CullFaceBack ) {\n\n\t\t\t\t\tgl.cullFace( 1029 );\n\n\t\t\t\t} else if ( cullFace === CullFaceFront ) {\n\n\t\t\t\t\tgl.cullFace( 1028 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tgl.cullFace( 1032 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tdisable( 2884 );\n\n\t\t}\n\n\t\tcurrentCullFace = cullFace;\n\n\t}\n\n\tfunction setLineWidth( width ) {\n\n\t\tif ( width !== currentLineWidth ) {\n\n\t\t\tif ( lineWidthAvailable ) gl.lineWidth( width );\n\n\t\t\tcurrentLineWidth = width;\n\n\t\t}\n\n\t}\n\n\tfunction setPolygonOffset( polygonOffset, factor, units ) {\n\n\t\tif ( polygonOffset ) {\n\n\t\t\tenable( 32823 );\n\n\t\t\tif ( currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units ) {\n\n\t\t\t\tgl.polygonOffset( factor, units );\n\n\t\t\t\tcurrentPolygonOffsetFactor = factor;\n\t\t\t\tcurrentPolygonOffsetUnits = units;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tdisable( 32823 );\n\n\t\t}\n\n\t}\n\n\tfunction setScissorTest( scissorTest ) {\n\n\t\tif ( scissorTest ) {\n\n\t\t\tenable( 3089 );\n\n\t\t} else {\n\n\t\t\tdisable( 3089 );\n\n\t\t}\n\n\t}\n\n\t// texture\n\n\tfunction activeTexture( webglSlot ) {\n\n\t\tif ( webglSlot === undefined ) webglSlot = 33984 + maxTextures - 1;\n\n\t\tif ( currentTextureSlot !== webglSlot ) {\n\n\t\t\tgl.activeTexture( webglSlot );\n\t\t\tcurrentTextureSlot = webglSlot;\n\n\t\t}\n\n\t}\n\n\tfunction bindTexture( webglType, webglTexture ) {\n\n\t\tif ( currentTextureSlot === null ) {\n\n\t\t\tactiveTexture();\n\n\t\t}\n\n\t\tlet boundTexture = currentBoundTextures[ currentTextureSlot ];\n\n\t\tif ( boundTexture === undefined ) {\n\n\t\t\tboundTexture = { type: undefined, texture: undefined };\n\t\t\tcurrentBoundTextures[ currentTextureSlot ] = boundTexture;\n\n\t\t}\n\n\t\tif ( boundTexture.type !== webglType || boundTexture.texture !== webglTexture ) {\n\n\t\t\tgl.bindTexture( webglType, webglTexture || emptyTextures[ webglType ] );\n\n\t\t\tboundTexture.type = webglType;\n\t\t\tboundTexture.texture = webglTexture;\n\n\t\t}\n\n\t}\n\n\tfunction unbindTexture() {\n\n\t\tconst boundTexture = currentBoundTextures[ currentTextureSlot ];\n\n\t\tif ( boundTexture !== undefined && boundTexture.type !== undefined ) {\n\n\t\t\tgl.bindTexture( boundTexture.type, null );\n\n\t\t\tboundTexture.type = undefined;\n\t\t\tboundTexture.texture = undefined;\n\n\t\t}\n\n\t}\n\n\tfunction compressedTexImage2D() {\n\n\t\ttry {\n\n\t\t\tgl.compressedTexImage2D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction texSubImage2D() {\n\n\t\ttry {\n\n\t\t\tgl.texSubImage2D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction texSubImage3D() {\n\n\t\ttry {\n\n\t\t\tgl.texSubImage3D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction compressedTexSubImage2D() {\n\n\t\ttry {\n\n\t\t\tgl.compressedTexSubImage2D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction texStorage2D() {\n\n\t\ttry {\n\n\t\t\tgl.texStorage2D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction texStorage3D() {\n\n\t\ttry {\n\n\t\t\tgl.texStorage3D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction texImage2D() {\n\n\t\ttry {\n\n\t\t\tgl.texImage2D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction texImage3D() {\n\n\t\ttry {\n\n\t\t\tgl.texImage3D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\t//\n\n\tfunction scissor( scissor ) {\n\n\t\tif ( currentScissor.equals( scissor ) === false ) {\n\n\t\t\tgl.scissor( scissor.x, scissor.y, scissor.z, scissor.w );\n\t\t\tcurrentScissor.copy( scissor );\n\n\t\t}\n\n\t}\n\n\tfunction viewport( viewport ) {\n\n\t\tif ( currentViewport.equals( viewport ) === false ) {\n\n\t\t\tgl.viewport( viewport.x, viewport.y, viewport.z, viewport.w );\n\t\t\tcurrentViewport.copy( viewport );\n\n\t\t}\n\n\t}\n\n\t//\n\n\tfunction reset() {\n\n\t\t// reset state\n\n\t\tgl.disable( 3042 );\n\t\tgl.disable( 2884 );\n\t\tgl.disable( 2929 );\n\t\tgl.disable( 32823 );\n\t\tgl.disable( 3089 );\n\t\tgl.disable( 2960 );\n\t\tgl.disable( 32926 );\n\n\t\tgl.blendEquation( 32774 );\n\t\tgl.blendFunc( 1, 0 );\n\t\tgl.blendFuncSeparate( 1, 0, 1, 0 );\n\n\t\tgl.colorMask( true, true, true, true );\n\t\tgl.clearColor( 0, 0, 0, 0 );\n\n\t\tgl.depthMask( true );\n\t\tgl.depthFunc( 513 );\n\t\tgl.clearDepth( 1 );\n\n\t\tgl.stencilMask( 0xffffffff );\n\t\tgl.stencilFunc( 519, 0, 0xffffffff );\n\t\tgl.stencilOp( 7680, 7680, 7680 );\n\t\tgl.clearStencil( 0 );\n\n\t\tgl.cullFace( 1029 );\n\t\tgl.frontFace( 2305 );\n\n\t\tgl.polygonOffset( 0, 0 );\n\n\t\tgl.activeTexture( 33984 );\n\n\t\tgl.bindFramebuffer( 36160, null );\n\n\t\tif ( isWebGL2 === true ) {\n\n\t\t\tgl.bindFramebuffer( 36009, null );\n\t\t\tgl.bindFramebuffer( 36008, null );\n\n\t\t}\n\n\t\tgl.useProgram( null );\n\n\t\tgl.lineWidth( 1 );\n\n\t\tgl.scissor( 0, 0, gl.canvas.width, gl.canvas.height );\n\t\tgl.viewport( 0, 0, gl.canvas.width, gl.canvas.height );\n\n\t\t// reset internals\n\n\t\tenabledCapabilities = {};\n\n\t\tcurrentTextureSlot = null;\n\t\tcurrentBoundTextures = {};\n\n\t\tcurrentBoundFramebuffers = {};\n\t\tcurrentDrawbuffers = new WeakMap();\n\t\tdefaultDrawbuffers = [];\n\n\t\tcurrentProgram = null;\n\n\t\tcurrentBlendingEnabled = false;\n\t\tcurrentBlending = null;\n\t\tcurrentBlendEquation = null;\n\t\tcurrentBlendSrc = null;\n\t\tcurrentBlendDst = null;\n\t\tcurrentBlendEquationAlpha = null;\n\t\tcurrentBlendSrcAlpha = null;\n\t\tcurrentBlendDstAlpha = null;\n\t\tcurrentPremultipledAlpha = false;\n\n\t\tcurrentFlipSided = null;\n\t\tcurrentCullFace = null;\n\n\t\tcurrentLineWidth = null;\n\n\t\tcurrentPolygonOffsetFactor = null;\n\t\tcurrentPolygonOffsetUnits = null;\n\n\t\tcurrentScissor.set( 0, 0, gl.canvas.width, gl.canvas.height );\n\t\tcurrentViewport.set( 0, 0, gl.canvas.width, gl.canvas.height );\n\n\t\tcolorBuffer.reset();\n\t\tdepthBuffer.reset();\n\t\tstencilBuffer.reset();\n\n\t}\n\n\treturn {\n\n\t\tbuffers: {\n\t\t\tcolor: colorBuffer,\n\t\t\tdepth: depthBuffer,\n\t\t\tstencil: stencilBuffer\n\t\t},\n\n\t\tenable: enable,\n\t\tdisable: disable,\n\n\t\tbindFramebuffer: bindFramebuffer,\n\t\tdrawBuffers: drawBuffers,\n\n\t\tuseProgram: useProgram,\n\n\t\tsetBlending: setBlending,\n\t\tsetMaterial: setMaterial,\n\n\t\tsetFlipSided: setFlipSided,\n\t\tsetCullFace: setCullFace,\n\n\t\tsetLineWidth: setLineWidth,\n\t\tsetPolygonOffset: setPolygonOffset,\n\n\t\tsetScissorTest: setScissorTest,\n\n\t\tactiveTexture: activeTexture,\n\t\tbindTexture: bindTexture,\n\t\tunbindTexture: unbindTexture,\n\t\tcompressedTexImage2D: compressedTexImage2D,\n\t\ttexImage2D: texImage2D,\n\t\ttexImage3D: texImage3D,\n\n\t\ttexStorage2D: texStorage2D,\n\t\ttexStorage3D: texStorage3D,\n\t\ttexSubImage2D: texSubImage2D,\n\t\ttexSubImage3D: texSubImage3D,\n\t\tcompressedTexSubImage2D: compressedTexSubImage2D,\n\n\t\tscissor: scissor,\n\t\tviewport: viewport,\n\n\t\treset: reset\n\n\t};\n\n}\n\nfunction WebGLTextures( _gl, extensions, state, properties, capabilities, utils, info ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\tconst maxTextures = capabilities.maxTextures;\n\tconst maxCubemapSize = capabilities.maxCubemapSize;\n\tconst maxTextureSize = capabilities.maxTextureSize;\n\tconst maxSamples = capabilities.maxSamples;\n\tconst hasMultisampledRenderToTexture = extensions.has( 'WEBGL_multisampled_render_to_texture' );\n\tconst MultisampledRenderToTextureExtension = hasMultisampledRenderToTexture ? extensions.get( 'WEBGL_multisampled_render_to_texture' ) : undefined;\n\n\tconst _videoTextures = new WeakMap();\n\tlet _canvas;\n\n\t// cordova iOS (as of 5.0) still uses UIWebView, which provides OffscreenCanvas,\n\t// also OffscreenCanvas.getContext(\"webgl\"), but not OffscreenCanvas.getContext(\"2d\")!\n\t// Some implementations may only implement OffscreenCanvas partially (e.g. lacking 2d).\n\n\tlet useOffscreenCanvas = false;\n\n\ttry {\n\n\t\tuseOffscreenCanvas = typeof OffscreenCanvas !== 'undefined'\n\t\t\t&& ( new OffscreenCanvas( 1, 1 ).getContext( '2d' ) ) !== null;\n\n\t} catch ( err ) {\n\n\t\t// Ignore any errors\n\n\t}\n\n\tfunction createCanvas( width, height ) {\n\n\t\t// Use OffscreenCanvas when available. Specially needed in web workers\n\n\t\treturn useOffscreenCanvas ?\n\t\t\tnew OffscreenCanvas( width, height ) : createElementNS( 'canvas' );\n\n\t}\n\n\tfunction resizeImage( image, needsPowerOfTwo, needsNewCanvas, maxSize ) {\n\n\t\tlet scale = 1;\n\n\t\t// handle case if texture exceeds max size\n\n\t\tif ( image.width > maxSize || image.height > maxSize ) {\n\n\t\t\tscale = maxSize / Math.max( image.width, image.height );\n\n\t\t}\n\n\t\t// only perform resize if necessary\n\n\t\tif ( scale < 1 || needsPowerOfTwo === true ) {\n\n\t\t\t// only perform resize for certain image types\n\n\t\t\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t\t\tconst floor = needsPowerOfTwo ? floorPowerOfTwo : Math.floor;\n\n\t\t\t\tconst width = floor( scale * image.width );\n\t\t\t\tconst height = floor( scale * image.height );\n\n\t\t\t\tif ( _canvas === undefined ) _canvas = createCanvas( width, height );\n\n\t\t\t\t// cube textures can't reuse the same canvas\n\n\t\t\t\tconst canvas = needsNewCanvas ? createCanvas( width, height ) : _canvas;\n\n\t\t\t\tcanvas.width = width;\n\t\t\t\tcanvas.height = height;\n\n\t\t\t\tconst context = canvas.getContext( '2d' );\n\t\t\t\tcontext.drawImage( image, 0, 0, width, height );\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture has been resized from (' + image.width + 'x' + image.height + ') to (' + width + 'x' + height + ').' );\n\n\t\t\t\treturn canvas;\n\n\t\t\t} else {\n\n\t\t\t\tif ( 'data' in image ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Image in DataTexture is too big (' + image.width + 'x' + image.height + ').' );\n\n\t\t\t\t}\n\n\t\t\t\treturn image;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn image;\n\n\t}\n\n\tfunction isPowerOfTwo$1( image ) {\n\n\t\treturn isPowerOfTwo( image.width ) && isPowerOfTwo( image.height );\n\n\t}\n\n\tfunction textureNeedsPowerOfTwo( texture ) {\n\n\t\tif ( isWebGL2 ) return false;\n\n\t\treturn ( texture.wrapS !== ClampToEdgeWrapping || texture.wrapT !== ClampToEdgeWrapping ) ||\n\t\t\t( texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter );\n\n\t}\n\n\tfunction textureNeedsGenerateMipmaps( texture, supportsMips ) {\n\n\t\treturn texture.generateMipmaps && supportsMips &&\n\t\t\ttexture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter;\n\n\t}\n\n\tfunction generateMipmap( target ) {\n\n\t\t_gl.generateMipmap( target );\n\n\t}\n\n\tfunction getInternalFormat( internalFormatName, glFormat, glType, encoding, isVideoTexture = false ) {\n\n\t\tif ( isWebGL2 === false ) return glFormat;\n\n\t\tif ( internalFormatName !== null ) {\n\n\t\t\tif ( _gl[ internalFormatName ] !== undefined ) return _gl[ internalFormatName ];\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format \\'' + internalFormatName + '\\'' );\n\n\t\t}\n\n\t\tlet internalFormat = glFormat;\n\n\t\tif ( glFormat === 6403 ) {\n\n\t\t\tif ( glType === 5126 ) internalFormat = 33326;\n\t\t\tif ( glType === 5131 ) internalFormat = 33325;\n\t\t\tif ( glType === 5121 ) internalFormat = 33321;\n\n\t\t}\n\n\t\tif ( glFormat === 33319 ) {\n\n\t\t\tif ( glType === 5126 ) internalFormat = 33328;\n\t\t\tif ( glType === 5131 ) internalFormat = 33327;\n\t\t\tif ( glType === 5121 ) internalFormat = 33323;\n\n\t\t}\n\n\t\tif ( glFormat === 6408 ) {\n\n\t\t\tif ( glType === 5126 ) internalFormat = 34836;\n\t\t\tif ( glType === 5131 ) internalFormat = 34842;\n\t\t\tif ( glType === 5121 ) internalFormat = ( encoding === sRGBEncoding && isVideoTexture === false ) ? 35907 : 32856;\n\t\t\tif ( glType === 32819 ) internalFormat = 32854;\n\t\t\tif ( glType === 32820 ) internalFormat = 32855;\n\n\t\t}\n\n\t\tif ( internalFormat === 33325 || internalFormat === 33326 ||\n\t\t\tinternalFormat === 33327 || internalFormat === 33328 ||\n\t\t\tinternalFormat === 34842 || internalFormat === 34836 ) {\n\n\t\t\textensions.get( 'EXT_color_buffer_float' );\n\n\t\t}\n\n\t\treturn internalFormat;\n\n\t}\n\n\tfunction getMipLevels( texture, image, supportsMips ) {\n\n\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) === true || ( texture.isFramebufferTexture && texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter ) ) {\n\n\t\t\treturn Math.log2( Math.max( image.width, image.height ) ) + 1;\n\n\t\t} else if ( texture.mipmaps !== undefined && texture.mipmaps.length > 0 ) {\n\n\t\t\t// user-defined mipmaps\n\n\t\t\treturn texture.mipmaps.length;\n\n\t\t} else if ( texture.isCompressedTexture && Array.isArray( texture.image ) ) {\n\n\t\t\treturn image.mipmaps.length;\n\n\t\t} else {\n\n\t\t\t// texture without mipmaps (only base level)\n\n\t\t\treturn 1;\n\n\t\t}\n\n\t}\n\n\t// Fallback filters for non-power-of-2 textures\n\n\tfunction filterFallback( f ) {\n\n\t\tif ( f === NearestFilter || f === NearestMipmapNearestFilter || f === NearestMipmapLinearFilter ) {\n\n\t\t\treturn 9728;\n\n\t\t}\n\n\t\treturn 9729;\n\n\t}\n\n\t//\n\n\tfunction onTextureDispose( event ) {\n\n\t\tconst texture = event.target;\n\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\n\n\t\tdeallocateTexture( texture );\n\n\t\tif ( texture.isVideoTexture ) {\n\n\t\t\t_videoTextures.delete( texture );\n\n\t\t}\n\n\t\tinfo.memory.textures --;\n\n\t}\n\n\tfunction onRenderTargetDispose( event ) {\n\n\t\tconst renderTarget = event.target;\n\n\t\trenderTarget.removeEventListener( 'dispose', onRenderTargetDispose );\n\n\t\tdeallocateRenderTarget( renderTarget );\n\n\t}\n\n\t//\n\n\tfunction deallocateTexture( texture ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( textureProperties.__webglInit === undefined ) return;\n\n\t\t_gl.deleteTexture( textureProperties.__webglTexture );\n\n\t\tproperties.remove( texture );\n\n\t}\n\n\tfunction deallocateRenderTarget( renderTarget ) {\n\n\t\tconst texture = renderTarget.texture;\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( ! renderTarget ) return;\n\n\t\tif ( textureProperties.__webglTexture !== undefined ) {\n\n\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\n\n\t\t\tinfo.memory.textures --;\n\n\t\t}\n\n\t\tif ( renderTarget.depthTexture ) {\n\n\t\t\trenderTarget.depthTexture.dispose();\n\n\t\t}\n\n\t\tif ( renderTarget.isWebGLCubeRenderTarget ) {\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer[ i ] );\n\t\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer[ i ] );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer );\n\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer );\n\t\t\tif ( renderTargetProperties.__webglMultisampledFramebuffer ) _gl.deleteFramebuffer( renderTargetProperties.__webglMultisampledFramebuffer );\n\t\t\tif ( renderTargetProperties.__webglColorRenderbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglColorRenderbuffer );\n\t\t\tif ( renderTargetProperties.__webglDepthRenderbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthRenderbuffer );\n\n\t\t}\n\n\t\tif ( renderTarget.isWebGLMultipleRenderTargets ) {\n\n\t\t\tfor ( let i = 0, il = texture.length; i < il; i ++ ) {\n\n\t\t\t\tconst attachmentProperties = properties.get( texture[ i ] );\n\n\t\t\t\tif ( attachmentProperties.__webglTexture ) {\n\n\t\t\t\t\t_gl.deleteTexture( attachmentProperties.__webglTexture );\n\n\t\t\t\t\tinfo.memory.textures --;\n\n\t\t\t\t}\n\n\t\t\t\tproperties.remove( texture[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tproperties.remove( texture );\n\t\tproperties.remove( renderTarget );\n\n\t}\n\n\t//\n\n\tlet textureUnits = 0;\n\n\tfunction resetTextureUnits() {\n\n\t\ttextureUnits = 0;\n\n\t}\n\n\tfunction allocateTextureUnit() {\n\n\t\tconst textureUnit = textureUnits;\n\n\t\tif ( textureUnit >= maxTextures ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLTextures: Trying to use ' + textureUnit + ' texture units while this GPU supports only ' + maxTextures );\n\n\t\t}\n\n\t\ttextureUnits += 1;\n\n\t\treturn textureUnit;\n\n\t}\n\n\t//\n\n\tfunction setTexture2D( texture, slot ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( texture.isVideoTexture ) updateVideoTexture( texture );\n\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\tconst image = texture.image;\n\n\t\t\tif ( image === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is undefined' );\n\n\t\t\t} else if ( image.complete === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is incomplete' );\n\n\t\t\t} else {\n\n\t\t\t\tuploadTexture( textureProperties, texture, slot );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.activeTexture( 33984 + slot );\n\t\tstate.bindTexture( 3553, textureProperties.__webglTexture );\n\n\t}\n\n\tfunction setTexture2DArray( texture, slot ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\tuploadTexture( textureProperties, texture, slot );\n\t\t\treturn;\n\n\t\t}\n\n\t\tstate.activeTexture( 33984 + slot );\n\t\tstate.bindTexture( 35866, textureProperties.__webglTexture );\n\n\t}\n\n\tfunction setTexture3D( texture, slot ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\tuploadTexture( textureProperties, texture, slot );\n\t\t\treturn;\n\n\t\t}\n\n\t\tstate.activeTexture( 33984 + slot );\n\t\tstate.bindTexture( 32879, textureProperties.__webglTexture );\n\n\t}\n\n\tfunction setTextureCube( texture, slot ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\tuploadCubeTexture( textureProperties, texture, slot );\n\t\t\treturn;\n\n\t\t}\n\n\t\tstate.activeTexture( 33984 + slot );\n\t\tstate.bindTexture( 34067, textureProperties.__webglTexture );\n\n\t}\n\n\tconst wrappingToGL = {\n\t\t[ RepeatWrapping ]: 10497,\n\t\t[ ClampToEdgeWrapping ]: 33071,\n\t\t[ MirroredRepeatWrapping ]: 33648\n\t};\n\n\tconst filterToGL = {\n\t\t[ NearestFilter ]: 9728,\n\t\t[ NearestMipmapNearestFilter ]: 9984,\n\t\t[ NearestMipmapLinearFilter ]: 9986,\n\n\t\t[ LinearFilter ]: 9729,\n\t\t[ LinearMipmapNearestFilter ]: 9985,\n\t\t[ LinearMipmapLinearFilter ]: 9987\n\t};\n\n\tfunction setTextureParameters( textureType, texture, supportsMips ) {\n\n\t\tif ( supportsMips ) {\n\n\t\t\t_gl.texParameteri( textureType, 10242, wrappingToGL[ texture.wrapS ] );\n\t\t\t_gl.texParameteri( textureType, 10243, wrappingToGL[ texture.wrapT ] );\n\n\t\t\tif ( textureType === 32879 || textureType === 35866 ) {\n\n\t\t\t\t_gl.texParameteri( textureType, 32882, wrappingToGL[ texture.wrapR ] );\n\n\t\t\t}\n\n\t\t\t_gl.texParameteri( textureType, 10240, filterToGL[ texture.magFilter ] );\n\t\t\t_gl.texParameteri( textureType, 10241, filterToGL[ texture.minFilter ] );\n\n\t\t} else {\n\n\t\t\t_gl.texParameteri( textureType, 10242, 33071 );\n\t\t\t_gl.texParameteri( textureType, 10243, 33071 );\n\n\t\t\tif ( textureType === 32879 || textureType === 35866 ) {\n\n\t\t\t\t_gl.texParameteri( textureType, 32882, 33071 );\n\n\t\t\t}\n\n\t\t\tif ( texture.wrapS !== ClampToEdgeWrapping || texture.wrapT !== ClampToEdgeWrapping ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.' );\n\n\t\t\t}\n\n\t\t\t_gl.texParameteri( textureType, 10240, filterFallback( texture.magFilter ) );\n\t\t\t_gl.texParameteri( textureType, 10241, filterFallback( texture.minFilter ) );\n\n\t\t\tif ( texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.' );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( extensions.has( 'EXT_texture_filter_anisotropic' ) === true ) {\n\n\t\t\tconst extension = extensions.get( 'EXT_texture_filter_anisotropic' );\n\n\t\t\tif ( texture.type === FloatType && extensions.has( 'OES_texture_float_linear' ) === false ) return; // verify extension for WebGL 1 and WebGL 2\n\t\t\tif ( isWebGL2 === false && ( texture.type === HalfFloatType && extensions.has( 'OES_texture_half_float_linear' ) === false ) ) return; // verify extension for WebGL 1 only\n\n\t\t\tif ( texture.anisotropy > 1 || properties.get( texture ).__currentAnisotropy ) {\n\n\t\t\t\t_gl.texParameterf( textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min( texture.anisotropy, capabilities.getMaxAnisotropy() ) );\n\t\t\t\tproperties.get( texture ).__currentAnisotropy = texture.anisotropy;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction initTexture( textureProperties, texture ) {\n\n\t\tif ( textureProperties.__webglInit === undefined ) {\n\n\t\t\ttextureProperties.__webglInit = true;\n\n\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\n\n\t\t\tinfo.memory.textures ++;\n\n\t\t}\n\n\t}\n\n\tfunction uploadTexture( textureProperties, texture, slot ) {\n\n\t\tlet textureType = 3553;\n\n\t\tif ( texture.isDataTexture2DArray ) textureType = 35866;\n\t\tif ( texture.isDataTexture3D ) textureType = 32879;\n\n\t\tinitTexture( textureProperties, texture );\n\n\t\tstate.activeTexture( 33984 + slot );\n\t\tstate.bindTexture( textureType, textureProperties.__webglTexture );\n\n\t\t_gl.pixelStorei( 37440, texture.flipY );\n\t\t_gl.pixelStorei( 37441, texture.premultiplyAlpha );\n\t\t_gl.pixelStorei( 3317, texture.unpackAlignment );\n\t\t_gl.pixelStorei( 37443, 0 );\n\n\t\tconst needsPowerOfTwo = textureNeedsPowerOfTwo( texture ) && isPowerOfTwo$1( texture.image ) === false;\n\t\tlet image = resizeImage( texture.image, needsPowerOfTwo, false, maxTextureSize );\n\t\timage = verifyColorSpace( texture, image );\n\n\t\tconst supportsMips = isPowerOfTwo$1( image ) || isWebGL2,\n\t\t\tglFormat = utils.convert( texture.format, texture.encoding );\n\n\t\tlet glType = utils.convert( texture.type ),\n\t\t\tglInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding, texture.isVideoTexture );\n\n\t\tsetTextureParameters( textureType, texture, supportsMips );\n\n\t\tlet mipmap;\n\t\tconst mipmaps = texture.mipmaps;\n\n\t\tconst useTexStorage = ( isWebGL2 && texture.isVideoTexture !== true );\n\t\tconst allocateMemory = ( textureProperties.__version === undefined );\n\t\tconst levels = getMipLevels( texture, image, supportsMips );\n\n\t\tif ( texture.isDepthTexture ) {\n\n\t\t\t// populate depth texture with dummy data\n\n\t\t\tglInternalFormat = 6402;\n\n\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\tif ( texture.type === FloatType ) {\n\n\t\t\t\t\tglInternalFormat = 36012;\n\n\t\t\t\t} else if ( texture.type === UnsignedIntType ) {\n\n\t\t\t\t\tglInternalFormat = 33190;\n\n\t\t\t\t} else if ( texture.type === UnsignedInt248Type ) {\n\n\t\t\t\t\tglInternalFormat = 35056;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tglInternalFormat = 33189; // WebGL2 requires sized internalformat for glTexImage2D\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( texture.type === FloatType ) {\n\n\t\t\t\t\tconsole.error( 'WebGLRenderer: Floating point depth texture requires WebGL2.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// validation checks for WebGL 1\n\n\t\t\tif ( texture.format === DepthFormat && glInternalFormat === 6402 ) {\n\n\t\t\t\t// The error INVALID_OPERATION is generated by texImage2D if format and internalformat are\n\t\t\t\t// DEPTH_COMPONENT and type is not UNSIGNED_SHORT or UNSIGNED_INT\n\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\n\t\t\t\tif ( texture.type !== UnsignedShortType && texture.type !== UnsignedIntType ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture.' );\n\n\t\t\t\t\ttexture.type = UnsignedShortType;\n\t\t\t\t\tglType = utils.convert( texture.type );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( texture.format === DepthStencilFormat && glInternalFormat === 6402 ) {\n\n\t\t\t\t// Depth stencil textures need the DEPTH_STENCIL internal format\n\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\n\t\t\t\tglInternalFormat = 34041;\n\n\t\t\t\t// The error INVALID_OPERATION is generated by texImage2D if format and internalformat are\n\t\t\t\t// DEPTH_STENCIL and type is not UNSIGNED_INT_24_8_WEBGL.\n\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\n\t\t\t\tif ( texture.type !== UnsignedInt248Type ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture.' );\n\n\t\t\t\t\ttexture.type = UnsignedInt248Type;\n\t\t\t\t\tglType = utils.convert( texture.type );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tif ( useTexStorage && allocateMemory ) {\n\n\t\t\t\tstate.texStorage2D( 3553, 1, glInternalFormat, image.width, image.height );\n\n\t\t\t} else {\n\n\t\t\t\tstate.texImage2D( 3553, 0, glInternalFormat, image.width, image.height, 0, glFormat, glType, null );\n\n\t\t\t}\n\n\t\t} else if ( texture.isDataTexture ) {\n\n\t\t\t// use manually created mipmaps if available\n\t\t\t// if there are no manual mipmaps\n\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\n\n\t\t\tif ( mipmaps.length > 0 && supportsMips ) {\n\n\t\t\t\tif ( useTexStorage && allocateMemory ) {\n\n\t\t\t\t\tstate.texStorage2D( 3553, levels, glInternalFormat, mipmaps[ 0 ].width, mipmaps[ 0 ].height );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\t\tmipmap = mipmaps[ i ];\n\n\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\tstate.texSubImage2D( 3553, 0, 0, 0, mipmap.width, mipmap.height, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tstate.texImage2D( 3553, i, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\ttexture.generateMipmaps = false;\n\n\t\t\t} else {\n\n\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\tif ( allocateMemory ) {\n\n\t\t\t\t\t\tstate.texStorage2D( 3553, levels, glInternalFormat, image.width, image.height );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.texSubImage2D( 3553, 0, 0, 0, image.width, image.height, glFormat, glType, image.data );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tstate.texImage2D( 3553, 0, glInternalFormat, image.width, image.height, 0, glFormat, glType, image.data );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( texture.isCompressedTexture ) {\n\n\t\t\tif ( useTexStorage && allocateMemory ) {\n\n\t\t\t\tstate.texStorage2D( 3553, levels, glInternalFormat, mipmaps[ 0 ].width, mipmaps[ 0 ].height );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\tmipmap = mipmaps[ i ];\n\n\t\t\t\tif ( texture.format !== RGBAFormat ) {\n\n\t\t\t\t\tif ( glFormat !== null ) {\n\n\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\tstate.compressedTexSubImage2D( 3553, i, 0, 0, mipmap.width, mipmap.height, glFormat, mipmap.data );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tstate.compressedTexImage2D( 3553, i, glInternalFormat, mipmap.width, mipmap.height, 0, mipmap.data );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()' );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\tstate.texSubImage2D( 3553, i, 0, 0, mipmap.width, mipmap.height, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tstate.texImage2D( 3553, i, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( texture.isDataTexture2DArray ) {\n\n\t\t\tif ( useTexStorage ) {\n\n\t\t\t\tif ( allocateMemory ) {\n\n\t\t\t\t\tstate.texStorage3D( 35866, levels, glInternalFormat, image.width, image.height, image.depth );\n\n\t\t\t\t}\n\n\t\t\t\tstate.texSubImage3D( 35866, 0, 0, 0, 0, image.width, image.height, image.depth, glFormat, glType, image.data );\n\n\t\t\t} else {\n\n\t\t\t\tstate.texImage3D( 35866, 0, glInternalFormat, image.width, image.height, image.depth, 0, glFormat, glType, image.data );\n\n\t\t\t}\n\n\t\t} else if ( texture.isDataTexture3D ) {\n\n\t\t\tif ( useTexStorage ) {\n\n\t\t\t\tif ( allocateMemory ) {\n\n\t\t\t\t\tstate.texStorage3D( 32879, levels, glInternalFormat, image.width, image.height, image.depth );\n\n\t\t\t\t}\n\n\t\t\t\tstate.texSubImage3D( 32879, 0, 0, 0, 0, image.width, image.height, image.depth, glFormat, glType, image.data );\n\n\t\t\t} else {\n\n\t\t\t\tstate.texImage3D( 32879, 0, glInternalFormat, image.width, image.height, image.depth, 0, glFormat, glType, image.data );\n\n\t\t\t}\n\n\t\t} else if ( texture.isFramebufferTexture ) {\n\n\t\t\tif ( useTexStorage && allocateMemory ) {\n\n\t\t\t\tstate.texStorage2D( 3553, levels, glInternalFormat, image.width, image.height );\n\n\t\t\t} else {\n\n\t\t\t\tstate.texImage2D( 3553, 0, glInternalFormat, image.width, image.height, 0, glFormat, glType, null );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// regular Texture (image, video, canvas)\n\n\t\t\t// use manually created mipmaps if available\n\t\t\t// if there are no manual mipmaps\n\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\n\n\t\t\tif ( mipmaps.length > 0 && supportsMips ) {\n\n\t\t\t\tif ( useTexStorage && allocateMemory ) {\n\n\t\t\t\t\tstate.texStorage2D( 3553, levels, glInternalFormat, mipmaps[ 0 ].width, mipmaps[ 0 ].height );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\t\tmipmap = mipmaps[ i ];\n\n\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\tstate.texSubImage2D( 3553, i, 0, 0, glFormat, glType, mipmap );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tstate.texImage2D( 3553, i, glInternalFormat, glFormat, glType, mipmap );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\ttexture.generateMipmaps = false;\n\n\t\t\t} else {\n\n\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\tif ( allocateMemory ) {\n\n\t\t\t\t\t\tstate.texStorage2D( 3553, levels, glInternalFormat, image.width, image.height );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.texSubImage2D( 3553, 0, 0, 0, glFormat, glType, image );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tstate.texImage2D( 3553, 0, glInternalFormat, glFormat, glType, image );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\tgenerateMipmap( textureType );\n\n\t\t}\n\n\t\ttextureProperties.__version = texture.version;\n\n\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\n\n\t}\n\n\tfunction uploadCubeTexture( textureProperties, texture, slot ) {\n\n\t\tif ( texture.image.length !== 6 ) return;\n\n\t\tinitTexture( textureProperties, texture );\n\n\t\tstate.activeTexture( 33984 + slot );\n\t\tstate.bindTexture( 34067, textureProperties.__webglTexture );\n\n\t\t_gl.pixelStorei( 37440, texture.flipY );\n\t\t_gl.pixelStorei( 37441, texture.premultiplyAlpha );\n\t\t_gl.pixelStorei( 3317, texture.unpackAlignment );\n\t\t_gl.pixelStorei( 37443, 0 );\n\n\t\tconst isCompressed = ( texture && ( texture.isCompressedTexture || texture.image[ 0 ].isCompressedTexture ) );\n\t\tconst isDataTexture = ( texture.image[ 0 ] && texture.image[ 0 ].isDataTexture );\n\n\t\tconst cubeImage = [];\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tif ( ! isCompressed && ! isDataTexture ) {\n\n\t\t\t\tcubeImage[ i ] = resizeImage( texture.image[ i ], false, true, maxCubemapSize );\n\n\t\t\t} else {\n\n\t\t\t\tcubeImage[ i ] = isDataTexture ? texture.image[ i ].image : texture.image[ i ];\n\n\t\t\t}\n\n\t\t\tcubeImage[ i ] = verifyColorSpace( texture, cubeImage[ i ] );\n\n\t\t}\n\n\t\tconst image = cubeImage[ 0 ],\n\t\t\tsupportsMips = isPowerOfTwo$1( image ) || isWebGL2,\n\t\t\tglFormat = utils.convert( texture.format, texture.encoding ),\n\t\t\tglType = utils.convert( texture.type ),\n\t\t\tglInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding );\n\n\t\tconst useTexStorage = ( isWebGL2 && texture.isVideoTexture !== true );\n\t\tconst allocateMemory = ( textureProperties.__version === undefined );\n\t\tlet levels = getMipLevels( texture, image, supportsMips );\n\n\t\tsetTextureParameters( 34067, texture, supportsMips );\n\n\t\tlet mipmaps;\n\n\t\tif ( isCompressed ) {\n\n\t\t\tif ( useTexStorage && allocateMemory ) {\n\n\t\t\t\tstate.texStorage2D( 34067, levels, glInternalFormat, image.width, image.height );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\tmipmaps = cubeImage[ i ].mipmaps;\n\n\t\t\t\tfor ( let j = 0; j < mipmaps.length; j ++ ) {\n\n\t\t\t\t\tconst mipmap = mipmaps[ j ];\n\n\t\t\t\t\tif ( texture.format !== RGBAFormat ) {\n\n\t\t\t\t\t\tif ( glFormat !== null ) {\n\n\t\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\t\tstate.compressedTexSubImage2D( 34069 + i, j, 0, 0, mipmap.width, mipmap.height, glFormat, mipmap.data );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tstate.compressedTexImage2D( 34069 + i, j, glInternalFormat, mipmap.width, mipmap.height, 0, mipmap.data );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\tstate.texSubImage2D( 34069 + i, j, 0, 0, mipmap.width, mipmap.height, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tstate.texImage2D( 34069 + i, j, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tmipmaps = texture.mipmaps;\n\n\t\t\tif ( useTexStorage && allocateMemory ) {\n\n\t\t\t\t// TODO: Uniformly handle mipmap definitions\n\t\t\t\t// Normal textures and compressed cube textures define base level + mips with their mipmap array\n\t\t\t\t// Uncompressed cube textures use their mipmap array only for mips (no base level)\n\n\t\t\t\tif ( mipmaps.length > 0 ) levels ++;\n\n\t\t\t\tstate.texStorage2D( 34067, levels, glInternalFormat, cubeImage[ 0 ].width, cubeImage[ 0 ].height );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\tif ( isDataTexture ) {\n\n\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\tstate.texSubImage2D( 34069 + i, 0, 0, 0, cubeImage[ i ].width, cubeImage[ i ].height, glFormat, glType, cubeImage[ i ].data );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tstate.texImage2D( 34069 + i, 0, glInternalFormat, cubeImage[ i ].width, cubeImage[ i ].height, 0, glFormat, glType, cubeImage[ i ].data );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( let j = 0; j < mipmaps.length; j ++ ) {\n\n\t\t\t\t\t\tconst mipmap = mipmaps[ j ];\n\t\t\t\t\t\tconst mipmapImage = mipmap.image[ i ].image;\n\n\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\tstate.texSubImage2D( 34069 + i, j + 1, 0, 0, mipmapImage.width, mipmapImage.height, glFormat, glType, mipmapImage.data );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tstate.texImage2D( 34069 + i, j + 1, glInternalFormat, mipmapImage.width, mipmapImage.height, 0, glFormat, glType, mipmapImage.data );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\tstate.texSubImage2D( 34069 + i, 0, 0, 0, glFormat, glType, cubeImage[ i ] );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tstate.texImage2D( 34069 + i, 0, glInternalFormat, glFormat, glType, cubeImage[ i ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( let j = 0; j < mipmaps.length; j ++ ) {\n\n\t\t\t\t\t\tconst mipmap = mipmaps[ j ];\n\n\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\tstate.texSubImage2D( 34069 + i, j + 1, 0, 0, glFormat, glType, mipmap.image[ i ] );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tstate.texImage2D( 34069 + i, j + 1, glInternalFormat, glFormat, glType, mipmap.image[ i ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\t// We assume images for cube map have the same size.\n\t\t\tgenerateMipmap( 34067 );\n\n\t\t}\n\n\t\ttextureProperties.__version = texture.version;\n\n\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\n\n\t}\n\n\t// Render targets\n\n\t// Setup storage for target texture and bind it to correct framebuffer\n\tfunction setupFrameBufferTexture( framebuffer, renderTarget, texture, attachment, textureTarget ) {\n\n\t\tconst glFormat = utils.convert( texture.format, texture.encoding );\n\t\tconst glType = utils.convert( texture.type );\n\t\tconst glInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding );\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\n\t\tif ( ! renderTargetProperties.__hasExternalTextures ) {\n\n\t\t\tif ( textureTarget === 32879 || textureTarget === 35866 ) {\n\n\t\t\t\tstate.texImage3D( textureTarget, 0, glInternalFormat, renderTarget.width, renderTarget.height, renderTarget.depth, 0, glFormat, glType, null );\n\n\t\t\t} else {\n\n\t\t\t\tstate.texImage2D( textureTarget, 0, glInternalFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.bindFramebuffer( 36160, framebuffer );\n\t\tif ( renderTarget.useRenderToTexture ) {\n\n\t\t\tMultisampledRenderToTextureExtension.framebufferTexture2DMultisampleEXT( 36160, attachment, textureTarget, properties.get( texture ).__webglTexture, 0, getRenderTargetSamples( renderTarget ) );\n\n\t\t} else {\n\n\t\t\t_gl.framebufferTexture2D( 36160, attachment, textureTarget, properties.get( texture ).__webglTexture, 0 );\n\n\t\t}\n\n\t\tstate.bindFramebuffer( 36160, null );\n\n\t}\n\n\n\t// Setup storage for internal depth/stencil buffers and bind to correct framebuffer\n\tfunction setupRenderBufferStorage( renderbuffer, renderTarget, isMultisample ) {\n\n\t\t_gl.bindRenderbuffer( 36161, renderbuffer );\n\n\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\n\n\t\t\tlet glInternalFormat = 33189;\n\n\t\t\tif ( isMultisample || renderTarget.useRenderToTexture ) {\n\n\t\t\t\tconst depthTexture = renderTarget.depthTexture;\n\n\t\t\t\tif ( depthTexture && depthTexture.isDepthTexture ) {\n\n\t\t\t\t\tif ( depthTexture.type === FloatType ) {\n\n\t\t\t\t\t\tglInternalFormat = 36012;\n\n\t\t\t\t\t} else if ( depthTexture.type === UnsignedIntType ) {\n\n\t\t\t\t\t\tglInternalFormat = 33190;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tconst samples = getRenderTargetSamples( renderTarget );\n\n\t\t\t\tif ( renderTarget.useRenderToTexture ) {\n\n\t\t\t\t\tMultisampledRenderToTextureExtension.renderbufferStorageMultisampleEXT( 36161, samples, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_gl.renderbufferStorageMultisample( 36161, samples, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t_gl.renderbufferStorage( 36161, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t}\n\n\t\t\t_gl.framebufferRenderbuffer( 36160, 36096, 36161, renderbuffer );\n\n\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\n\n\t\t\tconst samples = getRenderTargetSamples( renderTarget );\n\n\t\t\tif ( isMultisample && renderTarget.useRenderbuffer ) {\n\n\t\t\t\t_gl.renderbufferStorageMultisample( 36161, samples, 35056, renderTarget.width, renderTarget.height );\n\n\t\t\t} else if ( renderTarget.useRenderToTexture ) {\n\n\t\t\t\tMultisampledRenderToTextureExtension.renderbufferStorageMultisampleEXT( 36161, samples, 35056, renderTarget.width, renderTarget.height );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.renderbufferStorage( 36161, 34041, renderTarget.width, renderTarget.height );\n\n\t\t\t}\n\n\n\t\t\t_gl.framebufferRenderbuffer( 36160, 33306, 36161, renderbuffer );\n\n\t\t} else {\n\n\t\t\t// Use the first texture for MRT so far\n\t\t\tconst texture = renderTarget.isWebGLMultipleRenderTargets === true ? renderTarget.texture[ 0 ] : renderTarget.texture;\n\n\t\t\tconst glFormat = utils.convert( texture.format, texture.encoding );\n\t\t\tconst glType = utils.convert( texture.type );\n\t\t\tconst glInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding );\n\t\t\tconst samples = getRenderTargetSamples( renderTarget );\n\n\t\t\tif ( isMultisample && renderTarget.useRenderbuffer ) {\n\n\t\t\t\t_gl.renderbufferStorageMultisample( 36161, samples, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t} else if ( renderTarget.useRenderToTexture ) {\n\n\t\t\t\tMultisampledRenderToTextureExtension.renderbufferStorageMultisampleEXT( 36161, samples, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.renderbufferStorage( 36161, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t}\n\n\t\t}\n\n\t\t_gl.bindRenderbuffer( 36161, null );\n\n\t}\n\n\t// Setup resources for a Depth Texture for a FBO (needs an extension)\n\tfunction setupDepthTexture( framebuffer, renderTarget ) {\n\n\t\tconst isCube = ( renderTarget && renderTarget.isWebGLCubeRenderTarget );\n\t\tif ( isCube ) throw new Error( 'Depth Texture with cube render targets is not supported' );\n\n\t\tstate.bindFramebuffer( 36160, framebuffer );\n\n\t\tif ( ! ( renderTarget.depthTexture && renderTarget.depthTexture.isDepthTexture ) ) {\n\n\t\t\tthrow new Error( 'renderTarget.depthTexture must be an instance of THREE.DepthTexture' );\n\n\t\t}\n\n\t\t// upload an empty depth texture with framebuffer size\n\t\tif ( ! properties.get( renderTarget.depthTexture ).__webglTexture ||\n\t\t\t\trenderTarget.depthTexture.image.width !== renderTarget.width ||\n\t\t\t\trenderTarget.depthTexture.image.height !== renderTarget.height ) {\n\n\t\t\trenderTarget.depthTexture.image.width = renderTarget.width;\n\t\t\trenderTarget.depthTexture.image.height = renderTarget.height;\n\t\t\trenderTarget.depthTexture.needsUpdate = true;\n\n\t\t}\n\n\t\tsetTexture2D( renderTarget.depthTexture, 0 );\n\n\t\tconst webglDepthTexture = properties.get( renderTarget.depthTexture ).__webglTexture;\n\t\tconst samples = getRenderTargetSamples( renderTarget );\n\n\t\tif ( renderTarget.depthTexture.format === DepthFormat ) {\n\n\t\t\tif ( renderTarget.useRenderToTexture ) {\n\n\t\t\t\tMultisampledRenderToTextureExtension.framebufferTexture2DMultisampleEXT( 36160, 36096, 3553, webglDepthTexture, 0, samples );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.framebufferTexture2D( 36160, 36096, 3553, webglDepthTexture, 0 );\n\n\t\t\t}\n\n\t\t} else if ( renderTarget.depthTexture.format === DepthStencilFormat ) {\n\n\t\t\tif ( renderTarget.useRenderToTexture ) {\n\n\t\t\t\tMultisampledRenderToTextureExtension.framebufferTexture2DMultisampleEXT( 36160, 33306, 3553, webglDepthTexture, 0, samples );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.framebufferTexture2D( 36160, 33306, 3553, webglDepthTexture, 0 );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'Unknown depthTexture format' );\n\n\t\t}\n\n\t}\n\n\t// Setup GL resources for a non-texture depth buffer\n\tfunction setupDepthRenderbuffer( renderTarget ) {\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\t\tconst isCube = ( renderTarget.isWebGLCubeRenderTarget === true );\n\n\t\tif ( renderTarget.depthTexture && ! renderTargetProperties.__autoAllocateDepthBuffer ) {\n\n\t\t\tif ( isCube ) throw new Error( 'target.depthTexture not supported in Cube render targets' );\n\n\t\t\tsetupDepthTexture( renderTargetProperties.__webglFramebuffer, renderTarget );\n\n\t\t} else {\n\n\t\t\tif ( isCube ) {\n\n\t\t\t\trenderTargetProperties.__webglDepthbuffer = [];\n\n\t\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\t\tstate.bindFramebuffer( 36160, renderTargetProperties.__webglFramebuffer[ i ] );\n\t\t\t\t\trenderTargetProperties.__webglDepthbuffer[ i ] = _gl.createRenderbuffer();\n\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer[ i ], renderTarget, false );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tstate.bindFramebuffer( 36160, renderTargetProperties.__webglFramebuffer );\n\t\t\t\trenderTargetProperties.__webglDepthbuffer = _gl.createRenderbuffer();\n\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer, renderTarget, false );\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.bindFramebuffer( 36160, null );\n\n\t}\n\n\t// rebind framebuffer with external textures\n\tfunction rebindTextures( renderTarget, colorTexture, depthTexture ) {\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\n\t\tif ( colorTexture !== undefined ) {\n\n\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer, renderTarget, renderTarget.texture, 36064, 3553 );\n\n\t\t}\n\n\t\tif ( depthTexture !== undefined ) {\n\n\t\t\tsetupDepthRenderbuffer( renderTarget );\n\n\t\t}\n\n\t}\n\n\t// Set up GL resources for the render target\n\tfunction setupRenderTarget( renderTarget ) {\n\n\t\tconst texture = renderTarget.texture;\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\t\tconst textureProperties = properties.get( texture );\n\n\t\trenderTarget.addEventListener( 'dispose', onRenderTargetDispose );\n\n\t\tif ( renderTarget.isWebGLMultipleRenderTargets !== true ) {\n\n\t\t\tif ( textureProperties.__webglTexture === undefined ) {\n\n\t\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\n\n\t\t\t}\n\n\t\t\ttextureProperties.__version = texture.version;\n\t\t\tinfo.memory.textures ++;\n\n\t\t}\n\n\t\tconst isCube = ( renderTarget.isWebGLCubeRenderTarget === true );\n\t\tconst isMultipleRenderTargets = ( renderTarget.isWebGLMultipleRenderTargets === true );\n\t\tconst isRenderTarget3D = texture.isDataTexture3D || texture.isDataTexture2DArray;\n\t\tconst supportsMips = isPowerOfTwo$1( renderTarget ) || isWebGL2;\n\n\t\t// Setup framebuffer\n\n\t\tif ( isCube ) {\n\n\t\t\trenderTargetProperties.__webglFramebuffer = [];\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\trenderTargetProperties.__webglFramebuffer[ i ] = _gl.createFramebuffer();\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\trenderTargetProperties.__webglFramebuffer = _gl.createFramebuffer();\n\n\t\t\tif ( isMultipleRenderTargets ) {\n\n\t\t\t\tif ( capabilities.drawBuffers ) {\n\n\t\t\t\t\tconst textures = renderTarget.texture;\n\n\t\t\t\t\tfor ( let i = 0, il = textures.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst attachmentProperties = properties.get( textures[ i ] );\n\n\t\t\t\t\t\tif ( attachmentProperties.__webglTexture === undefined ) {\n\n\t\t\t\t\t\t\tattachmentProperties.__webglTexture = _gl.createTexture();\n\n\t\t\t\t\t\t\tinfo.memory.textures ++;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.' );\n\n\t\t\t\t}\n\n\t\t\t} else if ( renderTarget.useRenderbuffer ) {\n\n\t\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\t\trenderTargetProperties.__webglMultisampledFramebuffer = _gl.createFramebuffer();\n\t\t\t\t\trenderTargetProperties.__webglColorRenderbuffer = _gl.createRenderbuffer();\n\n\t\t\t\t\t_gl.bindRenderbuffer( 36161, renderTargetProperties.__webglColorRenderbuffer );\n\n\t\t\t\t\tconst glFormat = utils.convert( texture.format, texture.encoding );\n\t\t\t\t\tconst glType = utils.convert( texture.type );\n\t\t\t\t\tconst glInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding );\n\t\t\t\t\tconst samples = getRenderTargetSamples( renderTarget );\n\t\t\t\t\t_gl.renderbufferStorageMultisample( 36161, samples, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t\t\tstate.bindFramebuffer( 36160, renderTargetProperties.__webglMultisampledFramebuffer );\n\t\t\t\t\t_gl.framebufferRenderbuffer( 36160, 36064, 36161, renderTargetProperties.__webglColorRenderbuffer );\n\t\t\t\t\t_gl.bindRenderbuffer( 36161, null );\n\n\t\t\t\t\tif ( renderTarget.depthBuffer ) {\n\n\t\t\t\t\t\trenderTargetProperties.__webglDepthRenderbuffer = _gl.createRenderbuffer();\n\t\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthRenderbuffer, renderTarget, true );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.bindFramebuffer( 36160, null );\n\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Setup color buffer\n\n\t\tif ( isCube ) {\n\n\t\t\tstate.bindTexture( 34067, textureProperties.__webglTexture );\n\t\t\tsetTextureParameters( 34067, texture, supportsMips );\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer[ i ], renderTarget, texture, 36064, 34069 + i );\n\n\t\t\t}\n\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\t\tgenerateMipmap( 34067 );\n\n\t\t\t}\n\n\t\t\tstate.unbindTexture();\n\n\t\t} else if ( isMultipleRenderTargets ) {\n\n\t\t\tconst textures = renderTarget.texture;\n\n\t\t\tfor ( let i = 0, il = textures.length; i < il; i ++ ) {\n\n\t\t\t\tconst attachment = textures[ i ];\n\t\t\t\tconst attachmentProperties = properties.get( attachment );\n\n\t\t\t\tstate.bindTexture( 3553, attachmentProperties.__webglTexture );\n\t\t\t\tsetTextureParameters( 3553, attachment, supportsMips );\n\t\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer, renderTarget, attachment, 36064 + i, 3553 );\n\n\t\t\t\tif ( textureNeedsGenerateMipmaps( attachment, supportsMips ) ) {\n\n\t\t\t\t\tgenerateMipmap( 3553 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tstate.unbindTexture();\n\n\t\t} else {\n\n\t\t\tlet glTextureType = 3553;\n\n\t\t\tif ( isRenderTarget3D ) {\n\n\t\t\t\t// Render targets containing layers, i.e: Texture 3D and 2d arrays\n\n\t\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\t\tconst isTexture3D = texture.isDataTexture3D;\n\t\t\t\t\tglTextureType = isTexture3D ? 32879 : 35866;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tstate.bindTexture( glTextureType, textureProperties.__webglTexture );\n\t\t\tsetTextureParameters( glTextureType, texture, supportsMips );\n\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer, renderTarget, texture, 36064, glTextureType );\n\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\t\tgenerateMipmap( glTextureType );\n\n\t\t\t}\n\n\t\t\tstate.unbindTexture();\n\n\t\t}\n\n\t\t// Setup depth and stencil buffers\n\n\t\tif ( renderTarget.depthBuffer ) {\n\n\t\t\tsetupDepthRenderbuffer( renderTarget );\n\n\t\t}\n\n\t}\n\n\tfunction updateRenderTargetMipmap( renderTarget ) {\n\n\t\tconst supportsMips = isPowerOfTwo$1( renderTarget ) || isWebGL2;\n\n\t\tconst textures = renderTarget.isWebGLMultipleRenderTargets === true ? renderTarget.texture : [ renderTarget.texture ];\n\n\t\tfor ( let i = 0, il = textures.length; i < il; i ++ ) {\n\n\t\t\tconst texture = textures[ i ];\n\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\t\tconst target = renderTarget.isWebGLCubeRenderTarget ? 34067 : 3553;\n\t\t\t\tconst webglTexture = properties.get( texture ).__webglTexture;\n\n\t\t\t\tstate.bindTexture( target, webglTexture );\n\t\t\t\tgenerateMipmap( target );\n\t\t\t\tstate.unbindTexture();\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction updateMultisampleRenderTarget( renderTarget ) {\n\n\t\tif ( renderTarget.useRenderbuffer ) {\n\n\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\tconst width = renderTarget.width;\n\t\t\t\tconst height = renderTarget.height;\n\t\t\t\tlet mask = 16384;\n\t\t\t\tconst invalidationArray = [ 36064 ];\n\t\t\t\tconst depthStyle = renderTarget.stencilBuffer ? 33306 : 36096;\n\n\t\t\t\tif ( renderTarget.depthBuffer ) {\n\n\t\t\t\t\tinvalidationArray.push( depthStyle );\n\n\t\t\t\t}\n\n\t\t\t\tif ( ! renderTarget.ignoreDepthForMultisampleCopy ) {\n\n\t\t\t\t\tif ( renderTarget.depthBuffer ) mask |= 256;\n\t\t\t\t\tif ( renderTarget.stencilBuffer ) mask |= 1024;\n\n\t\t\t\t}\n\n\t\t\t\tconst renderTargetProperties = properties.get( renderTarget );\n\n\t\t\t\tstate.bindFramebuffer( 36008, renderTargetProperties.__webglMultisampledFramebuffer );\n\t\t\t\tstate.bindFramebuffer( 36009, renderTargetProperties.__webglFramebuffer );\n\n\t\t\t\tif ( renderTarget.ignoreDepthForMultisampleCopy ) {\n\n\t\t\t\t\t_gl.invalidateFramebuffer( 36008, [ depthStyle ] );\n\t\t\t\t\t_gl.invalidateFramebuffer( 36009, [ depthStyle ] );\n\n\t\t\t\t}\n\n\t\t\t\t_gl.blitFramebuffer( 0, 0, width, height, 0, 0, width, height, mask, 9728 );\n\t\t\t\t_gl.invalidateFramebuffer( 36008, invalidationArray );\n\n\t\t\t\tstate.bindFramebuffer( 36008, null );\n\t\t\t\tstate.bindFramebuffer( 36009, renderTargetProperties.__webglMultisampledFramebuffer );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction getRenderTargetSamples( renderTarget ) {\n\n\t\treturn ( isWebGL2 && ( renderTarget.useRenderbuffer || renderTarget.useRenderToTexture ) ) ?\n\t\t\tMath.min( maxSamples, renderTarget.samples ) : 0;\n\n\t}\n\n\tfunction updateVideoTexture( texture ) {\n\n\t\tconst frame = info.render.frame;\n\n\t\t// Check the last frame we updated the VideoTexture\n\n\t\tif ( _videoTextures.get( texture ) !== frame ) {\n\n\t\t\t_videoTextures.set( texture, frame );\n\t\t\ttexture.update();\n\n\t\t}\n\n\t}\n\n\tfunction verifyColorSpace( texture, image ) {\n\n\t\tconst encoding = texture.encoding;\n\t\tconst format = texture.format;\n\t\tconst type = texture.type;\n\n\t\tif ( texture.isCompressedTexture === true || texture.isVideoTexture === true || texture.format === _SRGBAFormat ) return image;\n\n\t\tif ( encoding !== LinearEncoding ) {\n\n\t\t\t// sRGB\n\n\t\t\tif ( encoding === sRGBEncoding ) {\n\n\t\t\t\tif ( isWebGL2 === false ) {\n\n\t\t\t\t\t// in WebGL 1, try to use EXT_sRGB extension and unsized formats\n\n\t\t\t\t\tif ( extensions.has( 'EXT_sRGB' ) === true && format === RGBAFormat ) {\n\n\t\t\t\t\t\ttexture.format = _SRGBAFormat;\n\n\t\t\t\t\t\t// it's not possible to generate mips in WebGL 1 with this extension\n\n\t\t\t\t\t\ttexture.minFilter = LinearFilter;\n\t\t\t\t\t\ttexture.generateMipmaps = false;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// slow fallback (CPU decode)\n\n\t\t\t\t\t\timage = ImageUtils.sRGBToLinear( image );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// in WebGL 2 uncompressed textures can only be sRGB encoded if they have the RGBA8 format\n\n\t\t\t\t\tif ( format !== RGBAFormat || type !== UnsignedByteType ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.WebGLTextures: Unsupported texture encoding:', encoding );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn image;\n\n\t}\n\n\t// backwards compatibility\n\n\tlet warnedTexture2D = false;\n\tlet warnedTextureCube = false;\n\n\tfunction safeSetTexture2D( texture, slot ) {\n\n\t\tif ( texture && texture.isWebGLRenderTarget ) {\n\n\t\t\tif ( warnedTexture2D === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLTextures.safeSetTexture2D: don\\'t use render targets as textures. Use their .texture property instead.' );\n\t\t\t\twarnedTexture2D = true;\n\n\t\t\t}\n\n\t\t\ttexture = texture.texture;\n\n\t\t}\n\n\t\tsetTexture2D( texture, slot );\n\n\t}\n\n\tfunction safeSetTextureCube( texture, slot ) {\n\n\t\tif ( texture && texture.isWebGLCubeRenderTarget ) {\n\n\t\t\tif ( warnedTextureCube === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLTextures.safeSetTextureCube: don\\'t use cube render targets as textures. Use their .texture property instead.' );\n\t\t\t\twarnedTextureCube = true;\n\n\t\t\t}\n\n\t\t\ttexture = texture.texture;\n\n\t\t}\n\n\n\t\tsetTextureCube( texture, slot );\n\n\t}\n\n\t//\n\n\tthis.allocateTextureUnit = allocateTextureUnit;\n\tthis.resetTextureUnits = resetTextureUnits;\n\n\tthis.setTexture2D = setTexture2D;\n\tthis.setTexture2DArray = setTexture2DArray;\n\tthis.setTexture3D = setTexture3D;\n\tthis.setTextureCube = setTextureCube;\n\tthis.rebindTextures = rebindTextures;\n\tthis.setupRenderTarget = setupRenderTarget;\n\tthis.updateRenderTargetMipmap = updateRenderTargetMipmap;\n\tthis.updateMultisampleRenderTarget = updateMultisampleRenderTarget;\n\tthis.setupDepthRenderbuffer = setupDepthRenderbuffer;\n\tthis.setupFrameBufferTexture = setupFrameBufferTexture;\n\n\tthis.safeSetTexture2D = safeSetTexture2D;\n\tthis.safeSetTextureCube = safeSetTextureCube;\n\n}\n\nfunction WebGLUtils( gl, extensions, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tfunction convert( p, encoding = null ) {\n\n\t\tlet extension;\n\n\t\tif ( p === UnsignedByteType ) return 5121;\n\t\tif ( p === UnsignedShort4444Type ) return 32819;\n\t\tif ( p === UnsignedShort5551Type ) return 32820;\n\n\t\tif ( p === ByteType ) return 5120;\n\t\tif ( p === ShortType ) return 5122;\n\t\tif ( p === UnsignedShortType ) return 5123;\n\t\tif ( p === IntType ) return 5124;\n\t\tif ( p === UnsignedIntType ) return 5125;\n\t\tif ( p === FloatType ) return 5126;\n\n\t\tif ( p === HalfFloatType ) {\n\n\t\t\tif ( isWebGL2 ) return 5131;\n\n\t\t\textension = extensions.get( 'OES_texture_half_float' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\treturn extension.HALF_FLOAT_OES;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( p === AlphaFormat ) return 6406;\n\t\tif ( p === RGBAFormat ) return 6408;\n\t\tif ( p === LuminanceFormat ) return 6409;\n\t\tif ( p === LuminanceAlphaFormat ) return 6410;\n\t\tif ( p === DepthFormat ) return 6402;\n\t\tif ( p === DepthStencilFormat ) return 34041;\n\t\tif ( p === RedFormat ) return 6403;\n\n\t\tif ( p === RGBFormat ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228' );\n\t\t\treturn 6408;\n\n\t\t}\n\n\t\t// WebGL 1 sRGB fallback\n\n\t\tif ( p === _SRGBAFormat ) {\n\n\t\t\textension = extensions.get( 'EXT_sRGB' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\treturn extension.SRGB_ALPHA_EXT;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// WebGL2 formats.\n\n\t\tif ( p === RedIntegerFormat ) return 36244;\n\t\tif ( p === RGFormat ) return 33319;\n\t\tif ( p === RGIntegerFormat ) return 33320;\n\t\tif ( p === RGBAIntegerFormat ) return 36249;\n\n\t\t// S3TC\n\n\t\tif ( p === RGB_S3TC_DXT1_Format || p === RGBA_S3TC_DXT1_Format || p === RGBA_S3TC_DXT3_Format || p === RGBA_S3TC_DXT5_Format ) {\n\n\t\t\tif ( encoding === sRGBEncoding ) {\n\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc_srgb' );\n\n\t\t\t\tif ( extension !== null ) {\n\n\t\t\t\t\tif ( p === RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_SRGB_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc' );\n\n\t\t\t\tif ( extension !== null ) {\n\n\t\t\t\t\tif ( p === RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// PVRTC\n\n\t\tif ( p === RGB_PVRTC_4BPPV1_Format || p === RGB_PVRTC_2BPPV1_Format || p === RGBA_PVRTC_4BPPV1_Format || p === RGBA_PVRTC_2BPPV1_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_pvrtc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGB_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\n\t\t\t\tif ( p === RGB_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\n\t\t\t\tif ( p === RGBA_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\n\t\t\t\tif ( p === RGBA_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// ETC1\n\n\t\tif ( p === RGB_ETC1_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_etc1' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\treturn extension.COMPRESSED_RGB_ETC1_WEBGL;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// ETC2\n\n\t\tif ( p === RGB_ETC2_Format || p === RGBA_ETC2_EAC_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_etc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGB_ETC2_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ETC2 : extension.COMPRESSED_RGB8_ETC2;\n\t\t\t\tif ( p === RGBA_ETC2_EAC_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC : extension.COMPRESSED_RGBA8_ETC2_EAC;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// ASTC\n\n\t\tif ( p === RGBA_ASTC_4x4_Format || p === RGBA_ASTC_5x4_Format || p === RGBA_ASTC_5x5_Format ||\n\t\t\tp === RGBA_ASTC_6x5_Format || p === RGBA_ASTC_6x6_Format || p === RGBA_ASTC_8x5_Format ||\n\t\t\tp === RGBA_ASTC_8x6_Format || p === RGBA_ASTC_8x8_Format || p === RGBA_ASTC_10x5_Format ||\n\t\t\tp === RGBA_ASTC_10x6_Format || p === RGBA_ASTC_10x8_Format || p === RGBA_ASTC_10x10_Format ||\n\t\t\tp === RGBA_ASTC_12x10_Format || p === RGBA_ASTC_12x12_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_astc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGBA_ASTC_4x4_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR : extension.COMPRESSED_RGBA_ASTC_4x4_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_5x4_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR : extension.COMPRESSED_RGBA_ASTC_5x4_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_5x5_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR : extension.COMPRESSED_RGBA_ASTC_5x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_6x5_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR : extension.COMPRESSED_RGBA_ASTC_6x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_6x6_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR : extension.COMPRESSED_RGBA_ASTC_6x6_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_8x5_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR : extension.COMPRESSED_RGBA_ASTC_8x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_8x6_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR : extension.COMPRESSED_RGBA_ASTC_8x6_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_8x8_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR : extension.COMPRESSED_RGBA_ASTC_8x8_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x5_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR : extension.COMPRESSED_RGBA_ASTC_10x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x6_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR : extension.COMPRESSED_RGBA_ASTC_10x6_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x8_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR : extension.COMPRESSED_RGBA_ASTC_10x8_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x10_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR : extension.COMPRESSED_RGBA_ASTC_10x10_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_12x10_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR : extension.COMPRESSED_RGBA_ASTC_12x10_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_12x12_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR : extension.COMPRESSED_RGBA_ASTC_12x12_KHR;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// BPTC\n\n\t\tif ( p === RGBA_BPTC_Format ) {\n\n\t\t\textension = extensions.get( 'EXT_texture_compression_bptc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGBA_BPTC_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT : extension.COMPRESSED_RGBA_BPTC_UNORM_EXT;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( p === UnsignedInt248Type ) {\n\n\t\t\tif ( isWebGL2 ) return 34042;\n\n\t\t\textension = extensions.get( 'WEBGL_depth_texture' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\treturn extension.UNSIGNED_INT_24_8_WEBGL;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn { convert: convert };\n\n}\n\nclass ArrayCamera extends PerspectiveCamera {\n\n\tconstructor( array = [] ) {\n\n\t\tsuper();\n\n\t\tthis.cameras = array;\n\n\t}\n\n}\n\nArrayCamera.prototype.isArrayCamera = true;\n\nclass Group extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'Group';\n\n\t}\n\n}\n\nGroup.prototype.isGroup = true;\n\nconst _moveEvent = { type: 'move' };\n\nclass WebXRController {\n\n\tconstructor() {\n\n\t\tthis._targetRay = null;\n\t\tthis._grip = null;\n\t\tthis._hand = null;\n\n\t}\n\n\tgetHandSpace() {\n\n\t\tif ( this._hand === null ) {\n\n\t\t\tthis._hand = new Group();\n\t\t\tthis._hand.matrixAutoUpdate = false;\n\t\t\tthis._hand.visible = false;\n\n\t\t\tthis._hand.joints = {};\n\t\t\tthis._hand.inputState = { pinching: false };\n\n\t\t}\n\n\t\treturn this._hand;\n\n\t}\n\n\tgetTargetRaySpace() {\n\n\t\tif ( this._targetRay === null ) {\n\n\t\t\tthis._targetRay = new Group();\n\t\t\tthis._targetRay.matrixAutoUpdate = false;\n\t\t\tthis._targetRay.visible = false;\n\t\t\tthis._targetRay.hasLinearVelocity = false;\n\t\t\tthis._targetRay.linearVelocity = new Vector3();\n\t\t\tthis._targetRay.hasAngularVelocity = false;\n\t\t\tthis._targetRay.angularVelocity = new Vector3();\n\n\t\t}\n\n\t\treturn this._targetRay;\n\n\t}\n\n\tgetGripSpace() {\n\n\t\tif ( this._grip === null ) {\n\n\t\t\tthis._grip = new Group();\n\t\t\tthis._grip.matrixAutoUpdate = false;\n\t\t\tthis._grip.visible = false;\n\t\t\tthis._grip.hasLinearVelocity = false;\n\t\t\tthis._grip.linearVelocity = new Vector3();\n\t\t\tthis._grip.hasAngularVelocity = false;\n\t\t\tthis._grip.angularVelocity = new Vector3();\n\n\t\t}\n\n\t\treturn this._grip;\n\n\t}\n\n\tdispatchEvent( event ) {\n\n\t\tif ( this._targetRay !== null ) {\n\n\t\t\tthis._targetRay.dispatchEvent( event );\n\n\t\t}\n\n\t\tif ( this._grip !== null ) {\n\n\t\t\tthis._grip.dispatchEvent( event );\n\n\t\t}\n\n\t\tif ( this._hand !== null ) {\n\n\t\t\tthis._hand.dispatchEvent( event );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tdisconnect( inputSource ) {\n\n\t\tthis.dispatchEvent( { type: 'disconnected', data: inputSource } );\n\n\t\tif ( this._targetRay !== null ) {\n\n\t\t\tthis._targetRay.visible = false;\n\n\t\t}\n\n\t\tif ( this._grip !== null ) {\n\n\t\t\tthis._grip.visible = false;\n\n\t\t}\n\n\t\tif ( this._hand !== null ) {\n\n\t\t\tthis._hand.visible = false;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tupdate( inputSource, frame, referenceSpace ) {\n\n\t\tlet inputPose = null;\n\t\tlet gripPose = null;\n\t\tlet handPose = null;\n\n\t\tconst targetRay = this._targetRay;\n\t\tconst grip = this._grip;\n\t\tconst hand = this._hand;\n\n\t\tif ( inputSource && frame.session.visibilityState !== 'visible-blurred' ) {\n\n\t\t\tif ( targetRay !== null ) {\n\n\t\t\t\tinputPose = frame.getPose( inputSource.targetRaySpace, referenceSpace );\n\n\t\t\t\tif ( inputPose !== null ) {\n\n\t\t\t\t\ttargetRay.matrix.fromArray( inputPose.transform.matrix );\n\t\t\t\t\ttargetRay.matrix.decompose( targetRay.position, targetRay.rotation, targetRay.scale );\n\n\t\t\t\t\tif ( inputPose.linearVelocity ) {\n\n\t\t\t\t\t\ttargetRay.hasLinearVelocity = true;\n\t\t\t\t\t\ttargetRay.linearVelocity.copy( inputPose.linearVelocity );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttargetRay.hasLinearVelocity = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( inputPose.angularVelocity ) {\n\n\t\t\t\t\t\ttargetRay.hasAngularVelocity = true;\n\t\t\t\t\t\ttargetRay.angularVelocity.copy( inputPose.angularVelocity );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttargetRay.hasAngularVelocity = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.dispatchEvent( _moveEvent );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( hand && inputSource.hand ) {\n\n\t\t\t\thandPose = true;\n\n\t\t\t\tfor ( const inputjoint of inputSource.hand.values() ) {\n\n\t\t\t\t\t// Update the joints groups with the XRJoint poses\n\t\t\t\t\tconst jointPose = frame.getJointPose( inputjoint, referenceSpace );\n\n\t\t\t\t\tif ( hand.joints[ inputjoint.jointName ] === undefined ) {\n\n\t\t\t\t\t\t// The transform of this joint will be updated with the joint pose on each frame\n\t\t\t\t\t\tconst joint = new Group();\n\t\t\t\t\t\tjoint.matrixAutoUpdate = false;\n\t\t\t\t\t\tjoint.visible = false;\n\t\t\t\t\t\thand.joints[ inputjoint.jointName ] = joint;\n\t\t\t\t\t\t// ??\n\t\t\t\t\t\thand.add( joint );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst joint = hand.joints[ inputjoint.jointName ];\n\n\t\t\t\t\tif ( jointPose !== null ) {\n\n\t\t\t\t\t\tjoint.matrix.fromArray( jointPose.transform.matrix );\n\t\t\t\t\t\tjoint.matrix.decompose( joint.position, joint.rotation, joint.scale );\n\t\t\t\t\t\tjoint.jointRadius = jointPose.radius;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tjoint.visible = jointPose !== null;\n\n\t\t\t\t}\n\n\t\t\t\t// Custom events\n\n\t\t\t\t// Check pinchz\n\t\t\t\tconst indexTip = hand.joints[ 'index-finger-tip' ];\n\t\t\t\tconst thumbTip = hand.joints[ 'thumb-tip' ];\n\t\t\t\tconst distance = indexTip.position.distanceTo( thumbTip.position );\n\n\t\t\t\tconst distanceToPinch = 0.02;\n\t\t\t\tconst threshold = 0.005;\n\n\t\t\t\tif ( hand.inputState.pinching && distance > distanceToPinch + threshold ) {\n\n\t\t\t\t\thand.inputState.pinching = false;\n\t\t\t\t\tthis.dispatchEvent( {\n\t\t\t\t\t\ttype: 'pinchend',\n\t\t\t\t\t\thandedness: inputSource.handedness,\n\t\t\t\t\t\ttarget: this\n\t\t\t\t\t} );\n\n\t\t\t\t} else if ( ! hand.inputState.pinching && distance <= distanceToPinch - threshold ) {\n\n\t\t\t\t\thand.inputState.pinching = true;\n\t\t\t\t\tthis.dispatchEvent( {\n\t\t\t\t\t\ttype: 'pinchstart',\n\t\t\t\t\t\thandedness: inputSource.handedness,\n\t\t\t\t\t\ttarget: this\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( grip !== null && inputSource.gripSpace ) {\n\n\t\t\t\t\tgripPose = frame.getPose( inputSource.gripSpace, referenceSpace );\n\n\t\t\t\t\tif ( gripPose !== null ) {\n\n\t\t\t\t\t\tgrip.matrix.fromArray( gripPose.transform.matrix );\n\t\t\t\t\t\tgrip.matrix.decompose( grip.position, grip.rotation, grip.scale );\n\n\t\t\t\t\t\tif ( gripPose.linearVelocity ) {\n\n\t\t\t\t\t\t\tgrip.hasLinearVelocity = true;\n\t\t\t\t\t\t\tgrip.linearVelocity.copy( gripPose.linearVelocity );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tgrip.hasLinearVelocity = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( gripPose.angularVelocity ) {\n\n\t\t\t\t\t\t\tgrip.hasAngularVelocity = true;\n\t\t\t\t\t\t\tgrip.angularVelocity.copy( gripPose.angularVelocity );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tgrip.hasAngularVelocity = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( targetRay !== null ) {\n\n\t\t\ttargetRay.visible = ( inputPose !== null );\n\n\t\t}\n\n\t\tif ( grip !== null ) {\n\n\t\t\tgrip.visible = ( gripPose !== null );\n\n\t\t}\n\n\t\tif ( hand !== null ) {\n\n\t\t\thand.visible = ( handPose !== null );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass DepthTexture extends Texture {\n\n\tconstructor( width, height, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, format ) {\n\n\t\tformat = format !== undefined ? format : DepthFormat;\n\n\t\tif ( format !== DepthFormat && format !== DepthStencilFormat ) {\n\n\t\t\tthrow new Error( 'DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat' );\n\n\t\t}\n\n\t\tif ( type === undefined && format === DepthFormat ) type = UnsignedShortType;\n\t\tif ( type === undefined && format === DepthStencilFormat ) type = UnsignedInt248Type;\n\n\t\tsuper( null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.image = { width: width, height: height };\n\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : NearestFilter;\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : NearestFilter;\n\n\t\tthis.flipY = false;\n\t\tthis.generateMipmaps\t= false;\n\n\t}\n\n\n}\n\nDepthTexture.prototype.isDepthTexture = true;\n\nclass WebXRManager extends EventDispatcher {\n\n\tconstructor( renderer, gl ) {\n\n\t\tsuper();\n\n\t\tconst scope = this;\n\n\t\tlet session = null;\n\t\tlet framebufferScaleFactor = 1.0;\n\n\t\tlet referenceSpace = null;\n\t\tlet referenceSpaceType = 'local-floor';\n\t\tconst hasMultisampledRenderToTexture = renderer.extensions.has( 'WEBGL_multisampled_render_to_texture' );\n\n\t\tlet pose = null;\n\t\tlet glBinding = null;\n\t\tlet glProjLayer = null;\n\t\tlet glBaseLayer = null;\n\t\tlet isMultisample = false;\n\t\tlet xrFrame = null;\n\t\tconst attributes = gl.getContextAttributes();\n\t\tlet initialRenderTarget = null;\n\t\tlet newRenderTarget = null;\n\n\t\tconst controllers = [];\n\t\tconst inputSourcesMap = new Map();\n\n\t\t//\n\n\t\tconst cameraL = new PerspectiveCamera();\n\t\tcameraL.layers.enable( 1 );\n\t\tcameraL.viewport = new Vector4();\n\n\t\tconst cameraR = new PerspectiveCamera();\n\t\tcameraR.layers.enable( 2 );\n\t\tcameraR.viewport = new Vector4();\n\n\t\tconst cameras = [ cameraL, cameraR ];\n\n\t\tconst cameraVR = new ArrayCamera();\n\t\tcameraVR.layers.enable( 1 );\n\t\tcameraVR.layers.enable( 2 );\n\n\t\tlet _currentDepthNear = null;\n\t\tlet _currentDepthFar = null;\n\n\t\t//\n\n\t\tthis.cameraAutoUpdate = true;\n\t\tthis.enabled = false;\n\n\t\tthis.isPresenting = false;\n\n\t\tthis.getController = function ( index ) {\n\n\t\t\tlet controller = controllers[ index ];\n\n\t\t\tif ( controller === undefined ) {\n\n\t\t\t\tcontroller = new WebXRController();\n\t\t\t\tcontrollers[ index ] = controller;\n\n\t\t\t}\n\n\t\t\treturn controller.getTargetRaySpace();\n\n\t\t};\n\n\t\tthis.getControllerGrip = function ( index ) {\n\n\t\t\tlet controller = controllers[ index ];\n\n\t\t\tif ( controller === undefined ) {\n\n\t\t\t\tcontroller = new WebXRController();\n\t\t\t\tcontrollers[ index ] = controller;\n\n\t\t\t}\n\n\t\t\treturn controller.getGripSpace();\n\n\t\t};\n\n\t\tthis.getHand = function ( index ) {\n\n\t\t\tlet controller = controllers[ index ];\n\n\t\t\tif ( controller === undefined ) {\n\n\t\t\t\tcontroller = new WebXRController();\n\t\t\t\tcontrollers[ index ] = controller;\n\n\t\t\t}\n\n\t\t\treturn controller.getHandSpace();\n\n\t\t};\n\n\t\t//\n\n\t\tfunction onSessionEvent( event ) {\n\n\t\t\tconst controller = inputSourcesMap.get( event.inputSource );\n\n\t\t\tif ( controller ) {\n\n\t\t\t\tcontroller.dispatchEvent( { type: event.type, data: event.inputSource } );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onSessionEnd() {\n\n\t\t\tinputSourcesMap.forEach( function ( controller, inputSource ) {\n\n\t\t\t\tcontroller.disconnect( inputSource );\n\n\t\t\t} );\n\n\t\t\tinputSourcesMap.clear();\n\n\t\t\t_currentDepthNear = null;\n\t\t\t_currentDepthFar = null;\n\n\t\t\t// restore framebuffer/rendering state\n\n\t\t\trenderer.setRenderTarget( initialRenderTarget );\n\n\t\t\tglBaseLayer = null;\n\t\t\tglProjLayer = null;\n\t\t\tglBinding = null;\n\t\t\tsession = null;\n\t\t\tnewRenderTarget = null;\n\n\t\t\t//\n\n\t\t\tanimation.stop();\n\n\t\t\tscope.isPresenting = false;\n\n\t\t\tscope.dispatchEvent( { type: 'sessionend' } );\n\n\t\t}\n\n\t\tthis.setFramebufferScaleFactor = function ( value ) {\n\n\t\t\tframebufferScaleFactor = value;\n\n\t\t\tif ( scope.isPresenting === true ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebXRManager: Cannot change framebuffer scale while presenting.' );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setReferenceSpaceType = function ( value ) {\n\n\t\t\treferenceSpaceType = value;\n\n\t\t\tif ( scope.isPresenting === true ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebXRManager: Cannot change reference space type while presenting.' );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.getReferenceSpace = function () {\n\n\t\t\treturn referenceSpace;\n\n\t\t};\n\n\t\tthis.getBaseLayer = function () {\n\n\t\t\treturn glProjLayer !== null ? glProjLayer : glBaseLayer;\n\n\t\t};\n\n\t\tthis.getBinding = function () {\n\n\t\t\treturn glBinding;\n\n\t\t};\n\n\t\tthis.getFrame = function () {\n\n\t\t\treturn xrFrame;\n\n\t\t};\n\n\t\tthis.getSession = function () {\n\n\t\t\treturn session;\n\n\t\t};\n\n\t\tthis.setSession = async function ( value ) {\n\n\t\t\tsession = value;\n\n\t\t\tif ( session !== null ) {\n\n\t\t\t\tinitialRenderTarget = renderer.getRenderTarget();\n\n\t\t\t\tsession.addEventListener( 'select', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'selectstart', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'selectend', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'squeeze', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'squeezestart', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'squeezeend', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'end', onSessionEnd );\n\t\t\t\tsession.addEventListener( 'inputsourceschange', onInputSourcesChange );\n\n\t\t\t\tif ( attributes.xrCompatible !== true ) {\n\n\t\t\t\t\tawait gl.makeXRCompatible();\n\n\t\t\t\t}\n\n\t\t\t\tif ( ( session.renderState.layers === undefined ) || ( renderer.capabilities.isWebGL2 === false ) ) {\n\n\t\t\t\t\tconst layerInit = {\n\t\t\t\t\t\tantialias: ( session.renderState.layers === undefined ) ? attributes.antialias : true,\n\t\t\t\t\t\talpha: attributes.alpha,\n\t\t\t\t\t\tdepth: attributes.depth,\n\t\t\t\t\t\tstencil: attributes.stencil,\n\t\t\t\t\t\tframebufferScaleFactor: framebufferScaleFactor\n\t\t\t\t\t};\n\n\t\t\t\t\tglBaseLayer = new XRWebGLLayer( session, gl, layerInit );\n\n\t\t\t\t\tsession.updateRenderState( { baseLayer: glBaseLayer } );\n\n\t\t\t\t\tnewRenderTarget = new WebGLRenderTarget(\n\t\t\t\t\t\tglBaseLayer.framebufferWidth,\n\t\t\t\t\t\tglBaseLayer.framebufferHeight,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tformat: RGBAFormat,\n\t\t\t\t\t\t\ttype: UnsignedByteType,\n\t\t\t\t\t\t\tencoding: renderer.outputEncoding\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t} else {\n\n\t\t\t\t\tisMultisample = attributes.antialias;\n\t\t\t\t\tlet depthFormat = null;\n\t\t\t\t\tlet depthType = null;\n\t\t\t\t\tlet glDepthFormat = null;\n\n\t\t\t\t\tif ( attributes.depth ) {\n\n\t\t\t\t\t\tglDepthFormat = attributes.stencil ? 35056 : 33190;\n\t\t\t\t\t\tdepthFormat = attributes.stencil ? DepthStencilFormat : DepthFormat;\n\t\t\t\t\t\tdepthType = attributes.stencil ? UnsignedInt248Type : UnsignedShortType;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst projectionlayerInit = {\n\t\t\t\t\t\tcolorFormat: ( renderer.outputEncoding === sRGBEncoding ) ? 35907 : 32856,\n\t\t\t\t\t\tdepthFormat: glDepthFormat,\n\t\t\t\t\t\tscaleFactor: framebufferScaleFactor\n\t\t\t\t\t};\n\n\t\t\t\t\tglBinding = new XRWebGLBinding( session, gl );\n\n\t\t\t\t\tglProjLayer = glBinding.createProjectionLayer( projectionlayerInit );\n\n\t\t\t\t\tsession.updateRenderState( { layers: [ glProjLayer ] } );\n\n\t\t\t\t\tif ( isMultisample ) {\n\n\t\t\t\t\t\tnewRenderTarget = new WebGLMultisampleRenderTarget(\n\t\t\t\t\t\t\tglProjLayer.textureWidth,\n\t\t\t\t\t\t\tglProjLayer.textureHeight,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tformat: RGBAFormat,\n\t\t\t\t\t\t\t\ttype: UnsignedByteType,\n\t\t\t\t\t\t\t\tdepthTexture: new DepthTexture( glProjLayer.textureWidth, glProjLayer.textureHeight, depthType, undefined, undefined, undefined, undefined, undefined, undefined, depthFormat ),\n\t\t\t\t\t\t\t\tstencilBuffer: attributes.stencil,\n\t\t\t\t\t\t\t\tignoreDepth: glProjLayer.ignoreDepthValues,\n\t\t\t\t\t\t\t\tuseRenderToTexture: hasMultisampledRenderToTexture,\n\t\t\t\t\t\t\t\tencoding: renderer.outputEncoding\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tnewRenderTarget = new WebGLRenderTarget(\n\t\t\t\t\t\t\tglProjLayer.textureWidth,\n\t\t\t\t\t\t\tglProjLayer.textureHeight,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tformat: RGBAFormat,\n\t\t\t\t\t\t\t\ttype: UnsignedByteType,\n\t\t\t\t\t\t\t\tdepthTexture: new DepthTexture( glProjLayer.textureWidth, glProjLayer.textureHeight, depthType, undefined, undefined, undefined, undefined, undefined, undefined, depthFormat ),\n\t\t\t\t\t\t\t\tstencilBuffer: attributes.stencil,\n\t\t\t\t\t\t\t\tignoreDepth: glProjLayer.ignoreDepthValues,\n\t\t\t\t\t\t\t\tencoding: renderer.outputEncoding\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tnewRenderTarget.isXRRenderTarget = true; // TODO Remove this when possible, see #23278\n\n\t\t\t\t// Set foveation to maximum.\n\t\t\t\tthis.setFoveation( 1.0 );\n\n\t\t\t\treferenceSpace = await session.requestReferenceSpace( referenceSpaceType );\n\n\t\t\t\tanimation.setContext( session );\n\t\t\t\tanimation.start();\n\n\t\t\t\tscope.isPresenting = true;\n\n\t\t\t\tscope.dispatchEvent( { type: 'sessionstart' } );\n\n\t\t\t}\n\n\t\t};\n\n\t\tfunction onInputSourcesChange( event ) {\n\n\t\t\tconst inputSources = session.inputSources;\n\n\t\t\t// Assign inputSources to available controllers\n\n\t\t\tfor ( let i = 0; i < controllers.length; i ++ ) {\n\n\t\t\t\tinputSourcesMap.set( inputSources[ i ], controllers[ i ] );\n\n\t\t\t}\n\n\t\t\t// Notify disconnected\n\n\t\t\tfor ( let i = 0; i < event.removed.length; i ++ ) {\n\n\t\t\t\tconst inputSource = event.removed[ i ];\n\t\t\t\tconst controller = inputSourcesMap.get( inputSource );\n\n\t\t\t\tif ( controller ) {\n\n\t\t\t\t\tcontroller.dispatchEvent( { type: 'disconnected', data: inputSource } );\n\t\t\t\t\tinputSourcesMap.delete( inputSource );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Notify connected\n\n\t\t\tfor ( let i = 0; i < event.added.length; i ++ ) {\n\n\t\t\t\tconst inputSource = event.added[ i ];\n\t\t\t\tconst controller = inputSourcesMap.get( inputSource );\n\n\t\t\t\tif ( controller ) {\n\n\t\t\t\t\tcontroller.dispatchEvent( { type: 'connected', data: inputSource } );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst cameraLPos = new Vector3();\n\t\tconst cameraRPos = new Vector3();\n\n\t\t/**\n\t\t * Assumes 2 cameras that are parallel and share an X-axis, and that\n\t\t * the cameras' projection and world matrices have already been set.\n\t\t * And that near and far planes are identical for both cameras.\n\t\t * Visualization of this technique: https://computergraphics.stackexchange.com/a/4765\n\t\t */\n\t\tfunction setProjectionFromUnion( camera, cameraL, cameraR ) {\n\n\t\t\tcameraLPos.setFromMatrixPosition( cameraL.matrixWorld );\n\t\t\tcameraRPos.setFromMatrixPosition( cameraR.matrixWorld );\n\n\t\t\tconst ipd = cameraLPos.distanceTo( cameraRPos );\n\n\t\t\tconst projL = cameraL.projectionMatrix.elements;\n\t\t\tconst projR = cameraR.projectionMatrix.elements;\n\n\t\t\t// VR systems will have identical far and near planes, and\n\t\t\t// most likely identical top and bottom frustum extents.\n\t\t\t// Use the left camera for these values.\n\t\t\tconst near = projL[ 14 ] / ( projL[ 10 ] - 1 );\n\t\t\tconst far = projL[ 14 ] / ( projL[ 10 ] + 1 );\n\t\t\tconst topFov = ( projL[ 9 ] + 1 ) / projL[ 5 ];\n\t\t\tconst bottomFov = ( projL[ 9 ] - 1 ) / projL[ 5 ];\n\n\t\t\tconst leftFov = ( projL[ 8 ] - 1 ) / projL[ 0 ];\n\t\t\tconst rightFov = ( projR[ 8 ] + 1 ) / projR[ 0 ];\n\t\t\tconst left = near * leftFov;\n\t\t\tconst right = near * rightFov;\n\n\t\t\t// Calculate the new camera's position offset from the\n\t\t\t// left camera. xOffset should be roughly half `ipd`.\n\t\t\tconst zOffset = ipd / ( - leftFov + rightFov );\n\t\t\tconst xOffset = zOffset * - leftFov;\n\n\t\t\t// TODO: Better way to apply this offset?\n\t\t\tcameraL.matrixWorld.decompose( camera.position, camera.quaternion, camera.scale );\n\t\t\tcamera.translateX( xOffset );\n\t\t\tcamera.translateZ( zOffset );\n\t\t\tcamera.matrixWorld.compose( camera.position, camera.quaternion, camera.scale );\n\t\t\tcamera.matrixWorldInverse.copy( camera.matrixWorld ).invert();\n\n\t\t\t// Find the union of the frustum values of the cameras and scale\n\t\t\t// the values so that the near plane's position does not change in world space,\n\t\t\t// although must now be relative to the new union camera.\n\t\t\tconst near2 = near + zOffset;\n\t\t\tconst far2 = far + zOffset;\n\t\t\tconst left2 = left - xOffset;\n\t\t\tconst right2 = right + ( ipd - xOffset );\n\t\t\tconst top2 = topFov * far / far2 * near2;\n\t\t\tconst bottom2 = bottomFov * far / far2 * near2;\n\n\t\t\tcamera.projectionMatrix.makePerspective( left2, right2, top2, bottom2, near2, far2 );\n\n\t\t}\n\n\t\tfunction updateCamera( camera, parent ) {\n\n\t\t\tif ( parent === null ) {\n\n\t\t\t\tcamera.matrixWorld.copy( camera.matrix );\n\n\t\t\t} else {\n\n\t\t\t\tcamera.matrixWorld.multiplyMatrices( parent.matrixWorld, camera.matrix );\n\n\t\t\t}\n\n\t\t\tcamera.matrixWorldInverse.copy( camera.matrixWorld ).invert();\n\n\t\t}\n\n\t\tthis.updateCamera = function ( camera ) {\n\n\t\t\tif ( session === null ) return;\n\n\t\t\tcameraVR.near = cameraR.near = cameraL.near = camera.near;\n\t\t\tcameraVR.far = cameraR.far = cameraL.far = camera.far;\n\n\t\t\tif ( _currentDepthNear !== cameraVR.near || _currentDepthFar !== cameraVR.far ) {\n\n\t\t\t\t// Note that the new renderState won't apply until the next frame. See #18320\n\n\t\t\t\tsession.updateRenderState( {\n\t\t\t\t\tdepthNear: cameraVR.near,\n\t\t\t\t\tdepthFar: cameraVR.far\n\t\t\t\t} );\n\n\t\t\t\t_currentDepthNear = cameraVR.near;\n\t\t\t\t_currentDepthFar = cameraVR.far;\n\n\t\t\t}\n\n\t\t\tconst parent = camera.parent;\n\t\t\tconst cameras = cameraVR.cameras;\n\n\t\t\tupdateCamera( cameraVR, parent );\n\n\t\t\tfor ( let i = 0; i < cameras.length; i ++ ) {\n\n\t\t\t\tupdateCamera( cameras[ i ], parent );\n\n\t\t\t}\n\n\t\t\tcameraVR.matrixWorld.decompose( cameraVR.position, cameraVR.quaternion, cameraVR.scale );\n\n\t\t\t// update user camera and its children\n\n\t\t\tcamera.position.copy( cameraVR.position );\n\t\t\tcamera.quaternion.copy( cameraVR.quaternion );\n\t\t\tcamera.scale.copy( cameraVR.scale );\n\t\t\tcamera.matrix.copy( cameraVR.matrix );\n\t\t\tcamera.matrixWorld.copy( cameraVR.matrixWorld );\n\n\t\t\tconst children = camera.children;\n\n\t\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tchildren[ i ].updateMatrixWorld( true );\n\n\t\t\t}\n\n\t\t\t// update projection matrix for proper view frustum culling\n\n\t\t\tif ( cameras.length === 2 ) {\n\n\t\t\t\tsetProjectionFromUnion( cameraVR, cameraL, cameraR );\n\n\t\t\t} else {\n\n\t\t\t\t// assume single camera setup (AR)\n\n\t\t\t\tcameraVR.projectionMatrix.copy( cameraL.projectionMatrix );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.getCamera = function () {\n\n\t\t\treturn cameraVR;\n\n\t\t};\n\n\t\tthis.getFoveation = function () {\n\n\t\t\tif ( glProjLayer !== null ) {\n\n\t\t\t\treturn glProjLayer.fixedFoveation;\n\n\t\t\t}\n\n\t\t\tif ( glBaseLayer !== null ) {\n\n\t\t\t\treturn glBaseLayer.fixedFoveation;\n\n\t\t\t}\n\n\t\t\treturn undefined;\n\n\t\t};\n\n\t\tthis.setFoveation = function ( foveation ) {\n\n\t\t\t// 0 = no foveation = full resolution\n\t\t\t// 1 = maximum foveation = the edges render at lower resolution\n\n\t\t\tif ( glProjLayer !== null ) {\n\n\t\t\t\tglProjLayer.fixedFoveation = foveation;\n\n\t\t\t}\n\n\t\t\tif ( glBaseLayer !== null && glBaseLayer.fixedFoveation !== undefined ) {\n\n\t\t\t\tglBaseLayer.fixedFoveation = foveation;\n\n\t\t\t}\n\n\t\t};\n\n\t\t// Animation Loop\n\n\t\tlet onAnimationFrameCallback = null;\n\n\t\tfunction onAnimationFrame( time, frame ) {\n\n\t\t\tpose = frame.getViewerPose( referenceSpace );\n\t\t\txrFrame = frame;\n\n\t\t\tif ( pose !== null ) {\n\n\t\t\t\tconst views = pose.views;\n\n\t\t\t\tif ( glBaseLayer !== null ) {\n\n\t\t\t\t\trenderer.setRenderTargetFramebuffer( newRenderTarget, glBaseLayer.framebuffer );\n\t\t\t\t\trenderer.setRenderTarget( newRenderTarget );\n\n\t\t\t\t}\n\n\t\t\t\tlet cameraVRNeedsUpdate = false;\n\n\t\t\t\t// check if it's necessary to rebuild cameraVR's camera list\n\n\t\t\t\tif ( views.length !== cameraVR.cameras.length ) {\n\n\t\t\t\t\tcameraVR.cameras.length = 0;\n\t\t\t\t\tcameraVRNeedsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0; i < views.length; i ++ ) {\n\n\t\t\t\t\tconst view = views[ i ];\n\n\t\t\t\t\tlet viewport = null;\n\n\t\t\t\t\tif ( glBaseLayer !== null ) {\n\n\t\t\t\t\t\tviewport = glBaseLayer.getViewport( view );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst glSubImage = glBinding.getViewSubImage( glProjLayer, view );\n\t\t\t\t\t\tviewport = glSubImage.viewport;\n\n\t\t\t\t\t\t// For side-by-side projection, we only produce a single texture for both eyes.\n\t\t\t\t\t\tif ( i === 0 ) {\n\n\t\t\t\t\t\t\trenderer.setRenderTargetTextures(\n\t\t\t\t\t\t\t\tnewRenderTarget,\n\t\t\t\t\t\t\t\tglSubImage.colorTexture,\n\t\t\t\t\t\t\t\tglProjLayer.ignoreDepthValues ? undefined : glSubImage.depthStencilTexture );\n\n\t\t\t\t\t\t\trenderer.setRenderTarget( newRenderTarget );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst camera = cameras[ i ];\n\n\t\t\t\t\tcamera.matrix.fromArray( view.transform.matrix );\n\t\t\t\t\tcamera.projectionMatrix.fromArray( view.projectionMatrix );\n\t\t\t\t\tcamera.viewport.set( viewport.x, viewport.y, viewport.width, viewport.height );\n\n\t\t\t\t\tif ( i === 0 ) {\n\n\t\t\t\t\t\tcameraVR.matrix.copy( camera.matrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( cameraVRNeedsUpdate === true ) {\n\n\t\t\t\t\t\tcameraVR.cameras.push( camera );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tconst inputSources = session.inputSources;\n\n\t\t\tfor ( let i = 0; i < controllers.length; i ++ ) {\n\n\t\t\t\tconst controller = controllers[ i ];\n\t\t\t\tconst inputSource = inputSources[ i ];\n\n\t\t\t\tcontroller.update( inputSource, frame, referenceSpace );\n\n\t\t\t}\n\n\t\t\tif ( onAnimationFrameCallback ) onAnimationFrameCallback( time, frame );\n\n\t\t\txrFrame = null;\n\n\t\t}\n\n\t\tconst animation = new WebGLAnimation();\n\n\t\tanimation.setAnimationLoop( onAnimationFrame );\n\n\t\tthis.setAnimationLoop = function ( callback ) {\n\n\t\t\tonAnimationFrameCallback = callback;\n\n\t\t};\n\n\t\tthis.dispose = function () {};\n\n\t}\n\n}\n\nfunction WebGLMaterials( properties ) {\n\n\tfunction refreshFogUniforms( uniforms, fog ) {\n\n\t\tuniforms.fogColor.value.copy( fog.color );\n\n\t\tif ( fog.isFog ) {\n\n\t\t\tuniforms.fogNear.value = fog.near;\n\t\t\tuniforms.fogFar.value = fog.far;\n\n\t\t} else if ( fog.isFogExp2 ) {\n\n\t\t\tuniforms.fogDensity.value = fog.density;\n\n\t\t}\n\n\t}\n\n\tfunction refreshMaterialUniforms( uniforms, material, pixelRatio, height, transmissionRenderTarget ) {\n\n\t\tif ( material.isMeshBasicMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\n\t\t} else if ( material.isMeshLambertMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsLambert( uniforms, material );\n\n\t\t} else if ( material.isMeshToonMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsToon( uniforms, material );\n\n\t\t} else if ( material.isMeshPhongMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsPhong( uniforms, material );\n\n\t\t} else if ( material.isMeshStandardMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\n\t\t\tif ( material.isMeshPhysicalMaterial ) {\n\n\t\t\t\trefreshUniformsPhysical( uniforms, material, transmissionRenderTarget );\n\n\t\t\t} else {\n\n\t\t\t\trefreshUniformsStandard( uniforms, material );\n\n\t\t\t}\n\n\t\t} else if ( material.isMeshMatcapMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsMatcap( uniforms, material );\n\n\t\t} else if ( material.isMeshDepthMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsDepth( uniforms, material );\n\n\t\t} else if ( material.isMeshDistanceMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsDistance( uniforms, material );\n\n\t\t} else if ( material.isMeshNormalMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsNormal( uniforms, material );\n\n\t\t} else if ( material.isLineBasicMaterial ) {\n\n\t\t\trefreshUniformsLine( uniforms, material );\n\n\t\t\tif ( material.isLineDashedMaterial ) {\n\n\t\t\t\trefreshUniformsDash( uniforms, material );\n\n\t\t\t}\n\n\t\t} else if ( material.isPointsMaterial ) {\n\n\t\t\trefreshUniformsPoints( uniforms, material, pixelRatio, height );\n\n\t\t} else if ( material.isSpriteMaterial ) {\n\n\t\t\trefreshUniformsSprites( uniforms, material );\n\n\t\t} else if ( material.isShadowMaterial ) {\n\n\t\t\tuniforms.color.value.copy( material.color );\n\t\t\tuniforms.opacity.value = material.opacity;\n\n\t\t} else if ( material.isShaderMaterial ) {\n\n\t\t\tmaterial.uniformsNeedUpdate = false; // #15581\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsCommon( uniforms, material ) {\n\n\t\tuniforms.opacity.value = material.opacity;\n\n\t\tif ( material.color ) {\n\n\t\t\tuniforms.diffuse.value.copy( material.color );\n\n\t\t}\n\n\t\tif ( material.emissive ) {\n\n\t\t\tuniforms.emissive.value.copy( material.emissive ).multiplyScalar( material.emissiveIntensity );\n\n\t\t}\n\n\t\tif ( material.map ) {\n\n\t\t\tuniforms.map.value = material.map;\n\n\t\t}\n\n\t\tif ( material.alphaMap ) {\n\n\t\t\tuniforms.alphaMap.value = material.alphaMap;\n\n\t\t}\n\n\t\tif ( material.specularMap ) {\n\n\t\t\tuniforms.specularMap.value = material.specularMap;\n\n\t\t}\n\n\t\tif ( material.alphaTest > 0 ) {\n\n\t\t\tuniforms.alphaTest.value = material.alphaTest;\n\n\t\t}\n\n\t\tconst envMap = properties.get( material ).envMap;\n\n\t\tif ( envMap ) {\n\n\t\t\tuniforms.envMap.value = envMap;\n\n\t\t\tuniforms.flipEnvMap.value = ( envMap.isCubeTexture && envMap.isRenderTargetTexture === false ) ? - 1 : 1;\n\n\t\t\tuniforms.reflectivity.value = material.reflectivity;\n\t\t\tuniforms.ior.value = material.ior;\n\t\t\tuniforms.refractionRatio.value = material.refractionRatio;\n\n\t\t}\n\n\t\tif ( material.lightMap ) {\n\n\t\t\tuniforms.lightMap.value = material.lightMap;\n\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\n\n\t\t}\n\n\t\tif ( material.aoMap ) {\n\n\t\t\tuniforms.aoMap.value = material.aoMap;\n\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\n\n\t\t}\n\n\t\t// uv repeat and offset setting priorities\n\t\t// 1. color map\n\t\t// 2. specular map\n\t\t// 3. displacementMap map\n\t\t// 4. normal map\n\t\t// 5. bump map\n\t\t// 6. roughnessMap map\n\t\t// 7. metalnessMap map\n\t\t// 8. alphaMap map\n\t\t// 9. emissiveMap map\n\t\t// 10. clearcoat map\n\t\t// 11. clearcoat normal map\n\t\t// 12. clearcoat roughnessMap map\n\t\t// 13. specular intensity map\n\t\t// 14. specular tint map\n\t\t// 15. transmission map\n\t\t// 16. thickness map\n\n\t\tlet uvScaleMap;\n\n\t\tif ( material.map ) {\n\n\t\t\tuvScaleMap = material.map;\n\n\t\t} else if ( material.specularMap ) {\n\n\t\t\tuvScaleMap = material.specularMap;\n\n\t\t} else if ( material.displacementMap ) {\n\n\t\t\tuvScaleMap = material.displacementMap;\n\n\t\t} else if ( material.normalMap ) {\n\n\t\t\tuvScaleMap = material.normalMap;\n\n\t\t} else if ( material.bumpMap ) {\n\n\t\t\tuvScaleMap = material.bumpMap;\n\n\t\t} else if ( material.roughnessMap ) {\n\n\t\t\tuvScaleMap = material.roughnessMap;\n\n\t\t} else if ( material.metalnessMap ) {\n\n\t\t\tuvScaleMap = material.metalnessMap;\n\n\t\t} else if ( material.alphaMap ) {\n\n\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t} else if ( material.emissiveMap ) {\n\n\t\t\tuvScaleMap = material.emissiveMap;\n\n\t\t} else if ( material.clearcoatMap ) {\n\n\t\t\tuvScaleMap = material.clearcoatMap;\n\n\t\t} else if ( material.clearcoatNormalMap ) {\n\n\t\t\tuvScaleMap = material.clearcoatNormalMap;\n\n\t\t} else if ( material.clearcoatRoughnessMap ) {\n\n\t\t\tuvScaleMap = material.clearcoatRoughnessMap;\n\n\t\t} else if ( material.specularIntensityMap ) {\n\n\t\t\tuvScaleMap = material.specularIntensityMap;\n\n\t\t} else if ( material.specularColorMap ) {\n\n\t\t\tuvScaleMap = material.specularColorMap;\n\n\t\t} else if ( material.transmissionMap ) {\n\n\t\t\tuvScaleMap = material.transmissionMap;\n\n\t\t} else if ( material.thicknessMap ) {\n\n\t\t\tuvScaleMap = material.thicknessMap;\n\n\t\t} else if ( material.sheenColorMap ) {\n\n\t\t\tuvScaleMap = material.sheenColorMap;\n\n\t\t} else if ( material.sheenRoughnessMap ) {\n\n\t\t\tuvScaleMap = material.sheenRoughnessMap;\n\n\t\t}\n\n\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\t// backwards compatibility\n\t\t\tif ( uvScaleMap.isWebGLRenderTarget ) {\n\n\t\t\t\tuvScaleMap = uvScaleMap.texture;\n\n\t\t\t}\n\n\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\tuvScaleMap.updateMatrix();\n\n\t\t\t}\n\n\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\n\n\t\t}\n\n\t\t// uv repeat and offset setting priorities for uv2\n\t\t// 1. ao map\n\t\t// 2. light map\n\n\t\tlet uv2ScaleMap;\n\n\t\tif ( material.aoMap ) {\n\n\t\t\tuv2ScaleMap = material.aoMap;\n\n\t\t} else if ( material.lightMap ) {\n\n\t\t\tuv2ScaleMap = material.lightMap;\n\n\t\t}\n\n\t\tif ( uv2ScaleMap !== undefined ) {\n\n\t\t\t// backwards compatibility\n\t\t\tif ( uv2ScaleMap.isWebGLRenderTarget ) {\n\n\t\t\t\tuv2ScaleMap = uv2ScaleMap.texture;\n\n\t\t\t}\n\n\t\t\tif ( uv2ScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\tuv2ScaleMap.updateMatrix();\n\n\t\t\t}\n\n\t\t\tuniforms.uv2Transform.value.copy( uv2ScaleMap.matrix );\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsLine( uniforms, material ) {\n\n\t\tuniforms.diffuse.value.copy( material.color );\n\t\tuniforms.opacity.value = material.opacity;\n\n\t}\n\n\tfunction refreshUniformsDash( uniforms, material ) {\n\n\t\tuniforms.dashSize.value = material.dashSize;\n\t\tuniforms.totalSize.value = material.dashSize + material.gapSize;\n\t\tuniforms.scale.value = material.scale;\n\n\t}\n\n\tfunction refreshUniformsPoints( uniforms, material, pixelRatio, height ) {\n\n\t\tuniforms.diffuse.value.copy( material.color );\n\t\tuniforms.opacity.value = material.opacity;\n\t\tuniforms.size.value = material.size * pixelRatio;\n\t\tuniforms.scale.value = height * 0.5;\n\n\t\tif ( material.map ) {\n\n\t\t\tuniforms.map.value = material.map;\n\n\t\t}\n\n\t\tif ( material.alphaMap ) {\n\n\t\t\tuniforms.alphaMap.value = material.alphaMap;\n\n\t\t}\n\n\t\tif ( material.alphaTest > 0 ) {\n\n\t\t\tuniforms.alphaTest.value = material.alphaTest;\n\n\t\t}\n\n\t\t// uv repeat and offset setting priorities\n\t\t// 1. color map\n\t\t// 2. alpha map\n\n\t\tlet uvScaleMap;\n\n\t\tif ( material.map ) {\n\n\t\t\tuvScaleMap = material.map;\n\n\t\t} else if ( material.alphaMap ) {\n\n\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t}\n\n\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\tuvScaleMap.updateMatrix();\n\n\t\t\t}\n\n\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsSprites( uniforms, material ) {\n\n\t\tuniforms.diffuse.value.copy( material.color );\n\t\tuniforms.opacity.value = material.opacity;\n\t\tuniforms.rotation.value = material.rotation;\n\n\t\tif ( material.map ) {\n\n\t\t\tuniforms.map.value = material.map;\n\n\t\t}\n\n\t\tif ( material.alphaMap ) {\n\n\t\t\tuniforms.alphaMap.value = material.alphaMap;\n\n\t\t}\n\n\t\tif ( material.alphaTest > 0 ) {\n\n\t\t\tuniforms.alphaTest.value = material.alphaTest;\n\n\t\t}\n\n\t\t// uv repeat and offset setting priorities\n\t\t// 1. color map\n\t\t// 2. alpha map\n\n\t\tlet uvScaleMap;\n\n\t\tif ( material.map ) {\n\n\t\t\tuvScaleMap = material.map;\n\n\t\t} else if ( material.alphaMap ) {\n\n\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t}\n\n\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\tuvScaleMap.updateMatrix();\n\n\t\t\t}\n\n\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsLambert( uniforms, material ) {\n\n\t\tif ( material.emissiveMap ) {\n\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsPhong( uniforms, material ) {\n\n\t\tuniforms.specular.value.copy( material.specular );\n\t\tuniforms.shininess.value = Math.max( material.shininess, 1e-4 ); // to prevent pow( 0.0, 0.0 )\n\n\t\tif ( material.emissiveMap ) {\n\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\n\t\t}\n\n\t\tif ( material.bumpMap ) {\n\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\t\t\tif ( material.side === BackSide ) uniforms.bumpScale.value *= - 1;\n\n\t\t}\n\n\t\tif ( material.normalMap ) {\n\n\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\t\t\tif ( material.side === BackSide ) uniforms.normalScale.value.negate();\n\n\t\t}\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsToon( uniforms, material ) {\n\n\t\tif ( material.gradientMap ) {\n\n\t\t\tuniforms.gradientMap.value = material.gradientMap;\n\n\t\t}\n\n\t\tif ( material.emissiveMap ) {\n\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\n\t\t}\n\n\t\tif ( material.bumpMap ) {\n\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\t\t\tif ( material.side === BackSide ) uniforms.bumpScale.value *= - 1;\n\n\t\t}\n\n\t\tif ( material.normalMap ) {\n\n\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\t\t\tif ( material.side === BackSide ) uniforms.normalScale.value.negate();\n\n\t\t}\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsStandard( uniforms, material ) {\n\n\t\tuniforms.roughness.value = material.roughness;\n\t\tuniforms.metalness.value = material.metalness;\n\n\t\tif ( material.roughnessMap ) {\n\n\t\t\tuniforms.roughnessMap.value = material.roughnessMap;\n\n\t\t}\n\n\t\tif ( material.metalnessMap ) {\n\n\t\t\tuniforms.metalnessMap.value = material.metalnessMap;\n\n\t\t}\n\n\t\tif ( material.emissiveMap ) {\n\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\n\t\t}\n\n\t\tif ( material.bumpMap ) {\n\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\t\t\tif ( material.side === BackSide ) uniforms.bumpScale.value *= - 1;\n\n\t\t}\n\n\t\tif ( material.normalMap ) {\n\n\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\t\t\tif ( material.side === BackSide ) uniforms.normalScale.value.negate();\n\n\t\t}\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t\tconst envMap = properties.get( material ).envMap;\n\n\t\tif ( envMap ) {\n\n\t\t\t//uniforms.envMap.value = material.envMap; // part of uniforms common\n\t\t\tuniforms.envMapIntensity.value = material.envMapIntensity;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsPhysical( uniforms, material, transmissionRenderTarget ) {\n\n\t\trefreshUniformsStandard( uniforms, material );\n\n\t\tuniforms.ior.value = material.ior; // also part of uniforms common\n\n\t\tif ( material.sheen > 0 ) {\n\n\t\t\tuniforms.sheenColor.value.copy( material.sheenColor ).multiplyScalar( material.sheen );\n\n\t\t\tuniforms.sheenRoughness.value = material.sheenRoughness;\n\n\t\t\tif ( material.sheenColorMap ) {\n\n\t\t\t\tuniforms.sheenColorMap.value = material.sheenColorMap;\n\n\t\t\t}\n\n\t\t\tif ( material.sheenRoughnessMap ) {\n\n\t\t\t\tuniforms.sheenRoughnessMap.value = material.sheenRoughnessMap;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( material.clearcoat > 0 ) {\n\n\t\t\tuniforms.clearcoat.value = material.clearcoat;\n\t\t\tuniforms.clearcoatRoughness.value = material.clearcoatRoughness;\n\n\t\t\tif ( material.clearcoatMap ) {\n\n\t\t\t\tuniforms.clearcoatMap.value = material.clearcoatMap;\n\n\t\t\t}\n\n\t\t\tif ( material.clearcoatRoughnessMap ) {\n\n\t\t\t\tuniforms.clearcoatRoughnessMap.value = material.clearcoatRoughnessMap;\n\n\t\t\t}\n\n\t\t\tif ( material.clearcoatNormalMap ) {\n\n\t\t\t\tuniforms.clearcoatNormalScale.value.copy( material.clearcoatNormalScale );\n\t\t\t\tuniforms.clearcoatNormalMap.value = material.clearcoatNormalMap;\n\n\t\t\t\tif ( material.side === BackSide ) {\n\n\t\t\t\t\tuniforms.clearcoatNormalScale.value.negate();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( material.transmission > 0 ) {\n\n\t\t\tuniforms.transmission.value = material.transmission;\n\t\t\tuniforms.transmissionSamplerMap.value = transmissionRenderTarget.texture;\n\t\t\tuniforms.transmissionSamplerSize.value.set( transmissionRenderTarget.width, transmissionRenderTarget.height );\n\n\t\t\tif ( material.transmissionMap ) {\n\n\t\t\t\tuniforms.transmissionMap.value = material.transmissionMap;\n\n\t\t\t}\n\n\t\t\tuniforms.thickness.value = material.thickness;\n\n\t\t\tif ( material.thicknessMap ) {\n\n\t\t\t\tuniforms.thicknessMap.value = material.thicknessMap;\n\n\t\t\t}\n\n\t\t\tuniforms.attenuationDistance.value = material.attenuationDistance;\n\t\t\tuniforms.attenuationColor.value.copy( material.attenuationColor );\n\n\t\t}\n\n\t\tuniforms.specularIntensity.value = material.specularIntensity;\n\t\tuniforms.specularColor.value.copy( material.specularColor );\n\n\t\tif ( material.specularIntensityMap ) {\n\n\t\t\tuniforms.specularIntensityMap.value = material.specularIntensityMap;\n\n\t\t}\n\n\t\tif ( material.specularColorMap ) {\n\n\t\t\tuniforms.specularColorMap.value = material.specularColorMap;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsMatcap( uniforms, material ) {\n\n\t\tif ( material.matcap ) {\n\n\t\t\tuniforms.matcap.value = material.matcap;\n\n\t\t}\n\n\t\tif ( material.bumpMap ) {\n\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\t\t\tif ( material.side === BackSide ) uniforms.bumpScale.value *= - 1;\n\n\t\t}\n\n\t\tif ( material.normalMap ) {\n\n\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\t\t\tif ( material.side === BackSide ) uniforms.normalScale.value.negate();\n\n\t\t}\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsDepth( uniforms, material ) {\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsDistance( uniforms, material ) {\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t\tuniforms.referencePosition.value.copy( material.referencePosition );\n\t\tuniforms.nearDistance.value = material.nearDistance;\n\t\tuniforms.farDistance.value = material.farDistance;\n\n\t}\n\n\tfunction refreshUniformsNormal( uniforms, material ) {\n\n\t\tif ( material.bumpMap ) {\n\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\t\t\tif ( material.side === BackSide ) uniforms.bumpScale.value *= - 1;\n\n\t\t}\n\n\t\tif ( material.normalMap ) {\n\n\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\t\t\tif ( material.side === BackSide ) uniforms.normalScale.value.negate();\n\n\t\t}\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t}\n\n\treturn {\n\t\trefreshFogUniforms: refreshFogUniforms,\n\t\trefreshMaterialUniforms: refreshMaterialUniforms\n\t};\n\n}\n\nfunction createCanvasElement() {\n\n\tconst canvas = createElementNS( 'canvas' );\n\tcanvas.style.display = 'block';\n\treturn canvas;\n\n}\n\nfunction WebGLRenderer( parameters = {} ) {\n\n\tconst _canvas = parameters.canvas !== undefined ? parameters.canvas : createCanvasElement(),\n\t\t_context = parameters.context !== undefined ? parameters.context : null,\n\n\t\t_alpha = parameters.alpha !== undefined ? parameters.alpha : false,\n\t\t_depth = parameters.depth !== undefined ? parameters.depth : true,\n\t\t_stencil = parameters.stencil !== undefined ? parameters.stencil : true,\n\t\t_antialias = parameters.antialias !== undefined ? parameters.antialias : false,\n\t\t_premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\n\t\t_preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false,\n\t\t_powerPreference = parameters.powerPreference !== undefined ? parameters.powerPreference : 'default',\n\t\t_failIfMajorPerformanceCaveat = parameters.failIfMajorPerformanceCaveat !== undefined ? parameters.failIfMajorPerformanceCaveat : false;\n\n\tlet currentRenderList = null;\n\tlet currentRenderState = null;\n\n\t// render() can be called from within a callback triggered by another render.\n\t// We track this so that the nested render call gets its list and state isolated from the parent render call.\n\n\tconst renderListStack = [];\n\tconst renderStateStack = [];\n\n\t// public properties\n\n\tthis.domElement = _canvas;\n\n\t// Debug configuration container\n\tthis.debug = {\n\n\t\t/**\n\t\t * Enables error checking and reporting when shader programs are being compiled\n\t\t * @type {boolean}\n\t\t */\n\t\tcheckShaderErrors: true\n\t};\n\n\t// clearing\n\n\tthis.autoClear = true;\n\tthis.autoClearColor = true;\n\tthis.autoClearDepth = true;\n\tthis.autoClearStencil = true;\n\n\t// scene graph\n\n\tthis.sortObjects = true;\n\n\t// user-defined clipping\n\n\tthis.clippingPlanes = [];\n\tthis.localClippingEnabled = false;\n\n\t// physically based shading\n\n\tthis.outputEncoding = LinearEncoding;\n\n\t// physical lights\n\n\tthis.physicallyCorrectLights = false;\n\n\t// tone mapping\n\n\tthis.toneMapping = NoToneMapping;\n\tthis.toneMappingExposure = 1.0;\n\n\t// internal properties\n\n\tconst _this = this;\n\n\tlet _isContextLost = false;\n\n\t// internal state cache\n\n\tlet _currentActiveCubeFace = 0;\n\tlet _currentActiveMipmapLevel = 0;\n\tlet _currentRenderTarget = null;\n\tlet _currentMaterialId = - 1;\n\n\tlet _currentCamera = null;\n\n\tconst _currentViewport = new Vector4();\n\tconst _currentScissor = new Vector4();\n\tlet _currentScissorTest = null;\n\n\t//\n\n\tlet _width = _canvas.width;\n\tlet _height = _canvas.height;\n\n\tlet _pixelRatio = 1;\n\tlet _opaqueSort = null;\n\tlet _transparentSort = null;\n\n\tconst _viewport = new Vector4( 0, 0, _width, _height );\n\tconst _scissor = new Vector4( 0, 0, _width, _height );\n\tlet _scissorTest = false;\n\n\t// frustum\n\n\tconst _frustum = new Frustum();\n\n\t// clipping\n\n\tlet _clippingEnabled = false;\n\tlet _localClippingEnabled = false;\n\n\t// transmission\n\n\tlet _transmissionRenderTarget = null;\n\n\t// camera matrices cache\n\n\tconst _projScreenMatrix = new Matrix4();\n\n\tconst _vector3 = new Vector3();\n\n\tconst _emptyScene = { background: null, fog: null, environment: null, overrideMaterial: null, isScene: true };\n\n\tfunction getTargetPixelRatio() {\n\n\t\treturn _currentRenderTarget === null ? _pixelRatio : 1;\n\n\t}\n\n\t// initialize\n\n\tlet _gl = _context;\n\n\tfunction getContext( contextNames, contextAttributes ) {\n\n\t\tfor ( let i = 0; i < contextNames.length; i ++ ) {\n\n\t\t\tconst contextName = contextNames[ i ];\n\t\t\tconst context = _canvas.getContext( contextName, contextAttributes );\n\t\t\tif ( context !== null ) return context;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\ttry {\n\n\t\tconst contextAttributes = {\n\t\t\talpha: true,\n\t\t\tdepth: _depth,\n\t\t\tstencil: _stencil,\n\t\t\tantialias: _antialias,\n\t\t\tpremultipliedAlpha: _premultipliedAlpha,\n\t\t\tpreserveDrawingBuffer: _preserveDrawingBuffer,\n\t\t\tpowerPreference: _powerPreference,\n\t\t\tfailIfMajorPerformanceCaveat: _failIfMajorPerformanceCaveat\n\t\t};\n\n\t\t// OffscreenCanvas does not have setAttribute, see #22811\n\t\tif ( 'setAttribute' in _canvas ) _canvas.setAttribute( 'data-engine', `three.js r${REVISION}` );\n\n\t\t// event listeners must be registered before WebGL context is created, see #12753\n\t\t_canvas.addEventListener( 'webglcontextlost', onContextLost, false );\n\t\t_canvas.addEventListener( 'webglcontextrestored', onContextRestore, false );\n\n\t\tif ( _gl === null ) {\n\n\t\t\tconst contextNames = [ 'webgl2', 'webgl', 'experimental-webgl' ];\n\n\t\t\tif ( _this.isWebGL1Renderer === true ) {\n\n\t\t\t\tcontextNames.shift();\n\n\t\t\t}\n\n\t\t\t_gl = getContext( contextNames, contextAttributes );\n\n\t\t\tif ( _gl === null ) {\n\n\t\t\t\tif ( getContext( contextNames ) ) {\n\n\t\t\t\t\tthrow new Error( 'Error creating WebGL context with your selected attributes.' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'Error creating WebGL context.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Some experimental-webgl implementations do not have getShaderPrecisionFormat\n\n\t\tif ( _gl.getShaderPrecisionFormat === undefined ) {\n\n\t\t\t_gl.getShaderPrecisionFormat = function () {\n\n\t\t\t\treturn { 'rangeMin': 1, 'rangeMax': 1, 'precision': 1 };\n\n\t\t\t};\n\n\t\t}\n\n\t} catch ( error ) {\n\n\t\tconsole.error( 'THREE.WebGLRenderer: ' + error.message );\n\t\tthrow error;\n\n\t}\n\n\tlet extensions, capabilities, state, info;\n\tlet properties, textures, cubemaps, cubeuvmaps, attributes, geometries, objects;\n\tlet programCache, materials, renderLists, renderStates, clipping, shadowMap;\n\n\tlet background, morphtargets, bufferRenderer, indexedBufferRenderer;\n\n\tlet utils, bindingStates;\n\n\tfunction initGLContext() {\n\n\t\textensions = new WebGLExtensions( _gl );\n\n\t\tcapabilities = new WebGLCapabilities( _gl, extensions, parameters );\n\n\t\textensions.init( capabilities );\n\n\t\tutils = new WebGLUtils( _gl, extensions, capabilities );\n\n\t\tstate = new WebGLState( _gl, extensions, capabilities );\n\n\t\tinfo = new WebGLInfo( _gl );\n\t\tproperties = new WebGLProperties();\n\t\ttextures = new WebGLTextures( _gl, extensions, state, properties, capabilities, utils, info );\n\t\tcubemaps = new WebGLCubeMaps( _this );\n\t\tcubeuvmaps = new WebGLCubeUVMaps( _this );\n\t\tattributes = new WebGLAttributes( _gl, capabilities );\n\t\tbindingStates = new WebGLBindingStates( _gl, extensions, attributes, capabilities );\n\t\tgeometries = new WebGLGeometries( _gl, attributes, info, bindingStates );\n\t\tobjects = new WebGLObjects( _gl, geometries, attributes, info );\n\t\tmorphtargets = new WebGLMorphtargets( _gl, capabilities, textures );\n\t\tclipping = new WebGLClipping( properties );\n\t\tprogramCache = new WebGLPrograms( _this, cubemaps, cubeuvmaps, extensions, capabilities, bindingStates, clipping );\n\t\tmaterials = new WebGLMaterials( properties );\n\t\trenderLists = new WebGLRenderLists();\n\t\trenderStates = new WebGLRenderStates( extensions, capabilities );\n\t\tbackground = new WebGLBackground( _this, cubemaps, state, objects, _alpha, _premultipliedAlpha );\n\t\tshadowMap = new WebGLShadowMap( _this, objects, capabilities );\n\n\t\tbufferRenderer = new WebGLBufferRenderer( _gl, extensions, info, capabilities );\n\t\tindexedBufferRenderer = new WebGLIndexedBufferRenderer( _gl, extensions, info, capabilities );\n\n\t\tinfo.programs = programCache.programs;\n\n\t\t_this.capabilities = capabilities;\n\t\t_this.extensions = extensions;\n\t\t_this.properties = properties;\n\t\t_this.renderLists = renderLists;\n\t\t_this.shadowMap = shadowMap;\n\t\t_this.state = state;\n\t\t_this.info = info;\n\n\t}\n\n\tinitGLContext();\n\n\t// xr\n\n\tconst xr = new WebXRManager( _this, _gl );\n\n\tthis.xr = xr;\n\n\t// API\n\n\tthis.getContext = function () {\n\n\t\treturn _gl;\n\n\t};\n\n\tthis.getContextAttributes = function () {\n\n\t\treturn _gl.getContextAttributes();\n\n\t};\n\n\tthis.forceContextLoss = function () {\n\n\t\tconst extension = extensions.get( 'WEBGL_lose_context' );\n\t\tif ( extension ) extension.loseContext();\n\n\t};\n\n\tthis.forceContextRestore = function () {\n\n\t\tconst extension = extensions.get( 'WEBGL_lose_context' );\n\t\tif ( extension ) extension.restoreContext();\n\n\t};\n\n\tthis.getPixelRatio = function () {\n\n\t\treturn _pixelRatio;\n\n\t};\n\n\tthis.setPixelRatio = function ( value ) {\n\n\t\tif ( value === undefined ) return;\n\n\t\t_pixelRatio = value;\n\n\t\tthis.setSize( _width, _height, false );\n\n\t};\n\n\tthis.getSize = function ( target ) {\n\n\t\treturn target.set( _width, _height );\n\n\t};\n\n\tthis.setSize = function ( width, height, updateStyle ) {\n\n\t\tif ( xr.isPresenting ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: Can\\'t change size while VR device is presenting.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\t_width = width;\n\t\t_height = height;\n\n\t\t_canvas.width = Math.floor( width * _pixelRatio );\n\t\t_canvas.height = Math.floor( height * _pixelRatio );\n\n\t\tif ( updateStyle !== false ) {\n\n\t\t\t_canvas.style.width = width + 'px';\n\t\t\t_canvas.style.height = height + 'px';\n\n\t\t}\n\n\t\tthis.setViewport( 0, 0, width, height );\n\n\t};\n\n\tthis.getDrawingBufferSize = function ( target ) {\n\n\t\treturn target.set( _width * _pixelRatio, _height * _pixelRatio ).floor();\n\n\t};\n\n\tthis.setDrawingBufferSize = function ( width, height, pixelRatio ) {\n\n\t\t_width = width;\n\t\t_height = height;\n\n\t\t_pixelRatio = pixelRatio;\n\n\t\t_canvas.width = Math.floor( width * pixelRatio );\n\t\t_canvas.height = Math.floor( height * pixelRatio );\n\n\t\tthis.setViewport( 0, 0, width, height );\n\n\t};\n\n\tthis.getCurrentViewport = function ( target ) {\n\n\t\treturn target.copy( _currentViewport );\n\n\t};\n\n\tthis.getViewport = function ( target ) {\n\n\t\treturn target.copy( _viewport );\n\n\t};\n\n\tthis.setViewport = function ( x, y, width, height ) {\n\n\t\tif ( x.isVector4 ) {\n\n\t\t\t_viewport.set( x.x, x.y, x.z, x.w );\n\n\t\t} else {\n\n\t\t\t_viewport.set( x, y, width, height );\n\n\t\t}\n\n\t\tstate.viewport( _currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio ).floor() );\n\n\t};\n\n\tthis.getScissor = function ( target ) {\n\n\t\treturn target.copy( _scissor );\n\n\t};\n\n\tthis.setScissor = function ( x, y, width, height ) {\n\n\t\tif ( x.isVector4 ) {\n\n\t\t\t_scissor.set( x.x, x.y, x.z, x.w );\n\n\t\t} else {\n\n\t\t\t_scissor.set( x, y, width, height );\n\n\t\t}\n\n\t\tstate.scissor( _currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio ).floor() );\n\n\t};\n\n\tthis.getScissorTest = function () {\n\n\t\treturn _scissorTest;\n\n\t};\n\n\tthis.setScissorTest = function ( boolean ) {\n\n\t\tstate.setScissorTest( _scissorTest = boolean );\n\n\t};\n\n\tthis.setOpaqueSort = function ( method ) {\n\n\t\t_opaqueSort = method;\n\n\t};\n\n\tthis.setTransparentSort = function ( method ) {\n\n\t\t_transparentSort = method;\n\n\t};\n\n\t// Clearing\n\n\tthis.getClearColor = function ( target ) {\n\n\t\treturn target.copy( background.getClearColor() );\n\n\t};\n\n\tthis.setClearColor = function () {\n\n\t\tbackground.setClearColor.apply( background, arguments );\n\n\t};\n\n\tthis.getClearAlpha = function () {\n\n\t\treturn background.getClearAlpha();\n\n\t};\n\n\tthis.setClearAlpha = function () {\n\n\t\tbackground.setClearAlpha.apply( background, arguments );\n\n\t};\n\n\tthis.clear = function ( color, depth, stencil ) {\n\n\t\tlet bits = 0;\n\n\t\tif ( color === undefined || color ) bits |= 16384;\n\t\tif ( depth === undefined || depth ) bits |= 256;\n\t\tif ( stencil === undefined || stencil ) bits |= 1024;\n\n\t\t_gl.clear( bits );\n\n\t};\n\n\tthis.clearColor = function () {\n\n\t\tthis.clear( true, false, false );\n\n\t};\n\n\tthis.clearDepth = function () {\n\n\t\tthis.clear( false, true, false );\n\n\t};\n\n\tthis.clearStencil = function () {\n\n\t\tthis.clear( false, false, true );\n\n\t};\n\n\t//\n\n\tthis.dispose = function () {\n\n\t\t_canvas.removeEventListener( 'webglcontextlost', onContextLost, false );\n\t\t_canvas.removeEventListener( 'webglcontextrestored', onContextRestore, false );\n\n\t\trenderLists.dispose();\n\t\trenderStates.dispose();\n\t\tproperties.dispose();\n\t\tcubemaps.dispose();\n\t\tcubeuvmaps.dispose();\n\t\tobjects.dispose();\n\t\tbindingStates.dispose();\n\t\tprogramCache.dispose();\n\n\t\txr.dispose();\n\n\t\txr.removeEventListener( 'sessionstart', onXRSessionStart );\n\t\txr.removeEventListener( 'sessionend', onXRSessionEnd );\n\n\t\tif ( _transmissionRenderTarget ) {\n\n\t\t\t_transmissionRenderTarget.dispose();\n\t\t\t_transmissionRenderTarget = null;\n\n\t\t}\n\n\t\tanimation.stop();\n\n\t};\n\n\t// Events\n\n\tfunction onContextLost( event ) {\n\n\t\tevent.preventDefault();\n\n\t\tconsole.log( 'THREE.WebGLRenderer: Context Lost.' );\n\n\t\t_isContextLost = true;\n\n\t}\n\n\tfunction onContextRestore( /* event */ ) {\n\n\t\tconsole.log( 'THREE.WebGLRenderer: Context Restored.' );\n\n\t\t_isContextLost = false;\n\n\t\tconst infoAutoReset = info.autoReset;\n\t\tconst shadowMapEnabled = shadowMap.enabled;\n\t\tconst shadowMapAutoUpdate = shadowMap.autoUpdate;\n\t\tconst shadowMapNeedsUpdate = shadowMap.needsUpdate;\n\t\tconst shadowMapType = shadowMap.type;\n\n\t\tinitGLContext();\n\n\t\tinfo.autoReset = infoAutoReset;\n\t\tshadowMap.enabled = shadowMapEnabled;\n\t\tshadowMap.autoUpdate = shadowMapAutoUpdate;\n\t\tshadowMap.needsUpdate = shadowMapNeedsUpdate;\n\t\tshadowMap.type = shadowMapType;\n\n\t}\n\n\tfunction onMaterialDispose( event ) {\n\n\t\tconst material = event.target;\n\n\t\tmaterial.removeEventListener( 'dispose', onMaterialDispose );\n\n\t\tdeallocateMaterial( material );\n\n\t}\n\n\t// Buffer deallocation\n\n\tfunction deallocateMaterial( material ) {\n\n\t\treleaseMaterialProgramReferences( material );\n\n\t\tproperties.remove( material );\n\n\t}\n\n\n\tfunction releaseMaterialProgramReferences( material ) {\n\n\t\tconst programs = properties.get( material ).programs;\n\n\t\tif ( programs !== undefined ) {\n\n\t\t\tprograms.forEach( function ( program ) {\n\n\t\t\t\tprogramCache.releaseProgram( program );\n\n\t\t\t} );\n\n\t\t\tif ( material.isShaderMaterial ) {\n\n\t\t\t\tprogramCache.releaseShaderCache( material );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// Buffer rendering\n\n\tthis.renderBufferDirect = function ( camera, scene, geometry, material, object, group ) {\n\n\t\tif ( scene === null ) scene = _emptyScene; // renderBufferDirect second parameter used to be fog (could be null)\n\n\t\tconst frontFaceCW = ( object.isMesh && object.matrixWorld.determinant() < 0 );\n\n\t\tconst program = setProgram( camera, scene, geometry, material, object );\n\n\t\tstate.setMaterial( material, frontFaceCW );\n\n\t\t//\n\n\t\tlet index = geometry.index;\n\t\tconst position = geometry.attributes.position;\n\n\t\t//\n\n\t\tif ( index === null ) {\n\n\t\t\tif ( position === undefined || position.count === 0 ) return;\n\n\t\t} else if ( index.count === 0 ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t//\n\n\t\tlet rangeFactor = 1;\n\n\t\tif ( material.wireframe === true ) {\n\n\t\t\tindex = geometries.getWireframeAttribute( geometry );\n\t\t\trangeFactor = 2;\n\n\t\t}\n\n\t\tbindingStates.setup( object, material, program, geometry, index );\n\n\t\tlet attribute;\n\t\tlet renderer = bufferRenderer;\n\n\t\tif ( index !== null ) {\n\n\t\t\tattribute = attributes.get( index );\n\n\t\t\trenderer = indexedBufferRenderer;\n\t\t\trenderer.setIndex( attribute );\n\n\t\t}\n\n\t\t//\n\n\t\tconst dataCount = ( index !== null ) ? index.count : position.count;\n\n\t\tconst rangeStart = geometry.drawRange.start * rangeFactor;\n\t\tconst rangeCount = geometry.drawRange.count * rangeFactor;\n\n\t\tconst groupStart = group !== null ? group.start * rangeFactor : 0;\n\t\tconst groupCount = group !== null ? group.count * rangeFactor : Infinity;\n\n\t\tconst drawStart = Math.max( rangeStart, groupStart );\n\t\tconst drawEnd = Math.min( dataCount, rangeStart + rangeCount, groupStart + groupCount ) - 1;\n\n\t\tconst drawCount = Math.max( 0, drawEnd - drawStart + 1 );\n\n\t\tif ( drawCount === 0 ) return;\n\n\t\t//\n\n\t\tif ( object.isMesh ) {\n\n\t\t\tif ( material.wireframe === true ) {\n\n\t\t\t\tstate.setLineWidth( material.wireframeLinewidth * getTargetPixelRatio() );\n\t\t\t\trenderer.setMode( 1 );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setMode( 4 );\n\n\t\t\t}\n\n\t\t} else if ( object.isLine ) {\n\n\t\t\tlet lineWidth = material.linewidth;\n\n\t\t\tif ( lineWidth === undefined ) lineWidth = 1; // Not using Line*Material\n\n\t\t\tstate.setLineWidth( lineWidth * getTargetPixelRatio() );\n\n\t\t\tif ( object.isLineSegments ) {\n\n\t\t\t\trenderer.setMode( 1 );\n\n\t\t\t} else if ( object.isLineLoop ) {\n\n\t\t\t\trenderer.setMode( 2 );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setMode( 3 );\n\n\t\t\t}\n\n\t\t} else if ( object.isPoints ) {\n\n\t\t\trenderer.setMode( 0 );\n\n\t\t} else if ( object.isSprite ) {\n\n\t\t\trenderer.setMode( 4 );\n\n\t\t}\n\n\t\tif ( object.isInstancedMesh ) {\n\n\t\t\trenderer.renderInstances( drawStart, drawCount, object.count );\n\n\t\t} else if ( geometry.isInstancedBufferGeometry ) {\n\n\t\t\tconst instanceCount = Math.min( geometry.instanceCount, geometry._maxInstanceCount );\n\n\t\t\trenderer.renderInstances( drawStart, drawCount, instanceCount );\n\n\t\t} else {\n\n\t\t\trenderer.render( drawStart, drawCount );\n\n\t\t}\n\n\t};\n\n\t// Compile\n\n\tthis.compile = function ( scene, camera ) {\n\n\t\tcurrentRenderState = renderStates.get( scene );\n\t\tcurrentRenderState.init();\n\n\t\trenderStateStack.push( currentRenderState );\n\n\t\tscene.traverseVisible( function ( object ) {\n\n\t\t\tif ( object.isLight && object.layers.test( camera.layers ) ) {\n\n\t\t\t\tcurrentRenderState.pushLight( object );\n\n\t\t\t\tif ( object.castShadow ) {\n\n\t\t\t\t\tcurrentRenderState.pushShadow( object );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t\tcurrentRenderState.setupLights( _this.physicallyCorrectLights );\n\n\t\tscene.traverse( function ( object ) {\n\n\t\t\tconst material = object.material;\n\n\t\t\tif ( material ) {\n\n\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\tfor ( let i = 0; i < material.length; i ++ ) {\n\n\t\t\t\t\t\tconst material2 = material[ i ];\n\n\t\t\t\t\t\tgetProgram( material2, scene, object );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tgetProgram( material, scene, object );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t\trenderStateStack.pop();\n\t\tcurrentRenderState = null;\n\n\t};\n\n\t// Animation Loop\n\n\tlet onAnimationFrameCallback = null;\n\n\tfunction onAnimationFrame( time ) {\n\n\t\tif ( onAnimationFrameCallback ) onAnimationFrameCallback( time );\n\n\t}\n\n\tfunction onXRSessionStart() {\n\n\t\tanimation.stop();\n\n\t}\n\n\tfunction onXRSessionEnd() {\n\n\t\tanimation.start();\n\n\t}\n\n\tconst animation = new WebGLAnimation();\n\tanimation.setAnimationLoop( onAnimationFrame );\n\n\tif ( typeof window !== 'undefined' ) animation.setContext( window );\n\n\tthis.setAnimationLoop = function ( callback ) {\n\n\t\tonAnimationFrameCallback = callback;\n\t\txr.setAnimationLoop( callback );\n\n\t\t( callback === null ) ? animation.stop() : animation.start();\n\n\t};\n\n\txr.addEventListener( 'sessionstart', onXRSessionStart );\n\txr.addEventListener( 'sessionend', onXRSessionEnd );\n\n\t// Rendering\n\n\tthis.render = function ( scene, camera ) {\n\n\t\tif ( camera !== undefined && camera.isCamera !== true ) {\n\n\t\t\tconsole.error( 'THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( _isContextLost === true ) return;\n\n\t\t// update scene graph\n\n\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\n\n\t\t// update camera matrices and frustum\n\n\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\tif ( xr.enabled === true && xr.isPresenting === true ) {\n\n\t\t\tif ( xr.cameraAutoUpdate === true ) xr.updateCamera( camera );\n\n\t\t\tcamera = xr.getCamera(); // use XR camera for rendering\n\n\t\t}\n\n\t\t//\n\t\tif ( scene.isScene === true ) scene.onBeforeRender( _this, scene, camera, _currentRenderTarget );\n\n\t\tcurrentRenderState = renderStates.get( scene, renderStateStack.length );\n\t\tcurrentRenderState.init();\n\n\t\trenderStateStack.push( currentRenderState );\n\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\n\t\t_frustum.setFromProjectionMatrix( _projScreenMatrix );\n\n\t\t_localClippingEnabled = this.localClippingEnabled;\n\t\t_clippingEnabled = clipping.init( this.clippingPlanes, _localClippingEnabled, camera );\n\n\t\tcurrentRenderList = renderLists.get( scene, renderListStack.length );\n\t\tcurrentRenderList.init();\n\n\t\trenderListStack.push( currentRenderList );\n\n\t\tprojectObject( scene, camera, 0, _this.sortObjects );\n\n\t\tcurrentRenderList.finish();\n\n\t\tif ( _this.sortObjects === true ) {\n\n\t\t\tcurrentRenderList.sort( _opaqueSort, _transparentSort );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( _clippingEnabled === true ) clipping.beginShadows();\n\n\t\tconst shadowsArray = currentRenderState.state.shadowsArray;\n\n\t\tshadowMap.render( shadowsArray, scene, camera );\n\n\t\tif ( _clippingEnabled === true ) clipping.endShadows();\n\n\t\t//\n\n\t\tif ( this.info.autoReset === true ) this.info.reset();\n\n\t\t//\n\n\t\tbackground.render( currentRenderList, scene );\n\n\t\t// render scene\n\n\t\tcurrentRenderState.setupLights( _this.physicallyCorrectLights );\n\n\t\tif ( camera.isArrayCamera ) {\n\n\t\t\tconst cameras = camera.cameras;\n\n\t\t\tfor ( let i = 0, l = cameras.length; i < l; i ++ ) {\n\n\t\t\t\tconst camera2 = cameras[ i ];\n\n\t\t\t\trenderScene( currentRenderList, scene, camera2, camera2.viewport );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\trenderScene( currentRenderList, scene, camera );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( _currentRenderTarget !== null ) {\n\n\t\t\t// resolve multisample renderbuffers to a single-sample texture if necessary\n\n\t\t\ttextures.updateMultisampleRenderTarget( _currentRenderTarget );\n\n\t\t\t// Generate mipmap if we're using any kind of mipmap filtering\n\n\t\t\ttextures.updateRenderTargetMipmap( _currentRenderTarget );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( scene.isScene === true ) scene.onAfterRender( _this, scene, camera );\n\n\t\t// Ensure depth buffer writing is enabled so it can be cleared on next render\n\n\t\tstate.buffers.depth.setTest( true );\n\t\tstate.buffers.depth.setMask( true );\n\t\tstate.buffers.color.setMask( true );\n\n\t\tstate.setPolygonOffset( false );\n\n\t\t// _gl.finish();\n\n\t\tbindingStates.resetDefaultState();\n\t\t_currentMaterialId = - 1;\n\t\t_currentCamera = null;\n\n\t\trenderStateStack.pop();\n\n\t\tif ( renderStateStack.length > 0 ) {\n\n\t\t\tcurrentRenderState = renderStateStack[ renderStateStack.length - 1 ];\n\n\t\t} else {\n\n\t\t\tcurrentRenderState = null;\n\n\t\t}\n\n\t\trenderListStack.pop();\n\n\t\tif ( renderListStack.length > 0 ) {\n\n\t\t\tcurrentRenderList = renderListStack[ renderListStack.length - 1 ];\n\n\t\t} else {\n\n\t\t\tcurrentRenderList = null;\n\n\t\t}\n\n\t};\n\n\tfunction projectObject( object, camera, groupOrder, sortObjects ) {\n\n\t\tif ( object.visible === false ) return;\n\n\t\tconst visible = object.layers.test( camera.layers );\n\n\t\tif ( visible ) {\n\n\t\t\tif ( object.isGroup ) {\n\n\t\t\t\tgroupOrder = object.renderOrder;\n\n\t\t\t} else if ( object.isLOD ) {\n\n\t\t\t\tif ( object.autoUpdate === true ) object.update( camera );\n\n\t\t\t} else if ( object.isLight ) {\n\n\t\t\t\tcurrentRenderState.pushLight( object );\n\n\t\t\t\tif ( object.castShadow ) {\n\n\t\t\t\t\tcurrentRenderState.pushShadow( object );\n\n\t\t\t\t}\n\n\t\t\t} else if ( object.isSprite ) {\n\n\t\t\t\tif ( ! object.frustumCulled || _frustum.intersectsSprite( object ) ) {\n\n\t\t\t\t\tif ( sortObjects ) {\n\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld )\n\t\t\t\t\t\t\t.applyMatrix4( _projScreenMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst geometry = objects.update( object );\n\t\t\t\t\tconst material = object.material;\n\n\t\t\t\t\tif ( material.visible ) {\n\n\t\t\t\t\t\tcurrentRenderList.push( object, geometry, material, groupOrder, _vector3.z, null );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( object.isMesh || object.isLine || object.isPoints ) {\n\n\t\t\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\t\t\t// update skeleton only once in a frame\n\n\t\t\t\t\tif ( object.skeleton.frame !== info.render.frame ) {\n\n\t\t\t\t\t\tobject.skeleton.update();\n\t\t\t\t\t\tobject.skeleton.frame = info.render.frame;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( ! object.frustumCulled || _frustum.intersectsObject( object ) ) {\n\n\t\t\t\t\tif ( sortObjects ) {\n\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld )\n\t\t\t\t\t\t\t.applyMatrix4( _projScreenMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst geometry = objects.update( object );\n\t\t\t\t\tconst material = object.material;\n\n\t\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\t\tconst groups = geometry.groups;\n\n\t\t\t\t\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\t\t\tif ( groupMaterial && groupMaterial.visible ) {\n\n\t\t\t\t\t\t\t\tcurrentRenderList.push( object, geometry, groupMaterial, groupOrder, _vector3.z, group );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( material.visible ) {\n\n\t\t\t\t\t\tcurrentRenderList.push( object, geometry, material, groupOrder, _vector3.z, null );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tprojectObject( children[ i ], camera, groupOrder, sortObjects );\n\n\t\t}\n\n\t}\n\n\tfunction renderScene( currentRenderList, scene, camera, viewport ) {\n\n\t\tconst opaqueObjects = currentRenderList.opaque;\n\t\tconst transmissiveObjects = currentRenderList.transmissive;\n\t\tconst transparentObjects = currentRenderList.transparent;\n\n\t\tcurrentRenderState.setupLightsView( camera );\n\n\t\tif ( transmissiveObjects.length > 0 ) renderTransmissionPass( opaqueObjects, scene, camera );\n\n\t\tif ( viewport ) state.viewport( _currentViewport.copy( viewport ) );\n\n\t\tif ( opaqueObjects.length > 0 ) renderObjects( opaqueObjects, scene, camera );\n\t\tif ( transmissiveObjects.length > 0 ) renderObjects( transmissiveObjects, scene, camera );\n\t\tif ( transparentObjects.length > 0 ) renderObjects( transparentObjects, scene, camera );\n\n\t}\n\n\tfunction renderTransmissionPass( opaqueObjects, scene, camera ) {\n\n\t\tif ( _transmissionRenderTarget === null ) {\n\n\t\t\tconst needsAntialias = _antialias === true && capabilities.isWebGL2 === true;\n\t\t\tconst renderTargetType = needsAntialias ? WebGLMultisampleRenderTarget : WebGLRenderTarget;\n\n\t\t\t_transmissionRenderTarget = new renderTargetType( 1024, 1024, {\n\t\t\t\tgenerateMipmaps: true,\n\t\t\t\ttype: utils.convert( HalfFloatType ) !== null ? HalfFloatType : UnsignedByteType,\n\t\t\t\tminFilter: LinearMipmapLinearFilter,\n\t\t\t\tmagFilter: NearestFilter,\n\t\t\t\twrapS: ClampToEdgeWrapping,\n\t\t\t\twrapT: ClampToEdgeWrapping,\n\t\t\t\tuseRenderToTexture: extensions.has( 'WEBGL_multisampled_render_to_texture' )\n\t\t\t} );\n\n\t\t}\n\n\t\tconst currentRenderTarget = _this.getRenderTarget();\n\t\t_this.setRenderTarget( _transmissionRenderTarget );\n\t\t_this.clear();\n\n\t\t// Turn off the features which can affect the frag color for opaque objects pass.\n\t\t// Otherwise they are applied twice in opaque objects pass and transmission objects pass.\n\t\tconst currentToneMapping = _this.toneMapping;\n\t\t_this.toneMapping = NoToneMapping;\n\n\t\trenderObjects( opaqueObjects, scene, camera );\n\n\t\t_this.toneMapping = currentToneMapping;\n\n\t\ttextures.updateMultisampleRenderTarget( _transmissionRenderTarget );\n\t\ttextures.updateRenderTargetMipmap( _transmissionRenderTarget );\n\n\t\t_this.setRenderTarget( currentRenderTarget );\n\n\t}\n\n\tfunction renderObjects( renderList, scene, camera ) {\n\n\t\tconst overrideMaterial = scene.isScene === true ? scene.overrideMaterial : null;\n\n\t\tfor ( let i = 0, l = renderList.length; i < l; i ++ ) {\n\n\t\t\tconst renderItem = renderList[ i ];\n\n\t\t\tconst object = renderItem.object;\n\t\t\tconst geometry = renderItem.geometry;\n\t\t\tconst material = overrideMaterial === null ? renderItem.material : overrideMaterial;\n\t\t\tconst group = renderItem.group;\n\n\t\t\tif ( object.layers.test( camera.layers ) ) {\n\n\t\t\t\trenderObject( object, scene, camera, geometry, material, group );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction renderObject( object, scene, camera, geometry, material, group ) {\n\n\t\tobject.onBeforeRender( _this, scene, camera, geometry, material, group );\n\n\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\n\t\tobject.normalMatrix.getNormalMatrix( object.modelViewMatrix );\n\n\t\tmaterial.onBeforeRender( _this, scene, camera, geometry, object, group );\n\n\t\tif ( material.transparent === true && material.side === DoubleSide ) {\n\n\t\t\tmaterial.side = BackSide;\n\t\t\tmaterial.needsUpdate = true;\n\t\t\t_this.renderBufferDirect( camera, scene, geometry, material, object, group );\n\n\t\t\tmaterial.side = FrontSide;\n\t\t\tmaterial.needsUpdate = true;\n\t\t\t_this.renderBufferDirect( camera, scene, geometry, material, object, group );\n\n\t\t\tmaterial.side = DoubleSide;\n\n\t\t} else {\n\n\t\t\t_this.renderBufferDirect( camera, scene, geometry, material, object, group );\n\n\t\t}\n\n\t\tobject.onAfterRender( _this, scene, camera, geometry, material, group );\n\n\t}\n\n\tfunction getProgram( material, scene, object ) {\n\n\t\tif ( scene.isScene !== true ) scene = _emptyScene; // scene could be a Mesh, Line, Points, ...\n\n\t\tconst materialProperties = properties.get( material );\n\n\t\tconst lights = currentRenderState.state.lights;\n\t\tconst shadowsArray = currentRenderState.state.shadowsArray;\n\n\t\tconst lightsStateVersion = lights.state.version;\n\n\t\tconst parameters = programCache.getParameters( material, lights.state, shadowsArray, scene, object );\n\t\tconst programCacheKey = programCache.getProgramCacheKey( parameters );\n\n\t\tlet programs = materialProperties.programs;\n\n\t\t// always update environment and fog - changing these trigger an getProgram call, but it's possible that the program doesn't change\n\n\t\tmaterialProperties.environment = material.isMeshStandardMaterial ? scene.environment : null;\n\t\tmaterialProperties.fog = scene.fog;\n\t\tmaterialProperties.envMap = ( material.isMeshStandardMaterial ? cubeuvmaps : cubemaps ).get( material.envMap || materialProperties.environment );\n\n\t\tif ( programs === undefined ) {\n\n\t\t\t// new material\n\n\t\t\tmaterial.addEventListener( 'dispose', onMaterialDispose );\n\n\t\t\tprograms = new Map();\n\t\t\tmaterialProperties.programs = programs;\n\n\t\t}\n\n\t\tlet program = programs.get( programCacheKey );\n\n\t\tif ( program !== undefined ) {\n\n\t\t\t// early out if program and light state is identical\n\n\t\t\tif ( materialProperties.currentProgram === program && materialProperties.lightsStateVersion === lightsStateVersion ) {\n\n\t\t\t\tupdateCommonMaterialProperties( material, parameters );\n\n\t\t\t\treturn program;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tparameters.uniforms = programCache.getUniforms( material );\n\n\t\t\tmaterial.onBuild( object, parameters, _this );\n\n\t\t\tmaterial.onBeforeCompile( parameters, _this );\n\n\t\t\tprogram = programCache.acquireProgram( parameters, programCacheKey );\n\t\t\tprograms.set( programCacheKey, program );\n\n\t\t\tmaterialProperties.uniforms = parameters.uniforms;\n\n\t\t}\n\n\t\tconst uniforms = materialProperties.uniforms;\n\n\t\tif ( ( ! material.isShaderMaterial && ! material.isRawShaderMaterial ) || material.clipping === true ) {\n\n\t\t\tuniforms.clippingPlanes = clipping.uniform;\n\n\t\t}\n\n\t\tupdateCommonMaterialProperties( material, parameters );\n\n\t\t// store the light setup it was created for\n\n\t\tmaterialProperties.needsLights = materialNeedsLights( material );\n\t\tmaterialProperties.lightsStateVersion = lightsStateVersion;\n\n\t\tif ( materialProperties.needsLights ) {\n\n\t\t\t// wire up the material to this renderer's lighting state\n\n\t\t\tuniforms.ambientLightColor.value = lights.state.ambient;\n\t\t\tuniforms.lightProbe.value = lights.state.probe;\n\t\t\tuniforms.directionalLights.value = lights.state.directional;\n\t\t\tuniforms.directionalLightShadows.value = lights.state.directionalShadow;\n\t\t\tuniforms.spotLights.value = lights.state.spot;\n\t\t\tuniforms.spotLightShadows.value = lights.state.spotShadow;\n\t\t\tuniforms.rectAreaLights.value = lights.state.rectArea;\n\t\t\tuniforms.ltc_1.value = lights.state.rectAreaLTC1;\n\t\t\tuniforms.ltc_2.value = lights.state.rectAreaLTC2;\n\t\t\tuniforms.pointLights.value = lights.state.point;\n\t\t\tuniforms.pointLightShadows.value = lights.state.pointShadow;\n\t\t\tuniforms.hemisphereLights.value = lights.state.hemi;\n\n\t\t\tuniforms.directionalShadowMap.value = lights.state.directionalShadowMap;\n\t\t\tuniforms.directionalShadowMatrix.value = lights.state.directionalShadowMatrix;\n\t\t\tuniforms.spotShadowMap.value = lights.state.spotShadowMap;\n\t\t\tuniforms.spotShadowMatrix.value = lights.state.spotShadowMatrix;\n\t\t\tuniforms.pointShadowMap.value = lights.state.pointShadowMap;\n\t\t\tuniforms.pointShadowMatrix.value = lights.state.pointShadowMatrix;\n\t\t\t// TODO (abelnation): add area lights shadow info to uniforms\n\n\t\t}\n\n\t\tconst progUniforms = program.getUniforms();\n\t\tconst uniformsList = WebGLUniforms.seqWithValue( progUniforms.seq, uniforms );\n\n\t\tmaterialProperties.currentProgram = program;\n\t\tmaterialProperties.uniformsList = uniformsList;\n\n\t\treturn program;\n\n\t}\n\n\tfunction updateCommonMaterialProperties( material, parameters ) {\n\n\t\tconst materialProperties = properties.get( material );\n\n\t\tmaterialProperties.outputEncoding = parameters.outputEncoding;\n\t\tmaterialProperties.instancing = parameters.instancing;\n\t\tmaterialProperties.skinning = parameters.skinning;\n\t\tmaterialProperties.morphTargets = parameters.morphTargets;\n\t\tmaterialProperties.morphNormals = parameters.morphNormals;\n\t\tmaterialProperties.morphTargetsCount = parameters.morphTargetsCount;\n\t\tmaterialProperties.numClippingPlanes = parameters.numClippingPlanes;\n\t\tmaterialProperties.numIntersection = parameters.numClipIntersection;\n\t\tmaterialProperties.vertexAlphas = parameters.vertexAlphas;\n\t\tmaterialProperties.vertexTangents = parameters.vertexTangents;\n\t\tmaterialProperties.toneMapping = parameters.toneMapping;\n\n\t}\n\n\tfunction setProgram( camera, scene, geometry, material, object ) {\n\n\t\tif ( scene.isScene !== true ) scene = _emptyScene; // scene could be a Mesh, Line, Points, ...\n\n\t\ttextures.resetTextureUnits();\n\n\t\tconst fog = scene.fog;\n\t\tconst environment = material.isMeshStandardMaterial ? scene.environment : null;\n\t\tconst encoding = ( _currentRenderTarget === null ) ? _this.outputEncoding : ( _currentRenderTarget.isXRRenderTarget === true ? _currentRenderTarget.texture.encoding : LinearEncoding );\n\t\tconst envMap = ( material.isMeshStandardMaterial ? cubeuvmaps : cubemaps ).get( material.envMap || environment );\n\t\tconst vertexAlphas = material.vertexColors === true && !! geometry.attributes.color && geometry.attributes.color.itemSize === 4;\n\t\tconst vertexTangents = !! material.normalMap && !! geometry.attributes.tangent;\n\t\tconst morphTargets = !! geometry.morphAttributes.position;\n\t\tconst morphNormals = !! geometry.morphAttributes.normal;\n\t\tconst morphTargetsCount = !! geometry.morphAttributes.position ? geometry.morphAttributes.position.length : 0;\n\t\tconst toneMapping = material.toneMapped ? _this.toneMapping : NoToneMapping;\n\n\t\tconst materialProperties = properties.get( material );\n\t\tconst lights = currentRenderState.state.lights;\n\n\t\tif ( _clippingEnabled === true ) {\n\n\t\t\tif ( _localClippingEnabled === true || camera !== _currentCamera ) {\n\n\t\t\t\tconst useCache =\n\t\t\t\t\tcamera === _currentCamera &&\n\t\t\t\t\tmaterial.id === _currentMaterialId;\n\n\t\t\t\t// we might want to call this function with some ClippingGroup\n\t\t\t\t// object instead of the material, once it becomes feasible\n\t\t\t\t// (#8465, #8379)\n\t\t\t\tclipping.setState( material, camera, useCache );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tlet needsProgramChange = false;\n\n\t\tif ( material.version === materialProperties.__version ) {\n\n\t\t\tif ( materialProperties.needsLights && ( materialProperties.lightsStateVersion !== lights.state.version ) ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.outputEncoding !== encoding ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( object.isInstancedMesh && materialProperties.instancing === false ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( ! object.isInstancedMesh && materialProperties.instancing === true ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( object.isSkinnedMesh && materialProperties.skinning === false ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( ! object.isSkinnedMesh && materialProperties.skinning === true ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.envMap !== envMap ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( material.fog && materialProperties.fog !== fog ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.numClippingPlanes !== undefined &&\n\t\t\t\t( materialProperties.numClippingPlanes !== clipping.numPlanes ||\n\t\t\t\tmaterialProperties.numIntersection !== clipping.numIntersection ) ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.vertexAlphas !== vertexAlphas ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.vertexTangents !== vertexTangents ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.morphTargets !== morphTargets ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.morphNormals !== morphNormals ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.toneMapping !== toneMapping ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( capabilities.isWebGL2 === true && materialProperties.morphTargetsCount !== morphTargetsCount ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tneedsProgramChange = true;\n\t\t\tmaterialProperties.__version = material.version;\n\n\t\t}\n\n\t\t//\n\n\t\tlet program = materialProperties.currentProgram;\n\n\t\tif ( needsProgramChange === true ) {\n\n\t\t\tprogram = getProgram( material, scene, object );\n\n\t\t}\n\n\t\tlet refreshProgram = false;\n\t\tlet refreshMaterial = false;\n\t\tlet refreshLights = false;\n\n\t\tconst p_uniforms = program.getUniforms(),\n\t\t\tm_uniforms = materialProperties.uniforms;\n\n\t\tif ( state.useProgram( program.program ) ) {\n\n\t\t\trefreshProgram = true;\n\t\t\trefreshMaterial = true;\n\t\t\trefreshLights = true;\n\n\t\t}\n\n\t\tif ( material.id !== _currentMaterialId ) {\n\n\t\t\t_currentMaterialId = material.id;\n\n\t\t\trefreshMaterial = true;\n\n\t\t}\n\n\t\tif ( refreshProgram || _currentCamera !== camera ) {\n\n\t\t\tp_uniforms.setValue( _gl, 'projectionMatrix', camera.projectionMatrix );\n\n\t\t\tif ( capabilities.logarithmicDepthBuffer ) {\n\n\t\t\t\tp_uniforms.setValue( _gl, 'logDepthBufFC',\n\t\t\t\t\t2.0 / ( Math.log( camera.far + 1.0 ) / Math.LN2 ) );\n\n\t\t\t}\n\n\t\t\tif ( _currentCamera !== camera ) {\n\n\t\t\t\t_currentCamera = camera;\n\n\t\t\t\t// lighting uniforms depend on the camera so enforce an update\n\t\t\t\t// now, in case this material supports lights - or later, when\n\t\t\t\t// the next material that does gets activated:\n\n\t\t\t\trefreshMaterial = true;\t\t// set to true on material change\n\t\t\t\trefreshLights = true;\t\t// remains set until update done\n\n\t\t\t}\n\n\t\t\t// load material specific uniforms\n\t\t\t// (shader material also gets them for the sake of genericity)\n\n\t\t\tif ( material.isShaderMaterial ||\n\t\t\t\tmaterial.isMeshPhongMaterial ||\n\t\t\t\tmaterial.isMeshToonMaterial ||\n\t\t\t\tmaterial.isMeshStandardMaterial ||\n\t\t\t\tmaterial.envMap ) {\n\n\t\t\t\tconst uCamPos = p_uniforms.map.cameraPosition;\n\n\t\t\t\tif ( uCamPos !== undefined ) {\n\n\t\t\t\t\tuCamPos.setValue( _gl,\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( camera.matrixWorld ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( material.isMeshPhongMaterial ||\n\t\t\t\tmaterial.isMeshToonMaterial ||\n\t\t\t\tmaterial.isMeshLambertMaterial ||\n\t\t\t\tmaterial.isMeshBasicMaterial ||\n\t\t\t\tmaterial.isMeshStandardMaterial ||\n\t\t\t\tmaterial.isShaderMaterial ) {\n\n\t\t\t\tp_uniforms.setValue( _gl, 'isOrthographic', camera.isOrthographicCamera === true );\n\n\t\t\t}\n\n\t\t\tif ( material.isMeshPhongMaterial ||\n\t\t\t\tmaterial.isMeshToonMaterial ||\n\t\t\t\tmaterial.isMeshLambertMaterial ||\n\t\t\t\tmaterial.isMeshBasicMaterial ||\n\t\t\t\tmaterial.isMeshStandardMaterial ||\n\t\t\t\tmaterial.isShaderMaterial ||\n\t\t\t\tmaterial.isShadowMaterial ||\n\t\t\t\tobject.isSkinnedMesh ) {\n\n\t\t\t\tp_uniforms.setValue( _gl, 'viewMatrix', camera.matrixWorldInverse );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// skinning and morph target uniforms must be set even if material didn't change\n\t\t// auto-setting of texture unit for bone and morph texture must go before other textures\n\t\t// otherwise textures used for skinning and morphing can take over texture units reserved for other material textures\n\n\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrix' );\n\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrixInverse' );\n\n\t\t\tconst skeleton = object.skeleton;\n\n\t\t\tif ( skeleton ) {\n\n\t\t\t\tif ( capabilities.floatVertexTextures ) {\n\n\t\t\t\t\tif ( skeleton.boneTexture === null ) skeleton.computeBoneTexture();\n\n\t\t\t\t\tp_uniforms.setValue( _gl, 'boneTexture', skeleton.boneTexture, textures );\n\t\t\t\t\tp_uniforms.setValue( _gl, 'boneTextureSize', skeleton.boneTextureSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tp_uniforms.setOptional( _gl, skeleton, 'boneMatrices' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( !! geometry && ( geometry.morphAttributes.position !== undefined || geometry.morphAttributes.normal !== undefined ) ) {\n\n\t\t\tmorphtargets.update( object, geometry, material, program );\n\n\t\t}\n\n\n\t\tif ( refreshMaterial || materialProperties.receiveShadow !== object.receiveShadow ) {\n\n\t\t\tmaterialProperties.receiveShadow = object.receiveShadow;\n\t\t\tp_uniforms.setValue( _gl, 'receiveShadow', object.receiveShadow );\n\n\t\t}\n\n\t\tif ( refreshMaterial ) {\n\n\t\t\tp_uniforms.setValue( _gl, 'toneMappingExposure', _this.toneMappingExposure );\n\n\t\t\tif ( materialProperties.needsLights ) {\n\n\t\t\t\t// the current material requires lighting info\n\n\t\t\t\t// note: all lighting uniforms are always set correctly\n\t\t\t\t// they simply reference the renderer's state for their\n\t\t\t\t// values\n\t\t\t\t//\n\t\t\t\t// use the current material's .needsUpdate flags to set\n\t\t\t\t// the GL state when required\n\n\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, refreshLights );\n\n\t\t\t}\n\n\t\t\t// refresh uniforms common to several materials\n\n\t\t\tif ( fog && material.fog ) {\n\n\t\t\t\tmaterials.refreshFogUniforms( m_uniforms, fog );\n\n\t\t\t}\n\n\t\t\tmaterials.refreshMaterialUniforms( m_uniforms, material, _pixelRatio, _height, _transmissionRenderTarget );\n\n\t\t\tWebGLUniforms.upload( _gl, materialProperties.uniformsList, m_uniforms, textures );\n\n\t\t}\n\n\t\tif ( material.isShaderMaterial && material.uniformsNeedUpdate === true ) {\n\n\t\t\tWebGLUniforms.upload( _gl, materialProperties.uniformsList, m_uniforms, textures );\n\t\t\tmaterial.uniformsNeedUpdate = false;\n\n\t\t}\n\n\t\tif ( material.isSpriteMaterial ) {\n\n\t\t\tp_uniforms.setValue( _gl, 'center', object.center );\n\n\t\t}\n\n\t\t// common matrices\n\n\t\tp_uniforms.setValue( _gl, 'modelViewMatrix', object.modelViewMatrix );\n\t\tp_uniforms.setValue( _gl, 'normalMatrix', object.normalMatrix );\n\t\tp_uniforms.setValue( _gl, 'modelMatrix', object.matrixWorld );\n\n\t\treturn program;\n\n\t}\n\n\t// If uniforms are marked as clean, they don't need to be loaded to the GPU.\n\n\tfunction markUniformsLightsNeedsUpdate( uniforms, value ) {\n\n\t\tuniforms.ambientLightColor.needsUpdate = value;\n\t\tuniforms.lightProbe.needsUpdate = value;\n\n\t\tuniforms.directionalLights.needsUpdate = value;\n\t\tuniforms.directionalLightShadows.needsUpdate = value;\n\t\tuniforms.pointLights.needsUpdate = value;\n\t\tuniforms.pointLightShadows.needsUpdate = value;\n\t\tuniforms.spotLights.needsUpdate = value;\n\t\tuniforms.spotLightShadows.needsUpdate = value;\n\t\tuniforms.rectAreaLights.needsUpdate = value;\n\t\tuniforms.hemisphereLights.needsUpdate = value;\n\n\t}\n\n\tfunction materialNeedsLights( material ) {\n\n\t\treturn material.isMeshLambertMaterial || material.isMeshToonMaterial || material.isMeshPhongMaterial ||\n\t\t\tmaterial.isMeshStandardMaterial || material.isShadowMaterial ||\n\t\t\t( material.isShaderMaterial && material.lights === true );\n\n\t}\n\n\tthis.getActiveCubeFace = function () {\n\n\t\treturn _currentActiveCubeFace;\n\n\t};\n\n\tthis.getActiveMipmapLevel = function () {\n\n\t\treturn _currentActiveMipmapLevel;\n\n\t};\n\n\tthis.getRenderTarget = function () {\n\n\t\treturn _currentRenderTarget;\n\n\t};\n\n\tthis.setRenderTargetTextures = function ( renderTarget, colorTexture, depthTexture ) {\n\n\t\tproperties.get( renderTarget.texture ).__webglTexture = colorTexture;\n\t\tproperties.get( renderTarget.depthTexture ).__webglTexture = depthTexture;\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\t\trenderTargetProperties.__hasExternalTextures = true;\n\n\t\tif ( renderTargetProperties.__hasExternalTextures ) {\n\n\t\t\trenderTargetProperties.__autoAllocateDepthBuffer = depthTexture === undefined;\n\n\t\t\tif ( ! renderTargetProperties.__autoAllocateDepthBuffer ) {\n\n\t\t\t\t// The multisample_render_to_texture extension doesn't work properly if there\n\t\t\t\t// are midframe flushes and an external depth buffer. Disable use of the extension.\n\t\t\t\tif ( renderTarget.useRenderToTexture ) {\n\n\t\t\t\t\tconsole.warn( 'render-to-texture extension was disabled because an external texture was provided' );\n\t\t\t\t\trenderTarget.useRenderToTexture = false;\n\t\t\t\t\trenderTarget.useRenderbuffer = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.setRenderTargetFramebuffer = function ( renderTarget, defaultFramebuffer ) {\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\t\trenderTargetProperties.__webglFramebuffer = defaultFramebuffer;\n\t\trenderTargetProperties.__useDefaultFramebuffer = defaultFramebuffer === undefined;\n\n\t};\n\n\tthis.setRenderTarget = function ( renderTarget, activeCubeFace = 0, activeMipmapLevel = 0 ) {\n\n\t\t_currentRenderTarget = renderTarget;\n\t\t_currentActiveCubeFace = activeCubeFace;\n\t\t_currentActiveMipmapLevel = activeMipmapLevel;\n\t\tlet useDefaultFramebuffer = true;\n\n\t\tif ( renderTarget ) {\n\n\t\t\tconst renderTargetProperties = properties.get( renderTarget );\n\n\t\t\tif ( renderTargetProperties.__useDefaultFramebuffer !== undefined ) {\n\n\t\t\t\t// We need to make sure to rebind the framebuffer.\n\t\t\t\tstate.bindFramebuffer( 36160, null );\n\t\t\t\tuseDefaultFramebuffer = false;\n\n\t\t\t} else if ( renderTargetProperties.__webglFramebuffer === undefined ) {\n\n\t\t\t\ttextures.setupRenderTarget( renderTarget );\n\n\t\t\t} else if ( renderTargetProperties.__hasExternalTextures ) {\n\n\t\t\t\t// Color and depth texture must be rebound in order for the swapchain to update.\n\t\t\t\ttextures.rebindTextures( renderTarget, properties.get( renderTarget.texture ).__webglTexture, properties.get( renderTarget.depthTexture ).__webglTexture );\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet framebuffer = null;\n\t\tlet isCube = false;\n\t\tlet isRenderTarget3D = false;\n\n\t\tif ( renderTarget ) {\n\n\t\t\tconst texture = renderTarget.texture;\n\n\t\t\tif ( texture.isDataTexture3D || texture.isDataTexture2DArray ) {\n\n\t\t\t\tisRenderTarget3D = true;\n\n\t\t\t}\n\n\t\t\tconst __webglFramebuffer = properties.get( renderTarget ).__webglFramebuffer;\n\n\t\t\tif ( renderTarget.isWebGLCubeRenderTarget ) {\n\n\t\t\t\tframebuffer = __webglFramebuffer[ activeCubeFace ];\n\t\t\t\tisCube = true;\n\n\t\t\t} else if ( renderTarget.useRenderbuffer ) {\n\n\t\t\t\tframebuffer = properties.get( renderTarget ).__webglMultisampledFramebuffer;\n\n\t\t\t} else {\n\n\t\t\t\tframebuffer = __webglFramebuffer;\n\n\t\t\t}\n\n\t\t\t_currentViewport.copy( renderTarget.viewport );\n\t\t\t_currentScissor.copy( renderTarget.scissor );\n\t\t\t_currentScissorTest = renderTarget.scissorTest;\n\n\t\t} else {\n\n\t\t\t_currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio ).floor();\n\t\t\t_currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio ).floor();\n\t\t\t_currentScissorTest = _scissorTest;\n\n\t\t}\n\n\t\tconst framebufferBound = state.bindFramebuffer( 36160, framebuffer );\n\n\t\tif ( framebufferBound && capabilities.drawBuffers && useDefaultFramebuffer ) {\n\n\t\t\tstate.drawBuffers( renderTarget, framebuffer );\n\n\t\t}\n\n\t\tstate.viewport( _currentViewport );\n\t\tstate.scissor( _currentScissor );\n\t\tstate.setScissorTest( _currentScissorTest );\n\n\t\tif ( isCube ) {\n\n\t\t\tconst textureProperties = properties.get( renderTarget.texture );\n\t\t\t_gl.framebufferTexture2D( 36160, 36064, 34069 + activeCubeFace, textureProperties.__webglTexture, activeMipmapLevel );\n\n\t\t} else if ( isRenderTarget3D ) {\n\n\t\t\tconst textureProperties = properties.get( renderTarget.texture );\n\t\t\tconst layer = activeCubeFace || 0;\n\t\t\t_gl.framebufferTextureLayer( 36160, 36064, textureProperties.__webglTexture, activeMipmapLevel || 0, layer );\n\n\t\t}\n\n\t\t_currentMaterialId = - 1; // reset current material to ensure correct uniform bindings\n\n\t};\n\n\tthis.readRenderTargetPixels = function ( renderTarget, x, y, width, height, buffer, activeCubeFaceIndex ) {\n\n\t\tif ( ! ( renderTarget && renderTarget.isWebGLRenderTarget ) ) {\n\n\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tlet framebuffer = properties.get( renderTarget ).__webglFramebuffer;\n\n\t\tif ( renderTarget.isWebGLCubeRenderTarget && activeCubeFaceIndex !== undefined ) {\n\n\t\t\tframebuffer = framebuffer[ activeCubeFaceIndex ];\n\n\t\t}\n\n\t\tif ( framebuffer ) {\n\n\t\t\tstate.bindFramebuffer( 36160, framebuffer );\n\n\t\t\ttry {\n\n\t\t\t\tconst texture = renderTarget.texture;\n\t\t\t\tconst textureFormat = texture.format;\n\t\t\t\tconst textureType = texture.type;\n\n\t\t\t\tif ( textureFormat !== RGBAFormat && utils.convert( textureFormat ) !== _gl.getParameter( 35739 ) ) {\n\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.' );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tconst halfFloatSupportedByExt = ( textureType === HalfFloatType ) && ( extensions.has( 'EXT_color_buffer_half_float' ) || ( capabilities.isWebGL2 && extensions.has( 'EXT_color_buffer_float' ) ) );\n\n\t\t\t\tif ( textureType !== UnsignedByteType && utils.convert( textureType ) !== _gl.getParameter( 35738 ) && // Edge and Chrome Mac < 52 (#9513)\n\t\t\t\t\t! ( textureType === FloatType && ( capabilities.isWebGL2 || extensions.has( 'OES_texture_float' ) || extensions.has( 'WEBGL_color_buffer_float' ) ) ) && // Chrome Mac >= 52 and Firefox\n\t\t\t\t\t! halfFloatSupportedByExt ) {\n\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.' );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( _gl.checkFramebufferStatus( 36160 ) === 36053 ) {\n\n\t\t\t\t\t// the following if statement ensures valid read requests (no out-of-bounds pixels, see #8604)\n\n\t\t\t\t\tif ( ( x >= 0 && x <= ( renderTarget.width - width ) ) && ( y >= 0 && y <= ( renderTarget.height - height ) ) ) {\n\n\t\t\t\t\t\t_gl.readPixels( x, y, width, height, utils.convert( textureFormat ), utils.convert( textureType ), buffer );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.' );\n\n\t\t\t\t}\n\n\t\t\t} finally {\n\n\t\t\t\t// restore framebuffer of current render target if necessary\n\n\t\t\t\tconst framebuffer = ( _currentRenderTarget !== null ) ? properties.get( _currentRenderTarget ).__webglFramebuffer : null;\n\t\t\t\tstate.bindFramebuffer( 36160, framebuffer );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.copyFramebufferToTexture = function ( position, texture, level = 0 ) {\n\n\t\tif ( texture.isFramebufferTexture !== true ) {\n\n\t\t\tconsole.error( 'THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst levelScale = Math.pow( 2, - level );\n\t\tconst width = Math.floor( texture.image.width * levelScale );\n\t\tconst height = Math.floor( texture.image.height * levelScale );\n\n\t\ttextures.setTexture2D( texture, 0 );\n\n\t\t_gl.copyTexSubImage2D( 3553, level, 0, 0, position.x, position.y, width, height );\n\n\t\tstate.unbindTexture();\n\n\t};\n\n\tthis.copyTextureToTexture = function ( position, srcTexture, dstTexture, level = 0 ) {\n\n\t\tconst width = srcTexture.image.width;\n\t\tconst height = srcTexture.image.height;\n\t\tconst glFormat = utils.convert( dstTexture.format );\n\t\tconst glType = utils.convert( dstTexture.type );\n\n\t\ttextures.setTexture2D( dstTexture, 0 );\n\n\t\t// As another texture upload may have changed pixelStorei\n\t\t// parameters, make sure they are correct for the dstTexture\n\t\t_gl.pixelStorei( 37440, dstTexture.flipY );\n\t\t_gl.pixelStorei( 37441, dstTexture.premultiplyAlpha );\n\t\t_gl.pixelStorei( 3317, dstTexture.unpackAlignment );\n\n\t\tif ( srcTexture.isDataTexture ) {\n\n\t\t\t_gl.texSubImage2D( 3553, level, position.x, position.y, width, height, glFormat, glType, srcTexture.image.data );\n\n\t\t} else {\n\n\t\t\tif ( srcTexture.isCompressedTexture ) {\n\n\t\t\t\t_gl.compressedTexSubImage2D( 3553, level, position.x, position.y, srcTexture.mipmaps[ 0 ].width, srcTexture.mipmaps[ 0 ].height, glFormat, srcTexture.mipmaps[ 0 ].data );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.texSubImage2D( 3553, level, position.x, position.y, glFormat, glType, srcTexture.image );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Generate mipmaps only when copying level 0\n\t\tif ( level === 0 && dstTexture.generateMipmaps ) _gl.generateMipmap( 3553 );\n\n\t\tstate.unbindTexture();\n\n\t};\n\n\tthis.copyTextureToTexture3D = function ( sourceBox, position, srcTexture, dstTexture, level = 0 ) {\n\n\t\tif ( _this.isWebGL1Renderer ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst width = sourceBox.max.x - sourceBox.min.x + 1;\n\t\tconst height = sourceBox.max.y - sourceBox.min.y + 1;\n\t\tconst depth = sourceBox.max.z - sourceBox.min.z + 1;\n\t\tconst glFormat = utils.convert( dstTexture.format );\n\t\tconst glType = utils.convert( dstTexture.type );\n\t\tlet glTarget;\n\n\t\tif ( dstTexture.isDataTexture3D ) {\n\n\t\t\ttextures.setTexture3D( dstTexture, 0 );\n\t\t\tglTarget = 32879;\n\n\t\t} else if ( dstTexture.isDataTexture2DArray ) {\n\n\t\t\ttextures.setTexture2DArray( dstTexture, 0 );\n\t\t\tglTarget = 35866;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\t_gl.pixelStorei( 37440, dstTexture.flipY );\n\t\t_gl.pixelStorei( 37441, dstTexture.premultiplyAlpha );\n\t\t_gl.pixelStorei( 3317, dstTexture.unpackAlignment );\n\n\t\tconst unpackRowLen = _gl.getParameter( 3314 );\n\t\tconst unpackImageHeight = _gl.getParameter( 32878 );\n\t\tconst unpackSkipPixels = _gl.getParameter( 3316 );\n\t\tconst unpackSkipRows = _gl.getParameter( 3315 );\n\t\tconst unpackSkipImages = _gl.getParameter( 32877 );\n\n\t\tconst image = srcTexture.isCompressedTexture ? srcTexture.mipmaps[ 0 ] : srcTexture.image;\n\n\t\t_gl.pixelStorei( 3314, image.width );\n\t\t_gl.pixelStorei( 32878, image.height );\n\t\t_gl.pixelStorei( 3316, sourceBox.min.x );\n\t\t_gl.pixelStorei( 3315, sourceBox.min.y );\n\t\t_gl.pixelStorei( 32877, sourceBox.min.z );\n\n\t\tif ( srcTexture.isDataTexture || srcTexture.isDataTexture3D ) {\n\n\t\t\t_gl.texSubImage3D( glTarget, level, position.x, position.y, position.z, width, height, depth, glFormat, glType, image.data );\n\n\t\t} else {\n\n\t\t\tif ( srcTexture.isCompressedTexture ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture.' );\n\t\t\t\t_gl.compressedTexSubImage3D( glTarget, level, position.x, position.y, position.z, width, height, depth, glFormat, image.data );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.texSubImage3D( glTarget, level, position.x, position.y, position.z, width, height, depth, glFormat, glType, image );\n\n\t\t\t}\n\n\t\t}\n\n\t\t_gl.pixelStorei( 3314, unpackRowLen );\n\t\t_gl.pixelStorei( 32878, unpackImageHeight );\n\t\t_gl.pixelStorei( 3316, unpackSkipPixels );\n\t\t_gl.pixelStorei( 3315, unpackSkipRows );\n\t\t_gl.pixelStorei( 32877, unpackSkipImages );\n\n\t\t// Generate mipmaps only when copying level 0\n\t\tif ( level === 0 && dstTexture.generateMipmaps ) _gl.generateMipmap( glTarget );\n\n\t\tstate.unbindTexture();\n\n\t};\n\n\tthis.initTexture = function ( texture ) {\n\n\t\ttextures.setTexture2D( texture, 0 );\n\n\t\tstate.unbindTexture();\n\n\t};\n\n\tthis.resetState = function () {\n\n\t\t_currentActiveCubeFace = 0;\n\t\t_currentActiveMipmapLevel = 0;\n\t\t_currentRenderTarget = null;\n\n\t\tstate.reset();\n\t\tbindingStates.reset();\n\n\t};\n\n\tif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\n\n\t\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'observe', { detail: this } ) );\n\n\t}\n\n}\n\nWebGLRenderer.prototype.isWebGLRenderer = true;\n\nclass WebGL1Renderer extends WebGLRenderer {}\n\nWebGL1Renderer.prototype.isWebGL1Renderer = true;\n\nclass FogExp2 {\n\n\tconstructor( color, density = 0.00025 ) {\n\n\t\tthis.name = '';\n\n\t\tthis.color = new Color( color );\n\t\tthis.density = density;\n\n\t}\n\n\tclone() {\n\n\t\treturn new FogExp2( this.color, this.density );\n\n\t}\n\n\ttoJSON( /* meta */ ) {\n\n\t\treturn {\n\t\t\ttype: 'FogExp2',\n\t\t\tcolor: this.color.getHex(),\n\t\t\tdensity: this.density\n\t\t};\n\n\t}\n\n}\n\nFogExp2.prototype.isFogExp2 = true;\n\nclass Fog {\n\n\tconstructor( color, near = 1, far = 1000 ) {\n\n\t\tthis.name = '';\n\n\t\tthis.color = new Color( color );\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\n\t}\n\n\tclone() {\n\n\t\treturn new Fog( this.color, this.near, this.far );\n\n\t}\n\n\ttoJSON( /* meta */ ) {\n\n\t\treturn {\n\t\t\ttype: 'Fog',\n\t\t\tcolor: this.color.getHex(),\n\t\t\tnear: this.near,\n\t\t\tfar: this.far\n\t\t};\n\n\t}\n\n}\n\nFog.prototype.isFog = true;\n\nclass Scene extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'Scene';\n\n\t\tthis.background = null;\n\t\tthis.environment = null;\n\t\tthis.fog = null;\n\n\t\tthis.overrideMaterial = null;\n\n\t\tthis.autoUpdate = true; // checked by the renderer\n\n\t\tif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\n\n\t\t\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'observe', { detail: this } ) );\n\n\t\t}\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tif ( source.background !== null ) this.background = source.background.clone();\n\t\tif ( source.environment !== null ) this.environment = source.environment.clone();\n\t\tif ( source.fog !== null ) this.fog = source.fog.clone();\n\n\t\tif ( source.overrideMaterial !== null ) this.overrideMaterial = source.overrideMaterial.clone();\n\n\t\tthis.autoUpdate = source.autoUpdate;\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tif ( this.fog !== null ) data.object.fog = this.fog.toJSON();\n\n\t\treturn data;\n\n\t}\n\n}\n\nScene.prototype.isScene = true;\n\nclass InterleavedBuffer {\n\n\tconstructor( array, stride ) {\n\n\t\tthis.array = array;\n\t\tthis.stride = stride;\n\t\tthis.count = array !== undefined ? array.length / stride : 0;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.updateRange = { offset: 0, count: - 1 };\n\n\t\tthis.version = 0;\n\n\t\tthis.uuid = generateUUID();\n\n\t}\n\n\tonUploadCallback() {}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.count = source.count;\n\t\tthis.stride = source.stride;\n\t\tthis.usage = source.usage;\n\n\t\treturn this;\n\n\t}\n\n\tcopyAt( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.stride;\n\t\tindex2 *= attribute.stride;\n\n\t\tfor ( let i = 0, l = this.stride; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tset( value, offset = 0 ) {\n\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tif ( data.arrayBuffers === undefined ) {\n\n\t\t\tdata.arrayBuffers = {};\n\n\t\t}\n\n\t\tif ( this.array.buffer._uuid === undefined ) {\n\n\t\t\tthis.array.buffer._uuid = generateUUID();\n\n\t\t}\n\n\t\tif ( data.arrayBuffers[ this.array.buffer._uuid ] === undefined ) {\n\n\t\t\tdata.arrayBuffers[ this.array.buffer._uuid ] = this.array.slice( 0 ).buffer;\n\n\t\t}\n\n\t\tconst array = new this.array.constructor( data.arrayBuffers[ this.array.buffer._uuid ] );\n\n\t\tconst ib = new this.constructor( array, this.stride );\n\t\tib.setUsage( this.usage );\n\n\t\treturn ib;\n\n\t}\n\n\tonUpload( callback ) {\n\n\t\tthis.onUploadCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tif ( data.arrayBuffers === undefined ) {\n\n\t\t\tdata.arrayBuffers = {};\n\n\t\t}\n\n\t\t// generate UUID for array buffer if necessary\n\n\t\tif ( this.array.buffer._uuid === undefined ) {\n\n\t\t\tthis.array.buffer._uuid = generateUUID();\n\n\t\t}\n\n\t\tif ( data.arrayBuffers[ this.array.buffer._uuid ] === undefined ) {\n\n\t\t\tdata.arrayBuffers[ this.array.buffer._uuid ] = Array.prototype.slice.call( new Uint32Array( this.array.buffer ) );\n\n\t\t}\n\n\t\t//\n\n\t\treturn {\n\t\t\tuuid: this.uuid,\n\t\t\tbuffer: this.array.buffer._uuid,\n\t\t\ttype: this.array.constructor.name,\n\t\t\tstride: this.stride\n\t\t};\n\n\t}\n\n}\n\nInterleavedBuffer.prototype.isInterleavedBuffer = true;\n\nconst _vector$6 = /*@__PURE__*/ new Vector3();\n\nclass InterleavedBufferAttribute {\n\n\tconstructor( interleavedBuffer, itemSize, offset, normalized = false ) {\n\n\t\tthis.name = '';\n\n\t\tthis.data = interleavedBuffer;\n\t\tthis.itemSize = itemSize;\n\t\tthis.offset = offset;\n\n\t\tthis.normalized = normalized === true;\n\n\t}\n\n\tget count() {\n\n\t\treturn this.data.count;\n\n\t}\n\n\tget array() {\n\n\t\treturn this.data.array;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tthis.data.needsUpdate = value;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tfor ( let i = 0, l = this.data.count; i < l; i ++ ) {\n\n\t\t\t_vector$6.x = this.getX( i );\n\t\t\t_vector$6.y = this.getY( i );\n\t\t\t_vector$6.z = this.getZ( i );\n\n\t\t\t_vector$6.applyMatrix4( m );\n\n\t\t\tthis.setXYZ( i, _vector$6.x, _vector$6.y, _vector$6.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$6.x = this.getX( i );\n\t\t\t_vector$6.y = this.getY( i );\n\t\t\t_vector$6.z = this.getZ( i );\n\n\t\t\t_vector$6.applyNormalMatrix( m );\n\n\t\t\tthis.setXYZ( i, _vector$6.x, _vector$6.y, _vector$6.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$6.x = this.getX( i );\n\t\t\t_vector$6.y = this.getY( i );\n\t\t\t_vector$6.z = this.getZ( i );\n\n\t\t\t_vector$6.transformDirection( m );\n\n\t\t\tthis.setXYZ( i, _vector$6.x, _vector$6.y, _vector$6.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetX( index, x ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( index, y ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( index, z ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetW( index, w ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tgetX( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset ];\n\n\t}\n\n\tgetY( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 1 ];\n\n\t}\n\n\tgetZ( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 2 ];\n\n\t}\n\n\tgetW( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 3 ];\n\n\t}\n\n\tsetXY( index, x, y ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZ( index, x, y, z ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZW( index, x, y, z, w ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\t\tthis.data.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconsole.log( 'THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.' );\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0; i < this.count; i ++ ) {\n\n\t\t\t\tconst index = i * this.data.stride + this.offset;\n\n\t\t\t\tfor ( let j = 0; j < this.itemSize; j ++ ) {\n\n\t\t\t\t\tarray.push( this.data.array[ index + j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new BufferAttribute( new this.array.constructor( array ), this.itemSize, this.normalized );\n\n\t\t} else {\n\n\t\t\tif ( data.interleavedBuffers === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers = {};\n\n\t\t\t}\n\n\t\t\tif ( data.interleavedBuffers[ this.data.uuid ] === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers[ this.data.uuid ] = this.data.clone( data );\n\n\t\t\t}\n\n\t\t\treturn new InterleavedBufferAttribute( data.interleavedBuffers[ this.data.uuid ], this.itemSize, this.offset, this.normalized );\n\n\t\t}\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconsole.log( 'THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.' );\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0; i < this.count; i ++ ) {\n\n\t\t\t\tconst index = i * this.data.stride + this.offset;\n\n\t\t\t\tfor ( let j = 0; j < this.itemSize; j ++ ) {\n\n\t\t\t\t\tarray.push( this.data.array[ index + j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// deinterleave data and save it as an ordinary buffer attribute for now\n\n\t\t\treturn {\n\t\t\t\titemSize: this.itemSize,\n\t\t\t\ttype: this.array.constructor.name,\n\t\t\t\tarray: array,\n\t\t\t\tnormalized: this.normalized\n\t\t\t};\n\n\t\t} else {\n\n\t\t\t// save as true interlaved attribtue\n\n\t\t\tif ( data.interleavedBuffers === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers = {};\n\n\t\t\t}\n\n\t\t\tif ( data.interleavedBuffers[ this.data.uuid ] === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers[ this.data.uuid ] = this.data.toJSON( data );\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tisInterleavedBufferAttribute: true,\n\t\t\t\titemSize: this.itemSize,\n\t\t\t\tdata: this.data.uuid,\n\t\t\t\toffset: this.offset,\n\t\t\t\tnormalized: this.normalized\n\t\t\t};\n\n\t\t}\n\n\t}\n\n}\n\nInterleavedBufferAttribute.prototype.isInterleavedBufferAttribute = true;\n\n/**\n * parameters = {\n *  color: <hex>,\n *  map: new THREE.Texture( <Image> ),\n *  alphaMap: new THREE.Texture( <Image> ),\n *  rotation: <float>,\n *  sizeAttenuation: <bool>\n * }\n */\n\nclass SpriteMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'SpriteMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.rotation = 0;\n\n\t\tthis.sizeAttenuation = true;\n\n\t\tthis.transparent = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.rotation = source.rotation;\n\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\n\n\t\treturn this;\n\n\t}\n\n}\n\nSpriteMaterial.prototype.isSpriteMaterial = true;\n\nlet _geometry;\n\nconst _intersectPoint = /*@__PURE__*/ new Vector3();\nconst _worldScale = /*@__PURE__*/ new Vector3();\nconst _mvPosition = /*@__PURE__*/ new Vector3();\n\nconst _alignedPosition = /*@__PURE__*/ new Vector2();\nconst _rotatedPosition = /*@__PURE__*/ new Vector2();\nconst _viewWorldMatrix = /*@__PURE__*/ new Matrix4();\n\nconst _vA = /*@__PURE__*/ new Vector3();\nconst _vB = /*@__PURE__*/ new Vector3();\nconst _vC = /*@__PURE__*/ new Vector3();\n\nconst _uvA = /*@__PURE__*/ new Vector2();\nconst _uvB = /*@__PURE__*/ new Vector2();\nconst _uvC = /*@__PURE__*/ new Vector2();\n\nclass Sprite extends Object3D {\n\n\tconstructor( material ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Sprite';\n\n\t\tif ( _geometry === undefined ) {\n\n\t\t\t_geometry = new BufferGeometry();\n\n\t\t\tconst float32Array = new Float32Array( [\n\t\t\t\t- 0.5, - 0.5, 0, 0, 0,\n\t\t\t\t0.5, - 0.5, 0, 1, 0,\n\t\t\t\t0.5, 0.5, 0, 1, 1,\n\t\t\t\t- 0.5, 0.5, 0, 0, 1\n\t\t\t] );\n\n\t\t\tconst interleavedBuffer = new InterleavedBuffer( float32Array, 5 );\n\n\t\t\t_geometry.setIndex( [ 0, 1, 2,\t0, 2, 3 ] );\n\t\t\t_geometry.setAttribute( 'position', new InterleavedBufferAttribute( interleavedBuffer, 3, 0, false ) );\n\t\t\t_geometry.setAttribute( 'uv', new InterleavedBufferAttribute( interleavedBuffer, 2, 3, false ) );\n\n\t\t}\n\n\t\tthis.geometry = _geometry;\n\t\tthis.material = ( material !== undefined ) ? material : new SpriteMaterial();\n\n\t\tthis.center = new Vector2( 0.5, 0.5 );\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tif ( raycaster.camera === null ) {\n\n\t\t\tconsole.error( 'THREE.Sprite: \"Raycaster.camera\" needs to be set in order to raycast against sprites.' );\n\n\t\t}\n\n\t\t_worldScale.setFromMatrixScale( this.matrixWorld );\n\n\t\t_viewWorldMatrix.copy( raycaster.camera.matrixWorld );\n\t\tthis.modelViewMatrix.multiplyMatrices( raycaster.camera.matrixWorldInverse, this.matrixWorld );\n\n\t\t_mvPosition.setFromMatrixPosition( this.modelViewMatrix );\n\n\t\tif ( raycaster.camera.isPerspectiveCamera && this.material.sizeAttenuation === false ) {\n\n\t\t\t_worldScale.multiplyScalar( - _mvPosition.z );\n\n\t\t}\n\n\t\tconst rotation = this.material.rotation;\n\t\tlet sin, cos;\n\n\t\tif ( rotation !== 0 ) {\n\n\t\t\tcos = Math.cos( rotation );\n\t\t\tsin = Math.sin( rotation );\n\n\t\t}\n\n\t\tconst center = this.center;\n\n\t\ttransformVertex( _vA.set( - 0.5, - 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\t\ttransformVertex( _vB.set( 0.5, - 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\t\ttransformVertex( _vC.set( 0.5, 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\n\t\t_uvA.set( 0, 0 );\n\t\t_uvB.set( 1, 0 );\n\t\t_uvC.set( 1, 1 );\n\n\t\t// check first triangle\n\t\tlet intersect = raycaster.ray.intersectTriangle( _vA, _vB, _vC, false, _intersectPoint );\n\n\t\tif ( intersect === null ) {\n\n\t\t\t// check second triangle\n\t\t\ttransformVertex( _vB.set( - 0.5, 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\t\t\t_uvB.set( 0, 1 );\n\n\t\t\tintersect = raycaster.ray.intersectTriangle( _vA, _vC, _vB, false, _intersectPoint );\n\t\t\tif ( intersect === null ) {\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst distance = raycaster.ray.origin.distanceTo( _intersectPoint );\n\n\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\t\tintersects.push( {\n\n\t\t\tdistance: distance,\n\t\t\tpoint: _intersectPoint.clone(),\n\t\t\tuv: Triangle.getUV( _intersectPoint, _vA, _vB, _vC, _uvA, _uvB, _uvC, new Vector2() ),\n\t\t\tface: null,\n\t\t\tobject: this\n\n\t\t} );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tif ( source.center !== undefined ) this.center.copy( source.center );\n\n\t\tthis.material = source.material;\n\n\t\treturn this;\n\n\t}\n\n}\n\nSprite.prototype.isSprite = true;\n\nfunction transformVertex( vertexPosition, mvPosition, center, scale, sin, cos ) {\n\n\t// compute position in camera space\n\t_alignedPosition.subVectors( vertexPosition, center ).addScalar( 0.5 ).multiply( scale );\n\n\t// to check if rotation is not zero\n\tif ( sin !== undefined ) {\n\n\t\t_rotatedPosition.x = ( cos * _alignedPosition.x ) - ( sin * _alignedPosition.y );\n\t\t_rotatedPosition.y = ( sin * _alignedPosition.x ) + ( cos * _alignedPosition.y );\n\n\t} else {\n\n\t\t_rotatedPosition.copy( _alignedPosition );\n\n\t}\n\n\n\tvertexPosition.copy( mvPosition );\n\tvertexPosition.x += _rotatedPosition.x;\n\tvertexPosition.y += _rotatedPosition.y;\n\n\t// transform to world space\n\tvertexPosition.applyMatrix4( _viewWorldMatrix );\n\n}\n\nconst _v1$2 = /*@__PURE__*/ new Vector3();\nconst _v2$1 = /*@__PURE__*/ new Vector3();\n\nclass LOD extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis._currentLevel = 0;\n\n\t\tthis.type = 'LOD';\n\n\t\tObject.defineProperties( this, {\n\t\t\tlevels: {\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: []\n\t\t\t},\n\t\t\tisLOD: {\n\t\t\t\tvalue: true,\n\t\t\t}\n\t\t} );\n\n\t\tthis.autoUpdate = true;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source, false );\n\n\t\tconst levels = source.levels;\n\n\t\tfor ( let i = 0, l = levels.length; i < l; i ++ ) {\n\n\t\t\tconst level = levels[ i ];\n\n\t\t\tthis.addLevel( level.object.clone(), level.distance );\n\n\t\t}\n\n\t\tthis.autoUpdate = source.autoUpdate;\n\n\t\treturn this;\n\n\t}\n\n\taddLevel( object, distance = 0 ) {\n\n\t\tdistance = Math.abs( distance );\n\n\t\tconst levels = this.levels;\n\n\t\tlet l;\n\n\t\tfor ( l = 0; l < levels.length; l ++ ) {\n\n\t\t\tif ( distance < levels[ l ].distance ) {\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tlevels.splice( l, 0, { distance: distance, object: object } );\n\n\t\tthis.add( object );\n\n\t\treturn this;\n\n\t}\n\n\tgetCurrentLevel() {\n\n\t\treturn this._currentLevel;\n\n\t}\n\n\tgetObjectForDistance( distance ) {\n\n\t\tconst levels = this.levels;\n\n\t\tif ( levels.length > 0 ) {\n\n\t\t\tlet i, l;\n\n\t\t\tfor ( i = 1, l = levels.length; i < l; i ++ ) {\n\n\t\t\t\tif ( distance < levels[ i ].distance ) {\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn levels[ i - 1 ].object;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst levels = this.levels;\n\n\t\tif ( levels.length > 0 ) {\n\n\t\t\t_v1$2.setFromMatrixPosition( this.matrixWorld );\n\n\t\t\tconst distance = raycaster.ray.origin.distanceTo( _v1$2 );\n\n\t\t\tthis.getObjectForDistance( distance ).raycast( raycaster, intersects );\n\n\t\t}\n\n\t}\n\n\tupdate( camera ) {\n\n\t\tconst levels = this.levels;\n\n\t\tif ( levels.length > 1 ) {\n\n\t\t\t_v1$2.setFromMatrixPosition( camera.matrixWorld );\n\t\t\t_v2$1.setFromMatrixPosition( this.matrixWorld );\n\n\t\t\tconst distance = _v1$2.distanceTo( _v2$1 ) / camera.zoom;\n\n\t\t\tlevels[ 0 ].object.visible = true;\n\n\t\t\tlet i, l;\n\n\t\t\tfor ( i = 1, l = levels.length; i < l; i ++ ) {\n\n\t\t\t\tif ( distance >= levels[ i ].distance ) {\n\n\t\t\t\t\tlevels[ i - 1 ].object.visible = false;\n\t\t\t\t\tlevels[ i ].object.visible = true;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._currentLevel = i - 1;\n\n\t\t\tfor ( ; i < l; i ++ ) {\n\n\t\t\t\tlevels[ i ].object.visible = false;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tif ( this.autoUpdate === false ) data.object.autoUpdate = false;\n\n\t\tdata.object.levels = [];\n\n\t\tconst levels = this.levels;\n\n\t\tfor ( let i = 0, l = levels.length; i < l; i ++ ) {\n\n\t\t\tconst level = levels[ i ];\n\n\t\t\tdata.object.levels.push( {\n\t\t\t\tobject: level.object.uuid,\n\t\t\t\tdistance: level.distance\n\t\t\t} );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n}\n\nconst _basePosition = /*@__PURE__*/ new Vector3();\n\nconst _skinIndex = /*@__PURE__*/ new Vector4();\nconst _skinWeight = /*@__PURE__*/ new Vector4();\n\nconst _vector$5 = /*@__PURE__*/ new Vector3();\nconst _matrix = /*@__PURE__*/ new Matrix4();\n\nclass SkinnedMesh extends Mesh {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'SkinnedMesh';\n\n\t\tthis.bindMode = 'attached';\n\t\tthis.bindMatrix = new Matrix4();\n\t\tthis.bindMatrixInverse = new Matrix4();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.bindMode = source.bindMode;\n\t\tthis.bindMatrix.copy( source.bindMatrix );\n\t\tthis.bindMatrixInverse.copy( source.bindMatrixInverse );\n\n\t\tthis.skeleton = source.skeleton;\n\n\t\treturn this;\n\n\t}\n\n\tbind( skeleton, bindMatrix ) {\n\n\t\tthis.skeleton = skeleton;\n\n\t\tif ( bindMatrix === undefined ) {\n\n\t\t\tthis.updateMatrixWorld( true );\n\n\t\t\tthis.skeleton.calculateInverses();\n\n\t\t\tbindMatrix = this.matrixWorld;\n\n\t\t}\n\n\t\tthis.bindMatrix.copy( bindMatrix );\n\t\tthis.bindMatrixInverse.copy( bindMatrix ).invert();\n\n\t}\n\n\tpose() {\n\n\t\tthis.skeleton.pose();\n\n\t}\n\n\tnormalizeSkinWeights() {\n\n\t\tconst vector = new Vector4();\n\n\t\tconst skinWeight = this.geometry.attributes.skinWeight;\n\n\t\tfor ( let i = 0, l = skinWeight.count; i < l; i ++ ) {\n\n\t\t\tvector.x = skinWeight.getX( i );\n\t\t\tvector.y = skinWeight.getY( i );\n\t\t\tvector.z = skinWeight.getZ( i );\n\t\t\tvector.w = skinWeight.getW( i );\n\n\t\t\tconst scale = 1.0 / vector.manhattanLength();\n\n\t\t\tif ( scale !== Infinity ) {\n\n\t\t\t\tvector.multiplyScalar( scale );\n\n\t\t\t} else {\n\n\t\t\t\tvector.set( 1, 0, 0, 0 ); // do something reasonable\n\n\t\t\t}\n\n\t\t\tskinWeight.setXYZW( i, vector.x, vector.y, vector.z, vector.w );\n\n\t\t}\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tif ( this.bindMode === 'attached' ) {\n\n\t\t\tthis.bindMatrixInverse.copy( this.matrixWorld ).invert();\n\n\t\t} else if ( this.bindMode === 'detached' ) {\n\n\t\t\tthis.bindMatrixInverse.copy( this.bindMatrix ).invert();\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.SkinnedMesh: Unrecognized bindMode: ' + this.bindMode );\n\n\t\t}\n\n\t}\n\n\tboneTransform( index, target ) {\n\n\t\tconst skeleton = this.skeleton;\n\t\tconst geometry = this.geometry;\n\n\t\t_skinIndex.fromBufferAttribute( geometry.attributes.skinIndex, index );\n\t\t_skinWeight.fromBufferAttribute( geometry.attributes.skinWeight, index );\n\n\t\t_basePosition.copy( target ).applyMatrix4( this.bindMatrix );\n\n\t\ttarget.set( 0, 0, 0 );\n\n\t\tfor ( let i = 0; i < 4; i ++ ) {\n\n\t\t\tconst weight = _skinWeight.getComponent( i );\n\n\t\t\tif ( weight !== 0 ) {\n\n\t\t\t\tconst boneIndex = _skinIndex.getComponent( i );\n\n\t\t\t\t_matrix.multiplyMatrices( skeleton.bones[ boneIndex ].matrixWorld, skeleton.boneInverses[ boneIndex ] );\n\n\t\t\t\ttarget.addScaledVector( _vector$5.copy( _basePosition ).applyMatrix4( _matrix ), weight );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn target.applyMatrix4( this.bindMatrixInverse );\n\n\t}\n\n}\n\nSkinnedMesh.prototype.isSkinnedMesh = true;\n\nclass Bone extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'Bone';\n\n\t}\n\n}\n\nBone.prototype.isBone = true;\n\nclass DataTexture extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, format, type, mapping, wrapS, wrapT, magFilter = NearestFilter, minFilter = NearestFilter, anisotropy, encoding ) {\n\n\t\tsuper( null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\n\n\t\tthis.image = { data: data, width: width, height: height };\n\n\t\tthis.magFilter = magFilter;\n\t\tthis.minFilter = minFilter;\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t}\n\n}\n\nDataTexture.prototype.isDataTexture = true;\n\nconst _offsetMatrix = /*@__PURE__*/ new Matrix4();\nconst _identityMatrix = /*@__PURE__*/ new Matrix4();\n\nclass Skeleton {\n\n\tconstructor( bones = [], boneInverses = [] ) {\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.bones = bones.slice( 0 );\n\t\tthis.boneInverses = boneInverses;\n\t\tthis.boneMatrices = null;\n\n\t\tthis.boneTexture = null;\n\t\tthis.boneTextureSize = 0;\n\n\t\tthis.frame = - 1;\n\n\t\tthis.init();\n\n\t}\n\n\tinit() {\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\n\t\tthis.boneMatrices = new Float32Array( bones.length * 16 );\n\n\t\t// calculate inverse bone matrices if necessary\n\n\t\tif ( boneInverses.length === 0 ) {\n\n\t\t\tthis.calculateInverses();\n\n\t\t} else {\n\n\t\t\t// handle special case\n\n\t\t\tif ( bones.length !== boneInverses.length ) {\n\n\t\t\t\tconsole.warn( 'THREE.Skeleton: Number of inverse bone matrices does not match amount of bones.' );\n\n\t\t\t\tthis.boneInverses = [];\n\n\t\t\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\t\t\tthis.boneInverses.push( new Matrix4() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcalculateInverses() {\n\n\t\tthis.boneInverses.length = 0;\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst inverse = new Matrix4();\n\n\t\t\tif ( this.bones[ i ] ) {\n\n\t\t\t\tinverse.copy( this.bones[ i ].matrixWorld ).invert();\n\n\t\t\t}\n\n\t\t\tthis.boneInverses.push( inverse );\n\n\t\t}\n\n\t}\n\n\tpose() {\n\n\t\t// recover the bind-time world matrices\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone ) {\n\n\t\t\t\tbone.matrixWorld.copy( this.boneInverses[ i ] ).invert();\n\n\t\t\t}\n\n\t\t}\n\n\t\t// compute the local matrices, positions, rotations and scales\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone ) {\n\n\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t\tbone.matrix.copy( bone.parent.matrixWorld ).invert();\n\t\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbone.matrix.copy( bone.matrixWorld );\n\n\t\t\t\t}\n\n\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdate() {\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\t\tconst boneMatrices = this.boneMatrices;\n\t\tconst boneTexture = this.boneTexture;\n\n\t\t// flatten bone matrices to array\n\n\t\tfor ( let i = 0, il = bones.length; i < il; i ++ ) {\n\n\t\t\t// compute the offset between the current and the original transform\n\n\t\t\tconst matrix = bones[ i ] ? bones[ i ].matrixWorld : _identityMatrix;\n\n\t\t\t_offsetMatrix.multiplyMatrices( matrix, boneInverses[ i ] );\n\t\t\t_offsetMatrix.toArray( boneMatrices, i * 16 );\n\n\t\t}\n\n\t\tif ( boneTexture !== null ) {\n\n\t\t\tboneTexture.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new Skeleton( this.bones, this.boneInverses );\n\n\t}\n\n\tcomputeBoneTexture() {\n\n\t\t// layout (1 matrix = 4 pixels)\n\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\n\t\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\n\t\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\n\t\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\n\t\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\n\n\t\tlet size = Math.sqrt( this.bones.length * 4 ); // 4 pixels needed for 1 matrix\n\t\tsize = ceilPowerOfTwo( size );\n\t\tsize = Math.max( size, 4 );\n\n\t\tconst boneMatrices = new Float32Array( size * size * 4 ); // 4 floats per RGBA pixel\n\t\tboneMatrices.set( this.boneMatrices ); // copy current values\n\n\t\tconst boneTexture = new DataTexture( boneMatrices, size, size, RGBAFormat, FloatType );\n\t\tboneTexture.needsUpdate = true;\n\n\t\tthis.boneMatrices = boneMatrices;\n\t\tthis.boneTexture = boneTexture;\n\t\tthis.boneTextureSize = size;\n\n\t\treturn this;\n\n\t}\n\n\tgetBoneByName( name ) {\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone.name === name ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn undefined;\n\n\t}\n\n\tdispose( ) {\n\n\t\tif ( this.boneTexture !== null ) {\n\n\t\t\tthis.boneTexture.dispose();\n\n\t\t\tthis.boneTexture = null;\n\n\t\t}\n\n\t}\n\n\tfromJSON( json, bones ) {\n\n\t\tthis.uuid = json.uuid;\n\n\t\tfor ( let i = 0, l = json.bones.length; i < l; i ++ ) {\n\n\t\t\tconst uuid = json.bones[ i ];\n\t\t\tlet bone = bones[ uuid ];\n\n\t\t\tif ( bone === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Skeleton: No bone found with UUID:', uuid );\n\t\t\t\tbone = new Bone();\n\n\t\t\t}\n\n\t\t\tthis.bones.push( bone );\n\t\t\tthis.boneInverses.push( new Matrix4().fromArray( json.boneInverses[ i ] ) );\n\n\t\t}\n\n\t\tthis.init();\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Skeleton',\n\t\t\t\tgenerator: 'Skeleton.toJSON'\n\t\t\t},\n\t\t\tbones: [],\n\t\t\tboneInverses: []\n\t\t};\n\n\t\tdata.uuid = this.uuid;\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\n\t\tfor ( let i = 0, l = bones.length; i < l; i ++ ) {\n\n\t\t\tconst bone = bones[ i ];\n\t\t\tdata.bones.push( bone.uuid );\n\n\t\t\tconst boneInverse = boneInverses[ i ];\n\t\t\tdata.boneInverses.push( boneInverse.toArray() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass InstancedBufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized, meshPerAttribute = 1 ) {\n\n\t\tif ( typeof normalized === 'number' ) {\n\n\t\t\tmeshPerAttribute = normalized;\n\n\t\t\tnormalized = false;\n\n\t\t\tconsole.error( 'THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.' );\n\n\t\t}\n\n\t\tsuper( array, itemSize, normalized );\n\n\t\tthis.meshPerAttribute = meshPerAttribute;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.meshPerAttribute = source.meshPerAttribute;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.meshPerAttribute = this.meshPerAttribute;\n\n\t\tdata.isInstancedBufferAttribute = true;\n\n\t\treturn data;\n\n\t}\n\n}\n\nInstancedBufferAttribute.prototype.isInstancedBufferAttribute = true;\n\nconst _instanceLocalMatrix = /*@__PURE__*/ new Matrix4();\nconst _instanceWorldMatrix = /*@__PURE__*/ new Matrix4();\n\nconst _instanceIntersects = [];\n\nconst _mesh = /*@__PURE__*/ new Mesh();\n\nclass InstancedMesh extends Mesh {\n\n\tconstructor( geometry, material, count ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.instanceMatrix = new InstancedBufferAttribute( new Float32Array( count * 16 ), 16 );\n\t\tthis.instanceColor = null;\n\n\t\tthis.count = count;\n\n\t\tthis.frustumCulled = false;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.instanceMatrix.copy( source.instanceMatrix );\n\n\t\tif ( source.instanceColor !== null ) this.instanceColor = source.instanceColor.clone();\n\n\t\tthis.count = source.count;\n\n\t\treturn this;\n\n\t}\n\n\tgetColorAt( index, color ) {\n\n\t\tcolor.fromArray( this.instanceColor.array, index * 3 );\n\n\t}\n\n\tgetMatrixAt( index, matrix ) {\n\n\t\tmatrix.fromArray( this.instanceMatrix.array, index * 16 );\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst raycastTimes = this.count;\n\n\t\t_mesh.geometry = this.geometry;\n\t\t_mesh.material = this.material;\n\n\t\tif ( _mesh.material === undefined ) return;\n\n\t\tfor ( let instanceId = 0; instanceId < raycastTimes; instanceId ++ ) {\n\n\t\t\t// calculate the world matrix for each instance\n\n\t\t\tthis.getMatrixAt( instanceId, _instanceLocalMatrix );\n\n\t\t\t_instanceWorldMatrix.multiplyMatrices( matrixWorld, _instanceLocalMatrix );\n\n\t\t\t// the mesh represents this single instance\n\n\t\t\t_mesh.matrixWorld = _instanceWorldMatrix;\n\n\t\t\t_mesh.raycast( raycaster, _instanceIntersects );\n\n\t\t\t// process the result of raycast\n\n\t\t\tfor ( let i = 0, l = _instanceIntersects.length; i < l; i ++ ) {\n\n\t\t\t\tconst intersect = _instanceIntersects[ i ];\n\t\t\t\tintersect.instanceId = instanceId;\n\t\t\t\tintersect.object = this;\n\t\t\t\tintersects.push( intersect );\n\n\t\t\t}\n\n\t\t\t_instanceIntersects.length = 0;\n\n\t\t}\n\n\t}\n\n\tsetColorAt( index, color ) {\n\n\t\tif ( this.instanceColor === null ) {\n\n\t\t\tthis.instanceColor = new InstancedBufferAttribute( new Float32Array( this.instanceMatrix.count * 3 ), 3 );\n\n\t\t}\n\n\t\tcolor.toArray( this.instanceColor.array, index * 3 );\n\n\t}\n\n\tsetMatrixAt( index, matrix ) {\n\n\t\tmatrix.toArray( this.instanceMatrix.array, index * 16 );\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n}\n\nInstancedMesh.prototype.isInstancedMesh = true;\n\n/**\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *\n *  linewidth: <float>,\n *  linecap: \"round\",\n *  linejoin: \"round\"\n * }\n */\n\nclass LineBasicMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'LineBasicMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.linewidth = 1;\n\t\tthis.linecap = 'round';\n\t\tthis.linejoin = 'round';\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.linewidth = source.linewidth;\n\t\tthis.linecap = source.linecap;\n\t\tthis.linejoin = source.linejoin;\n\n\t\treturn this;\n\n\t}\n\n}\n\nLineBasicMaterial.prototype.isLineBasicMaterial = true;\n\nconst _start$1 = /*@__PURE__*/ new Vector3();\nconst _end$1 = /*@__PURE__*/ new Vector3();\nconst _inverseMatrix$1 = /*@__PURE__*/ new Matrix4();\nconst _ray$1 = /*@__PURE__*/ new Ray();\nconst _sphere$1 = /*@__PURE__*/ new Sphere();\n\nclass Line extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new LineBasicMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Line';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.material = source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\tcomputeLineDistances() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\t// we assume non-indexed geometry\n\n\t\t\tif ( geometry.index === null ) {\n\n\t\t\t\tconst positionAttribute = geometry.attributes.position;\n\t\t\t\tconst lineDistances = [ 0 ];\n\n\t\t\t\tfor ( let i = 1, l = positionAttribute.count; i < l; i ++ ) {\n\n\t\t\t\t\t_start$1.fromBufferAttribute( positionAttribute, i - 1 );\n\t\t\t\t\t_end$1.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\t\tlineDistances[ i ] = lineDistances[ i - 1 ];\n\t\t\t\t\tlineDistances[ i ] += _start$1.distanceTo( _end$1 );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconsole.error( 'THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst threshold = raycaster.params.Line.threshold;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere$1.copy( geometry.boundingSphere );\n\t\t_sphere$1.applyMatrix4( matrixWorld );\n\t\t_sphere$1.radius += threshold;\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere$1 ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix$1.copy( matrixWorld ).invert();\n\t\t_ray$1.copy( raycaster.ray ).applyMatrix4( _inverseMatrix$1 );\n\n\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tconst localThresholdSq = localThreshold * localThreshold;\n\n\t\tconst vStart = new Vector3();\n\t\tconst vEnd = new Vector3();\n\t\tconst interSegment = new Vector3();\n\t\tconst interRay = new Vector3();\n\t\tconst step = this.isLineSegments ? 2 : 1;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst attributes = geometry.attributes;\n\t\t\tconst positionAttribute = attributes.position;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, l = end - 1; i < l; i += step ) {\n\n\t\t\t\t\tconst a = index.getX( i );\n\t\t\t\t\tconst b = index.getX( i + 1 );\n\n\t\t\t\t\tvStart.fromBufferAttribute( positionAttribute, a );\n\t\t\t\t\tvEnd.fromBufferAttribute( positionAttribute, b );\n\n\t\t\t\t\tconst distSq = _ray$1.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\n\n\t\t\t\t\tif ( distSq > localThresholdSq ) continue;\n\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\t\tconst distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tface: null,\n\t\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, l = end - 1; i < l; i += step ) {\n\n\t\t\t\t\tvStart.fromBufferAttribute( positionAttribute, i );\n\t\t\t\t\tvEnd.fromBufferAttribute( positionAttribute, i + 1 );\n\n\t\t\t\t\tconst distSq = _ray$1.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\n\n\t\t\t\t\tif ( distSq > localThresholdSq ) continue;\n\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\t\tconst distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tface: null,\n\t\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconsole.error( 'THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst morphAttributes = geometry.morphAttributes;\n\t\t\tconst keys = Object.keys( morphAttributes );\n\n\t\t\tif ( keys.length > 0 ) {\n\n\t\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst morphTargets = geometry.morphTargets;\n\n\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\n\n\t\t\t\tconsole.error( 'THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nLine.prototype.isLine = true;\n\nconst _start = /*@__PURE__*/ new Vector3();\nconst _end = /*@__PURE__*/ new Vector3();\n\nclass LineSegments extends Line {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'LineSegments';\n\n\t}\n\n\tcomputeLineDistances() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\t// we assume non-indexed geometry\n\n\t\t\tif ( geometry.index === null ) {\n\n\t\t\t\tconst positionAttribute = geometry.attributes.position;\n\t\t\t\tconst lineDistances = [];\n\n\t\t\t\tfor ( let i = 0, l = positionAttribute.count; i < l; i += 2 ) {\n\n\t\t\t\t\t_start.fromBufferAttribute( positionAttribute, i );\n\t\t\t\t\t_end.fromBufferAttribute( positionAttribute, i + 1 );\n\n\t\t\t\t\tlineDistances[ i ] = ( i === 0 ) ? 0 : lineDistances[ i - 1 ];\n\t\t\t\t\tlineDistances[ i + 1 ] = lineDistances[ i ] + _start.distanceTo( _end );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconsole.error( 'THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nLineSegments.prototype.isLineSegments = true;\n\nclass LineLoop extends Line {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'LineLoop';\n\n\t}\n\n}\n\nLineLoop.prototype.isLineLoop = true;\n\n/**\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *  map: new THREE.Texture( <Image> ),\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  size: <float>,\n *  sizeAttenuation: <bool>\n *\n * }\n */\n\nclass PointsMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'PointsMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.size = 1;\n\t\tthis.sizeAttenuation = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.size = source.size;\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\n\n\t\treturn this;\n\n\t}\n\n}\n\nPointsMaterial.prototype.isPointsMaterial = true;\n\nconst _inverseMatrix = /*@__PURE__*/ new Matrix4();\nconst _ray = /*@__PURE__*/ new Ray();\nconst _sphere = /*@__PURE__*/ new Sphere();\nconst _position$2 = /*@__PURE__*/ new Vector3();\n\nclass Points extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new PointsMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Points';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.material = source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst threshold = raycaster.params.Points.threshold;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere.copy( geometry.boundingSphere );\n\t\t_sphere.applyMatrix4( matrixWorld );\n\t\t_sphere.radius += threshold;\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix.copy( matrixWorld ).invert();\n\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\n\n\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tconst localThresholdSq = localThreshold * localThreshold;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst attributes = geometry.attributes;\n\t\t\tconst positionAttribute = attributes.position;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, il = end; i < il; i ++ ) {\n\n\t\t\t\t\tconst a = index.getX( i );\n\n\t\t\t\t\t_position$2.fromBufferAttribute( positionAttribute, a );\n\n\t\t\t\t\ttestPoint( _position$2, a, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, l = end; i < l; i ++ ) {\n\n\t\t\t\t\t_position$2.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\t\ttestPoint( _position$2, i, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst morphAttributes = geometry.morphAttributes;\n\t\t\tconst keys = Object.keys( morphAttributes );\n\n\t\t\tif ( keys.length > 0 ) {\n\n\t\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst morphTargets = geometry.morphTargets;\n\n\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\n\n\t\t\t\tconsole.error( 'THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nPoints.prototype.isPoints = true;\n\nfunction testPoint( point, index, localThresholdSq, matrixWorld, raycaster, intersects, object ) {\n\n\tconst rayPointDistanceSq = _ray.distanceSqToPoint( point );\n\n\tif ( rayPointDistanceSq < localThresholdSq ) {\n\n\t\tconst intersectPoint = new Vector3();\n\n\t\t_ray.closestPointToPoint( point, intersectPoint );\n\t\tintersectPoint.applyMatrix4( matrixWorld );\n\n\t\tconst distance = raycaster.ray.origin.distanceTo( intersectPoint );\n\n\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\t\tintersects.push( {\n\n\t\t\tdistance: distance,\n\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\n\t\t\tpoint: intersectPoint,\n\t\t\tindex: index,\n\t\t\tface: null,\n\t\t\tobject: object\n\n\t\t} );\n\n\t}\n\n}\n\nclass VideoTexture extends Texture {\n\n\tconstructor( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\t\tsuper( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : LinearFilter;\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : LinearFilter;\n\n\t\tthis.generateMipmaps = false;\n\n\t\tconst scope = this;\n\n\t\tfunction updateVideo() {\n\n\t\t\tscope.needsUpdate = true;\n\t\t\tvideo.requestVideoFrameCallback( updateVideo );\n\n\t\t}\n\n\t\tif ( 'requestVideoFrameCallback' in video ) {\n\n\t\t\tvideo.requestVideoFrameCallback( updateVideo );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.image ).copy( this );\n\n\t}\n\n\tupdate() {\n\n\t\tconst video = this.image;\n\t\tconst hasVideoFrameCallback = 'requestVideoFrameCallback' in video;\n\n\t\tif ( hasVideoFrameCallback === false && video.readyState >= video.HAVE_CURRENT_DATA ) {\n\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n}\n\nVideoTexture.prototype.isVideoTexture = true;\n\nclass FramebufferTexture extends Texture {\n\n\tconstructor( width, height, format ) {\n\n\t\tsuper( { width, height } );\n\n\t\tthis.format = format;\n\n\t\tthis.magFilter = NearestFilter;\n\t\tthis.minFilter = NearestFilter;\n\n\t\tthis.generateMipmaps = false;\n\n\t\tthis.needsUpdate = true;\n\n\t}\n\n}\n\nFramebufferTexture.prototype.isFramebufferTexture = true;\n\nclass CompressedTexture extends Texture {\n\n\tconstructor( mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, encoding ) {\n\n\t\tsuper( null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\n\n\t\tthis.image = { width: width, height: height };\n\t\tthis.mipmaps = mipmaps;\n\n\t\t// no flipping for cube textures\n\t\t// (also flipping doesn't work for compressed textures )\n\n\t\tthis.flipY = false;\n\n\t\t// can't generate mipmaps for compressed textures\n\t\t// mips must be embedded in DDS files\n\n\t\tthis.generateMipmaps = false;\n\n\t}\n\n}\n\nCompressedTexture.prototype.isCompressedTexture = true;\n\nclass CanvasTexture extends Texture {\n\n\tconstructor( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\t\tsuper( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.needsUpdate = true;\n\n\t}\n\n}\n\nCanvasTexture.prototype.isCanvasTexture = true;\n\nclass CircleGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, segments = 8, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CircleGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tsegments: segments,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tsegments = Math.max( 3, segments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tconst vertex = new Vector3();\n\t\tconst uv = new Vector2();\n\n\t\t// center point\n\n\t\tvertices.push( 0, 0, 0 );\n\t\tnormals.push( 0, 0, 1 );\n\t\tuvs.push( 0.5, 0.5 );\n\n\t\tfor ( let s = 0, i = 3; s <= segments; s ++, i += 3 ) {\n\n\t\t\tconst segment = thetaStart + s / segments * thetaLength;\n\n\t\t\t// vertex\n\n\t\t\tvertex.x = radius * Math.cos( segment );\n\t\t\tvertex.y = radius * Math.sin( segment );\n\n\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t// normal\n\n\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t// uvs\n\n\t\t\tuv.x = ( vertices[ i ] / radius + 1 ) / 2;\n\t\t\tuv.y = ( vertices[ i + 1 ] / radius + 1 ) / 2;\n\n\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let i = 1; i <= segments; i ++ ) {\n\n\t\t\tindices.push( i, i + 1, 0 );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new CircleGeometry( data.radius, data.segments, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass CylinderGeometry extends BufferGeometry {\n\n\tconstructor( radiusTop = 1, radiusBottom = 1, height = 1, radialSegments = 8, heightSegments = 1, openEnded = false, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\t\tthis.type = 'CylinderGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradiusTop: radiusTop,\n\t\t\tradiusBottom: radiusBottom,\n\t\t\theight: height,\n\t\t\tradialSegments: radialSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\topenEnded: openEnded,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tconst scope = this;\n\n\t\tradialSegments = Math.floor( radialSegments );\n\t\theightSegments = Math.floor( heightSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tlet index = 0;\n\t\tconst indexArray = [];\n\t\tconst halfHeight = height / 2;\n\t\tlet groupStart = 0;\n\n\t\t// generate geometry\n\n\t\tgenerateTorso();\n\n\t\tif ( openEnded === false ) {\n\n\t\t\tif ( radiusTop > 0 ) generateCap( true );\n\t\t\tif ( radiusBottom > 0 ) generateCap( false );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\tfunction generateTorso() {\n\n\t\t\tconst normal = new Vector3();\n\t\t\tconst vertex = new Vector3();\n\n\t\t\tlet groupCount = 0;\n\n\t\t\t// this will be used to calculate the normal\n\t\t\tconst slope = ( radiusBottom - radiusTop ) / height;\n\n\t\t\t// generate vertices, normals and uvs\n\n\t\t\tfor ( let y = 0; y <= heightSegments; y ++ ) {\n\n\t\t\t\tconst indexRow = [];\n\n\t\t\t\tconst v = y / heightSegments;\n\n\t\t\t\t// calculate the radius of the current row\n\n\t\t\t\tconst radius = v * ( radiusBottom - radiusTop ) + radiusTop;\n\n\t\t\t\tfor ( let x = 0; x <= radialSegments; x ++ ) {\n\n\t\t\t\t\tconst u = x / radialSegments;\n\n\t\t\t\t\tconst theta = u * thetaLength + thetaStart;\n\n\t\t\t\t\tconst sinTheta = Math.sin( theta );\n\t\t\t\t\tconst cosTheta = Math.cos( theta );\n\n\t\t\t\t\t// vertex\n\n\t\t\t\t\tvertex.x = radius * sinTheta;\n\t\t\t\t\tvertex.y = - v * height + halfHeight;\n\t\t\t\t\tvertex.z = radius * cosTheta;\n\t\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t\t// normal\n\n\t\t\t\t\tnormal.set( sinTheta, slope, cosTheta ).normalize();\n\t\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t\t// uv\n\n\t\t\t\t\tuvs.push( u, 1 - v );\n\n\t\t\t\t\t// save index of vertex in respective row\n\n\t\t\t\t\tindexRow.push( index ++ );\n\n\t\t\t\t}\n\n\t\t\t\t// now save vertices of the row in our index array\n\n\t\t\t\tindexArray.push( indexRow );\n\n\t\t\t}\n\n\t\t\t// generate indices\n\n\t\t\tfor ( let x = 0; x < radialSegments; x ++ ) {\n\n\t\t\t\tfor ( let y = 0; y < heightSegments; y ++ ) {\n\n\t\t\t\t\t// we use the index array to access the correct indices\n\n\t\t\t\t\tconst a = indexArray[ y ][ x ];\n\t\t\t\t\tconst b = indexArray[ y + 1 ][ x ];\n\t\t\t\t\tconst c = indexArray[ y + 1 ][ x + 1 ];\n\t\t\t\t\tconst d = indexArray[ y ][ x + 1 ];\n\n\t\t\t\t\t// faces\n\n\t\t\t\t\tindices.push( a, b, d );\n\t\t\t\t\tindices.push( b, c, d );\n\n\t\t\t\t\t// update group counter\n\n\t\t\t\t\tgroupCount += 6;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\n\t\t\tscope.addGroup( groupStart, groupCount, 0 );\n\n\t\t\t// calculate new start value for groups\n\n\t\t\tgroupStart += groupCount;\n\n\t\t}\n\n\t\tfunction generateCap( top ) {\n\n\t\t\t// save the index of the first center vertex\n\t\t\tconst centerIndexStart = index;\n\n\t\t\tconst uv = new Vector2();\n\t\t\tconst vertex = new Vector3();\n\n\t\t\tlet groupCount = 0;\n\n\t\t\tconst radius = ( top === true ) ? radiusTop : radiusBottom;\n\t\t\tconst sign = ( top === true ) ? 1 : - 1;\n\n\t\t\t// first we generate the center vertex data of the cap.\n\t\t\t// because the geometry needs one set of uvs per face,\n\t\t\t// we must generate a center vertex per face/segment\n\n\t\t\tfor ( let x = 1; x <= radialSegments; x ++ ) {\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertices.push( 0, halfHeight * sign, 0 );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormals.push( 0, sign, 0 );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( 0.5, 0.5 );\n\n\t\t\t\t// increase index\n\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\t// save the index of the last center vertex\n\t\t\tconst centerIndexEnd = index;\n\n\t\t\t// now we generate the surrounding vertices, normals and uvs\n\n\t\t\tfor ( let x = 0; x <= radialSegments; x ++ ) {\n\n\t\t\t\tconst u = x / radialSegments;\n\t\t\t\tconst theta = u * thetaLength + thetaStart;\n\n\t\t\t\tconst cosTheta = Math.cos( theta );\n\t\t\t\tconst sinTheta = Math.sin( theta );\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = radius * sinTheta;\n\t\t\t\tvertex.y = halfHeight * sign;\n\t\t\t\tvertex.z = radius * cosTheta;\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormals.push( 0, sign, 0 );\n\n\t\t\t\t// uv\n\n\t\t\t\tuv.x = ( cosTheta * 0.5 ) + 0.5;\n\t\t\t\tuv.y = ( sinTheta * 0.5 * sign ) + 0.5;\n\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t\t// increase index\n\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\t// generate indices\n\n\t\t\tfor ( let x = 0; x < radialSegments; x ++ ) {\n\n\t\t\t\tconst c = centerIndexStart + x;\n\t\t\t\tconst i = centerIndexEnd + x;\n\n\t\t\t\tif ( top === true ) {\n\n\t\t\t\t\t// face top\n\n\t\t\t\t\tindices.push( i, i + 1, c );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// face bottom\n\n\t\t\t\t\tindices.push( i + 1, i, c );\n\n\t\t\t\t}\n\n\t\t\t\tgroupCount += 3;\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\n\t\t\tscope.addGroup( groupStart, groupCount, top === true ? 1 : 2 );\n\n\t\t\t// calculate new start value for groups\n\n\t\t\tgroupStart += groupCount;\n\n\t\t}\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new CylinderGeometry( data.radiusTop, data.radiusBottom, data.height, data.radialSegments, data.heightSegments, data.openEnded, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass ConeGeometry extends CylinderGeometry {\n\n\tconstructor( radius = 1, height = 1, radialSegments = 8, heightSegments = 1, openEnded = false, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper( 0, radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength );\n\n\t\tthis.type = 'ConeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\theight: height,\n\t\t\tradialSegments: radialSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\topenEnded: openEnded,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new ConeGeometry( data.radius, data.height, data.radialSegments, data.heightSegments, data.openEnded, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass PolyhedronGeometry extends BufferGeometry {\n\n\tconstructor( vertices = [], indices = [], radius = 1, detail = 0 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'PolyhedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tvertices: vertices,\n\t\t\tindices: indices,\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t\t// default buffer data\n\n\t\tconst vertexBuffer = [];\n\t\tconst uvBuffer = [];\n\n\t\t// the subdivision creates the vertex buffer data\n\n\t\tsubdivide( detail );\n\n\t\t// all vertices should lie on a conceptual sphere with a given radius\n\n\t\tapplyRadius( radius );\n\n\t\t// finally, create the uv data\n\n\t\tgenerateUVs();\n\n\t\t// build non-indexed geometry\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertexBuffer, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( vertexBuffer.slice(), 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvBuffer, 2 ) );\n\n\t\tif ( detail === 0 ) {\n\n\t\t\tthis.computeVertexNormals(); // flat normals\n\n\t\t} else {\n\n\t\t\tthis.normalizeNormals(); // smooth normals\n\n\t\t}\n\n\t\t// helper functions\n\n\t\tfunction subdivide( detail ) {\n\n\t\t\tconst a = new Vector3();\n\t\t\tconst b = new Vector3();\n\t\t\tconst c = new Vector3();\n\n\t\t\t// iterate over all faces and apply a subdivison with the given detail value\n\n\t\t\tfor ( let i = 0; i < indices.length; i += 3 ) {\n\n\t\t\t\t// get the vertices of the face\n\n\t\t\t\tgetVertexByIndex( indices[ i + 0 ], a );\n\t\t\t\tgetVertexByIndex( indices[ i + 1 ], b );\n\t\t\t\tgetVertexByIndex( indices[ i + 2 ], c );\n\n\t\t\t\t// perform subdivision\n\n\t\t\t\tsubdivideFace( a, b, c, detail );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction subdivideFace( a, b, c, detail ) {\n\n\t\t\tconst cols = detail + 1;\n\n\t\t\t// we use this multidimensional array as a data structure for creating the subdivision\n\n\t\t\tconst v = [];\n\n\t\t\t// construct all of the vertices for this subdivision\n\n\t\t\tfor ( let i = 0; i <= cols; i ++ ) {\n\n\t\t\t\tv[ i ] = [];\n\n\t\t\t\tconst aj = a.clone().lerp( c, i / cols );\n\t\t\t\tconst bj = b.clone().lerp( c, i / cols );\n\n\t\t\t\tconst rows = cols - i;\n\n\t\t\t\tfor ( let j = 0; j <= rows; j ++ ) {\n\n\t\t\t\t\tif ( j === 0 && i === cols ) {\n\n\t\t\t\t\t\tv[ i ][ j ] = aj;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tv[ i ][ j ] = aj.clone().lerp( bj, j / rows );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// construct all of the faces\n\n\t\t\tfor ( let i = 0; i < cols; i ++ ) {\n\n\t\t\t\tfor ( let j = 0; j < 2 * ( cols - i ) - 1; j ++ ) {\n\n\t\t\t\t\tconst k = Math.floor( j / 2 );\n\n\t\t\t\t\tif ( j % 2 === 0 ) {\n\n\t\t\t\t\t\tpushVertex( v[ i ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k ] );\n\t\t\t\t\t\tpushVertex( v[ i ][ k ] );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tpushVertex( v[ i ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction applyRadius( radius ) {\n\n\t\t\tconst vertex = new Vector3();\n\n\t\t\t// iterate over the entire buffer and apply the radius to each vertex\n\n\t\t\tfor ( let i = 0; i < vertexBuffer.length; i += 3 ) {\n\n\t\t\t\tvertex.x = vertexBuffer[ i + 0 ];\n\t\t\t\tvertex.y = vertexBuffer[ i + 1 ];\n\t\t\t\tvertex.z = vertexBuffer[ i + 2 ];\n\n\t\t\t\tvertex.normalize().multiplyScalar( radius );\n\n\t\t\t\tvertexBuffer[ i + 0 ] = vertex.x;\n\t\t\t\tvertexBuffer[ i + 1 ] = vertex.y;\n\t\t\t\tvertexBuffer[ i + 2 ] = vertex.z;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateUVs() {\n\n\t\t\tconst vertex = new Vector3();\n\n\t\t\tfor ( let i = 0; i < vertexBuffer.length; i += 3 ) {\n\n\t\t\t\tvertex.x = vertexBuffer[ i + 0 ];\n\t\t\t\tvertex.y = vertexBuffer[ i + 1 ];\n\t\t\t\tvertex.z = vertexBuffer[ i + 2 ];\n\n\t\t\t\tconst u = azimuth( vertex ) / 2 / Math.PI + 0.5;\n\t\t\t\tconst v = inclination( vertex ) / Math.PI + 0.5;\n\t\t\t\tuvBuffer.push( u, 1 - v );\n\n\t\t\t}\n\n\t\t\tcorrectUVs();\n\n\t\t\tcorrectSeam();\n\n\t\t}\n\n\t\tfunction correctSeam() {\n\n\t\t\t// handle case when face straddles the seam, see #3269\n\n\t\t\tfor ( let i = 0; i < uvBuffer.length; i += 6 ) {\n\n\t\t\t\t// uv data of a single face\n\n\t\t\t\tconst x0 = uvBuffer[ i + 0 ];\n\t\t\t\tconst x1 = uvBuffer[ i + 2 ];\n\t\t\t\tconst x2 = uvBuffer[ i + 4 ];\n\n\t\t\t\tconst max = Math.max( x0, x1, x2 );\n\t\t\t\tconst min = Math.min( x0, x1, x2 );\n\n\t\t\t\t// 0.9 is somewhat arbitrary\n\n\t\t\t\tif ( max > 0.9 && min < 0.1 ) {\n\n\t\t\t\t\tif ( x0 < 0.2 ) uvBuffer[ i + 0 ] += 1;\n\t\t\t\t\tif ( x1 < 0.2 ) uvBuffer[ i + 2 ] += 1;\n\t\t\t\t\tif ( x2 < 0.2 ) uvBuffer[ i + 4 ] += 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction pushVertex( vertex ) {\n\n\t\t\tvertexBuffer.push( vertex.x, vertex.y, vertex.z );\n\n\t\t}\n\n\t\tfunction getVertexByIndex( index, vertex ) {\n\n\t\t\tconst stride = index * 3;\n\n\t\t\tvertex.x = vertices[ stride + 0 ];\n\t\t\tvertex.y = vertices[ stride + 1 ];\n\t\t\tvertex.z = vertices[ stride + 2 ];\n\n\t\t}\n\n\t\tfunction correctUVs() {\n\n\t\t\tconst a = new Vector3();\n\t\t\tconst b = new Vector3();\n\t\t\tconst c = new Vector3();\n\n\t\t\tconst centroid = new Vector3();\n\n\t\t\tconst uvA = new Vector2();\n\t\t\tconst uvB = new Vector2();\n\t\t\tconst uvC = new Vector2();\n\n\t\t\tfor ( let i = 0, j = 0; i < vertexBuffer.length; i += 9, j += 6 ) {\n\n\t\t\t\ta.set( vertexBuffer[ i + 0 ], vertexBuffer[ i + 1 ], vertexBuffer[ i + 2 ] );\n\t\t\t\tb.set( vertexBuffer[ i + 3 ], vertexBuffer[ i + 4 ], vertexBuffer[ i + 5 ] );\n\t\t\t\tc.set( vertexBuffer[ i + 6 ], vertexBuffer[ i + 7 ], vertexBuffer[ i + 8 ] );\n\n\t\t\t\tuvA.set( uvBuffer[ j + 0 ], uvBuffer[ j + 1 ] );\n\t\t\t\tuvB.set( uvBuffer[ j + 2 ], uvBuffer[ j + 3 ] );\n\t\t\t\tuvC.set( uvBuffer[ j + 4 ], uvBuffer[ j + 5 ] );\n\n\t\t\t\tcentroid.copy( a ).add( b ).add( c ).divideScalar( 3 );\n\n\t\t\t\tconst azi = azimuth( centroid );\n\n\t\t\t\tcorrectUV( uvA, j + 0, a, azi );\n\t\t\t\tcorrectUV( uvB, j + 2, b, azi );\n\t\t\t\tcorrectUV( uvC, j + 4, c, azi );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction correctUV( uv, stride, vector, azimuth ) {\n\n\t\t\tif ( ( azimuth < 0 ) && ( uv.x === 1 ) ) {\n\n\t\t\t\tuvBuffer[ stride ] = uv.x - 1;\n\n\t\t\t}\n\n\t\t\tif ( ( vector.x === 0 ) && ( vector.z === 0 ) ) {\n\n\t\t\t\tuvBuffer[ stride ] = azimuth / 2 / Math.PI + 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Angle around the Y axis, counter-clockwise when looking from above.\n\n\t\tfunction azimuth( vector ) {\n\n\t\t\treturn Math.atan2( vector.z, - vector.x );\n\n\t\t}\n\n\n\t\t// Angle above the XZ plane.\n\n\t\tfunction inclination( vector ) {\n\n\t\t\treturn Math.atan2( - vector.y, Math.sqrt( ( vector.x * vector.x ) + ( vector.z * vector.z ) ) );\n\n\t\t}\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new PolyhedronGeometry( data.vertices, data.indices, data.radius, data.details );\n\n\t}\n\n}\n\nclass DodecahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst t = ( 1 + Math.sqrt( 5 ) ) / 2;\n\t\tconst r = 1 / t;\n\n\t\tconst vertices = [\n\n\t\t\t// (±1, ±1, ±1)\n\t\t\t- 1, - 1, - 1,\t- 1, - 1, 1,\n\t\t\t- 1, 1, - 1, - 1, 1, 1,\n\t\t\t1, - 1, - 1, 1, - 1, 1,\n\t\t\t1, 1, - 1, 1, 1, 1,\n\n\t\t\t// (0, ±1/φ, ±φ)\n\t\t\t0, - r, - t, 0, - r, t,\n\t\t\t0, r, - t, 0, r, t,\n\n\t\t\t// (±1/φ, ±φ, 0)\n\t\t\t- r, - t, 0, - r, t, 0,\n\t\t\tr, - t, 0, r, t, 0,\n\n\t\t\t// (±φ, 0, ±1/φ)\n\t\t\t- t, 0, - r, t, 0, - r,\n\t\t\t- t, 0, r, t, 0, r\n\t\t];\n\n\t\tconst indices = [\n\t\t\t3, 11, 7, \t3, 7, 15, \t3, 15, 13,\n\t\t\t7, 19, 17, \t7, 17, 6, \t7, 6, 15,\n\t\t\t17, 4, 8, \t17, 8, 10, \t17, 10, 6,\n\t\t\t8, 0, 16, \t8, 16, 2, \t8, 2, 10,\n\t\t\t0, 12, 1, \t0, 1, 18, \t0, 18, 16,\n\t\t\t6, 10, 2, \t6, 2, 13, \t6, 13, 15,\n\t\t\t2, 16, 18, \t2, 18, 3, \t2, 3, 13,\n\t\t\t18, 1, 9, \t18, 9, 11, \t18, 11, 3,\n\t\t\t4, 14, 12, \t4, 12, 0, \t4, 0, 8,\n\t\t\t11, 9, 5, \t11, 5, 19, \t11, 19, 7,\n\t\t\t19, 5, 14, \t19, 14, 4, \t19, 4, 17,\n\t\t\t1, 12, 14, \t1, 14, 5, \t1, 5, 9\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'DodecahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new DodecahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nconst _v0 = new Vector3();\nconst _v1$1 = new Vector3();\nconst _normal = new Vector3();\nconst _triangle = new Triangle();\n\nclass EdgesGeometry extends BufferGeometry {\n\n\tconstructor( geometry = null, thresholdAngle = 1 ) {\n\n\t\tsuper();\n\t\tthis.type = 'EdgesGeometry';\n\n\t\tthis.parameters = {\n\t\t\tgeometry: geometry,\n\t\t\tthresholdAngle: thresholdAngle\n\t\t};\n\n\t\tif ( geometry !== null ) {\n\n\t\t\tconst precisionPoints = 4;\n\t\t\tconst precision = Math.pow( 10, precisionPoints );\n\t\t\tconst thresholdDot = Math.cos( DEG2RAD * thresholdAngle );\n\n\t\t\tconst indexAttr = geometry.getIndex();\n\t\t\tconst positionAttr = geometry.getAttribute( 'position' );\n\t\t\tconst indexCount = indexAttr ? indexAttr.count : positionAttr.count;\n\n\t\t\tconst indexArr = [ 0, 0, 0 ];\n\t\t\tconst vertKeys = [ 'a', 'b', 'c' ];\n\t\t\tconst hashes = new Array( 3 );\n\n\t\t\tconst edgeData = {};\n\t\t\tconst vertices = [];\n\t\t\tfor ( let i = 0; i < indexCount; i += 3 ) {\n\n\t\t\t\tif ( indexAttr ) {\n\n\t\t\t\t\tindexArr[ 0 ] = indexAttr.getX( i );\n\t\t\t\t\tindexArr[ 1 ] = indexAttr.getX( i + 1 );\n\t\t\t\t\tindexArr[ 2 ] = indexAttr.getX( i + 2 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tindexArr[ 0 ] = i;\n\t\t\t\t\tindexArr[ 1 ] = i + 1;\n\t\t\t\t\tindexArr[ 2 ] = i + 2;\n\n\t\t\t\t}\n\n\t\t\t\tconst { a, b, c } = _triangle;\n\t\t\t\ta.fromBufferAttribute( positionAttr, indexArr[ 0 ] );\n\t\t\t\tb.fromBufferAttribute( positionAttr, indexArr[ 1 ] );\n\t\t\t\tc.fromBufferAttribute( positionAttr, indexArr[ 2 ] );\n\t\t\t\t_triangle.getNormal( _normal );\n\n\t\t\t\t// create hashes for the edge from the vertices\n\t\t\t\thashes[ 0 ] = `${ Math.round( a.x * precision ) },${ Math.round( a.y * precision ) },${ Math.round( a.z * precision ) }`;\n\t\t\t\thashes[ 1 ] = `${ Math.round( b.x * precision ) },${ Math.round( b.y * precision ) },${ Math.round( b.z * precision ) }`;\n\t\t\t\thashes[ 2 ] = `${ Math.round( c.x * precision ) },${ Math.round( c.y * precision ) },${ Math.round( c.z * precision ) }`;\n\n\t\t\t\t// skip degenerate triangles\n\t\t\t\tif ( hashes[ 0 ] === hashes[ 1 ] || hashes[ 1 ] === hashes[ 2 ] || hashes[ 2 ] === hashes[ 0 ] ) {\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\t// iterate over every edge\n\t\t\t\tfor ( let j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t// get the first and next vertex making up the edge\n\t\t\t\t\tconst jNext = ( j + 1 ) % 3;\n\t\t\t\t\tconst vecHash0 = hashes[ j ];\n\t\t\t\t\tconst vecHash1 = hashes[ jNext ];\n\t\t\t\t\tconst v0 = _triangle[ vertKeys[ j ] ];\n\t\t\t\t\tconst v1 = _triangle[ vertKeys[ jNext ] ];\n\n\t\t\t\t\tconst hash = `${ vecHash0 }_${ vecHash1 }`;\n\t\t\t\t\tconst reverseHash = `${ vecHash1 }_${ vecHash0 }`;\n\n\t\t\t\t\tif ( reverseHash in edgeData && edgeData[ reverseHash ] ) {\n\n\t\t\t\t\t\t// if we found a sibling edge add it into the vertex array if\n\t\t\t\t\t\t// it meets the angle threshold and delete the edge from the map.\n\t\t\t\t\t\tif ( _normal.dot( edgeData[ reverseHash ].normal ) <= thresholdDot ) {\n\n\t\t\t\t\t\t\tvertices.push( v0.x, v0.y, v0.z );\n\t\t\t\t\t\t\tvertices.push( v1.x, v1.y, v1.z );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tedgeData[ reverseHash ] = null;\n\n\t\t\t\t\t} else if ( ! ( hash in edgeData ) ) {\n\n\t\t\t\t\t\t// if we've already got an edge here then skip adding a new one\n\t\t\t\t\t\tedgeData[ hash ] = {\n\n\t\t\t\t\t\t\tindex0: indexArr[ j ],\n\t\t\t\t\t\t\tindex1: indexArr[ jNext ],\n\t\t\t\t\t\t\tnormal: _normal.clone(),\n\n\t\t\t\t\t\t};\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// iterate over all remaining, unmatched edges and add them to the vertex array\n\t\t\tfor ( const key in edgeData ) {\n\n\t\t\t\tif ( edgeData[ key ] ) {\n\n\t\t\t\t\tconst { index0, index1 } = edgeData[ key ];\n\t\t\t\t\t_v0.fromBufferAttribute( positionAttr, index0 );\n\t\t\t\t\t_v1$1.fromBufferAttribute( positionAttr, index1 );\n\n\t\t\t\t\tvertices.push( _v0.x, _v0.y, _v0.z );\n\t\t\t\t\tvertices.push( _v1$1.x, _v1$1.y, _v1$1.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Extensible curve object.\n *\n * Some common of curve methods:\n * .getPoint( t, optionalTarget ), .getTangent( t, optionalTarget )\n * .getPointAt( u, optionalTarget ), .getTangentAt( u, optionalTarget )\n * .getPoints(), .getSpacedPoints()\n * .getLength()\n * .updateArcLengths()\n *\n * This following curves inherit from THREE.Curve:\n *\n * -- 2D curves --\n * THREE.ArcCurve\n * THREE.CubicBezierCurve\n * THREE.EllipseCurve\n * THREE.LineCurve\n * THREE.QuadraticBezierCurve\n * THREE.SplineCurve\n *\n * -- 3D curves --\n * THREE.CatmullRomCurve3\n * THREE.CubicBezierCurve3\n * THREE.LineCurve3\n * THREE.QuadraticBezierCurve3\n *\n * A series of curves can be represented as a THREE.CurvePath.\n *\n **/\n\nclass Curve {\n\n\tconstructor() {\n\n\t\tthis.type = 'Curve';\n\n\t\tthis.arcLengthDivisions = 200;\n\n\t}\n\n\t// Virtual base class method to overwrite and implement in subclasses\n\t//\t- t [0 .. 1]\n\n\tgetPoint( /* t, optionalTarget */ ) {\n\n\t\tconsole.warn( 'THREE.Curve: .getPoint() not implemented.' );\n\t\treturn null;\n\n\t}\n\n\t// Get point at relative position in curve according to arc length\n\t// - u [0 .. 1]\n\n\tgetPointAt( u, optionalTarget ) {\n\n\t\tconst t = this.getUtoTmapping( u );\n\t\treturn this.getPoint( t, optionalTarget );\n\n\t}\n\n\t// Get sequence of points using getPoint( t )\n\n\tgetPoints( divisions = 5 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let d = 0; d <= divisions; d ++ ) {\n\n\t\t\tpoints.push( this.getPoint( d / divisions ) );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\t// Get sequence of points using getPointAt( u )\n\n\tgetSpacedPoints( divisions = 5 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let d = 0; d <= divisions; d ++ ) {\n\n\t\t\tpoints.push( this.getPointAt( d / divisions ) );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\t// Get total curve arc length\n\n\tgetLength() {\n\n\t\tconst lengths = this.getLengths();\n\t\treturn lengths[ lengths.length - 1 ];\n\n\t}\n\n\t// Get list of cumulative segment lengths\n\n\tgetLengths( divisions = this.arcLengthDivisions ) {\n\n\t\tif ( this.cacheArcLengths &&\n\t\t\t( this.cacheArcLengths.length === divisions + 1 ) &&\n\t\t\t! this.needsUpdate ) {\n\n\t\t\treturn this.cacheArcLengths;\n\n\t\t}\n\n\t\tthis.needsUpdate = false;\n\n\t\tconst cache = [];\n\t\tlet current, last = this.getPoint( 0 );\n\t\tlet sum = 0;\n\n\t\tcache.push( 0 );\n\n\t\tfor ( let p = 1; p <= divisions; p ++ ) {\n\n\t\t\tcurrent = this.getPoint( p / divisions );\n\t\t\tsum += current.distanceTo( last );\n\t\t\tcache.push( sum );\n\t\t\tlast = current;\n\n\t\t}\n\n\t\tthis.cacheArcLengths = cache;\n\n\t\treturn cache; // { sums: cache, sum: sum }; Sum is in the last element.\n\n\t}\n\n\tupdateArcLengths() {\n\n\t\tthis.needsUpdate = true;\n\t\tthis.getLengths();\n\n\t}\n\n\t// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant\n\n\tgetUtoTmapping( u, distance ) {\n\n\t\tconst arcLengths = this.getLengths();\n\n\t\tlet i = 0;\n\t\tconst il = arcLengths.length;\n\n\t\tlet targetArcLength; // The targeted u distance value to get\n\n\t\tif ( distance ) {\n\n\t\t\ttargetArcLength = distance;\n\n\t\t} else {\n\n\t\t\ttargetArcLength = u * arcLengths[ il - 1 ];\n\n\t\t}\n\n\t\t// binary search for the index with largest value smaller than target u distance\n\n\t\tlet low = 0, high = il - 1, comparison;\n\n\t\twhile ( low <= high ) {\n\n\t\t\ti = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\n\n\t\t\tcomparison = arcLengths[ i ] - targetArcLength;\n\n\t\t\tif ( comparison < 0 ) {\n\n\t\t\t\tlow = i + 1;\n\n\t\t\t} else if ( comparison > 0 ) {\n\n\t\t\t\thigh = i - 1;\n\n\t\t\t} else {\n\n\t\t\t\thigh = i;\n\t\t\t\tbreak;\n\n\t\t\t\t// DONE\n\n\t\t\t}\n\n\t\t}\n\n\t\ti = high;\n\n\t\tif ( arcLengths[ i ] === targetArcLength ) {\n\n\t\t\treturn i / ( il - 1 );\n\n\t\t}\n\n\t\t// we could get finer grain at lengths, or use simple interpolation between two points\n\n\t\tconst lengthBefore = arcLengths[ i ];\n\t\tconst lengthAfter = arcLengths[ i + 1 ];\n\n\t\tconst segmentLength = lengthAfter - lengthBefore;\n\n\t\t// determine where we are between the 'before' and 'after' points\n\n\t\tconst segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\n\n\t\t// add that fractional amount to t\n\n\t\tconst t = ( i + segmentFraction ) / ( il - 1 );\n\n\t\treturn t;\n\n\t}\n\n\t// Returns a unit vector tangent at t\n\t// In case any sub curve does not implement its tangent derivation,\n\t// 2 points a small delta apart will be used to find its gradient\n\t// which seems to give a reasonable approximation\n\n\tgetTangent( t, optionalTarget ) {\n\n\t\tconst delta = 0.0001;\n\t\tlet t1 = t - delta;\n\t\tlet t2 = t + delta;\n\n\t\t// Capping in case of danger\n\n\t\tif ( t1 < 0 ) t1 = 0;\n\t\tif ( t2 > 1 ) t2 = 1;\n\n\t\tconst pt1 = this.getPoint( t1 );\n\t\tconst pt2 = this.getPoint( t2 );\n\n\t\tconst tangent = optionalTarget || ( ( pt1.isVector2 ) ? new Vector2() : new Vector3() );\n\n\t\ttangent.copy( pt2 ).sub( pt1 ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n\tgetTangentAt( u, optionalTarget ) {\n\n\t\tconst t = this.getUtoTmapping( u );\n\t\treturn this.getTangent( t, optionalTarget );\n\n\t}\n\n\tcomputeFrenetFrames( segments, closed ) {\n\n\t\t// see http://www.cs.indiana.edu/pub/techreports/TR425.pdf\n\n\t\tconst normal = new Vector3();\n\n\t\tconst tangents = [];\n\t\tconst normals = [];\n\t\tconst binormals = [];\n\n\t\tconst vec = new Vector3();\n\t\tconst mat = new Matrix4();\n\n\t\t// compute the tangent vectors for each segment on the curve\n\n\t\tfor ( let i = 0; i <= segments; i ++ ) {\n\n\t\t\tconst u = i / segments;\n\n\t\t\ttangents[ i ] = this.getTangentAt( u, new Vector3() );\n\n\t\t}\n\n\t\t// select an initial normal vector perpendicular to the first tangent vector,\n\t\t// and in the direction of the minimum tangent xyz component\n\n\t\tnormals[ 0 ] = new Vector3();\n\t\tbinormals[ 0 ] = new Vector3();\n\t\tlet min = Number.MAX_VALUE;\n\t\tconst tx = Math.abs( tangents[ 0 ].x );\n\t\tconst ty = Math.abs( tangents[ 0 ].y );\n\t\tconst tz = Math.abs( tangents[ 0 ].z );\n\n\t\tif ( tx <= min ) {\n\n\t\t\tmin = tx;\n\t\t\tnormal.set( 1, 0, 0 );\n\n\t\t}\n\n\t\tif ( ty <= min ) {\n\n\t\t\tmin = ty;\n\t\t\tnormal.set( 0, 1, 0 );\n\n\t\t}\n\n\t\tif ( tz <= min ) {\n\n\t\t\tnormal.set( 0, 0, 1 );\n\n\t\t}\n\n\t\tvec.crossVectors( tangents[ 0 ], normal ).normalize();\n\n\t\tnormals[ 0 ].crossVectors( tangents[ 0 ], vec );\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] );\n\n\n\t\t// compute the slowly-varying normal and binormal vectors for each segment on the curve\n\n\t\tfor ( let i = 1; i <= segments; i ++ ) {\n\n\t\t\tnormals[ i ] = normals[ i - 1 ].clone();\n\n\t\t\tbinormals[ i ] = binormals[ i - 1 ].clone();\n\n\t\t\tvec.crossVectors( tangents[ i - 1 ], tangents[ i ] );\n\n\t\t\tif ( vec.length() > Number.EPSILON ) {\n\n\t\t\t\tvec.normalize();\n\n\t\t\t\tconst theta = Math.acos( clamp( tangents[ i - 1 ].dot( tangents[ i ] ), - 1, 1 ) ); // clamp for floating pt errors\n\n\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( vec, theta ) );\n\n\t\t\t}\n\n\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\n\n\t\t}\n\n\t\t// if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\n\n\t\tif ( closed === true ) {\n\n\t\t\tlet theta = Math.acos( clamp( normals[ 0 ].dot( normals[ segments ] ), - 1, 1 ) );\n\t\t\ttheta /= segments;\n\n\t\t\tif ( tangents[ 0 ].dot( vec.crossVectors( normals[ 0 ], normals[ segments ] ) ) > 0 ) {\n\n\t\t\t\ttheta = - theta;\n\n\t\t\t}\n\n\t\t\tfor ( let i = 1; i <= segments; i ++ ) {\n\n\t\t\t\t// twist a little...\n\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( tangents[ i ], theta * i ) );\n\t\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\ttangents: tangents,\n\t\t\tnormals: normals,\n\t\t\tbinormals: binormals\n\t\t};\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.arcLengthDivisions = source.arcLengthDivisions;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Curve',\n\t\t\t\tgenerator: 'Curve.toJSON'\n\t\t\t}\n\t\t};\n\n\t\tdata.arcLengthDivisions = this.arcLengthDivisions;\n\t\tdata.type = this.type;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tthis.arcLengthDivisions = json.arcLengthDivisions;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass EllipseCurve extends Curve {\n\n\tconstructor( aX = 0, aY = 0, xRadius = 1, yRadius = 1, aStartAngle = 0, aEndAngle = Math.PI * 2, aClockwise = false, aRotation = 0 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'EllipseCurve';\n\n\t\tthis.aX = aX;\n\t\tthis.aY = aY;\n\n\t\tthis.xRadius = xRadius;\n\t\tthis.yRadius = yRadius;\n\n\t\tthis.aStartAngle = aStartAngle;\n\t\tthis.aEndAngle = aEndAngle;\n\n\t\tthis.aClockwise = aClockwise;\n\n\t\tthis.aRotation = aRotation;\n\n\t}\n\n\tgetPoint( t, optionalTarget ) {\n\n\t\tconst point = optionalTarget || new Vector2();\n\n\t\tconst twoPi = Math.PI * 2;\n\t\tlet deltaAngle = this.aEndAngle - this.aStartAngle;\n\t\tconst samePoints = Math.abs( deltaAngle ) < Number.EPSILON;\n\n\t\t// ensures that deltaAngle is 0 .. 2 PI\n\t\twhile ( deltaAngle < 0 ) deltaAngle += twoPi;\n\t\twhile ( deltaAngle > twoPi ) deltaAngle -= twoPi;\n\n\t\tif ( deltaAngle < Number.EPSILON ) {\n\n\t\t\tif ( samePoints ) {\n\n\t\t\t\tdeltaAngle = 0;\n\n\t\t\t} else {\n\n\t\t\t\tdeltaAngle = twoPi;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.aClockwise === true && ! samePoints ) {\n\n\t\t\tif ( deltaAngle === twoPi ) {\n\n\t\t\t\tdeltaAngle = - twoPi;\n\n\t\t\t} else {\n\n\t\t\t\tdeltaAngle = deltaAngle - twoPi;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst angle = this.aStartAngle + t * deltaAngle;\n\t\tlet x = this.aX + this.xRadius * Math.cos( angle );\n\t\tlet y = this.aY + this.yRadius * Math.sin( angle );\n\n\t\tif ( this.aRotation !== 0 ) {\n\n\t\t\tconst cos = Math.cos( this.aRotation );\n\t\t\tconst sin = Math.sin( this.aRotation );\n\n\t\t\tconst tx = x - this.aX;\n\t\t\tconst ty = y - this.aY;\n\n\t\t\t// Rotate the point about the center of the ellipse.\n\t\t\tx = tx * cos - ty * sin + this.aX;\n\t\t\ty = tx * sin + ty * cos + this.aY;\n\n\t\t}\n\n\t\treturn point.set( x, y );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.aX = source.aX;\n\t\tthis.aY = source.aY;\n\n\t\tthis.xRadius = source.xRadius;\n\t\tthis.yRadius = source.yRadius;\n\n\t\tthis.aStartAngle = source.aStartAngle;\n\t\tthis.aEndAngle = source.aEndAngle;\n\n\t\tthis.aClockwise = source.aClockwise;\n\n\t\tthis.aRotation = source.aRotation;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.aX = this.aX;\n\t\tdata.aY = this.aY;\n\n\t\tdata.xRadius = this.xRadius;\n\t\tdata.yRadius = this.yRadius;\n\n\t\tdata.aStartAngle = this.aStartAngle;\n\t\tdata.aEndAngle = this.aEndAngle;\n\n\t\tdata.aClockwise = this.aClockwise;\n\n\t\tdata.aRotation = this.aRotation;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.aX = json.aX;\n\t\tthis.aY = json.aY;\n\n\t\tthis.xRadius = json.xRadius;\n\t\tthis.yRadius = json.yRadius;\n\n\t\tthis.aStartAngle = json.aStartAngle;\n\t\tthis.aEndAngle = json.aEndAngle;\n\n\t\tthis.aClockwise = json.aClockwise;\n\n\t\tthis.aRotation = json.aRotation;\n\n\t\treturn this;\n\n\t}\n\n}\n\nEllipseCurve.prototype.isEllipseCurve = true;\n\nclass ArcCurve extends EllipseCurve {\n\n\tconstructor( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tsuper( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\n\n\t\tthis.type = 'ArcCurve';\n\n\t}\n\n}\n\nArcCurve.prototype.isArcCurve = true;\n\n/**\n * Centripetal CatmullRom Curve - which is useful for avoiding\n * cusps and self-intersections in non-uniform catmull rom curves.\n * http://www.cemyuksel.com/research/catmullrom_param/catmullrom.pdf\n *\n * curve.type accepts centripetal(default), chordal and catmullrom\n * curve.tension is used for catmullrom which defaults to 0.5\n */\n\n\n/*\nBased on an optimized c++ solution in\n - http://stackoverflow.com/questions/9489736/catmull-rom-curve-with-no-cusps-and-no-self-intersections/\n - http://ideone.com/NoEbVM\n\nThis CubicPoly class could be used for reusing some variables and calculations,\nbut for three.js curve use, it could be possible inlined and flatten into a single function call\nwhich can be placed in CurveUtils.\n*/\n\nfunction CubicPoly() {\n\n\tlet c0 = 0, c1 = 0, c2 = 0, c3 = 0;\n\n\t/*\n\t * Compute coefficients for a cubic polynomial\n\t *   p(s) = c0 + c1*s + c2*s^2 + c3*s^3\n\t * such that\n\t *   p(0) = x0, p(1) = x1\n\t *  and\n\t *   p'(0) = t0, p'(1) = t1.\n\t */\n\tfunction init( x0, x1, t0, t1 ) {\n\n\t\tc0 = x0;\n\t\tc1 = t0;\n\t\tc2 = - 3 * x0 + 3 * x1 - 2 * t0 - t1;\n\t\tc3 = 2 * x0 - 2 * x1 + t0 + t1;\n\n\t}\n\n\treturn {\n\n\t\tinitCatmullRom: function ( x0, x1, x2, x3, tension ) {\n\n\t\t\tinit( x1, x2, tension * ( x2 - x0 ), tension * ( x3 - x1 ) );\n\n\t\t},\n\n\t\tinitNonuniformCatmullRom: function ( x0, x1, x2, x3, dt0, dt1, dt2 ) {\n\n\t\t\t// compute tangents when parameterized in [t1,t2]\n\t\t\tlet t1 = ( x1 - x0 ) / dt0 - ( x2 - x0 ) / ( dt0 + dt1 ) + ( x2 - x1 ) / dt1;\n\t\t\tlet t2 = ( x2 - x1 ) / dt1 - ( x3 - x1 ) / ( dt1 + dt2 ) + ( x3 - x2 ) / dt2;\n\n\t\t\t// rescale tangents for parametrization in [0,1]\n\t\t\tt1 *= dt1;\n\t\t\tt2 *= dt1;\n\n\t\t\tinit( x1, x2, t1, t2 );\n\n\t\t},\n\n\t\tcalc: function ( t ) {\n\n\t\t\tconst t2 = t * t;\n\t\t\tconst t3 = t2 * t;\n\t\t\treturn c0 + c1 * t + c2 * t2 + c3 * t3;\n\n\t\t}\n\n\t};\n\n}\n\n//\n\nconst tmp = new Vector3();\nconst px = new CubicPoly(), py = new CubicPoly(), pz = new CubicPoly();\n\nclass CatmullRomCurve3 extends Curve {\n\n\tconstructor( points = [], closed = false, curveType = 'centripetal', tension = 0.5 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CatmullRomCurve3';\n\n\t\tthis.points = points;\n\t\tthis.closed = closed;\n\t\tthis.curveType = curveType;\n\t\tthis.tension = tension;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst points = this.points;\n\t\tconst l = points.length;\n\n\t\tconst p = ( l - ( this.closed ? 0 : 1 ) ) * t;\n\t\tlet intPoint = Math.floor( p );\n\t\tlet weight = p - intPoint;\n\n\t\tif ( this.closed ) {\n\n\t\t\tintPoint += intPoint > 0 ? 0 : ( Math.floor( Math.abs( intPoint ) / l ) + 1 ) * l;\n\n\t\t} else if ( weight === 0 && intPoint === l - 1 ) {\n\n\t\t\tintPoint = l - 2;\n\t\t\tweight = 1;\n\n\t\t}\n\n\t\tlet p0, p3; // 4 points (p1 & p2 defined below)\n\n\t\tif ( this.closed || intPoint > 0 ) {\n\n\t\t\tp0 = points[ ( intPoint - 1 ) % l ];\n\n\t\t} else {\n\n\t\t\t// extrapolate first point\n\t\t\ttmp.subVectors( points[ 0 ], points[ 1 ] ).add( points[ 0 ] );\n\t\t\tp0 = tmp;\n\n\t\t}\n\n\t\tconst p1 = points[ intPoint % l ];\n\t\tconst p2 = points[ ( intPoint + 1 ) % l ];\n\n\t\tif ( this.closed || intPoint + 2 < l ) {\n\n\t\t\tp3 = points[ ( intPoint + 2 ) % l ];\n\n\t\t} else {\n\n\t\t\t// extrapolate last point\n\t\t\ttmp.subVectors( points[ l - 1 ], points[ l - 2 ] ).add( points[ l - 1 ] );\n\t\t\tp3 = tmp;\n\n\t\t}\n\n\t\tif ( this.curveType === 'centripetal' || this.curveType === 'chordal' ) {\n\n\t\t\t// init Centripetal / Chordal Catmull-Rom\n\t\t\tconst pow = this.curveType === 'chordal' ? 0.5 : 0.25;\n\t\t\tlet dt0 = Math.pow( p0.distanceToSquared( p1 ), pow );\n\t\t\tlet dt1 = Math.pow( p1.distanceToSquared( p2 ), pow );\n\t\t\tlet dt2 = Math.pow( p2.distanceToSquared( p3 ), pow );\n\n\t\t\t// safety check for repeated points\n\t\t\tif ( dt1 < 1e-4 ) dt1 = 1.0;\n\t\t\tif ( dt0 < 1e-4 ) dt0 = dt1;\n\t\t\tif ( dt2 < 1e-4 ) dt2 = dt1;\n\n\t\t\tpx.initNonuniformCatmullRom( p0.x, p1.x, p2.x, p3.x, dt0, dt1, dt2 );\n\t\t\tpy.initNonuniformCatmullRom( p0.y, p1.y, p2.y, p3.y, dt0, dt1, dt2 );\n\t\t\tpz.initNonuniformCatmullRom( p0.z, p1.z, p2.z, p3.z, dt0, dt1, dt2 );\n\n\t\t} else if ( this.curveType === 'catmullrom' ) {\n\n\t\t\tpx.initCatmullRom( p0.x, p1.x, p2.x, p3.x, this.tension );\n\t\t\tpy.initCatmullRom( p0.y, p1.y, p2.y, p3.y, this.tension );\n\t\t\tpz.initCatmullRom( p0.z, p1.z, p2.z, p3.z, this.tension );\n\n\t\t}\n\n\t\tpoint.set(\n\t\t\tpx.calc( weight ),\n\t\t\tpy.calc( weight ),\n\t\t\tpz.calc( weight )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = source.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = source.points[ i ];\n\n\t\t\tthis.points.push( point.clone() );\n\n\t\t}\n\n\t\tthis.closed = source.closed;\n\t\tthis.curveType = source.curveType;\n\t\tthis.tension = source.tension;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.points = [];\n\n\t\tfor ( let i = 0, l = this.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = this.points[ i ];\n\t\t\tdata.points.push( point.toArray() );\n\n\t\t}\n\n\t\tdata.closed = this.closed;\n\t\tdata.curveType = this.curveType;\n\t\tdata.tension = this.tension;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = json.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = json.points[ i ];\n\t\t\tthis.points.push( new Vector3().fromArray( point ) );\n\n\t\t}\n\n\t\tthis.closed = json.closed;\n\t\tthis.curveType = json.curveType;\n\t\tthis.tension = json.tension;\n\n\t\treturn this;\n\n\t}\n\n}\n\nCatmullRomCurve3.prototype.isCatmullRomCurve3 = true;\n\n/**\n * Bezier Curves formulas obtained from\n * https://en.wikipedia.org/wiki/B%C3%A9zier_curve\n */\n\nfunction CatmullRom( t, p0, p1, p2, p3 ) {\n\n\tconst v0 = ( p2 - p0 ) * 0.5;\n\tconst v1 = ( p3 - p1 ) * 0.5;\n\tconst t2 = t * t;\n\tconst t3 = t * t2;\n\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\n\n}\n\n//\n\nfunction QuadraticBezierP0( t, p ) {\n\n\tconst k = 1 - t;\n\treturn k * k * p;\n\n}\n\nfunction QuadraticBezierP1( t, p ) {\n\n\treturn 2 * ( 1 - t ) * t * p;\n\n}\n\nfunction QuadraticBezierP2( t, p ) {\n\n\treturn t * t * p;\n\n}\n\nfunction QuadraticBezier( t, p0, p1, p2 ) {\n\n\treturn QuadraticBezierP0( t, p0 ) + QuadraticBezierP1( t, p1 ) +\n\t\tQuadraticBezierP2( t, p2 );\n\n}\n\n//\n\nfunction CubicBezierP0( t, p ) {\n\n\tconst k = 1 - t;\n\treturn k * k * k * p;\n\n}\n\nfunction CubicBezierP1( t, p ) {\n\n\tconst k = 1 - t;\n\treturn 3 * k * k * t * p;\n\n}\n\nfunction CubicBezierP2( t, p ) {\n\n\treturn 3 * ( 1 - t ) * t * t * p;\n\n}\n\nfunction CubicBezierP3( t, p ) {\n\n\treturn t * t * t * p;\n\n}\n\nfunction CubicBezier( t, p0, p1, p2, p3 ) {\n\n\treturn CubicBezierP0( t, p0 ) + CubicBezierP1( t, p1 ) + CubicBezierP2( t, p2 ) +\n\t\tCubicBezierP3( t, p3 );\n\n}\n\nclass CubicBezierCurve extends Curve {\n\n\tconstructor( v0 = new Vector2(), v1 = new Vector2(), v2 = new Vector2(), v3 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CubicBezierCurve';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\t\tthis.v3 = v3;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\n\n\t\tpoint.set(\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\t\tthis.v3.copy( source.v3 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\t\tdata.v3 = this.v3.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\t\tthis.v3.fromArray( json.v3 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nCubicBezierCurve.prototype.isCubicBezierCurve = true;\n\nclass CubicBezierCurve3 extends Curve {\n\n\tconstructor( v0 = new Vector3(), v1 = new Vector3(), v2 = new Vector3(), v3 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CubicBezierCurve3';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\t\tthis.v3 = v3;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\n\n\t\tpoint.set(\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y ),\n\t\t\tCubicBezier( t, v0.z, v1.z, v2.z, v3.z )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\t\tthis.v3.copy( source.v3 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\t\tdata.v3 = this.v3.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\t\tthis.v3.fromArray( json.v3 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nCubicBezierCurve3.prototype.isCubicBezierCurve3 = true;\n\nclass LineCurve extends Curve {\n\n\tconstructor( v1 = new Vector2(), v2 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'LineCurve';\n\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tif ( t === 1 ) {\n\n\t\t\tpoint.copy( this.v2 );\n\n\t\t} else {\n\n\t\t\tpoint.copy( this.v2 ).sub( this.v1 );\n\t\t\tpoint.multiplyScalar( t ).add( this.v1 );\n\n\t\t}\n\n\t\treturn point;\n\n\t}\n\n\t// Line curve is linear, so we can overwrite default getPointAt\n\tgetPointAt( u, optionalTarget ) {\n\n\t\treturn this.getPoint( u, optionalTarget );\n\n\t}\n\n\tgetTangent( t, optionalTarget ) {\n\n\t\tconst tangent = optionalTarget || new Vector2();\n\n\t\ttangent.copy( this.v2 ).sub( this.v1 ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nLineCurve.prototype.isLineCurve = true;\n\nclass LineCurve3 extends Curve {\n\n\tconstructor( v1 = new Vector3(), v2 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'LineCurve3';\n\t\tthis.isLineCurve3 = true;\n\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tif ( t === 1 ) {\n\n\t\t\tpoint.copy( this.v2 );\n\n\t\t} else {\n\n\t\t\tpoint.copy( this.v2 ).sub( this.v1 );\n\t\t\tpoint.multiplyScalar( t ).add( this.v1 );\n\n\t\t}\n\n\t\treturn point;\n\n\t}\n\t// Line curve is linear, so we can overwrite default getPointAt\n\tgetPointAt( u, optionalTarget ) {\n\n\t\treturn this.getPoint( u, optionalTarget );\n\n\t}\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass QuadraticBezierCurve extends Curve {\n\n\tconstructor( v0 = new Vector2(), v1 = new Vector2(), v2 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'QuadraticBezierCurve';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2;\n\n\t\tpoint.set(\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nQuadraticBezierCurve.prototype.isQuadraticBezierCurve = true;\n\nclass QuadraticBezierCurve3 extends Curve {\n\n\tconstructor( v0 = new Vector3(), v1 = new Vector3(), v2 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'QuadraticBezierCurve3';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2;\n\n\t\tpoint.set(\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y ),\n\t\t\tQuadraticBezier( t, v0.z, v1.z, v2.z )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nQuadraticBezierCurve3.prototype.isQuadraticBezierCurve3 = true;\n\nclass SplineCurve extends Curve {\n\n\tconstructor( points = [] ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'SplineCurve';\n\n\t\tthis.points = points;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst points = this.points;\n\t\tconst p = ( points.length - 1 ) * t;\n\n\t\tconst intPoint = Math.floor( p );\n\t\tconst weight = p - intPoint;\n\n\t\tconst p0 = points[ intPoint === 0 ? intPoint : intPoint - 1 ];\n\t\tconst p1 = points[ intPoint ];\n\t\tconst p2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\n\t\tconst p3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\n\n\t\tpoint.set(\n\t\t\tCatmullRom( weight, p0.x, p1.x, p2.x, p3.x ),\n\t\t\tCatmullRom( weight, p0.y, p1.y, p2.y, p3.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = source.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = source.points[ i ];\n\n\t\t\tthis.points.push( point.clone() );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.points = [];\n\n\t\tfor ( let i = 0, l = this.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = this.points[ i ];\n\t\t\tdata.points.push( point.toArray() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = json.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = json.points[ i ];\n\t\t\tthis.points.push( new Vector2().fromArray( point ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nSplineCurve.prototype.isSplineCurve = true;\n\nvar Curves = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tArcCurve: ArcCurve,\n\tCatmullRomCurve3: CatmullRomCurve3,\n\tCubicBezierCurve: CubicBezierCurve,\n\tCubicBezierCurve3: CubicBezierCurve3,\n\tEllipseCurve: EllipseCurve,\n\tLineCurve: LineCurve,\n\tLineCurve3: LineCurve3,\n\tQuadraticBezierCurve: QuadraticBezierCurve,\n\tQuadraticBezierCurve3: QuadraticBezierCurve3,\n\tSplineCurve: SplineCurve\n});\n\n/**************************************************************\n *\tCurved Path - a curve path is simply a array of connected\n *  curves, but retains the api of a curve\n **************************************************************/\n\nclass CurvePath extends Curve {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'CurvePath';\n\n\t\tthis.curves = [];\n\t\tthis.autoClose = false; // Automatically closes the path\n\n\t}\n\n\tadd( curve ) {\n\n\t\tthis.curves.push( curve );\n\n\t}\n\n\tclosePath() {\n\n\t\t// Add a line curve if start and end of lines are not connected\n\t\tconst startPoint = this.curves[ 0 ].getPoint( 0 );\n\t\tconst endPoint = this.curves[ this.curves.length - 1 ].getPoint( 1 );\n\n\t\tif ( ! startPoint.equals( endPoint ) ) {\n\n\t\t\tthis.curves.push( new LineCurve( endPoint, startPoint ) );\n\n\t\t}\n\n\t}\n\n\t// To get accurate point with reference to\n\t// entire path distance at time t,\n\t// following has to be done:\n\n\t// 1. Length of each sub path have to be known\n\t// 2. Locate and identify type of curve\n\t// 3. Get t for the curve\n\t// 4. Return curve.getPointAt(t')\n\n\tgetPoint( t, optionalTarget ) {\n\n\t\tconst d = t * this.getLength();\n\t\tconst curveLengths = this.getCurveLengths();\n\t\tlet i = 0;\n\n\t\t// To think about boundaries points.\n\n\t\twhile ( i < curveLengths.length ) {\n\n\t\t\tif ( curveLengths[ i ] >= d ) {\n\n\t\t\t\tconst diff = curveLengths[ i ] - d;\n\t\t\t\tconst curve = this.curves[ i ];\n\n\t\t\t\tconst segmentLength = curve.getLength();\n\t\t\t\tconst u = segmentLength === 0 ? 0 : 1 - diff / segmentLength;\n\n\t\t\t\treturn curve.getPointAt( u, optionalTarget );\n\n\t\t\t}\n\n\t\t\ti ++;\n\n\t\t}\n\n\t\treturn null;\n\n\t\t// loop where sum != 0, sum > d , sum+1 <d\n\n\t}\n\n\t// We cannot use the default THREE.Curve getPoint() with getLength() because in\n\t// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\n\t// getPoint() depends on getLength\n\n\tgetLength() {\n\n\t\tconst lens = this.getCurveLengths();\n\t\treturn lens[ lens.length - 1 ];\n\n\t}\n\n\t// cacheLengths must be recalculated.\n\tupdateArcLengths() {\n\n\t\tthis.needsUpdate = true;\n\t\tthis.cacheLengths = null;\n\t\tthis.getCurveLengths();\n\n\t}\n\n\t// Compute lengths and cache them\n\t// We cannot overwrite getLengths() because UtoT mapping uses it.\n\n\tgetCurveLengths() {\n\n\t\t// We use cache values if curves and cache array are same length\n\n\t\tif ( this.cacheLengths && this.cacheLengths.length === this.curves.length ) {\n\n\t\t\treturn this.cacheLengths;\n\n\t\t}\n\n\t\t// Get length of sub-curve\n\t\t// Push sums into cached array\n\n\t\tconst lengths = [];\n\t\tlet sums = 0;\n\n\t\tfor ( let i = 0, l = this.curves.length; i < l; i ++ ) {\n\n\t\t\tsums += this.curves[ i ].getLength();\n\t\t\tlengths.push( sums );\n\n\t\t}\n\n\t\tthis.cacheLengths = lengths;\n\n\t\treturn lengths;\n\n\t}\n\n\tgetSpacedPoints( divisions = 40 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let i = 0; i <= divisions; i ++ ) {\n\n\t\t\tpoints.push( this.getPoint( i / divisions ) );\n\n\t\t}\n\n\t\tif ( this.autoClose ) {\n\n\t\t\tpoints.push( points[ 0 ] );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\tgetPoints( divisions = 12 ) {\n\n\t\tconst points = [];\n\t\tlet last;\n\n\t\tfor ( let i = 0, curves = this.curves; i < curves.length; i ++ ) {\n\n\t\t\tconst curve = curves[ i ];\n\t\t\tconst resolution = ( curve && curve.isEllipseCurve ) ? divisions * 2\n\t\t\t\t: ( curve && ( curve.isLineCurve || curve.isLineCurve3 ) ) ? 1\n\t\t\t\t\t: ( curve && curve.isSplineCurve ) ? divisions * curve.points.length\n\t\t\t\t\t\t: divisions;\n\n\t\t\tconst pts = curve.getPoints( resolution );\n\n\t\t\tfor ( let j = 0; j < pts.length; j ++ ) {\n\n\t\t\t\tconst point = pts[ j ];\n\n\t\t\t\tif ( last && last.equals( point ) ) continue; // ensures no consecutive points are duplicates\n\n\t\t\t\tpoints.push( point );\n\t\t\t\tlast = point;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.autoClose && points.length > 1 && ! points[ points.length - 1 ].equals( points[ 0 ] ) ) {\n\n\t\t\tpoints.push( points[ 0 ] );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.curves = [];\n\n\t\tfor ( let i = 0, l = source.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = source.curves[ i ];\n\n\t\t\tthis.curves.push( curve.clone() );\n\n\t\t}\n\n\t\tthis.autoClose = source.autoClose;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.autoClose = this.autoClose;\n\t\tdata.curves = [];\n\n\t\tfor ( let i = 0, l = this.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = this.curves[ i ];\n\t\t\tdata.curves.push( curve.toJSON() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.autoClose = json.autoClose;\n\t\tthis.curves = [];\n\n\t\tfor ( let i = 0, l = json.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = json.curves[ i ];\n\t\t\tthis.curves.push( new Curves[ curve.type ]().fromJSON( curve ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass Path extends CurvePath {\n\n\tconstructor( points ) {\n\n\t\tsuper();\n\t\tthis.type = 'Path';\n\n\t\tthis.currentPoint = new Vector2();\n\n\t\tif ( points ) {\n\n\t\t\tthis.setFromPoints( points );\n\n\t\t}\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.moveTo( points[ 0 ].x, points[ 0 ].y );\n\n\t\tfor ( let i = 1, l = points.length; i < l; i ++ ) {\n\n\t\t\tthis.lineTo( points[ i ].x, points[ i ].y );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tmoveTo( x, y ) {\n\n\t\tthis.currentPoint.set( x, y ); // TODO consider referencing vectors instead of copying?\n\n\t\treturn this;\n\n\t}\n\n\tlineTo( x, y ) {\n\n\t\tconst curve = new LineCurve( this.currentPoint.clone(), new Vector2( x, y ) );\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tquadraticCurveTo( aCPx, aCPy, aX, aY ) {\n\n\t\tconst curve = new QuadraticBezierCurve(\n\t\t\tthis.currentPoint.clone(),\n\t\t\tnew Vector2( aCPx, aCPy ),\n\t\t\tnew Vector2( aX, aY )\n\t\t);\n\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tbezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\n\n\t\tconst curve = new CubicBezierCurve(\n\t\t\tthis.currentPoint.clone(),\n\t\t\tnew Vector2( aCP1x, aCP1y ),\n\t\t\tnew Vector2( aCP2x, aCP2y ),\n\t\t\tnew Vector2( aX, aY )\n\t\t);\n\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tsplineThru( pts /*Array of Vector*/ ) {\n\n\t\tconst npts = [ this.currentPoint.clone() ].concat( pts );\n\n\t\tconst curve = new SplineCurve( npts );\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.copy( pts[ pts.length - 1 ] );\n\n\t\treturn this;\n\n\t}\n\n\tarc( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tconst x0 = this.currentPoint.x;\n\t\tconst y0 = this.currentPoint.y;\n\n\t\tthis.absarc( aX + x0, aY + y0, aRadius,\n\t\t\taStartAngle, aEndAngle, aClockwise );\n\n\t\treturn this;\n\n\t}\n\n\tabsarc( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tthis.absellipse( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\n\n\t\treturn this;\n\n\t}\n\n\tellipse( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\t\tconst x0 = this.currentPoint.x;\n\t\tconst y0 = this.currentPoint.y;\n\n\t\tthis.absellipse( aX + x0, aY + y0, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\n\n\t\treturn this;\n\n\t}\n\n\tabsellipse( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\t\tconst curve = new EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\n\n\t\tif ( this.curves.length > 0 ) {\n\n\t\t\t// if a previous curve is present, attempt to join\n\t\t\tconst firstPoint = curve.getPoint( 0 );\n\n\t\t\tif ( ! firstPoint.equals( this.currentPoint ) ) {\n\n\t\t\t\tthis.lineTo( firstPoint.x, firstPoint.y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.curves.push( curve );\n\n\t\tconst lastPoint = curve.getPoint( 1 );\n\t\tthis.currentPoint.copy( lastPoint );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.currentPoint.copy( source.currentPoint );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.currentPoint = this.currentPoint.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.currentPoint.fromArray( json.currentPoint );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass Shape extends Path {\n\n\tconstructor( points ) {\n\n\t\tsuper( points );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.type = 'Shape';\n\n\t\tthis.holes = [];\n\n\t}\n\n\tgetPointsHoles( divisions ) {\n\n\t\tconst holesPts = [];\n\n\t\tfor ( let i = 0, l = this.holes.length; i < l; i ++ ) {\n\n\t\t\tholesPts[ i ] = this.holes[ i ].getPoints( divisions );\n\n\t\t}\n\n\t\treturn holesPts;\n\n\t}\n\n\t// get points of shape and holes (keypoints based on segments parameter)\n\n\textractPoints( divisions ) {\n\n\t\treturn {\n\n\t\t\tshape: this.getPoints( divisions ),\n\t\t\tholes: this.getPointsHoles( divisions )\n\n\t\t};\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.holes = [];\n\n\t\tfor ( let i = 0, l = source.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = source.holes[ i ];\n\n\t\t\tthis.holes.push( hole.clone() );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.holes = [];\n\n\t\tfor ( let i = 0, l = this.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = this.holes[ i ];\n\t\t\tdata.holes.push( hole.toJSON() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.uuid = json.uuid;\n\t\tthis.holes = [];\n\n\t\tfor ( let i = 0, l = json.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = json.holes[ i ];\n\t\t\tthis.holes.push( new Path().fromJSON( hole ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\n/**\n * Port from https://github.com/mapbox/earcut (v2.2.2)\n */\n\nconst Earcut = {\n\n\ttriangulate: function ( data, holeIndices, dim = 2 ) {\n\n\t\tconst hasHoles = holeIndices && holeIndices.length;\n\t\tconst outerLen = hasHoles ? holeIndices[ 0 ] * dim : data.length;\n\t\tlet outerNode = linkedList( data, 0, outerLen, dim, true );\n\t\tconst triangles = [];\n\n\t\tif ( ! outerNode || outerNode.next === outerNode.prev ) return triangles;\n\n\t\tlet minX, minY, maxX, maxY, x, y, invSize;\n\n\t\tif ( hasHoles ) outerNode = eliminateHoles( data, holeIndices, outerNode, dim );\n\n\t\t// if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n\t\tif ( data.length > 80 * dim ) {\n\n\t\t\tminX = maxX = data[ 0 ];\n\t\t\tminY = maxY = data[ 1 ];\n\n\t\t\tfor ( let i = dim; i < outerLen; i += dim ) {\n\n\t\t\t\tx = data[ i ];\n\t\t\t\ty = data[ i + 1 ];\n\t\t\t\tif ( x < minX ) minX = x;\n\t\t\t\tif ( y < minY ) minY = y;\n\t\t\t\tif ( x > maxX ) maxX = x;\n\t\t\t\tif ( y > maxY ) maxY = y;\n\n\t\t\t}\n\n\t\t\t// minX, minY and invSize are later used to transform coords into integers for z-order calculation\n\t\t\tinvSize = Math.max( maxX - minX, maxY - minY );\n\t\t\tinvSize = invSize !== 0 ? 1 / invSize : 0;\n\n\t\t}\n\n\t\tearcutLinked( outerNode, triangles, dim, minX, minY, invSize );\n\n\t\treturn triangles;\n\n\t}\n\n};\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList( data, start, end, dim, clockwise ) {\n\n\tlet i, last;\n\n\tif ( clockwise === ( signedArea( data, start, end, dim ) > 0 ) ) {\n\n\t\tfor ( i = start; i < end; i += dim ) last = insertNode( i, data[ i ], data[ i + 1 ], last );\n\n\t} else {\n\n\t\tfor ( i = end - dim; i >= start; i -= dim ) last = insertNode( i, data[ i ], data[ i + 1 ], last );\n\n\t}\n\n\tif ( last && equals( last, last.next ) ) {\n\n\t\tremoveNode( last );\n\t\tlast = last.next;\n\n\t}\n\n\treturn last;\n\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints( start, end ) {\n\n\tif ( ! start ) return start;\n\tif ( ! end ) end = start;\n\n\tlet p = start,\n\t\tagain;\n\tdo {\n\n\t\tagain = false;\n\n\t\tif ( ! p.steiner && ( equals( p, p.next ) || area( p.prev, p, p.next ) === 0 ) ) {\n\n\t\t\tremoveNode( p );\n\t\t\tp = end = p.prev;\n\t\t\tif ( p === p.next ) break;\n\t\t\tagain = true;\n\n\t\t} else {\n\n\t\t\tp = p.next;\n\n\t\t}\n\n\t} while ( again || p !== end );\n\n\treturn end;\n\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked( ear, triangles, dim, minX, minY, invSize, pass ) {\n\n\tif ( ! ear ) return;\n\n\t// interlink polygon nodes in z-order\n\tif ( ! pass && invSize ) indexCurve( ear, minX, minY, invSize );\n\n\tlet stop = ear,\n\t\tprev, next;\n\n\t// iterate through ears, slicing them one by one\n\twhile ( ear.prev !== ear.next ) {\n\n\t\tprev = ear.prev;\n\t\tnext = ear.next;\n\n\t\tif ( invSize ? isEarHashed( ear, minX, minY, invSize ) : isEar( ear ) ) {\n\n\t\t\t// cut off the triangle\n\t\t\ttriangles.push( prev.i / dim );\n\t\t\ttriangles.push( ear.i / dim );\n\t\t\ttriangles.push( next.i / dim );\n\n\t\t\tremoveNode( ear );\n\n\t\t\t// skipping the next vertex leads to less sliver triangles\n\t\t\tear = next.next;\n\t\t\tstop = next.next;\n\n\t\t\tcontinue;\n\n\t\t}\n\n\t\tear = next;\n\n\t\t// if we looped through the whole remaining polygon and can't find any more ears\n\t\tif ( ear === stop ) {\n\n\t\t\t// try filtering points and slicing again\n\t\t\tif ( ! pass ) {\n\n\t\t\t\tearcutLinked( filterPoints( ear ), triangles, dim, minX, minY, invSize, 1 );\n\n\t\t\t\t// if this didn't work, try curing all small self-intersections locally\n\n\t\t\t} else if ( pass === 1 ) {\n\n\t\t\t\tear = cureLocalIntersections( filterPoints( ear ), triangles, dim );\n\t\t\t\tearcutLinked( ear, triangles, dim, minX, minY, invSize, 2 );\n\n\t\t\t\t// as a last resort, try splitting the remaining polygon into two\n\n\t\t\t} else if ( pass === 2 ) {\n\n\t\t\t\tsplitEarcut( ear, triangles, dim, minX, minY, invSize );\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar( ear ) {\n\n\tconst a = ear.prev,\n\t\tb = ear,\n\t\tc = ear.next;\n\n\tif ( area( a, b, c ) >= 0 ) return false; // reflex, can't be an ear\n\n\t// now make sure we don't have other points inside the potential ear\n\tlet p = ear.next.next;\n\n\twhile ( p !== ear.prev ) {\n\n\t\tif ( pointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y ) &&\n\t\t\tarea( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.next;\n\n\t}\n\n\treturn true;\n\n}\n\nfunction isEarHashed( ear, minX, minY, invSize ) {\n\n\tconst a = ear.prev,\n\t\tb = ear,\n\t\tc = ear.next;\n\n\tif ( area( a, b, c ) >= 0 ) return false; // reflex, can't be an ear\n\n\t// triangle bbox; min & max are calculated like this for speed\n\tconst minTX = a.x < b.x ? ( a.x < c.x ? a.x : c.x ) : ( b.x < c.x ? b.x : c.x ),\n\t\tminTY = a.y < b.y ? ( a.y < c.y ? a.y : c.y ) : ( b.y < c.y ? b.y : c.y ),\n\t\tmaxTX = a.x > b.x ? ( a.x > c.x ? a.x : c.x ) : ( b.x > c.x ? b.x : c.x ),\n\t\tmaxTY = a.y > b.y ? ( a.y > c.y ? a.y : c.y ) : ( b.y > c.y ? b.y : c.y );\n\n\t// z-order range for the current triangle bbox;\n\tconst minZ = zOrder( minTX, minTY, minX, minY, invSize ),\n\t\tmaxZ = zOrder( maxTX, maxTY, minX, minY, invSize );\n\n\tlet p = ear.prevZ,\n\t\tn = ear.nextZ;\n\n\t// look for points inside the triangle in both directions\n\twhile ( p && p.z >= minZ && n && n.z <= maxZ ) {\n\n\t\tif ( p !== ear.prev && p !== ear.next &&\n\t\t\tpointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y ) &&\n\t\t\tarea( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.prevZ;\n\n\t\tif ( n !== ear.prev && n !== ear.next &&\n\t\t\tpointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y ) &&\n\t\t\tarea( n.prev, n, n.next ) >= 0 ) return false;\n\t\tn = n.nextZ;\n\n\t}\n\n\t// look for remaining points in decreasing z-order\n\twhile ( p && p.z >= minZ ) {\n\n\t\tif ( p !== ear.prev && p !== ear.next &&\n\t\t\tpointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y ) &&\n\t\t\tarea( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.prevZ;\n\n\t}\n\n\t// look for remaining points in increasing z-order\n\twhile ( n && n.z <= maxZ ) {\n\n\t\tif ( n !== ear.prev && n !== ear.next &&\n\t\t\tpointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y ) &&\n\t\t\tarea( n.prev, n, n.next ) >= 0 ) return false;\n\t\tn = n.nextZ;\n\n\t}\n\n\treturn true;\n\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections( start, triangles, dim ) {\n\n\tlet p = start;\n\tdo {\n\n\t\tconst a = p.prev,\n\t\t\tb = p.next.next;\n\n\t\tif ( ! equals( a, b ) && intersects( a, p, p.next, b ) && locallyInside( a, b ) && locallyInside( b, a ) ) {\n\n\t\t\ttriangles.push( a.i / dim );\n\t\t\ttriangles.push( p.i / dim );\n\t\t\ttriangles.push( b.i / dim );\n\n\t\t\t// remove two nodes involved\n\t\t\tremoveNode( p );\n\t\t\tremoveNode( p.next );\n\n\t\t\tp = start = b;\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\treturn filterPoints( p );\n\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut( start, triangles, dim, minX, minY, invSize ) {\n\n\t// look for a valid diagonal that divides the polygon into two\n\tlet a = start;\n\tdo {\n\n\t\tlet b = a.next.next;\n\t\twhile ( b !== a.prev ) {\n\n\t\t\tif ( a.i !== b.i && isValidDiagonal( a, b ) ) {\n\n\t\t\t\t// split the polygon in two by the diagonal\n\t\t\t\tlet c = splitPolygon( a, b );\n\n\t\t\t\t// filter colinear points around the cuts\n\t\t\t\ta = filterPoints( a, a.next );\n\t\t\t\tc = filterPoints( c, c.next );\n\n\t\t\t\t// run earcut on each half\n\t\t\t\tearcutLinked( a, triangles, dim, minX, minY, invSize );\n\t\t\t\tearcutLinked( c, triangles, dim, minX, minY, invSize );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tb = b.next;\n\n\t\t}\n\n\t\ta = a.next;\n\n\t} while ( a !== start );\n\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles( data, holeIndices, outerNode, dim ) {\n\n\tconst queue = [];\n\tlet i, len, start, end, list;\n\n\tfor ( i = 0, len = holeIndices.length; i < len; i ++ ) {\n\n\t\tstart = holeIndices[ i ] * dim;\n\t\tend = i < len - 1 ? holeIndices[ i + 1 ] * dim : data.length;\n\t\tlist = linkedList( data, start, end, dim, false );\n\t\tif ( list === list.next ) list.steiner = true;\n\t\tqueue.push( getLeftmost( list ) );\n\n\t}\n\n\tqueue.sort( compareX );\n\n\t// process holes from left to right\n\tfor ( i = 0; i < queue.length; i ++ ) {\n\n\t\teliminateHole( queue[ i ], outerNode );\n\t\touterNode = filterPoints( outerNode, outerNode.next );\n\n\t}\n\n\treturn outerNode;\n\n}\n\nfunction compareX( a, b ) {\n\n\treturn a.x - b.x;\n\n}\n\n// find a bridge between vertices that connects hole with an outer ring and and link it\nfunction eliminateHole( hole, outerNode ) {\n\n\touterNode = findHoleBridge( hole, outerNode );\n\tif ( outerNode ) {\n\n\t\tconst b = splitPolygon( outerNode, hole );\n\n\t\t// filter collinear points around the cuts\n\t\tfilterPoints( outerNode, outerNode.next );\n\t\tfilterPoints( b, b.next );\n\n\t}\n\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge( hole, outerNode ) {\n\n\tlet p = outerNode;\n\tconst hx = hole.x;\n\tconst hy = hole.y;\n\tlet qx = - Infinity, m;\n\n\t// find a segment intersected by a ray from the hole's leftmost point to the left;\n\t// segment's endpoint with lesser x will be potential connection point\n\tdo {\n\n\t\tif ( hy <= p.y && hy >= p.next.y && p.next.y !== p.y ) {\n\n\t\t\tconst x = p.x + ( hy - p.y ) * ( p.next.x - p.x ) / ( p.next.y - p.y );\n\t\t\tif ( x <= hx && x > qx ) {\n\n\t\t\t\tqx = x;\n\t\t\t\tif ( x === hx ) {\n\n\t\t\t\t\tif ( hy === p.y ) return p;\n\t\t\t\t\tif ( hy === p.next.y ) return p.next;\n\n\t\t\t\t}\n\n\t\t\t\tm = p.x < p.next.x ? p : p.next;\n\n\t\t\t}\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== outerNode );\n\n\tif ( ! m ) return null;\n\n\tif ( hx === qx ) return m; // hole touches outer segment; pick leftmost endpoint\n\n\t// look for points inside the triangle of hole point, segment intersection and endpoint;\n\t// if there are no points found, we have a valid connection;\n\t// otherwise choose the point of the minimum angle with the ray as connection point\n\n\tconst stop = m,\n\t\tmx = m.x,\n\t\tmy = m.y;\n\tlet tanMin = Infinity, tan;\n\n\tp = m;\n\n\tdo {\n\n\t\tif ( hx >= p.x && p.x >= mx && hx !== p.x &&\n\t\t\t\tpointInTriangle( hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y ) ) {\n\n\t\t\ttan = Math.abs( hy - p.y ) / ( hx - p.x ); // tangential\n\n\t\t\tif ( locallyInside( p, hole ) && ( tan < tanMin || ( tan === tanMin && ( p.x > m.x || ( p.x === m.x && sectorContainsSector( m, p ) ) ) ) ) ) {\n\n\t\t\t\tm = p;\n\t\t\t\ttanMin = tan;\n\n\t\t\t}\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== stop );\n\n\treturn m;\n\n}\n\n// whether sector in vertex m contains sector in vertex p in the same coordinates\nfunction sectorContainsSector( m, p ) {\n\n\treturn area( m.prev, m, p.prev ) < 0 && area( p.next, m, m.next ) < 0;\n\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve( start, minX, minY, invSize ) {\n\n\tlet p = start;\n\tdo {\n\n\t\tif ( p.z === null ) p.z = zOrder( p.x, p.y, minX, minY, invSize );\n\t\tp.prevZ = p.prev;\n\t\tp.nextZ = p.next;\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\tp.prevZ.nextZ = null;\n\tp.prevZ = null;\n\n\tsortLinked( p );\n\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked( list ) {\n\n\tlet i, p, q, e, tail, numMerges, pSize, qSize,\n\t\tinSize = 1;\n\n\tdo {\n\n\t\tp = list;\n\t\tlist = null;\n\t\ttail = null;\n\t\tnumMerges = 0;\n\n\t\twhile ( p ) {\n\n\t\t\tnumMerges ++;\n\t\t\tq = p;\n\t\t\tpSize = 0;\n\t\t\tfor ( i = 0; i < inSize; i ++ ) {\n\n\t\t\t\tpSize ++;\n\t\t\t\tq = q.nextZ;\n\t\t\t\tif ( ! q ) break;\n\n\t\t\t}\n\n\t\t\tqSize = inSize;\n\n\t\t\twhile ( pSize > 0 || ( qSize > 0 && q ) ) {\n\n\t\t\t\tif ( pSize !== 0 && ( qSize === 0 || ! q || p.z <= q.z ) ) {\n\n\t\t\t\t\te = p;\n\t\t\t\t\tp = p.nextZ;\n\t\t\t\t\tpSize --;\n\n\t\t\t\t} else {\n\n\t\t\t\t\te = q;\n\t\t\t\t\tq = q.nextZ;\n\t\t\t\t\tqSize --;\n\n\t\t\t\t}\n\n\t\t\t\tif ( tail ) tail.nextZ = e;\n\t\t\t\telse list = e;\n\n\t\t\t\te.prevZ = tail;\n\t\t\t\ttail = e;\n\n\t\t\t}\n\n\t\t\tp = q;\n\n\t\t}\n\n\t\ttail.nextZ = null;\n\t\tinSize *= 2;\n\n\t} while ( numMerges > 1 );\n\n\treturn list;\n\n}\n\n// z-order of a point given coords and inverse of the longer side of data bbox\nfunction zOrder( x, y, minX, minY, invSize ) {\n\n\t// coords are transformed into non-negative 15-bit integer range\n\tx = 32767 * ( x - minX ) * invSize;\n\ty = 32767 * ( y - minY ) * invSize;\n\n\tx = ( x | ( x << 8 ) ) & 0x00FF00FF;\n\tx = ( x | ( x << 4 ) ) & 0x0F0F0F0F;\n\tx = ( x | ( x << 2 ) ) & 0x33333333;\n\tx = ( x | ( x << 1 ) ) & 0x55555555;\n\n\ty = ( y | ( y << 8 ) ) & 0x00FF00FF;\n\ty = ( y | ( y << 4 ) ) & 0x0F0F0F0F;\n\ty = ( y | ( y << 2 ) ) & 0x33333333;\n\ty = ( y | ( y << 1 ) ) & 0x55555555;\n\n\treturn x | ( y << 1 );\n\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost( start ) {\n\n\tlet p = start,\n\t\tleftmost = start;\n\tdo {\n\n\t\tif ( p.x < leftmost.x || ( p.x === leftmost.x && p.y < leftmost.y ) ) leftmost = p;\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\treturn leftmost;\n\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle( ax, ay, bx, by, cx, cy, px, py ) {\n\n\treturn ( cx - px ) * ( ay - py ) - ( ax - px ) * ( cy - py ) >= 0 &&\n\t\t\t( ax - px ) * ( by - py ) - ( bx - px ) * ( ay - py ) >= 0 &&\n\t\t\t( bx - px ) * ( cy - py ) - ( cx - px ) * ( by - py ) >= 0;\n\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal( a, b ) {\n\n\treturn a.next.i !== b.i && a.prev.i !== b.i && ! intersectsPolygon( a, b ) && // dones't intersect other edges\n\t\t( locallyInside( a, b ) && locallyInside( b, a ) && middleInside( a, b ) && // locally visible\n\t\t( area( a.prev, a, b.prev ) || area( a, b.prev, b ) ) || // does not create opposite-facing sectors\n\t\tequals( a, b ) && area( a.prev, a, a.next ) > 0 && area( b.prev, b, b.next ) > 0 ); // special zero-length case\n\n}\n\n// signed area of a triangle\nfunction area( p, q, r ) {\n\n\treturn ( q.y - p.y ) * ( r.x - q.x ) - ( q.x - p.x ) * ( r.y - q.y );\n\n}\n\n// check if two points are equal\nfunction equals( p1, p2 ) {\n\n\treturn p1.x === p2.x && p1.y === p2.y;\n\n}\n\n// check if two segments intersect\nfunction intersects( p1, q1, p2, q2 ) {\n\n\tconst o1 = sign( area( p1, q1, p2 ) );\n\tconst o2 = sign( area( p1, q1, q2 ) );\n\tconst o3 = sign( area( p2, q2, p1 ) );\n\tconst o4 = sign( area( p2, q2, q1 ) );\n\n\tif ( o1 !== o2 && o3 !== o4 ) return true; // general case\n\n\tif ( o1 === 0 && onSegment( p1, p2, q1 ) ) return true; // p1, q1 and p2 are collinear and p2 lies on p1q1\n\tif ( o2 === 0 && onSegment( p1, q2, q1 ) ) return true; // p1, q1 and q2 are collinear and q2 lies on p1q1\n\tif ( o3 === 0 && onSegment( p2, p1, q2 ) ) return true; // p2, q2 and p1 are collinear and p1 lies on p2q2\n\tif ( o4 === 0 && onSegment( p2, q1, q2 ) ) return true; // p2, q2 and q1 are collinear and q1 lies on p2q2\n\n\treturn false;\n\n}\n\n// for collinear points p, q, r, check if point q lies on segment pr\nfunction onSegment( p, q, r ) {\n\n\treturn q.x <= Math.max( p.x, r.x ) && q.x >= Math.min( p.x, r.x ) && q.y <= Math.max( p.y, r.y ) && q.y >= Math.min( p.y, r.y );\n\n}\n\nfunction sign( num ) {\n\n\treturn num > 0 ? 1 : num < 0 ? - 1 : 0;\n\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon( a, b ) {\n\n\tlet p = a;\n\tdo {\n\n\t\tif ( p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n\t\t\t\tintersects( p, p.next, a, b ) ) return true;\n\t\tp = p.next;\n\n\t} while ( p !== a );\n\n\treturn false;\n\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside( a, b ) {\n\n\treturn area( a.prev, a, a.next ) < 0 ?\n\t\tarea( a, b, a.next ) >= 0 && area( a, a.prev, b ) >= 0 :\n\t\tarea( a, b, a.prev ) < 0 || area( a, a.next, b ) < 0;\n\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside( a, b ) {\n\n\tlet p = a,\n\t\tinside = false;\n\tconst px = ( a.x + b.x ) / 2,\n\t\tpy = ( a.y + b.y ) / 2;\n\tdo {\n\n\t\tif ( ( ( p.y > py ) !== ( p.next.y > py ) ) && p.next.y !== p.y &&\n\t\t\t\t( px < ( p.next.x - p.x ) * ( py - p.y ) / ( p.next.y - p.y ) + p.x ) )\n\t\t\tinside = ! inside;\n\t\tp = p.next;\n\n\t} while ( p !== a );\n\n\treturn inside;\n\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon( a, b ) {\n\n\tconst a2 = new Node( a.i, a.x, a.y ),\n\t\tb2 = new Node( b.i, b.x, b.y ),\n\t\tan = a.next,\n\t\tbp = b.prev;\n\n\ta.next = b;\n\tb.prev = a;\n\n\ta2.next = an;\n\tan.prev = a2;\n\n\tb2.next = a2;\n\ta2.prev = b2;\n\n\tbp.next = b2;\n\tb2.prev = bp;\n\n\treturn b2;\n\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode( i, x, y, last ) {\n\n\tconst p = new Node( i, x, y );\n\n\tif ( ! last ) {\n\n\t\tp.prev = p;\n\t\tp.next = p;\n\n\t} else {\n\n\t\tp.next = last.next;\n\t\tp.prev = last;\n\t\tlast.next.prev = p;\n\t\tlast.next = p;\n\n\t}\n\n\treturn p;\n\n}\n\nfunction removeNode( p ) {\n\n\tp.next.prev = p.prev;\n\tp.prev.next = p.next;\n\n\tif ( p.prevZ ) p.prevZ.nextZ = p.nextZ;\n\tif ( p.nextZ ) p.nextZ.prevZ = p.prevZ;\n\n}\n\nfunction Node( i, x, y ) {\n\n\t// vertex index in coordinates array\n\tthis.i = i;\n\n\t// vertex coordinates\n\tthis.x = x;\n\tthis.y = y;\n\n\t// previous and next vertex nodes in a polygon ring\n\tthis.prev = null;\n\tthis.next = null;\n\n\t// z-order curve value\n\tthis.z = null;\n\n\t// previous and next nodes in z-order\n\tthis.prevZ = null;\n\tthis.nextZ = null;\n\n\t// indicates whether this is a steiner point\n\tthis.steiner = false;\n\n}\n\nfunction signedArea( data, start, end, dim ) {\n\n\tlet sum = 0;\n\tfor ( let i = start, j = end - dim; i < end; i += dim ) {\n\n\t\tsum += ( data[ j ] - data[ i ] ) * ( data[ i + 1 ] + data[ j + 1 ] );\n\t\tj = i;\n\n\t}\n\n\treturn sum;\n\n}\n\nclass ShapeUtils {\n\n\t// calculate area of the contour polygon\n\n\tstatic area( contour ) {\n\n\t\tconst n = contour.length;\n\t\tlet a = 0.0;\n\n\t\tfor ( let p = n - 1, q = 0; q < n; p = q ++ ) {\n\n\t\t\ta += contour[ p ].x * contour[ q ].y - contour[ q ].x * contour[ p ].y;\n\n\t\t}\n\n\t\treturn a * 0.5;\n\n\t}\n\n\tstatic isClockWise( pts ) {\n\n\t\treturn ShapeUtils.area( pts ) < 0;\n\n\t}\n\n\tstatic triangulateShape( contour, holes ) {\n\n\t\tconst vertices = []; // flat array of vertices like [ x0,y0, x1,y1, x2,y2, ... ]\n\t\tconst holeIndices = []; // array of hole indices\n\t\tconst faces = []; // final array of vertex indices like [ [ a,b,d ], [ b,c,d ] ]\n\n\t\tremoveDupEndPts( contour );\n\t\taddContour( vertices, contour );\n\n\t\t//\n\n\t\tlet holeIndex = contour.length;\n\n\t\tholes.forEach( removeDupEndPts );\n\n\t\tfor ( let i = 0; i < holes.length; i ++ ) {\n\n\t\t\tholeIndices.push( holeIndex );\n\t\t\tholeIndex += holes[ i ].length;\n\t\t\taddContour( vertices, holes[ i ] );\n\n\t\t}\n\n\t\t//\n\n\t\tconst triangles = Earcut.triangulate( vertices, holeIndices );\n\n\t\t//\n\n\t\tfor ( let i = 0; i < triangles.length; i += 3 ) {\n\n\t\t\tfaces.push( triangles.slice( i, i + 3 ) );\n\n\t\t}\n\n\t\treturn faces;\n\n\t}\n\n}\n\nfunction removeDupEndPts( points ) {\n\n\tconst l = points.length;\n\n\tif ( l > 2 && points[ l - 1 ].equals( points[ 0 ] ) ) {\n\n\t\tpoints.pop();\n\n\t}\n\n}\n\nfunction addContour( vertices, contour ) {\n\n\tfor ( let i = 0; i < contour.length; i ++ ) {\n\n\t\tvertices.push( contour[ i ].x );\n\t\tvertices.push( contour[ i ].y );\n\n\t}\n\n}\n\n/**\n * Creates extruded geometry from a path shape.\n *\n * parameters = {\n *\n *  curveSegments: <int>, // number of points on the curves\n *  steps: <int>, // number of points for z-side extrusions / used for subdividing segments of extrude spline too\n *  depth: <float>, // Depth to extrude the shape\n *\n *  bevelEnabled: <bool>, // turn on bevel\n *  bevelThickness: <float>, // how deep into the original shape bevel goes\n *  bevelSize: <float>, // how far from shape outline (including bevelOffset) is bevel\n *  bevelOffset: <float>, // how far from shape outline does bevel start\n *  bevelSegments: <int>, // number of bevel layers\n *\n *  extrudePath: <THREE.Curve> // curve to extrude shape along\n *\n *  UVGenerator: <Object> // object that provides UV generator functions\n *\n * }\n */\n\nclass ExtrudeGeometry extends BufferGeometry {\n\n\tconstructor( shapes = new Shape( [ new Vector2( 0.5, 0.5 ), new Vector2( - 0.5, 0.5 ), new Vector2( - 0.5, - 0.5 ), new Vector2( 0.5, - 0.5 ) ] ), options = {} ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ExtrudeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tshapes: shapes,\n\t\t\toptions: options\n\t\t};\n\n\t\tshapes = Array.isArray( shapes ) ? shapes : [ shapes ];\n\n\t\tconst scope = this;\n\n\t\tconst verticesArray = [];\n\t\tconst uvArray = [];\n\n\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\tconst shape = shapes[ i ];\n\t\t\taddShape( shape );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( verticesArray, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvArray, 2 ) );\n\n\t\tthis.computeVertexNormals();\n\n\t\t// functions\n\n\t\tfunction addShape( shape ) {\n\n\t\t\tconst placeholder = [];\n\n\t\t\t// options\n\n\t\t\tconst curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\n\t\t\tconst steps = options.steps !== undefined ? options.steps : 1;\n\t\t\tlet depth = options.depth !== undefined ? options.depth : 1;\n\n\t\t\tlet bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true;\n\t\t\tlet bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 0.2;\n\t\t\tlet bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 0.1;\n\t\t\tlet bevelOffset = options.bevelOffset !== undefined ? options.bevelOffset : 0;\n\t\t\tlet bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\n\n\t\t\tconst extrudePath = options.extrudePath;\n\n\t\t\tconst uvgen = options.UVGenerator !== undefined ? options.UVGenerator : WorldUVGenerator;\n\n\t\t\t// deprecated options\n\n\t\t\tif ( options.amount !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.ExtrudeBufferGeometry: amount has been renamed to depth.' );\n\t\t\t\tdepth = options.amount;\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tlet extrudePts, extrudeByPath = false;\n\t\t\tlet splineTube, binormal, normal, position2;\n\n\t\t\tif ( extrudePath ) {\n\n\t\t\t\textrudePts = extrudePath.getSpacedPoints( steps );\n\n\t\t\t\textrudeByPath = true;\n\t\t\t\tbevelEnabled = false; // bevels not supported for path extrusion\n\n\t\t\t\t// SETUP TNB variables\n\n\t\t\t\t// TODO1 - have a .isClosed in spline?\n\n\t\t\t\tsplineTube = extrudePath.computeFrenetFrames( steps, false );\n\n\t\t\t\t// console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\n\n\t\t\t\tbinormal = new Vector3();\n\t\t\t\tnormal = new Vector3();\n\t\t\t\tposition2 = new Vector3();\n\n\t\t\t}\n\n\t\t\t// Safeguards if bevels are not enabled\n\n\t\t\tif ( ! bevelEnabled ) {\n\n\t\t\t\tbevelSegments = 0;\n\t\t\t\tbevelThickness = 0;\n\t\t\t\tbevelSize = 0;\n\t\t\t\tbevelOffset = 0;\n\n\t\t\t}\n\n\t\t\t// Variables initialization\n\n\t\t\tconst shapePoints = shape.extractPoints( curveSegments );\n\n\t\t\tlet vertices = shapePoints.shape;\n\t\t\tconst holes = shapePoints.holes;\n\n\t\t\tconst reverse = ! ShapeUtils.isClockWise( vertices );\n\n\t\t\tif ( reverse ) {\n\n\t\t\t\tvertices = vertices.reverse();\n\n\t\t\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe ...\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\t\tif ( ShapeUtils.isClockWise( ahole ) ) {\n\n\t\t\t\t\t\tholes[ h ] = ahole.reverse();\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\tconst faces = ShapeUtils.triangulateShape( vertices, holes );\n\n\t\t\t/* Vertices */\n\n\t\t\tconst contour = vertices; // vertices has all points but contour has only points of circumference\n\n\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\tvertices = vertices.concat( ahole );\n\n\t\t\t}\n\n\n\t\t\tfunction scalePt2( pt, vec, size ) {\n\n\t\t\t\tif ( ! vec ) console.error( 'THREE.ExtrudeGeometry: vec does not exist' );\n\n\t\t\t\treturn vec.clone().multiplyScalar( size ).add( pt );\n\n\t\t\t}\n\n\t\t\tconst vlen = vertices.length, flen = faces.length;\n\n\n\t\t\t// Find directions for point movement\n\n\n\t\t\tfunction getBevelVec( inPt, inPrev, inNext ) {\n\n\t\t\t\t// computes for inPt the corresponding point inPt' on a new contour\n\t\t\t\t//   shifted by 1 unit (length of normalized vector) to the left\n\t\t\t\t// if we walk along contour clockwise, this new contour is outside the old one\n\t\t\t\t//\n\t\t\t\t// inPt' is the intersection of the two lines parallel to the two\n\t\t\t\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\n\n\t\t\t\tlet v_trans_x, v_trans_y, shrink_by; // resulting translation vector for inPt\n\n\t\t\t\t// good reading for geometry algorithms (here: line-line intersection)\n\t\t\t\t// http://geomalgorithms.com/a05-_intersect-1.html\n\n\t\t\t\tconst v_prev_x = inPt.x - inPrev.x,\n\t\t\t\t\tv_prev_y = inPt.y - inPrev.y;\n\t\t\t\tconst v_next_x = inNext.x - inPt.x,\n\t\t\t\t\tv_next_y = inNext.y - inPt.y;\n\n\t\t\t\tconst v_prev_lensq = ( v_prev_x * v_prev_x + v_prev_y * v_prev_y );\n\n\t\t\t\t// check for collinear edges\n\t\t\t\tconst collinear0 = ( v_prev_x * v_next_y - v_prev_y * v_next_x );\n\n\t\t\t\tif ( Math.abs( collinear0 ) > Number.EPSILON ) {\n\n\t\t\t\t\t// not collinear\n\n\t\t\t\t\t// length of vectors for normalizing\n\n\t\t\t\t\tconst v_prev_len = Math.sqrt( v_prev_lensq );\n\t\t\t\t\tconst v_next_len = Math.sqrt( v_next_x * v_next_x + v_next_y * v_next_y );\n\n\t\t\t\t\t// shift adjacent points by unit vectors to the left\n\n\t\t\t\t\tconst ptPrevShift_x = ( inPrev.x - v_prev_y / v_prev_len );\n\t\t\t\t\tconst ptPrevShift_y = ( inPrev.y + v_prev_x / v_prev_len );\n\n\t\t\t\t\tconst ptNextShift_x = ( inNext.x - v_next_y / v_next_len );\n\t\t\t\t\tconst ptNextShift_y = ( inNext.y + v_next_x / v_next_len );\n\n\t\t\t\t\t// scaling factor for v_prev to intersection point\n\n\t\t\t\t\tconst sf = ( ( ptNextShift_x - ptPrevShift_x ) * v_next_y -\n\t\t\t\t\t\t\t( ptNextShift_y - ptPrevShift_y ) * v_next_x ) /\n\t\t\t\t\t\t( v_prev_x * v_next_y - v_prev_y * v_next_x );\n\n\t\t\t\t\t// vector from inPt to intersection point\n\n\t\t\t\t\tv_trans_x = ( ptPrevShift_x + v_prev_x * sf - inPt.x );\n\t\t\t\t\tv_trans_y = ( ptPrevShift_y + v_prev_y * sf - inPt.y );\n\n\t\t\t\t\t// Don't normalize!, otherwise sharp corners become ugly\n\t\t\t\t\t//  but prevent crazy spikes\n\t\t\t\t\tconst v_trans_lensq = ( v_trans_x * v_trans_x + v_trans_y * v_trans_y );\n\t\t\t\t\tif ( v_trans_lensq <= 2 ) {\n\n\t\t\t\t\t\treturn new Vector2( v_trans_x, v_trans_y );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_trans_lensq / 2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// handle special case of collinear edges\n\n\t\t\t\t\tlet direction_eq = false; // assumes: opposite\n\n\t\t\t\t\tif ( v_prev_x > Number.EPSILON ) {\n\n\t\t\t\t\t\tif ( v_next_x > Number.EPSILON ) {\n\n\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( v_prev_x < - Number.EPSILON ) {\n\n\t\t\t\t\t\t\tif ( v_next_x < - Number.EPSILON ) {\n\n\t\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tif ( Math.sign( v_prev_y ) === Math.sign( v_next_y ) ) {\n\n\t\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( direction_eq ) {\n\n\t\t\t\t\t\t// console.log(\"Warning: lines are a straight sequence\");\n\t\t\t\t\t\tv_trans_x = - v_prev_y;\n\t\t\t\t\t\tv_trans_y = v_prev_x;\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// console.log(\"Warning: lines are a straight spike\");\n\t\t\t\t\t\tv_trans_x = v_prev_x;\n\t\t\t\t\t\tv_trans_y = v_prev_y;\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq / 2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn new Vector2( v_trans_x / shrink_by, v_trans_y / shrink_by );\n\n\t\t\t}\n\n\n\t\t\tconst contourMovements = [];\n\n\t\t\tfor ( let i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\n\n\t\t\t\tif ( j === il ) j = 0;\n\t\t\t\tif ( k === il ) k = 0;\n\n\t\t\t\t//  (j)---(i)---(k)\n\t\t\t\t// console.log('i,j,k', i, j , k)\n\n\t\t\t\tcontourMovements[ i ] = getBevelVec( contour[ i ], contour[ j ], contour[ k ] );\n\n\t\t\t}\n\n\t\t\tconst holesMovements = [];\n\t\t\tlet oneHoleMovements, verticesMovements = contourMovements.concat();\n\n\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\toneHoleMovements = [];\n\n\t\t\t\tfor ( let i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\n\n\t\t\t\t\tif ( j === il ) j = 0;\n\t\t\t\t\tif ( k === il ) k = 0;\n\n\t\t\t\t\t//  (j)---(i)---(k)\n\t\t\t\t\toneHoleMovements[ i ] = getBevelVec( ahole[ i ], ahole[ j ], ahole[ k ] );\n\n\t\t\t\t}\n\n\t\t\t\tholesMovements.push( oneHoleMovements );\n\t\t\t\tverticesMovements = verticesMovements.concat( oneHoleMovements );\n\n\t\t\t}\n\n\n\t\t\t// Loop bevelSegments, 1 for the front, 1 for the back\n\n\t\t\tfor ( let b = 0; b < bevelSegments; b ++ ) {\n\n\t\t\t\t//for ( b = bevelSegments; b > 0; b -- ) {\n\n\t\t\t\tconst t = b / bevelSegments;\n\t\t\t\tconst z = bevelThickness * Math.cos( t * Math.PI / 2 );\n\t\t\t\tconst bs = bevelSize * Math.sin( t * Math.PI / 2 ) + bevelOffset;\n\n\t\t\t\t// contract shape\n\n\t\t\t\tfor ( let i = 0, il = contour.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst vert = scalePt2( contour[ i ], contourMovements[ i ], bs );\n\n\t\t\t\t\tv( vert.x, vert.y, - z );\n\n\t\t\t\t}\n\n\t\t\t\t// expand holes\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\toneHoleMovements = holesMovements[ h ];\n\n\t\t\t\t\tfor ( let i = 0, il = ahole.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst vert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\n\n\t\t\t\t\t\tv( vert.x, vert.y, - z );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst bs = bevelSize + bevelOffset;\n\n\t\t\t// Back facing vertices\n\n\t\t\tfor ( let i = 0; i < vlen; i ++ ) {\n\n\t\t\t\tconst vert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\n\n\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\tv( vert.x, vert.y, 0 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\n\n\t\t\t\t\tnormal.copy( splineTube.normals[ 0 ] ).multiplyScalar( vert.x );\n\t\t\t\t\tbinormal.copy( splineTube.binormals[ 0 ] ).multiplyScalar( vert.y );\n\n\t\t\t\t\tposition2.copy( extrudePts[ 0 ] ).add( normal ).add( binormal );\n\n\t\t\t\t\tv( position2.x, position2.y, position2.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Add stepped vertices...\n\t\t\t// Including front facing vertices\n\n\t\t\tfor ( let s = 1; s <= steps; s ++ ) {\n\n\t\t\t\tfor ( let i = 0; i < vlen; i ++ ) {\n\n\t\t\t\t\tconst vert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\n\n\t\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\t\tv( vert.x, vert.y, depth / steps * s );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\n\n\t\t\t\t\t\tnormal.copy( splineTube.normals[ s ] ).multiplyScalar( vert.x );\n\t\t\t\t\t\tbinormal.copy( splineTube.binormals[ s ] ).multiplyScalar( vert.y );\n\n\t\t\t\t\t\tposition2.copy( extrudePts[ s ] ).add( normal ).add( binormal );\n\n\t\t\t\t\t\tv( position2.x, position2.y, position2.z );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\t// Add bevel segments planes\n\n\t\t\t//for ( b = 1; b <= bevelSegments; b ++ ) {\n\t\t\tfor ( let b = bevelSegments - 1; b >= 0; b -- ) {\n\n\t\t\t\tconst t = b / bevelSegments;\n\t\t\t\tconst z = bevelThickness * Math.cos( t * Math.PI / 2 );\n\t\t\t\tconst bs = bevelSize * Math.sin( t * Math.PI / 2 ) + bevelOffset;\n\n\t\t\t\t// contract shape\n\n\t\t\t\tfor ( let i = 0, il = contour.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst vert = scalePt2( contour[ i ], contourMovements[ i ], bs );\n\t\t\t\t\tv( vert.x, vert.y, depth + z );\n\n\t\t\t\t}\n\n\t\t\t\t// expand holes\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\toneHoleMovements = holesMovements[ h ];\n\n\t\t\t\t\tfor ( let i = 0, il = ahole.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst vert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\n\n\t\t\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\t\t\tv( vert.x, vert.y, depth + z );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tv( vert.x, vert.y + extrudePts[ steps - 1 ].y, extrudePts[ steps - 1 ].x + z );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t/* Faces */\n\n\t\t\t// Top and bottom faces\n\n\t\t\tbuildLidFaces();\n\n\t\t\t// Sides faces\n\n\t\t\tbuildSideFaces();\n\n\n\t\t\t/////  Internal functions\n\n\t\t\tfunction buildLidFaces() {\n\n\t\t\t\tconst start = verticesArray.length / 3;\n\n\t\t\t\tif ( bevelEnabled ) {\n\n\t\t\t\t\tlet layer = 0; // steps + 1\n\t\t\t\t\tlet offset = vlen * layer;\n\n\t\t\t\t\t// Bottom faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 2 ] + offset, face[ 1 ] + offset, face[ 0 ] + offset );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlayer = steps + bevelSegments * 2;\n\t\t\t\t\toffset = vlen * layer;\n\n\t\t\t\t\t// Top faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 0 ] + offset, face[ 1 ] + offset, face[ 2 ] + offset );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Bottom faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 2 ], face[ 1 ], face[ 0 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Top faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 0 ] + vlen * steps, face[ 1 ] + vlen * steps, face[ 2 ] + vlen * steps );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tscope.addGroup( start, verticesArray.length / 3 - start, 0 );\n\n\t\t\t}\n\n\t\t\t// Create faces for the z-sides of the shape\n\n\t\t\tfunction buildSideFaces() {\n\n\t\t\t\tconst start = verticesArray.length / 3;\n\t\t\t\tlet layeroffset = 0;\n\t\t\t\tsidewalls( contour, layeroffset );\n\t\t\t\tlayeroffset += contour.length;\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\tsidewalls( ahole, layeroffset );\n\n\t\t\t\t\t//, true\n\t\t\t\t\tlayeroffset += ahole.length;\n\n\t\t\t\t}\n\n\n\t\t\t\tscope.addGroup( start, verticesArray.length / 3 - start, 1 );\n\n\n\t\t\t}\n\n\t\t\tfunction sidewalls( contour, layeroffset ) {\n\n\t\t\t\tlet i = contour.length;\n\n\t\t\t\twhile ( -- i >= 0 ) {\n\n\t\t\t\t\tconst j = i;\n\t\t\t\t\tlet k = i - 1;\n\t\t\t\t\tif ( k < 0 ) k = contour.length - 1;\n\n\t\t\t\t\t//console.log('b', i,j, i-1, k,vertices.length);\n\n\t\t\t\t\tfor ( let s = 0, sl = ( steps + bevelSegments * 2 ); s < sl; s ++ ) {\n\n\t\t\t\t\t\tconst slen1 = vlen * s;\n\t\t\t\t\t\tconst slen2 = vlen * ( s + 1 );\n\n\t\t\t\t\t\tconst a = layeroffset + j + slen1,\n\t\t\t\t\t\t\tb = layeroffset + k + slen1,\n\t\t\t\t\t\t\tc = layeroffset + k + slen2,\n\t\t\t\t\t\t\td = layeroffset + j + slen2;\n\n\t\t\t\t\t\tf4( a, b, c, d );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction v( x, y, z ) {\n\n\t\t\t\tplaceholder.push( x );\n\t\t\t\tplaceholder.push( y );\n\t\t\t\tplaceholder.push( z );\n\n\t\t\t}\n\n\n\t\t\tfunction f3( a, b, c ) {\n\n\t\t\t\taddVertex( a );\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( c );\n\n\t\t\t\tconst nextIndex = verticesArray.length / 3;\n\t\t\t\tconst uvs = uvgen.generateTopUV( scope, verticesArray, nextIndex - 3, nextIndex - 2, nextIndex - 1 );\n\n\t\t\t\taddUV( uvs[ 0 ] );\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 2 ] );\n\n\t\t\t}\n\n\t\t\tfunction f4( a, b, c, d ) {\n\n\t\t\t\taddVertex( a );\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( d );\n\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( c );\n\t\t\t\taddVertex( d );\n\n\n\t\t\t\tconst nextIndex = verticesArray.length / 3;\n\t\t\t\tconst uvs = uvgen.generateSideWallUV( scope, verticesArray, nextIndex - 6, nextIndex - 3, nextIndex - 2, nextIndex - 1 );\n\n\t\t\t\taddUV( uvs[ 0 ] );\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 3 ] );\n\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 2 ] );\n\t\t\t\taddUV( uvs[ 3 ] );\n\n\t\t\t}\n\n\t\t\tfunction addVertex( index ) {\n\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 0 ] );\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 1 ] );\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 2 ] );\n\n\t\t\t}\n\n\n\t\t\tfunction addUV( vector2 ) {\n\n\t\t\t\tuvArray.push( vector2.x );\n\t\t\t\tuvArray.push( vector2.y );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tconst shapes = this.parameters.shapes;\n\t\tconst options = this.parameters.options;\n\n\t\treturn toJSON$1( shapes, options, data );\n\n\t}\n\n\tstatic fromJSON( data, shapes ) {\n\n\t\tconst geometryShapes = [];\n\n\t\tfor ( let j = 0, jl = data.shapes.length; j < jl; j ++ ) {\n\n\t\t\tconst shape = shapes[ data.shapes[ j ] ];\n\n\t\t\tgeometryShapes.push( shape );\n\n\t\t}\n\n\t\tconst extrudePath = data.options.extrudePath;\n\n\t\tif ( extrudePath !== undefined ) {\n\n\t\t\tdata.options.extrudePath = new Curves[ extrudePath.type ]().fromJSON( extrudePath );\n\n\t\t}\n\n\t\treturn new ExtrudeGeometry( geometryShapes, data.options );\n\n\t}\n\n}\n\nconst WorldUVGenerator = {\n\n\tgenerateTopUV: function ( geometry, vertices, indexA, indexB, indexC ) {\n\n\t\tconst a_x = vertices[ indexA * 3 ];\n\t\tconst a_y = vertices[ indexA * 3 + 1 ];\n\t\tconst b_x = vertices[ indexB * 3 ];\n\t\tconst b_y = vertices[ indexB * 3 + 1 ];\n\t\tconst c_x = vertices[ indexC * 3 ];\n\t\tconst c_y = vertices[ indexC * 3 + 1 ];\n\n\t\treturn [\n\t\t\tnew Vector2( a_x, a_y ),\n\t\t\tnew Vector2( b_x, b_y ),\n\t\t\tnew Vector2( c_x, c_y )\n\t\t];\n\n\t},\n\n\tgenerateSideWallUV: function ( geometry, vertices, indexA, indexB, indexC, indexD ) {\n\n\t\tconst a_x = vertices[ indexA * 3 ];\n\t\tconst a_y = vertices[ indexA * 3 + 1 ];\n\t\tconst a_z = vertices[ indexA * 3 + 2 ];\n\t\tconst b_x = vertices[ indexB * 3 ];\n\t\tconst b_y = vertices[ indexB * 3 + 1 ];\n\t\tconst b_z = vertices[ indexB * 3 + 2 ];\n\t\tconst c_x = vertices[ indexC * 3 ];\n\t\tconst c_y = vertices[ indexC * 3 + 1 ];\n\t\tconst c_z = vertices[ indexC * 3 + 2 ];\n\t\tconst d_x = vertices[ indexD * 3 ];\n\t\tconst d_y = vertices[ indexD * 3 + 1 ];\n\t\tconst d_z = vertices[ indexD * 3 + 2 ];\n\n\t\tif ( Math.abs( a_y - b_y ) < Math.abs( a_x - b_x ) ) {\n\n\t\t\treturn [\n\t\t\t\tnew Vector2( a_x, 1 - a_z ),\n\t\t\t\tnew Vector2( b_x, 1 - b_z ),\n\t\t\t\tnew Vector2( c_x, 1 - c_z ),\n\t\t\t\tnew Vector2( d_x, 1 - d_z )\n\t\t\t];\n\n\t\t} else {\n\n\t\t\treturn [\n\t\t\t\tnew Vector2( a_y, 1 - a_z ),\n\t\t\t\tnew Vector2( b_y, 1 - b_z ),\n\t\t\t\tnew Vector2( c_y, 1 - c_z ),\n\t\t\t\tnew Vector2( d_y, 1 - d_z )\n\t\t\t];\n\n\t\t}\n\n\t}\n\n};\n\nfunction toJSON$1( shapes, options, data ) {\n\n\tdata.shapes = [];\n\n\tif ( Array.isArray( shapes ) ) {\n\n\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\tconst shape = shapes[ i ];\n\n\t\t\tdata.shapes.push( shape.uuid );\n\n\t\t}\n\n\t} else {\n\n\t\tdata.shapes.push( shapes.uuid );\n\n\t}\n\n\tif ( options.extrudePath !== undefined ) data.options.extrudePath = options.extrudePath.toJSON();\n\n\treturn data;\n\n}\n\nclass IcosahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst t = ( 1 + Math.sqrt( 5 ) ) / 2;\n\n\t\tconst vertices = [\n\t\t\t- 1, t, 0, \t1, t, 0, \t- 1, - t, 0, \t1, - t, 0,\n\t\t\t0, - 1, t, \t0, 1, t,\t0, - 1, - t, \t0, 1, - t,\n\t\t\tt, 0, - 1, \tt, 0, 1, \t- t, 0, - 1, \t- t, 0, 1\n\t\t];\n\n\t\tconst indices = [\n\t\t\t0, 11, 5, \t0, 5, 1, \t0, 1, 7, \t0, 7, 10, \t0, 10, 11,\n\t\t\t1, 5, 9, \t5, 11, 4,\t11, 10, 2,\t10, 7, 6,\t7, 1, 8,\n\t\t\t3, 9, 4, \t3, 4, 2,\t3, 2, 6,\t3, 6, 8,\t3, 8, 9,\n\t\t\t4, 9, 5, \t2, 4, 11,\t6, 2, 10,\t8, 6, 7,\t9, 8, 1\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'IcosahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new IcosahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nclass LatheGeometry extends BufferGeometry {\n\n\tconstructor( points = [ new Vector2( 0, 0.5 ), new Vector2( 0.5, 0 ), new Vector2( 0, - 0.5 ) ], segments = 12, phiStart = 0, phiLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'LatheGeometry';\n\n\t\tthis.parameters = {\n\t\t\tpoints: points,\n\t\t\tsegments: segments,\n\t\t\tphiStart: phiStart,\n\t\t\tphiLength: phiLength\n\t\t};\n\n\t\tsegments = Math.floor( segments );\n\n\t\t// clamp phiLength so it's in range of [ 0, 2PI ]\n\n\t\tphiLength = clamp( phiLength, 0, Math.PI * 2 );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst uvs = [];\n\t\tconst initNormals = [];\n\t\tconst normals = [];\n\n\t\t// helper variables\n\n\t\tconst inverseSegments = 1.0 / segments;\n\t\tconst vertex = new Vector3();\n\t\tconst uv = new Vector2();\n\t\tconst normal = new Vector3();\n\t\tconst curNormal = new Vector3();\n\t\tconst prevNormal = new Vector3();\n\t\tlet dx = 0;\n\t\tlet dy = 0;\n\n\t\t// pre-compute normals for initial \"meridian\"\n\n\t\tfor ( let j = 0; j <= ( points.length - 1 ); j ++ ) {\n\n\t\t\tswitch ( j ) {\n\n\t\t\t\tcase 0:\t\t\t\t// special handling for 1st vertex on path\n\n\t\t\t\t\tdx = points[ j + 1 ].x - points[ j ].x;\n\t\t\t\t\tdy = points[ j + 1 ].y - points[ j ].y;\n\n\t\t\t\t\tnormal.x = dy * 1.0;\n\t\t\t\t\tnormal.y = - dx;\n\t\t\t\t\tnormal.z = dy * 0.0;\n\n\t\t\t\t\tprevNormal.copy( normal );\n\n\t\t\t\t\tnormal.normalize();\n\n\t\t\t\t\tinitNormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ( points.length - 1 ):\t// special handling for last Vertex on path\n\n\t\t\t\t\tinitNormals.push( prevNormal.x, prevNormal.y, prevNormal.z );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\t\t\t// default handling for all vertices in between\n\n\t\t\t\t\tdx = points[ j + 1 ].x - points[ j ].x;\n\t\t\t\t\tdy = points[ j + 1 ].y - points[ j ].y;\n\n\t\t\t\t\tnormal.x = dy * 1.0;\n\t\t\t\t\tnormal.y = - dx;\n\t\t\t\t\tnormal.z = dy * 0.0;\n\n\t\t\t\t\tcurNormal.copy( normal );\n\n\t\t\t\t\tnormal.x += prevNormal.x;\n\t\t\t\t\tnormal.y += prevNormal.y;\n\t\t\t\t\tnormal.z += prevNormal.z;\n\n\t\t\t\t\tnormal.normalize();\n\n\t\t\t\t\tinitNormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t\tprevNormal.copy( curNormal );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate vertices, uvs and normals\n\n\t\tfor ( let i = 0; i <= segments; i ++ ) {\n\n\t\t\tconst phi = phiStart + i * inverseSegments * phiLength;\n\n\t\t\tconst sin = Math.sin( phi );\n\t\t\tconst cos = Math.cos( phi );\n\n\t\t\tfor ( let j = 0; j <= ( points.length - 1 ); j ++ ) {\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = points[ j ].x * sin;\n\t\t\t\tvertex.y = points[ j ].y;\n\t\t\t\tvertex.z = points[ j ].x * cos;\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuv.x = i / segments;\n\t\t\t\tuv.y = j / ( points.length - 1 );\n\n\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t\t// normal\n\n\t\t\t\tconst x = initNormals[ 3 * j + 0 ] * sin;\n\t\t\t\tconst y = initNormals[ 3 * j + 1 ];\n\t\t\t\tconst z = initNormals[ 3 * j + 0 ] * cos;\n\n\t\t\t\tnormals.push( x, y, z );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let i = 0; i < segments; i ++ ) {\n\n\t\t\tfor ( let j = 0; j < ( points.length - 1 ); j ++ ) {\n\n\t\t\t\tconst base = j + i * points.length;\n\n\t\t\t\tconst a = base;\n\t\t\t\tconst b = base + points.length;\n\t\t\t\tconst c = base + points.length + 1;\n\t\t\t\tconst d = base + 1;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( c, d, b );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new LatheGeometry( data.points, data.segments, data.phiStart, data.phiLength );\n\n\t}\n\n}\n\nclass OctahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst vertices = [\n\t\t\t1, 0, 0, \t- 1, 0, 0,\t0, 1, 0,\n\t\t\t0, - 1, 0, \t0, 0, 1,\t0, 0, - 1\n\t\t];\n\n\t\tconst indices = [\n\t\t\t0, 2, 4,\t0, 4, 3,\t0, 3, 5,\n\t\t\t0, 5, 2,\t1, 2, 5,\t1, 5, 3,\n\t\t\t1, 3, 4,\t1, 4, 2\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'OctahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new OctahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nclass RingGeometry extends BufferGeometry {\n\n\tconstructor( innerRadius = 0.5, outerRadius = 1, thetaSegments = 8, phiSegments = 1, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'RingGeometry';\n\n\t\tthis.parameters = {\n\t\t\tinnerRadius: innerRadius,\n\t\t\touterRadius: outerRadius,\n\t\t\tthetaSegments: thetaSegments,\n\t\t\tphiSegments: phiSegments,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tthetaSegments = Math.max( 3, thetaSegments );\n\t\tphiSegments = Math.max( 1, phiSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// some helper variables\n\n\t\tlet radius = innerRadius;\n\t\tconst radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\n\t\tconst vertex = new Vector3();\n\t\tconst uv = new Vector2();\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let j = 0; j <= phiSegments; j ++ ) {\n\n\t\t\tfor ( let i = 0; i <= thetaSegments; i ++ ) {\n\n\t\t\t\t// values are generate from the inside of the ring to the outside\n\n\t\t\t\tconst segment = thetaStart + i / thetaSegments * thetaLength;\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = radius * Math.cos( segment );\n\t\t\t\tvertex.y = radius * Math.sin( segment );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t\t// uv\n\n\t\t\t\tuv.x = ( vertex.x / outerRadius + 1 ) / 2;\n\t\t\t\tuv.y = ( vertex.y / outerRadius + 1 ) / 2;\n\n\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t}\n\n\t\t\t// increase the radius for next row of vertices\n\n\t\t\tradius += radiusStep;\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let j = 0; j < phiSegments; j ++ ) {\n\n\t\t\tconst thetaSegmentLevel = j * ( thetaSegments + 1 );\n\n\t\t\tfor ( let i = 0; i < thetaSegments; i ++ ) {\n\n\t\t\t\tconst segment = i + thetaSegmentLevel;\n\n\t\t\t\tconst a = segment;\n\t\t\t\tconst b = segment + thetaSegments + 1;\n\t\t\t\tconst c = segment + thetaSegments + 2;\n\t\t\t\tconst d = segment + 1;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new RingGeometry( data.innerRadius, data.outerRadius, data.thetaSegments, data.phiSegments, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass ShapeGeometry extends BufferGeometry {\n\n\tconstructor( shapes = new Shape( [ new Vector2( 0, 0.5 ), new Vector2( - 0.5, - 0.5 ), new Vector2( 0.5, - 0.5 ) ] ), curveSegments = 12 ) {\n\n\t\tsuper();\n\t\tthis.type = 'ShapeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tshapes: shapes,\n\t\t\tcurveSegments: curveSegments\n\t\t};\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tlet groupStart = 0;\n\t\tlet groupCount = 0;\n\n\t\t// allow single and array values for \"shapes\" parameter\n\n\t\tif ( Array.isArray( shapes ) === false ) {\n\n\t\t\taddShape( shapes );\n\n\t\t} else {\n\n\t\t\tfor ( let i = 0; i < shapes.length; i ++ ) {\n\n\t\t\t\taddShape( shapes[ i ] );\n\n\t\t\t\tthis.addGroup( groupStart, groupCount, i ); // enables MultiMaterial support\n\n\t\t\t\tgroupStart += groupCount;\n\t\t\t\tgroupCount = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\n\t\t// helper functions\n\n\t\tfunction addShape( shape ) {\n\n\t\t\tconst indexOffset = vertices.length / 3;\n\t\t\tconst points = shape.extractPoints( curveSegments );\n\n\t\t\tlet shapeVertices = points.shape;\n\t\t\tconst shapeHoles = points.holes;\n\n\t\t\t// check direction of vertices\n\n\t\t\tif ( ShapeUtils.isClockWise( shapeVertices ) === false ) {\n\n\t\t\t\tshapeVertices = shapeVertices.reverse();\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, l = shapeHoles.length; i < l; i ++ ) {\n\n\t\t\t\tconst shapeHole = shapeHoles[ i ];\n\n\t\t\t\tif ( ShapeUtils.isClockWise( shapeHole ) === true ) {\n\n\t\t\t\t\tshapeHoles[ i ] = shapeHole.reverse();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst faces = ShapeUtils.triangulateShape( shapeVertices, shapeHoles );\n\n\t\t\t// join vertices of inner and outer paths to a single array\n\n\t\t\tfor ( let i = 0, l = shapeHoles.length; i < l; i ++ ) {\n\n\t\t\t\tconst shapeHole = shapeHoles[ i ];\n\t\t\t\tshapeVertices = shapeVertices.concat( shapeHole );\n\n\t\t\t}\n\n\t\t\t// vertices, normals, uvs\n\n\t\t\tfor ( let i = 0, l = shapeVertices.length; i < l; i ++ ) {\n\n\t\t\t\tconst vertex = shapeVertices[ i ];\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, 0 );\n\t\t\t\tnormals.push( 0, 0, 1 );\n\t\t\t\tuvs.push( vertex.x, vertex.y ); // world uvs\n\n\t\t\t}\n\n\t\t\t// incides\n\n\t\t\tfor ( let i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\t\tconst face = faces[ i ];\n\n\t\t\t\tconst a = face[ 0 ] + indexOffset;\n\t\t\t\tconst b = face[ 1 ] + indexOffset;\n\t\t\t\tconst c = face[ 2 ] + indexOffset;\n\n\t\t\t\tindices.push( a, b, c );\n\t\t\t\tgroupCount += 3;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tconst shapes = this.parameters.shapes;\n\n\t\treturn toJSON( shapes, data );\n\n\t}\n\n\tstatic fromJSON( data, shapes ) {\n\n\t\tconst geometryShapes = [];\n\n\t\tfor ( let j = 0, jl = data.shapes.length; j < jl; j ++ ) {\n\n\t\t\tconst shape = shapes[ data.shapes[ j ] ];\n\n\t\t\tgeometryShapes.push( shape );\n\n\t\t}\n\n\t\treturn new ShapeGeometry( geometryShapes, data.curveSegments );\n\n\t}\n\n}\n\nfunction toJSON( shapes, data ) {\n\n\tdata.shapes = [];\n\n\tif ( Array.isArray( shapes ) ) {\n\n\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\tconst shape = shapes[ i ];\n\n\t\t\tdata.shapes.push( shape.uuid );\n\n\t\t}\n\n\t} else {\n\n\t\tdata.shapes.push( shapes.uuid );\n\n\t}\n\n\treturn data;\n\n}\n\nclass SphereGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, widthSegments = 32, heightSegments = 16, phiStart = 0, phiLength = Math.PI * 2, thetaStart = 0, thetaLength = Math.PI ) {\n\n\t\tsuper();\n\t\tthis.type = 'SphereGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\tphiStart: phiStart,\n\t\t\tphiLength: phiLength,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\twidthSegments = Math.max( 3, Math.floor( widthSegments ) );\n\t\theightSegments = Math.max( 2, Math.floor( heightSegments ) );\n\n\t\tconst thetaEnd = Math.min( thetaStart + thetaLength, Math.PI );\n\n\t\tlet index = 0;\n\t\tconst grid = [];\n\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let iy = 0; iy <= heightSegments; iy ++ ) {\n\n\t\t\tconst verticesRow = [];\n\n\t\t\tconst v = iy / heightSegments;\n\n\t\t\t// special case for the poles\n\n\t\t\tlet uOffset = 0;\n\n\t\t\tif ( iy == 0 && thetaStart == 0 ) {\n\n\t\t\t\tuOffset = 0.5 / widthSegments;\n\n\t\t\t} else if ( iy == heightSegments && thetaEnd == Math.PI ) {\n\n\t\t\t\tuOffset = - 0.5 / widthSegments;\n\n\t\t\t}\n\n\t\t\tfor ( let ix = 0; ix <= widthSegments; ix ++ ) {\n\n\t\t\t\tconst u = ix / widthSegments;\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = - radius * Math.cos( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\n\t\t\t\tvertex.y = radius * Math.cos( thetaStart + v * thetaLength );\n\t\t\t\tvertex.z = radius * Math.sin( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormal.copy( vertex ).normalize();\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( u + uOffset, 1 - v );\n\n\t\t\t\tverticesRow.push( index ++ );\n\n\t\t\t}\n\n\t\t\tgrid.push( verticesRow );\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let iy = 0; iy < heightSegments; iy ++ ) {\n\n\t\t\tfor ( let ix = 0; ix < widthSegments; ix ++ ) {\n\n\t\t\t\tconst a = grid[ iy ][ ix + 1 ];\n\t\t\t\tconst b = grid[ iy ][ ix ];\n\t\t\t\tconst c = grid[ iy + 1 ][ ix ];\n\t\t\t\tconst d = grid[ iy + 1 ][ ix + 1 ];\n\n\t\t\t\tif ( iy !== 0 || thetaStart > 0 ) indices.push( a, b, d );\n\t\t\t\tif ( iy !== heightSegments - 1 || thetaEnd < Math.PI ) indices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new SphereGeometry( data.radius, data.widthSegments, data.heightSegments, data.phiStart, data.phiLength, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass TetrahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst vertices = [\n\t\t\t1, 1, 1, \t- 1, - 1, 1, \t- 1, 1, - 1, \t1, - 1, - 1\n\t\t];\n\n\t\tconst indices = [\n\t\t\t2, 1, 0, \t0, 3, 2,\t1, 3, 0,\t2, 3, 1\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'TetrahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new TetrahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nclass TorusGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, tube = 0.4, radialSegments = 8, tubularSegments = 6, arc = Math.PI * 2 ) {\n\n\t\tsuper();\n\t\tthis.type = 'TorusGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\ttube: tube,\n\t\t\tradialSegments: radialSegments,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tarc: arc\n\t\t};\n\n\t\tradialSegments = Math.floor( radialSegments );\n\t\ttubularSegments = Math.floor( tubularSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tconst center = new Vector3();\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\tfor ( let i = 0; i <= tubularSegments; i ++ ) {\n\n\t\t\t\tconst u = i / tubularSegments * arc;\n\t\t\t\tconst v = j / radialSegments * Math.PI * 2;\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = ( radius + tube * Math.cos( v ) ) * Math.cos( u );\n\t\t\t\tvertex.y = ( radius + tube * Math.cos( v ) ) * Math.sin( u );\n\t\t\t\tvertex.z = tube * Math.sin( v );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tcenter.x = radius * Math.cos( u );\n\t\t\t\tcenter.y = radius * Math.sin( u );\n\t\t\t\tnormal.subVectors( vertex, center ).normalize();\n\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( i / tubularSegments );\n\t\t\t\tuvs.push( j / radialSegments );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate indices\n\n\t\tfor ( let j = 1; j <= radialSegments; j ++ ) {\n\n\t\t\tfor ( let i = 1; i <= tubularSegments; i ++ ) {\n\n\t\t\t\t// indices\n\n\t\t\t\tconst a = ( tubularSegments + 1 ) * j + i - 1;\n\t\t\t\tconst b = ( tubularSegments + 1 ) * ( j - 1 ) + i - 1;\n\t\t\t\tconst c = ( tubularSegments + 1 ) * ( j - 1 ) + i;\n\t\t\t\tconst d = ( tubularSegments + 1 ) * j + i;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new TorusGeometry( data.radius, data.tube, data.radialSegments, data.tubularSegments, data.arc );\n\n\t}\n\n}\n\nclass TorusKnotGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, tube = 0.4, tubularSegments = 64, radialSegments = 8, p = 2, q = 3 ) {\n\n\t\tsuper();\n\t\tthis.type = 'TorusKnotGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\ttube: tube,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tradialSegments: radialSegments,\n\t\t\tp: p,\n\t\t\tq: q\n\t\t};\n\n\t\ttubularSegments = Math.floor( tubularSegments );\n\t\tradialSegments = Math.floor( radialSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\n\t\tconst P1 = new Vector3();\n\t\tconst P2 = new Vector3();\n\n\t\tconst B = new Vector3();\n\t\tconst T = new Vector3();\n\t\tconst N = new Vector3();\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let i = 0; i <= tubularSegments; ++ i ) {\n\n\t\t\t// the radian \"u\" is used to calculate the position on the torus curve of the current tubular segement\n\n\t\t\tconst u = i / tubularSegments * p * Math.PI * 2;\n\n\t\t\t// now we calculate two points. P1 is our current position on the curve, P2 is a little farther ahead.\n\t\t\t// these points are used to create a special \"coordinate space\", which is necessary to calculate the correct vertex positions\n\n\t\t\tcalculatePositionOnCurve( u, p, q, radius, P1 );\n\t\t\tcalculatePositionOnCurve( u + 0.01, p, q, radius, P2 );\n\n\t\t\t// calculate orthonormal basis\n\n\t\t\tT.subVectors( P2, P1 );\n\t\t\tN.addVectors( P2, P1 );\n\t\t\tB.crossVectors( T, N );\n\t\t\tN.crossVectors( B, T );\n\n\t\t\t// normalize B, N. T can be ignored, we don't use it\n\n\t\t\tB.normalize();\n\t\t\tN.normalize();\n\n\t\t\tfor ( let j = 0; j <= radialSegments; ++ j ) {\n\n\t\t\t\t// now calculate the vertices. they are nothing more than an extrusion of the torus curve.\n\t\t\t\t// because we extrude a shape in the xy-plane, there is no need to calculate a z-value.\n\n\t\t\t\tconst v = j / radialSegments * Math.PI * 2;\n\t\t\t\tconst cx = - tube * Math.cos( v );\n\t\t\t\tconst cy = tube * Math.sin( v );\n\n\t\t\t\t// now calculate the final vertex position.\n\t\t\t\t// first we orient the extrusion with our basis vectos, then we add it to the current position on the curve\n\n\t\t\t\tvertex.x = P1.x + ( cx * N.x + cy * B.x );\n\t\t\t\tvertex.y = P1.y + ( cx * N.y + cy * B.y );\n\t\t\t\tvertex.z = P1.z + ( cx * N.z + cy * B.z );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal (P1 is always the center/origin of the extrusion, thus we can use it to calculate the normal)\n\n\t\t\t\tnormal.subVectors( vertex, P1 ).normalize();\n\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( i / tubularSegments );\n\t\t\t\tuvs.push( j / radialSegments );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate indices\n\n\t\tfor ( let j = 1; j <= tubularSegments; j ++ ) {\n\n\t\t\tfor ( let i = 1; i <= radialSegments; i ++ ) {\n\n\t\t\t\t// indices\n\n\t\t\t\tconst a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\n\t\t\t\tconst b = ( radialSegments + 1 ) * j + ( i - 1 );\n\t\t\t\tconst c = ( radialSegments + 1 ) * j + i;\n\t\t\t\tconst d = ( radialSegments + 1 ) * ( j - 1 ) + i;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\t// this function calculates the current position on the torus curve\n\n\t\tfunction calculatePositionOnCurve( u, p, q, radius, position ) {\n\n\t\t\tconst cu = Math.cos( u );\n\t\t\tconst su = Math.sin( u );\n\t\t\tconst quOverP = q / p * u;\n\t\t\tconst cs = Math.cos( quOverP );\n\n\t\t\tposition.x = radius * ( 2 + cs ) * 0.5 * cu;\n\t\t\tposition.y = radius * ( 2 + cs ) * su * 0.5;\n\t\t\tposition.z = radius * Math.sin( quOverP ) * 0.5;\n\n\t\t}\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new TorusKnotGeometry( data.radius, data.tube, data.tubularSegments, data.radialSegments, data.p, data.q );\n\n\t}\n\n}\n\nclass TubeGeometry extends BufferGeometry {\n\n\tconstructor( path = new QuadraticBezierCurve3( new Vector3( - 1, - 1, 0 ), new Vector3( - 1, 1, 0 ), new Vector3( 1, 1, 0 ) ), tubularSegments = 64, radius = 1, radialSegments = 8, closed = false ) {\n\n\t\tsuper();\n\t\tthis.type = 'TubeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tpath: path,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tradius: radius,\n\t\t\tradialSegments: radialSegments,\n\t\t\tclosed: closed\n\t\t};\n\n\t\tconst frames = path.computeFrenetFrames( tubularSegments, closed );\n\n\t\t// expose internals\n\n\t\tthis.tangents = frames.tangents;\n\t\tthis.normals = frames.normals;\n\t\tthis.binormals = frames.binormals;\n\n\t\t// helper variables\n\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\t\tconst uv = new Vector2();\n\t\tlet P = new Vector3();\n\n\t\t// buffer\n\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\t\tconst indices = [];\n\n\t\t// create buffer data\n\n\t\tgenerateBufferData();\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\t// functions\n\n\t\tfunction generateBufferData() {\n\n\t\t\tfor ( let i = 0; i < tubularSegments; i ++ ) {\n\n\t\t\t\tgenerateSegment( i );\n\n\t\t\t}\n\n\t\t\t// if the geometry is not closed, generate the last row of vertices and normals\n\t\t\t// at the regular position on the given path\n\t\t\t//\n\t\t\t// if the geometry is closed, duplicate the first row of vertices and normals (uvs will differ)\n\n\t\t\tgenerateSegment( ( closed === false ) ? tubularSegments : 0 );\n\n\t\t\t// uvs are generated in a separate function.\n\t\t\t// this makes it easy compute correct values for closed geometries\n\n\t\t\tgenerateUVs();\n\n\t\t\t// finally create faces\n\n\t\t\tgenerateIndices();\n\n\t\t}\n\n\t\tfunction generateSegment( i ) {\n\n\t\t\t// we use getPointAt to sample evenly distributed points from the given path\n\n\t\t\tP = path.getPointAt( i / tubularSegments, P );\n\n\t\t\t// retrieve corresponding normal and binormal\n\n\t\t\tconst N = frames.normals[ i ];\n\t\t\tconst B = frames.binormals[ i ];\n\n\t\t\t// generate normals and vertices for the current segment\n\n\t\t\tfor ( let j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\t\tconst v = j / radialSegments * Math.PI * 2;\n\n\t\t\t\tconst sin = Math.sin( v );\n\t\t\t\tconst cos = - Math.cos( v );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormal.x = ( cos * N.x + sin * B.x );\n\t\t\t\tnormal.y = ( cos * N.y + sin * B.y );\n\t\t\t\tnormal.z = ( cos * N.z + sin * B.z );\n\t\t\t\tnormal.normalize();\n\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = P.x + radius * normal.x;\n\t\t\t\tvertex.y = P.y + radius * normal.y;\n\t\t\t\tvertex.z = P.z + radius * normal.z;\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateIndices() {\n\n\t\t\tfor ( let j = 1; j <= tubularSegments; j ++ ) {\n\n\t\t\t\tfor ( let i = 1; i <= radialSegments; i ++ ) {\n\n\t\t\t\t\tconst a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\n\t\t\t\t\tconst b = ( radialSegments + 1 ) * j + ( i - 1 );\n\t\t\t\t\tconst c = ( radialSegments + 1 ) * j + i;\n\t\t\t\t\tconst d = ( radialSegments + 1 ) * ( j - 1 ) + i;\n\n\t\t\t\t\t// faces\n\n\t\t\t\t\tindices.push( a, b, d );\n\t\t\t\t\tindices.push( b, c, d );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateUVs() {\n\n\t\t\tfor ( let i = 0; i <= tubularSegments; i ++ ) {\n\n\t\t\t\tfor ( let j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\t\t\tuv.x = i / tubularSegments;\n\t\t\t\t\tuv.y = j / radialSegments;\n\n\t\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.path = this.parameters.path.toJSON();\n\n\t\treturn data;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\t// This only works for built-in curves (e.g. CatmullRomCurve3).\n\t\t// User defined curves or instances of CurvePath will not be deserialized.\n\t\treturn new TubeGeometry(\n\t\t\tnew Curves[ data.path.type ]().fromJSON( data.path ),\n\t\t\tdata.tubularSegments,\n\t\t\tdata.radius,\n\t\t\tdata.radialSegments,\n\t\t\tdata.closed\n\t\t);\n\n\t}\n\n}\n\nclass WireframeGeometry extends BufferGeometry {\n\n\tconstructor( geometry = null ) {\n\n\t\tsuper();\n\t\tthis.type = 'WireframeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tgeometry: geometry\n\t\t};\n\n\t\tif ( geometry !== null ) {\n\n\t\t\t// buffer\n\n\t\t\tconst vertices = [];\n\t\t\tconst edges = new Set();\n\n\t\t\t// helper variables\n\n\t\t\tconst start = new Vector3();\n\t\t\tconst end = new Vector3();\n\n\t\t\tif ( geometry.index !== null ) {\n\n\t\t\t\t// indexed BufferGeometry\n\n\t\t\t\tconst position = geometry.attributes.position;\n\t\t\t\tconst indices = geometry.index;\n\t\t\t\tlet groups = geometry.groups;\n\n\t\t\t\tif ( groups.length === 0 ) {\n\n\t\t\t\t\tgroups = [ { start: 0, count: indices.count, materialIndex: 0 } ];\n\n\t\t\t\t}\n\n\t\t\t\t// create a data structure that contains all eges without duplicates\n\n\t\t\t\tfor ( let o = 0, ol = groups.length; o < ol; ++ o ) {\n\n\t\t\t\t\tconst group = groups[ o ];\n\n\t\t\t\t\tconst groupStart = group.start;\n\t\t\t\t\tconst groupCount = group.count;\n\n\t\t\t\t\tfor ( let i = groupStart, l = ( groupStart + groupCount ); i < l; i += 3 ) {\n\n\t\t\t\t\t\tfor ( let j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t\t\tconst index1 = indices.getX( i + j );\n\t\t\t\t\t\t\tconst index2 = indices.getX( i + ( j + 1 ) % 3 );\n\n\t\t\t\t\t\t\tstart.fromBufferAttribute( position, index1 );\n\t\t\t\t\t\t\tend.fromBufferAttribute( position, index2 );\n\n\t\t\t\t\t\t\tif ( isUniqueEdge( start, end, edges ) === true ) {\n\n\t\t\t\t\t\t\t\tvertices.push( start.x, start.y, start.z );\n\t\t\t\t\t\t\t\tvertices.push( end.x, end.y, end.z );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// non-indexed BufferGeometry\n\n\t\t\t\tconst position = geometry.attributes.position;\n\n\t\t\t\tfor ( let i = 0, l = ( position.count / 3 ); i < l; i ++ ) {\n\n\t\t\t\t\tfor ( let j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t\t// three edges per triangle, an edge is represented as (index1, index2)\n\t\t\t\t\t\t// e.g. the first triangle has the following edges: (0,1),(1,2),(2,0)\n\n\t\t\t\t\t\tconst index1 = 3 * i + j;\n\t\t\t\t\t\tconst index2 = 3 * i + ( ( j + 1 ) % 3 );\n\n\t\t\t\t\t\tstart.fromBufferAttribute( position, index1 );\n\t\t\t\t\t\tend.fromBufferAttribute( position, index2 );\n\n\t\t\t\t\t\tif ( isUniqueEdge( start, end, edges ) === true ) {\n\n\t\t\t\t\t\t\tvertices.push( start.x, start.y, start.z );\n\t\t\t\t\t\t\tvertices.push( end.x, end.y, end.z );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// build geometry\n\n\t\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\n\t\t}\n\n\t}\n\n}\n\nfunction isUniqueEdge( start, end, edges ) {\n\n\tconst hash1 = `${start.x},${start.y},${start.z}-${end.x},${end.y},${end.z}`;\n\tconst hash2 = `${end.x},${end.y},${end.z}-${start.x},${start.y},${start.z}`; // coincident edge\n\n\tif ( edges.has( hash1 ) === true || edges.has( hash2 ) === true ) {\n\n\t\treturn false;\n\n\t} else {\n\n\t\tedges.add( hash1, hash2 );\n\t\treturn true;\n\n\t}\n\n}\n\nvar Geometries = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tBoxGeometry: BoxGeometry,\n\tBoxBufferGeometry: BoxGeometry,\n\tCircleGeometry: CircleGeometry,\n\tCircleBufferGeometry: CircleGeometry,\n\tConeGeometry: ConeGeometry,\n\tConeBufferGeometry: ConeGeometry,\n\tCylinderGeometry: CylinderGeometry,\n\tCylinderBufferGeometry: CylinderGeometry,\n\tDodecahedronGeometry: DodecahedronGeometry,\n\tDodecahedronBufferGeometry: DodecahedronGeometry,\n\tEdgesGeometry: EdgesGeometry,\n\tExtrudeGeometry: ExtrudeGeometry,\n\tExtrudeBufferGeometry: ExtrudeGeometry,\n\tIcosahedronGeometry: IcosahedronGeometry,\n\tIcosahedronBufferGeometry: IcosahedronGeometry,\n\tLatheGeometry: LatheGeometry,\n\tLatheBufferGeometry: LatheGeometry,\n\tOctahedronGeometry: OctahedronGeometry,\n\tOctahedronBufferGeometry: OctahedronGeometry,\n\tPlaneGeometry: PlaneGeometry,\n\tPlaneBufferGeometry: PlaneGeometry,\n\tPolyhedronGeometry: PolyhedronGeometry,\n\tPolyhedronBufferGeometry: PolyhedronGeometry,\n\tRingGeometry: RingGeometry,\n\tRingBufferGeometry: RingGeometry,\n\tShapeGeometry: ShapeGeometry,\n\tShapeBufferGeometry: ShapeGeometry,\n\tSphereGeometry: SphereGeometry,\n\tSphereBufferGeometry: SphereGeometry,\n\tTetrahedronGeometry: TetrahedronGeometry,\n\tTetrahedronBufferGeometry: TetrahedronGeometry,\n\tTorusGeometry: TorusGeometry,\n\tTorusBufferGeometry: TorusGeometry,\n\tTorusKnotGeometry: TorusKnotGeometry,\n\tTorusKnotBufferGeometry: TorusKnotGeometry,\n\tTubeGeometry: TubeGeometry,\n\tTubeBufferGeometry: TubeGeometry,\n\tWireframeGeometry: WireframeGeometry\n});\n\n/**\n * parameters = {\n *  color: <THREE.Color>\n * }\n */\n\nclass ShadowMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ShadowMaterial';\n\n\t\tthis.color = new Color( 0x000000 );\n\t\tthis.transparent = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\treturn this;\n\n\t}\n\n}\n\nShadowMaterial.prototype.isShadowMaterial = true;\n\n/**\n * parameters = {\n *  color: <hex>,\n *  roughness: <float>,\n *  metalness: <float>,\n *  opacity: <float>,\n *\n *  map: new THREE.Texture( <Image> ),\n *\n *  lightMap: new THREE.Texture( <Image> ),\n *  lightMapIntensity: <float>\n *\n *  aoMap: new THREE.Texture( <Image> ),\n *  aoMapIntensity: <float>\n *\n *  emissive: <hex>,\n *  emissiveIntensity: <float>\n *  emissiveMap: new THREE.Texture( <Image> ),\n *\n *  bumpMap: new THREE.Texture( <Image> ),\n *  bumpScale: <float>,\n *\n *  normalMap: new THREE.Texture( <Image> ),\n *  normalMapType: THREE.TangentSpaceNormalMap,\n *  normalScale: <Vector2>,\n *\n *  displacementMap: new THREE.Texture( <Image> ),\n *  displacementScale: <float>,\n *  displacementBias: <float>,\n *\n *  roughnessMap: new THREE.Texture( <Image> ),\n *\n *  metalnessMap: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\n *  envMapIntensity: <float>\n *\n *  refractionRatio: <float>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n *\n *  flatShading: <bool>\n * }\n */\n\nclass MeshStandardMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.defines = { 'STANDARD': '' };\n\n\t\tthis.type = 'MeshStandardMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\t\tthis.roughness = 1.0;\n\t\tthis.metalness = 0.0;\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.roughnessMap = null;\n\n\t\tthis.metalnessMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.envMapIntensity = 1.0;\n\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = { 'STANDARD': '' };\n\n\t\tthis.color.copy( source.color );\n\t\tthis.roughness = source.roughness;\n\t\tthis.metalness = source.metalness;\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.roughnessMap = source.roughnessMap;\n\n\t\tthis.metalnessMap = source.metalnessMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.envMapIntensity = source.envMapIntensity;\n\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshStandardMaterial.prototype.isMeshStandardMaterial = true;\n\n/**\n * parameters = {\n *  clearcoat: <float>,\n *  clearcoatMap: new THREE.Texture( <Image> ),\n *  clearcoatRoughness: <float>,\n *  clearcoatRoughnessMap: new THREE.Texture( <Image> ),\n *  clearcoatNormalScale: <Vector2>,\n *  clearcoatNormalMap: new THREE.Texture( <Image> ),\n *\n *  ior: <float>,\n *  reflectivity: <float>,\n *\n *  sheen: <float>,\n *  sheenColor: <Color>,\n *  sheenColorMap: new THREE.Texture( <Image> ),\n *  sheenRoughness: <float>,\n *  sheenRoughnessMap: new THREE.Texture( <Image> ),\n *\n *  transmission: <float>,\n *  transmissionMap: new THREE.Texture( <Image> ),\n *\n *  thickness: <float>,\n *  thicknessMap: new THREE.Texture( <Image> ),\n *  attenuationDistance: <float>,\n *  attenuationColor: <Color>,\n *\n *  specularIntensity: <float>,\n *  specularIntensityMap: new THREE.Texture( <Image> ),\n *  specularColor: <Color>,\n *  specularColorMap: new THREE.Texture( <Image> )\n * }\n */\n\nclass MeshPhysicalMaterial extends MeshStandardMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.defines = {\n\n\t\t\t'STANDARD': '',\n\t\t\t'PHYSICAL': ''\n\n\t\t};\n\n\t\tthis.type = 'MeshPhysicalMaterial';\n\n\t\tthis.clearcoatMap = null;\n\t\tthis.clearcoatRoughness = 0.0;\n\t\tthis.clearcoatRoughnessMap = null;\n\t\tthis.clearcoatNormalScale = new Vector2( 1, 1 );\n\t\tthis.clearcoatNormalMap = null;\n\n\t\tthis.ior = 1.5;\n\n\t\tObject.defineProperty( this, 'reflectivity', {\n\t\t\tget: function () {\n\n\t\t\t\treturn ( clamp( 2.5 * ( this.ior - 1 ) / ( this.ior + 1 ), 0, 1 ) );\n\n\t\t\t},\n\t\t\tset: function ( reflectivity ) {\n\n\t\t\t\tthis.ior = ( 1 + 0.4 * reflectivity ) / ( 1 - 0.4 * reflectivity );\n\n\t\t\t}\n\t\t} );\n\n\t\tthis.sheenColor = new Color( 0x000000 );\n\t\tthis.sheenColorMap = null;\n\t\tthis.sheenRoughness = 1.0;\n\t\tthis.sheenRoughnessMap = null;\n\n\t\tthis.transmissionMap = null;\n\n\t\tthis.thickness = 0;\n\t\tthis.thicknessMap = null;\n\t\tthis.attenuationDistance = 0.0;\n\t\tthis.attenuationColor = new Color( 1, 1, 1 );\n\n\t\tthis.specularIntensity = 1.0;\n\t\tthis.specularIntensityMap = null;\n\t\tthis.specularColor = new Color( 1, 1, 1 );\n\t\tthis.specularColorMap = null;\n\n\t\tthis._sheen = 0.0;\n\t\tthis._clearcoat = 0;\n\t\tthis._transmission = 0;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tget sheen() {\n\n\t\treturn this._sheen;\n\n\t}\n\n\tset sheen( value ) {\n\n\t\tif ( this._sheen > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._sheen = value;\n\n\t}\n\n\tget clearcoat() {\n\n\t\treturn this._clearcoat;\n\n\t}\n\n\tset clearcoat( value ) {\n\n\t\tif ( this._clearcoat > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._clearcoat = value;\n\n\t}\n\n\tget transmission() {\n\n\t\treturn this._transmission;\n\n\t}\n\n\tset transmission( value ) {\n\n\t\tif ( this._transmission > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._transmission = value;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = {\n\n\t\t\t'STANDARD': '',\n\t\t\t'PHYSICAL': ''\n\n\t\t};\n\n\t\tthis.clearcoat = source.clearcoat;\n\t\tthis.clearcoatMap = source.clearcoatMap;\n\t\tthis.clearcoatRoughness = source.clearcoatRoughness;\n\t\tthis.clearcoatRoughnessMap = source.clearcoatRoughnessMap;\n\t\tthis.clearcoatNormalMap = source.clearcoatNormalMap;\n\t\tthis.clearcoatNormalScale.copy( source.clearcoatNormalScale );\n\n\t\tthis.ior = source.ior;\n\n\t\tthis.sheen = source.sheen;\n\t\tthis.sheenColor.copy( source.sheenColor );\n\t\tthis.sheenColorMap = source.sheenColorMap;\n\t\tthis.sheenRoughness = source.sheenRoughness;\n\t\tthis.sheenRoughnessMap = source.sheenRoughnessMap;\n\n\t\tthis.transmission = source.transmission;\n\t\tthis.transmissionMap = source.transmissionMap;\n\n\t\tthis.thickness = source.thickness;\n\t\tthis.thicknessMap = source.thicknessMap;\n\t\tthis.attenuationDistance = source.attenuationDistance;\n\t\tthis.attenuationColor.copy( source.attenuationColor );\n\n\t\tthis.specularIntensity = source.specularIntensity;\n\t\tthis.specularIntensityMap = source.specularIntensityMap;\n\t\tthis.specularColor.copy( source.specularColor );\n\t\tthis.specularColorMap = source.specularColorMap;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshPhysicalMaterial.prototype.isMeshPhysicalMaterial = true;\n\n/**\n * parameters = {\n *  color: <hex>,\n *  specular: <hex>,\n *  shininess: <float>,\n *  opacity: <float>,\n *\n *  map: new THREE.Texture( <Image> ),\n *\n *  lightMap: new THREE.Texture( <Image> ),\n *  lightMapIntensity: <float>\n *\n *  aoMap: new THREE.Texture( <Image> ),\n *  aoMapIntensity: <float>\n *\n *  emissive: <hex>,\n *  emissiveIntensity: <float>\n *  emissiveMap: new THREE.Texture( <Image> ),\n *\n *  bumpMap: new THREE.Texture( <Image> ),\n *  bumpScale: <float>,\n *\n *  normalMap: new THREE.Texture( <Image> ),\n *  normalMapType: THREE.TangentSpaceNormalMap,\n *  normalScale: <Vector2>,\n *\n *  displacementMap: new THREE.Texture( <Image> ),\n *  displacementScale: <float>,\n *  displacementBias: <float>,\n *\n *  specularMap: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\n *  combine: THREE.MultiplyOperation,\n *  reflectivity: <float>,\n *  refractionRatio: <float>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n *\n *  flatShading: <bool>\n * }\n */\n\nclass MeshPhongMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshPhongMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\t\tthis.specular = new Color( 0x111111 );\n\t\tthis.shininess = 30;\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\t\tthis.specular.copy( source.specular );\n\t\tthis.shininess = source.shininess;\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshPhongMaterial.prototype.isMeshPhongMaterial = true;\n\n/**\n * parameters = {\n *  color: <hex>,\n *\n *  map: new THREE.Texture( <Image> ),\n *  gradientMap: new THREE.Texture( <Image> ),\n *\n *  lightMap: new THREE.Texture( <Image> ),\n *  lightMapIntensity: <float>\n *\n *  aoMap: new THREE.Texture( <Image> ),\n *  aoMapIntensity: <float>\n *\n *  emissive: <hex>,\n *  emissiveIntensity: <float>\n *  emissiveMap: new THREE.Texture( <Image> ),\n *\n *  bumpMap: new THREE.Texture( <Image> ),\n *  bumpScale: <float>,\n *\n *  normalMap: new THREE.Texture( <Image> ),\n *  normalMapType: THREE.TangentSpaceNormalMap,\n *  normalScale: <Vector2>,\n *\n *  displacementMap: new THREE.Texture( <Image> ),\n *  displacementScale: <float>,\n *  displacementBias: <float>,\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n *\n * }\n */\n\nclass MeshToonMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.defines = { 'TOON': '' };\n\n\t\tthis.type = 'MeshToonMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\t\tthis.gradientMap = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\t\tthis.gradientMap = source.gradientMap;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshToonMaterial.prototype.isMeshToonMaterial = true;\n\n/**\n * parameters = {\n *  opacity: <float>,\n *\n *  bumpMap: new THREE.Texture( <Image> ),\n *  bumpScale: <float>,\n *\n *  normalMap: new THREE.Texture( <Image> ),\n *  normalMapType: THREE.TangentSpaceNormalMap,\n *  normalScale: <Vector2>,\n *\n *  displacementMap: new THREE.Texture( <Image> ),\n *  displacementScale: <float>,\n *  displacementBias: <float>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>\n *\n *  flatShading: <bool>\n * }\n */\n\nclass MeshNormalMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshNormalMaterial';\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false;\n\n\t\tthis.flatShading = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshNormalMaterial.prototype.isMeshNormalMaterial = true;\n\n/**\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *\n *  map: new THREE.Texture( <Image> ),\n *\n *  lightMap: new THREE.Texture( <Image> ),\n *  lightMapIntensity: <float>\n *\n *  aoMap: new THREE.Texture( <Image> ),\n *  aoMapIntensity: <float>\n *\n *  emissive: <hex>,\n *  emissiveIntensity: <float>\n *  emissiveMap: new THREE.Texture( <Image> ),\n *\n *  specularMap: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\n *  combine: THREE.Multiply,\n *  reflectivity: <float>,\n *  refractionRatio: <float>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n *\n * }\n */\n\nclass MeshLambertMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshLambertMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshLambertMaterial.prototype.isMeshLambertMaterial = true;\n\n/**\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *\n *  matcap: new THREE.Texture( <Image> ),\n *\n *  map: new THREE.Texture( <Image> ),\n *\n *  bumpMap: new THREE.Texture( <Image> ),\n *  bumpScale: <float>,\n *\n *  normalMap: new THREE.Texture( <Image> ),\n *  normalMapType: THREE.TangentSpaceNormalMap,\n *  normalScale: <Vector2>,\n *\n *  displacementMap: new THREE.Texture( <Image> ),\n *  displacementScale: <float>,\n *  displacementBias: <float>,\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  flatShading: <bool>\n * }\n */\n\nclass MeshMatcapMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.defines = { 'MATCAP': '' };\n\n\t\tthis.type = 'MeshMatcapMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\n\t\tthis.matcap = null;\n\n\t\tthis.map = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.flatShading = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = { 'MATCAP': '' };\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.matcap = source.matcap;\n\n\t\tthis.map = source.map;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshMatcapMaterial.prototype.isMeshMatcapMaterial = true;\n\n/**\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *\n *  linewidth: <float>,\n *\n *  scale: <float>,\n *  dashSize: <float>,\n *  gapSize: <float>\n * }\n */\n\nclass LineDashedMaterial extends LineBasicMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'LineDashedMaterial';\n\n\t\tthis.scale = 1;\n\t\tthis.dashSize = 3;\n\t\tthis.gapSize = 1;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.scale = source.scale;\n\t\tthis.dashSize = source.dashSize;\n\t\tthis.gapSize = source.gapSize;\n\n\t\treturn this;\n\n\t}\n\n}\n\nLineDashedMaterial.prototype.isLineDashedMaterial = true;\n\nvar Materials = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tShadowMaterial: ShadowMaterial,\n\tSpriteMaterial: SpriteMaterial,\n\tRawShaderMaterial: RawShaderMaterial,\n\tShaderMaterial: ShaderMaterial,\n\tPointsMaterial: PointsMaterial,\n\tMeshPhysicalMaterial: MeshPhysicalMaterial,\n\tMeshStandardMaterial: MeshStandardMaterial,\n\tMeshPhongMaterial: MeshPhongMaterial,\n\tMeshToonMaterial: MeshToonMaterial,\n\tMeshNormalMaterial: MeshNormalMaterial,\n\tMeshLambertMaterial: MeshLambertMaterial,\n\tMeshDepthMaterial: MeshDepthMaterial,\n\tMeshDistanceMaterial: MeshDistanceMaterial,\n\tMeshBasicMaterial: MeshBasicMaterial,\n\tMeshMatcapMaterial: MeshMatcapMaterial,\n\tLineDashedMaterial: LineDashedMaterial,\n\tLineBasicMaterial: LineBasicMaterial,\n\tMaterial: Material\n});\n\nconst AnimationUtils = {\n\n\t// same as Array.prototype.slice, but also works on typed arrays\n\tarraySlice: function ( array, from, to ) {\n\n\t\tif ( AnimationUtils.isTypedArray( array ) ) {\n\n\t\t\t// in ios9 array.subarray(from, undefined) will return empty array\n\t\t\t// but array.subarray(from) or array.subarray(from, len) is correct\n\t\t\treturn new array.constructor( array.subarray( from, to !== undefined ? to : array.length ) );\n\n\t\t}\n\n\t\treturn array.slice( from, to );\n\n\t},\n\n\t// converts an array to a specific type\n\tconvertArray: function ( array, type, forceClone ) {\n\n\t\tif ( ! array || // let 'undefined' and 'null' pass\n\t\t\t! forceClone && array.constructor === type ) return array;\n\n\t\tif ( typeof type.BYTES_PER_ELEMENT === 'number' ) {\n\n\t\t\treturn new type( array ); // create typed array\n\n\t\t}\n\n\t\treturn Array.prototype.slice.call( array ); // create Array\n\n\t},\n\n\tisTypedArray: function ( object ) {\n\n\t\treturn ArrayBuffer.isView( object ) &&\n\t\t\t! ( object instanceof DataView );\n\n\t},\n\n\t// returns an array by which times and values can be sorted\n\tgetKeyframeOrder: function ( times ) {\n\n\t\tfunction compareTime( i, j ) {\n\n\t\t\treturn times[ i ] - times[ j ];\n\n\t\t}\n\n\t\tconst n = times.length;\n\t\tconst result = new Array( n );\n\t\tfor ( let i = 0; i !== n; ++ i ) result[ i ] = i;\n\n\t\tresult.sort( compareTime );\n\n\t\treturn result;\n\n\t},\n\n\t// uses the array previously returned by 'getKeyframeOrder' to sort data\n\tsortedArray: function ( values, stride, order ) {\n\n\t\tconst nValues = values.length;\n\t\tconst result = new values.constructor( nValues );\n\n\t\tfor ( let i = 0, dstOffset = 0; dstOffset !== nValues; ++ i ) {\n\n\t\t\tconst srcOffset = order[ i ] * stride;\n\n\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\tresult[ dstOffset ++ ] = values[ srcOffset + j ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn result;\n\n\t},\n\n\t// function for parsing AOS keyframe formats\n\tflattenJSON: function ( jsonKeys, times, values, valuePropertyName ) {\n\n\t\tlet i = 1, key = jsonKeys[ 0 ];\n\n\t\twhile ( key !== undefined && key[ valuePropertyName ] === undefined ) {\n\n\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t}\n\n\t\tif ( key === undefined ) return; // no data\n\n\t\tlet value = key[ valuePropertyName ];\n\t\tif ( value === undefined ) return; // no data\n\n\t\tif ( Array.isArray( value ) ) {\n\n\t\t\tdo {\n\n\t\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\ttimes.push( key.time );\n\t\t\t\t\tvalues.push.apply( values, value ); // push all elements\n\n\t\t\t\t}\n\n\t\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t\t} while ( key !== undefined );\n\n\t\t} else if ( value.toArray !== undefined ) {\n\n\t\t\t// ...assume THREE.Math-ish\n\n\t\t\tdo {\n\n\t\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\ttimes.push( key.time );\n\t\t\t\t\tvalue.toArray( values, values.length );\n\n\t\t\t\t}\n\n\t\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t\t} while ( key !== undefined );\n\n\t\t} else {\n\n\t\t\t// otherwise push as-is\n\n\t\t\tdo {\n\n\t\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\ttimes.push( key.time );\n\t\t\t\t\tvalues.push( value );\n\n\t\t\t\t}\n\n\t\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t\t} while ( key !== undefined );\n\n\t\t}\n\n\t},\n\n\tsubclip: function ( sourceClip, name, startFrame, endFrame, fps = 30 ) {\n\n\t\tconst clip = sourceClip.clone();\n\n\t\tclip.name = name;\n\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\t\tconst track = clip.tracks[ i ];\n\t\t\tconst valueSize = track.getValueSize();\n\n\t\t\tconst times = [];\n\t\t\tconst values = [];\n\n\t\t\tfor ( let j = 0; j < track.times.length; ++ j ) {\n\n\t\t\t\tconst frame = track.times[ j ] * fps;\n\n\t\t\t\tif ( frame < startFrame || frame >= endFrame ) continue;\n\n\t\t\t\ttimes.push( track.times[ j ] );\n\n\t\t\t\tfor ( let k = 0; k < valueSize; ++ k ) {\n\n\t\t\t\t\tvalues.push( track.values[ j * valueSize + k ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( times.length === 0 ) continue;\n\n\t\t\ttrack.times = AnimationUtils.convertArray( times, track.times.constructor );\n\t\t\ttrack.values = AnimationUtils.convertArray( values, track.values.constructor );\n\n\t\t\ttracks.push( track );\n\n\t\t}\n\n\t\tclip.tracks = tracks;\n\n\t\t// find minimum .times value across all tracks in the trimmed clip\n\n\t\tlet minStartTime = Infinity;\n\n\t\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\t\tif ( minStartTime > clip.tracks[ i ].times[ 0 ] ) {\n\n\t\t\t\tminStartTime = clip.tracks[ i ].times[ 0 ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// shift all tracks such that clip begins at t=0\n\n\t\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\t\tclip.tracks[ i ].shift( - 1 * minStartTime );\n\n\t\t}\n\n\t\tclip.resetDuration();\n\n\t\treturn clip;\n\n\t},\n\n\tmakeClipAdditive: function ( targetClip, referenceFrame = 0, referenceClip = targetClip, fps = 30 ) {\n\n\t\tif ( fps <= 0 ) fps = 30;\n\n\t\tconst numTracks = referenceClip.tracks.length;\n\t\tconst referenceTime = referenceFrame / fps;\n\n\t\t// Make each track's values relative to the values at the reference frame\n\t\tfor ( let i = 0; i < numTracks; ++ i ) {\n\n\t\t\tconst referenceTrack = referenceClip.tracks[ i ];\n\t\t\tconst referenceTrackType = referenceTrack.ValueTypeName;\n\n\t\t\t// Skip this track if it's non-numeric\n\t\t\tif ( referenceTrackType === 'bool' || referenceTrackType === 'string' ) continue;\n\n\t\t\t// Find the track in the target clip whose name and type matches the reference track\n\t\t\tconst targetTrack = targetClip.tracks.find( function ( track ) {\n\n\t\t\t\treturn track.name === referenceTrack.name\n\t\t\t\t\t&& track.ValueTypeName === referenceTrackType;\n\n\t\t\t} );\n\n\t\t\tif ( targetTrack === undefined ) continue;\n\n\t\t\tlet referenceOffset = 0;\n\t\t\tconst referenceValueSize = referenceTrack.getValueSize();\n\n\t\t\tif ( referenceTrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline ) {\n\n\t\t\t\treferenceOffset = referenceValueSize / 3;\n\n\t\t\t}\n\n\t\t\tlet targetOffset = 0;\n\t\t\tconst targetValueSize = targetTrack.getValueSize();\n\n\t\t\tif ( targetTrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline ) {\n\n\t\t\t\ttargetOffset = targetValueSize / 3;\n\n\t\t\t}\n\n\t\t\tconst lastIndex = referenceTrack.times.length - 1;\n\t\t\tlet referenceValue;\n\n\t\t\t// Find the value to subtract out of the track\n\t\t\tif ( referenceTime <= referenceTrack.times[ 0 ] ) {\n\n\t\t\t\t// Reference frame is earlier than the first keyframe, so just use the first keyframe\n\t\t\t\tconst startIndex = referenceOffset;\n\t\t\t\tconst endIndex = referenceValueSize - referenceOffset;\n\t\t\t\treferenceValue = AnimationUtils.arraySlice( referenceTrack.values, startIndex, endIndex );\n\n\t\t\t} else if ( referenceTime >= referenceTrack.times[ lastIndex ] ) {\n\n\t\t\t\t// Reference frame is after the last keyframe, so just use the last keyframe\n\t\t\t\tconst startIndex = lastIndex * referenceValueSize + referenceOffset;\n\t\t\t\tconst endIndex = startIndex + referenceValueSize - referenceOffset;\n\t\t\t\treferenceValue = AnimationUtils.arraySlice( referenceTrack.values, startIndex, endIndex );\n\n\t\t\t} else {\n\n\t\t\t\t// Interpolate to the reference value\n\t\t\t\tconst interpolant = referenceTrack.createInterpolant();\n\t\t\t\tconst startIndex = referenceOffset;\n\t\t\t\tconst endIndex = referenceValueSize - referenceOffset;\n\t\t\t\tinterpolant.evaluate( referenceTime );\n\t\t\t\treferenceValue = AnimationUtils.arraySlice( interpolant.resultBuffer, startIndex, endIndex );\n\n\t\t\t}\n\n\t\t\t// Conjugate the quaternion\n\t\t\tif ( referenceTrackType === 'quaternion' ) {\n\n\t\t\t\tconst referenceQuat = new Quaternion().fromArray( referenceValue ).normalize().conjugate();\n\t\t\t\treferenceQuat.toArray( referenceValue );\n\n\t\t\t}\n\n\t\t\t// Subtract the reference value from all of the track values\n\n\t\t\tconst numTimes = targetTrack.times.length;\n\t\t\tfor ( let j = 0; j < numTimes; ++ j ) {\n\n\t\t\t\tconst valueStart = j * targetValueSize + targetOffset;\n\n\t\t\t\tif ( referenceTrackType === 'quaternion' ) {\n\n\t\t\t\t\t// Multiply the conjugate for quaternion track types\n\t\t\t\t\tQuaternion.multiplyQuaternionsFlat(\n\t\t\t\t\t\ttargetTrack.values,\n\t\t\t\t\t\tvalueStart,\n\t\t\t\t\t\treferenceValue,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\ttargetTrack.values,\n\t\t\t\t\t\tvalueStart\n\t\t\t\t\t);\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst valueEnd = targetValueSize - targetOffset * 2;\n\n\t\t\t\t\t// Subtract each value for all other numeric track types\n\t\t\t\t\tfor ( let k = 0; k < valueEnd; ++ k ) {\n\n\t\t\t\t\t\ttargetTrack.values[ valueStart + k ] -= referenceValue[ k ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\ttargetClip.blendMode = AdditiveAnimationBlendMode;\n\n\t\treturn targetClip;\n\n\t}\n\n};\n\n/**\n * Abstract base class of interpolants over parametric samples.\n *\n * The parameter domain is one dimensional, typically the time or a path\n * along a curve defined by the data.\n *\n * The sample values can have any dimensionality and derived classes may\n * apply special interpretations to the data.\n *\n * This class provides the interval seek in a Template Method, deferring\n * the actual interpolation to derived classes.\n *\n * Time complexity is O(1) for linear access crossing at most two points\n * and O(log N) for random access, where N is the number of positions.\n *\n * References:\n *\n * \t\thttp://www.oodesign.com/template-method-pattern.html\n *\n */\n\nclass Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tthis.parameterPositions = parameterPositions;\n\t\tthis._cachedIndex = 0;\n\n\t\tthis.resultBuffer = resultBuffer !== undefined ?\n\t\t\tresultBuffer : new sampleValues.constructor( sampleSize );\n\t\tthis.sampleValues = sampleValues;\n\t\tthis.valueSize = sampleSize;\n\n\t\tthis.settings = null;\n\t\tthis.DefaultSettings_ = {};\n\n\t}\n\n\tevaluate( t ) {\n\n\t\tconst pp = this.parameterPositions;\n\t\tlet i1 = this._cachedIndex,\n\t\t\tt1 = pp[ i1 ],\n\t\t\tt0 = pp[ i1 - 1 ];\n\n\t\tvalidate_interval: {\n\n\t\t\tseek: {\n\n\t\t\t\tlet right;\n\n\t\t\t\tlinear_scan: {\n\n\t\t\t\t\t//- See http://jsperf.com/comparison-to-undefined/3\n\t\t\t\t\t//- slower code:\n\t\t\t\t\t//-\n\t\t\t\t\t//- \t\t\t\tif ( t >= t1 || t1 === undefined ) {\n\t\t\t\t\tforward_scan: if ( ! ( t < t1 ) ) {\n\n\t\t\t\t\t\tfor ( let giveUpAt = i1 + 2; ; ) {\n\n\t\t\t\t\t\t\tif ( t1 === undefined ) {\n\n\t\t\t\t\t\t\t\tif ( t < t0 ) break forward_scan;\n\n\t\t\t\t\t\t\t\t// after end\n\n\t\t\t\t\t\t\t\ti1 = pp.length;\n\t\t\t\t\t\t\t\tthis._cachedIndex = i1;\n\t\t\t\t\t\t\t\treturn this.afterEnd_( i1 - 1, t, t0 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\n\n\t\t\t\t\t\t\tt0 = t1;\n\t\t\t\t\t\t\tt1 = pp[ ++ i1 ];\n\n\t\t\t\t\t\t\tif ( t < t1 ) {\n\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\n\t\t\t\t\t\t\t\tbreak seek;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// prepare binary search on the right side of the index\n\t\t\t\t\t\tright = pp.length;\n\t\t\t\t\t\tbreak linear_scan;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t//- slower code:\n\t\t\t\t\t//-\t\t\t\t\tif ( t < t0 || t0 === undefined ) {\n\t\t\t\t\tif ( ! ( t >= t0 ) ) {\n\n\t\t\t\t\t\t// looping?\n\n\t\t\t\t\t\tconst t1global = pp[ 1 ];\n\n\t\t\t\t\t\tif ( t < t1global ) {\n\n\t\t\t\t\t\t\ti1 = 2; // + 1, using the scan for the details\n\t\t\t\t\t\t\tt0 = t1global;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// linear reverse scan\n\n\t\t\t\t\t\tfor ( let giveUpAt = i1 - 2; ; ) {\n\n\t\t\t\t\t\t\tif ( t0 === undefined ) {\n\n\t\t\t\t\t\t\t\t// before start\n\n\t\t\t\t\t\t\t\tthis._cachedIndex = 0;\n\t\t\t\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\n\n\t\t\t\t\t\t\tt1 = t0;\n\t\t\t\t\t\t\tt0 = pp[ -- i1 - 1 ];\n\n\t\t\t\t\t\t\tif ( t >= t0 ) {\n\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\n\t\t\t\t\t\t\t\tbreak seek;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// prepare binary search on the left side of the index\n\t\t\t\t\t\tright = i1;\n\t\t\t\t\t\ti1 = 0;\n\t\t\t\t\t\tbreak linear_scan;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// the interval is valid\n\n\t\t\t\t\tbreak validate_interval;\n\n\t\t\t\t} // linear scan\n\n\t\t\t\t// binary search\n\n\t\t\t\twhile ( i1 < right ) {\n\n\t\t\t\t\tconst mid = ( i1 + right ) >>> 1;\n\n\t\t\t\t\tif ( t < pp[ mid ] ) {\n\n\t\t\t\t\t\tright = mid;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ti1 = mid + 1;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tt1 = pp[ i1 ];\n\t\t\t\tt0 = pp[ i1 - 1 ];\n\n\t\t\t\t// check boundary cases, again\n\n\t\t\t\tif ( t0 === undefined ) {\n\n\t\t\t\t\tthis._cachedIndex = 0;\n\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\n\n\t\t\t\t}\n\n\t\t\t\tif ( t1 === undefined ) {\n\n\t\t\t\t\ti1 = pp.length;\n\t\t\t\t\tthis._cachedIndex = i1;\n\t\t\t\t\treturn this.afterEnd_( i1 - 1, t0, t );\n\n\t\t\t\t}\n\n\t\t\t} // seek\n\n\t\t\tthis._cachedIndex = i1;\n\n\t\t\tthis.intervalChanged_( i1, t0, t1 );\n\n\t\t} // validate_interval\n\n\t\treturn this.interpolate_( i1, t0, t, t1 );\n\n\t}\n\n\tgetSettings_() {\n\n\t\treturn this.settings || this.DefaultSettings_;\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// copies a sample value to the result buffer\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\t\t\toffset = index * stride;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\t// Template methods for derived classes:\n\n\tinterpolate_( /* i1, t0, t, t1 */ ) {\n\n\t\tthrow new Error( 'call to abstract method' );\n\t\t// implementations shall return this.resultBuffer\n\n\t}\n\n\tintervalChanged_( /* i1, t0, t1 */ ) {\n\n\t\t// empty\n\n\t}\n\n}\n\n// ALIAS DEFINITIONS\n\nInterpolant.prototype.beforeStart_ = Interpolant.prototype.copySampleValue_;\nInterpolant.prototype.afterEnd_ = Interpolant.prototype.copySampleValue_;\n\n/**\n * Fast and simple cubic spline interpolant.\n *\n * It was derived from a Hermitian construction setting the first derivative\n * at each sample position to the linear slope between neighboring positions\n * over their parameter interval.\n */\n\nclass CubicInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t\tthis._weightPrev = - 0;\n\t\tthis._offsetPrev = - 0;\n\t\tthis._weightNext = - 0;\n\t\tthis._offsetNext = - 0;\n\n\t\tthis.DefaultSettings_ = {\n\n\t\t\tendingStart: ZeroCurvatureEnding,\n\t\t\tendingEnd: ZeroCurvatureEnding\n\n\t\t};\n\n\t}\n\n\tintervalChanged_( i1, t0, t1 ) {\n\n\t\tconst pp = this.parameterPositions;\n\t\tlet iPrev = i1 - 2,\n\t\t\tiNext = i1 + 1,\n\n\t\t\ttPrev = pp[ iPrev ],\n\t\t\ttNext = pp[ iNext ];\n\n\t\tif ( tPrev === undefined ) {\n\n\t\t\tswitch ( this.getSettings_().endingStart ) {\n\n\t\t\t\tcase ZeroSlopeEnding:\n\n\t\t\t\t\t// f'(t0) = 0\n\t\t\t\t\tiPrev = i1;\n\t\t\t\t\ttPrev = 2 * t0 - t1;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase WrapAroundEnding:\n\n\t\t\t\t\t// use the other end of the curve\n\t\t\t\t\tiPrev = pp.length - 2;\n\t\t\t\t\ttPrev = t0 + pp[ iPrev ] - pp[ iPrev + 1 ];\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault: // ZeroCurvatureEnding\n\n\t\t\t\t\t// f''(t0) = 0 a.k.a. Natural Spline\n\t\t\t\t\tiPrev = i1;\n\t\t\t\t\ttPrev = t1;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( tNext === undefined ) {\n\n\t\t\tswitch ( this.getSettings_().endingEnd ) {\n\n\t\t\t\tcase ZeroSlopeEnding:\n\n\t\t\t\t\t// f'(tN) = 0\n\t\t\t\t\tiNext = i1;\n\t\t\t\t\ttNext = 2 * t1 - t0;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase WrapAroundEnding:\n\n\t\t\t\t\t// use the other end of the curve\n\t\t\t\t\tiNext = 1;\n\t\t\t\t\ttNext = t1 + pp[ 1 ] - pp[ 0 ];\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault: // ZeroCurvatureEnding\n\n\t\t\t\t\t// f''(tN) = 0, a.k.a. Natural Spline\n\t\t\t\t\tiNext = i1 - 1;\n\t\t\t\t\ttNext = t0;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst halfDt = ( t1 - t0 ) * 0.5,\n\t\t\tstride = this.valueSize;\n\n\t\tthis._weightPrev = halfDt / ( t0 - tPrev );\n\t\tthis._weightNext = halfDt / ( tNext - t1 );\n\t\tthis._offsetPrev = iPrev * stride;\n\t\tthis._offsetNext = iNext * stride;\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\to1 = i1 * stride,\t\to0 = o1 - stride,\n\t\t\toP = this._offsetPrev, \toN = this._offsetNext,\n\t\t\twP = this._weightPrev,\twN = this._weightNext,\n\n\t\t\tp = ( t - t0 ) / ( t1 - t0 ),\n\t\t\tpp = p * p,\n\t\t\tppp = pp * p;\n\n\t\t// evaluate polynomials\n\n\t\tconst sP = - wP * ppp + 2 * wP * pp - wP * p;\n\t\tconst s0 = ( 1 + wP ) * ppp + ( - 1.5 - 2 * wP ) * pp + ( - 0.5 + wP ) * p + 1;\n\t\tconst s1 = ( - 1 - wN ) * ppp + ( 1.5 + wN ) * pp + 0.5 * p;\n\t\tconst sN = wN * ppp - wN * pp;\n\n\t\t// combine data linearly\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] =\n\t\t\t\t\tsP * values[ oP + i ] +\n\t\t\t\t\ts0 * values[ o0 + i ] +\n\t\t\t\t\ts1 * values[ o1 + i ] +\n\t\t\t\t\tsN * values[ oN + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nclass LinearInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\toffset1 = i1 * stride,\n\t\t\toffset0 = offset1 - stride,\n\n\t\t\tweight1 = ( t - t0 ) / ( t1 - t0 ),\n\t\t\tweight0 = 1 - weight1;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] =\n\t\t\t\t\tvalues[ offset0 + i ] * weight0 +\n\t\t\t\t\tvalues[ offset1 + i ] * weight1;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\n/**\n *\n * Interpolant that evaluates to the sample value at the position preceeding\n * the parameter.\n */\n\nclass DiscreteInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1 /*, t0, t, t1 */ ) {\n\n\t\treturn this.copySampleValue_( i1 - 1 );\n\n\t}\n\n}\n\nclass KeyframeTrack {\n\n\tconstructor( name, times, values, interpolation ) {\n\n\t\tif ( name === undefined ) throw new Error( 'THREE.KeyframeTrack: track name is undefined' );\n\t\tif ( times === undefined || times.length === 0 ) throw new Error( 'THREE.KeyframeTrack: no keyframes in track named ' + name );\n\n\t\tthis.name = name;\n\n\t\tthis.times = AnimationUtils.convertArray( times, this.TimeBufferType );\n\t\tthis.values = AnimationUtils.convertArray( values, this.ValueBufferType );\n\n\t\tthis.setInterpolation( interpolation || this.DefaultInterpolation );\n\n\t}\n\n\t// Serialization (in static context, because of constructor invocation\n\t// and automatic invocation of .toJSON):\n\n\tstatic toJSON( track ) {\n\n\t\tconst trackType = track.constructor;\n\n\t\tlet json;\n\n\t\t// derived classes can define a static toJSON method\n\t\tif ( trackType.toJSON !== this.toJSON ) {\n\n\t\t\tjson = trackType.toJSON( track );\n\n\t\t} else {\n\n\t\t\t// by default, we assume the data can be serialized as-is\n\t\t\tjson = {\n\n\t\t\t\t'name': track.name,\n\t\t\t\t'times': AnimationUtils.convertArray( track.times, Array ),\n\t\t\t\t'values': AnimationUtils.convertArray( track.values, Array )\n\n\t\t\t};\n\n\t\t\tconst interpolation = track.getInterpolation();\n\n\t\t\tif ( interpolation !== track.DefaultInterpolation ) {\n\n\t\t\t\tjson.interpolation = interpolation;\n\n\t\t\t}\n\n\t\t}\n\n\t\tjson.type = track.ValueTypeName; // mandatory\n\n\t\treturn json;\n\n\t}\n\n\tInterpolantFactoryMethodDiscrete( result ) {\n\n\t\treturn new DiscreteInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tInterpolantFactoryMethodLinear( result ) {\n\n\t\treturn new LinearInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tInterpolantFactoryMethodSmooth( result ) {\n\n\t\treturn new CubicInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tsetInterpolation( interpolation ) {\n\n\t\tlet factoryMethod;\n\n\t\tswitch ( interpolation ) {\n\n\t\t\tcase InterpolateDiscrete:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodDiscrete;\n\n\t\t\t\tbreak;\n\n\t\t\tcase InterpolateLinear:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodLinear;\n\n\t\t\t\tbreak;\n\n\t\t\tcase InterpolateSmooth:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodSmooth;\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( factoryMethod === undefined ) {\n\n\t\t\tconst message = 'unsupported interpolation for ' +\n\t\t\t\tthis.ValueTypeName + ' keyframe track named ' + this.name;\n\n\t\t\tif ( this.createInterpolant === undefined ) {\n\n\t\t\t\t// fall back to default, unless the default itself is messed up\n\t\t\t\tif ( interpolation !== this.DefaultInterpolation ) {\n\n\t\t\t\t\tthis.setInterpolation( this.DefaultInterpolation );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( message ); // fatal, in this case\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconsole.warn( 'THREE.KeyframeTrack:', message );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tthis.createInterpolant = factoryMethod;\n\n\t\treturn this;\n\n\t}\n\n\tgetInterpolation() {\n\n\t\tswitch ( this.createInterpolant ) {\n\n\t\t\tcase this.InterpolantFactoryMethodDiscrete:\n\n\t\t\t\treturn InterpolateDiscrete;\n\n\t\t\tcase this.InterpolantFactoryMethodLinear:\n\n\t\t\t\treturn InterpolateLinear;\n\n\t\t\tcase this.InterpolantFactoryMethodSmooth:\n\n\t\t\t\treturn InterpolateSmooth;\n\n\t\t}\n\n\t}\n\n\tgetValueSize() {\n\n\t\treturn this.values.length / this.times.length;\n\n\t}\n\n\t// move all keyframes either forwards or backwards in time\n\tshift( timeOffset ) {\n\n\t\tif ( timeOffset !== 0.0 ) {\n\n\t\t\tconst times = this.times;\n\n\t\t\tfor ( let i = 0, n = times.length; i !== n; ++ i ) {\n\n\t\t\t\ttimes[ i ] += timeOffset;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// scale all keyframe times by a factor (useful for frame <-> seconds conversions)\n\tscale( timeScale ) {\n\n\t\tif ( timeScale !== 1.0 ) {\n\n\t\t\tconst times = this.times;\n\n\t\t\tfor ( let i = 0, n = times.length; i !== n; ++ i ) {\n\n\t\t\t\ttimes[ i ] *= timeScale;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// removes keyframes before and after animation without changing any values within the range [startTime, endTime].\n\t// IMPORTANT: We do not shift around keys to the start of the track time, because for interpolated keys this will change their values\n\ttrim( startTime, endTime ) {\n\n\t\tconst times = this.times,\n\t\t\tnKeys = times.length;\n\n\t\tlet from = 0,\n\t\t\tto = nKeys - 1;\n\n\t\twhile ( from !== nKeys && times[ from ] < startTime ) {\n\n\t\t\t++ from;\n\n\t\t}\n\n\t\twhile ( to !== - 1 && times[ to ] > endTime ) {\n\n\t\t\t-- to;\n\n\t\t}\n\n\t\t++ to; // inclusive -> exclusive bound\n\n\t\tif ( from !== 0 || to !== nKeys ) {\n\n\t\t\t// empty tracks are forbidden, so keep at least one keyframe\n\t\t\tif ( from >= to ) {\n\n\t\t\t\tto = Math.max( to, 1 );\n\t\t\t\tfrom = to - 1;\n\n\t\t\t}\n\n\t\t\tconst stride = this.getValueSize();\n\t\t\tthis.times = AnimationUtils.arraySlice( times, from, to );\n\t\t\tthis.values = AnimationUtils.arraySlice( this.values, from * stride, to * stride );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// ensure we do not get a GarbageInGarbageOut situation, make sure tracks are at least minimally viable\n\tvalidate() {\n\n\t\tlet valid = true;\n\n\t\tconst valueSize = this.getValueSize();\n\t\tif ( valueSize - Math.floor( valueSize ) !== 0 ) {\n\n\t\t\tconsole.error( 'THREE.KeyframeTrack: Invalid value size in track.', this );\n\t\t\tvalid = false;\n\n\t\t}\n\n\t\tconst times = this.times,\n\t\t\tvalues = this.values,\n\n\t\t\tnKeys = times.length;\n\n\t\tif ( nKeys === 0 ) {\n\n\t\t\tconsole.error( 'THREE.KeyframeTrack: Track is empty.', this );\n\t\t\tvalid = false;\n\n\t\t}\n\n\t\tlet prevTime = null;\n\n\t\tfor ( let i = 0; i !== nKeys; i ++ ) {\n\n\t\t\tconst currTime = times[ i ];\n\n\t\t\tif ( typeof currTime === 'number' && isNaN( currTime ) ) {\n\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Time is not a valid number.', this, i, currTime );\n\t\t\t\tvalid = false;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( prevTime !== null && prevTime > currTime ) {\n\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Out of order keys.', this, i, currTime, prevTime );\n\t\t\t\tvalid = false;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tprevTime = currTime;\n\n\t\t}\n\n\t\tif ( values !== undefined ) {\n\n\t\t\tif ( AnimationUtils.isTypedArray( values ) ) {\n\n\t\t\t\tfor ( let i = 0, n = values.length; i !== n; ++ i ) {\n\n\t\t\t\t\tconst value = values[ i ];\n\n\t\t\t\t\tif ( isNaN( value ) ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Value is not a valid number.', this, i, value );\n\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn valid;\n\n\t}\n\n\t// removes equivalent sequential keys as common in morph target sequences\n\t// (0,0,0,0,1,1,1,0,0,0,0,0,0,0) --> (0,0,1,1,0,0)\n\toptimize() {\n\n\t\t// times or values may be shared with other tracks, so overwriting is unsafe\n\t\tconst times = AnimationUtils.arraySlice( this.times ),\n\t\t\tvalues = AnimationUtils.arraySlice( this.values ),\n\t\t\tstride = this.getValueSize(),\n\n\t\t\tsmoothInterpolation = this.getInterpolation() === InterpolateSmooth,\n\n\t\t\tlastIndex = times.length - 1;\n\n\t\tlet writeIndex = 1;\n\n\t\tfor ( let i = 1; i < lastIndex; ++ i ) {\n\n\t\t\tlet keep = false;\n\n\t\t\tconst time = times[ i ];\n\t\t\tconst timeNext = times[ i + 1 ];\n\n\t\t\t// remove adjacent keyframes scheduled at the same time\n\n\t\t\tif ( time !== timeNext && ( i !== 1 || time !== times[ 0 ] ) ) {\n\n\t\t\t\tif ( ! smoothInterpolation ) {\n\n\t\t\t\t\t// remove unnecessary keyframes same as their neighbors\n\n\t\t\t\t\tconst offset = i * stride,\n\t\t\t\t\t\toffsetP = offset - stride,\n\t\t\t\t\t\toffsetN = offset + stride;\n\n\t\t\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\t\t\tconst value = values[ offset + j ];\n\n\t\t\t\t\t\tif ( value !== values[ offsetP + j ] ||\n\t\t\t\t\t\t\tvalue !== values[ offsetN + j ] ) {\n\n\t\t\t\t\t\t\tkeep = true;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tkeep = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// in-place compaction\n\n\t\t\tif ( keep ) {\n\n\t\t\t\tif ( i !== writeIndex ) {\n\n\t\t\t\t\ttimes[ writeIndex ] = times[ i ];\n\n\t\t\t\t\tconst readOffset = i * stride,\n\t\t\t\t\t\twriteOffset = writeIndex * stride;\n\n\t\t\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t++ writeIndex;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// flush last keyframe (compaction looks ahead)\n\n\t\tif ( lastIndex > 0 ) {\n\n\t\t\ttimes[ writeIndex ] = times[ lastIndex ];\n\n\t\t\tfor ( let readOffset = lastIndex * stride, writeOffset = writeIndex * stride, j = 0; j !== stride; ++ j ) {\n\n\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\n\n\t\t\t}\n\n\t\t\t++ writeIndex;\n\n\t\t}\n\n\t\tif ( writeIndex !== times.length ) {\n\n\t\t\tthis.times = AnimationUtils.arraySlice( times, 0, writeIndex );\n\t\t\tthis.values = AnimationUtils.arraySlice( values, 0, writeIndex * stride );\n\n\t\t} else {\n\n\t\t\tthis.times = times;\n\t\t\tthis.values = values;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\tconst times = AnimationUtils.arraySlice( this.times, 0 );\n\t\tconst values = AnimationUtils.arraySlice( this.values, 0 );\n\n\t\tconst TypedKeyframeTrack = this.constructor;\n\t\tconst track = new TypedKeyframeTrack( this.name, times, values );\n\n\t\t// Interpolant argument to constructor is not saved, so copy the factory method directly.\n\t\ttrack.createInterpolant = this.createInterpolant;\n\n\t\treturn track;\n\n\t}\n\n}\n\nKeyframeTrack.prototype.TimeBufferType = Float32Array;\nKeyframeTrack.prototype.ValueBufferType = Float32Array;\nKeyframeTrack.prototype.DefaultInterpolation = InterpolateLinear;\n\n/**\n * A Track of Boolean keyframe values.\n */\nclass BooleanKeyframeTrack extends KeyframeTrack {}\n\nBooleanKeyframeTrack.prototype.ValueTypeName = 'bool';\nBooleanKeyframeTrack.prototype.ValueBufferType = Array;\nBooleanKeyframeTrack.prototype.DefaultInterpolation = InterpolateDiscrete;\nBooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear = undefined;\nBooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\n/**\n * A Track of keyframe values that represent color.\n */\nclass ColorKeyframeTrack extends KeyframeTrack {}\n\nColorKeyframeTrack.prototype.ValueTypeName = 'color';\n\n/**\n * A Track of numeric keyframe values.\n */\nclass NumberKeyframeTrack extends KeyframeTrack {}\n\nNumberKeyframeTrack.prototype.ValueTypeName = 'number';\n\n/**\n * Spherical linear unit quaternion interpolant.\n */\n\nclass QuaternionLinearInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\talpha = ( t - t0 ) / ( t1 - t0 );\n\n\t\tlet offset = i1 * stride;\n\n\t\tfor ( let end = offset + stride; offset !== end; offset += 4 ) {\n\n\t\t\tQuaternion.slerpFlat( result, 0, values, offset - stride, values, offset, alpha );\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\n/**\n * A Track of quaternion keyframe values.\n */\nclass QuaternionKeyframeTrack extends KeyframeTrack {\n\n\tInterpolantFactoryMethodLinear( result ) {\n\n\t\treturn new QuaternionLinearInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n}\n\nQuaternionKeyframeTrack.prototype.ValueTypeName = 'quaternion';\n// ValueBufferType is inherited\nQuaternionKeyframeTrack.prototype.DefaultInterpolation = InterpolateLinear;\nQuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\n/**\n * A Track that interpolates Strings\n */\nclass StringKeyframeTrack extends KeyframeTrack {}\n\nStringKeyframeTrack.prototype.ValueTypeName = 'string';\nStringKeyframeTrack.prototype.ValueBufferType = Array;\nStringKeyframeTrack.prototype.DefaultInterpolation = InterpolateDiscrete;\nStringKeyframeTrack.prototype.InterpolantFactoryMethodLinear = undefined;\nStringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\n/**\n * A Track of vectored keyframe values.\n */\nclass VectorKeyframeTrack extends KeyframeTrack {}\n\nVectorKeyframeTrack.prototype.ValueTypeName = 'vector';\n\nclass AnimationClip {\n\n\tconstructor( name, duration = - 1, tracks, blendMode = NormalAnimationBlendMode ) {\n\n\t\tthis.name = name;\n\t\tthis.tracks = tracks;\n\t\tthis.duration = duration;\n\t\tthis.blendMode = blendMode;\n\n\t\tthis.uuid = generateUUID();\n\n\t\t// this means it should figure out its duration by scanning the tracks\n\t\tif ( this.duration < 0 ) {\n\n\t\t\tthis.resetDuration();\n\n\t\t}\n\n\t}\n\n\n\tstatic parse( json ) {\n\n\t\tconst tracks = [],\n\t\t\tjsonTracks = json.tracks,\n\t\t\tframeTime = 1.0 / ( json.fps || 1.0 );\n\n\t\tfor ( let i = 0, n = jsonTracks.length; i !== n; ++ i ) {\n\n\t\t\ttracks.push( parseKeyframeTrack( jsonTracks[ i ] ).scale( frameTime ) );\n\n\t\t}\n\n\t\tconst clip = new this( json.name, json.duration, tracks, json.blendMode );\n\t\tclip.uuid = json.uuid;\n\n\t\treturn clip;\n\n\t}\n\n\tstatic toJSON( clip ) {\n\n\t\tconst tracks = [],\n\t\t\tclipTracks = clip.tracks;\n\n\t\tconst json = {\n\n\t\t\t'name': clip.name,\n\t\t\t'duration': clip.duration,\n\t\t\t'tracks': tracks,\n\t\t\t'uuid': clip.uuid,\n\t\t\t'blendMode': clip.blendMode\n\n\t\t};\n\n\t\tfor ( let i = 0, n = clipTracks.length; i !== n; ++ i ) {\n\n\t\t\ttracks.push( KeyframeTrack.toJSON( clipTracks[ i ] ) );\n\n\t\t}\n\n\t\treturn json;\n\n\t}\n\n\tstatic CreateFromMorphTargetSequence( name, morphTargetSequence, fps, noLoop ) {\n\n\t\tconst numMorphTargets = morphTargetSequence.length;\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < numMorphTargets; i ++ ) {\n\n\t\t\tlet times = [];\n\t\t\tlet values = [];\n\n\t\t\ttimes.push(\n\t\t\t\t( i + numMorphTargets - 1 ) % numMorphTargets,\n\t\t\t\ti,\n\t\t\t\t( i + 1 ) % numMorphTargets );\n\n\t\t\tvalues.push( 0, 1, 0 );\n\n\t\t\tconst order = AnimationUtils.getKeyframeOrder( times );\n\t\t\ttimes = AnimationUtils.sortedArray( times, 1, order );\n\t\t\tvalues = AnimationUtils.sortedArray( values, 1, order );\n\n\t\t\t// if there is a key at the first frame, duplicate it as the\n\t\t\t// last frame as well for perfect loop.\n\t\t\tif ( ! noLoop && times[ 0 ] === 0 ) {\n\n\t\t\t\ttimes.push( numMorphTargets );\n\t\t\t\tvalues.push( values[ 0 ] );\n\n\t\t\t}\n\n\t\t\ttracks.push(\n\t\t\t\tnew NumberKeyframeTrack(\n\t\t\t\t\t'.morphTargetInfluences[' + morphTargetSequence[ i ].name + ']',\n\t\t\t\t\ttimes, values\n\t\t\t\t).scale( 1.0 / fps ) );\n\n\t\t}\n\n\t\treturn new this( name, - 1, tracks );\n\n\t}\n\n\tstatic findByName( objectOrClipArray, name ) {\n\n\t\tlet clipArray = objectOrClipArray;\n\n\t\tif ( ! Array.isArray( objectOrClipArray ) ) {\n\n\t\t\tconst o = objectOrClipArray;\n\t\t\tclipArray = o.geometry && o.geometry.animations || o.animations;\n\n\t\t}\n\n\t\tfor ( let i = 0; i < clipArray.length; i ++ ) {\n\n\t\t\tif ( clipArray[ i ].name === name ) {\n\n\t\t\t\treturn clipArray[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tstatic CreateClipsFromMorphTargetSequences( morphTargets, fps, noLoop ) {\n\n\t\tconst animationToMorphTargets = {};\n\n\t\t// tested with https://regex101.com/ on trick sequences\n\t\t// such flamingo_flyA_003, flamingo_run1_003, crdeath0059\n\t\tconst pattern = /^([\\w-]*?)([\\d]+)$/;\n\n\t\t// sort morph target names into animation groups based\n\t\t// patterns like Walk_001, Walk_002, Run_001, Run_002\n\t\tfor ( let i = 0, il = morphTargets.length; i < il; i ++ ) {\n\n\t\t\tconst morphTarget = morphTargets[ i ];\n\t\t\tconst parts = morphTarget.name.match( pattern );\n\n\t\t\tif ( parts && parts.length > 1 ) {\n\n\t\t\t\tconst name = parts[ 1 ];\n\n\t\t\t\tlet animationMorphTargets = animationToMorphTargets[ name ];\n\n\t\t\t\tif ( ! animationMorphTargets ) {\n\n\t\t\t\t\tanimationToMorphTargets[ name ] = animationMorphTargets = [];\n\n\t\t\t\t}\n\n\t\t\t\tanimationMorphTargets.push( morphTarget );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst clips = [];\n\n\t\tfor ( const name in animationToMorphTargets ) {\n\n\t\t\tclips.push( this.CreateFromMorphTargetSequence( name, animationToMorphTargets[ name ], fps, noLoop ) );\n\n\t\t}\n\n\t\treturn clips;\n\n\t}\n\n\t// parse the animation.hierarchy format\n\tstatic parseAnimation( animation, bones ) {\n\n\t\tif ( ! animation ) {\n\n\t\t\tconsole.error( 'THREE.AnimationClip: No animation in JSONLoader data.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst addNonemptyTrack = function ( trackType, trackName, animationKeys, propertyName, destTracks ) {\n\n\t\t\t// only return track if there are actually keys.\n\t\t\tif ( animationKeys.length !== 0 ) {\n\n\t\t\t\tconst times = [];\n\t\t\t\tconst values = [];\n\n\t\t\t\tAnimationUtils.flattenJSON( animationKeys, times, values, propertyName );\n\n\t\t\t\t// empty keys are filtered out, so check again\n\t\t\t\tif ( times.length !== 0 ) {\n\n\t\t\t\t\tdestTracks.push( new trackType( trackName, times, values ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tconst tracks = [];\n\n\t\tconst clipName = animation.name || 'default';\n\t\tconst fps = animation.fps || 30;\n\t\tconst blendMode = animation.blendMode;\n\n\t\t// automatic length determination in AnimationClip.\n\t\tlet duration = animation.length || - 1;\n\n\t\tconst hierarchyTracks = animation.hierarchy || [];\n\n\t\tfor ( let h = 0; h < hierarchyTracks.length; h ++ ) {\n\n\t\t\tconst animationKeys = hierarchyTracks[ h ].keys;\n\n\t\t\t// skip empty tracks\n\t\t\tif ( ! animationKeys || animationKeys.length === 0 ) continue;\n\n\t\t\t// process morph targets\n\t\t\tif ( animationKeys[ 0 ].morphTargets ) {\n\n\t\t\t\t// figure out all morph targets used in this track\n\t\t\t\tconst morphTargetNames = {};\n\n\t\t\t\tlet k;\n\n\t\t\t\tfor ( k = 0; k < animationKeys.length; k ++ ) {\n\n\t\t\t\t\tif ( animationKeys[ k ].morphTargets ) {\n\n\t\t\t\t\t\tfor ( let m = 0; m < animationKeys[ k ].morphTargets.length; m ++ ) {\n\n\t\t\t\t\t\t\tmorphTargetNames[ animationKeys[ k ].morphTargets[ m ] ] = - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// create a track for each morph target with all zero\n\t\t\t\t// morphTargetInfluences except for the keys in which\n\t\t\t\t// the morphTarget is named.\n\t\t\t\tfor ( const morphTargetName in morphTargetNames ) {\n\n\t\t\t\t\tconst times = [];\n\t\t\t\t\tconst values = [];\n\n\t\t\t\t\tfor ( let m = 0; m !== animationKeys[ k ].morphTargets.length; ++ m ) {\n\n\t\t\t\t\t\tconst animationKey = animationKeys[ k ];\n\n\t\t\t\t\t\ttimes.push( animationKey.time );\n\t\t\t\t\t\tvalues.push( ( animationKey.morphTarget === morphTargetName ) ? 1 : 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( new NumberKeyframeTrack( '.morphTargetInfluence[' + morphTargetName + ']', times, values ) );\n\n\t\t\t\t}\n\n\t\t\t\tduration = morphTargetNames.length * ( fps || 1.0 );\n\n\t\t\t} else {\n\n\t\t\t\t// ...assume skeletal animation\n\n\t\t\t\tconst boneName = '.bones[' + bones[ h ].name + ']';\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tVectorKeyframeTrack, boneName + '.position',\n\t\t\t\t\tanimationKeys, 'pos', tracks );\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tQuaternionKeyframeTrack, boneName + '.quaternion',\n\t\t\t\t\tanimationKeys, 'rot', tracks );\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tVectorKeyframeTrack, boneName + '.scale',\n\t\t\t\t\tanimationKeys, 'scl', tracks );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( tracks.length === 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst clip = new this( clipName, duration, tracks, blendMode );\n\n\t\treturn clip;\n\n\t}\n\n\tresetDuration() {\n\n\t\tconst tracks = this.tracks;\n\t\tlet duration = 0;\n\n\t\tfor ( let i = 0, n = tracks.length; i !== n; ++ i ) {\n\n\t\t\tconst track = this.tracks[ i ];\n\n\t\t\tduration = Math.max( duration, track.times[ track.times.length - 1 ] );\n\n\t\t}\n\n\t\tthis.duration = duration;\n\n\t\treturn this;\n\n\t}\n\n\ttrim() {\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tthis.tracks[ i ].trim( 0, this.duration );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tvalidate() {\n\n\t\tlet valid = true;\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tvalid = valid && this.tracks[ i ].validate();\n\n\t\t}\n\n\t\treturn valid;\n\n\t}\n\n\toptimize() {\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tthis.tracks[ i ].optimize();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\ttracks.push( this.tracks[ i ].clone() );\n\n\t\t}\n\n\t\treturn new this.constructor( this.name, this.duration, tracks, this.blendMode );\n\n\t}\n\n\ttoJSON() {\n\n\t\treturn this.constructor.toJSON( this );\n\n\t}\n\n}\n\nfunction getTrackTypeForValueTypeName( typeName ) {\n\n\tswitch ( typeName.toLowerCase() ) {\n\n\t\tcase 'scalar':\n\t\tcase 'double':\n\t\tcase 'float':\n\t\tcase 'number':\n\t\tcase 'integer':\n\n\t\t\treturn NumberKeyframeTrack;\n\n\t\tcase 'vector':\n\t\tcase 'vector2':\n\t\tcase 'vector3':\n\t\tcase 'vector4':\n\n\t\t\treturn VectorKeyframeTrack;\n\n\t\tcase 'color':\n\n\t\t\treturn ColorKeyframeTrack;\n\n\t\tcase 'quaternion':\n\n\t\t\treturn QuaternionKeyframeTrack;\n\n\t\tcase 'bool':\n\t\tcase 'boolean':\n\n\t\t\treturn BooleanKeyframeTrack;\n\n\t\tcase 'string':\n\n\t\t\treturn StringKeyframeTrack;\n\n\t}\n\n\tthrow new Error( 'THREE.KeyframeTrack: Unsupported typeName: ' + typeName );\n\n}\n\nfunction parseKeyframeTrack( json ) {\n\n\tif ( json.type === undefined ) {\n\n\t\tthrow new Error( 'THREE.KeyframeTrack: track type undefined, can not parse' );\n\n\t}\n\n\tconst trackType = getTrackTypeForValueTypeName( json.type );\n\n\tif ( json.times === undefined ) {\n\n\t\tconst times = [], values = [];\n\n\t\tAnimationUtils.flattenJSON( json.keys, times, values, 'value' );\n\n\t\tjson.times = times;\n\t\tjson.values = values;\n\n\t}\n\n\t// derived classes can define a static parse method\n\tif ( trackType.parse !== undefined ) {\n\n\t\treturn trackType.parse( json );\n\n\t} else {\n\n\t\t// by default, we assume a constructor compatible with the base\n\t\treturn new trackType( json.name, json.times, json.values, json.interpolation );\n\n\t}\n\n}\n\nconst Cache = {\n\n\tenabled: false,\n\n\tfiles: {},\n\n\tadd: function ( key, file ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\n\n\t\tthis.files[ key ] = file;\n\n\t},\n\n\tget: function ( key ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\n\n\t\treturn this.files[ key ];\n\n\t},\n\n\tremove: function ( key ) {\n\n\t\tdelete this.files[ key ];\n\n\t},\n\n\tclear: function () {\n\n\t\tthis.files = {};\n\n\t}\n\n};\n\nclass LoadingManager {\n\n\tconstructor( onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet isLoading = false;\n\t\tlet itemsLoaded = 0;\n\t\tlet itemsTotal = 0;\n\t\tlet urlModifier = undefined;\n\t\tconst handlers = [];\n\n\t\t// Refer to #5689 for the reason why we don't set .onStart\n\t\t// in the constructor\n\n\t\tthis.onStart = undefined;\n\t\tthis.onLoad = onLoad;\n\t\tthis.onProgress = onProgress;\n\t\tthis.onError = onError;\n\n\t\tthis.itemStart = function ( url ) {\n\n\t\t\titemsTotal ++;\n\n\t\t\tif ( isLoading === false ) {\n\n\t\t\t\tif ( scope.onStart !== undefined ) {\n\n\t\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tisLoading = true;\n\n\t\t};\n\n\t\tthis.itemEnd = function ( url ) {\n\n\t\t\titemsLoaded ++;\n\n\t\t\tif ( scope.onProgress !== undefined ) {\n\n\t\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\n\n\t\t\t}\n\n\t\t\tif ( itemsLoaded === itemsTotal ) {\n\n\t\t\t\tisLoading = false;\n\n\t\t\t\tif ( scope.onLoad !== undefined ) {\n\n\t\t\t\t\tscope.onLoad();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.itemError = function ( url ) {\n\n\t\t\tif ( scope.onError !== undefined ) {\n\n\t\t\t\tscope.onError( url );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.resolveURL = function ( url ) {\n\n\t\t\tif ( urlModifier ) {\n\n\t\t\t\treturn urlModifier( url );\n\n\t\t\t}\n\n\t\t\treturn url;\n\n\t\t};\n\n\t\tthis.setURLModifier = function ( transform ) {\n\n\t\t\turlModifier = transform;\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.addHandler = function ( regex, loader ) {\n\n\t\t\thandlers.push( regex, loader );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.removeHandler = function ( regex ) {\n\n\t\t\tconst index = handlers.indexOf( regex );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\thandlers.splice( index, 2 );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.getHandler = function ( file ) {\n\n\t\t\tfor ( let i = 0, l = handlers.length; i < l; i += 2 ) {\n\n\t\t\t\tconst regex = handlers[ i ];\n\t\t\t\tconst loader = handlers[ i + 1 ];\n\n\t\t\t\tif ( regex.global ) regex.lastIndex = 0; // see #17920\n\n\t\t\t\tif ( regex.test( file ) ) {\n\n\t\t\t\t\treturn loader;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn null;\n\n\t\t};\n\n\t}\n\n}\n\nconst DefaultLoadingManager = new LoadingManager();\n\nclass Loader {\n\n\tconstructor( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t\tthis.crossOrigin = 'anonymous';\n\t\tthis.withCredentials = false;\n\t\tthis.path = '';\n\t\tthis.resourcePath = '';\n\t\tthis.requestHeader = {};\n\n\t}\n\n\tload( /* url, onLoad, onProgress, onError */ ) {}\n\n\tloadAsync( url, onProgress ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.load( url, resolve, onProgress, reject );\n\n\t\t} );\n\n\t}\n\n\tparse( /* data */ ) {}\n\n\tsetCrossOrigin( crossOrigin ) {\n\n\t\tthis.crossOrigin = crossOrigin;\n\t\treturn this;\n\n\t}\n\n\tsetWithCredentials( value ) {\n\n\t\tthis.withCredentials = value;\n\t\treturn this;\n\n\t}\n\n\tsetPath( path ) {\n\n\t\tthis.path = path;\n\t\treturn this;\n\n\t}\n\n\tsetResourcePath( resourcePath ) {\n\n\t\tthis.resourcePath = resourcePath;\n\t\treturn this;\n\n\t}\n\n\tsetRequestHeader( requestHeader ) {\n\n\t\tthis.requestHeader = requestHeader;\n\t\treturn this;\n\n\t}\n\n}\n\nconst loading = {};\n\nclass FileLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tthis.manager.itemStart( url );\n\n\t\t\tsetTimeout( () => {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tthis.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\t// Check if request is duplicate\n\n\t\tif ( loading[ url ] !== undefined ) {\n\n\t\t\tloading[ url ].push( {\n\n\t\t\t\tonLoad: onLoad,\n\t\t\t\tonProgress: onProgress,\n\t\t\t\tonError: onError\n\n\t\t\t} );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Initialise array for duplicate requests\n\t\tloading[ url ] = [];\n\n\t\tloading[ url ].push( {\n\t\t\tonLoad: onLoad,\n\t\t\tonProgress: onProgress,\n\t\t\tonError: onError,\n\t\t} );\n\n\t\t// create request\n\t\tconst req = new Request( url, {\n\t\t\theaders: new Headers( this.requestHeader ),\n\t\t\tcredentials: this.withCredentials ? 'include' : 'same-origin',\n\t\t\t// An abort controller could be added within a future PR\n\t\t} );\n\n\t\t// record states ( avoid data race )\n\t\tconst mimeType = this.mimeType;\n\t\tconst responseType = this.responseType;\n\n\t\t// start the fetch\n\t\tfetch( req )\n\t\t\t.then( response => {\n\n\t\t\t\tif ( response.status === 200 || response.status === 0 ) {\n\n\t\t\t\t\t// Some browsers return HTTP Status 0 when using non-http protocol\n\t\t\t\t\t// e.g. 'file://' or 'data://'. Handle as success.\n\n\t\t\t\t\tif ( response.status === 0 ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.FileLoader: HTTP Status 0 received.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( typeof ReadableStream === 'undefined' || response.body.getReader === undefined ) {\n\n\t\t\t\t\t\treturn response;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst callbacks = loading[ url ];\n\t\t\t\t\tconst reader = response.body.getReader();\n\t\t\t\t\tconst contentLength = response.headers.get( 'Content-Length' );\n\t\t\t\t\tconst total = contentLength ? parseInt( contentLength ) : 0;\n\t\t\t\t\tconst lengthComputable = total !== 0;\n\t\t\t\t\tlet loaded = 0;\n\n\t\t\t\t\t// periodically read data into the new stream tracking while download progress\n\t\t\t\t\tconst stream = new ReadableStream( {\n\t\t\t\t\t\tstart( controller ) {\n\n\t\t\t\t\t\t\treadData();\n\n\t\t\t\t\t\t\tfunction readData() {\n\n\t\t\t\t\t\t\t\treader.read().then( ( { done, value } ) => {\n\n\t\t\t\t\t\t\t\t\tif ( done ) {\n\n\t\t\t\t\t\t\t\t\t\tcontroller.close();\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\tloaded += value.byteLength;\n\n\t\t\t\t\t\t\t\t\t\tconst event = new ProgressEvent( 'progress', { lengthComputable, loaded, total } );\n\t\t\t\t\t\t\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\t\t\t\t\t\t\tif ( callback.onProgress ) callback.onProgress( event );\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tcontroller.enqueue( value );\n\t\t\t\t\t\t\t\t\t\treadData();\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t\treturn new Response( stream );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow Error( `fetch for \"${response.url}\" responded with ${response.status}: ${response.statusText}` );\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.then( response => {\n\n\t\t\t\tswitch ( responseType ) {\n\n\t\t\t\t\tcase 'arraybuffer':\n\n\t\t\t\t\t\treturn response.arrayBuffer();\n\n\t\t\t\t\tcase 'blob':\n\n\t\t\t\t\t\treturn response.blob();\n\n\t\t\t\t\tcase 'document':\n\n\t\t\t\t\t\treturn response.text()\n\t\t\t\t\t\t\t.then( text => {\n\n\t\t\t\t\t\t\t\tconst parser = new DOMParser();\n\t\t\t\t\t\t\t\treturn parser.parseFromString( text, mimeType );\n\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\tcase 'json':\n\n\t\t\t\t\t\treturn response.json();\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( mimeType === undefined ) {\n\n\t\t\t\t\t\t\treturn response.text();\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// sniff encoding\n\t\t\t\t\t\t\tconst re = /charset=\"?([^;\"\\s]*)\"?/i;\n\t\t\t\t\t\t\tconst exec = re.exec( mimeType );\n\t\t\t\t\t\t\tconst label = exec && exec[ 1 ] ? exec[ 1 ].toLowerCase() : undefined;\n\t\t\t\t\t\t\tconst decoder = new TextDecoder( label );\n\t\t\t\t\t\t\treturn response.arrayBuffer().then( ab => decoder.decode( ab ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.then( data => {\n\n\t\t\t\t// Add to cache only on HTTP success, so that we do not cache\n\t\t\t\t// error response bodies as proper responses to requests.\n\t\t\t\tCache.add( url, data );\n\n\t\t\t\tconst callbacks = loading[ url ];\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onLoad ) callback.onLoad( data );\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.catch( err => {\n\n\t\t\t\t// Abort errors and other errors are handled the same\n\n\t\t\t\tconst callbacks = loading[ url ];\n\n\t\t\t\tif ( callbacks === undefined ) {\n\n\t\t\t\t\t// When onLoad was called and url was deleted in `loading`\n\t\t\t\t\tthis.manager.itemError( url );\n\t\t\t\t\tthrow err;\n\n\t\t\t\t}\n\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onError ) callback.onError( err );\n\n\t\t\t\t}\n\n\t\t\t\tthis.manager.itemError( url );\n\n\t\t\t} )\n\t\t\t.finally( () => {\n\n\t\t\t\tthis.manager.itemEnd( url );\n\n\t\t\t} );\n\n\t\tthis.manager.itemStart( url );\n\n\t}\n\n\tsetResponseType( value ) {\n\n\t\tthis.responseType = value;\n\t\treturn this;\n\n\t}\n\n\tsetMimeType( value ) {\n\n\t\tthis.mimeType = value;\n\t\treturn this;\n\n\t}\n\n}\n\nclass AnimationLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst animations = [];\n\n\t\tfor ( let i = 0; i < json.length; i ++ ) {\n\n\t\t\tconst clip = AnimationClip.parse( json[ i ] );\n\n\t\t\tanimations.push( clip );\n\n\t\t}\n\n\t\treturn animations;\n\n\t}\n\n}\n\n/**\n * Abstract Base class to block based textures loader (dds, pvr, ...)\n *\n * Sub classes have to implement the parse() method which will be used in load().\n */\n\nclass CompressedTextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst images = [];\n\n\t\tconst texture = new CompressedTexture();\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\n\t\tlet loaded = 0;\n\n\t\tfunction loadTexture( i ) {\n\n\t\t\tloader.load( url[ i ], function ( buffer ) {\n\n\t\t\t\tconst texDatas = scope.parse( buffer, true );\n\n\t\t\t\timages[ i ] = {\n\t\t\t\t\twidth: texDatas.width,\n\t\t\t\t\theight: texDatas.height,\n\t\t\t\t\tformat: texDatas.format,\n\t\t\t\t\tmipmaps: texDatas.mipmaps\n\t\t\t\t};\n\n\t\t\t\tloaded += 1;\n\n\t\t\t\tif ( loaded === 6 ) {\n\n\t\t\t\t\tif ( texDatas.mipmapCount === 1 ) texture.minFilter = LinearFilter;\n\n\t\t\t\t\ttexture.image = images;\n\t\t\t\t\ttexture.format = texDatas.format;\n\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t\t}\n\n\t\t\t}, onProgress, onError );\n\n\t\t}\n\n\t\tif ( Array.isArray( url ) ) {\n\n\t\t\tfor ( let i = 0, il = url.length; i < il; ++ i ) {\n\n\t\t\t\tloadTexture( i );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// compressed cubemap texture stored in a single DDS file\n\n\t\t\tloader.load( url, function ( buffer ) {\n\n\t\t\t\tconst texDatas = scope.parse( buffer, true );\n\n\t\t\t\tif ( texDatas.isCubemap ) {\n\n\t\t\t\t\tconst faces = texDatas.mipmaps.length / texDatas.mipmapCount;\n\n\t\t\t\t\tfor ( let f = 0; f < faces; f ++ ) {\n\n\t\t\t\t\t\timages[ f ] = { mipmaps: [] };\n\n\t\t\t\t\t\tfor ( let i = 0; i < texDatas.mipmapCount; i ++ ) {\n\n\t\t\t\t\t\t\timages[ f ].mipmaps.push( texDatas.mipmaps[ f * texDatas.mipmapCount + i ] );\n\t\t\t\t\t\t\timages[ f ].format = texDatas.format;\n\t\t\t\t\t\t\timages[ f ].width = texDatas.width;\n\t\t\t\t\t\t\timages[ f ].height = texDatas.height;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttexture.image = images;\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttexture.image.width = texDatas.width;\n\t\t\t\t\ttexture.image.height = texDatas.height;\n\t\t\t\t\ttexture.mipmaps = texDatas.mipmaps;\n\n\t\t\t\t}\n\n\t\t\t\tif ( texDatas.mipmapCount === 1 ) {\n\n\t\t\t\t\ttexture.minFilter = LinearFilter;\n\n\t\t\t\t}\n\n\t\t\t\ttexture.format = texDatas.format;\n\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t}, onProgress, onError );\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n}\n\nclass ImageLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tconst image = createElementNS( 'img' );\n\n\t\tfunction onImageLoad() {\n\n\t\t\tremoveEventListeners();\n\n\t\t\tCache.add( url, this );\n\n\t\t\tif ( onLoad ) onLoad( this );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}\n\n\t\tfunction onImageError( event ) {\n\n\t\t\tremoveEventListeners();\n\n\t\t\tif ( onError ) onError( event );\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}\n\n\t\tfunction removeEventListeners() {\n\n\t\t\timage.removeEventListener( 'load', onImageLoad, false );\n\t\t\timage.removeEventListener( 'error', onImageError, false );\n\n\t\t}\n\n\t\timage.addEventListener( 'load', onImageLoad, false );\n\t\timage.addEventListener( 'error', onImageError, false );\n\n\t\tif ( url.substr( 0, 5 ) !== 'data:' ) {\n\n\t\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\n\n\t\t}\n\n\t\tscope.manager.itemStart( url );\n\n\t\timage.src = url;\n\n\t\treturn image;\n\n\t}\n\n}\n\nclass CubeTextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( urls, onLoad, onProgress, onError ) {\n\n\t\tconst texture = new CubeTexture();\n\n\t\tconst loader = new ImageLoader( this.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.setPath( this.path );\n\n\t\tlet loaded = 0;\n\n\t\tfunction loadTexture( i ) {\n\n\t\t\tloader.load( urls[ i ], function ( image ) {\n\n\t\t\t\ttexture.images[ i ] = image;\n\n\t\t\t\tloaded ++;\n\n\t\t\t\tif ( loaded === 6 ) {\n\n\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t\t}\n\n\t\t\t}, undefined, onError );\n\n\t\t}\n\n\t\tfor ( let i = 0; i < urls.length; ++ i ) {\n\n\t\t\tloadTexture( i );\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n}\n\n/**\n * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\n *\n * Sub classes have to implement the parse() method which will be used in load().\n */\n\nclass DataTextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst texture = new DataTexture();\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setPath( this.path );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\tconst texData = scope.parse( buffer );\n\n\t\t\tif ( ! texData ) return;\n\n\t\t\tif ( texData.image !== undefined ) {\n\n\t\t\t\ttexture.image = texData.image;\n\n\t\t\t} else if ( texData.data !== undefined ) {\n\n\t\t\t\ttexture.image.width = texData.width;\n\t\t\t\ttexture.image.height = texData.height;\n\t\t\t\ttexture.image.data = texData.data;\n\n\t\t\t}\n\n\t\t\ttexture.wrapS = texData.wrapS !== undefined ? texData.wrapS : ClampToEdgeWrapping;\n\t\t\ttexture.wrapT = texData.wrapT !== undefined ? texData.wrapT : ClampToEdgeWrapping;\n\n\t\t\ttexture.magFilter = texData.magFilter !== undefined ? texData.magFilter : LinearFilter;\n\t\t\ttexture.minFilter = texData.minFilter !== undefined ? texData.minFilter : LinearFilter;\n\n\t\t\ttexture.anisotropy = texData.anisotropy !== undefined ? texData.anisotropy : 1;\n\n\t\t\tif ( texData.encoding !== undefined ) {\n\n\t\t\t\ttexture.encoding = texData.encoding;\n\n\t\t\t}\n\n\t\t\tif ( texData.flipY !== undefined ) {\n\n\t\t\t\ttexture.flipY = texData.flipY;\n\n\t\t\t}\n\n\t\t\tif ( texData.format !== undefined ) {\n\n\t\t\t\ttexture.format = texData.format;\n\n\t\t\t}\n\n\t\t\tif ( texData.type !== undefined ) {\n\n\t\t\t\ttexture.type = texData.type;\n\n\t\t\t}\n\n\t\t\tif ( texData.mipmaps !== undefined ) {\n\n\t\t\t\ttexture.mipmaps = texData.mipmaps;\n\t\t\t\ttexture.minFilter = LinearMipmapLinearFilter; // presumably...\n\n\t\t\t}\n\n\t\t\tif ( texData.mipmapCount === 1 ) {\n\n\t\t\t\ttexture.minFilter = LinearFilter;\n\n\t\t\t}\n\n\t\t\tif ( texData.generateMipmaps !== undefined ) {\n\n\t\t\t\ttexture.generateMipmaps = texData.generateMipmaps;\n\n\t\t\t}\n\n\t\t\ttexture.needsUpdate = true;\n\n\t\t\tif ( onLoad ) onLoad( texture, texData );\n\n\t\t}, onProgress, onError );\n\n\n\t\treturn texture;\n\n\t}\n\n}\n\nclass TextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst texture = new Texture();\n\n\t\tconst loader = new ImageLoader( this.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.setPath( this.path );\n\n\t\tloader.load( url, function ( image ) {\n\n\t\t\ttexture.image = image;\n\t\t\ttexture.needsUpdate = true;\n\n\t\t\tif ( onLoad !== undefined ) {\n\n\t\t\t\tonLoad( texture );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t\treturn texture;\n\n\t}\n\n}\n\nclass Light extends Object3D {\n\n\tconstructor( color, intensity = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Light';\n\n\t\tthis.color = new Color( color );\n\t\tthis.intensity = intensity;\n\n\t}\n\n\tdispose() {\n\n\t\t// Empty here in base class; some subclasses override.\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\t\tthis.intensity = source.intensity;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.color = this.color.getHex();\n\t\tdata.object.intensity = this.intensity;\n\n\t\tif ( this.groundColor !== undefined ) data.object.groundColor = this.groundColor.getHex();\n\n\t\tif ( this.distance !== undefined ) data.object.distance = this.distance;\n\t\tif ( this.angle !== undefined ) data.object.angle = this.angle;\n\t\tif ( this.decay !== undefined ) data.object.decay = this.decay;\n\t\tif ( this.penumbra !== undefined ) data.object.penumbra = this.penumbra;\n\n\t\tif ( this.shadow !== undefined ) data.object.shadow = this.shadow.toJSON();\n\n\t\treturn data;\n\n\t}\n\n}\n\nLight.prototype.isLight = true;\n\nclass HemisphereLight extends Light {\n\n\tconstructor( skyColor, groundColor, intensity ) {\n\n\t\tsuper( skyColor, intensity );\n\n\t\tthis.type = 'HemisphereLight';\n\n\t\tthis.position.copy( Object3D.DefaultUp );\n\t\tthis.updateMatrix();\n\n\t\tthis.groundColor = new Color( groundColor );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tLight.prototype.copy.call( this, source );\n\n\t\tthis.groundColor.copy( source.groundColor );\n\n\t\treturn this;\n\n\t}\n\n}\n\nHemisphereLight.prototype.isHemisphereLight = true;\n\nconst _projScreenMatrix$1 = /*@__PURE__*/ new Matrix4();\nconst _lightPositionWorld$1 = /*@__PURE__*/ new Vector3();\nconst _lookTarget$1 = /*@__PURE__*/ new Vector3();\n\nclass LightShadow {\n\n\tconstructor( camera ) {\n\n\t\tthis.camera = camera;\n\n\t\tthis.bias = 0;\n\t\tthis.normalBias = 0;\n\t\tthis.radius = 1;\n\t\tthis.blurSamples = 8;\n\n\t\tthis.mapSize = new Vector2( 512, 512 );\n\n\t\tthis.map = null;\n\t\tthis.mapPass = null;\n\t\tthis.matrix = new Matrix4();\n\n\t\tthis.autoUpdate = true;\n\t\tthis.needsUpdate = false;\n\n\t\tthis._frustum = new Frustum();\n\t\tthis._frameExtents = new Vector2( 1, 1 );\n\n\t\tthis._viewportCount = 1;\n\n\t\tthis._viewports = [\n\n\t\t\tnew Vector4( 0, 0, 1, 1 )\n\n\t\t];\n\n\t}\n\n\tgetViewportCount() {\n\n\t\treturn this._viewportCount;\n\n\t}\n\n\tgetFrustum() {\n\n\t\treturn this._frustum;\n\n\t}\n\n\tupdateMatrices( light ) {\n\n\t\tconst shadowCamera = this.camera;\n\t\tconst shadowMatrix = this.matrix;\n\n\t\t_lightPositionWorld$1.setFromMatrixPosition( light.matrixWorld );\n\t\tshadowCamera.position.copy( _lightPositionWorld$1 );\n\n\t\t_lookTarget$1.setFromMatrixPosition( light.target.matrixWorld );\n\t\tshadowCamera.lookAt( _lookTarget$1 );\n\t\tshadowCamera.updateMatrixWorld();\n\n\t\t_projScreenMatrix$1.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\n\t\tthis._frustum.setFromProjectionMatrix( _projScreenMatrix$1 );\n\n\t\tshadowMatrix.set(\n\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t);\n\n\t\tshadowMatrix.multiply( shadowCamera.projectionMatrix );\n\t\tshadowMatrix.multiply( shadowCamera.matrixWorldInverse );\n\n\t}\n\n\tgetViewport( viewportIndex ) {\n\n\t\treturn this._viewports[ viewportIndex ];\n\n\t}\n\n\tgetFrameExtents() {\n\n\t\treturn this._frameExtents;\n\n\t}\n\n\tdispose() {\n\n\t\tif ( this.map ) {\n\n\t\t\tthis.map.dispose();\n\n\t\t}\n\n\t\tif ( this.mapPass ) {\n\n\t\t\tthis.mapPass.dispose();\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.camera = source.camera.clone();\n\n\t\tthis.bias = source.bias;\n\t\tthis.radius = source.radius;\n\n\t\tthis.mapSize.copy( source.mapSize );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst object = {};\n\n\t\tif ( this.bias !== 0 ) object.bias = this.bias;\n\t\tif ( this.normalBias !== 0 ) object.normalBias = this.normalBias;\n\t\tif ( this.radius !== 1 ) object.radius = this.radius;\n\t\tif ( this.mapSize.x !== 512 || this.mapSize.y !== 512 ) object.mapSize = this.mapSize.toArray();\n\n\t\tobject.camera = this.camera.toJSON( false ).object;\n\t\tdelete object.camera.matrix;\n\n\t\treturn object;\n\n\t}\n\n}\n\nclass SpotLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new PerspectiveCamera( 50, 1, 0.5, 500 ) );\n\n\t\tthis.focus = 1;\n\n\t}\n\n\tupdateMatrices( light ) {\n\n\t\tconst camera = this.camera;\n\n\t\tconst fov = RAD2DEG * 2 * light.angle * this.focus;\n\t\tconst aspect = this.mapSize.width / this.mapSize.height;\n\t\tconst far = light.distance || camera.far;\n\n\t\tif ( fov !== camera.fov || aspect !== camera.aspect || far !== camera.far ) {\n\n\t\t\tcamera.fov = fov;\n\t\t\tcamera.aspect = aspect;\n\t\t\tcamera.far = far;\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\tsuper.updateMatrices( light );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.focus = source.focus;\n\n\t\treturn this;\n\n\t}\n\n}\n\nSpotLightShadow.prototype.isSpotLightShadow = true;\n\nclass SpotLight extends Light {\n\n\tconstructor( color, intensity, distance = 0, angle = Math.PI / 3, penumbra = 0, decay = 1 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.type = 'SpotLight';\n\n\t\tthis.position.copy( Object3D.DefaultUp );\n\t\tthis.updateMatrix();\n\n\t\tthis.target = new Object3D();\n\n\t\tthis.distance = distance;\n\t\tthis.angle = angle;\n\t\tthis.penumbra = penumbra;\n\t\tthis.decay = decay; // for physically correct lights, should be 2.\n\n\t\tthis.shadow = new SpotLightShadow();\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in candela)\n\t\t// by convention for a spotlight, luminous power (lm) = π * luminous intensity (cd)\n\t\treturn this.intensity * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in candela) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / Math.PI;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.distance = source.distance;\n\t\tthis.angle = source.angle;\n\t\tthis.penumbra = source.penumbra;\n\t\tthis.decay = source.decay;\n\n\t\tthis.target = source.target.clone();\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nSpotLight.prototype.isSpotLight = true;\n\nconst _projScreenMatrix = /*@__PURE__*/ new Matrix4();\nconst _lightPositionWorld = /*@__PURE__*/ new Vector3();\nconst _lookTarget = /*@__PURE__*/ new Vector3();\n\nclass PointLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new PerspectiveCamera( 90, 1, 0.5, 500 ) );\n\n\t\tthis._frameExtents = new Vector2( 4, 2 );\n\n\t\tthis._viewportCount = 6;\n\n\t\tthis._viewports = [\n\t\t\t// These viewports map a cube-map onto a 2D texture with the\n\t\t\t// following orientation:\n\t\t\t//\n\t\t\t//  xzXZ\n\t\t\t//   y Y\n\t\t\t//\n\t\t\t// X - Positive x direction\n\t\t\t// x - Negative x direction\n\t\t\t// Y - Positive y direction\n\t\t\t// y - Negative y direction\n\t\t\t// Z - Positive z direction\n\t\t\t// z - Negative z direction\n\n\t\t\t// positive X\n\t\t\tnew Vector4( 2, 1, 1, 1 ),\n\t\t\t// negative X\n\t\t\tnew Vector4( 0, 1, 1, 1 ),\n\t\t\t// positive Z\n\t\t\tnew Vector4( 3, 1, 1, 1 ),\n\t\t\t// negative Z\n\t\t\tnew Vector4( 1, 1, 1, 1 ),\n\t\t\t// positive Y\n\t\t\tnew Vector4( 3, 0, 1, 1 ),\n\t\t\t// negative Y\n\t\t\tnew Vector4( 1, 0, 1, 1 )\n\t\t];\n\n\t\tthis._cubeDirections = [\n\t\t\tnew Vector3( 1, 0, 0 ), new Vector3( - 1, 0, 0 ), new Vector3( 0, 0, 1 ),\n\t\t\tnew Vector3( 0, 0, - 1 ), new Vector3( 0, 1, 0 ), new Vector3( 0, - 1, 0 )\n\t\t];\n\n\t\tthis._cubeUps = [\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ),\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 0, 1 ),\tnew Vector3( 0, 0, - 1 )\n\t\t];\n\n\t}\n\n\tupdateMatrices( light, viewportIndex = 0 ) {\n\n\t\tconst camera = this.camera;\n\t\tconst shadowMatrix = this.matrix;\n\n\t\tconst far = light.distance || camera.far;\n\n\t\tif ( far !== camera.far ) {\n\n\t\t\tcamera.far = far;\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\t_lightPositionWorld.setFromMatrixPosition( light.matrixWorld );\n\t\tcamera.position.copy( _lightPositionWorld );\n\n\t\t_lookTarget.copy( camera.position );\n\t\t_lookTarget.add( this._cubeDirections[ viewportIndex ] );\n\t\tcamera.up.copy( this._cubeUps[ viewportIndex ] );\n\t\tcamera.lookAt( _lookTarget );\n\t\tcamera.updateMatrixWorld();\n\n\t\tshadowMatrix.makeTranslation( - _lightPositionWorld.x, - _lightPositionWorld.y, - _lightPositionWorld.z );\n\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\n\t\tthis._frustum.setFromProjectionMatrix( _projScreenMatrix );\n\n\t}\n\n}\n\nPointLightShadow.prototype.isPointLightShadow = true;\n\nclass PointLight extends Light {\n\n\tconstructor( color, intensity, distance = 0, decay = 1 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.type = 'PointLight';\n\n\t\tthis.distance = distance;\n\t\tthis.decay = decay; // for physically correct lights, should be 2.\n\n\t\tthis.shadow = new PointLightShadow();\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in candela)\n\t\t// for an isotropic light source, luminous power (lm) = 4 π luminous intensity (cd)\n\t\treturn this.intensity * 4 * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in candela) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / ( 4 * Math.PI );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.distance = source.distance;\n\t\tthis.decay = source.decay;\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nPointLight.prototype.isPointLight = true;\n\nclass DirectionalLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new OrthographicCamera( - 5, 5, 5, - 5, 0.5, 500 ) );\n\n\t}\n\n}\n\nDirectionalLightShadow.prototype.isDirectionalLightShadow = true;\n\nclass DirectionalLight extends Light {\n\n\tconstructor( color, intensity ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.type = 'DirectionalLight';\n\n\t\tthis.position.copy( Object3D.DefaultUp );\n\t\tthis.updateMatrix();\n\n\t\tthis.target = new Object3D();\n\n\t\tthis.shadow = new DirectionalLightShadow();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.target = source.target.clone();\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nDirectionalLight.prototype.isDirectionalLight = true;\n\nclass AmbientLight extends Light {\n\n\tconstructor( color, intensity ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.type = 'AmbientLight';\n\n\t}\n\n}\n\nAmbientLight.prototype.isAmbientLight = true;\n\nclass RectAreaLight extends Light {\n\n\tconstructor( color, intensity, width = 10, height = 10 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.type = 'RectAreaLight';\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in nits)\n\t\treturn this.intensity * this.width * this.height * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in nits) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / ( this.width * this.height * Math.PI );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.width = source.width;\n\t\tthis.height = source.height;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.width = this.width;\n\t\tdata.object.height = this.height;\n\n\t\treturn data;\n\n\t}\n\n}\n\nRectAreaLight.prototype.isRectAreaLight = true;\n\n/**\n * Primary reference:\n *   https://graphics.stanford.edu/papers/envmap/envmap.pdf\n *\n * Secondary reference:\n *   https://www.ppsloan.org/publications/StupidSH36.pdf\n */\n\n// 3-band SH defined by 9 coefficients\n\nclass SphericalHarmonics3 {\n\n\tconstructor() {\n\n\t\tthis.coefficients = [];\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients.push( new Vector3() );\n\n\t\t}\n\n\t}\n\n\tset( coefficients ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].copy( coefficients[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tzero() {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].set( 0, 0, 0 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// get the radiance in the direction of the normal\n\t// target is a Vector3\n\tgetAt( normal, target ) {\n\n\t\t// normal is assumed to be unit length\n\n\t\tconst x = normal.x, y = normal.y, z = normal.z;\n\n\t\tconst coeff = this.coefficients;\n\n\t\t// band 0\n\t\ttarget.copy( coeff[ 0 ] ).multiplyScalar( 0.282095 );\n\n\t\t// band 1\n\t\ttarget.addScaledVector( coeff[ 1 ], 0.488603 * y );\n\t\ttarget.addScaledVector( coeff[ 2 ], 0.488603 * z );\n\t\ttarget.addScaledVector( coeff[ 3 ], 0.488603 * x );\n\n\t\t// band 2\n\t\ttarget.addScaledVector( coeff[ 4 ], 1.092548 * ( x * y ) );\n\t\ttarget.addScaledVector( coeff[ 5 ], 1.092548 * ( y * z ) );\n\t\ttarget.addScaledVector( coeff[ 6 ], 0.315392 * ( 3.0 * z * z - 1.0 ) );\n\t\ttarget.addScaledVector( coeff[ 7 ], 1.092548 * ( x * z ) );\n\t\ttarget.addScaledVector( coeff[ 8 ], 0.546274 * ( x * x - y * y ) );\n\n\t\treturn target;\n\n\t}\n\n\t// get the irradiance (radiance convolved with cosine lobe) in the direction of the normal\n\t// target is a Vector3\n\t// https://graphics.stanford.edu/papers/envmap/envmap.pdf\n\tgetIrradianceAt( normal, target ) {\n\n\t\t// normal is assumed to be unit length\n\n\t\tconst x = normal.x, y = normal.y, z = normal.z;\n\n\t\tconst coeff = this.coefficients;\n\n\t\t// band 0\n\t\ttarget.copy( coeff[ 0 ] ).multiplyScalar( 0.886227 ); // π * 0.282095\n\n\t\t// band 1\n\t\ttarget.addScaledVector( coeff[ 1 ], 2.0 * 0.511664 * y ); // ( 2 * π / 3 ) * 0.488603\n\t\ttarget.addScaledVector( coeff[ 2 ], 2.0 * 0.511664 * z );\n\t\ttarget.addScaledVector( coeff[ 3 ], 2.0 * 0.511664 * x );\n\n\t\t// band 2\n\t\ttarget.addScaledVector( coeff[ 4 ], 2.0 * 0.429043 * x * y ); // ( π / 4 ) * 1.092548\n\t\ttarget.addScaledVector( coeff[ 5 ], 2.0 * 0.429043 * y * z );\n\t\ttarget.addScaledVector( coeff[ 6 ], 0.743125 * z * z - 0.247708 ); // ( π / 4 ) * 0.315392 * 3\n\t\ttarget.addScaledVector( coeff[ 7 ], 2.0 * 0.429043 * x * z );\n\t\ttarget.addScaledVector( coeff[ 8 ], 0.429043 * ( x * x - y * y ) ); // ( π / 4 ) * 0.546274\n\n\t\treturn target;\n\n\t}\n\n\tadd( sh ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].add( sh.coefficients[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\taddScaledSH( sh, s ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].addScaledVector( sh.coefficients[ i ], s );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tscale( s ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].multiplyScalar( s );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tlerp( sh, alpha ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].lerp( sh.coefficients[ i ], alpha );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tequals( sh ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tif ( ! this.coefficients[ i ].equals( sh.coefficients[ i ] ) ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tcopy( sh ) {\n\n\t\treturn this.set( sh.coefficients );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tconst coefficients = this.coefficients;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tcoefficients[ i ].fromArray( array, offset + ( i * 3 ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst coefficients = this.coefficients;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tcoefficients[ i ].toArray( array, offset + ( i * 3 ) );\n\n\t\t}\n\n\t\treturn array;\n\n\t}\n\n\t// evaluate the basis functions\n\t// shBasis is an Array[ 9 ]\n\tstatic getBasisAt( normal, shBasis ) {\n\n\t\t// normal is assumed to be unit length\n\n\t\tconst x = normal.x, y = normal.y, z = normal.z;\n\n\t\t// band 0\n\t\tshBasis[ 0 ] = 0.282095;\n\n\t\t// band 1\n\t\tshBasis[ 1 ] = 0.488603 * y;\n\t\tshBasis[ 2 ] = 0.488603 * z;\n\t\tshBasis[ 3 ] = 0.488603 * x;\n\n\t\t// band 2\n\t\tshBasis[ 4 ] = 1.092548 * x * y;\n\t\tshBasis[ 5 ] = 1.092548 * y * z;\n\t\tshBasis[ 6 ] = 0.315392 * ( 3 * z * z - 1 );\n\t\tshBasis[ 7 ] = 1.092548 * x * z;\n\t\tshBasis[ 8 ] = 0.546274 * ( x * x - y * y );\n\n\t}\n\n}\n\nSphericalHarmonics3.prototype.isSphericalHarmonics3 = true;\n\nclass LightProbe extends Light {\n\n\tconstructor( sh = new SphericalHarmonics3(), intensity = 1 ) {\n\n\t\tsuper( undefined, intensity );\n\n\t\tthis.sh = sh;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.sh.copy( source.sh );\n\n\t\treturn this;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tthis.intensity = json.intensity; // TODO: Move this bit to Light.fromJSON();\n\t\tthis.sh.fromArray( json.sh );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.sh = this.sh.toArray();\n\n\t\treturn data;\n\n\t}\n\n}\n\nLightProbe.prototype.isLightProbe = true;\n\nclass MaterialLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\t\tthis.textures = {};\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( scope.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst textures = this.textures;\n\n\t\tfunction getTexture( name ) {\n\n\t\t\tif ( textures[ name ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.MaterialLoader: Undefined texture', name );\n\n\t\t\t}\n\n\t\t\treturn textures[ name ];\n\n\t\t}\n\n\t\tconst material = new Materials[ json.type ]();\n\n\t\tif ( json.uuid !== undefined ) material.uuid = json.uuid;\n\t\tif ( json.name !== undefined ) material.name = json.name;\n\t\tif ( json.color !== undefined && material.color !== undefined ) material.color.setHex( json.color );\n\t\tif ( json.roughness !== undefined ) material.roughness = json.roughness;\n\t\tif ( json.metalness !== undefined ) material.metalness = json.metalness;\n\t\tif ( json.sheen !== undefined ) material.sheen = json.sheen;\n\t\tif ( json.sheenColor !== undefined ) material.sheenColor = new Color().setHex( json.sheenColor );\n\t\tif ( json.sheenRoughness !== undefined ) material.sheenRoughness = json.sheenRoughness;\n\t\tif ( json.emissive !== undefined && material.emissive !== undefined ) material.emissive.setHex( json.emissive );\n\t\tif ( json.specular !== undefined && material.specular !== undefined ) material.specular.setHex( json.specular );\n\t\tif ( json.specularIntensity !== undefined ) material.specularIntensity = json.specularIntensity;\n\t\tif ( json.specularColor !== undefined && material.specularColor !== undefined ) material.specularColor.setHex( json.specularColor );\n\t\tif ( json.shininess !== undefined ) material.shininess = json.shininess;\n\t\tif ( json.clearcoat !== undefined ) material.clearcoat = json.clearcoat;\n\t\tif ( json.clearcoatRoughness !== undefined ) material.clearcoatRoughness = json.clearcoatRoughness;\n\t\tif ( json.transmission !== undefined ) material.transmission = json.transmission;\n\t\tif ( json.thickness !== undefined ) material.thickness = json.thickness;\n\t\tif ( json.attenuationDistance !== undefined ) material.attenuationDistance = json.attenuationDistance;\n\t\tif ( json.attenuationColor !== undefined && material.attenuationColor !== undefined ) material.attenuationColor.setHex( json.attenuationColor );\n\t\tif ( json.fog !== undefined ) material.fog = json.fog;\n\t\tif ( json.flatShading !== undefined ) material.flatShading = json.flatShading;\n\t\tif ( json.blending !== undefined ) material.blending = json.blending;\n\t\tif ( json.combine !== undefined ) material.combine = json.combine;\n\t\tif ( json.side !== undefined ) material.side = json.side;\n\t\tif ( json.shadowSide !== undefined ) material.shadowSide = json.shadowSide;\n\t\tif ( json.opacity !== undefined ) material.opacity = json.opacity;\n\t\tif ( json.transparent !== undefined ) material.transparent = json.transparent;\n\t\tif ( json.alphaTest !== undefined ) material.alphaTest = json.alphaTest;\n\t\tif ( json.depthTest !== undefined ) material.depthTest = json.depthTest;\n\t\tif ( json.depthWrite !== undefined ) material.depthWrite = json.depthWrite;\n\t\tif ( json.colorWrite !== undefined ) material.colorWrite = json.colorWrite;\n\n\t\tif ( json.stencilWrite !== undefined ) material.stencilWrite = json.stencilWrite;\n\t\tif ( json.stencilWriteMask !== undefined ) material.stencilWriteMask = json.stencilWriteMask;\n\t\tif ( json.stencilFunc !== undefined ) material.stencilFunc = json.stencilFunc;\n\t\tif ( json.stencilRef !== undefined ) material.stencilRef = json.stencilRef;\n\t\tif ( json.stencilFuncMask !== undefined ) material.stencilFuncMask = json.stencilFuncMask;\n\t\tif ( json.stencilFail !== undefined ) material.stencilFail = json.stencilFail;\n\t\tif ( json.stencilZFail !== undefined ) material.stencilZFail = json.stencilZFail;\n\t\tif ( json.stencilZPass !== undefined ) material.stencilZPass = json.stencilZPass;\n\n\t\tif ( json.wireframe !== undefined ) material.wireframe = json.wireframe;\n\t\tif ( json.wireframeLinewidth !== undefined ) material.wireframeLinewidth = json.wireframeLinewidth;\n\t\tif ( json.wireframeLinecap !== undefined ) material.wireframeLinecap = json.wireframeLinecap;\n\t\tif ( json.wireframeLinejoin !== undefined ) material.wireframeLinejoin = json.wireframeLinejoin;\n\n\t\tif ( json.rotation !== undefined ) material.rotation = json.rotation;\n\n\t\tif ( json.linewidth !== 1 ) material.linewidth = json.linewidth;\n\t\tif ( json.dashSize !== undefined ) material.dashSize = json.dashSize;\n\t\tif ( json.gapSize !== undefined ) material.gapSize = json.gapSize;\n\t\tif ( json.scale !== undefined ) material.scale = json.scale;\n\n\t\tif ( json.polygonOffset !== undefined ) material.polygonOffset = json.polygonOffset;\n\t\tif ( json.polygonOffsetFactor !== undefined ) material.polygonOffsetFactor = json.polygonOffsetFactor;\n\t\tif ( json.polygonOffsetUnits !== undefined ) material.polygonOffsetUnits = json.polygonOffsetUnits;\n\n\t\tif ( json.dithering !== undefined ) material.dithering = json.dithering;\n\n\t\tif ( json.alphaToCoverage !== undefined ) material.alphaToCoverage = json.alphaToCoverage;\n\t\tif ( json.premultipliedAlpha !== undefined ) material.premultipliedAlpha = json.premultipliedAlpha;\n\n\t\tif ( json.visible !== undefined ) material.visible = json.visible;\n\n\t\tif ( json.toneMapped !== undefined ) material.toneMapped = json.toneMapped;\n\n\t\tif ( json.userData !== undefined ) material.userData = json.userData;\n\n\t\tif ( json.vertexColors !== undefined ) {\n\n\t\t\tif ( typeof json.vertexColors === 'number' ) {\n\n\t\t\t\tmaterial.vertexColors = ( json.vertexColors > 0 ) ? true : false;\n\n\t\t\t} else {\n\n\t\t\t\tmaterial.vertexColors = json.vertexColors;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Shader Material\n\n\t\tif ( json.uniforms !== undefined ) {\n\n\t\t\tfor ( const name in json.uniforms ) {\n\n\t\t\t\tconst uniform = json.uniforms[ name ];\n\n\t\t\t\tmaterial.uniforms[ name ] = {};\n\n\t\t\t\tswitch ( uniform.type ) {\n\n\t\t\t\t\tcase 't':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = getTexture( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'c':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Color().setHex( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v2':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector2().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v3':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector3().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v4':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector4().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'm3':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Matrix3().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'm4':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Matrix4().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = uniform.value;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( json.defines !== undefined ) material.defines = json.defines;\n\t\tif ( json.vertexShader !== undefined ) material.vertexShader = json.vertexShader;\n\t\tif ( json.fragmentShader !== undefined ) material.fragmentShader = json.fragmentShader;\n\n\t\tif ( json.extensions !== undefined ) {\n\n\t\t\tfor ( const key in json.extensions ) {\n\n\t\t\t\tmaterial.extensions[ key ] = json.extensions[ key ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Deprecated\n\n\t\tif ( json.shading !== undefined ) material.flatShading = json.shading === 1; // THREE.FlatShading\n\n\t\t// for PointsMaterial\n\n\t\tif ( json.size !== undefined ) material.size = json.size;\n\t\tif ( json.sizeAttenuation !== undefined ) material.sizeAttenuation = json.sizeAttenuation;\n\n\t\t// maps\n\n\t\tif ( json.map !== undefined ) material.map = getTexture( json.map );\n\t\tif ( json.matcap !== undefined ) material.matcap = getTexture( json.matcap );\n\n\t\tif ( json.alphaMap !== undefined ) material.alphaMap = getTexture( json.alphaMap );\n\n\t\tif ( json.bumpMap !== undefined ) material.bumpMap = getTexture( json.bumpMap );\n\t\tif ( json.bumpScale !== undefined ) material.bumpScale = json.bumpScale;\n\n\t\tif ( json.normalMap !== undefined ) material.normalMap = getTexture( json.normalMap );\n\t\tif ( json.normalMapType !== undefined ) material.normalMapType = json.normalMapType;\n\t\tif ( json.normalScale !== undefined ) {\n\n\t\t\tlet normalScale = json.normalScale;\n\n\t\t\tif ( Array.isArray( normalScale ) === false ) {\n\n\t\t\t\t// Blender exporter used to export a scalar. See #7459\n\n\t\t\t\tnormalScale = [ normalScale, normalScale ];\n\n\t\t\t}\n\n\t\t\tmaterial.normalScale = new Vector2().fromArray( normalScale );\n\n\t\t}\n\n\t\tif ( json.displacementMap !== undefined ) material.displacementMap = getTexture( json.displacementMap );\n\t\tif ( json.displacementScale !== undefined ) material.displacementScale = json.displacementScale;\n\t\tif ( json.displacementBias !== undefined ) material.displacementBias = json.displacementBias;\n\n\t\tif ( json.roughnessMap !== undefined ) material.roughnessMap = getTexture( json.roughnessMap );\n\t\tif ( json.metalnessMap !== undefined ) material.metalnessMap = getTexture( json.metalnessMap );\n\n\t\tif ( json.emissiveMap !== undefined ) material.emissiveMap = getTexture( json.emissiveMap );\n\t\tif ( json.emissiveIntensity !== undefined ) material.emissiveIntensity = json.emissiveIntensity;\n\n\t\tif ( json.specularMap !== undefined ) material.specularMap = getTexture( json.specularMap );\n\t\tif ( json.specularIntensityMap !== undefined ) material.specularIntensityMap = getTexture( json.specularIntensityMap );\n\t\tif ( json.specularColorMap !== undefined ) material.specularColorMap = getTexture( json.specularColorMap );\n\n\t\tif ( json.envMap !== undefined ) material.envMap = getTexture( json.envMap );\n\t\tif ( json.envMapIntensity !== undefined ) material.envMapIntensity = json.envMapIntensity;\n\n\t\tif ( json.reflectivity !== undefined ) material.reflectivity = json.reflectivity;\n\t\tif ( json.refractionRatio !== undefined ) material.refractionRatio = json.refractionRatio;\n\n\t\tif ( json.lightMap !== undefined ) material.lightMap = getTexture( json.lightMap );\n\t\tif ( json.lightMapIntensity !== undefined ) material.lightMapIntensity = json.lightMapIntensity;\n\n\t\tif ( json.aoMap !== undefined ) material.aoMap = getTexture( json.aoMap );\n\t\tif ( json.aoMapIntensity !== undefined ) material.aoMapIntensity = json.aoMapIntensity;\n\n\t\tif ( json.gradientMap !== undefined ) material.gradientMap = getTexture( json.gradientMap );\n\n\t\tif ( json.clearcoatMap !== undefined ) material.clearcoatMap = getTexture( json.clearcoatMap );\n\t\tif ( json.clearcoatRoughnessMap !== undefined ) material.clearcoatRoughnessMap = getTexture( json.clearcoatRoughnessMap );\n\t\tif ( json.clearcoatNormalMap !== undefined ) material.clearcoatNormalMap = getTexture( json.clearcoatNormalMap );\n\t\tif ( json.clearcoatNormalScale !== undefined ) material.clearcoatNormalScale = new Vector2().fromArray( json.clearcoatNormalScale );\n\n\t\tif ( json.transmissionMap !== undefined ) material.transmissionMap = getTexture( json.transmissionMap );\n\t\tif ( json.thicknessMap !== undefined ) material.thicknessMap = getTexture( json.thicknessMap );\n\n\t\tif ( json.sheenColorMap !== undefined ) material.sheenColorMap = getTexture( json.sheenColorMap );\n\t\tif ( json.sheenRoughnessMap !== undefined ) material.sheenRoughnessMap = getTexture( json.sheenRoughnessMap );\n\n\t\treturn material;\n\n\t}\n\n\tsetTextures( value ) {\n\n\t\tthis.textures = value;\n\t\treturn this;\n\n\t}\n\n}\n\nclass LoaderUtils {\n\n\tstatic decodeText( array ) {\n\n\t\tif ( typeof TextDecoder !== 'undefined' ) {\n\n\t\t\treturn new TextDecoder().decode( array );\n\n\t\t}\n\n\t\t// Avoid the String.fromCharCode.apply(null, array) shortcut, which\n\t\t// throws a \"maximum call stack size exceeded\" error for large arrays.\n\n\t\tlet s = '';\n\n\t\tfor ( let i = 0, il = array.length; i < il; i ++ ) {\n\n\t\t\t// Implicitly assumes little-endian.\n\t\t\ts += String.fromCharCode( array[ i ] );\n\n\t\t}\n\n\t\ttry {\n\n\t\t\t// merges multi-byte utf-8 characters.\n\n\t\t\treturn decodeURIComponent( escape( s ) );\n\n\t\t} catch ( e ) { // see #16358\n\n\t\t\treturn s;\n\n\t\t}\n\n\t}\n\n\tstatic extractUrlBase( url ) {\n\n\t\tconst index = url.lastIndexOf( '/' );\n\n\t\tif ( index === - 1 ) return './';\n\n\t\treturn url.substr( 0, index + 1 );\n\n\t}\n\n\tstatic resolveURL( url, path ) {\n\n\t\t// Invalid URL\n\t\tif ( typeof url !== 'string' || url === '' ) return '';\n\n\t\t// Host Relative URL\n\t\tif ( /^https?:\\/\\//i.test( path ) && /^\\//.test( url ) ) {\n\n\t\t\tpath = path.replace( /(^https?:\\/\\/[^\\/]+).*/i, '$1' );\n\n\t\t}\n\n\t\t// Absolute URL http://,https://,//\n\t\tif ( /^(https?:)?\\/\\//i.test( url ) ) return url;\n\n\t\t// Data URI\n\t\tif ( /^data:.*,.*$/i.test( url ) ) return url;\n\n\t\t// Blob URL\n\t\tif ( /^blob:.*$/i.test( url ) ) return url;\n\n\t\t// Relative URL\n\t\treturn path + url;\n\n\t}\n\n}\n\nclass InstancedBufferGeometry extends BufferGeometry {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'InstancedBufferGeometry';\n\t\tthis.instanceCount = Infinity;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.instanceCount = source.instanceCount;\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON( this );\n\n\t\tdata.instanceCount = this.instanceCount;\n\n\t\tdata.isInstancedBufferGeometry = true;\n\n\t\treturn data;\n\n\t}\n\n}\n\nInstancedBufferGeometry.prototype.isInstancedBufferGeometry = true;\n\nclass BufferGeometryLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( scope.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst interleavedBufferMap = {};\n\t\tconst arrayBufferMap = {};\n\n\t\tfunction getInterleavedBuffer( json, uuid ) {\n\n\t\t\tif ( interleavedBufferMap[ uuid ] !== undefined ) return interleavedBufferMap[ uuid ];\n\n\t\t\tconst interleavedBuffers = json.interleavedBuffers;\n\t\t\tconst interleavedBuffer = interleavedBuffers[ uuid ];\n\n\t\t\tconst buffer = getArrayBuffer( json, interleavedBuffer.buffer );\n\n\t\t\tconst array = getTypedArray( interleavedBuffer.type, buffer );\n\t\t\tconst ib = new InterleavedBuffer( array, interleavedBuffer.stride );\n\t\t\tib.uuid = interleavedBuffer.uuid;\n\n\t\t\tinterleavedBufferMap[ uuid ] = ib;\n\n\t\t\treturn ib;\n\n\t\t}\n\n\t\tfunction getArrayBuffer( json, uuid ) {\n\n\t\t\tif ( arrayBufferMap[ uuid ] !== undefined ) return arrayBufferMap[ uuid ];\n\n\t\t\tconst arrayBuffers = json.arrayBuffers;\n\t\t\tconst arrayBuffer = arrayBuffers[ uuid ];\n\n\t\t\tconst ab = new Uint32Array( arrayBuffer ).buffer;\n\n\t\t\tarrayBufferMap[ uuid ] = ab;\n\n\t\t\treturn ab;\n\n\t\t}\n\n\t\tconst geometry = json.isInstancedBufferGeometry ? new InstancedBufferGeometry() : new BufferGeometry();\n\n\t\tconst index = json.data.index;\n\n\t\tif ( index !== undefined ) {\n\n\t\t\tconst typedArray = getTypedArray( index.type, index.array );\n\t\t\tgeometry.setIndex( new BufferAttribute( typedArray, 1 ) );\n\n\t\t}\n\n\t\tconst attributes = json.data.attributes;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tconst attribute = attributes[ key ];\n\t\t\tlet bufferAttribute;\n\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\tconst interleavedBuffer = getInterleavedBuffer( json.data, attribute.data );\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( interleavedBuffer, attribute.itemSize, attribute.offset, attribute.normalized );\n\n\t\t\t} else {\n\n\t\t\t\tconst typedArray = getTypedArray( attribute.type, attribute.array );\n\t\t\t\tconst bufferAttributeConstr = attribute.isInstancedBufferAttribute ? InstancedBufferAttribute : BufferAttribute;\n\t\t\t\tbufferAttribute = new bufferAttributeConstr( typedArray, attribute.itemSize, attribute.normalized );\n\n\t\t\t}\n\n\t\t\tif ( attribute.name !== undefined ) bufferAttribute.name = attribute.name;\n\t\t\tif ( attribute.usage !== undefined ) bufferAttribute.setUsage( attribute.usage );\n\n\t\t\tif ( attribute.updateRange !== undefined ) {\n\n\t\t\t\tbufferAttribute.updateRange.offset = attribute.updateRange.offset;\n\t\t\t\tbufferAttribute.updateRange.count = attribute.updateRange.count;\n\n\t\t\t}\n\n\t\t\tgeometry.setAttribute( key, bufferAttribute );\n\n\t\t}\n\n\t\tconst morphAttributes = json.data.morphAttributes;\n\n\t\tif ( morphAttributes ) {\n\n\t\t\tfor ( const key in morphAttributes ) {\n\n\t\t\t\tconst attributeArray = morphAttributes[ key ];\n\n\t\t\t\tconst array = [];\n\n\t\t\t\tfor ( let i = 0, il = attributeArray.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst attribute = attributeArray[ i ];\n\t\t\t\t\tlet bufferAttribute;\n\n\t\t\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\t\t\tconst interleavedBuffer = getInterleavedBuffer( json.data, attribute.data );\n\t\t\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( interleavedBuffer, attribute.itemSize, attribute.offset, attribute.normalized );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst typedArray = getTypedArray( attribute.type, attribute.array );\n\t\t\t\t\t\tbufferAttribute = new BufferAttribute( typedArray, attribute.itemSize, attribute.normalized );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attribute.name !== undefined ) bufferAttribute.name = attribute.name;\n\t\t\t\t\tarray.push( bufferAttribute );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.morphAttributes[ key ] = array;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst morphTargetsRelative = json.data.morphTargetsRelative;\n\n\t\tif ( morphTargetsRelative ) {\n\n\t\t\tgeometry.morphTargetsRelative = true;\n\n\t\t}\n\n\t\tconst groups = json.data.groups || json.data.drawcalls || json.data.offsets;\n\n\t\tif ( groups !== undefined ) {\n\n\t\t\tfor ( let i = 0, n = groups.length; i !== n; ++ i ) {\n\n\t\t\t\tconst group = groups[ i ];\n\n\t\t\t\tgeometry.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst boundingSphere = json.data.boundingSphere;\n\n\t\tif ( boundingSphere !== undefined ) {\n\n\t\t\tconst center = new Vector3();\n\n\t\t\tif ( boundingSphere.center !== undefined ) {\n\n\t\t\t\tcenter.fromArray( boundingSphere.center );\n\n\t\t\t}\n\n\t\t\tgeometry.boundingSphere = new Sphere( center, boundingSphere.radius );\n\n\t\t}\n\n\t\tif ( json.name ) geometry.name = json.name;\n\t\tif ( json.userData ) geometry.userData = json.userData;\n\n\t\treturn geometry;\n\n\t}\n\n}\n\nclass ObjectLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( this.path === '' ) ? LoaderUtils.extractUrlBase( url ) : this.path;\n\t\tthis.resourcePath = this.resourcePath || path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\tlet json = null;\n\n\t\t\ttry {\n\n\t\t\t\tjson = JSON.parse( text );\n\n\t\t\t} catch ( error ) {\n\n\t\t\t\tif ( onError !== undefined ) onError( error );\n\n\t\t\t\tconsole.error( 'THREE:ObjectLoader: Can\\'t parse ' + url + '.', error.message );\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tconst metadata = json.metadata;\n\n\t\t\tif ( metadata === undefined || metadata.type === undefined || metadata.type.toLowerCase() === 'geometry' ) {\n\n\t\t\t\tconsole.error( 'THREE.ObjectLoader: Can\\'t load ' + url );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tscope.parse( json, onLoad );\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tasync loadAsync( url, onProgress ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( this.path === '' ) ? LoaderUtils.extractUrlBase( url ) : this.path;\n\t\tthis.resourcePath = this.resourcePath || path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tconst text = await loader.loadAsync( url, onProgress );\n\n\t\tconst json = JSON.parse( text );\n\n\t\tconst metadata = json.metadata;\n\n\t\tif ( metadata === undefined || metadata.type === undefined || metadata.type.toLowerCase() === 'geometry' ) {\n\n\t\t\tthrow new Error( 'THREE.ObjectLoader: Can\\'t load ' + url );\n\n\t\t}\n\n\t\treturn await scope.parseAsync( json );\n\n\t}\n\n\tparse( json, onLoad ) {\n\n\t\tconst animations = this.parseAnimations( json.animations );\n\t\tconst shapes = this.parseShapes( json.shapes );\n\t\tconst geometries = this.parseGeometries( json.geometries, shapes );\n\n\t\tconst images = this.parseImages( json.images, function () {\n\n\t\t\tif ( onLoad !== undefined ) onLoad( object );\n\n\t\t} );\n\n\t\tconst textures = this.parseTextures( json.textures, images );\n\t\tconst materials = this.parseMaterials( json.materials, textures );\n\n\t\tconst object = this.parseObject( json.object, geometries, materials, textures, animations );\n\t\tconst skeletons = this.parseSkeletons( json.skeletons, object );\n\n\t\tthis.bindSkeletons( object, skeletons );\n\n\t\t//\n\n\t\tif ( onLoad !== undefined ) {\n\n\t\t\tlet hasImages = false;\n\n\t\t\tfor ( const uuid in images ) {\n\n\t\t\t\tif ( images[ uuid ] instanceof HTMLImageElement ) {\n\n\t\t\t\t\thasImages = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( hasImages === false ) onLoad( object );\n\n\t\t}\n\n\t\treturn object;\n\n\t}\n\n\tasync parseAsync( json ) {\n\n\t\tconst animations = this.parseAnimations( json.animations );\n\t\tconst shapes = this.parseShapes( json.shapes );\n\t\tconst geometries = this.parseGeometries( json.geometries, shapes );\n\n\t\tconst images = await this.parseImagesAsync( json.images );\n\n\t\tconst textures = this.parseTextures( json.textures, images );\n\t\tconst materials = this.parseMaterials( json.materials, textures );\n\n\t\tconst object = this.parseObject( json.object, geometries, materials, textures, animations );\n\t\tconst skeletons = this.parseSkeletons( json.skeletons, object );\n\n\t\tthis.bindSkeletons( object, skeletons );\n\n\t\treturn object;\n\n\t}\n\n\tparseShapes( json ) {\n\n\t\tconst shapes = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst shape = new Shape().fromJSON( json[ i ] );\n\n\t\t\t\tshapes[ shape.uuid ] = shape;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn shapes;\n\n\t}\n\n\tparseSkeletons( json, object ) {\n\n\t\tconst skeletons = {};\n\t\tconst bones = {};\n\n\t\t// generate bone lookup table\n\n\t\tobject.traverse( function ( child ) {\n\n\t\t\tif ( child.isBone ) bones[ child.uuid ] = child;\n\n\t\t} );\n\n\t\t// create skeletons\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst skeleton = new Skeleton().fromJSON( json[ i ], bones );\n\n\t\t\t\tskeletons[ skeleton.uuid ] = skeleton;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn skeletons;\n\n\t}\n\n\tparseGeometries( json, shapes ) {\n\n\t\tconst geometries = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tconst bufferGeometryLoader = new BufferGeometryLoader();\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tlet geometry;\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tswitch ( data.type ) {\n\n\t\t\t\t\tcase 'BufferGeometry':\n\t\t\t\t\tcase 'InstancedBufferGeometry':\n\n\t\t\t\t\t\tgeometry = bufferGeometryLoader.parse( data );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'Geometry':\n\n\t\t\t\t\t\tconsole.error( 'THREE.ObjectLoader: The legacy Geometry type is no longer supported.' );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( data.type in Geometries ) {\n\n\t\t\t\t\t\t\tgeometry = Geometries[ data.type ].fromJSON( data, shapes );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tconsole.warn( `THREE.ObjectLoader: Unsupported geometry type \"${ data.type }\"` );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.uuid = data.uuid;\n\n\t\t\t\tif ( data.name !== undefined ) geometry.name = data.name;\n\t\t\t\tif ( geometry.isBufferGeometry === true && data.userData !== undefined ) geometry.userData = data.userData;\n\n\t\t\t\tgeometries[ data.uuid ] = geometry;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn geometries;\n\n\t}\n\n\tparseMaterials( json, textures ) {\n\n\t\tconst cache = {}; // MultiMaterial\n\t\tconst materials = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tconst loader = new MaterialLoader();\n\t\t\tloader.setTextures( textures );\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tif ( data.type === 'MultiMaterial' ) {\n\n\t\t\t\t\t// Deprecated\n\n\t\t\t\t\tconst array = [];\n\n\t\t\t\t\tfor ( let j = 0; j < data.materials.length; j ++ ) {\n\n\t\t\t\t\t\tconst material = data.materials[ j ];\n\n\t\t\t\t\t\tif ( cache[ material.uuid ] === undefined ) {\n\n\t\t\t\t\t\t\tcache[ material.uuid ] = loader.parse( material );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tarray.push( cache[ material.uuid ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmaterials[ data.uuid ] = array;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( cache[ data.uuid ] === undefined ) {\n\n\t\t\t\t\t\tcache[ data.uuid ] = loader.parse( data );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmaterials[ data.uuid ] = cache[ data.uuid ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn materials;\n\n\t}\n\n\tparseAnimations( json ) {\n\n\t\tconst animations = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0; i < json.length; i ++ ) {\n\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tconst clip = AnimationClip.parse( data );\n\n\t\t\t\tanimations[ clip.uuid ] = clip;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn animations;\n\n\t}\n\n\tparseImages( json, onLoad ) {\n\n\t\tconst scope = this;\n\t\tconst images = {};\n\n\t\tlet loader;\n\n\t\tfunction loadImage( url ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\treturn loader.load( url, function () {\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, undefined, function () {\n\n\t\t\t\tscope.manager.itemError( url );\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t} );\n\n\t\t}\n\n\t\tfunction deserializeImage( image ) {\n\n\t\t\tif ( typeof image === 'string' ) {\n\n\t\t\t\tconst url = image;\n\n\t\t\t\tconst path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( url ) ? url : scope.resourcePath + url;\n\n\t\t\t\treturn loadImage( path );\n\n\t\t\t} else {\n\n\t\t\t\tif ( image.data ) {\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdata: getTypedArray( image.type, image.data ),\n\t\t\t\t\t\twidth: image.width,\n\t\t\t\t\t\theight: image.height\n\t\t\t\t\t};\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( json !== undefined && json.length > 0 ) {\n\n\t\t\tconst manager = new LoadingManager( onLoad );\n\n\t\t\tloader = new ImageLoader( manager );\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\n\n\t\t\tfor ( let i = 0, il = json.length; i < il; i ++ ) {\n\n\t\t\t\tconst image = json[ i ];\n\t\t\t\tconst url = image.url;\n\n\t\t\t\tif ( Array.isArray( url ) ) {\n\n\t\t\t\t\t// load array of images e.g CubeTexture\n\n\t\t\t\t\timages[ image.uuid ] = [];\n\n\t\t\t\t\tfor ( let j = 0, jl = url.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tconst currentUrl = url[ j ];\n\n\t\t\t\t\t\tconst deserializedImage = deserializeImage( currentUrl );\n\n\t\t\t\t\t\tif ( deserializedImage !== null ) {\n\n\t\t\t\t\t\t\tif ( deserializedImage instanceof HTMLImageElement ) {\n\n\t\t\t\t\t\t\t\timages[ image.uuid ].push( deserializedImage );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t// special case: handle array of data textures for cube textures\n\n\t\t\t\t\t\t\t\timages[ image.uuid ].push( new DataTexture( deserializedImage.data, deserializedImage.width, deserializedImage.height ) );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// load single image\n\n\t\t\t\t\tconst deserializedImage = deserializeImage( image.url );\n\n\t\t\t\t\tif ( deserializedImage !== null ) {\n\n\t\t\t\t\t\timages[ image.uuid ] = deserializedImage;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\tasync parseImagesAsync( json ) {\n\n\t\tconst scope = this;\n\t\tconst images = {};\n\n\t\tlet loader;\n\n\t\tasync function deserializeImage( image ) {\n\n\t\t\tif ( typeof image === 'string' ) {\n\n\t\t\t\tconst url = image;\n\n\t\t\t\tconst path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( url ) ? url : scope.resourcePath + url;\n\n\t\t\t\treturn await loader.loadAsync( path );\n\n\t\t\t} else {\n\n\t\t\t\tif ( image.data ) {\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdata: getTypedArray( image.type, image.data ),\n\t\t\t\t\t\twidth: image.width,\n\t\t\t\t\t\theight: image.height\n\t\t\t\t\t};\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( json !== undefined && json.length > 0 ) {\n\n\t\t\tloader = new ImageLoader( this.manager );\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\n\n\t\t\tfor ( let i = 0, il = json.length; i < il; i ++ ) {\n\n\t\t\t\tconst image = json[ i ];\n\t\t\t\tconst url = image.url;\n\n\t\t\t\tif ( Array.isArray( url ) ) {\n\n\t\t\t\t\t// load array of images e.g CubeTexture\n\n\t\t\t\t\timages[ image.uuid ] = [];\n\n\t\t\t\t\tfor ( let j = 0, jl = url.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tconst currentUrl = url[ j ];\n\n\t\t\t\t\t\tconst deserializedImage = await deserializeImage( currentUrl );\n\n\t\t\t\t\t\tif ( deserializedImage !== null ) {\n\n\t\t\t\t\t\t\tif ( deserializedImage instanceof HTMLImageElement ) {\n\n\t\t\t\t\t\t\t\timages[ image.uuid ].push( deserializedImage );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t// special case: handle array of data textures for cube textures\n\n\t\t\t\t\t\t\t\timages[ image.uuid ].push( new DataTexture( deserializedImage.data, deserializedImage.width, deserializedImage.height ) );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// load single image\n\n\t\t\t\t\tconst deserializedImage = await deserializeImage( image.url );\n\n\t\t\t\t\tif ( deserializedImage !== null ) {\n\n\t\t\t\t\t\timages[ image.uuid ] = deserializedImage;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\tparseTextures( json, images ) {\n\n\t\tfunction parseConstant( value, type ) {\n\n\t\t\tif ( typeof value === 'number' ) return value;\n\n\t\t\tconsole.warn( 'THREE.ObjectLoader.parseTexture: Constant should be in numeric form.', value );\n\n\t\t\treturn type[ value ];\n\n\t\t}\n\n\t\tconst textures = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tif ( data.image === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No \"image\" specified for', data.uuid );\n\n\t\t\t\t}\n\n\t\t\t\tif ( images[ data.image ] === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined image', data.image );\n\n\t\t\t\t}\n\n\t\t\t\tlet texture;\n\t\t\t\tconst image = images[ data.image ];\n\n\t\t\t\tif ( Array.isArray( image ) ) {\n\n\t\t\t\t\ttexture = new CubeTexture( image );\n\n\t\t\t\t\tif ( image.length === 6 ) texture.needsUpdate = true;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( image && image.data ) {\n\n\t\t\t\t\t\ttexture = new DataTexture( image.data, image.width, image.height );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttexture = new Texture( image );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( image ) texture.needsUpdate = true; // textures can have undefined image data\n\n\t\t\t\t}\n\n\t\t\t\ttexture.uuid = data.uuid;\n\n\t\t\t\tif ( data.name !== undefined ) texture.name = data.name;\n\n\t\t\t\tif ( data.mapping !== undefined ) texture.mapping = parseConstant( data.mapping, TEXTURE_MAPPING );\n\n\t\t\t\tif ( data.offset !== undefined ) texture.offset.fromArray( data.offset );\n\t\t\t\tif ( data.repeat !== undefined ) texture.repeat.fromArray( data.repeat );\n\t\t\t\tif ( data.center !== undefined ) texture.center.fromArray( data.center );\n\t\t\t\tif ( data.rotation !== undefined ) texture.rotation = data.rotation;\n\n\t\t\t\tif ( data.wrap !== undefined ) {\n\n\t\t\t\t\ttexture.wrapS = parseConstant( data.wrap[ 0 ], TEXTURE_WRAPPING );\n\t\t\t\t\ttexture.wrapT = parseConstant( data.wrap[ 1 ], TEXTURE_WRAPPING );\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.format !== undefined ) texture.format = data.format;\n\t\t\t\tif ( data.type !== undefined ) texture.type = data.type;\n\t\t\t\tif ( data.encoding !== undefined ) texture.encoding = data.encoding;\n\n\t\t\t\tif ( data.minFilter !== undefined ) texture.minFilter = parseConstant( data.minFilter, TEXTURE_FILTER );\n\t\t\t\tif ( data.magFilter !== undefined ) texture.magFilter = parseConstant( data.magFilter, TEXTURE_FILTER );\n\t\t\t\tif ( data.anisotropy !== undefined ) texture.anisotropy = data.anisotropy;\n\n\t\t\t\tif ( data.flipY !== undefined ) texture.flipY = data.flipY;\n\n\t\t\t\tif ( data.premultiplyAlpha !== undefined ) texture.premultiplyAlpha = data.premultiplyAlpha;\n\t\t\t\tif ( data.unpackAlignment !== undefined ) texture.unpackAlignment = data.unpackAlignment;\n\n\t\t\t\tif ( data.userData !== undefined ) texture.userData = data.userData;\n\n\t\t\t\ttextures[ data.uuid ] = texture;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn textures;\n\n\t}\n\n\tparseObject( data, geometries, materials, textures, animations ) {\n\n\t\tlet object;\n\n\t\tfunction getGeometry( name ) {\n\n\t\t\tif ( geometries[ name ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined geometry', name );\n\n\t\t\t}\n\n\t\t\treturn geometries[ name ];\n\n\t\t}\n\n\t\tfunction getMaterial( name ) {\n\n\t\t\tif ( name === undefined ) return undefined;\n\n\t\t\tif ( Array.isArray( name ) ) {\n\n\t\t\t\tconst array = [];\n\n\t\t\t\tfor ( let i = 0, l = name.length; i < l; i ++ ) {\n\n\t\t\t\t\tconst uuid = name[ i ];\n\n\t\t\t\t\tif ( materials[ uuid ] === undefined ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', uuid );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tarray.push( materials[ uuid ] );\n\n\t\t\t\t}\n\n\t\t\t\treturn array;\n\n\t\t\t}\n\n\t\t\tif ( materials[ name ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', name );\n\n\t\t\t}\n\n\t\t\treturn materials[ name ];\n\n\t\t}\n\n\t\tfunction getTexture( uuid ) {\n\n\t\t\tif ( textures[ uuid ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined texture', uuid );\n\n\t\t\t}\n\n\t\t\treturn textures[ uuid ];\n\n\t\t}\n\n\t\tlet geometry, material;\n\n\t\tswitch ( data.type ) {\n\n\t\t\tcase 'Scene':\n\n\t\t\t\tobject = new Scene();\n\n\t\t\t\tif ( data.background !== undefined ) {\n\n\t\t\t\t\tif ( Number.isInteger( data.background ) ) {\n\n\t\t\t\t\t\tobject.background = new Color( data.background );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tobject.background = getTexture( data.background );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.environment !== undefined ) {\n\n\t\t\t\t\tobject.environment = getTexture( data.environment );\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.fog !== undefined ) {\n\n\t\t\t\t\tif ( data.fog.type === 'Fog' ) {\n\n\t\t\t\t\t\tobject.fog = new Fog( data.fog.color, data.fog.near, data.fog.far );\n\n\t\t\t\t\t} else if ( data.fog.type === 'FogExp2' ) {\n\n\t\t\t\t\t\tobject.fog = new FogExp2( data.fog.color, data.fog.density );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'PerspectiveCamera':\n\n\t\t\t\tobject = new PerspectiveCamera( data.fov, data.aspect, data.near, data.far );\n\n\t\t\t\tif ( data.focus !== undefined ) object.focus = data.focus;\n\t\t\t\tif ( data.zoom !== undefined ) object.zoom = data.zoom;\n\t\t\t\tif ( data.filmGauge !== undefined ) object.filmGauge = data.filmGauge;\n\t\t\t\tif ( data.filmOffset !== undefined ) object.filmOffset = data.filmOffset;\n\t\t\t\tif ( data.view !== undefined ) object.view = Object.assign( {}, data.view );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'OrthographicCamera':\n\n\t\t\t\tobject = new OrthographicCamera( data.left, data.right, data.top, data.bottom, data.near, data.far );\n\n\t\t\t\tif ( data.zoom !== undefined ) object.zoom = data.zoom;\n\t\t\t\tif ( data.view !== undefined ) object.view = Object.assign( {}, data.view );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'AmbientLight':\n\n\t\t\t\tobject = new AmbientLight( data.color, data.intensity );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'DirectionalLight':\n\n\t\t\t\tobject = new DirectionalLight( data.color, data.intensity );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'PointLight':\n\n\t\t\t\tobject = new PointLight( data.color, data.intensity, data.distance, data.decay );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'RectAreaLight':\n\n\t\t\t\tobject = new RectAreaLight( data.color, data.intensity, data.width, data.height );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'SpotLight':\n\n\t\t\t\tobject = new SpotLight( data.color, data.intensity, data.distance, data.angle, data.penumbra, data.decay );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'HemisphereLight':\n\n\t\t\t\tobject = new HemisphereLight( data.color, data.groundColor, data.intensity );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LightProbe':\n\n\t\t\t\tobject = new LightProbe().fromJSON( data );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'SkinnedMesh':\n\n\t\t\t\tgeometry = getGeometry( data.geometry );\n\t\t\t \tmaterial = getMaterial( data.material );\n\n\t\t\t\tobject = new SkinnedMesh( geometry, material );\n\n\t\t\t\tif ( data.bindMode !== undefined ) object.bindMode = data.bindMode;\n\t\t\t\tif ( data.bindMatrix !== undefined ) object.bindMatrix.fromArray( data.bindMatrix );\n\t\t\t\tif ( data.skeleton !== undefined ) object.skeleton = data.skeleton;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Mesh':\n\n\t\t\t\tgeometry = getGeometry( data.geometry );\n\t\t\t\tmaterial = getMaterial( data.material );\n\n\t\t\t\tobject = new Mesh( geometry, material );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'InstancedMesh':\n\n\t\t\t\tgeometry = getGeometry( data.geometry );\n\t\t\t\tmaterial = getMaterial( data.material );\n\t\t\t\tconst count = data.count;\n\t\t\t\tconst instanceMatrix = data.instanceMatrix;\n\t\t\t\tconst instanceColor = data.instanceColor;\n\n\t\t\t\tobject = new InstancedMesh( geometry, material, count );\n\t\t\t\tobject.instanceMatrix = new InstancedBufferAttribute( new Float32Array( instanceMatrix.array ), 16 );\n\t\t\t\tif ( instanceColor !== undefined ) object.instanceColor = new InstancedBufferAttribute( new Float32Array( instanceColor.array ), instanceColor.itemSize );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LOD':\n\n\t\t\t\tobject = new LOD();\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Line':\n\n\t\t\t\tobject = new Line( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LineLoop':\n\n\t\t\t\tobject = new LineLoop( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LineSegments':\n\n\t\t\t\tobject = new LineSegments( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'PointCloud':\n\t\t\tcase 'Points':\n\n\t\t\t\tobject = new Points( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Sprite':\n\n\t\t\t\tobject = new Sprite( getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Group':\n\n\t\t\t\tobject = new Group();\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Bone':\n\n\t\t\t\tobject = new Bone();\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tobject = new Object3D();\n\n\t\t}\n\n\t\tobject.uuid = data.uuid;\n\n\t\tif ( data.name !== undefined ) object.name = data.name;\n\n\t\tif ( data.matrix !== undefined ) {\n\n\t\t\tobject.matrix.fromArray( data.matrix );\n\n\t\t\tif ( data.matrixAutoUpdate !== undefined ) object.matrixAutoUpdate = data.matrixAutoUpdate;\n\t\t\tif ( object.matrixAutoUpdate ) object.matrix.decompose( object.position, object.quaternion, object.scale );\n\n\t\t} else {\n\n\t\t\tif ( data.position !== undefined ) object.position.fromArray( data.position );\n\t\t\tif ( data.rotation !== undefined ) object.rotation.fromArray( data.rotation );\n\t\t\tif ( data.quaternion !== undefined ) object.quaternion.fromArray( data.quaternion );\n\t\t\tif ( data.scale !== undefined ) object.scale.fromArray( data.scale );\n\n\t\t}\n\n\t\tif ( data.castShadow !== undefined ) object.castShadow = data.castShadow;\n\t\tif ( data.receiveShadow !== undefined ) object.receiveShadow = data.receiveShadow;\n\n\t\tif ( data.shadow ) {\n\n\t\t\tif ( data.shadow.bias !== undefined ) object.shadow.bias = data.shadow.bias;\n\t\t\tif ( data.shadow.normalBias !== undefined ) object.shadow.normalBias = data.shadow.normalBias;\n\t\t\tif ( data.shadow.radius !== undefined ) object.shadow.radius = data.shadow.radius;\n\t\t\tif ( data.shadow.mapSize !== undefined ) object.shadow.mapSize.fromArray( data.shadow.mapSize );\n\t\t\tif ( data.shadow.camera !== undefined ) object.shadow.camera = this.parseObject( data.shadow.camera );\n\n\t\t}\n\n\t\tif ( data.visible !== undefined ) object.visible = data.visible;\n\t\tif ( data.frustumCulled !== undefined ) object.frustumCulled = data.frustumCulled;\n\t\tif ( data.renderOrder !== undefined ) object.renderOrder = data.renderOrder;\n\t\tif ( data.userData !== undefined ) object.userData = data.userData;\n\t\tif ( data.layers !== undefined ) object.layers.mask = data.layers;\n\n\t\tif ( data.children !== undefined ) {\n\n\t\t\tconst children = data.children;\n\n\t\t\tfor ( let i = 0; i < children.length; i ++ ) {\n\n\t\t\t\tobject.add( this.parseObject( children[ i ], geometries, materials, textures, animations ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( data.animations !== undefined ) {\n\n\t\t\tconst objectAnimations = data.animations;\n\n\t\t\tfor ( let i = 0; i < objectAnimations.length; i ++ ) {\n\n\t\t\t\tconst uuid = objectAnimations[ i ];\n\n\t\t\t\tobject.animations.push( animations[ uuid ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( data.type === 'LOD' ) {\n\n\t\t\tif ( data.autoUpdate !== undefined ) object.autoUpdate = data.autoUpdate;\n\n\t\t\tconst levels = data.levels;\n\n\t\t\tfor ( let l = 0; l < levels.length; l ++ ) {\n\n\t\t\t\tconst level = levels[ l ];\n\t\t\t\tconst child = object.getObjectByProperty( 'uuid', level.object );\n\n\t\t\t\tif ( child !== undefined ) {\n\n\t\t\t\t\tobject.addLevel( child, level.distance );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn object;\n\n\t}\n\n\tbindSkeletons( object, skeletons ) {\n\n\t\tif ( Object.keys( skeletons ).length === 0 ) return;\n\n\t\tobject.traverse( function ( child ) {\n\n\t\t\tif ( child.isSkinnedMesh === true && child.skeleton !== undefined ) {\n\n\t\t\t\tconst skeleton = skeletons[ child.skeleton ];\n\n\t\t\t\tif ( skeleton === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No skeleton found with UUID:', child.skeleton );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tchild.bind( skeleton, child.bindMatrix );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\t/* DEPRECATED */\n\n\tsetTexturePath( value ) {\n\n\t\tconsole.warn( 'THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath().' );\n\t\treturn this.setResourcePath( value );\n\n\t}\n\n}\n\nconst TEXTURE_MAPPING = {\n\tUVMapping: UVMapping,\n\tCubeReflectionMapping: CubeReflectionMapping,\n\tCubeRefractionMapping: CubeRefractionMapping,\n\tEquirectangularReflectionMapping: EquirectangularReflectionMapping,\n\tEquirectangularRefractionMapping: EquirectangularRefractionMapping,\n\tCubeUVReflectionMapping: CubeUVReflectionMapping,\n\tCubeUVRefractionMapping: CubeUVRefractionMapping\n};\n\nconst TEXTURE_WRAPPING = {\n\tRepeatWrapping: RepeatWrapping,\n\tClampToEdgeWrapping: ClampToEdgeWrapping,\n\tMirroredRepeatWrapping: MirroredRepeatWrapping\n};\n\nconst TEXTURE_FILTER = {\n\tNearestFilter: NearestFilter,\n\tNearestMipmapNearestFilter: NearestMipmapNearestFilter,\n\tNearestMipmapLinearFilter: NearestMipmapLinearFilter,\n\tLinearFilter: LinearFilter,\n\tLinearMipmapNearestFilter: LinearMipmapNearestFilter,\n\tLinearMipmapLinearFilter: LinearMipmapLinearFilter\n};\n\nclass ImageBitmapLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tif ( typeof createImageBitmap === 'undefined' ) {\n\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: createImageBitmap() not supported.' );\n\n\t\t}\n\n\t\tif ( typeof fetch === 'undefined' ) {\n\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: fetch() not supported.' );\n\n\t\t}\n\n\t\tthis.options = { premultiplyAlpha: 'none' };\n\n\t}\n\n\tsetOptions( options ) {\n\n\t\tthis.options = options;\n\n\t\treturn this;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tconst fetchOptions = {};\n\t\tfetchOptions.credentials = ( this.crossOrigin === 'anonymous' ) ? 'same-origin' : 'include';\n\t\tfetchOptions.headers = this.requestHeader;\n\n\t\tfetch( url, fetchOptions ).then( function ( res ) {\n\n\t\t\treturn res.blob();\n\n\t\t} ).then( function ( blob ) {\n\n\t\t\treturn createImageBitmap( blob, Object.assign( scope.options, { colorSpaceConversion: 'none' } ) );\n\n\t\t} ).then( function ( imageBitmap ) {\n\n\t\t\tCache.add( url, imageBitmap );\n\n\t\t\tif ( onLoad ) onLoad( imageBitmap );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t} ).catch( function ( e ) {\n\n\t\t\tif ( onError ) onError( e );\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t} );\n\n\t\tscope.manager.itemStart( url );\n\n\t}\n\n}\n\nImageBitmapLoader.prototype.isImageBitmapLoader = true;\n\nlet _context;\n\nconst AudioContext = {\n\n\tgetContext: function () {\n\n\t\tif ( _context === undefined ) {\n\n\t\t\t_context = new ( window.AudioContext || window.webkitAudioContext )();\n\n\t\t}\n\n\t\treturn _context;\n\n\t},\n\n\tsetContext: function ( value ) {\n\n\t\t_context = value;\n\n\t}\n\n};\n\nclass AudioLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\ttry {\n\n\t\t\t\t// Create a copy of the buffer. The `decodeAudioData` method\n\t\t\t\t// detaches the buffer when complete, preventing reuse.\n\t\t\t\tconst bufferCopy = buffer.slice( 0 );\n\n\t\t\t\tconst context = AudioContext.getContext();\n\t\t\t\tcontext.decodeAudioData( bufferCopy, function ( audioBuffer ) {\n\n\t\t\t\t\tonLoad( audioBuffer );\n\n\t\t\t\t} );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n}\n\nclass HemisphereLightProbe extends LightProbe {\n\n\tconstructor( skyColor, groundColor, intensity = 1 ) {\n\n\t\tsuper( undefined, intensity );\n\n\t\tconst color1 = new Color().set( skyColor );\n\t\tconst color2 = new Color().set( groundColor );\n\n\t\tconst sky = new Vector3( color1.r, color1.g, color1.b );\n\t\tconst ground = new Vector3( color2.r, color2.g, color2.b );\n\n\t\t// without extra factor of PI in the shader, should = 1 / Math.sqrt( Math.PI );\n\t\tconst c0 = Math.sqrt( Math.PI );\n\t\tconst c1 = c0 * Math.sqrt( 0.75 );\n\n\t\tthis.sh.coefficients[ 0 ].copy( sky ).add( ground ).multiplyScalar( c0 );\n\t\tthis.sh.coefficients[ 1 ].copy( sky ).sub( ground ).multiplyScalar( c1 );\n\n\t}\n\n}\n\nHemisphereLightProbe.prototype.isHemisphereLightProbe = true;\n\nclass AmbientLightProbe extends LightProbe {\n\n\tconstructor( color, intensity = 1 ) {\n\n\t\tsuper( undefined, intensity );\n\n\t\tconst color1 = new Color().set( color );\n\n\t\t// without extra factor of PI in the shader, would be 2 / Math.sqrt( Math.PI );\n\t\tthis.sh.coefficients[ 0 ].set( color1.r, color1.g, color1.b ).multiplyScalar( 2 * Math.sqrt( Math.PI ) );\n\n\t}\n\n}\n\nAmbientLightProbe.prototype.isAmbientLightProbe = true;\n\nconst _eyeRight = /*@__PURE__*/ new Matrix4();\nconst _eyeLeft = /*@__PURE__*/ new Matrix4();\nconst _projectionMatrix = /*@__PURE__*/ new Matrix4();\n\nclass StereoCamera {\n\n\tconstructor() {\n\n\t\tthis.type = 'StereoCamera';\n\n\t\tthis.aspect = 1;\n\n\t\tthis.eyeSep = 0.064;\n\n\t\tthis.cameraL = new PerspectiveCamera();\n\t\tthis.cameraL.layers.enable( 1 );\n\t\tthis.cameraL.matrixAutoUpdate = false;\n\n\t\tthis.cameraR = new PerspectiveCamera();\n\t\tthis.cameraR.layers.enable( 2 );\n\t\tthis.cameraR.matrixAutoUpdate = false;\n\n\t\tthis._cache = {\n\t\t\tfocus: null,\n\t\t\tfov: null,\n\t\t\taspect: null,\n\t\t\tnear: null,\n\t\t\tfar: null,\n\t\t\tzoom: null,\n\t\t\teyeSep: null\n\t\t};\n\n\t}\n\n\tupdate( camera ) {\n\n\t\tconst cache = this._cache;\n\n\t\tconst needsUpdate = cache.focus !== camera.focus || cache.fov !== camera.fov ||\n\t\t\tcache.aspect !== camera.aspect * this.aspect || cache.near !== camera.near ||\n\t\t\tcache.far !== camera.far || cache.zoom !== camera.zoom || cache.eyeSep !== this.eyeSep;\n\n\t\tif ( needsUpdate ) {\n\n\t\t\tcache.focus = camera.focus;\n\t\t\tcache.fov = camera.fov;\n\t\t\tcache.aspect = camera.aspect * this.aspect;\n\t\t\tcache.near = camera.near;\n\t\t\tcache.far = camera.far;\n\t\t\tcache.zoom = camera.zoom;\n\t\t\tcache.eyeSep = this.eyeSep;\n\n\t\t\t// Off-axis stereoscopic effect based on\n\t\t\t// http://paulbourke.net/stereographics/stereorender/\n\n\t\t\t_projectionMatrix.copy( camera.projectionMatrix );\n\t\t\tconst eyeSepHalf = cache.eyeSep / 2;\n\t\t\tconst eyeSepOnProjection = eyeSepHalf * cache.near / cache.focus;\n\t\t\tconst ymax = ( cache.near * Math.tan( DEG2RAD * cache.fov * 0.5 ) ) / cache.zoom;\n\t\t\tlet xmin, xmax;\n\n\t\t\t// translate xOffset\n\n\t\t\t_eyeLeft.elements[ 12 ] = - eyeSepHalf;\n\t\t\t_eyeRight.elements[ 12 ] = eyeSepHalf;\n\n\t\t\t// for left eye\n\n\t\t\txmin = - ymax * cache.aspect + eyeSepOnProjection;\n\t\t\txmax = ymax * cache.aspect + eyeSepOnProjection;\n\n\t\t\t_projectionMatrix.elements[ 0 ] = 2 * cache.near / ( xmax - xmin );\n\t\t\t_projectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\n\n\t\t\tthis.cameraL.projectionMatrix.copy( _projectionMatrix );\n\n\t\t\t// for right eye\n\n\t\t\txmin = - ymax * cache.aspect - eyeSepOnProjection;\n\t\t\txmax = ymax * cache.aspect - eyeSepOnProjection;\n\n\t\t\t_projectionMatrix.elements[ 0 ] = 2 * cache.near / ( xmax - xmin );\n\t\t\t_projectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\n\n\t\t\tthis.cameraR.projectionMatrix.copy( _projectionMatrix );\n\n\t\t}\n\n\t\tthis.cameraL.matrixWorld.copy( camera.matrixWorld ).multiply( _eyeLeft );\n\t\tthis.cameraR.matrixWorld.copy( camera.matrixWorld ).multiply( _eyeRight );\n\n\t}\n\n}\n\nclass Clock {\n\n\tconstructor( autoStart = true ) {\n\n\t\tthis.autoStart = autoStart;\n\n\t\tthis.startTime = 0;\n\t\tthis.oldTime = 0;\n\t\tthis.elapsedTime = 0;\n\n\t\tthis.running = false;\n\n\t}\n\n\tstart() {\n\n\t\tthis.startTime = now();\n\n\t\tthis.oldTime = this.startTime;\n\t\tthis.elapsedTime = 0;\n\t\tthis.running = true;\n\n\t}\n\n\tstop() {\n\n\t\tthis.getElapsedTime();\n\t\tthis.running = false;\n\t\tthis.autoStart = false;\n\n\t}\n\n\tgetElapsedTime() {\n\n\t\tthis.getDelta();\n\t\treturn this.elapsedTime;\n\n\t}\n\n\tgetDelta() {\n\n\t\tlet diff = 0;\n\n\t\tif ( this.autoStart && ! this.running ) {\n\n\t\t\tthis.start();\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tif ( this.running ) {\n\n\t\t\tconst newTime = now();\n\n\t\t\tdiff = ( newTime - this.oldTime ) / 1000;\n\t\t\tthis.oldTime = newTime;\n\n\t\t\tthis.elapsedTime += diff;\n\n\t\t}\n\n\t\treturn diff;\n\n\t}\n\n}\n\nfunction now() {\n\n\treturn ( typeof performance === 'undefined' ? Date : performance ).now(); // see #10732\n\n}\n\nconst _position$1 = /*@__PURE__*/ new Vector3();\nconst _quaternion$1 = /*@__PURE__*/ new Quaternion();\nconst _scale$1 = /*@__PURE__*/ new Vector3();\nconst _orientation$1 = /*@__PURE__*/ new Vector3();\n\nclass AudioListener extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'AudioListener';\n\n\t\tthis.context = AudioContext.getContext();\n\n\t\tthis.gain = this.context.createGain();\n\t\tthis.gain.connect( this.context.destination );\n\n\t\tthis.filter = null;\n\n\t\tthis.timeDelta = 0;\n\n\t\t// private\n\n\t\tthis._clock = new Clock();\n\n\t}\n\n\tgetInput() {\n\n\t\treturn this.gain;\n\n\t}\n\n\tremoveFilter() {\n\n\t\tif ( this.filter !== null ) {\n\n\t\t\tthis.gain.disconnect( this.filter );\n\t\t\tthis.filter.disconnect( this.context.destination );\n\t\t\tthis.gain.connect( this.context.destination );\n\t\t\tthis.filter = null;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetFilter() {\n\n\t\treturn this.filter;\n\n\t}\n\n\tsetFilter( value ) {\n\n\t\tif ( this.filter !== null ) {\n\n\t\t\tthis.gain.disconnect( this.filter );\n\t\t\tthis.filter.disconnect( this.context.destination );\n\n\t\t} else {\n\n\t\t\tthis.gain.disconnect( this.context.destination );\n\n\t\t}\n\n\t\tthis.filter = value;\n\t\tthis.gain.connect( this.filter );\n\t\tthis.filter.connect( this.context.destination );\n\n\t\treturn this;\n\n\t}\n\n\tgetMasterVolume() {\n\n\t\treturn this.gain.gain.value;\n\n\t}\n\n\tsetMasterVolume( value ) {\n\n\t\tthis.gain.gain.setTargetAtTime( value, this.context.currentTime, 0.01 );\n\n\t\treturn this;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tconst listener = this.context.listener;\n\t\tconst up = this.up;\n\n\t\tthis.timeDelta = this._clock.getDelta();\n\n\t\tthis.matrixWorld.decompose( _position$1, _quaternion$1, _scale$1 );\n\n\t\t_orientation$1.set( 0, 0, - 1 ).applyQuaternion( _quaternion$1 );\n\n\t\tif ( listener.positionX ) {\n\n\t\t\t// code path for Chrome (see #14393)\n\n\t\t\tconst endTime = this.context.currentTime + this.timeDelta;\n\n\t\t\tlistener.positionX.linearRampToValueAtTime( _position$1.x, endTime );\n\t\t\tlistener.positionY.linearRampToValueAtTime( _position$1.y, endTime );\n\t\t\tlistener.positionZ.linearRampToValueAtTime( _position$1.z, endTime );\n\t\t\tlistener.forwardX.linearRampToValueAtTime( _orientation$1.x, endTime );\n\t\t\tlistener.forwardY.linearRampToValueAtTime( _orientation$1.y, endTime );\n\t\t\tlistener.forwardZ.linearRampToValueAtTime( _orientation$1.z, endTime );\n\t\t\tlistener.upX.linearRampToValueAtTime( up.x, endTime );\n\t\t\tlistener.upY.linearRampToValueAtTime( up.y, endTime );\n\t\t\tlistener.upZ.linearRampToValueAtTime( up.z, endTime );\n\n\t\t} else {\n\n\t\t\tlistener.setPosition( _position$1.x, _position$1.y, _position$1.z );\n\t\t\tlistener.setOrientation( _orientation$1.x, _orientation$1.y, _orientation$1.z, up.x, up.y, up.z );\n\n\t\t}\n\n\t}\n\n}\n\nclass Audio extends Object3D {\n\n\tconstructor( listener ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Audio';\n\n\t\tthis.listener = listener;\n\t\tthis.context = listener.context;\n\n\t\tthis.gain = this.context.createGain();\n\t\tthis.gain.connect( listener.getInput() );\n\n\t\tthis.autoplay = false;\n\n\t\tthis.buffer = null;\n\t\tthis.detune = 0;\n\t\tthis.loop = false;\n\t\tthis.loopStart = 0;\n\t\tthis.loopEnd = 0;\n\t\tthis.offset = 0;\n\t\tthis.duration = undefined;\n\t\tthis.playbackRate = 1;\n\t\tthis.isPlaying = false;\n\t\tthis.hasPlaybackControl = true;\n\t\tthis.source = null;\n\t\tthis.sourceType = 'empty';\n\n\t\tthis._startedAt = 0;\n\t\tthis._progress = 0;\n\t\tthis._connected = false;\n\n\t\tthis.filters = [];\n\n\t}\n\n\tgetOutput() {\n\n\t\treturn this.gain;\n\n\t}\n\n\tsetNodeSource( audioNode ) {\n\n\t\tthis.hasPlaybackControl = false;\n\t\tthis.sourceType = 'audioNode';\n\t\tthis.source = audioNode;\n\t\tthis.connect();\n\n\t\treturn this;\n\n\t}\n\n\tsetMediaElementSource( mediaElement ) {\n\n\t\tthis.hasPlaybackControl = false;\n\t\tthis.sourceType = 'mediaNode';\n\t\tthis.source = this.context.createMediaElementSource( mediaElement );\n\t\tthis.connect();\n\n\t\treturn this;\n\n\t}\n\n\tsetMediaStreamSource( mediaStream ) {\n\n\t\tthis.hasPlaybackControl = false;\n\t\tthis.sourceType = 'mediaStreamNode';\n\t\tthis.source = this.context.createMediaStreamSource( mediaStream );\n\t\tthis.connect();\n\n\t\treturn this;\n\n\t}\n\n\tsetBuffer( audioBuffer ) {\n\n\t\tthis.buffer = audioBuffer;\n\t\tthis.sourceType = 'buffer';\n\n\t\tif ( this.autoplay ) this.play();\n\n\t\treturn this;\n\n\t}\n\n\tplay( delay = 0 ) {\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: Audio is already playing.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._startedAt = this.context.currentTime + delay;\n\n\t\tconst source = this.context.createBufferSource();\n\t\tsource.buffer = this.buffer;\n\t\tsource.loop = this.loop;\n\t\tsource.loopStart = this.loopStart;\n\t\tsource.loopEnd = this.loopEnd;\n\t\tsource.onended = this.onEnded.bind( this );\n\t\tsource.start( this._startedAt, this._progress + this.offset, this.duration );\n\n\t\tthis.isPlaying = true;\n\n\t\tthis.source = source;\n\n\t\tthis.setDetune( this.detune );\n\t\tthis.setPlaybackRate( this.playbackRate );\n\n\t\treturn this.connect();\n\n\t}\n\n\tpause() {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\t// update current progress\n\n\t\t\tthis._progress += Math.max( this.context.currentTime - this._startedAt, 0 ) * this.playbackRate;\n\n\t\t\tif ( this.loop === true ) {\n\n\t\t\t\t// ensure _progress does not exceed duration with looped audios\n\n\t\t\t\tthis._progress = this._progress % ( this.duration || this.buffer.duration );\n\n\t\t\t}\n\n\t\t\tthis.source.stop();\n\t\t\tthis.source.onended = null;\n\n\t\t\tthis.isPlaying = false;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tstop() {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._progress = 0;\n\n\t\tthis.source.stop();\n\t\tthis.source.onended = null;\n\t\tthis.isPlaying = false;\n\n\t\treturn this;\n\n\t}\n\n\tconnect() {\n\n\t\tif ( this.filters.length > 0 ) {\n\n\t\t\tthis.source.connect( this.filters[ 0 ] );\n\n\t\t\tfor ( let i = 1, l = this.filters.length; i < l; i ++ ) {\n\n\t\t\t\tthis.filters[ i - 1 ].connect( this.filters[ i ] );\n\n\t\t\t}\n\n\t\t\tthis.filters[ this.filters.length - 1 ].connect( this.getOutput() );\n\n\t\t} else {\n\n\t\t\tthis.source.connect( this.getOutput() );\n\n\t\t}\n\n\t\tthis._connected = true;\n\n\t\treturn this;\n\n\t}\n\n\tdisconnect() {\n\n\t\tif ( this.filters.length > 0 ) {\n\n\t\t\tthis.source.disconnect( this.filters[ 0 ] );\n\n\t\t\tfor ( let i = 1, l = this.filters.length; i < l; i ++ ) {\n\n\t\t\t\tthis.filters[ i - 1 ].disconnect( this.filters[ i ] );\n\n\t\t\t}\n\n\t\t\tthis.filters[ this.filters.length - 1 ].disconnect( this.getOutput() );\n\n\t\t} else {\n\n\t\t\tthis.source.disconnect( this.getOutput() );\n\n\t\t}\n\n\t\tthis._connected = false;\n\n\t\treturn this;\n\n\t}\n\n\tgetFilters() {\n\n\t\treturn this.filters;\n\n\t}\n\n\tsetFilters( value ) {\n\n\t\tif ( ! value ) value = [];\n\n\t\tif ( this._connected === true ) {\n\n\t\t\tthis.disconnect();\n\t\t\tthis.filters = value.slice();\n\t\t\tthis.connect();\n\n\t\t} else {\n\n\t\t\tthis.filters = value.slice();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetDetune( value ) {\n\n\t\tthis.detune = value;\n\n\t\tif ( this.source.detune === undefined ) return; // only set detune when available\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\tthis.source.detune.setTargetAtTime( this.detune, this.context.currentTime, 0.01 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetDetune() {\n\n\t\treturn this.detune;\n\n\t}\n\n\tgetFilter() {\n\n\t\treturn this.getFilters()[ 0 ];\n\n\t}\n\n\tsetFilter( filter ) {\n\n\t\treturn this.setFilters( filter ? [ filter ] : [] );\n\n\t}\n\n\tsetPlaybackRate( value ) {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.playbackRate = value;\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\tthis.source.playbackRate.setTargetAtTime( this.playbackRate, this.context.currentTime, 0.01 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetPlaybackRate() {\n\n\t\treturn this.playbackRate;\n\n\t}\n\n\tonEnded() {\n\n\t\tthis.isPlaying = false;\n\n\t}\n\n\tgetLoop() {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn false;\n\n\t\t}\n\n\t\treturn this.loop;\n\n\t}\n\n\tsetLoop( value ) {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.loop = value;\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\tthis.source.loop = this.loop;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetLoopStart( value ) {\n\n\t\tthis.loopStart = value;\n\n\t\treturn this;\n\n\t}\n\n\tsetLoopEnd( value ) {\n\n\t\tthis.loopEnd = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetVolume() {\n\n\t\treturn this.gain.gain.value;\n\n\t}\n\n\tsetVolume( value ) {\n\n\t\tthis.gain.gain.setTargetAtTime( value, this.context.currentTime, 0.01 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _position = /*@__PURE__*/ new Vector3();\nconst _quaternion = /*@__PURE__*/ new Quaternion();\nconst _scale = /*@__PURE__*/ new Vector3();\nconst _orientation = /*@__PURE__*/ new Vector3();\n\nclass PositionalAudio extends Audio {\n\n\tconstructor( listener ) {\n\n\t\tsuper( listener );\n\n\t\tthis.panner = this.context.createPanner();\n\t\tthis.panner.panningModel = 'HRTF';\n\t\tthis.panner.connect( this.gain );\n\n\t}\n\n\tgetOutput() {\n\n\t\treturn this.panner;\n\n\t}\n\n\tgetRefDistance() {\n\n\t\treturn this.panner.refDistance;\n\n\t}\n\n\tsetRefDistance( value ) {\n\n\t\tthis.panner.refDistance = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetRolloffFactor() {\n\n\t\treturn this.panner.rolloffFactor;\n\n\t}\n\n\tsetRolloffFactor( value ) {\n\n\t\tthis.panner.rolloffFactor = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetDistanceModel() {\n\n\t\treturn this.panner.distanceModel;\n\n\t}\n\n\tsetDistanceModel( value ) {\n\n\t\tthis.panner.distanceModel = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetMaxDistance() {\n\n\t\treturn this.panner.maxDistance;\n\n\t}\n\n\tsetMaxDistance( value ) {\n\n\t\tthis.panner.maxDistance = value;\n\n\t\treturn this;\n\n\t}\n\n\tsetDirectionalCone( coneInnerAngle, coneOuterAngle, coneOuterGain ) {\n\n\t\tthis.panner.coneInnerAngle = coneInnerAngle;\n\t\tthis.panner.coneOuterAngle = coneOuterAngle;\n\t\tthis.panner.coneOuterGain = coneOuterGain;\n\n\t\treturn this;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tif ( this.hasPlaybackControl === true && this.isPlaying === false ) return;\n\n\t\tthis.matrixWorld.decompose( _position, _quaternion, _scale );\n\n\t\t_orientation.set( 0, 0, 1 ).applyQuaternion( _quaternion );\n\n\t\tconst panner = this.panner;\n\n\t\tif ( panner.positionX ) {\n\n\t\t\t// code path for Chrome and Firefox (see #14393)\n\n\t\t\tconst endTime = this.context.currentTime + this.listener.timeDelta;\n\n\t\t\tpanner.positionX.linearRampToValueAtTime( _position.x, endTime );\n\t\t\tpanner.positionY.linearRampToValueAtTime( _position.y, endTime );\n\t\t\tpanner.positionZ.linearRampToValueAtTime( _position.z, endTime );\n\t\t\tpanner.orientationX.linearRampToValueAtTime( _orientation.x, endTime );\n\t\t\tpanner.orientationY.linearRampToValueAtTime( _orientation.y, endTime );\n\t\t\tpanner.orientationZ.linearRampToValueAtTime( _orientation.z, endTime );\n\n\t\t} else {\n\n\t\t\tpanner.setPosition( _position.x, _position.y, _position.z );\n\t\t\tpanner.setOrientation( _orientation.x, _orientation.y, _orientation.z );\n\n\t\t}\n\n\t}\n\n}\n\nclass AudioAnalyser {\n\n\tconstructor( audio, fftSize = 2048 ) {\n\n\t\tthis.analyser = audio.context.createAnalyser();\n\t\tthis.analyser.fftSize = fftSize;\n\n\t\tthis.data = new Uint8Array( this.analyser.frequencyBinCount );\n\n\t\taudio.getOutput().connect( this.analyser );\n\n\t}\n\n\n\tgetFrequencyData() {\n\n\t\tthis.analyser.getByteFrequencyData( this.data );\n\n\t\treturn this.data;\n\n\t}\n\n\tgetAverageFrequency() {\n\n\t\tlet value = 0;\n\t\tconst data = this.getFrequencyData();\n\n\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\tvalue += data[ i ];\n\n\t\t}\n\n\t\treturn value / data.length;\n\n\t}\n\n}\n\nclass PropertyMixer {\n\n\tconstructor( binding, typeName, valueSize ) {\n\n\t\tthis.binding = binding;\n\t\tthis.valueSize = valueSize;\n\n\t\tlet mixFunction,\n\t\t\tmixFunctionAdditive,\n\t\t\tsetIdentity;\n\n\t\t// buffer layout: [ incoming | accu0 | accu1 | orig | addAccu | (optional work) ]\n\t\t//\n\t\t// interpolators can use .buffer as their .result\n\t\t// the data then goes to 'incoming'\n\t\t//\n\t\t// 'accu0' and 'accu1' are used frame-interleaved for\n\t\t// the cumulative result and are compared to detect\n\t\t// changes\n\t\t//\n\t\t// 'orig' stores the original state of the property\n\t\t//\n\t\t// 'add' is used for additive cumulative results\n\t\t//\n\t\t// 'work' is optional and is only present for quaternion types. It is used\n\t\t// to store intermediate quaternion multiplication results\n\n\t\tswitch ( typeName ) {\n\n\t\t\tcase 'quaternion':\n\t\t\t\tmixFunction = this._slerp;\n\t\t\t\tmixFunctionAdditive = this._slerpAdditive;\n\t\t\t\tsetIdentity = this._setAdditiveIdentityQuaternion;\n\n\t\t\t\tthis.buffer = new Float64Array( valueSize * 6 );\n\t\t\t\tthis._workIndex = 5;\n\t\t\t\tbreak;\n\n\t\t\tcase 'string':\n\t\t\tcase 'bool':\n\t\t\t\tmixFunction = this._select;\n\n\t\t\t\t// Use the regular mix function and for additive on these types,\n\t\t\t\t// additive is not relevant for non-numeric types\n\t\t\t\tmixFunctionAdditive = this._select;\n\n\t\t\t\tsetIdentity = this._setAdditiveIdentityOther;\n\n\t\t\t\tthis.buffer = new Array( valueSize * 5 );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tmixFunction = this._lerp;\n\t\t\t\tmixFunctionAdditive = this._lerpAdditive;\n\t\t\t\tsetIdentity = this._setAdditiveIdentityNumeric;\n\n\t\t\t\tthis.buffer = new Float64Array( valueSize * 5 );\n\n\t\t}\n\n\t\tthis._mixBufferRegion = mixFunction;\n\t\tthis._mixBufferRegionAdditive = mixFunctionAdditive;\n\t\tthis._setIdentity = setIdentity;\n\t\tthis._origIndex = 3;\n\t\tthis._addIndex = 4;\n\n\t\tthis.cumulativeWeight = 0;\n\t\tthis.cumulativeWeightAdditive = 0;\n\n\t\tthis.useCount = 0;\n\t\tthis.referenceCount = 0;\n\n\t}\n\n\t// accumulate data in the 'incoming' region into 'accu<i>'\n\taccumulate( accuIndex, weight ) {\n\n\t\t// note: happily accumulating nothing when weight = 0, the caller knows\n\t\t// the weight and shouldn't have made the call in the first place\n\n\t\tconst buffer = this.buffer,\n\t\t\tstride = this.valueSize,\n\t\t\toffset = accuIndex * stride + stride;\n\n\t\tlet currentWeight = this.cumulativeWeight;\n\n\t\tif ( currentWeight === 0 ) {\n\n\t\t\t// accuN := incoming * weight\n\n\t\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\t\tbuffer[ offset + i ] = buffer[ i ];\n\n\t\t\t}\n\n\t\t\tcurrentWeight = weight;\n\n\t\t} else {\n\n\t\t\t// accuN := accuN + incoming * weight\n\n\t\t\tcurrentWeight += weight;\n\t\t\tconst mix = weight / currentWeight;\n\t\t\tthis._mixBufferRegion( buffer, offset, 0, mix, stride );\n\n\t\t}\n\n\t\tthis.cumulativeWeight = currentWeight;\n\n\t}\n\n\t// accumulate data in the 'incoming' region into 'add'\n\taccumulateAdditive( weight ) {\n\n\t\tconst buffer = this.buffer,\n\t\t\tstride = this.valueSize,\n\t\t\toffset = stride * this._addIndex;\n\n\t\tif ( this.cumulativeWeightAdditive === 0 ) {\n\n\t\t\t// add = identity\n\n\t\t\tthis._setIdentity();\n\n\t\t}\n\n\t\t// add := add + incoming * weight\n\n\t\tthis._mixBufferRegionAdditive( buffer, offset, 0, weight, stride );\n\t\tthis.cumulativeWeightAdditive += weight;\n\n\t}\n\n\t// apply the state of 'accu<i>' to the binding when accus differ\n\tapply( accuIndex ) {\n\n\t\tconst stride = this.valueSize,\n\t\t\tbuffer = this.buffer,\n\t\t\toffset = accuIndex * stride + stride,\n\n\t\t\tweight = this.cumulativeWeight,\n\t\t\tweightAdditive = this.cumulativeWeightAdditive,\n\n\t\t\tbinding = this.binding;\n\n\t\tthis.cumulativeWeight = 0;\n\t\tthis.cumulativeWeightAdditive = 0;\n\n\t\tif ( weight < 1 ) {\n\n\t\t\t// accuN := accuN + original * ( 1 - cumulativeWeight )\n\n\t\t\tconst originalValueOffset = stride * this._origIndex;\n\n\t\t\tthis._mixBufferRegion(\n\t\t\t\tbuffer, offset, originalValueOffset, 1 - weight, stride );\n\n\t\t}\n\n\t\tif ( weightAdditive > 0 ) {\n\n\t\t\t// accuN := accuN + additive accuN\n\n\t\t\tthis._mixBufferRegionAdditive( buffer, offset, this._addIndex * stride, 1, stride );\n\n\t\t}\n\n\t\tfor ( let i = stride, e = stride + stride; i !== e; ++ i ) {\n\n\t\t\tif ( buffer[ i ] !== buffer[ i + stride ] ) {\n\n\t\t\t\t// value has changed -> update scene graph\n\n\t\t\t\tbinding.setValue( buffer, offset );\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// remember the state of the bound property and copy it to both accus\n\tsaveOriginalState() {\n\n\t\tconst binding = this.binding;\n\n\t\tconst buffer = this.buffer,\n\t\t\tstride = this.valueSize,\n\n\t\t\toriginalValueOffset = stride * this._origIndex;\n\n\t\tbinding.getValue( buffer, originalValueOffset );\n\n\t\t// accu[0..1] := orig -- initially detect changes against the original\n\t\tfor ( let i = stride, e = originalValueOffset; i !== e; ++ i ) {\n\n\t\t\tbuffer[ i ] = buffer[ originalValueOffset + ( i % stride ) ];\n\n\t\t}\n\n\t\t// Add to identity for additive\n\t\tthis._setIdentity();\n\n\t\tthis.cumulativeWeight = 0;\n\t\tthis.cumulativeWeightAdditive = 0;\n\n\t}\n\n\t// apply the state previously taken via 'saveOriginalState' to the binding\n\trestoreOriginalState() {\n\n\t\tconst originalValueOffset = this.valueSize * 3;\n\t\tthis.binding.setValue( this.buffer, originalValueOffset );\n\n\t}\n\n\t_setAdditiveIdentityNumeric() {\n\n\t\tconst startIndex = this._addIndex * this.valueSize;\n\t\tconst endIndex = startIndex + this.valueSize;\n\n\t\tfor ( let i = startIndex; i < endIndex; i ++ ) {\n\n\t\t\tthis.buffer[ i ] = 0;\n\n\t\t}\n\n\t}\n\n\t_setAdditiveIdentityQuaternion() {\n\n\t\tthis._setAdditiveIdentityNumeric();\n\t\tthis.buffer[ this._addIndex * this.valueSize + 3 ] = 1;\n\n\t}\n\n\t_setAdditiveIdentityOther() {\n\n\t\tconst startIndex = this._origIndex * this.valueSize;\n\t\tconst targetIndex = this._addIndex * this.valueSize;\n\n\t\tfor ( let i = 0; i < this.valueSize; i ++ ) {\n\n\t\t\tthis.buffer[ targetIndex + i ] = this.buffer[ startIndex + i ];\n\n\t\t}\n\n\t}\n\n\n\t// mix functions\n\n\t_select( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tif ( t >= 0.5 ) {\n\n\t\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\t\tbuffer[ dstOffset + i ] = buffer[ srcOffset + i ];\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_slerp( buffer, dstOffset, srcOffset, t ) {\n\n\t\tQuaternion.slerpFlat( buffer, dstOffset, buffer, dstOffset, buffer, srcOffset, t );\n\n\t}\n\n\t_slerpAdditive( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tconst workOffset = this._workIndex * stride;\n\n\t\t// Store result in intermediate buffer offset\n\t\tQuaternion.multiplyQuaternionsFlat( buffer, workOffset, buffer, dstOffset, buffer, srcOffset );\n\n\t\t// Slerp to the intermediate result\n\t\tQuaternion.slerpFlat( buffer, dstOffset, buffer, dstOffset, buffer, workOffset, t );\n\n\t}\n\n\t_lerp( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tconst s = 1 - t;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tconst j = dstOffset + i;\n\n\t\t\tbuffer[ j ] = buffer[ j ] * s + buffer[ srcOffset + i ] * t;\n\n\t\t}\n\n\t}\n\n\t_lerpAdditive( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tconst j = dstOffset + i;\n\n\t\t\tbuffer[ j ] = buffer[ j ] + buffer[ srcOffset + i ] * t;\n\n\t\t}\n\n\t}\n\n}\n\n// Characters [].:/ are reserved for track binding syntax.\nconst _RESERVED_CHARS_RE = '\\\\[\\\\]\\\\.:\\\\/';\nconst _reservedRe = new RegExp( '[' + _RESERVED_CHARS_RE + ']', 'g' );\n\n// Attempts to allow node names from any language. ES5's `\\w` regexp matches\n// only latin characters, and the unicode \\p{L} is not yet supported. So\n// instead, we exclude reserved characters and match everything else.\nconst _wordChar = '[^' + _RESERVED_CHARS_RE + ']';\nconst _wordCharOrDot = '[^' + _RESERVED_CHARS_RE.replace( '\\\\.', '' ) + ']';\n\n// Parent directories, delimited by '/' or ':'. Currently unused, but must\n// be matched to parse the rest of the track name.\nconst _directoryRe = /((?:WC+[\\/:])*)/.source.replace( 'WC', _wordChar );\n\n// Target node. May contain word characters (a-zA-Z0-9_) and '.' or '-'.\nconst _nodeRe = /(WCOD+)?/.source.replace( 'WCOD', _wordCharOrDot );\n\n// Object on target node, and accessor. May not contain reserved\n// characters. Accessor may contain any character except closing bracket.\nconst _objectRe = /(?:\\.(WC+)(?:\\[(.+)\\])?)?/.source.replace( 'WC', _wordChar );\n\n// Property and accessor. May not contain reserved characters. Accessor may\n// contain any non-bracket characters.\nconst _propertyRe = /\\.(WC+)(?:\\[(.+)\\])?/.source.replace( 'WC', _wordChar );\n\nconst _trackRe = new RegExp( ''\n\t+ '^'\n\t+ _directoryRe\n\t+ _nodeRe\n\t+ _objectRe\n\t+ _propertyRe\n\t+ '$'\n);\n\nconst _supportedObjectNames = [ 'material', 'materials', 'bones' ];\n\nclass Composite {\n\n\tconstructor( targetGroup, path, optionalParsedPath ) {\n\n\t\tconst parsedPath = optionalParsedPath || PropertyBinding.parseTrackName( path );\n\n\t\tthis._targetGroup = targetGroup;\n\t\tthis._bindings = targetGroup.subscribe_( path, parsedPath );\n\n\t}\n\n\tgetValue( array, offset ) {\n\n\t\tthis.bind(); // bind all binding\n\n\t\tconst firstValidIndex = this._targetGroup.nCachedObjects_,\n\t\t\tbinding = this._bindings[ firstValidIndex ];\n\n\t\t// and only call .getValue on the first\n\t\tif ( binding !== undefined ) binding.getValue( array, offset );\n\n\t}\n\n\tsetValue( array, offset ) {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].setValue( array, offset );\n\n\t\t}\n\n\t}\n\n\tbind() {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].bind();\n\n\t\t}\n\n\t}\n\n\tunbind() {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].unbind();\n\n\t\t}\n\n\t}\n\n}\n\n// Note: This class uses a State pattern on a per-method basis:\n// 'bind' sets 'this.getValue' / 'setValue' and shadows the\n// prototype version of these methods with one that represents\n// the bound state. When the property is not found, the methods\n// become no-ops.\nclass PropertyBinding {\n\n\tconstructor( rootNode, path, parsedPath ) {\n\n\t\tthis.path = path;\n\t\tthis.parsedPath = parsedPath || PropertyBinding.parseTrackName( path );\n\n\t\tthis.node = PropertyBinding.findNode( rootNode, this.parsedPath.nodeName ) || rootNode;\n\n\t\tthis.rootNode = rootNode;\n\n\t\t// initial state of these methods that calls 'bind'\n\t\tthis.getValue = this._getValue_unbound;\n\t\tthis.setValue = this._setValue_unbound;\n\n\t}\n\n\n\tstatic create( root, path, parsedPath ) {\n\n\t\tif ( ! ( root && root.isAnimationObjectGroup ) ) {\n\n\t\t\treturn new PropertyBinding( root, path, parsedPath );\n\n\t\t} else {\n\n\t\t\treturn new PropertyBinding.Composite( root, path, parsedPath );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Replaces spaces with underscores and removes unsupported characters from\n\t * node names, to ensure compatibility with parseTrackName().\n\t *\n\t * @param {string} name Node name to be sanitized.\n\t * @return {string}\n\t */\n\tstatic sanitizeNodeName( name ) {\n\n\t\treturn name.replace( /\\s/g, '_' ).replace( _reservedRe, '' );\n\n\t}\n\n\tstatic parseTrackName( trackName ) {\n\n\t\tconst matches = _trackRe.exec( trackName );\n\n\t\tif ( ! matches ) {\n\n\t\t\tthrow new Error( 'PropertyBinding: Cannot parse trackName: ' + trackName );\n\n\t\t}\n\n\t\tconst results = {\n\t\t\t// directoryName: matches[ 1 ], // (tschw) currently unused\n\t\t\tnodeName: matches[ 2 ],\n\t\t\tobjectName: matches[ 3 ],\n\t\t\tobjectIndex: matches[ 4 ],\n\t\t\tpropertyName: matches[ 5 ], // required\n\t\t\tpropertyIndex: matches[ 6 ]\n\t\t};\n\n\t\tconst lastDot = results.nodeName && results.nodeName.lastIndexOf( '.' );\n\n\t\tif ( lastDot !== undefined && lastDot !== - 1 ) {\n\n\t\t\tconst objectName = results.nodeName.substring( lastDot + 1 );\n\n\t\t\t// Object names must be checked against an allowlist. Otherwise, there\n\t\t\t// is no way to parse 'foo.bar.baz': 'baz' must be a property, but\n\t\t\t// 'bar' could be the objectName, or part of a nodeName (which can\n\t\t\t// include '.' characters).\n\t\t\tif ( _supportedObjectNames.indexOf( objectName ) !== - 1 ) {\n\n\t\t\t\tresults.nodeName = results.nodeName.substring( 0, lastDot );\n\t\t\t\tresults.objectName = objectName;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( results.propertyName === null || results.propertyName.length === 0 ) {\n\n\t\t\tthrow new Error( 'PropertyBinding: can not parse propertyName from trackName: ' + trackName );\n\n\t\t}\n\n\t\treturn results;\n\n\t}\n\n\tstatic findNode( root, nodeName ) {\n\n\t\tif ( ! nodeName || nodeName === '' || nodeName === '.' || nodeName === - 1 || nodeName === root.name || nodeName === root.uuid ) {\n\n\t\t\treturn root;\n\n\t\t}\n\n\t\t// search into skeleton bones.\n\t\tif ( root.skeleton ) {\n\n\t\t\tconst bone = root.skeleton.getBoneByName( nodeName );\n\n\t\t\tif ( bone !== undefined ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// search into node subtree.\n\t\tif ( root.children ) {\n\n\t\t\tconst searchNodeSubtree = function ( children ) {\n\n\t\t\t\tfor ( let i = 0; i < children.length; i ++ ) {\n\n\t\t\t\t\tconst childNode = children[ i ];\n\n\t\t\t\t\tif ( childNode.name === nodeName || childNode.uuid === nodeName ) {\n\n\t\t\t\t\t\treturn childNode;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = searchNodeSubtree( childNode.children );\n\n\t\t\t\t\tif ( result ) return result;\n\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\n\t\t\t};\n\n\t\t\tconst subTreeNode = searchNodeSubtree( root.children );\n\n\t\t\tif ( subTreeNode ) {\n\n\t\t\t\treturn subTreeNode;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t// these are used to \"bind\" a nonexistent property\n\t_getValue_unavailable() {}\n\t_setValue_unavailable() {}\n\n\t// Getters\n\n\t_getValue_direct( buffer, offset ) {\n\n\t\tbuffer[ offset ] = this.targetObject[ this.propertyName ];\n\n\t}\n\n\t_getValue_array( buffer, offset ) {\n\n\t\tconst source = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = source.length; i !== n; ++ i ) {\n\n\t\t\tbuffer[ offset ++ ] = source[ i ];\n\n\t\t}\n\n\t}\n\n\t_getValue_arrayElement( buffer, offset ) {\n\n\t\tbuffer[ offset ] = this.resolvedProperty[ this.propertyIndex ];\n\n\t}\n\n\t_getValue_toArray( buffer, offset ) {\n\n\t\tthis.resolvedProperty.toArray( buffer, offset );\n\n\t}\n\n\t// Direct\n\n\t_setValue_direct( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\n\t}\n\n\t_setValue_direct_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_direct_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// EntireArray\n\n\t_setValue_array( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t}\n\n\t_setValue_array_setNeedsUpdate( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_array_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// ArrayElement\n\n\t_setValue_arrayElement( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\n\t}\n\n\t_setValue_arrayElement_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_arrayElement_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// HasToFromArray\n\n\t_setValue_fromArray( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\n\t}\n\n\t_setValue_fromArray_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_fromArray_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t_getValue_unbound( targetArray, offset ) {\n\n\t\tthis.bind();\n\t\tthis.getValue( targetArray, offset );\n\n\t}\n\n\t_setValue_unbound( sourceArray, offset ) {\n\n\t\tthis.bind();\n\t\tthis.setValue( sourceArray, offset );\n\n\t}\n\n\t// create getter / setter pair for a property in the scene graph\n\tbind() {\n\n\t\tlet targetObject = this.node;\n\t\tconst parsedPath = this.parsedPath;\n\n\t\tconst objectName = parsedPath.objectName;\n\t\tconst propertyName = parsedPath.propertyName;\n\t\tlet propertyIndex = parsedPath.propertyIndex;\n\n\t\tif ( ! targetObject ) {\n\n\t\t\ttargetObject = PropertyBinding.findNode( this.rootNode, parsedPath.nodeName ) || this.rootNode;\n\n\t\t\tthis.node = targetObject;\n\n\t\t}\n\n\t\t// set fail state so we can just 'return' on error\n\t\tthis.getValue = this._getValue_unavailable;\n\t\tthis.setValue = this._setValue_unavailable;\n\n\t\t// ensure there is a value node\n\t\tif ( ! targetObject ) {\n\n\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to update node for track: ' + this.path + ' but it wasn\\'t found.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( objectName ) {\n\n\t\t\tlet objectIndex = parsedPath.objectIndex;\n\n\t\t\t// special cases were we need to reach deeper into the hierarchy to get the face materials....\n\t\t\tswitch ( objectName ) {\n\n\t\t\t\tcase 'materials':\n\n\t\t\t\t\tif ( ! targetObject.material ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material as node does not have a material.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! targetObject.material.materials ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject.material.materials;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bones':\n\n\t\t\t\t\tif ( ! targetObject.skeleton ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// potential future optimization: skip this if propertyIndex is already an integer\n\t\t\t\t\t// and convert the integer string to a true integer.\n\n\t\t\t\t\ttargetObject = targetObject.skeleton.bones;\n\n\t\t\t\t\t// support resolving morphTarget names into indices.\n\t\t\t\t\tfor ( let i = 0; i < targetObject.length; i ++ ) {\n\n\t\t\t\t\t\tif ( targetObject[ i ].name === objectIndex ) {\n\n\t\t\t\t\t\t\tobjectIndex = i;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tif ( targetObject[ objectName ] === undefined ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to objectName of node undefined.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject[ objectName ];\n\n\t\t\t}\n\n\n\t\t\tif ( objectIndex !== undefined ) {\n\n\t\t\t\tif ( targetObject[ objectIndex ] === undefined ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.', this, targetObject );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\ttargetObject = targetObject[ objectIndex ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// resolve property\n\t\tconst nodeProperty = targetObject[ propertyName ];\n\n\t\tif ( nodeProperty === undefined ) {\n\n\t\t\tconst nodeName = parsedPath.nodeName;\n\n\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to update property for track: ' + nodeName +\n\t\t\t\t'.' + propertyName + ' but it wasn\\'t found.', targetObject );\n\t\t\treturn;\n\n\t\t}\n\n\t\t// determine versioning scheme\n\t\tlet versioning = this.Versioning.None;\n\n\t\tthis.targetObject = targetObject;\n\n\t\tif ( targetObject.needsUpdate !== undefined ) { // material\n\n\t\t\tversioning = this.Versioning.NeedsUpdate;\n\n\t\t} else if ( targetObject.matrixWorldNeedsUpdate !== undefined ) { // node transform\n\n\t\t\tversioning = this.Versioning.MatrixWorldNeedsUpdate;\n\n\t\t}\n\n\t\t// determine how the property gets bound\n\t\tlet bindingType = this.BindingType.Direct;\n\n\t\tif ( propertyIndex !== undefined ) {\n\n\t\t\t// access a sub element of the property array (only primitives are supported right now)\n\n\t\t\tif ( propertyName === 'morphTargetInfluences' ) {\n\n\t\t\t\t// potential optimization, skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\n\n\t\t\t\t// support resolving morphTarget names into indices.\n\t\t\t\tif ( ! targetObject.geometry ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.', this );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( targetObject.geometry.isBufferGeometry ) {\n\n\t\t\t\t\tif ( ! targetObject.geometry.morphAttributes ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( targetObject.morphTargetDictionary[ propertyIndex ] !== undefined ) {\n\n\t\t\t\t\t\tpropertyIndex = targetObject.morphTargetDictionary[ propertyIndex ];\n\n\t\t\t\t\t}\n\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.', this );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tbindingType = this.BindingType.ArrayElement;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\t\t\tthis.propertyIndex = propertyIndex;\n\n\t\t} else if ( nodeProperty.fromArray !== undefined && nodeProperty.toArray !== undefined ) {\n\n\t\t\t// must use copy for Object3D.Euler/Quaternion\n\n\t\t\tbindingType = this.BindingType.HasFromToArray;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\n\t\t} else if ( Array.isArray( nodeProperty ) ) {\n\n\t\t\tbindingType = this.BindingType.EntireArray;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\n\t\t} else {\n\n\t\t\tthis.propertyName = propertyName;\n\n\t\t}\n\n\t\t// select getter / setter\n\t\tthis.getValue = this.GetterByBindingType[ bindingType ];\n\t\tthis.setValue = this.SetterByBindingTypeAndVersioning[ bindingType ][ versioning ];\n\n\t}\n\n\tunbind() {\n\n\t\tthis.node = null;\n\n\t\t// back to the prototype version of getValue / setValue\n\t\t// note: avoiding to mutate the shape of 'this' via 'delete'\n\t\tthis.getValue = this._getValue_unbound;\n\t\tthis.setValue = this._setValue_unbound;\n\n\t}\n\n}\n\nPropertyBinding.Composite = Composite;\n\nPropertyBinding.prototype.BindingType = {\n\tDirect: 0,\n\tEntireArray: 1,\n\tArrayElement: 2,\n\tHasFromToArray: 3\n};\n\nPropertyBinding.prototype.Versioning = {\n\tNone: 0,\n\tNeedsUpdate: 1,\n\tMatrixWorldNeedsUpdate: 2\n};\n\nPropertyBinding.prototype.GetterByBindingType = [\n\n\tPropertyBinding.prototype._getValue_direct,\n\tPropertyBinding.prototype._getValue_array,\n\tPropertyBinding.prototype._getValue_arrayElement,\n\tPropertyBinding.prototype._getValue_toArray,\n\n];\n\nPropertyBinding.prototype.SetterByBindingTypeAndVersioning = [\n\n\t[\n\t\t// Direct\n\t\tPropertyBinding.prototype._setValue_direct,\n\t\tPropertyBinding.prototype._setValue_direct_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// EntireArray\n\n\t\tPropertyBinding.prototype._setValue_array,\n\t\tPropertyBinding.prototype._setValue_array_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// ArrayElement\n\t\tPropertyBinding.prototype._setValue_arrayElement,\n\t\tPropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// HasToFromArray\n\t\tPropertyBinding.prototype._setValue_fromArray,\n\t\tPropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate,\n\n\t]\n\n];\n\n/**\n *\n * A group of objects that receives a shared animation state.\n *\n * Usage:\n *\n *  - Add objects you would otherwise pass as 'root' to the\n *    constructor or the .clipAction method of AnimationMixer.\n *\n *  - Instead pass this object as 'root'.\n *\n *  - You can also add and remove objects later when the mixer\n *    is running.\n *\n * Note:\n *\n *    Objects of this class appear as one object to the mixer,\n *    so cache control of the individual objects must be done\n *    on the group.\n *\n * Limitation:\n *\n *  - The animated properties must be compatible among the\n *    all objects in the group.\n *\n *  - A single property can either be controlled through a\n *    target group or directly, but not both.\n */\n\nclass AnimationObjectGroup {\n\n\tconstructor() {\n\n\t\tthis.uuid = generateUUID();\n\n\t\t// cached objects followed by the active ones\n\t\tthis._objects = Array.prototype.slice.call( arguments );\n\n\t\tthis.nCachedObjects_ = 0; // threshold\n\t\t// note: read by PropertyBinding.Composite\n\n\t\tconst indices = {};\n\t\tthis._indicesByUUID = indices; // for bookkeeping\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tindices[ arguments[ i ].uuid ] = i;\n\n\t\t}\n\n\t\tthis._paths = []; // inside: string\n\t\tthis._parsedPaths = []; // inside: { we don't care, here }\n\t\tthis._bindings = []; // inside: Array< PropertyBinding >\n\t\tthis._bindingsIndicesByPath = {}; // inside: indices in these arrays\n\n\t\tconst scope = this;\n\n\t\tthis.stats = {\n\n\t\t\tobjects: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._objects.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn this.total - scope.nCachedObjects_;\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tget bindingsPerObject() {\n\n\t\t\t\treturn scope._bindings.length;\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\tadd() {\n\n\t\tconst objects = this._objects,\n\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\tpaths = this._paths,\n\t\t\tparsedPaths = this._parsedPaths,\n\t\t\tbindings = this._bindings,\n\t\t\tnBindings = bindings.length;\n\n\t\tlet knownObject = undefined,\n\t\t\tnObjects = objects.length,\n\t\t\tnCachedObjects = this.nCachedObjects_;\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tconst object = arguments[ i ],\n\t\t\t\tuuid = object.uuid;\n\t\t\tlet index = indicesByUUID[ uuid ];\n\n\t\t\tif ( index === undefined ) {\n\n\t\t\t\t// unknown object -> add it to the ACTIVE region\n\n\t\t\t\tindex = nObjects ++;\n\t\t\t\tindicesByUUID[ uuid ] = index;\n\t\t\t\tobjects.push( object );\n\n\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\tbindings[ j ].push( new PropertyBinding( object, paths[ j ], parsedPaths[ j ] ) );\n\n\t\t\t\t}\n\n\t\t\t} else if ( index < nCachedObjects ) {\n\n\t\t\t\tknownObject = objects[ index ];\n\n\t\t\t\t// move existing object to the ACTIVE region\n\n\t\t\t\tconst firstActiveIndex = -- nCachedObjects,\n\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ];\n\n\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\n\t\t\t\tobjects[ index ] = lastCachedObject;\n\n\t\t\t\tindicesByUUID[ uuid ] = firstActiveIndex;\n\t\t\t\tobjects[ firstActiveIndex ] = object;\n\n\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\tconst bindingsForPath = bindings[ j ],\n\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ];\n\n\t\t\t\t\tlet binding = bindingsForPath[ index ];\n\n\t\t\t\t\tbindingsForPath[ index ] = lastCached;\n\n\t\t\t\t\tif ( binding === undefined ) {\n\n\t\t\t\t\t\t// since we do not bother to create new bindings\n\t\t\t\t\t\t// for objects that are cached, the binding may\n\t\t\t\t\t\t// or may not exist\n\n\t\t\t\t\t\tbinding = new PropertyBinding( object, paths[ j ], parsedPaths[ j ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = binding;\n\n\t\t\t\t}\n\n\t\t\t} else if ( objects[ index ] !== knownObject ) {\n\n\t\t\t\tconsole.error( 'THREE.AnimationObjectGroup: Different objects with the same UUID ' +\n\t\t\t\t\t'detected. Clean the caches or recreate your infrastructure when reloading scenes.' );\n\n\t\t\t} // else the object is already where we want it to be\n\n\t\t} // for arguments\n\n\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t}\n\n\tremove() {\n\n\t\tconst objects = this._objects,\n\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\tbindings = this._bindings,\n\t\t\tnBindings = bindings.length;\n\n\t\tlet nCachedObjects = this.nCachedObjects_;\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tconst object = arguments[ i ],\n\t\t\t\tuuid = object.uuid,\n\t\t\t\tindex = indicesByUUID[ uuid ];\n\n\t\t\tif ( index !== undefined && index >= nCachedObjects ) {\n\n\t\t\t\t// move existing object into the CACHED region\n\n\t\t\t\tconst lastCachedIndex = nCachedObjects ++,\n\t\t\t\t\tfirstActiveObject = objects[ lastCachedIndex ];\n\n\t\t\t\tindicesByUUID[ firstActiveObject.uuid ] = index;\n\t\t\t\tobjects[ index ] = firstActiveObject;\n\n\t\t\t\tindicesByUUID[ uuid ] = lastCachedIndex;\n\t\t\t\tobjects[ lastCachedIndex ] = object;\n\n\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\tconst bindingsForPath = bindings[ j ],\n\t\t\t\t\t\tfirstActive = bindingsForPath[ lastCachedIndex ],\n\t\t\t\t\t\tbinding = bindingsForPath[ index ];\n\n\t\t\t\t\tbindingsForPath[ index ] = firstActive;\n\t\t\t\t\tbindingsForPath[ lastCachedIndex ] = binding;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} // for arguments\n\n\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t}\n\n\t// remove & forget\n\tuncache() {\n\n\t\tconst objects = this._objects,\n\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\tbindings = this._bindings,\n\t\t\tnBindings = bindings.length;\n\n\t\tlet nCachedObjects = this.nCachedObjects_,\n\t\t\tnObjects = objects.length;\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tconst object = arguments[ i ],\n\t\t\t\tuuid = object.uuid,\n\t\t\t\tindex = indicesByUUID[ uuid ];\n\n\t\t\tif ( index !== undefined ) {\n\n\t\t\t\tdelete indicesByUUID[ uuid ];\n\n\t\t\t\tif ( index < nCachedObjects ) {\n\n\t\t\t\t\t// object is cached, shrink the CACHED region\n\n\t\t\t\t\tconst firstActiveIndex = -- nCachedObjects,\n\t\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ],\n\t\t\t\t\t\tlastIndex = -- nObjects,\n\t\t\t\t\t\tlastObject = objects[ lastIndex ];\n\n\t\t\t\t\t// last cached object takes this object's place\n\t\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\n\t\t\t\t\tobjects[ index ] = lastCachedObject;\n\n\t\t\t\t\t// last object goes to the activated slot and pop\n\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = firstActiveIndex;\n\t\t\t\t\tobjects[ firstActiveIndex ] = lastObject;\n\t\t\t\t\tobjects.pop();\n\n\t\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\t\tconst bindingsForPath = bindings[ j ],\n\t\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ],\n\t\t\t\t\t\t\tlast = bindingsForPath[ lastIndex ];\n\n\t\t\t\t\t\tbindingsForPath[ index ] = lastCached;\n\t\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = last;\n\t\t\t\t\t\tbindingsForPath.pop();\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// object is active, just swap with the last and pop\n\n\t\t\t\t\tconst lastIndex = -- nObjects,\n\t\t\t\t\t\tlastObject = objects[ lastIndex ];\n\n\t\t\t\t\tif ( lastIndex > 0 ) {\n\n\t\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = index;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tobjects[ index ] = lastObject;\n\t\t\t\t\tobjects.pop();\n\n\t\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\t\tconst bindingsForPath = bindings[ j ];\n\n\t\t\t\t\t\tbindingsForPath[ index ] = bindingsForPath[ lastIndex ];\n\t\t\t\t\t\tbindingsForPath.pop();\n\n\t\t\t\t\t}\n\n\t\t\t\t} // cached or active\n\n\t\t\t} // if object is known\n\n\t\t} // for arguments\n\n\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t}\n\n\t// Internal interface used by befriended PropertyBinding.Composite:\n\n\tsubscribe_( path, parsedPath ) {\n\n\t\t// returns an array of bindings for the given path that is changed\n\t\t// according to the contained objects in the group\n\n\t\tconst indicesByPath = this._bindingsIndicesByPath;\n\t\tlet index = indicesByPath[ path ];\n\t\tconst bindings = this._bindings;\n\n\t\tif ( index !== undefined ) return bindings[ index ];\n\n\t\tconst paths = this._paths,\n\t\t\tparsedPaths = this._parsedPaths,\n\t\t\tobjects = this._objects,\n\t\t\tnObjects = objects.length,\n\t\t\tnCachedObjects = this.nCachedObjects_,\n\t\t\tbindingsForPath = new Array( nObjects );\n\n\t\tindex = bindings.length;\n\n\t\tindicesByPath[ path ] = index;\n\n\t\tpaths.push( path );\n\t\tparsedPaths.push( parsedPath );\n\t\tbindings.push( bindingsForPath );\n\n\t\tfor ( let i = nCachedObjects, n = objects.length; i !== n; ++ i ) {\n\n\t\t\tconst object = objects[ i ];\n\t\t\tbindingsForPath[ i ] = new PropertyBinding( object, path, parsedPath );\n\n\t\t}\n\n\t\treturn bindingsForPath;\n\n\t}\n\n\tunsubscribe_( path ) {\n\n\t\t// tells the group to forget about a property path and no longer\n\t\t// update the array previously obtained with 'subscribe_'\n\n\t\tconst indicesByPath = this._bindingsIndicesByPath,\n\t\t\tindex = indicesByPath[ path ];\n\n\t\tif ( index !== undefined ) {\n\n\t\t\tconst paths = this._paths,\n\t\t\t\tparsedPaths = this._parsedPaths,\n\t\t\t\tbindings = this._bindings,\n\t\t\t\tlastBindingsIndex = bindings.length - 1,\n\t\t\t\tlastBindings = bindings[ lastBindingsIndex ],\n\t\t\t\tlastBindingsPath = path[ lastBindingsIndex ];\n\n\t\t\tindicesByPath[ lastBindingsPath ] = index;\n\n\t\t\tbindings[ index ] = lastBindings;\n\t\t\tbindings.pop();\n\n\t\t\tparsedPaths[ index ] = parsedPaths[ lastBindingsIndex ];\n\t\t\tparsedPaths.pop();\n\n\t\t\tpaths[ index ] = paths[ lastBindingsIndex ];\n\t\t\tpaths.pop();\n\n\t\t}\n\n\t}\n\n}\n\nAnimationObjectGroup.prototype.isAnimationObjectGroup = true;\n\nclass AnimationAction {\n\n\tconstructor( mixer, clip, localRoot = null, blendMode = clip.blendMode ) {\n\n\t\tthis._mixer = mixer;\n\t\tthis._clip = clip;\n\t\tthis._localRoot = localRoot;\n\t\tthis.blendMode = blendMode;\n\n\t\tconst tracks = clip.tracks,\n\t\t\tnTracks = tracks.length,\n\t\t\tinterpolants = new Array( nTracks );\n\n\t\tconst interpolantSettings = {\n\t\t\tendingStart: ZeroCurvatureEnding,\n\t\t\tendingEnd: ZeroCurvatureEnding\n\t\t};\n\n\t\tfor ( let i = 0; i !== nTracks; ++ i ) {\n\n\t\t\tconst interpolant = tracks[ i ].createInterpolant( null );\n\t\t\tinterpolants[ i ] = interpolant;\n\t\t\tinterpolant.settings = interpolantSettings;\n\n\t\t}\n\n\t\tthis._interpolantSettings = interpolantSettings;\n\n\t\tthis._interpolants = interpolants; // bound by the mixer\n\n\t\t// inside: PropertyMixer (managed by the mixer)\n\t\tthis._propertyBindings = new Array( nTracks );\n\n\t\tthis._cacheIndex = null; // for the memory manager\n\t\tthis._byClipCacheIndex = null; // for the memory manager\n\n\t\tthis._timeScaleInterpolant = null;\n\t\tthis._weightInterpolant = null;\n\n\t\tthis.loop = LoopRepeat;\n\t\tthis._loopCount = - 1;\n\n\t\t// global mixer time when the action is to be started\n\t\t// it's set back to 'null' upon start of the action\n\t\tthis._startTime = null;\n\n\t\t// scaled local time of the action\n\t\t// gets clamped or wrapped to 0..clip.duration according to loop\n\t\tthis.time = 0;\n\n\t\tthis.timeScale = 1;\n\t\tthis._effectiveTimeScale = 1;\n\n\t\tthis.weight = 1;\n\t\tthis._effectiveWeight = 1;\n\n\t\tthis.repetitions = Infinity; // no. of repetitions when looping\n\n\t\tthis.paused = false; // true -> zero effective time scale\n\t\tthis.enabled = true; // false -> zero effective weight\n\n\t\tthis.clampWhenFinished = false;// keep feeding the last frame?\n\n\t\tthis.zeroSlopeAtStart = true;// for smooth interpolation w/o separate\n\t\tthis.zeroSlopeAtEnd = true;// clips for start, loop and end\n\n\t}\n\n\t// State & Scheduling\n\n\tplay() {\n\n\t\tthis._mixer._activateAction( this );\n\n\t\treturn this;\n\n\t}\n\n\tstop() {\n\n\t\tthis._mixer._deactivateAction( this );\n\n\t\treturn this.reset();\n\n\t}\n\n\treset() {\n\n\t\tthis.paused = false;\n\t\tthis.enabled = true;\n\n\t\tthis.time = 0; // restart clip\n\t\tthis._loopCount = - 1;// forget previous loops\n\t\tthis._startTime = null;// forget scheduling\n\n\t\treturn this.stopFading().stopWarping();\n\n\t}\n\n\tisRunning() {\n\n\t\treturn this.enabled && ! this.paused && this.timeScale !== 0 &&\n\t\t\tthis._startTime === null && this._mixer._isActiveAction( this );\n\n\t}\n\n\t// return true when play has been called\n\tisScheduled() {\n\n\t\treturn this._mixer._isActiveAction( this );\n\n\t}\n\n\tstartAt( time ) {\n\n\t\tthis._startTime = time;\n\n\t\treturn this;\n\n\t}\n\n\tsetLoop( mode, repetitions ) {\n\n\t\tthis.loop = mode;\n\t\tthis.repetitions = repetitions;\n\n\t\treturn this;\n\n\t}\n\n\t// Weight\n\n\t// set the weight stopping any scheduled fading\n\t// although .enabled = false yields an effective weight of zero, this\n\t// method does *not* change .enabled, because it would be confusing\n\tsetEffectiveWeight( weight ) {\n\n\t\tthis.weight = weight;\n\n\t\t// note: same logic as when updated at runtime\n\t\tthis._effectiveWeight = this.enabled ? weight : 0;\n\n\t\treturn this.stopFading();\n\n\t}\n\n\t// return the weight considering fading and .enabled\n\tgetEffectiveWeight() {\n\n\t\treturn this._effectiveWeight;\n\n\t}\n\n\tfadeIn( duration ) {\n\n\t\treturn this._scheduleFading( duration, 0, 1 );\n\n\t}\n\n\tfadeOut( duration ) {\n\n\t\treturn this._scheduleFading( duration, 1, 0 );\n\n\t}\n\n\tcrossFadeFrom( fadeOutAction, duration, warp ) {\n\n\t\tfadeOutAction.fadeOut( duration );\n\t\tthis.fadeIn( duration );\n\n\t\tif ( warp ) {\n\n\t\t\tconst fadeInDuration = this._clip.duration,\n\t\t\t\tfadeOutDuration = fadeOutAction._clip.duration,\n\n\t\t\t\tstartEndRatio = fadeOutDuration / fadeInDuration,\n\t\t\t\tendStartRatio = fadeInDuration / fadeOutDuration;\n\n\t\t\tfadeOutAction.warp( 1.0, startEndRatio, duration );\n\t\t\tthis.warp( endStartRatio, 1.0, duration );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcrossFadeTo( fadeInAction, duration, warp ) {\n\n\t\treturn fadeInAction.crossFadeFrom( this, duration, warp );\n\n\t}\n\n\tstopFading() {\n\n\t\tconst weightInterpolant = this._weightInterpolant;\n\n\t\tif ( weightInterpolant !== null ) {\n\n\t\t\tthis._weightInterpolant = null;\n\t\t\tthis._mixer._takeBackControlInterpolant( weightInterpolant );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Time Scale Control\n\n\t// set the time scale stopping any scheduled warping\n\t// although .paused = true yields an effective time scale of zero, this\n\t// method does *not* change .paused, because it would be confusing\n\tsetEffectiveTimeScale( timeScale ) {\n\n\t\tthis.timeScale = timeScale;\n\t\tthis._effectiveTimeScale = this.paused ? 0 : timeScale;\n\n\t\treturn this.stopWarping();\n\n\t}\n\n\t// return the time scale considering warping and .paused\n\tgetEffectiveTimeScale() {\n\n\t\treturn this._effectiveTimeScale;\n\n\t}\n\n\tsetDuration( duration ) {\n\n\t\tthis.timeScale = this._clip.duration / duration;\n\n\t\treturn this.stopWarping();\n\n\t}\n\n\tsyncWith( action ) {\n\n\t\tthis.time = action.time;\n\t\tthis.timeScale = action.timeScale;\n\n\t\treturn this.stopWarping();\n\n\t}\n\n\thalt( duration ) {\n\n\t\treturn this.warp( this._effectiveTimeScale, 0, duration );\n\n\t}\n\n\twarp( startTimeScale, endTimeScale, duration ) {\n\n\t\tconst mixer = this._mixer,\n\t\t\tnow = mixer.time,\n\t\t\ttimeScale = this.timeScale;\n\n\t\tlet interpolant = this._timeScaleInterpolant;\n\n\t\tif ( interpolant === null ) {\n\n\t\t\tinterpolant = mixer._lendControlInterpolant();\n\t\t\tthis._timeScaleInterpolant = interpolant;\n\n\t\t}\n\n\t\tconst times = interpolant.parameterPositions,\n\t\t\tvalues = interpolant.sampleValues;\n\n\t\ttimes[ 0 ] = now;\n\t\ttimes[ 1 ] = now + duration;\n\n\t\tvalues[ 0 ] = startTimeScale / timeScale;\n\t\tvalues[ 1 ] = endTimeScale / timeScale;\n\n\t\treturn this;\n\n\t}\n\n\tstopWarping() {\n\n\t\tconst timeScaleInterpolant = this._timeScaleInterpolant;\n\n\t\tif ( timeScaleInterpolant !== null ) {\n\n\t\t\tthis._timeScaleInterpolant = null;\n\t\t\tthis._mixer._takeBackControlInterpolant( timeScaleInterpolant );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Object Accessors\n\n\tgetMixer() {\n\n\t\treturn this._mixer;\n\n\t}\n\n\tgetClip() {\n\n\t\treturn this._clip;\n\n\t}\n\n\tgetRoot() {\n\n\t\treturn this._localRoot || this._mixer._root;\n\n\t}\n\n\t// Interna\n\n\t_update( time, deltaTime, timeDirection, accuIndex ) {\n\n\t\t// called by the mixer\n\n\t\tif ( ! this.enabled ) {\n\n\t\t\t// call ._updateWeight() to update ._effectiveWeight\n\n\t\t\tthis._updateWeight( time );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst startTime = this._startTime;\n\n\t\tif ( startTime !== null ) {\n\n\t\t\t// check for scheduled start of action\n\n\t\t\tconst timeRunning = ( time - startTime ) * timeDirection;\n\t\t\tif ( timeRunning < 0 || timeDirection === 0 ) {\n\n\t\t\t\treturn; // yet to come / don't decide when delta = 0\n\n\t\t\t}\n\n\t\t\t// start\n\n\t\t\tthis._startTime = null; // unschedule\n\t\t\tdeltaTime = timeDirection * timeRunning;\n\n\t\t}\n\n\t\t// apply time scale and advance time\n\n\t\tdeltaTime *= this._updateTimeScale( time );\n\t\tconst clipTime = this._updateTime( deltaTime );\n\n\t\t// note: _updateTime may disable the action resulting in\n\t\t// an effective weight of 0\n\n\t\tconst weight = this._updateWeight( time );\n\n\t\tif ( weight > 0 ) {\n\n\t\t\tconst interpolants = this._interpolants;\n\t\t\tconst propertyMixers = this._propertyBindings;\n\n\t\t\tswitch ( this.blendMode ) {\n\n\t\t\t\tcase AdditiveAnimationBlendMode:\n\n\t\t\t\t\tfor ( let j = 0, m = interpolants.length; j !== m; ++ j ) {\n\n\t\t\t\t\t\tinterpolants[ j ].evaluate( clipTime );\n\t\t\t\t\t\tpropertyMixers[ j ].accumulateAdditive( weight );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase NormalAnimationBlendMode:\n\t\t\t\tdefault:\n\n\t\t\t\t\tfor ( let j = 0, m = interpolants.length; j !== m; ++ j ) {\n\n\t\t\t\t\t\tinterpolants[ j ].evaluate( clipTime );\n\t\t\t\t\t\tpropertyMixers[ j ].accumulate( accuIndex, weight );\n\n\t\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_updateWeight( time ) {\n\n\t\tlet weight = 0;\n\n\t\tif ( this.enabled ) {\n\n\t\t\tweight = this.weight;\n\t\t\tconst interpolant = this._weightInterpolant;\n\n\t\t\tif ( interpolant !== null ) {\n\n\t\t\t\tconst interpolantValue = interpolant.evaluate( time )[ 0 ];\n\n\t\t\t\tweight *= interpolantValue;\n\n\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\n\n\t\t\t\t\tthis.stopFading();\n\n\t\t\t\t\tif ( interpolantValue === 0 ) {\n\n\t\t\t\t\t\t// faded out, disable\n\t\t\t\t\t\tthis.enabled = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis._effectiveWeight = weight;\n\t\treturn weight;\n\n\t}\n\n\t_updateTimeScale( time ) {\n\n\t\tlet timeScale = 0;\n\n\t\tif ( ! this.paused ) {\n\n\t\t\ttimeScale = this.timeScale;\n\n\t\t\tconst interpolant = this._timeScaleInterpolant;\n\n\t\t\tif ( interpolant !== null ) {\n\n\t\t\t\tconst interpolantValue = interpolant.evaluate( time )[ 0 ];\n\n\t\t\t\ttimeScale *= interpolantValue;\n\n\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\n\n\t\t\t\t\tthis.stopWarping();\n\n\t\t\t\t\tif ( timeScale === 0 ) {\n\n\t\t\t\t\t\t// motion has halted, pause\n\t\t\t\t\t\tthis.paused = true;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// warp done - apply final time scale\n\t\t\t\t\t\tthis.timeScale = timeScale;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis._effectiveTimeScale = timeScale;\n\t\treturn timeScale;\n\n\t}\n\n\t_updateTime( deltaTime ) {\n\n\t\tconst duration = this._clip.duration;\n\t\tconst loop = this.loop;\n\n\t\tlet time = this.time + deltaTime;\n\t\tlet loopCount = this._loopCount;\n\n\t\tconst pingPong = ( loop === LoopPingPong );\n\n\t\tif ( deltaTime === 0 ) {\n\n\t\t\tif ( loopCount === - 1 ) return time;\n\n\t\t\treturn ( pingPong && ( loopCount & 1 ) === 1 ) ? duration - time : time;\n\n\t\t}\n\n\t\tif ( loop === LoopOnce ) {\n\n\t\t\tif ( loopCount === - 1 ) {\n\n\t\t\t\t// just started\n\n\t\t\t\tthis._loopCount = 0;\n\t\t\t\tthis._setEndings( true, true, false );\n\n\t\t\t}\n\n\t\t\thandle_stop: {\n\n\t\t\t\tif ( time >= duration ) {\n\n\t\t\t\t\ttime = duration;\n\n\t\t\t\t} else if ( time < 0 ) {\n\n\t\t\t\t\ttime = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.time = time;\n\n\t\t\t\t\tbreak handle_stop;\n\n\t\t\t\t}\n\n\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\n\t\t\t\telse this.enabled = false;\n\n\t\t\t\tthis.time = time;\n\n\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\ttype: 'finished', action: this,\n\t\t\t\t\tdirection: deltaTime < 0 ? - 1 : 1\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t} else { // repetitive Repeat or PingPong\n\n\t\t\tif ( loopCount === - 1 ) {\n\n\t\t\t\t// just started\n\n\t\t\t\tif ( deltaTime >= 0 ) {\n\n\t\t\t\t\tloopCount = 0;\n\n\t\t\t\t\tthis._setEndings( true, this.repetitions === 0, pingPong );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// when looping in reverse direction, the initial\n\t\t\t\t\t// transition through zero counts as a repetition,\n\t\t\t\t\t// so leave loopCount at -1\n\n\t\t\t\t\tthis._setEndings( this.repetitions === 0, true, pingPong );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( time >= duration || time < 0 ) {\n\n\t\t\t\t// wrap around\n\n\t\t\t\tconst loopDelta = Math.floor( time / duration ); // signed\n\t\t\t\ttime -= duration * loopDelta;\n\n\t\t\t\tloopCount += Math.abs( loopDelta );\n\n\t\t\t\tconst pending = this.repetitions - loopCount;\n\n\t\t\t\tif ( pending <= 0 ) {\n\n\t\t\t\t\t// have to stop (switch state, clamp time, fire event)\n\n\t\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\n\t\t\t\t\telse this.enabled = false;\n\n\t\t\t\t\ttime = deltaTime > 0 ? duration : 0;\n\n\t\t\t\t\tthis.time = time;\n\n\t\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\t\ttype: 'finished', action: this,\n\t\t\t\t\t\tdirection: deltaTime > 0 ? 1 : - 1\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// keep running\n\n\t\t\t\t\tif ( pending === 1 ) {\n\n\t\t\t\t\t\t// entering the last round\n\n\t\t\t\t\t\tconst atStart = deltaTime < 0;\n\t\t\t\t\t\tthis._setEndings( atStart, ! atStart, pingPong );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthis._setEndings( false, false, pingPong );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._loopCount = loopCount;\n\n\t\t\t\t\tthis.time = time;\n\n\t\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\t\ttype: 'loop', action: this, loopDelta: loopDelta\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tthis.time = time;\n\n\t\t\t}\n\n\t\t\tif ( pingPong && ( loopCount & 1 ) === 1 ) {\n\n\t\t\t\t// invert time for the \"pong round\"\n\n\t\t\t\treturn duration - time;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn time;\n\n\t}\n\n\t_setEndings( atStart, atEnd, pingPong ) {\n\n\t\tconst settings = this._interpolantSettings;\n\n\t\tif ( pingPong ) {\n\n\t\t\tsettings.endingStart = ZeroSlopeEnding;\n\t\t\tsettings.endingEnd = ZeroSlopeEnding;\n\n\t\t} else {\n\n\t\t\t// assuming for LoopOnce atStart == atEnd == true\n\n\t\t\tif ( atStart ) {\n\n\t\t\t\tsettings.endingStart = this.zeroSlopeAtStart ? ZeroSlopeEnding : ZeroCurvatureEnding;\n\n\t\t\t} else {\n\n\t\t\t\tsettings.endingStart = WrapAroundEnding;\n\n\t\t\t}\n\n\t\t\tif ( atEnd ) {\n\n\t\t\t\tsettings.endingEnd = this.zeroSlopeAtEnd ? ZeroSlopeEnding : ZeroCurvatureEnding;\n\n\t\t\t} else {\n\n\t\t\t\tsettings.endingEnd \t = WrapAroundEnding;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_scheduleFading( duration, weightNow, weightThen ) {\n\n\t\tconst mixer = this._mixer, now = mixer.time;\n\t\tlet interpolant = this._weightInterpolant;\n\n\t\tif ( interpolant === null ) {\n\n\t\t\tinterpolant = mixer._lendControlInterpolant();\n\t\t\tthis._weightInterpolant = interpolant;\n\n\t\t}\n\n\t\tconst times = interpolant.parameterPositions,\n\t\t\tvalues = interpolant.sampleValues;\n\n\t\ttimes[ 0 ] = now;\n\t\tvalues[ 0 ] = weightNow;\n\t\ttimes[ 1 ] = now + duration;\n\t\tvalues[ 1 ] = weightThen;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass AnimationMixer extends EventDispatcher {\n\n\tconstructor( root ) {\n\n\t\tsuper();\n\n\t\tthis._root = root;\n\t\tthis._initMemoryManager();\n\t\tthis._accuIndex = 0;\n\t\tthis.time = 0;\n\t\tthis.timeScale = 1.0;\n\n\t}\n\n\t_bindAction( action, prototypeAction ) {\n\n\t\tconst root = action._localRoot || this._root,\n\t\t\ttracks = action._clip.tracks,\n\t\t\tnTracks = tracks.length,\n\t\t\tbindings = action._propertyBindings,\n\t\t\tinterpolants = action._interpolants,\n\t\t\trootUuid = root.uuid,\n\t\t\tbindingsByRoot = this._bindingsByRootAndName;\n\n\t\tlet bindingsByName = bindingsByRoot[ rootUuid ];\n\n\t\tif ( bindingsByName === undefined ) {\n\n\t\t\tbindingsByName = {};\n\t\t\tbindingsByRoot[ rootUuid ] = bindingsByName;\n\n\t\t}\n\n\t\tfor ( let i = 0; i !== nTracks; ++ i ) {\n\n\t\t\tconst track = tracks[ i ],\n\t\t\t\ttrackName = track.name;\n\n\t\t\tlet binding = bindingsByName[ trackName ];\n\n\t\t\tif ( binding !== undefined ) {\n\n\t\t\t\t++ binding.referenceCount;\n\t\t\t\tbindings[ i ] = binding;\n\n\t\t\t} else {\n\n\t\t\t\tbinding = bindings[ i ];\n\n\t\t\t\tif ( binding !== undefined ) {\n\n\t\t\t\t\t// existing binding, make sure the cache knows\n\n\t\t\t\t\tif ( binding._cacheIndex === null ) {\n\n\t\t\t\t\t\t++ binding.referenceCount;\n\t\t\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\tconst path = prototypeAction && prototypeAction.\n\t\t\t\t\t_propertyBindings[ i ].binding.parsedPath;\n\n\t\t\t\tbinding = new PropertyMixer(\n\t\t\t\t\tPropertyBinding.create( root, trackName, path ),\n\t\t\t\t\ttrack.ValueTypeName, track.getValueSize() );\n\n\t\t\t\t++ binding.referenceCount;\n\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\n\n\t\t\t\tbindings[ i ] = binding;\n\n\t\t\t}\n\n\t\t\tinterpolants[ i ].resultBuffer = binding.buffer;\n\n\t\t}\n\n\t}\n\n\t_activateAction( action ) {\n\n\t\tif ( ! this._isActiveAction( action ) ) {\n\n\t\t\tif ( action._cacheIndex === null ) {\n\n\t\t\t\t// this action has been forgotten by the cache, but the user\n\t\t\t\t// appears to be still using it -> rebind\n\n\t\t\t\tconst rootUuid = ( action._localRoot || this._root ).uuid,\n\t\t\t\t\tclipUuid = action._clip.uuid,\n\t\t\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\n\n\t\t\t\tthis._bindAction( action,\n\t\t\t\t\tactionsForClip && actionsForClip.knownActions[ 0 ] );\n\n\t\t\t\tthis._addInactiveAction( action, clipUuid, rootUuid );\n\n\t\t\t}\n\n\t\t\tconst bindings = action._propertyBindings;\n\n\t\t\t// increment reference counts / sort out state\n\t\t\tfor ( let i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\t\tconst binding = bindings[ i ];\n\n\t\t\t\tif ( binding.useCount ++ === 0 ) {\n\n\t\t\t\t\tthis._lendBinding( binding );\n\t\t\t\t\tbinding.saveOriginalState();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._lendAction( action );\n\n\t\t}\n\n\t}\n\n\t_deactivateAction( action ) {\n\n\t\tif ( this._isActiveAction( action ) ) {\n\n\t\t\tconst bindings = action._propertyBindings;\n\n\t\t\t// decrement reference counts / sort out state\n\t\t\tfor ( let i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\t\tconst binding = bindings[ i ];\n\n\t\t\t\tif ( -- binding.useCount === 0 ) {\n\n\t\t\t\t\tbinding.restoreOriginalState();\n\t\t\t\t\tthis._takeBackBinding( binding );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._takeBackAction( action );\n\n\t\t}\n\n\t}\n\n\t// Memory manager\n\n\t_initMemoryManager() {\n\n\t\tthis._actions = []; // 'nActiveActions' followed by inactive ones\n\t\tthis._nActiveActions = 0;\n\n\t\tthis._actionsByClip = {};\n\t\t// inside:\n\t\t// {\n\t\t// \tknownActions: Array< AnimationAction > - used as prototypes\n\t\t// \tactionByRoot: AnimationAction - lookup\n\t\t// }\n\n\n\t\tthis._bindings = []; // 'nActiveBindings' followed by inactive ones\n\t\tthis._nActiveBindings = 0;\n\n\t\tthis._bindingsByRootAndName = {}; // inside: Map< name, PropertyMixer >\n\n\n\t\tthis._controlInterpolants = []; // same game as above\n\t\tthis._nActiveControlInterpolants = 0;\n\n\t\tconst scope = this;\n\n\t\tthis.stats = {\n\n\t\t\tactions: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._actions.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn scope._nActiveActions;\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tbindings: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._bindings.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn scope._nActiveBindings;\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tcontrolInterpolants: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._controlInterpolants.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn scope._nActiveControlInterpolants;\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t// Memory management for AnimationAction objects\n\n\t_isActiveAction( action ) {\n\n\t\tconst index = action._cacheIndex;\n\t\treturn index !== null && index < this._nActiveActions;\n\n\t}\n\n\t_addInactiveAction( action, clipUuid, rootUuid ) {\n\n\t\tconst actions = this._actions,\n\t\t\tactionsByClip = this._actionsByClip;\n\n\t\tlet actionsForClip = actionsByClip[ clipUuid ];\n\n\t\tif ( actionsForClip === undefined ) {\n\n\t\t\tactionsForClip = {\n\n\t\t\t\tknownActions: [ action ],\n\t\t\t\tactionByRoot: {}\n\n\t\t\t};\n\n\t\t\taction._byClipCacheIndex = 0;\n\n\t\t\tactionsByClip[ clipUuid ] = actionsForClip;\n\n\t\t} else {\n\n\t\t\tconst knownActions = actionsForClip.knownActions;\n\n\t\t\taction._byClipCacheIndex = knownActions.length;\n\t\t\tknownActions.push( action );\n\n\t\t}\n\n\t\taction._cacheIndex = actions.length;\n\t\tactions.push( action );\n\n\t\tactionsForClip.actionByRoot[ rootUuid ] = action;\n\n\t}\n\n\t_removeInactiveAction( action ) {\n\n\t\tconst actions = this._actions,\n\t\t\tlastInactiveAction = actions[ actions.length - 1 ],\n\t\t\tcacheIndex = action._cacheIndex;\n\n\t\tlastInactiveAction._cacheIndex = cacheIndex;\n\t\tactions[ cacheIndex ] = lastInactiveAction;\n\t\tactions.pop();\n\n\t\taction._cacheIndex = null;\n\n\n\t\tconst clipUuid = action._clip.uuid,\n\t\t\tactionsByClip = this._actionsByClip,\n\t\t\tactionsForClip = actionsByClip[ clipUuid ],\n\t\t\tknownActionsForClip = actionsForClip.knownActions,\n\n\t\t\tlastKnownAction =\n\t\t\t\tknownActionsForClip[ knownActionsForClip.length - 1 ],\n\n\t\t\tbyClipCacheIndex = action._byClipCacheIndex;\n\n\t\tlastKnownAction._byClipCacheIndex = byClipCacheIndex;\n\t\tknownActionsForClip[ byClipCacheIndex ] = lastKnownAction;\n\t\tknownActionsForClip.pop();\n\n\t\taction._byClipCacheIndex = null;\n\n\n\t\tconst actionByRoot = actionsForClip.actionByRoot,\n\t\t\trootUuid = ( action._localRoot || this._root ).uuid;\n\n\t\tdelete actionByRoot[ rootUuid ];\n\n\t\tif ( knownActionsForClip.length === 0 ) {\n\n\t\t\tdelete actionsByClip[ clipUuid ];\n\n\t\t}\n\n\t\tthis._removeInactiveBindingsForAction( action );\n\n\t}\n\n\t_removeInactiveBindingsForAction( action ) {\n\n\t\tconst bindings = action._propertyBindings;\n\n\t\tfor ( let i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tconst binding = bindings[ i ];\n\n\t\t\tif ( -- binding.referenceCount === 0 ) {\n\n\t\t\t\tthis._removeInactiveBinding( binding );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_lendAction( action ) {\n\n\t\t// [ active actions |  inactive actions  ]\n\t\t// [  active actions >| inactive actions ]\n\t\t//                 s        a\n\t\t//                  <-swap->\n\t\t//                 a        s\n\n\t\tconst actions = this._actions,\n\t\t\tprevIndex = action._cacheIndex,\n\n\t\t\tlastActiveIndex = this._nActiveActions ++,\n\n\t\t\tfirstInactiveAction = actions[ lastActiveIndex ];\n\n\t\taction._cacheIndex = lastActiveIndex;\n\t\tactions[ lastActiveIndex ] = action;\n\n\t\tfirstInactiveAction._cacheIndex = prevIndex;\n\t\tactions[ prevIndex ] = firstInactiveAction;\n\n\t}\n\n\t_takeBackAction( action ) {\n\n\t\t// [  active actions  | inactive actions ]\n\t\t// [ active actions |< inactive actions  ]\n\t\t//        a        s\n\t\t//         <-swap->\n\t\t//        s        a\n\n\t\tconst actions = this._actions,\n\t\t\tprevIndex = action._cacheIndex,\n\n\t\t\tfirstInactiveIndex = -- this._nActiveActions,\n\n\t\t\tlastActiveAction = actions[ firstInactiveIndex ];\n\n\t\taction._cacheIndex = firstInactiveIndex;\n\t\tactions[ firstInactiveIndex ] = action;\n\n\t\tlastActiveAction._cacheIndex = prevIndex;\n\t\tactions[ prevIndex ] = lastActiveAction;\n\n\t}\n\n\t// Memory management for PropertyMixer objects\n\n\t_addInactiveBinding( binding, rootUuid, trackName ) {\n\n\t\tconst bindingsByRoot = this._bindingsByRootAndName,\n\t\t\tbindings = this._bindings;\n\n\t\tlet bindingByName = bindingsByRoot[ rootUuid ];\n\n\t\tif ( bindingByName === undefined ) {\n\n\t\t\tbindingByName = {};\n\t\t\tbindingsByRoot[ rootUuid ] = bindingByName;\n\n\t\t}\n\n\t\tbindingByName[ trackName ] = binding;\n\n\t\tbinding._cacheIndex = bindings.length;\n\t\tbindings.push( binding );\n\n\t}\n\n\t_removeInactiveBinding( binding ) {\n\n\t\tconst bindings = this._bindings,\n\t\t\tpropBinding = binding.binding,\n\t\t\trootUuid = propBinding.rootNode.uuid,\n\t\t\ttrackName = propBinding.path,\n\t\t\tbindingsByRoot = this._bindingsByRootAndName,\n\t\t\tbindingByName = bindingsByRoot[ rootUuid ],\n\n\t\t\tlastInactiveBinding = bindings[ bindings.length - 1 ],\n\t\t\tcacheIndex = binding._cacheIndex;\n\n\t\tlastInactiveBinding._cacheIndex = cacheIndex;\n\t\tbindings[ cacheIndex ] = lastInactiveBinding;\n\t\tbindings.pop();\n\n\t\tdelete bindingByName[ trackName ];\n\n\t\tif ( Object.keys( bindingByName ).length === 0 ) {\n\n\t\t\tdelete bindingsByRoot[ rootUuid ];\n\n\t\t}\n\n\t}\n\n\t_lendBinding( binding ) {\n\n\t\tconst bindings = this._bindings,\n\t\t\tprevIndex = binding._cacheIndex,\n\n\t\t\tlastActiveIndex = this._nActiveBindings ++,\n\n\t\t\tfirstInactiveBinding = bindings[ lastActiveIndex ];\n\n\t\tbinding._cacheIndex = lastActiveIndex;\n\t\tbindings[ lastActiveIndex ] = binding;\n\n\t\tfirstInactiveBinding._cacheIndex = prevIndex;\n\t\tbindings[ prevIndex ] = firstInactiveBinding;\n\n\t}\n\n\t_takeBackBinding( binding ) {\n\n\t\tconst bindings = this._bindings,\n\t\t\tprevIndex = binding._cacheIndex,\n\n\t\t\tfirstInactiveIndex = -- this._nActiveBindings,\n\n\t\t\tlastActiveBinding = bindings[ firstInactiveIndex ];\n\n\t\tbinding._cacheIndex = firstInactiveIndex;\n\t\tbindings[ firstInactiveIndex ] = binding;\n\n\t\tlastActiveBinding._cacheIndex = prevIndex;\n\t\tbindings[ prevIndex ] = lastActiveBinding;\n\n\t}\n\n\n\t// Memory management of Interpolants for weight and time scale\n\n\t_lendControlInterpolant() {\n\n\t\tconst interpolants = this._controlInterpolants,\n\t\t\tlastActiveIndex = this._nActiveControlInterpolants ++;\n\n\t\tlet interpolant = interpolants[ lastActiveIndex ];\n\n\t\tif ( interpolant === undefined ) {\n\n\t\t\tinterpolant = new LinearInterpolant(\n\t\t\t\tnew Float32Array( 2 ), new Float32Array( 2 ),\n\t\t\t\t1, this._controlInterpolantsResultBuffer );\n\n\t\t\tinterpolant.__cacheIndex = lastActiveIndex;\n\t\t\tinterpolants[ lastActiveIndex ] = interpolant;\n\n\t\t}\n\n\t\treturn interpolant;\n\n\t}\n\n\t_takeBackControlInterpolant( interpolant ) {\n\n\t\tconst interpolants = this._controlInterpolants,\n\t\t\tprevIndex = interpolant.__cacheIndex,\n\n\t\t\tfirstInactiveIndex = -- this._nActiveControlInterpolants,\n\n\t\t\tlastActiveInterpolant = interpolants[ firstInactiveIndex ];\n\n\t\tinterpolant.__cacheIndex = firstInactiveIndex;\n\t\tinterpolants[ firstInactiveIndex ] = interpolant;\n\n\t\tlastActiveInterpolant.__cacheIndex = prevIndex;\n\t\tinterpolants[ prevIndex ] = lastActiveInterpolant;\n\n\t}\n\n\t// return an action for a clip optionally using a custom root target\n\t// object (this method allocates a lot of dynamic memory in case a\n\t// previously unknown clip/root combination is specified)\n\tclipAction( clip, optionalRoot, blendMode ) {\n\n\t\tconst root = optionalRoot || this._root,\n\t\t\trootUuid = root.uuid;\n\n\t\tlet clipObject = typeof clip === 'string' ? AnimationClip.findByName( root, clip ) : clip;\n\n\t\tconst clipUuid = clipObject !== null ? clipObject.uuid : clip;\n\n\t\tconst actionsForClip = this._actionsByClip[ clipUuid ];\n\t\tlet prototypeAction = null;\n\n\t\tif ( blendMode === undefined ) {\n\n\t\t\tif ( clipObject !== null ) {\n\n\t\t\t\tblendMode = clipObject.blendMode;\n\n\t\t\t} else {\n\n\t\t\t\tblendMode = NormalAnimationBlendMode;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\tconst existingAction = actionsForClip.actionByRoot[ rootUuid ];\n\n\t\t\tif ( existingAction !== undefined && existingAction.blendMode === blendMode ) {\n\n\t\t\t\treturn existingAction;\n\n\t\t\t}\n\n\t\t\t// we know the clip, so we don't have to parse all\n\t\t\t// the bindings again but can just copy\n\t\t\tprototypeAction = actionsForClip.knownActions[ 0 ];\n\n\t\t\t// also, take the clip from the prototype action\n\t\t\tif ( clipObject === null )\n\t\t\t\tclipObject = prototypeAction._clip;\n\n\t\t}\n\n\t\t// clip must be known when specified via string\n\t\tif ( clipObject === null ) return null;\n\n\t\t// allocate all resources required to run it\n\t\tconst newAction = new AnimationAction( this, clipObject, optionalRoot, blendMode );\n\n\t\tthis._bindAction( newAction, prototypeAction );\n\n\t\t// and make the action known to the memory manager\n\t\tthis._addInactiveAction( newAction, clipUuid, rootUuid );\n\n\t\treturn newAction;\n\n\t}\n\n\t// get an existing action\n\texistingAction( clip, optionalRoot ) {\n\n\t\tconst root = optionalRoot || this._root,\n\t\t\trootUuid = root.uuid,\n\n\t\t\tclipObject = typeof clip === 'string' ?\n\t\t\t\tAnimationClip.findByName( root, clip ) : clip,\n\n\t\t\tclipUuid = clipObject ? clipObject.uuid : clip,\n\n\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\n\n\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\treturn actionsForClip.actionByRoot[ rootUuid ] || null;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t// deactivates all previously scheduled actions\n\tstopAllAction() {\n\n\t\tconst actions = this._actions,\n\t\t\tnActions = this._nActiveActions;\n\n\t\tfor ( let i = nActions - 1; i >= 0; -- i ) {\n\n\t\t\tactions[ i ].stop();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// advance the time and update apply the animation\n\tupdate( deltaTime ) {\n\n\t\tdeltaTime *= this.timeScale;\n\n\t\tconst actions = this._actions,\n\t\t\tnActions = this._nActiveActions,\n\n\t\t\ttime = this.time += deltaTime,\n\t\t\ttimeDirection = Math.sign( deltaTime ),\n\n\t\t\taccuIndex = this._accuIndex ^= 1;\n\n\t\t// run active actions\n\n\t\tfor ( let i = 0; i !== nActions; ++ i ) {\n\n\t\t\tconst action = actions[ i ];\n\n\t\t\taction._update( time, deltaTime, timeDirection, accuIndex );\n\n\t\t}\n\n\t\t// update scene graph\n\n\t\tconst bindings = this._bindings,\n\t\t\tnBindings = this._nActiveBindings;\n\n\t\tfor ( let i = 0; i !== nBindings; ++ i ) {\n\n\t\t\tbindings[ i ].apply( accuIndex );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Allows you to seek to a specific time in an animation.\n\tsetTime( timeInSeconds ) {\n\n\t\tthis.time = 0; // Zero out time attribute for AnimationMixer object;\n\t\tfor ( let i = 0; i < this._actions.length; i ++ ) {\n\n\t\t\tthis._actions[ i ].time = 0; // Zero out time attribute for all associated AnimationAction objects.\n\n\t\t}\n\n\t\treturn this.update( timeInSeconds ); // Update used to set exact time. Returns \"this\" AnimationMixer object.\n\n\t}\n\n\t// return this mixer's root target object\n\tgetRoot() {\n\n\t\treturn this._root;\n\n\t}\n\n\t// free all resources specific to a particular clip\n\tuncacheClip( clip ) {\n\n\t\tconst actions = this._actions,\n\t\t\tclipUuid = clip.uuid,\n\t\t\tactionsByClip = this._actionsByClip,\n\t\t\tactionsForClip = actionsByClip[ clipUuid ];\n\n\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\t// note: just calling _removeInactiveAction would mess up the\n\t\t\t// iteration state and also require updating the state we can\n\t\t\t// just throw away\n\n\t\t\tconst actionsToRemove = actionsForClip.knownActions;\n\n\t\t\tfor ( let i = 0, n = actionsToRemove.length; i !== n; ++ i ) {\n\n\t\t\t\tconst action = actionsToRemove[ i ];\n\n\t\t\t\tthis._deactivateAction( action );\n\n\t\t\t\tconst cacheIndex = action._cacheIndex,\n\t\t\t\t\tlastInactiveAction = actions[ actions.length - 1 ];\n\n\t\t\t\taction._cacheIndex = null;\n\t\t\t\taction._byClipCacheIndex = null;\n\n\t\t\t\tlastInactiveAction._cacheIndex = cacheIndex;\n\t\t\t\tactions[ cacheIndex ] = lastInactiveAction;\n\t\t\t\tactions.pop();\n\n\t\t\t\tthis._removeInactiveBindingsForAction( action );\n\n\t\t\t}\n\n\t\t\tdelete actionsByClip[ clipUuid ];\n\n\t\t}\n\n\t}\n\n\t// free all resources specific to a particular root target object\n\tuncacheRoot( root ) {\n\n\t\tconst rootUuid = root.uuid,\n\t\t\tactionsByClip = this._actionsByClip;\n\n\t\tfor ( const clipUuid in actionsByClip ) {\n\n\t\t\tconst actionByRoot = actionsByClip[ clipUuid ].actionByRoot,\n\t\t\t\taction = actionByRoot[ rootUuid ];\n\n\t\t\tif ( action !== undefined ) {\n\n\t\t\t\tthis._deactivateAction( action );\n\t\t\t\tthis._removeInactiveAction( action );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst bindingsByRoot = this._bindingsByRootAndName,\n\t\t\tbindingByName = bindingsByRoot[ rootUuid ];\n\n\t\tif ( bindingByName !== undefined ) {\n\n\t\t\tfor ( const trackName in bindingByName ) {\n\n\t\t\t\tconst binding = bindingByName[ trackName ];\n\t\t\t\tbinding.restoreOriginalState();\n\t\t\t\tthis._removeInactiveBinding( binding );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// remove a targeted clip from the cache\n\tuncacheAction( clip, optionalRoot ) {\n\n\t\tconst action = this.existingAction( clip, optionalRoot );\n\n\t\tif ( action !== null ) {\n\n\t\t\tthis._deactivateAction( action );\n\t\t\tthis._removeInactiveAction( action );\n\n\t\t}\n\n\t}\n\n}\n\nAnimationMixer.prototype._controlInterpolantsResultBuffer = new Float32Array( 1 );\n\nclass Uniform {\n\n\tconstructor( value ) {\n\n\t\tif ( typeof value === 'string' ) {\n\n\t\t\tconsole.warn( 'THREE.Uniform: Type parameter is no longer needed.' );\n\t\t\tvalue = arguments[ 1 ];\n\n\t\t}\n\n\t\tthis.value = value;\n\n\t}\n\n\tclone() {\n\n\t\treturn new Uniform( this.value.clone === undefined ? this.value : this.value.clone() );\n\n\t}\n\n}\n\nclass InstancedInterleavedBuffer extends InterleavedBuffer {\n\n\tconstructor( array, stride, meshPerAttribute = 1 ) {\n\n\t\tsuper( array, stride );\n\n\t\tthis.meshPerAttribute = meshPerAttribute;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.meshPerAttribute = source.meshPerAttribute;\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tconst ib = super.clone( data );\n\n\t\tib.meshPerAttribute = this.meshPerAttribute;\n\n\t\treturn ib;\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tconst json = super.toJSON( data );\n\n\t\tjson.isInstancedInterleavedBuffer = true;\n\t\tjson.meshPerAttribute = this.meshPerAttribute;\n\n\t\treturn json;\n\n\t}\n\n}\n\nInstancedInterleavedBuffer.prototype.isInstancedInterleavedBuffer = true;\n\nclass GLBufferAttribute {\n\n\tconstructor( buffer, type, itemSize, elementSize, count ) {\n\n\t\tthis.buffer = buffer;\n\t\tthis.type = type;\n\t\tthis.itemSize = itemSize;\n\t\tthis.elementSize = elementSize;\n\t\tthis.count = count;\n\n\t\tthis.version = 0;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetBuffer( buffer ) {\n\n\t\tthis.buffer = buffer;\n\n\t\treturn this;\n\n\t}\n\n\tsetType( type, elementSize ) {\n\n\t\tthis.type = type;\n\t\tthis.elementSize = elementSize;\n\n\t\treturn this;\n\n\t}\n\n\tsetItemSize( itemSize ) {\n\n\t\tthis.itemSize = itemSize;\n\n\t\treturn this;\n\n\t}\n\n\tsetCount( count ) {\n\n\t\tthis.count = count;\n\n\t\treturn this;\n\n\t}\n\n}\n\nGLBufferAttribute.prototype.isGLBufferAttribute = true;\n\nclass Raycaster {\n\n\tconstructor( origin, direction, near = 0, far = Infinity ) {\n\n\t\tthis.ray = new Ray( origin, direction );\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\t\tthis.camera = null;\n\t\tthis.layers = new Layers();\n\n\t\tthis.params = {\n\t\t\tMesh: {},\n\t\t\tLine: { threshold: 1 },\n\t\t\tLOD: {},\n\t\t\tPoints: { threshold: 1 },\n\t\t\tSprite: {}\n\t\t};\n\n\t}\n\n\tset( origin, direction ) {\n\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\n\n\t\tthis.ray.set( origin, direction );\n\n\t}\n\n\tsetFromCamera( coords, camera ) {\n\n\t\tif ( camera && camera.isPerspectiveCamera ) {\n\n\t\t\tthis.ray.origin.setFromMatrixPosition( camera.matrixWorld );\n\t\t\tthis.ray.direction.set( coords.x, coords.y, 0.5 ).unproject( camera ).sub( this.ray.origin ).normalize();\n\t\t\tthis.camera = camera;\n\n\t\t} else if ( camera && camera.isOrthographicCamera ) {\n\n\t\t\tthis.ray.origin.set( coords.x, coords.y, ( camera.near + camera.far ) / ( camera.near - camera.far ) ).unproject( camera ); // set origin in plane of camera\n\t\t\tthis.ray.direction.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld );\n\t\t\tthis.camera = camera;\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Raycaster: Unsupported camera type: ' + camera.type );\n\n\t\t}\n\n\t}\n\n\tintersectObject( object, recursive = true, intersects = [] ) {\n\n\t\tintersectObject( object, this, intersects, recursive );\n\n\t\tintersects.sort( ascSort );\n\n\t\treturn intersects;\n\n\t}\n\n\tintersectObjects( objects, recursive = true, intersects = [] ) {\n\n\t\tfor ( let i = 0, l = objects.length; i < l; i ++ ) {\n\n\t\t\tintersectObject( objects[ i ], this, intersects, recursive );\n\n\t\t}\n\n\t\tintersects.sort( ascSort );\n\n\t\treturn intersects;\n\n\t}\n\n}\n\nfunction ascSort( a, b ) {\n\n\treturn a.distance - b.distance;\n\n}\n\nfunction intersectObject( object, raycaster, intersects, recursive ) {\n\n\tif ( object.layers.test( raycaster.layers ) ) {\n\n\t\tobject.raycast( raycaster, intersects );\n\n\t}\n\n\tif ( recursive === true ) {\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tintersectObject( children[ i ], raycaster, intersects, true );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Ref: https://en.wikipedia.org/wiki/Spherical_coordinate_system\n *\n * The polar angle (phi) is measured from the positive y-axis. The positive y-axis is up.\n * The azimuthal angle (theta) is measured from the positive z-axis.\n */\n\nclass Spherical {\n\n\tconstructor( radius = 1, phi = 0, theta = 0 ) {\n\n\t\tthis.radius = radius;\n\t\tthis.phi = phi; // polar angle\n\t\tthis.theta = theta; // azimuthal angle\n\n\t\treturn this;\n\n\t}\n\n\tset( radius, phi, theta ) {\n\n\t\tthis.radius = radius;\n\t\tthis.phi = phi;\n\t\tthis.theta = theta;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( other ) {\n\n\t\tthis.radius = other.radius;\n\t\tthis.phi = other.phi;\n\t\tthis.theta = other.theta;\n\n\t\treturn this;\n\n\t}\n\n\t// restrict phi to be betwee EPS and PI-EPS\n\tmakeSafe() {\n\n\t\tconst EPS = 0.000001;\n\t\tthis.phi = Math.max( EPS, Math.min( Math.PI - EPS, this.phi ) );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromVector3( v ) {\n\n\t\treturn this.setFromCartesianCoords( v.x, v.y, v.z );\n\n\t}\n\n\tsetFromCartesianCoords( x, y, z ) {\n\n\t\tthis.radius = Math.sqrt( x * x + y * y + z * z );\n\n\t\tif ( this.radius === 0 ) {\n\n\t\t\tthis.theta = 0;\n\t\t\tthis.phi = 0;\n\n\t\t} else {\n\n\t\t\tthis.theta = Math.atan2( x, z );\n\t\t\tthis.phi = Math.acos( clamp( y / this.radius, - 1, 1 ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\n/**\n * Ref: https://en.wikipedia.org/wiki/Cylindrical_coordinate_system\n */\n\nclass Cylindrical {\n\n\tconstructor( radius = 1, theta = 0, y = 0 ) {\n\n\t\tthis.radius = radius; // distance from the origin to a point in the x-z plane\n\t\tthis.theta = theta; // counterclockwise angle in the x-z plane measured in radians from the positive z-axis\n\t\tthis.y = y; // height above the x-z plane\n\n\t\treturn this;\n\n\t}\n\n\tset( radius, theta, y ) {\n\n\t\tthis.radius = radius;\n\t\tthis.theta = theta;\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( other ) {\n\n\t\tthis.radius = other.radius;\n\t\tthis.theta = other.theta;\n\t\tthis.y = other.y;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromVector3( v ) {\n\n\t\treturn this.setFromCartesianCoords( v.x, v.y, v.z );\n\n\t}\n\n\tsetFromCartesianCoords( x, y, z ) {\n\n\t\tthis.radius = Math.sqrt( x * x + z * z );\n\t\tthis.theta = Math.atan2( x, z );\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _vector$4 = /*@__PURE__*/ new Vector2();\n\nclass Box2 {\n\n\tconstructor( min = new Vector2( + Infinity, + Infinity ), max = new Vector2( - Infinity, - Infinity ) ) {\n\n\t\tthis.min = min;\n\t\tthis.max = max;\n\n\t}\n\n\tset( min, max ) {\n\n\t\tthis.min.copy( min );\n\t\tthis.max.copy( max );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tthis.expandByPoint( points[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCenterAndSize( center, size ) {\n\n\t\tconst halfSize = _vector$4.copy( size ).multiplyScalar( 0.5 );\n\t\tthis.min.copy( center ).sub( halfSize );\n\t\tthis.max.copy( center ).add( halfSize );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( box ) {\n\n\t\tthis.min.copy( box.min );\n\t\tthis.max.copy( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.min.x = this.min.y = + Infinity;\n\t\tthis.max.x = this.max.y = - Infinity;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y );\n\n\t}\n\n\tgetCenter( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0 ) : target.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\n\n\t}\n\n\tgetSize( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0 ) : target.subVectors( this.max, this.min );\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\tthis.min.min( point );\n\t\tthis.max.max( point );\n\n\t\treturn this;\n\n\t}\n\n\texpandByVector( vector ) {\n\n\t\tthis.min.sub( vector );\n\t\tthis.max.add( vector );\n\n\t\treturn this;\n\n\t}\n\n\texpandByScalar( scalar ) {\n\n\t\tthis.min.addScalar( - scalar );\n\t\tthis.max.addScalar( scalar );\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn point.x < this.min.x || point.x > this.max.x ||\n\t\t\tpoint.y < this.min.y || point.y > this.max.y ? false : true;\n\n\t}\n\n\tcontainsBox( box ) {\n\n\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\n\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y;\n\n\t}\n\n\tgetParameter( point, target ) {\n\n\t\t// This can potentially have a divide by zero if the box\n\t\t// has a size dimension of 0.\n\n\t\treturn target.set(\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y )\n\t\t);\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\t// using 4 splitting planes to rule out intersections\n\n\t\treturn box.max.x < this.min.x || box.min.x > this.max.x ||\n\t\t\tbox.max.y < this.min.y || box.min.y > this.max.y ? false : true;\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\treturn target.copy( point ).clamp( this.min, this.max );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\tconst clampedPoint = _vector$4.copy( point ).clamp( this.min, this.max );\n\t\treturn clampedPoint.sub( point ).length();\n\n\t}\n\n\tintersect( box ) {\n\n\t\tthis.min.max( box.min );\n\t\tthis.max.min( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tunion( box ) {\n\n\t\tthis.min.min( box.min );\n\t\tthis.max.max( box.max );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.min.add( offset );\n\t\tthis.max.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\tequals( box ) {\n\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\n\n\t}\n\n}\n\nBox2.prototype.isBox2 = true;\n\nconst _startP = /*@__PURE__*/ new Vector3();\nconst _startEnd = /*@__PURE__*/ new Vector3();\n\nclass Line3 {\n\n\tconstructor( start = new Vector3(), end = new Vector3() ) {\n\n\t\tthis.start = start;\n\t\tthis.end = end;\n\n\t}\n\n\tset( start, end ) {\n\n\t\tthis.start.copy( start );\n\t\tthis.end.copy( end );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( line ) {\n\n\t\tthis.start.copy( line.start );\n\t\tthis.end.copy( line.end );\n\n\t\treturn this;\n\n\t}\n\n\tgetCenter( target ) {\n\n\t\treturn target.addVectors( this.start, this.end ).multiplyScalar( 0.5 );\n\n\t}\n\n\tdelta( target ) {\n\n\t\treturn target.subVectors( this.end, this.start );\n\n\t}\n\n\tdistanceSq() {\n\n\t\treturn this.start.distanceToSquared( this.end );\n\n\t}\n\n\tdistance() {\n\n\t\treturn this.start.distanceTo( this.end );\n\n\t}\n\n\tat( t, target ) {\n\n\t\treturn this.delta( target ).multiplyScalar( t ).add( this.start );\n\n\t}\n\n\tclosestPointToPointParameter( point, clampToLine ) {\n\n\t\t_startP.subVectors( point, this.start );\n\t\t_startEnd.subVectors( this.end, this.start );\n\n\t\tconst startEnd2 = _startEnd.dot( _startEnd );\n\t\tconst startEnd_startP = _startEnd.dot( _startP );\n\n\t\tlet t = startEnd_startP / startEnd2;\n\n\t\tif ( clampToLine ) {\n\n\t\t\tt = clamp( t, 0, 1 );\n\n\t\t}\n\n\t\treturn t;\n\n\t}\n\n\tclosestPointToPoint( point, clampToLine, target ) {\n\n\t\tconst t = this.closestPointToPointParameter( point, clampToLine );\n\n\t\treturn this.delta( target ).multiplyScalar( t ).add( this.start );\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tthis.start.applyMatrix4( matrix );\n\t\tthis.end.applyMatrix4( matrix );\n\n\t\treturn this;\n\n\t}\n\n\tequals( line ) {\n\n\t\treturn line.start.equals( this.start ) && line.end.equals( this.end );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _vector$3 = /*@__PURE__*/ new Vector3();\n\nclass SpotLightHelper extends Object3D {\n\n\tconstructor( light, color ) {\n\n\t\tsuper();\n\t\tthis.light = light;\n\t\tthis.light.updateMatrixWorld();\n\n\t\tthis.matrix = light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.color = color;\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tconst positions = [\n\t\t\t0, 0, 0, \t0, 0, 1,\n\t\t\t0, 0, 0, \t1, 0, 1,\n\t\t\t0, 0, 0,\t- 1, 0, 1,\n\t\t\t0, 0, 0, \t0, 1, 1,\n\t\t\t0, 0, 0, \t0, - 1, 1\n\t\t];\n\n\t\tfor ( let i = 0, j = 1, l = 32; i < l; i ++, j ++ ) {\n\n\t\t\tconst p1 = ( i / l ) * Math.PI * 2;\n\t\t\tconst p2 = ( j / l ) * Math.PI * 2;\n\n\t\t\tpositions.push(\n\t\t\t\tMath.cos( p1 ), Math.sin( p1 ), 1,\n\t\t\t\tMath.cos( p2 ), Math.sin( p2 ), 1\n\t\t\t);\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { fog: false, toneMapped: false } );\n\n\t\tthis.cone = new LineSegments( geometry, material );\n\t\tthis.add( this.cone );\n\n\t\tthis.update();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.cone.geometry.dispose();\n\t\tthis.cone.material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tthis.light.updateMatrixWorld();\n\n\t\tconst coneLength = this.light.distance ? this.light.distance : 1000;\n\t\tconst coneWidth = coneLength * Math.tan( this.light.angle );\n\n\t\tthis.cone.scale.set( coneWidth, coneWidth, coneLength );\n\n\t\t_vector$3.setFromMatrixPosition( this.light.target.matrixWorld );\n\n\t\tthis.cone.lookAt( _vector$3 );\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.cone.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tthis.cone.material.color.copy( this.light.color );\n\n\t\t}\n\n\t}\n\n}\n\nconst _vector$2 = /*@__PURE__*/ new Vector3();\nconst _boneMatrix = /*@__PURE__*/ new Matrix4();\nconst _matrixWorldInv = /*@__PURE__*/ new Matrix4();\n\n\nclass SkeletonHelper extends LineSegments {\n\n\tconstructor( object ) {\n\n\t\tconst bones = getBoneList( object );\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tconst vertices = [];\n\t\tconst colors = [];\n\n\t\tconst color1 = new Color( 0, 0, 1 );\n\t\tconst color2 = new Color( 0, 1, 0 );\n\n\t\tfor ( let i = 0; i < bones.length; i ++ ) {\n\n\t\t\tconst bone = bones[ i ];\n\n\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\tvertices.push( 0, 0, 0 );\n\t\t\t\tvertices.push( 0, 0, 0 );\n\t\t\t\tcolors.push( color1.r, color1.g, color1.b );\n\t\t\t\tcolors.push( color2.r, color2.g, color2.b );\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, depthTest: false, depthWrite: false, toneMapped: false, transparent: true } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'SkeletonHelper';\n\t\tthis.isSkeletonHelper = true;\n\n\t\tthis.root = object;\n\t\tthis.bones = bones;\n\n\t\tthis.matrix = object.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tconst bones = this.bones;\n\n\t\tconst geometry = this.geometry;\n\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\t_matrixWorldInv.copy( this.root.matrixWorld ).invert();\n\n\t\tfor ( let i = 0, j = 0; i < bones.length; i ++ ) {\n\n\t\t\tconst bone = bones[ i ];\n\n\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t_boneMatrix.multiplyMatrices( _matrixWorldInv, bone.matrixWorld );\n\t\t\t\t_vector$2.setFromMatrixPosition( _boneMatrix );\n\t\t\t\tposition.setXYZ( j, _vector$2.x, _vector$2.y, _vector$2.z );\n\n\t\t\t\t_boneMatrix.multiplyMatrices( _matrixWorldInv, bone.parent.matrixWorld );\n\t\t\t\t_vector$2.setFromMatrixPosition( _boneMatrix );\n\t\t\t\tposition.setXYZ( j + 1, _vector$2.x, _vector$2.y, _vector$2.z );\n\n\t\t\t\tj += 2;\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeometry.getAttribute( 'position' ).needsUpdate = true;\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t}\n\n}\n\n\nfunction getBoneList( object ) {\n\n\tconst boneList = [];\n\n\tif ( object && object.isBone ) {\n\n\t\tboneList.push( object );\n\n\t}\n\n\tfor ( let i = 0; i < object.children.length; i ++ ) {\n\n\t\tboneList.push.apply( boneList, getBoneList( object.children[ i ] ) );\n\n\t}\n\n\treturn boneList;\n\n}\n\nclass PointLightHelper extends Mesh {\n\n\tconstructor( light, sphereSize, color ) {\n\n\t\tconst geometry = new SphereGeometry( sphereSize, 4, 2 );\n\t\tconst material = new MeshBasicMaterial( { wireframe: true, fog: false, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.light = light;\n\t\tthis.light.updateMatrixWorld();\n\n\t\tthis.color = color;\n\n\t\tthis.type = 'PointLightHelper';\n\n\t\tthis.matrix = this.light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.update();\n\n\n\t\t/*\n\t// TODO: delete this comment?\n\tconst distanceGeometry = new THREE.IcosahedronBufferGeometry( 1, 2 );\n\tconst distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\n\n\tthis.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\n\tthis.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\n\n\tconst d = light.distance;\n\n\tif ( d === 0.0 ) {\n\n\t\tthis.lightDistance.visible = false;\n\n\t} else {\n\n\t\tthis.lightDistance.scale.set( d, d, d );\n\n\t}\n\n\tthis.add( this.lightDistance );\n\t*/\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tthis.material.color.copy( this.light.color );\n\n\t\t}\n\n\t\t/*\n\t\tconst d = this.light.distance;\n\n\t\tif ( d === 0.0 ) {\n\n\t\t\tthis.lightDistance.visible = false;\n\n\t\t} else {\n\n\t\t\tthis.lightDistance.visible = true;\n\t\t\tthis.lightDistance.scale.set( d, d, d );\n\n\t\t}\n\t\t*/\n\n\t}\n\n}\n\nconst _vector$1 = /*@__PURE__*/ new Vector3();\nconst _color1 = /*@__PURE__*/ new Color();\nconst _color2 = /*@__PURE__*/ new Color();\n\nclass HemisphereLightHelper extends Object3D {\n\n\tconstructor( light, size, color ) {\n\n\t\tsuper();\n\t\tthis.light = light;\n\t\tthis.light.updateMatrixWorld();\n\n\t\tthis.matrix = light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.color = color;\n\n\t\tconst geometry = new OctahedronGeometry( size );\n\t\tgeometry.rotateY( Math.PI * 0.5 );\n\n\t\tthis.material = new MeshBasicMaterial( { wireframe: true, fog: false, toneMapped: false } );\n\t\tif ( this.color === undefined ) this.material.vertexColors = true;\n\n\t\tconst position = geometry.getAttribute( 'position' );\n\t\tconst colors = new Float32Array( position.count * 3 );\n\n\t\tgeometry.setAttribute( 'color', new BufferAttribute( colors, 3 ) );\n\n\t\tthis.add( new Mesh( geometry, this.material ) );\n\n\t\tthis.update();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.children[ 0 ].geometry.dispose();\n\t\tthis.children[ 0 ].material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tconst mesh = this.children[ 0 ];\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tconst colors = mesh.geometry.getAttribute( 'color' );\n\n\t\t\t_color1.copy( this.light.color );\n\t\t\t_color2.copy( this.light.groundColor );\n\n\t\t\tfor ( let i = 0, l = colors.count; i < l; i ++ ) {\n\n\t\t\t\tconst color = ( i < ( l / 2 ) ) ? _color1 : _color2;\n\n\t\t\t\tcolors.setXYZ( i, color.r, color.g, color.b );\n\n\t\t\t}\n\n\t\t\tcolors.needsUpdate = true;\n\n\t\t}\n\n\t\tmesh.lookAt( _vector$1.setFromMatrixPosition( this.light.matrixWorld ).negate() );\n\n\t}\n\n}\n\nclass GridHelper extends LineSegments {\n\n\tconstructor( size = 10, divisions = 10, color1 = 0x444444, color2 = 0x888888 ) {\n\n\t\tcolor1 = new Color( color1 );\n\t\tcolor2 = new Color( color2 );\n\n\t\tconst center = divisions / 2;\n\t\tconst step = size / divisions;\n\t\tconst halfSize = size / 2;\n\n\t\tconst vertices = [], colors = [];\n\n\t\tfor ( let i = 0, j = 0, k = - halfSize; i <= divisions; i ++, k += step ) {\n\n\t\t\tvertices.push( - halfSize, 0, k, halfSize, 0, k );\n\t\t\tvertices.push( k, 0, - halfSize, k, 0, halfSize );\n\n\t\t\tconst color = i === center ? color1 : color2;\n\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\n\t\t}\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'GridHelper';\n\n\t}\n\n}\n\nclass PolarGridHelper extends LineSegments {\n\n\tconstructor( radius = 10, radials = 16, circles = 8, divisions = 64, color1 = 0x444444, color2 = 0x888888 ) {\n\n\t\tcolor1 = new Color( color1 );\n\t\tcolor2 = new Color( color2 );\n\n\t\tconst vertices = [];\n\t\tconst colors = [];\n\n\t\t// create the radials\n\n\t\tfor ( let i = 0; i <= radials; i ++ ) {\n\n\t\t\tconst v = ( i / radials ) * ( Math.PI * 2 );\n\n\t\t\tconst x = Math.sin( v ) * radius;\n\t\t\tconst z = Math.cos( v ) * radius;\n\n\t\t\tvertices.push( 0, 0, 0 );\n\t\t\tvertices.push( x, 0, z );\n\n\t\t\tconst color = ( i & 1 ) ? color1 : color2;\n\n\t\t\tcolors.push( color.r, color.g, color.b );\n\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t}\n\n\t\t// create the circles\n\n\t\tfor ( let i = 0; i <= circles; i ++ ) {\n\n\t\t\tconst color = ( i & 1 ) ? color1 : color2;\n\n\t\t\tconst r = radius - ( radius / circles * i );\n\n\t\t\tfor ( let j = 0; j < divisions; j ++ ) {\n\n\t\t\t\t// first vertex\n\n\t\t\t\tlet v = ( j / divisions ) * ( Math.PI * 2 );\n\n\t\t\t\tlet x = Math.sin( v ) * r;\n\t\t\t\tlet z = Math.cos( v ) * r;\n\n\t\t\t\tvertices.push( x, 0, z );\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\t\t// second vertex\n\n\t\t\t\tv = ( ( j + 1 ) / divisions ) * ( Math.PI * 2 );\n\n\t\t\t\tx = Math.sin( v ) * r;\n\t\t\t\tz = Math.cos( v ) * r;\n\n\t\t\t\tvertices.push( x, 0, z );\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'PolarGridHelper';\n\n\t}\n\n}\n\nconst _v1 = /*@__PURE__*/ new Vector3();\nconst _v2 = /*@__PURE__*/ new Vector3();\nconst _v3 = /*@__PURE__*/ new Vector3();\n\nclass DirectionalLightHelper extends Object3D {\n\n\tconstructor( light, size, color ) {\n\n\t\tsuper();\n\t\tthis.light = light;\n\t\tthis.light.updateMatrixWorld();\n\n\t\tthis.matrix = light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.color = color;\n\n\t\tif ( size === undefined ) size = 1;\n\n\t\tlet geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( [\n\t\t\t- size, size, 0,\n\t\t\tsize, size, 0,\n\t\t\tsize, - size, 0,\n\t\t\t- size, - size, 0,\n\t\t\t- size, size, 0\n\t\t], 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { fog: false, toneMapped: false } );\n\n\t\tthis.lightPlane = new Line( geometry, material );\n\t\tthis.add( this.lightPlane );\n\n\t\tgeometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 0, 0, 1 ], 3 ) );\n\n\t\tthis.targetLine = new Line( geometry, material );\n\t\tthis.add( this.targetLine );\n\n\t\tthis.update();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.lightPlane.geometry.dispose();\n\t\tthis.lightPlane.material.dispose();\n\t\tthis.targetLine.geometry.dispose();\n\t\tthis.targetLine.material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\t_v1.setFromMatrixPosition( this.light.matrixWorld );\n\t\t_v2.setFromMatrixPosition( this.light.target.matrixWorld );\n\t\t_v3.subVectors( _v2, _v1 );\n\n\t\tthis.lightPlane.lookAt( _v2 );\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.lightPlane.material.color.set( this.color );\n\t\t\tthis.targetLine.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tthis.lightPlane.material.color.copy( this.light.color );\n\t\t\tthis.targetLine.material.color.copy( this.light.color );\n\n\t\t}\n\n\t\tthis.targetLine.lookAt( _v2 );\n\t\tthis.targetLine.scale.z = _v3.length();\n\n\t}\n\n}\n\nconst _vector = /*@__PURE__*/ new Vector3();\nconst _camera = /*@__PURE__*/ new Camera();\n\n/**\n *\t- shows frustum, line of sight and up of the camera\n *\t- suitable for fast updates\n * \t- based on frustum visualization in lightgl.js shadowmap example\n *\t\thttps://github.com/evanw/lightgl.js/blob/master/tests/shadowmap.html\n */\n\nclass CameraHelper extends LineSegments {\n\n\tconstructor( camera ) {\n\n\t\tconst geometry = new BufferGeometry();\n\t\tconst material = new LineBasicMaterial( { color: 0xffffff, vertexColors: true, toneMapped: false } );\n\n\t\tconst vertices = [];\n\t\tconst colors = [];\n\n\t\tconst pointMap = {};\n\n\t\t// colors\n\n\t\tconst colorFrustum = new Color( 0xffaa00 );\n\t\tconst colorCone = new Color( 0xff0000 );\n\t\tconst colorUp = new Color( 0x00aaff );\n\t\tconst colorTarget = new Color( 0xffffff );\n\t\tconst colorCross = new Color( 0x333333 );\n\n\t\t// near\n\n\t\taddLine( 'n1', 'n2', colorFrustum );\n\t\taddLine( 'n2', 'n4', colorFrustum );\n\t\taddLine( 'n4', 'n3', colorFrustum );\n\t\taddLine( 'n3', 'n1', colorFrustum );\n\n\t\t// far\n\n\t\taddLine( 'f1', 'f2', colorFrustum );\n\t\taddLine( 'f2', 'f4', colorFrustum );\n\t\taddLine( 'f4', 'f3', colorFrustum );\n\t\taddLine( 'f3', 'f1', colorFrustum );\n\n\t\t// sides\n\n\t\taddLine( 'n1', 'f1', colorFrustum );\n\t\taddLine( 'n2', 'f2', colorFrustum );\n\t\taddLine( 'n3', 'f3', colorFrustum );\n\t\taddLine( 'n4', 'f4', colorFrustum );\n\n\t\t// cone\n\n\t\taddLine( 'p', 'n1', colorCone );\n\t\taddLine( 'p', 'n2', colorCone );\n\t\taddLine( 'p', 'n3', colorCone );\n\t\taddLine( 'p', 'n4', colorCone );\n\n\t\t// up\n\n\t\taddLine( 'u1', 'u2', colorUp );\n\t\taddLine( 'u2', 'u3', colorUp );\n\t\taddLine( 'u3', 'u1', colorUp );\n\n\t\t// target\n\n\t\taddLine( 'c', 't', colorTarget );\n\t\taddLine( 'p', 'c', colorCross );\n\n\t\t// cross\n\n\t\taddLine( 'cn1', 'cn2', colorCross );\n\t\taddLine( 'cn3', 'cn4', colorCross );\n\n\t\taddLine( 'cf1', 'cf2', colorCross );\n\t\taddLine( 'cf3', 'cf4', colorCross );\n\n\t\tfunction addLine( a, b, color ) {\n\n\t\t\taddPoint( a, color );\n\t\t\taddPoint( b, color );\n\n\t\t}\n\n\t\tfunction addPoint( id, color ) {\n\n\t\t\tvertices.push( 0, 0, 0 );\n\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\tif ( pointMap[ id ] === undefined ) {\n\n\t\t\t\tpointMap[ id ] = [];\n\n\t\t\t}\n\n\t\t\tpointMap[ id ].push( ( vertices.length / 3 ) - 1 );\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'CameraHelper';\n\n\t\tthis.camera = camera;\n\t\tif ( this.camera.updateProjectionMatrix ) this.camera.updateProjectionMatrix();\n\n\t\tthis.matrix = camera.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.pointMap = pointMap;\n\n\t\tthis.update();\n\n\t}\n\n\tupdate() {\n\n\t\tconst geometry = this.geometry;\n\t\tconst pointMap = this.pointMap;\n\n\t\tconst w = 1, h = 1;\n\n\t\t// we need just camera projection matrix inverse\n\t\t// world matrix must be identity\n\n\t\t_camera.projectionMatrixInverse.copy( this.camera.projectionMatrixInverse );\n\n\t\t// center / target\n\n\t\tsetPoint( 'c', pointMap, geometry, _camera, 0, 0, - 1 );\n\t\tsetPoint( 't', pointMap, geometry, _camera, 0, 0, 1 );\n\n\t\t// near\n\n\t\tsetPoint( 'n1', pointMap, geometry, _camera, - w, - h, - 1 );\n\t\tsetPoint( 'n2', pointMap, geometry, _camera, w, - h, - 1 );\n\t\tsetPoint( 'n3', pointMap, geometry, _camera, - w, h, - 1 );\n\t\tsetPoint( 'n4', pointMap, geometry, _camera, w, h, - 1 );\n\n\t\t// far\n\n\t\tsetPoint( 'f1', pointMap, geometry, _camera, - w, - h, 1 );\n\t\tsetPoint( 'f2', pointMap, geometry, _camera, w, - h, 1 );\n\t\tsetPoint( 'f3', pointMap, geometry, _camera, - w, h, 1 );\n\t\tsetPoint( 'f4', pointMap, geometry, _camera, w, h, 1 );\n\n\t\t// up\n\n\t\tsetPoint( 'u1', pointMap, geometry, _camera, w * 0.7, h * 1.1, - 1 );\n\t\tsetPoint( 'u2', pointMap, geometry, _camera, - w * 0.7, h * 1.1, - 1 );\n\t\tsetPoint( 'u3', pointMap, geometry, _camera, 0, h * 2, - 1 );\n\n\t\t// cross\n\n\t\tsetPoint( 'cf1', pointMap, geometry, _camera, - w, 0, 1 );\n\t\tsetPoint( 'cf2', pointMap, geometry, _camera, w, 0, 1 );\n\t\tsetPoint( 'cf3', pointMap, geometry, _camera, 0, - h, 1 );\n\t\tsetPoint( 'cf4', pointMap, geometry, _camera, 0, h, 1 );\n\n\t\tsetPoint( 'cn1', pointMap, geometry, _camera, - w, 0, - 1 );\n\t\tsetPoint( 'cn2', pointMap, geometry, _camera, w, 0, - 1 );\n\t\tsetPoint( 'cn3', pointMap, geometry, _camera, 0, - h, - 1 );\n\t\tsetPoint( 'cn4', pointMap, geometry, _camera, 0, h, - 1 );\n\n\t\tgeometry.getAttribute( 'position' ).needsUpdate = true;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\n\nfunction setPoint( point, pointMap, geometry, camera, x, y, z ) {\n\n\t_vector.set( x, y, z ).unproject( camera );\n\n\tconst points = pointMap[ point ];\n\n\tif ( points !== undefined ) {\n\n\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\tfor ( let i = 0, l = points.length; i < l; i ++ ) {\n\n\t\t\tposition.setXYZ( points[ i ], _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t}\n\n}\n\nconst _box = /*@__PURE__*/ new Box3();\n\nclass BoxHelper extends LineSegments {\n\n\tconstructor( object, color = 0xffff00 ) {\n\n\t\tconst indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\n\t\tconst positions = new Float32Array( 8 * 3 );\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setIndex( new BufferAttribute( indices, 1 ) );\n\t\tgeometry.setAttribute( 'position', new BufferAttribute( positions, 3 ) );\n\n\t\tsuper( geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\n\t\tthis.object = object;\n\t\tthis.type = 'BoxHelper';\n\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.update();\n\n\t}\n\n\tupdate( object ) {\n\n\t\tif ( object !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.BoxHelper: .update() has no longer arguments.' );\n\n\t\t}\n\n\t\tif ( this.object !== undefined ) {\n\n\t\t\t_box.setFromObject( this.object );\n\n\t\t}\n\n\t\tif ( _box.isEmpty() ) return;\n\n\t\tconst min = _box.min;\n\t\tconst max = _box.max;\n\n\t\t/*\n\t\t\t5____4\n\t\t1/___0/|\n\t\t| 6__|_7\n\t\t2/___3/\n\n\t\t0: max.x, max.y, max.z\n\t\t1: min.x, max.y, max.z\n\t\t2: min.x, min.y, max.z\n\t\t3: max.x, min.y, max.z\n\t\t4: max.x, max.y, min.z\n\t\t5: min.x, max.y, min.z\n\t\t6: min.x, min.y, min.z\n\t\t7: max.x, min.y, min.z\n\t\t*/\n\n\t\tconst position = this.geometry.attributes.position;\n\t\tconst array = position.array;\n\n\t\tarray[ 0 ] = max.x; array[ 1 ] = max.y; array[ 2 ] = max.z;\n\t\tarray[ 3 ] = min.x; array[ 4 ] = max.y; array[ 5 ] = max.z;\n\t\tarray[ 6 ] = min.x; array[ 7 ] = min.y; array[ 8 ] = max.z;\n\t\tarray[ 9 ] = max.x; array[ 10 ] = min.y; array[ 11 ] = max.z;\n\t\tarray[ 12 ] = max.x; array[ 13 ] = max.y; array[ 14 ] = min.z;\n\t\tarray[ 15 ] = min.x; array[ 16 ] = max.y; array[ 17 ] = min.z;\n\t\tarray[ 18 ] = min.x; array[ 19 ] = min.y; array[ 20 ] = min.z;\n\t\tarray[ 21 ] = max.x; array[ 22 ] = min.y; array[ 23 ] = min.z;\n\n\t\tposition.needsUpdate = true;\n\n\t\tthis.geometry.computeBoundingSphere();\n\n\n\t}\n\n\tsetFromObject( object ) {\n\n\t\tthis.object = object;\n\t\tthis.update();\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tLineSegments.prototype.copy.call( this, source );\n\n\t\tthis.object = source.object;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass Box3Helper extends LineSegments {\n\n\tconstructor( box, color = 0xffff00 ) {\n\n\t\tconst indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\n\n\t\tconst positions = [ 1, 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, - 1, 1, 1, 1, - 1, - 1, 1, - 1, - 1, - 1, - 1, 1, - 1, - 1 ];\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tgeometry.setIndex( new BufferAttribute( indices, 1 ) );\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\n\t\tsuper( geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\n\t\tthis.box = box;\n\n\t\tthis.type = 'Box3Helper';\n\n\t\tthis.geometry.computeBoundingSphere();\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tconst box = this.box;\n\n\t\tif ( box.isEmpty() ) return;\n\n\t\tbox.getCenter( this.position );\n\n\t\tbox.getSize( this.scale );\n\n\t\tthis.scale.multiplyScalar( 0.5 );\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t}\n\n}\n\nclass PlaneHelper extends Line {\n\n\tconstructor( plane, size = 1, hex = 0xffff00 ) {\n\n\t\tconst color = hex;\n\n\t\tconst positions = [ 1, - 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, - 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0 ];\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\t\tgeometry.computeBoundingSphere();\n\n\t\tsuper( geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\n\t\tthis.type = 'PlaneHelper';\n\n\t\tthis.plane = plane;\n\n\t\tthis.size = size;\n\n\t\tconst positions2 = [ 1, 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, 1, 1, - 1, - 1, 1, 1, - 1, 1 ];\n\n\t\tconst geometry2 = new BufferGeometry();\n\t\tgeometry2.setAttribute( 'position', new Float32BufferAttribute( positions2, 3 ) );\n\t\tgeometry2.computeBoundingSphere();\n\n\t\tthis.add( new Mesh( geometry2, new MeshBasicMaterial( { color: color, opacity: 0.2, transparent: true, depthWrite: false, toneMapped: false } ) ) );\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tlet scale = - this.plane.constant;\n\n\t\tif ( Math.abs( scale ) < 1e-8 ) scale = 1e-8; // sign does not matter\n\n\t\tthis.scale.set( 0.5 * this.size, 0.5 * this.size, scale );\n\n\t\tthis.children[ 0 ].material.side = ( scale < 0 ) ? BackSide : FrontSide; // renderer flips side when determinant < 0; flipping not wanted here\n\n\t\tthis.lookAt( this.plane.normal );\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t}\n\n}\n\nconst _axis = /*@__PURE__*/ new Vector3();\nlet _lineGeometry, _coneGeometry;\n\nclass ArrowHelper extends Object3D {\n\n\t// dir is assumed to be normalized\n\n\tconstructor( dir = new Vector3( 0, 0, 1 ), origin = new Vector3( 0, 0, 0 ), length = 1, color = 0xffff00, headLength = length * 0.2, headWidth = headLength * 0.2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ArrowHelper';\n\n\t\tif ( _lineGeometry === undefined ) {\n\n\t\t\t_lineGeometry = new BufferGeometry();\n\t\t\t_lineGeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 0, 1, 0 ], 3 ) );\n\n\t\t\t_coneGeometry = new CylinderGeometry( 0, 0.5, 1, 5, 1 );\n\t\t\t_coneGeometry.translate( 0, - 0.5, 0 );\n\n\t\t}\n\n\t\tthis.position.copy( origin );\n\n\t\tthis.line = new Line( _lineGeometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\t\tthis.line.matrixAutoUpdate = false;\n\t\tthis.add( this.line );\n\n\t\tthis.cone = new Mesh( _coneGeometry, new MeshBasicMaterial( { color: color, toneMapped: false } ) );\n\t\tthis.cone.matrixAutoUpdate = false;\n\t\tthis.add( this.cone );\n\n\t\tthis.setDirection( dir );\n\t\tthis.setLength( length, headLength, headWidth );\n\n\t}\n\n\tsetDirection( dir ) {\n\n\t\t// dir is assumed to be normalized\n\n\t\tif ( dir.y > 0.99999 ) {\n\n\t\t\tthis.quaternion.set( 0, 0, 0, 1 );\n\n\t\t} else if ( dir.y < - 0.99999 ) {\n\n\t\t\tthis.quaternion.set( 1, 0, 0, 0 );\n\n\t\t} else {\n\n\t\t\t_axis.set( dir.z, 0, - dir.x ).normalize();\n\n\t\t\tconst radians = Math.acos( dir.y );\n\n\t\t\tthis.quaternion.setFromAxisAngle( _axis, radians );\n\n\t\t}\n\n\t}\n\n\tsetLength( length, headLength = length * 0.2, headWidth = headLength * 0.2 ) {\n\n\t\tthis.line.scale.set( 1, Math.max( 0.0001, length - headLength ), 1 ); // see #17458\n\t\tthis.line.updateMatrix();\n\n\t\tthis.cone.scale.set( headWidth, headLength, headWidth );\n\t\tthis.cone.position.y = length;\n\t\tthis.cone.updateMatrix();\n\n\t}\n\n\tsetColor( color ) {\n\n\t\tthis.line.material.color.set( color );\n\t\tthis.cone.material.color.set( color );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source, false );\n\n\t\tthis.line.copy( source.line );\n\t\tthis.cone.copy( source.cone );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass AxesHelper extends LineSegments {\n\n\tconstructor( size = 1 ) {\n\n\t\tconst vertices = [\n\t\t\t0, 0, 0,\tsize, 0, 0,\n\t\t\t0, 0, 0,\t0, size, 0,\n\t\t\t0, 0, 0,\t0, 0, size\n\t\t];\n\n\t\tconst colors = [\n\t\t\t1, 0, 0,\t1, 0.6, 0,\n\t\t\t0, 1, 0,\t0.6, 1, 0,\n\t\t\t0, 0, 1,\t0, 0.6, 1\n\t\t];\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'AxesHelper';\n\n\t}\n\n\tsetColors( xAxisColor, yAxisColor, zAxisColor ) {\n\n\t\tconst color = new Color();\n\t\tconst array = this.geometry.attributes.color.array;\n\n\t\tcolor.set( xAxisColor );\n\t\tcolor.toArray( array, 0 );\n\t\tcolor.toArray( array, 3 );\n\n\t\tcolor.set( yAxisColor );\n\t\tcolor.toArray( array, 6 );\n\t\tcolor.toArray( array, 9 );\n\n\t\tcolor.set( zAxisColor );\n\t\tcolor.toArray( array, 12 );\n\t\tcolor.toArray( array, 15 );\n\n\t\tthis.geometry.attributes.color.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nclass ShapePath {\n\n\tconstructor() {\n\n\t\tthis.type = 'ShapePath';\n\n\t\tthis.color = new Color();\n\n\t\tthis.subPaths = [];\n\t\tthis.currentPath = null;\n\n\t}\n\n\tmoveTo( x, y ) {\n\n\t\tthis.currentPath = new Path();\n\t\tthis.subPaths.push( this.currentPath );\n\t\tthis.currentPath.moveTo( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tlineTo( x, y ) {\n\n\t\tthis.currentPath.lineTo( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tquadraticCurveTo( aCPx, aCPy, aX, aY ) {\n\n\t\tthis.currentPath.quadraticCurveTo( aCPx, aCPy, aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tbezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\n\n\t\tthis.currentPath.bezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tsplineThru( pts ) {\n\n\t\tthis.currentPath.splineThru( pts );\n\n\t\treturn this;\n\n\t}\n\n\ttoShapes( isCCW, noHoles ) {\n\n\t\tfunction toShapesNoHoles( inSubpaths ) {\n\n\t\t\tconst shapes = [];\n\n\t\t\tfor ( let i = 0, l = inSubpaths.length; i < l; i ++ ) {\n\n\t\t\t\tconst tmpPath = inSubpaths[ i ];\n\n\t\t\t\tconst tmpShape = new Shape();\n\t\t\t\ttmpShape.curves = tmpPath.curves;\n\n\t\t\t\tshapes.push( tmpShape );\n\n\t\t\t}\n\n\t\t\treturn shapes;\n\n\t\t}\n\n\t\tfunction isPointInsidePolygon( inPt, inPolygon ) {\n\n\t\t\tconst polyLen = inPolygon.length;\n\n\t\t\t// inPt on polygon contour => immediate success    or\n\t\t\t// toggling of inside/outside at every single! intersection point of an edge\n\t\t\t//  with the horizontal line through inPt, left of inPt\n\t\t\t//  not counting lowerY endpoints of edges and whole edges on that line\n\t\t\tlet inside = false;\n\t\t\tfor ( let p = polyLen - 1, q = 0; q < polyLen; p = q ++ ) {\n\n\t\t\t\tlet edgeLowPt = inPolygon[ p ];\n\t\t\t\tlet edgeHighPt = inPolygon[ q ];\n\n\t\t\t\tlet edgeDx = edgeHighPt.x - edgeLowPt.x;\n\t\t\t\tlet edgeDy = edgeHighPt.y - edgeLowPt.y;\n\n\t\t\t\tif ( Math.abs( edgeDy ) > Number.EPSILON ) {\n\n\t\t\t\t\t// not parallel\n\t\t\t\t\tif ( edgeDy < 0 ) {\n\n\t\t\t\t\t\tedgeLowPt = inPolygon[ q ]; edgeDx = - edgeDx;\n\t\t\t\t\t\tedgeHighPt = inPolygon[ p ]; edgeDy = - edgeDy;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ( inPt.y < edgeLowPt.y ) || ( inPt.y > edgeHighPt.y ) ) \t\tcontinue;\n\n\t\t\t\t\tif ( inPt.y === edgeLowPt.y ) {\n\n\t\t\t\t\t\tif ( inPt.x === edgeLowPt.x )\t\treturn\ttrue;\t\t// inPt is on contour ?\n\t\t\t\t\t\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst perpEdge = edgeDy * ( inPt.x - edgeLowPt.x ) - edgeDx * ( inPt.y - edgeLowPt.y );\n\t\t\t\t\t\tif ( perpEdge === 0 )\t\t\t\treturn\ttrue;\t\t// inPt is on contour ?\n\t\t\t\t\t\tif ( perpEdge < 0 ) \t\t\t\tcontinue;\n\t\t\t\t\t\tinside = ! inside;\t\t// true intersection left of inPt\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// parallel or collinear\n\t\t\t\t\tif ( inPt.y !== edgeLowPt.y ) \t\tcontinue;\t\t\t// parallel\n\t\t\t\t\t// edge lies on the same horizontal line as inPt\n\t\t\t\t\tif ( ( ( edgeHighPt.x <= inPt.x ) && ( inPt.x <= edgeLowPt.x ) ) ||\n\t\t\t\t\t\t ( ( edgeLowPt.x <= inPt.x ) && ( inPt.x <= edgeHighPt.x ) ) )\t\treturn\ttrue;\t// inPt: Point on contour !\n\t\t\t\t\t// continue;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn\tinside;\n\n\t\t}\n\n\t\tconst isClockWise = ShapeUtils.isClockWise;\n\n\t\tconst subPaths = this.subPaths;\n\t\tif ( subPaths.length === 0 ) return [];\n\n\t\tif ( noHoles === true )\treturn\ttoShapesNoHoles( subPaths );\n\n\n\t\tlet solid, tmpPath, tmpShape;\n\t\tconst shapes = [];\n\n\t\tif ( subPaths.length === 1 ) {\n\n\t\t\ttmpPath = subPaths[ 0 ];\n\t\t\ttmpShape = new Shape();\n\t\t\ttmpShape.curves = tmpPath.curves;\n\t\t\tshapes.push( tmpShape );\n\t\t\treturn shapes;\n\n\t\t}\n\n\t\tlet holesFirst = ! isClockWise( subPaths[ 0 ].getPoints() );\n\t\tholesFirst = isCCW ? ! holesFirst : holesFirst;\n\n\t\t// console.log(\"Holes first\", holesFirst);\n\n\t\tconst betterShapeHoles = [];\n\t\tconst newShapes = [];\n\t\tlet newShapeHoles = [];\n\t\tlet mainIdx = 0;\n\t\tlet tmpPoints;\n\n\t\tnewShapes[ mainIdx ] = undefined;\n\t\tnewShapeHoles[ mainIdx ] = [];\n\n\t\tfor ( let i = 0, l = subPaths.length; i < l; i ++ ) {\n\n\t\t\ttmpPath = subPaths[ i ];\n\t\t\ttmpPoints = tmpPath.getPoints();\n\t\t\tsolid = isClockWise( tmpPoints );\n\t\t\tsolid = isCCW ? ! solid : solid;\n\n\t\t\tif ( solid ) {\n\n\t\t\t\tif ( ( ! holesFirst ) && ( newShapes[ mainIdx ] ) )\tmainIdx ++;\n\n\t\t\t\tnewShapes[ mainIdx ] = { s: new Shape(), p: tmpPoints };\n\t\t\t\tnewShapes[ mainIdx ].s.curves = tmpPath.curves;\n\n\t\t\t\tif ( holesFirst )\tmainIdx ++;\n\t\t\t\tnewShapeHoles[ mainIdx ] = [];\n\n\t\t\t\t//console.log('cw', i);\n\n\t\t\t} else {\n\n\t\t\t\tnewShapeHoles[ mainIdx ].push( { h: tmpPath, p: tmpPoints[ 0 ] } );\n\n\t\t\t\t//console.log('ccw', i);\n\n\t\t\t}\n\n\t\t}\n\n\t\t// only Holes? -> probably all Shapes with wrong orientation\n\t\tif ( ! newShapes[ 0 ] )\treturn\ttoShapesNoHoles( subPaths );\n\n\n\t\tif ( newShapes.length > 1 ) {\n\n\t\t\tlet ambiguous = false;\n\t\t\tconst toChange = [];\n\n\t\t\tfor ( let sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\n\n\t\t\t\tbetterShapeHoles[ sIdx ] = [];\n\n\t\t\t}\n\n\t\t\tfor ( let sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\n\n\t\t\t\tconst sho = newShapeHoles[ sIdx ];\n\n\t\t\t\tfor ( let hIdx = 0; hIdx < sho.length; hIdx ++ ) {\n\n\t\t\t\t\tconst ho = sho[ hIdx ];\n\t\t\t\t\tlet hole_unassigned = true;\n\n\t\t\t\t\tfor ( let s2Idx = 0; s2Idx < newShapes.length; s2Idx ++ ) {\n\n\t\t\t\t\t\tif ( isPointInsidePolygon( ho.p, newShapes[ s2Idx ].p ) ) {\n\n\t\t\t\t\t\t\tif ( sIdx !== s2Idx )\ttoChange.push( { froms: sIdx, tos: s2Idx, hole: hIdx } );\n\t\t\t\t\t\t\tif ( hole_unassigned ) {\n\n\t\t\t\t\t\t\t\thole_unassigned = false;\n\t\t\t\t\t\t\t\tbetterShapeHoles[ s2Idx ].push( ho );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tambiguous = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( hole_unassigned ) {\n\n\t\t\t\t\t\tbetterShapeHoles[ sIdx ].push( ho );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t\t// console.log(\"ambiguous: \", ambiguous);\n\n\t\t\tif ( toChange.length > 0 ) {\n\n\t\t\t\t// console.log(\"to change: \", toChange);\n\t\t\t\tif ( ! ambiguous )\tnewShapeHoles = betterShapeHoles;\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet tmpHoles;\n\n\t\tfor ( let i = 0, il = newShapes.length; i < il; i ++ ) {\n\n\t\t\ttmpShape = newShapes[ i ].s;\n\t\t\tshapes.push( tmpShape );\n\t\t\ttmpHoles = newShapeHoles[ i ];\n\n\t\t\tfor ( let j = 0, jl = tmpHoles.length; j < jl; j ++ ) {\n\n\t\t\t\ttmpShape.holes.push( tmpHoles[ j ].h );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//console.log(\"shape\", shapes);\n\n\t\treturn shapes;\n\n\t}\n\n}\n\nconst _floatView = new Float32Array( 1 );\nconst _int32View = new Int32Array( _floatView.buffer );\n\nclass DataUtils {\n\n\t// Converts float32 to float16 (stored as uint16 value).\n\n\tstatic toHalfFloat( val ) {\n\n\t\tif ( val > 65504 ) {\n\n\t\t\tconsole.warn( 'THREE.DataUtils.toHalfFloat(): value exceeds 65504.' );\n\n\t\t\tval = 65504; // maximum representable value in float16\n\n\t\t}\n\n\t\t// Source: http://gamedev.stackexchange.com/questions/17326/conversion-of-a-number-from-single-precision-floating-point-representation-to-a/17410#17410\n\n\t\t/* This method is faster than the OpenEXR implementation (very often\n\t\t* used, eg. in Ogre), with the additional benefit of rounding, inspired\n\t\t* by James Tursa?s half-precision code. */\n\n\t\t_floatView[ 0 ] = val;\n\t\tconst x = _int32View[ 0 ];\n\n\t\tlet bits = ( x >> 16 ) & 0x8000; /* Get the sign */\n\t\tlet m = ( x >> 12 ) & 0x07ff; /* Keep one extra bit for rounding */\n\t\tconst e = ( x >> 23 ) & 0xff; /* Using int is faster here */\n\n\t\t/* If zero, or denormal, or exponent underflows too much for a denormal\n\t\t\t* half, return signed zero. */\n\t\tif ( e < 103 ) return bits;\n\n\t\t/* If NaN, return NaN. If Inf or exponent overflow, return Inf. */\n\t\tif ( e > 142 ) {\n\n\t\t\tbits |= 0x7c00;\n\t\t\t/* If exponent was 0xff and one mantissa bit was set, it means NaN,\n\t\t\t\t\t\t* not Inf, so make sure we set one mantissa bit too. */\n\t\t\tbits |= ( ( e == 255 ) ? 0 : 1 ) && ( x & 0x007fffff );\n\t\t\treturn bits;\n\n\t\t}\n\n\t\t/* If exponent underflows but not too much, return a denormal */\n\t\tif ( e < 113 ) {\n\n\t\t\tm |= 0x0800;\n\t\t\t/* Extra rounding may overflow and set mantissa to 0 and exponent\n\t\t\t\t* to 1, which is OK. */\n\t\t\tbits |= ( m >> ( 114 - e ) ) + ( ( m >> ( 113 - e ) ) & 1 );\n\t\t\treturn bits;\n\n\t\t}\n\n\t\tbits |= ( ( e - 112 ) << 10 ) | ( m >> 1 );\n\t\t/* Extra rounding. An overflow will set mantissa to 0 and increment\n\t\t\t* the exponent, which is OK. */\n\t\tbits += m & 1;\n\t\treturn bits;\n\n\t}\n\n}\n\nconst LineStrip = 0;\nconst LinePieces = 1;\nconst NoColors = 0;\nconst FaceColors = 1;\nconst VertexColors = 2;\n\nfunction MeshFaceMaterial( materials ) {\n\n\tconsole.warn( 'THREE.MeshFaceMaterial has been removed. Use an Array instead.' );\n\treturn materials;\n\n}\n\nfunction MultiMaterial( materials = [] ) {\n\n\tconsole.warn( 'THREE.MultiMaterial has been removed. Use an Array instead.' );\n\tmaterials.isMultiMaterial = true;\n\tmaterials.materials = materials;\n\tmaterials.clone = function () {\n\n\t\treturn materials.slice();\n\n\t};\n\n\treturn materials;\n\n}\n\nfunction PointCloud( geometry, material ) {\n\n\tconsole.warn( 'THREE.PointCloud has been renamed to THREE.Points.' );\n\treturn new Points( geometry, material );\n\n}\n\nfunction Particle( material ) {\n\n\tconsole.warn( 'THREE.Particle has been renamed to THREE.Sprite.' );\n\treturn new Sprite( material );\n\n}\n\nfunction ParticleSystem( geometry, material ) {\n\n\tconsole.warn( 'THREE.ParticleSystem has been renamed to THREE.Points.' );\n\treturn new Points( geometry, material );\n\n}\n\nfunction PointCloudMaterial( parameters ) {\n\n\tconsole.warn( 'THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.' );\n\treturn new PointsMaterial( parameters );\n\n}\n\nfunction ParticleBasicMaterial( parameters ) {\n\n\tconsole.warn( 'THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.' );\n\treturn new PointsMaterial( parameters );\n\n}\n\nfunction ParticleSystemMaterial( parameters ) {\n\n\tconsole.warn( 'THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.' );\n\treturn new PointsMaterial( parameters );\n\n}\n\nfunction Vertex( x, y, z ) {\n\n\tconsole.warn( 'THREE.Vertex has been removed. Use THREE.Vector3 instead.' );\n\treturn new Vector3( x, y, z );\n\n}\n\n//\n\nfunction DynamicBufferAttribute( array, itemSize ) {\n\n\tconsole.warn( 'THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead.' );\n\treturn new BufferAttribute( array, itemSize ).setUsage( DynamicDrawUsage );\n\n}\n\nfunction Int8Attribute( array, itemSize ) {\n\n\tconsole.warn( 'THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.' );\n\treturn new Int8BufferAttribute( array, itemSize );\n\n}\n\nfunction Uint8Attribute( array, itemSize ) {\n\n\tconsole.warn( 'THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.' );\n\treturn new Uint8BufferAttribute( array, itemSize );\n\n}\n\nfunction Uint8ClampedAttribute( array, itemSize ) {\n\n\tconsole.warn( 'THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.' );\n\treturn new Uint8ClampedBufferAttribute( array, itemSize );\n\n}\n\nfunction Int16Attribute( array, itemSize ) {\n\n\tconsole.warn( 'THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.' );\n\treturn new Int16BufferAttribute( array, itemSize );\n\n}\n\nfunction Uint16Attribute( array, itemSize ) {\n\n\tconsole.warn( 'THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.' );\n\treturn new Uint16BufferAttribute( array, itemSize );\n\n}\n\nfunction Int32Attribute( array, itemSize ) {\n\n\tconsole.warn( 'THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.' );\n\treturn new Int32BufferAttribute( array, itemSize );\n\n}\n\nfunction Uint32Attribute( array, itemSize ) {\n\n\tconsole.warn( 'THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.' );\n\treturn new Uint32BufferAttribute( array, itemSize );\n\n}\n\nfunction Float32Attribute( array, itemSize ) {\n\n\tconsole.warn( 'THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.' );\n\treturn new Float32BufferAttribute( array, itemSize );\n\n}\n\nfunction Float64Attribute( array, itemSize ) {\n\n\tconsole.warn( 'THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.' );\n\treturn new Float64BufferAttribute( array, itemSize );\n\n}\n\n//\n\nCurve.create = function ( construct, getPoint ) {\n\n\tconsole.log( 'THREE.Curve.create() has been deprecated' );\n\n\tconstruct.prototype = Object.create( Curve.prototype );\n\tconstruct.prototype.constructor = construct;\n\tconstruct.prototype.getPoint = getPoint;\n\n\treturn construct;\n\n};\n\n//\n\nPath.prototype.fromPoints = function ( points ) {\n\n\tconsole.warn( 'THREE.Path: .fromPoints() has been renamed to .setFromPoints().' );\n\treturn this.setFromPoints( points );\n\n};\n\n//\n\nfunction AxisHelper( size ) {\n\n\tconsole.warn( 'THREE.AxisHelper has been renamed to THREE.AxesHelper.' );\n\treturn new AxesHelper( size );\n\n}\n\nfunction BoundingBoxHelper( object, color ) {\n\n\tconsole.warn( 'THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.' );\n\treturn new BoxHelper( object, color );\n\n}\n\nfunction EdgesHelper( object, hex ) {\n\n\tconsole.warn( 'THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.' );\n\treturn new LineSegments( new EdgesGeometry( object.geometry ), new LineBasicMaterial( { color: hex !== undefined ? hex : 0xffffff } ) );\n\n}\n\nGridHelper.prototype.setColors = function () {\n\n\tconsole.error( 'THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.' );\n\n};\n\nSkeletonHelper.prototype.update = function () {\n\n\tconsole.error( 'THREE.SkeletonHelper: update() no longer needs to be called.' );\n\n};\n\nfunction WireframeHelper( object, hex ) {\n\n\tconsole.warn( 'THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.' );\n\treturn new LineSegments( new WireframeGeometry( object.geometry ), new LineBasicMaterial( { color: hex !== undefined ? hex : 0xffffff } ) );\n\n}\n\n//\n\nLoader.prototype.extractUrlBase = function ( url ) {\n\n\tconsole.warn( 'THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.' );\n\treturn LoaderUtils.extractUrlBase( url );\n\n};\n\nLoader.Handlers = {\n\n\tadd: function ( /* regex, loader */ ) {\n\n\t\tconsole.error( 'THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.' );\n\n\t},\n\n\tget: function ( /* file */ ) {\n\n\t\tconsole.error( 'THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.' );\n\n\t}\n\n};\n\nfunction XHRLoader( manager ) {\n\n\tconsole.warn( 'THREE.XHRLoader has been renamed to THREE.FileLoader.' );\n\treturn new FileLoader( manager );\n\n}\n\nfunction BinaryTextureLoader( manager ) {\n\n\tconsole.warn( 'THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.' );\n\treturn new DataTextureLoader( manager );\n\n}\n\n//\n\nBox2.prototype.center = function ( optionalTarget ) {\n\n\tconsole.warn( 'THREE.Box2: .center() has been renamed to .getCenter().' );\n\treturn this.getCenter( optionalTarget );\n\n};\n\nBox2.prototype.empty = function () {\n\n\tconsole.warn( 'THREE.Box2: .empty() has been renamed to .isEmpty().' );\n\treturn this.isEmpty();\n\n};\n\nBox2.prototype.isIntersectionBox = function ( box ) {\n\n\tconsole.warn( 'THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().' );\n\treturn this.intersectsBox( box );\n\n};\n\nBox2.prototype.size = function ( optionalTarget ) {\n\n\tconsole.warn( 'THREE.Box2: .size() has been renamed to .getSize().' );\n\treturn this.getSize( optionalTarget );\n\n};\n\n//\n\nBox3.prototype.center = function ( optionalTarget ) {\n\n\tconsole.warn( 'THREE.Box3: .center() has been renamed to .getCenter().' );\n\treturn this.getCenter( optionalTarget );\n\n};\n\nBox3.prototype.empty = function () {\n\n\tconsole.warn( 'THREE.Box3: .empty() has been renamed to .isEmpty().' );\n\treturn this.isEmpty();\n\n};\n\nBox3.prototype.isIntersectionBox = function ( box ) {\n\n\tconsole.warn( 'THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().' );\n\treturn this.intersectsBox( box );\n\n};\n\nBox3.prototype.isIntersectionSphere = function ( sphere ) {\n\n\tconsole.warn( 'THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().' );\n\treturn this.intersectsSphere( sphere );\n\n};\n\nBox3.prototype.size = function ( optionalTarget ) {\n\n\tconsole.warn( 'THREE.Box3: .size() has been renamed to .getSize().' );\n\treturn this.getSize( optionalTarget );\n\n};\n\n//\n\nSphere.prototype.empty = function () {\n\n\tconsole.warn( 'THREE.Sphere: .empty() has been renamed to .isEmpty().' );\n\treturn this.isEmpty();\n\n};\n\n//\n\nFrustum.prototype.setFromMatrix = function ( m ) {\n\n\tconsole.warn( 'THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix().' );\n\treturn this.setFromProjectionMatrix( m );\n\n};\n\n//\n\nLine3.prototype.center = function ( optionalTarget ) {\n\n\tconsole.warn( 'THREE.Line3: .center() has been renamed to .getCenter().' );\n\treturn this.getCenter( optionalTarget );\n\n};\n\n//\n\nMatrix3.prototype.flattenToArrayOffset = function ( array, offset ) {\n\n\tconsole.warn( 'THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.' );\n\treturn this.toArray( array, offset );\n\n};\n\nMatrix3.prototype.multiplyVector3 = function ( vector ) {\n\n\tconsole.warn( 'THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.' );\n\treturn vector.applyMatrix3( this );\n\n};\n\nMatrix3.prototype.multiplyVector3Array = function ( /* a */ ) {\n\n\tconsole.error( 'THREE.Matrix3: .multiplyVector3Array() has been removed.' );\n\n};\n\nMatrix3.prototype.applyToBufferAttribute = function ( attribute ) {\n\n\tconsole.warn( 'THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead.' );\n\treturn attribute.applyMatrix3( this );\n\n};\n\nMatrix3.prototype.applyToVector3Array = function ( /* array, offset, length */ ) {\n\n\tconsole.error( 'THREE.Matrix3: .applyToVector3Array() has been removed.' );\n\n};\n\nMatrix3.prototype.getInverse = function ( matrix ) {\n\n\tconsole.warn( 'THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead.' );\n\treturn this.copy( matrix ).invert();\n\n};\n\n//\n\nMatrix4.prototype.extractPosition = function ( m ) {\n\n\tconsole.warn( 'THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().' );\n\treturn this.copyPosition( m );\n\n};\n\nMatrix4.prototype.flattenToArrayOffset = function ( array, offset ) {\n\n\tconsole.warn( 'THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.' );\n\treturn this.toArray( array, offset );\n\n};\n\nMatrix4.prototype.getPosition = function () {\n\n\tconsole.warn( 'THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.' );\n\treturn new Vector3().setFromMatrixColumn( this, 3 );\n\n};\n\nMatrix4.prototype.setRotationFromQuaternion = function ( q ) {\n\n\tconsole.warn( 'THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().' );\n\treturn this.makeRotationFromQuaternion( q );\n\n};\n\nMatrix4.prototype.multiplyToArray = function () {\n\n\tconsole.warn( 'THREE.Matrix4: .multiplyToArray() has been removed.' );\n\n};\n\nMatrix4.prototype.multiplyVector3 = function ( vector ) {\n\n\tconsole.warn( 'THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\n\treturn vector.applyMatrix4( this );\n\n};\n\nMatrix4.prototype.multiplyVector4 = function ( vector ) {\n\n\tconsole.warn( 'THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\n\treturn vector.applyMatrix4( this );\n\n};\n\nMatrix4.prototype.multiplyVector3Array = function ( /* a */ ) {\n\n\tconsole.error( 'THREE.Matrix4: .multiplyVector3Array() has been removed.' );\n\n};\n\nMatrix4.prototype.rotateAxis = function ( v ) {\n\n\tconsole.warn( 'THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.' );\n\tv.transformDirection( this );\n\n};\n\nMatrix4.prototype.crossVector = function ( vector ) {\n\n\tconsole.warn( 'THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\n\treturn vector.applyMatrix4( this );\n\n};\n\nMatrix4.prototype.translate = function () {\n\n\tconsole.error( 'THREE.Matrix4: .translate() has been removed.' );\n\n};\n\nMatrix4.prototype.rotateX = function () {\n\n\tconsole.error( 'THREE.Matrix4: .rotateX() has been removed.' );\n\n};\n\nMatrix4.prototype.rotateY = function () {\n\n\tconsole.error( 'THREE.Matrix4: .rotateY() has been removed.' );\n\n};\n\nMatrix4.prototype.rotateZ = function () {\n\n\tconsole.error( 'THREE.Matrix4: .rotateZ() has been removed.' );\n\n};\n\nMatrix4.prototype.rotateByAxis = function () {\n\n\tconsole.error( 'THREE.Matrix4: .rotateByAxis() has been removed.' );\n\n};\n\nMatrix4.prototype.applyToBufferAttribute = function ( attribute ) {\n\n\tconsole.warn( 'THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead.' );\n\treturn attribute.applyMatrix4( this );\n\n};\n\nMatrix4.prototype.applyToVector3Array = function ( /* array, offset, length */ ) {\n\n\tconsole.error( 'THREE.Matrix4: .applyToVector3Array() has been removed.' );\n\n};\n\nMatrix4.prototype.makeFrustum = function ( left, right, bottom, top, near, far ) {\n\n\tconsole.warn( 'THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.' );\n\treturn this.makePerspective( left, right, top, bottom, near, far );\n\n};\n\nMatrix4.prototype.getInverse = function ( matrix ) {\n\n\tconsole.warn( 'THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead.' );\n\treturn this.copy( matrix ).invert();\n\n};\n\n//\n\nPlane.prototype.isIntersectionLine = function ( line ) {\n\n\tconsole.warn( 'THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().' );\n\treturn this.intersectsLine( line );\n\n};\n\n//\n\nQuaternion.prototype.multiplyVector3 = function ( vector ) {\n\n\tconsole.warn( 'THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.' );\n\treturn vector.applyQuaternion( this );\n\n};\n\nQuaternion.prototype.inverse = function ( ) {\n\n\tconsole.warn( 'THREE.Quaternion: .inverse() has been renamed to invert().' );\n\treturn this.invert();\n\n};\n\n//\n\nRay.prototype.isIntersectionBox = function ( box ) {\n\n\tconsole.warn( 'THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().' );\n\treturn this.intersectsBox( box );\n\n};\n\nRay.prototype.isIntersectionPlane = function ( plane ) {\n\n\tconsole.warn( 'THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().' );\n\treturn this.intersectsPlane( plane );\n\n};\n\nRay.prototype.isIntersectionSphere = function ( sphere ) {\n\n\tconsole.warn( 'THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().' );\n\treturn this.intersectsSphere( sphere );\n\n};\n\n//\n\nTriangle.prototype.area = function () {\n\n\tconsole.warn( 'THREE.Triangle: .area() has been renamed to .getArea().' );\n\treturn this.getArea();\n\n};\n\nTriangle.prototype.barycoordFromPoint = function ( point, target ) {\n\n\tconsole.warn( 'THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().' );\n\treturn this.getBarycoord( point, target );\n\n};\n\nTriangle.prototype.midpoint = function ( target ) {\n\n\tconsole.warn( 'THREE.Triangle: .midpoint() has been renamed to .getMidpoint().' );\n\treturn this.getMidpoint( target );\n\n};\n\nTriangle.prototypenormal = function ( target ) {\n\n\tconsole.warn( 'THREE.Triangle: .normal() has been renamed to .getNormal().' );\n\treturn this.getNormal( target );\n\n};\n\nTriangle.prototype.plane = function ( target ) {\n\n\tconsole.warn( 'THREE.Triangle: .plane() has been renamed to .getPlane().' );\n\treturn this.getPlane( target );\n\n};\n\nTriangle.barycoordFromPoint = function ( point, a, b, c, target ) {\n\n\tconsole.warn( 'THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().' );\n\treturn Triangle.getBarycoord( point, a, b, c, target );\n\n};\n\nTriangle.normal = function ( a, b, c, target ) {\n\n\tconsole.warn( 'THREE.Triangle: .normal() has been renamed to .getNormal().' );\n\treturn Triangle.getNormal( a, b, c, target );\n\n};\n\n//\n\nShape.prototype.extractAllPoints = function ( divisions ) {\n\n\tconsole.warn( 'THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.' );\n\treturn this.extractPoints( divisions );\n\n};\n\nShape.prototype.extrude = function ( options ) {\n\n\tconsole.warn( 'THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.' );\n\treturn new ExtrudeGeometry( this, options );\n\n};\n\nShape.prototype.makeGeometry = function ( options ) {\n\n\tconsole.warn( 'THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.' );\n\treturn new ShapeGeometry( this, options );\n\n};\n\n//\n\nVector2.prototype.fromAttribute = function ( attribute, index, offset ) {\n\n\tconsole.warn( 'THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().' );\n\treturn this.fromBufferAttribute( attribute, index, offset );\n\n};\n\nVector2.prototype.distanceToManhattan = function ( v ) {\n\n\tconsole.warn( 'THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().' );\n\treturn this.manhattanDistanceTo( v );\n\n};\n\nVector2.prototype.lengthManhattan = function () {\n\n\tconsole.warn( 'THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().' );\n\treturn this.manhattanLength();\n\n};\n\n//\n\nVector3.prototype.setEulerFromRotationMatrix = function () {\n\n\tconsole.error( 'THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.' );\n\n};\n\nVector3.prototype.setEulerFromQuaternion = function () {\n\n\tconsole.error( 'THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.' );\n\n};\n\nVector3.prototype.getPositionFromMatrix = function ( m ) {\n\n\tconsole.warn( 'THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().' );\n\treturn this.setFromMatrixPosition( m );\n\n};\n\nVector3.prototype.getScaleFromMatrix = function ( m ) {\n\n\tconsole.warn( 'THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().' );\n\treturn this.setFromMatrixScale( m );\n\n};\n\nVector3.prototype.getColumnFromMatrix = function ( index, matrix ) {\n\n\tconsole.warn( 'THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().' );\n\treturn this.setFromMatrixColumn( matrix, index );\n\n};\n\nVector3.prototype.applyProjection = function ( m ) {\n\n\tconsole.warn( 'THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.' );\n\treturn this.applyMatrix4( m );\n\n};\n\nVector3.prototype.fromAttribute = function ( attribute, index, offset ) {\n\n\tconsole.warn( 'THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().' );\n\treturn this.fromBufferAttribute( attribute, index, offset );\n\n};\n\nVector3.prototype.distanceToManhattan = function ( v ) {\n\n\tconsole.warn( 'THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().' );\n\treturn this.manhattanDistanceTo( v );\n\n};\n\nVector3.prototype.lengthManhattan = function () {\n\n\tconsole.warn( 'THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().' );\n\treturn this.manhattanLength();\n\n};\n\n//\n\nVector4.prototype.fromAttribute = function ( attribute, index, offset ) {\n\n\tconsole.warn( 'THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().' );\n\treturn this.fromBufferAttribute( attribute, index, offset );\n\n};\n\nVector4.prototype.lengthManhattan = function () {\n\n\tconsole.warn( 'THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().' );\n\treturn this.manhattanLength();\n\n};\n\n//\n\nObject3D.prototype.getChildByName = function ( name ) {\n\n\tconsole.warn( 'THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().' );\n\treturn this.getObjectByName( name );\n\n};\n\nObject3D.prototype.renderDepth = function () {\n\n\tconsole.warn( 'THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.' );\n\n};\n\nObject3D.prototype.translate = function ( distance, axis ) {\n\n\tconsole.warn( 'THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.' );\n\treturn this.translateOnAxis( axis, distance );\n\n};\n\nObject3D.prototype.getWorldRotation = function () {\n\n\tconsole.error( 'THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.' );\n\n};\n\nObject3D.prototype.applyMatrix = function ( matrix ) {\n\n\tconsole.warn( 'THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4().' );\n\treturn this.applyMatrix4( matrix );\n\n};\n\nObject.defineProperties( Object3D.prototype, {\n\n\teulerOrder: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\n\t\t\treturn this.rotation.order;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\n\t\t\tthis.rotation.order = value;\n\n\t\t}\n\t},\n\tuseQuaternion: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\n\n\t\t},\n\t\tset: function () {\n\n\t\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\n\n\t\t}\n\t}\n\n} );\n\nMesh.prototype.setDrawMode = function () {\n\n\tconsole.error( 'THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.' );\n\n};\n\nObject.defineProperties( Mesh.prototype, {\n\n\tdrawMode: {\n\t\tget: function () {\n\n\t\t\tconsole.error( 'THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode.' );\n\t\t\treturn TrianglesDrawMode;\n\n\t\t},\n\t\tset: function () {\n\n\t\t\tconsole.error( 'THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.' );\n\n\t\t}\n\t}\n\n} );\n\nSkinnedMesh.prototype.initBones = function () {\n\n\tconsole.error( 'THREE.SkinnedMesh: initBones() has been removed.' );\n\n};\n\n//\n\nPerspectiveCamera.prototype.setLens = function ( focalLength, filmGauge ) {\n\n\tconsole.warn( 'THREE.PerspectiveCamera.setLens is deprecated. ' +\n\t\t\t'Use .setFocalLength and .filmGauge for a photographic setup.' );\n\n\tif ( filmGauge !== undefined ) this.filmGauge = filmGauge;\n\tthis.setFocalLength( focalLength );\n\n};\n\n//\n\nObject.defineProperties( Light.prototype, {\n\tonlyShadow: {\n\t\tset: function () {\n\n\t\t\tconsole.warn( 'THREE.Light: .onlyShadow has been removed.' );\n\n\t\t}\n\t},\n\tshadowCameraFov: {\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraFov is now .shadow.camera.fov.' );\n\t\t\tthis.shadow.camera.fov = value;\n\n\t\t}\n\t},\n\tshadowCameraLeft: {\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraLeft is now .shadow.camera.left.' );\n\t\t\tthis.shadow.camera.left = value;\n\n\t\t}\n\t},\n\tshadowCameraRight: {\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraRight is now .shadow.camera.right.' );\n\t\t\tthis.shadow.camera.right = value;\n\n\t\t}\n\t},\n\tshadowCameraTop: {\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraTop is now .shadow.camera.top.' );\n\t\t\tthis.shadow.camera.top = value;\n\n\t\t}\n\t},\n\tshadowCameraBottom: {\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.' );\n\t\t\tthis.shadow.camera.bottom = value;\n\n\t\t}\n\t},\n\tshadowCameraNear: {\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraNear is now .shadow.camera.near.' );\n\t\t\tthis.shadow.camera.near = value;\n\n\t\t}\n\t},\n\tshadowCameraFar: {\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraFar is now .shadow.camera.far.' );\n\t\t\tthis.shadow.camera.far = value;\n\n\t\t}\n\t},\n\tshadowCameraVisible: {\n\t\tset: function () {\n\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.' );\n\n\t\t}\n\t},\n\tshadowBias: {\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.Light: .shadowBias is now .shadow.bias.' );\n\t\t\tthis.shadow.bias = value;\n\n\t\t}\n\t},\n\tshadowDarkness: {\n\t\tset: function () {\n\n\t\t\tconsole.warn( 'THREE.Light: .shadowDarkness has been removed.' );\n\n\t\t}\n\t},\n\tshadowMapWidth: {\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.' );\n\t\t\tthis.shadow.mapSize.width = value;\n\n\t\t}\n\t},\n\tshadowMapHeight: {\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.' );\n\t\t\tthis.shadow.mapSize.height = value;\n\n\t\t}\n\t}\n} );\n\n//\n\nObject.defineProperties( BufferAttribute.prototype, {\n\n\tlength: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.BufferAttribute: .length has been deprecated. Use .count instead.' );\n\t\t\treturn this.array.length;\n\n\t\t}\n\t},\n\tdynamic: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead.' );\n\t\t\treturn this.usage === DynamicDrawUsage;\n\n\t\t},\n\t\tset: function ( /* value */ ) {\n\n\t\t\tconsole.warn( 'THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead.' );\n\t\t\tthis.setUsage( DynamicDrawUsage );\n\n\t\t}\n\t}\n\n} );\n\nBufferAttribute.prototype.setDynamic = function ( value ) {\n\n\tconsole.warn( 'THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead.' );\n\tthis.setUsage( value === true ? DynamicDrawUsage : StaticDrawUsage );\n\treturn this;\n\n};\n\nBufferAttribute.prototype.copyIndicesArray = function ( /* indices */ ) {\n\n\tconsole.error( 'THREE.BufferAttribute: .copyIndicesArray() has been removed.' );\n\n},\n\nBufferAttribute.prototype.setArray = function ( /* array */ ) {\n\n\tconsole.error( 'THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers' );\n\n};\n\n//\n\nBufferGeometry.prototype.addIndex = function ( index ) {\n\n\tconsole.warn( 'THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().' );\n\tthis.setIndex( index );\n\n};\n\nBufferGeometry.prototype.addAttribute = function ( name, attribute ) {\n\n\tconsole.warn( 'THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute().' );\n\n\tif ( ! ( attribute && attribute.isBufferAttribute ) && ! ( attribute && attribute.isInterleavedBufferAttribute ) ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).' );\n\n\t\treturn this.setAttribute( name, new BufferAttribute( arguments[ 1 ], arguments[ 2 ] ) );\n\n\t}\n\n\tif ( name === 'index' ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.' );\n\t\tthis.setIndex( attribute );\n\n\t\treturn this;\n\n\t}\n\n\treturn this.setAttribute( name, attribute );\n\n};\n\nBufferGeometry.prototype.addDrawCall = function ( start, count, indexOffset ) {\n\n\tif ( indexOffset !== undefined ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.' );\n\n\t}\n\n\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() is now .addGroup().' );\n\tthis.addGroup( start, count );\n\n};\n\nBufferGeometry.prototype.clearDrawCalls = function () {\n\n\tconsole.warn( 'THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().' );\n\tthis.clearGroups();\n\n};\n\nBufferGeometry.prototype.computeOffsets = function () {\n\n\tconsole.warn( 'THREE.BufferGeometry: .computeOffsets() has been removed.' );\n\n};\n\nBufferGeometry.prototype.removeAttribute = function ( name ) {\n\n\tconsole.warn( 'THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute().' );\n\n\treturn this.deleteAttribute( name );\n\n};\n\nBufferGeometry.prototype.applyMatrix = function ( matrix ) {\n\n\tconsole.warn( 'THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4().' );\n\treturn this.applyMatrix4( matrix );\n\n};\n\nObject.defineProperties( BufferGeometry.prototype, {\n\n\tdrawcalls: {\n\t\tget: function () {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry: .drawcalls has been renamed to .groups.' );\n\t\t\treturn this.groups;\n\n\t\t}\n\t},\n\toffsets: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .offsets has been renamed to .groups.' );\n\t\t\treturn this.groups;\n\n\t\t}\n\t}\n\n} );\n\nInterleavedBuffer.prototype.setDynamic = function ( value ) {\n\n\tconsole.warn( 'THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead.' );\n\tthis.setUsage( value === true ? DynamicDrawUsage : StaticDrawUsage );\n\treturn this;\n\n};\n\nInterleavedBuffer.prototype.setArray = function ( /* array */ ) {\n\n\tconsole.error( 'THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers' );\n\n};\n\n//\n\nExtrudeGeometry.prototype.getArrays = function () {\n\n\tconsole.error( 'THREE.ExtrudeGeometry: .getArrays() has been removed.' );\n\n};\n\nExtrudeGeometry.prototype.addShapeList = function () {\n\n\tconsole.error( 'THREE.ExtrudeGeometry: .addShapeList() has been removed.' );\n\n};\n\nExtrudeGeometry.prototype.addShape = function () {\n\n\tconsole.error( 'THREE.ExtrudeGeometry: .addShape() has been removed.' );\n\n};\n\n//\n\nScene.prototype.dispose = function () {\n\n\tconsole.error( 'THREE.Scene: .dispose() has been removed.' );\n\n};\n\n//\n\nUniform.prototype.onUpdate = function () {\n\n\tconsole.warn( 'THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.' );\n\treturn this;\n\n};\n\n//\n\nObject.defineProperties( Material.prototype, {\n\n\twrapAround: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.Material: .wrapAround has been removed.' );\n\n\t\t},\n\t\tset: function () {\n\n\t\t\tconsole.warn( 'THREE.Material: .wrapAround has been removed.' );\n\n\t\t}\n\t},\n\n\toverdraw: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.Material: .overdraw has been removed.' );\n\n\t\t},\n\t\tset: function () {\n\n\t\t\tconsole.warn( 'THREE.Material: .overdraw has been removed.' );\n\n\t\t}\n\t},\n\n\twrapRGB: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.Material: .wrapRGB has been removed.' );\n\t\t\treturn new Color();\n\n\t\t}\n\t},\n\n\tshading: {\n\t\tget: function () {\n\n\t\t\tconsole.error( 'THREE.' + this.type + ': .shading has been removed. Use the boolean .flatShading instead.' );\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.' + this.type + ': .shading has been removed. Use the boolean .flatShading instead.' );\n\t\t\tthis.flatShading = ( value === FlatShading );\n\n\t\t}\n\t},\n\n\tstencilMask: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.' + this.type + ': .stencilMask has been removed. Use .stencilFuncMask instead.' );\n\t\t\treturn this.stencilFuncMask;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.' + this.type + ': .stencilMask has been removed. Use .stencilFuncMask instead.' );\n\t\t\tthis.stencilFuncMask = value;\n\n\t\t}\n\t},\n\n\tvertexTangents: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.' + this.type + ': .vertexTangents has been removed.' );\n\n\t\t},\n\t\tset: function () {\n\n\t\t\tconsole.warn( 'THREE.' + this.type + ': .vertexTangents has been removed.' );\n\n\t\t}\n\t},\n\n} );\n\nObject.defineProperties( ShaderMaterial.prototype, {\n\n\tderivatives: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.' );\n\t\t\treturn this.extensions.derivatives;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.' );\n\t\t\tthis.extensions.derivatives = value;\n\n\t\t}\n\t}\n\n} );\n\n//\n\nWebGLRenderer.prototype.clearTarget = function ( renderTarget, color, depth, stencil ) {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead.' );\n\tthis.setRenderTarget( renderTarget );\n\tthis.clear( color, depth, stencil );\n\n};\n\nWebGLRenderer.prototype.animate = function ( callback ) {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .animate() is now .setAnimationLoop().' );\n\tthis.setAnimationLoop( callback );\n\n};\n\nWebGLRenderer.prototype.getCurrentRenderTarget = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().' );\n\treturn this.getRenderTarget();\n\n};\n\nWebGLRenderer.prototype.getMaxAnisotropy = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().' );\n\treturn this.capabilities.getMaxAnisotropy();\n\n};\n\nWebGLRenderer.prototype.getPrecision = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.' );\n\treturn this.capabilities.precision;\n\n};\n\nWebGLRenderer.prototype.resetGLState = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .resetGLState() is now .state.reset().' );\n\treturn this.state.reset();\n\n};\n\nWebGLRenderer.prototype.supportsFloatTextures = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \\'OES_texture_float\\' ).' );\n\treturn this.extensions.get( 'OES_texture_float' );\n\n};\n\nWebGLRenderer.prototype.supportsHalfFloatTextures = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \\'OES_texture_half_float\\' ).' );\n\treturn this.extensions.get( 'OES_texture_half_float' );\n\n};\n\nWebGLRenderer.prototype.supportsStandardDerivatives = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \\'OES_standard_derivatives\\' ).' );\n\treturn this.extensions.get( 'OES_standard_derivatives' );\n\n};\n\nWebGLRenderer.prototype.supportsCompressedTextureS3TC = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \\'WEBGL_compressed_texture_s3tc\\' ).' );\n\treturn this.extensions.get( 'WEBGL_compressed_texture_s3tc' );\n\n};\n\nWebGLRenderer.prototype.supportsCompressedTexturePVRTC = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \\'WEBGL_compressed_texture_pvrtc\\' ).' );\n\treturn this.extensions.get( 'WEBGL_compressed_texture_pvrtc' );\n\n};\n\nWebGLRenderer.prototype.supportsBlendMinMax = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \\'EXT_blend_minmax\\' ).' );\n\treturn this.extensions.get( 'EXT_blend_minmax' );\n\n};\n\nWebGLRenderer.prototype.supportsVertexTextures = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.' );\n\treturn this.capabilities.vertexTextures;\n\n};\n\nWebGLRenderer.prototype.supportsInstancedArrays = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \\'ANGLE_instanced_arrays\\' ).' );\n\treturn this.extensions.get( 'ANGLE_instanced_arrays' );\n\n};\n\nWebGLRenderer.prototype.enableScissorTest = function ( boolean ) {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().' );\n\tthis.setScissorTest( boolean );\n\n};\n\nWebGLRenderer.prototype.initMaterial = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .initMaterial() has been removed.' );\n\n};\n\nWebGLRenderer.prototype.addPrePlugin = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .addPrePlugin() has been removed.' );\n\n};\n\nWebGLRenderer.prototype.addPostPlugin = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .addPostPlugin() has been removed.' );\n\n};\n\nWebGLRenderer.prototype.updateShadowMap = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .updateShadowMap() has been removed.' );\n\n};\n\nWebGLRenderer.prototype.setFaceCulling = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .setFaceCulling() has been removed.' );\n\n};\n\nWebGLRenderer.prototype.allocTextureUnit = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .allocTextureUnit() has been removed.' );\n\n};\n\nWebGLRenderer.prototype.setTexture = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .setTexture() has been removed.' );\n\n};\n\nWebGLRenderer.prototype.setTexture2D = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .setTexture2D() has been removed.' );\n\n};\n\nWebGLRenderer.prototype.setTextureCube = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .setTextureCube() has been removed.' );\n\n};\n\nWebGLRenderer.prototype.getActiveMipMapLevel = function () {\n\n\tconsole.warn( 'THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel().' );\n\treturn this.getActiveMipmapLevel();\n\n};\n\nObject.defineProperties( WebGLRenderer.prototype, {\n\n\tshadowMapEnabled: {\n\t\tget: function () {\n\n\t\t\treturn this.shadowMap.enabled;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.' );\n\t\t\tthis.shadowMap.enabled = value;\n\n\t\t}\n\t},\n\tshadowMapType: {\n\t\tget: function () {\n\n\t\t\treturn this.shadowMap.type;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.' );\n\t\t\tthis.shadowMap.type = value;\n\n\t\t}\n\t},\n\tshadowMapCullFace: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.' );\n\t\t\treturn undefined;\n\n\t\t},\n\t\tset: function ( /* value */ ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.' );\n\n\t\t}\n\t},\n\tcontext: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .context has been removed. Use .getContext() instead.' );\n\t\t\treturn this.getContext();\n\n\t\t}\n\t},\n\tvr: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .vr has been renamed to .xr' );\n\t\t\treturn this.xr;\n\n\t\t}\n\t},\n\tgammaInput: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.' );\n\t\t\treturn false;\n\n\t\t},\n\t\tset: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.' );\n\n\t\t}\n\t},\n\tgammaOutput: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead.' );\n\t\t\treturn false;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead.' );\n\t\t\tthis.outputEncoding = ( value === true ) ? sRGBEncoding : LinearEncoding;\n\n\t\t}\n\t},\n\ttoneMappingWhitePoint: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.' );\n\t\t\treturn 1.0;\n\n\t\t},\n\t\tset: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.' );\n\n\t\t}\n\t},\n\tgammaFactor: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .gammaFactor has been removed.' );\n\t\t\treturn 2;\n\n\t\t},\n\t\tset: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .gammaFactor has been removed.' );\n\n\t\t}\n\t}\n} );\n\nObject.defineProperties( WebGLShadowMap.prototype, {\n\n\tcullFace: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.' );\n\t\t\treturn undefined;\n\n\t\t},\n\t\tset: function ( /* cullFace */ ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.' );\n\n\t\t}\n\t},\n\trenderReverseSided: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.' );\n\t\t\treturn undefined;\n\n\t\t},\n\t\tset: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.' );\n\n\t\t}\n\t},\n\trenderSingleSided: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.' );\n\t\t\treturn undefined;\n\n\t\t},\n\t\tset: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.' );\n\n\t\t}\n\t}\n\n} );\n\nfunction WebGLRenderTargetCube( width, height, options ) {\n\n\tconsole.warn( 'THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options ).' );\n\treturn new WebGLCubeRenderTarget( width, options );\n\n}\n\n//\n\nObject.defineProperties( WebGLRenderTarget.prototype, {\n\n\twrapS: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\n\t\t\treturn this.texture.wrapS;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\n\t\t\tthis.texture.wrapS = value;\n\n\t\t}\n\t},\n\twrapT: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\n\t\t\treturn this.texture.wrapT;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\n\t\t\tthis.texture.wrapT = value;\n\n\t\t}\n\t},\n\tmagFilter: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\n\t\t\treturn this.texture.magFilter;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\n\t\t\tthis.texture.magFilter = value;\n\n\t\t}\n\t},\n\tminFilter: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\n\t\t\treturn this.texture.minFilter;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\n\t\t\tthis.texture.minFilter = value;\n\n\t\t}\n\t},\n\tanisotropy: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\n\t\t\treturn this.texture.anisotropy;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\n\t\t\tthis.texture.anisotropy = value;\n\n\t\t}\n\t},\n\toffset: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\n\t\t\treturn this.texture.offset;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\n\t\t\tthis.texture.offset = value;\n\n\t\t}\n\t},\n\trepeat: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\n\t\t\treturn this.texture.repeat;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\n\t\t\tthis.texture.repeat = value;\n\n\t\t}\n\t},\n\tformat: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\n\t\t\treturn this.texture.format;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\n\t\t\tthis.texture.format = value;\n\n\t\t}\n\t},\n\ttype: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\n\t\t\treturn this.texture.type;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\n\t\t\tthis.texture.type = value;\n\n\t\t}\n\t},\n\tgenerateMipmaps: {\n\t\tget: function () {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\n\t\t\treturn this.texture.generateMipmaps;\n\n\t\t},\n\t\tset: function ( value ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\n\t\t\tthis.texture.generateMipmaps = value;\n\n\t\t}\n\t}\n\n} );\n\n//\n\nAudio.prototype.load = function ( file ) {\n\n\tconsole.warn( 'THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.' );\n\tconst scope = this;\n\tconst audioLoader = new AudioLoader();\n\taudioLoader.load( file, function ( buffer ) {\n\n\t\tscope.setBuffer( buffer );\n\n\t} );\n\treturn this;\n\n};\n\n\nAudioAnalyser.prototype.getData = function () {\n\n\tconsole.warn( 'THREE.AudioAnalyser: .getData() is now .getFrequencyData().' );\n\treturn this.getFrequencyData();\n\n};\n\n//\n\nCubeCamera.prototype.updateCubeMap = function ( renderer, scene ) {\n\n\tconsole.warn( 'THREE.CubeCamera: .updateCubeMap() is now .update().' );\n\treturn this.update( renderer, scene );\n\n};\n\nCubeCamera.prototype.clear = function ( renderer, color, depth, stencil ) {\n\n\tconsole.warn( 'THREE.CubeCamera: .clear() is now .renderTarget.clear().' );\n\treturn this.renderTarget.clear( renderer, color, depth, stencil );\n\n};\n\nImageUtils.crossOrigin = undefined;\n\nImageUtils.loadTexture = function ( url, mapping, onLoad, onError ) {\n\n\tconsole.warn( 'THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.' );\n\n\tconst loader = new TextureLoader();\n\tloader.setCrossOrigin( this.crossOrigin );\n\n\tconst texture = loader.load( url, onLoad, undefined, onError );\n\n\tif ( mapping ) texture.mapping = mapping;\n\n\treturn texture;\n\n};\n\nImageUtils.loadTextureCube = function ( urls, mapping, onLoad, onError ) {\n\n\tconsole.warn( 'THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.' );\n\n\tconst loader = new CubeTextureLoader();\n\tloader.setCrossOrigin( this.crossOrigin );\n\n\tconst texture = loader.load( urls, onLoad, undefined, onError );\n\n\tif ( mapping ) texture.mapping = mapping;\n\n\treturn texture;\n\n};\n\nImageUtils.loadCompressedTexture = function () {\n\n\tconsole.error( 'THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.' );\n\n};\n\nImageUtils.loadCompressedTextureCube = function () {\n\n\tconsole.error( 'THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.' );\n\n};\n\n//\n\nfunction CanvasRenderer() {\n\n\tconsole.error( 'THREE.CanvasRenderer has been removed' );\n\n}\n\n//\n\nfunction JSONLoader() {\n\n\tconsole.error( 'THREE.JSONLoader has been removed.' );\n\n}\n\n//\n\nconst SceneUtils = {\n\n\tcreateMultiMaterialObject: function ( /* geometry, materials */ ) {\n\n\t\tconsole.error( 'THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js' );\n\n\t},\n\n\tdetach: function ( /* child, parent, scene */ ) {\n\n\t\tconsole.error( 'THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js' );\n\n\t},\n\n\tattach: function ( /* child, scene, parent */ ) {\n\n\t\tconsole.error( 'THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js' );\n\n\t}\n\n};\n\n//\n\nfunction LensFlare() {\n\n\tconsole.error( 'THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js' );\n\n}\n\n//\n\nfunction ParametricGeometry() {\n\n\tconsole.error( 'THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js' );\n\treturn new BufferGeometry();\n\n}\n\nfunction TextGeometry() {\n\n\tconsole.error( 'THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js' );\n\treturn new BufferGeometry();\n\n}\n\nfunction FontLoader() {\n\n\tconsole.error( 'THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js' );\n\n}\n\nfunction Font() {\n\n\tconsole.error( 'THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js' );\n\n}\n\nfunction ImmediateRenderObject() {\n\n\tconsole.error( 'THREE.ImmediateRenderObject has been removed.' );\n\n}\n\nif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\n\n\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'register', { detail: {\n\t\trevision: REVISION,\n\t} } ) );\n\n}\n\nif ( typeof window !== 'undefined' ) {\n\n\tif ( window.__THREE__ ) {\n\n\t\tconsole.warn( 'WARNING: Multiple instances of Three.js being imported.' );\n\n\t} else {\n\n\t\twindow.__THREE__ = REVISION;\n\n\t}\n\n}\n\nexport { ACESFilmicToneMapping, AddEquation, AddOperation, AdditiveAnimationBlendMode, AdditiveBlending, AlphaFormat, AlwaysDepth, AlwaysStencilFunc, AmbientLight, AmbientLightProbe, AnimationClip, AnimationLoader, AnimationMixer, AnimationObjectGroup, AnimationUtils, ArcCurve, ArrayCamera, ArrowHelper, Audio, AudioAnalyser, AudioContext, AudioListener, AudioLoader, AxesHelper, AxisHelper, BackSide, BasicDepthPacking, BasicShadowMap, BinaryTextureLoader, Bone, BooleanKeyframeTrack, BoundingBoxHelper, Box2, Box3, Box3Helper, BoxGeometry as BoxBufferGeometry, BoxGeometry, BoxHelper, BufferAttribute, BufferGeometry, BufferGeometryLoader, ByteType, Cache, Camera, CameraHelper, CanvasRenderer, CanvasTexture, CatmullRomCurve3, CineonToneMapping, CircleGeometry as CircleBufferGeometry, CircleGeometry, ClampToEdgeWrapping, Clock, Color, ColorKeyframeTrack, CompressedTexture, CompressedTextureLoader, ConeGeometry as ConeBufferGeometry, ConeGeometry, CubeCamera, CubeReflectionMapping, CubeRefractionMapping, CubeTexture, CubeTextureLoader, CubeUVReflectionMapping, CubeUVRefractionMapping, CubicBezierCurve, CubicBezierCurve3, CubicInterpolant, CullFaceBack, CullFaceFront, CullFaceFrontBack, CullFaceNone, Curve, CurvePath, CustomBlending, CustomToneMapping, CylinderGeometry as CylinderBufferGeometry, CylinderGeometry, Cylindrical, DataTexture, DataTexture2DArray, DataTexture3D, DataTextureLoader, DataUtils, DecrementStencilOp, DecrementWrapStencilOp, DefaultLoadingManager, DepthFormat, DepthStencilFormat, DepthTexture, DirectionalLight, DirectionalLightHelper, DiscreteInterpolant, DodecahedronGeometry as DodecahedronBufferGeometry, DodecahedronGeometry, DoubleSide, DstAlphaFactor, DstColorFactor, DynamicBufferAttribute, DynamicCopyUsage, DynamicDrawUsage, DynamicReadUsage, EdgesGeometry, EdgesHelper, EllipseCurve, EqualDepth, EqualStencilFunc, EquirectangularReflectionMapping, EquirectangularRefractionMapping, Euler, EventDispatcher, ExtrudeGeometry as ExtrudeBufferGeometry, ExtrudeGeometry, FaceColors, FileLoader, FlatShading, Float16BufferAttribute, Float32Attribute, Float32BufferAttribute, Float64Attribute, Float64BufferAttribute, FloatType, Fog, FogExp2, Font, FontLoader, FramebufferTexture, FrontSide, Frustum, GLBufferAttribute, GLSL1, GLSL3, GreaterDepth, GreaterEqualDepth, GreaterEqualStencilFunc, GreaterStencilFunc, GridHelper, Group, HalfFloatType, HemisphereLight, HemisphereLightHelper, HemisphereLightProbe, IcosahedronGeometry as IcosahedronBufferGeometry, IcosahedronGeometry, ImageBitmapLoader, ImageLoader, ImageUtils, ImmediateRenderObject, IncrementStencilOp, IncrementWrapStencilOp, InstancedBufferAttribute, InstancedBufferGeometry, InstancedInterleavedBuffer, InstancedMesh, Int16Attribute, Int16BufferAttribute, Int32Attribute, Int32BufferAttribute, Int8Attribute, Int8BufferAttribute, IntType, InterleavedBuffer, InterleavedBufferAttribute, Interpolant, InterpolateDiscrete, InterpolateLinear, InterpolateSmooth, InvertStencilOp, JSONLoader, KeepStencilOp, KeyframeTrack, LOD, LatheGeometry as LatheBufferGeometry, LatheGeometry, Layers, LensFlare, LessDepth, LessEqualDepth, LessEqualStencilFunc, LessStencilFunc, Light, LightProbe, Line, Line3, LineBasicMaterial, LineCurve, LineCurve3, LineDashedMaterial, LineLoop, LinePieces, LineSegments, LineStrip, LinearEncoding, LinearFilter, LinearInterpolant, LinearMipMapLinearFilter, LinearMipMapNearestFilter, LinearMipmapLinearFilter, LinearMipmapNearestFilter, LinearToneMapping, Loader, LoaderUtils, LoadingManager, LoopOnce, LoopPingPong, LoopRepeat, LuminanceAlphaFormat, LuminanceFormat, MOUSE, Material, MaterialLoader, MathUtils as Math, MathUtils, Matrix3, Matrix4, MaxEquation, Mesh, MeshBasicMaterial, MeshDepthMaterial, MeshDistanceMaterial, MeshFaceMaterial, MeshLambertMaterial, MeshMatcapMaterial, MeshNormalMaterial, MeshPhongMaterial, MeshPhysicalMaterial, MeshStandardMaterial, MeshToonMaterial, MinEquation, MirroredRepeatWrapping, MixOperation, MultiMaterial, MultiplyBlending, MultiplyOperation, NearestFilter, NearestMipMapLinearFilter, NearestMipMapNearestFilter, NearestMipmapLinearFilter, NearestMipmapNearestFilter, NeverDepth, NeverStencilFunc, NoBlending, NoColors, NoToneMapping, NormalAnimationBlendMode, NormalBlending, NotEqualDepth, NotEqualStencilFunc, NumberKeyframeTrack, Object3D, ObjectLoader, ObjectSpaceNormalMap, OctahedronGeometry as OctahedronBufferGeometry, OctahedronGeometry, OneFactor, OneMinusDstAlphaFactor, OneMinusDstColorFactor, OneMinusSrcAlphaFactor, OneMinusSrcColorFactor, OrthographicCamera, PCFShadowMap, PCFSoftShadowMap, PMREMGenerator, ParametricGeometry, Particle, ParticleBasicMaterial, ParticleSystem, ParticleSystemMaterial, Path, PerspectiveCamera, Plane, PlaneGeometry as PlaneBufferGeometry, PlaneGeometry, PlaneHelper, PointCloud, PointCloudMaterial, PointLight, PointLightHelper, Points, PointsMaterial, PolarGridHelper, PolyhedronGeometry as PolyhedronBufferGeometry, PolyhedronGeometry, PositionalAudio, PropertyBinding, PropertyMixer, QuadraticBezierCurve, QuadraticBezierCurve3, Quaternion, QuaternionKeyframeTrack, QuaternionLinearInterpolant, REVISION, RGBADepthPacking, RGBAFormat, RGBAIntegerFormat, RGBA_ASTC_10x10_Format, RGBA_ASTC_10x5_Format, RGBA_ASTC_10x6_Format, RGBA_ASTC_10x8_Format, RGBA_ASTC_12x10_Format, RGBA_ASTC_12x12_Format, RGBA_ASTC_4x4_Format, RGBA_ASTC_5x4_Format, RGBA_ASTC_5x5_Format, RGBA_ASTC_6x5_Format, RGBA_ASTC_6x6_Format, RGBA_ASTC_8x5_Format, RGBA_ASTC_8x6_Format, RGBA_ASTC_8x8_Format, RGBA_BPTC_Format, RGBA_ETC2_EAC_Format, RGBA_PVRTC_2BPPV1_Format, RGBA_PVRTC_4BPPV1_Format, RGBA_S3TC_DXT1_Format, RGBA_S3TC_DXT3_Format, RGBA_S3TC_DXT5_Format, RGBFormat, RGB_ETC1_Format, RGB_ETC2_Format, RGB_PVRTC_2BPPV1_Format, RGB_PVRTC_4BPPV1_Format, RGB_S3TC_DXT1_Format, RGFormat, RGIntegerFormat, RawShaderMaterial, Ray, Raycaster, RectAreaLight, RedFormat, RedIntegerFormat, ReinhardToneMapping, RepeatWrapping, ReplaceStencilOp, ReverseSubtractEquation, RingGeometry as RingBufferGeometry, RingGeometry, Scene, SceneUtils, ShaderChunk, ShaderLib, ShaderMaterial, ShadowMaterial, Shape, ShapeGeometry as ShapeBufferGeometry, ShapeGeometry, ShapePath, ShapeUtils, ShortType, Skeleton, SkeletonHelper, SkinnedMesh, SmoothShading, Sphere, SphereGeometry as SphereBufferGeometry, SphereGeometry, Spherical, SphericalHarmonics3, SplineCurve, SpotLight, SpotLightHelper, Sprite, SpriteMaterial, SrcAlphaFactor, SrcAlphaSaturateFactor, SrcColorFactor, StaticCopyUsage, StaticDrawUsage, StaticReadUsage, StereoCamera, StreamCopyUsage, StreamDrawUsage, StreamReadUsage, StringKeyframeTrack, SubtractEquation, SubtractiveBlending, TOUCH, TangentSpaceNormalMap, TetrahedronGeometry as TetrahedronBufferGeometry, TetrahedronGeometry, TextGeometry, Texture, TextureLoader, TorusGeometry as TorusBufferGeometry, TorusGeometry, TorusKnotGeometry as TorusKnotBufferGeometry, TorusKnotGeometry, Triangle, TriangleFanDrawMode, TriangleStripDrawMode, TrianglesDrawMode, TubeGeometry as TubeBufferGeometry, TubeGeometry, UVMapping, Uint16Attribute, Uint16BufferAttribute, Uint32Attribute, Uint32BufferAttribute, Uint8Attribute, Uint8BufferAttribute, Uint8ClampedAttribute, Uint8ClampedBufferAttribute, Uniform, UniformsLib, UniformsUtils, UnsignedByteType, UnsignedInt248Type, UnsignedIntType, UnsignedShort4444Type, UnsignedShort5551Type, UnsignedShortType, VSMShadowMap, Vector2, Vector3, Vector4, VectorKeyframeTrack, Vertex, VertexColors, VideoTexture, WebGL1Renderer, WebGLCubeRenderTarget, WebGLMultipleRenderTargets, WebGLMultisampleRenderTarget, WebGLRenderTarget, WebGLRenderTargetCube, WebGLRenderer, WebGLUtils, WireframeGeometry, WireframeHelper, WrapAroundEnding, XHRLoader, ZeroCurvatureEnding, ZeroFactor, ZeroSlopeEnding, ZeroStencilOp, _SRGBAFormat, sRGBEncoding };\n"],"mappings":"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","names":[]}]}