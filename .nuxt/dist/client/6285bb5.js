(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{274:function($,ie,B){var z=B(277);function D(p,w,y){return w=z(w),w in p?Object.defineProperty(p,w,{value:y,enumerable:!0,configurable:!0,writable:!0}):p[w]=y,p}$.exports=D,$.exports.__esModule=!0,$.exports.default=$.exports},275:function($,ie){function B(z){return $.exports=B=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},$.exports.__esModule=!0,$.exports.default=$.exports,B(z)}$.exports=B,$.exports.__esModule=!0,$.exports.default=$.exports},277:function($,ie,B){var z=B(275).default,D=B(279);function p(w){var y=D(w,"string");return z(y)==="symbol"?y:String(y)}$.exports=p,$.exports.__esModule=!0,$.exports.default=$.exports},279:function($,ie,B){var z=B(275).default;function D(p,w){if(z(p)!=="object"||p===null)return p;var y=p[Symbol.toPrimitive];if(y!==void 0){var I=y.call(p,w||"default");if(z(I)!=="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return(w==="string"?String:Number)(p)}$.exports=D,$.exports.__esModule=!0,$.exports.default=$.exports},285:function($,ie,B){"use strict";var z=B(31),D=B(84),p=B(40);$.exports=function(y){for(var I=z(this),s=p(I),x=arguments.length,_=D(x>1?arguments[1]:void 0,s),S=x>2?arguments[2]:void 0,E=S===void 0?s:D(S,s);E>_;)I[_++]=y;return I}},436:function($,ie){function B(D,p,w,y,I,s,x){try{var _=D[s](x),S=_.value}catch(E){w(E);return}_.done?p(S):Promise.resolve(S).then(y,I)}function z(D){return function(){var p=this,w=arguments;return new Promise(function(y,I){var s=D.apply(p,w);function x(S){B(s,y,I,x,_,"next",S)}function _(S){B(s,y,I,x,_,"throw",S)}x(void 0)})}}$.exports=z,$.exports.__esModule=!0,$.exports.default=$.exports},437:function($,ie){function B(z,D){if(!(z instanceof D))throw new TypeError("Cannot call a class as a function")}$.exports=B,$.exports.__esModule=!0,$.exports.default=$.exports},438:function($,ie,B){var z=B(277);function D(w,y){for(var I=0;I<y.length;I++){var s=y[I];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(w,z(s.key),s)}}function p(w,y,I){return y&&D(w.prototype,y),I&&D(w,I),Object.defineProperty(w,"prototype",{writable:!1}),w}$.exports=p,$.exports.__esModule=!0,$.exports.default=$.exports},439:function($,ie,B){"use strict";var z=B(5),D=B(69).findIndex,p=B(116),w="findIndex",y=!0;w in[]&&Array(1)[w](function(){y=!1}),z({target:"Array",proto:!0,forced:y},{findIndex:function(s){return D(this,s,arguments.length>1?arguments[1]:void 0)}}),p(w)},440:function($,ie,B){var z=B(5),D=B(285),p=B(116);z({target:"Array",proto:!0},{fill:D}),p("fill")},441:function($,ie,B){(function(D,p){$.exports=p()})(typeof self!="undefined"?self:this,function(){return function(z){var D={};function p(w){if(D[w])return D[w].exports;var y=D[w]={i:w,l:!1,exports:{}};return z[w].call(y.exports,y,y.exports,p),y.l=!0,y.exports}return p.m=z,p.c=D,p.d=function(w,y,I){p.o(w,y)||Object.defineProperty(w,y,{enumerable:!0,get:I})},p.r=function(w){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(w,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(w,"__esModule",{value:!0})},p.t=function(w,y){if(y&1&&(w=p(w)),y&8||y&4&&typeof w=="object"&&w&&w.__esModule)return w;var I=Object.create(null);if(p.r(I),Object.defineProperty(I,"default",{enumerable:!0,value:w}),y&2&&typeof w!="string")for(var s in w)p.d(I,s,function(x){return w[x]}.bind(null,s));return I},p.n=function(w){var y=w&&w.__esModule?function(){return w.default}:function(){return w};return p.d(y,"a",y),y},p.o=function(w,y){return Object.prototype.hasOwnProperty.call(w,y)},p.p="",p(p.s=8)}([function(z,D,p){"use strict";p.d(D,"a",function(){return y});var w=p(2);let y={js:I(),"abstract-js":s(),"abstract-date":x(),loki:_()};function I(){return(S,E)=>S===E?0:S<E?-1:1}function s(){return(S,E)=>S==E?0:S<E?-1:1}function x(){return(S,E)=>{let P=new Date(S).toISOString(),u=new Date(E).toISOString();return P==u?0:P<u?-1:1}}function _(){return(S,E)=>Object(w.b)(S,E)?0:Object(w.c)(S,E,!1)?-1:1}},function(z,D,p){"use strict";(function(w){p.d(D,"a",function(){return s});function y(){let x;return function(_){x=_}(w!==void 0&&w||this),x}function I(){const x=y(),_=Symbol.for("LOKI");return x[_]===void 0&&(x[_]={}),x[_]}const s=I()}).call(this,p(7))},function(z,D,p){"use strict";p.d(D,"b",function(){return w}),p.d(D,"c",function(){return y}),p.d(D,"d",function(){return s}),p.d(D,"a",function(){return E});function w(P,u){if(P===u)return!0;if(!P||!u||P===!0||u===!0||P!==P||u!==u){let m,C;switch(P){case void 0:m=1;break;case null:m=1;break;case!1:m=3;break;case!0:m=4;break;case"":m=5;break;default:m=P===P?9:0;break}switch(u){case void 0:C=1;break;case null:C=1;break;case!1:C=3;break;case!0:C=4;break;case"":C=5;break;default:C=u===u?9:0;break}if(m!==9||C!==9)return m===C}let l=Number(P),d=Number(u);return l===l||d===d?l===d:(l=P.toString(),d=u.toString(),l==d)}function y(P,u,l){if(!P||!u||P===!0||u===!0||P!==P||u!==u){let C,e;switch(P){case void 0:C=1;break;case null:C=1;break;case!1:C=3;break;case!0:C=4;break;case"":C=5;break;default:C=P===P?9:0;break}switch(u){case void 0:e=1;break;case null:e=1;break;case!1:e=3;break;case!0:e=4;break;case"":e=5;break;default:e=u===u?9:0;break}if(C!==9||e!==9)return C===e?l:C<e}let d=Number(P),m=Number(u);return d===d&&m===m?d<m?!0:d>m?!1:l:d===d&&m!==m?!0:m===m&&d!==d?!1:P<u?!0:P>u?!1:P==u?l:(d=P.toString(),m=u.toString(),d<m?!0:d==m?l:!1)}function I(P,u,l){if(!P||!u||P===!0||u===!0||P!==P||u!==u){let C,e;switch(P){case void 0:C=1;break;case null:C=1;break;case!1:C=3;break;case!0:C=4;break;case"":C=5;break;default:C=P===P?9:0;break}switch(u){case void 0:e=1;break;case null:e=1;break;case!1:e=3;break;case!0:e=4;break;case"":e=5;break;default:e=u===u?9:0;break}if(C!==9||e!==9)return C===e?l:C>e}let d=Number(P),m=Number(u);return d===d&&m===m?d>m?!0:d<m?!1:l:d===d&&m!==m?!1:m===m&&d!==d||P>u?!0:P<u?!1:P==u?l:(d=P.toString(),m=u.toString(),d>m?!0:d==m?l:!1)}function s(P,u,l){return w(P,u)?0:y(P,u,!1)?l?1:-1:I(P,u,!1)?l?-1:1:0}class x{$eq(u,l){return u===l}$ne(u,l){return u!==l}$gt(u,l){return u>l}$gte(u,l){return u>=l}$lt(u,l){return u<l}$lte(u,l){return u<=l}$between(u,l){return u==null?!1:u>=l[0]&&u<=l[1]}$in(u,l){return l.indexOf(u)!==-1}$nin(u,l){return l.indexOf(u)===-1}$keyin(u,l){return u in l}$nkeyin(u,l){return!(u in l)}$definedin(u,l){return l[u]!==void 0}$undefinedin(u,l){return l[u]===void 0}$regex(u,l){return l.test(u)}$containsNone(u,l){return!this.$containsAny(u,l)}$containsAny(u,l){const d=this.containsCheckFn(u);return d!==null?Array.isArray(l)?l.some(d):d(l):!1}$contains(u,l){const d=this.containsCheckFn(u);return d!==null?Array.isArray(l)?l.every(d):d(l):!1}$type(u,l){let d=typeof u;return d==="object"&&(Array.isArray(u)?d="array":u instanceof Date&&(d="date")),typeof l!="object"?d===l:this.doQueryOp(d,l)}$finite(u,l){return l===isFinite(u)}$size(u,l){return Array.isArray(u)?typeof l!="object"?u.length===l:this.doQueryOp(u.length,l):!1}$len(u,l){return typeof u=="string"?typeof l!="object"?u.length===l:this.doQueryOp(u.length,l):!1}$where(u,l){return l(u)===!0}$not(u,l){return!this.doQueryOp(u,l)}$and(u,l){for(let d=0,m=l.length;d<m;d++)if(!this.doQueryOp(u,l[d]))return!1;return!0}$or(u,l){for(let d=0,m=l.length;d<m;d++)if(this.doQueryOp(u,l[d]))return!0;return!1}doQueryOp(u,l){for(let d in l)if(Object.hasOwnProperty.call(l,d))return this[d](u,l[d]);return!1}containsCheckFn(u){return typeof u=="string"||Array.isArray(u)?l=>u.indexOf(l)!==-1:typeof u=="object"&&u!==null?l=>Object.hasOwnProperty.call(u,l):null}}class _ extends x{constructor(){super()}$eq(u,l){return w(u,l)}$ne(u,l){return!w(u,l)}$gt(u,l){return I(u,l,!1)}$gte(u,l){return I(u,l,!0)}$lt(u,l){return y(u,l,!1)}$lte(u,l){return y(u,l,!0)}$between(u,l){return u==null?!1:I(u,l[0],!0)&&y(u,l[1],!0)}}class S extends x{constructor(u){super();this.comparator=u}$eq(u,l){return this.comparator(u,l)===0}$ne(u,l){return this.comparator(u,l)!==0}$gt(u,l){return this.comparator(u,l)===1}$gte(u,l){return this.comparator(u,l)>-1}$lt(u,l){return this.comparator(u,l)===-1}$lte(u,l){return this.comparator(u,l)<1}$between(u,l){return u==null?!1:this.comparator(u,l[0])>-1&&this.comparator(u,l[1])<1}}let E={js:new x,loki:new _}},function(z,D,p){"use strict";var w=p(5);class y{constructor(t){this._field=t,this._lokiMap={},this._valMap={}}set(t,i){if(i!=null){if(i in this._lokiMap)throw new Error("Duplicate key for property "+this._field+": "+i);if(t in this._valMap)throw new Error("Duplicate key for property $loki : "+t);this._lokiMap[i]=t,this._valMap[t]=i}}get(t){return this._lokiMap[t]}update(t,i){if(i!==this._valMap[t]){if(i in this._lokiMap)throw new Error("Duplicate key for property "+this._field+": "+i);this.remove(t),this.set(t,i)}}remove(t){if(!(t in this._valMap))throw new Error("Key is not in unique index: "+this._field);let i=this._valMap[t];delete this._lokiMap[i],delete this._valMap[t]}clear(){this._lokiMap={},this._valMap={}}}function I(A,t,i){if(A instanceof Array)return A.push(i),A[A.length-1];if(A instanceof Object)return A[t]=i,A[t]}function s(A,t){for(let i in A){let r=A[i];if(r instanceof Date){let h=new Date(r.getTime());I(t,i,h)}else if(r instanceof Function)I(t,i,r);else if(r instanceof Array){let c=I(t,i,[]);s(r,c)}else if(r instanceof Object){let c=I(t,i,{});s(r,c)}else I(t,i,r)}}function x(A){if(/number|string|boolean/.test(typeof A))return A;if(A instanceof Date)return new Date(A.getTime());const t=A instanceof Array?[]:{};return s(A,t),t}function _(A,t="parse-stringify"){if(A==null)return null;let i;switch(t){case"parse-stringify":i=JSON.parse(JSON.stringify(A));break;case"deep":i=x(A);break;case"shallow":i=Object.create(A.constructor.prototype),Object.assign(i,A);break;case"shallow-recurse":i=_(A,"shallow");const r=Object.keys(A);for(let h=0;h<r.length;h++){const c=r[h];typeof A[c]=="object"&&A[c].constructor.name==="Object"&&(i[c]=_(A[c],"shallow-recurse"))}break;default:break}return i}var S=p(2),E=p(0);function P(A,t,i=0){if(++i>=10)return A;for(const r in A)if(typeof A[r]=="string"&&A[r].indexOf("[%lktxp]")===0){const h=A[r].substring(8);t[h]!==void 0&&(A[r]=t[h])}else typeof A[r]=="object"&&(A[r]=P(A[r],t,i));return A}function u(A,t){if(t===void 0)return A;const i=[];for(let r=0;r<A.length;r++){const h=_(A[r],"shallow-recurse");i.push(P(h,t))}return i}const l={$eq:!0,$dteq:!0,$gt:!0,$gte:!0,$lt:!0,$lte:!0,$in:!0,$between:!0};class d{constructor(t){this._filteredRows=[],this._filterInitialized=!1,this._scoring=null,this._collection=t}reset(){return this._filteredRows.length>0&&(this._filteredRows=[]),this._filterInitialized=!1,this}toJSON(){const t=this.copy();return t._collection=null,t}limit(t){return!this._filterInitialized&&this._filteredRows.length===0&&(this._filteredRows=this._collection._prepareFullDocIndex()),this._filteredRows=this._filteredRows.slice(0,t),this._filterInitialized=!0,this}offset(t){return!this._filterInitialized&&this._filteredRows.length===0&&(this._filteredRows=this._collection._prepareFullDocIndex()),this._filteredRows=this._filteredRows.slice(t),this._filterInitialized=!0,this}copy(){const t=new d(this._collection);return t._filteredRows=this._filteredRows.slice(),t._filterInitialized=this._filterInitialized,t}transform(t,i){typeof t=="string"&&(t=this._collection._transforms[t]),i!==void 0&&(t=u(t,i));let r=this;for(let h=0;h<t.length;h++){const c=t[h];switch(c.type){case"find":r.find(c.value);break;case"where":r.where(c.value);break;case"simplesort":r.simplesort(c.property,c.options);break;case"compoundsort":r.compoundsort(c.value);break;case"sort":r.sort(c.value);break;case"sortByScoring":r.sortByScoring(c.desc);break;case"limit":r=r.limit(c.value);break;case"offset":r=r.offset(c.value);break;case"map":r=r.map(c.value,c.dataOptions);break;case"eqJoin":r=r.eqJoin(c.joinData,c.leftJoinKey,c.rightJoinKey,c.mapFun,c.dataOptions);break;case"mapReduce":r=r.mapReduce(c.mapFunction,c.reduceFunction);break;case"update":r.update(c.value);break;case"remove":r.remove();break;default:break}}return r}sort(t){!this._filterInitialized&&this._filteredRows.length===0&&(this._filteredRows=this._collection._prepareFullDocIndex());const i=this._collection._data,r=(h,c)=>t(i[h],i[c]);return this._filteredRows.sort(r),this}simplesort(t,i={desc:!1}){if(typeof i=="boolean"&&(i={desc:i}),!this._filterInitialized&&this._collection._rangedIndexes.hasOwnProperty(t)){let v=this._collection._rangedIndexes[t].index.rangeRequest(),k=[];for(let J of v)k.push(this._collection.get(J,!0)[1]);return this._filteredRows=i.desc?k.reverse():k,this._filterInitialized=!0,this}!this._filterInitialized&&this._filteredRows.length===0&&(this._filteredRows=this._collection._prepareFullDocIndex());const r=this._collection._data;let h=i.sortComparator?E.a[i.sortComparator]:E.a[this._collection._unindexedSortComparator];const c=(v,k)=>h(r[v][t],r[k][t]);return this._filteredRows.sort(c),i.desc&&this._filteredRows.reverse(),this}compoundsort(t){if(t.length===0)throw new Error("Invalid call to compoundsort, need at least one property");if(t.length===1){const h=t[0];return typeof h=="string"?this.simplesort(h,!1):this.simplesort(h[0],h[1])}for(let h=0,c=t.length;h<c;h++){const v=t[h];typeof v=="string"&&(t[h]=[v,!1])}!this._filterInitialized&&this._filteredRows.length===0&&(this._filteredRows=this._collection._prepareFullDocIndex());const i=this._collection._data,r=(h,c)=>this._compoundeval(t,i[h],i[c]);return this._filteredRows.sort(r),this}_compoundeval(t,i,r){for(let h=0,c=t.length;h<c;h++){const v=t[h],k=v[0],J=Object(S.d)(i[k],r[k],v[1]);if(J!==0)return J}return 0}sortByScoring(t=!1){if(this._scoring===null)throw new Error("No scoring available");return t?this._filteredRows.sort((i,r)=>this._scoring[i].score-this._scoring[r].score):this._filteredRows.sort((i,r)=>this._scoring[r].score-this._scoring[i].score),this}getScoring(){if(this._scoring===null)throw new Error("No scoring available");const t=[];for(let i=0;i<this._filteredRows.length;i++)t.push(this._scoring[this._filteredRows[i]]);return t}findOr(t){const i=[],r=[],h=this.count();for(let c=0,v=t.length;c<v;c++){const k=this.copy().find(t[c])._filteredRows,J=k.length;if(J===h)return this;for(let K=0;K<J;K++){const H=k[K];r[H]===void 0&&(r[H]=!0,i.push(H))}}return this._filteredRows=i,this._filterInitialized=!0,this}$or(t){return this.findOr(t)}findAnd(t){for(let i=0,r=t.length;i<r;i++){if(this.count()===0)return this;this.find(t[i])}return this}$and(t){return this.findAnd(t)}find(t,i=!1){if(this._collection._data.length===0)return this._filteredRows=[],this._filterInitialized=!0,this;const r=t||"getAll";let h,c,v;if(typeof r=="object"){let j=[];for(let V in r){let L={};L[V]=r[V],j.push(L),r[V]!==void 0&&(h=V,c=r[V])}if(j.length>1)return this.find({$and:j},i)}if(!h||r==="getAll")return i&&(this._filteredRows=this._collection._data.length>0?[0]:[],this._filterInitialized=!0),this;if(h==="$and"||h==="$or")return this[h](c),i&&this._filteredRows.length>1&&(this._filteredRows=this._filteredRows.slice(0,1)),this;let k="";if(c===null||typeof c!="object"||c instanceof Date)k="$eq",v=c;else if(typeof c=="object"){for(let j in c)if(c[j]!==void 0){k=j,v=c[j];break}}else throw new Error("Do not know what you want to do.");k==="$regex"&&(Array.isArray(v)?v=new RegExp(v[0],v[1]):v instanceof RegExp||(v=new RegExp(v)));const J=!this._filterInitialized;let K=!1;J&&this._collection._rangedIndexes[h]&&l[k]&&(K=!0);const H=S.a[this._collection._defaultLokiOperatorPackage],le=this._collection._data;let X=[];if(this._filterInitialized){let j=this._filteredRows;if(h==="$fts"){this._scoring=this._collection._fullTextSearch.search(r.$fts);let V=Object.keys(this._scoring);for(let L=0;L<V.length;L++)j.indexOf(+V[L])!==-1&&X.push(+V[L])}else if(this._collection._constraints.unique[h]!==void 0&&k==="$eq"){const V=this._collection._constraints.unique[h].get(v);if(V!==void 0){const L=this._collection.get(V,!0)[1];j.indexOf(L)!==-1&&X.push(L)}}else for(let V=0;V<j.length;V++){let L=j[V];H[k](le[L][h],v)&&X.push(L)}return this._filteredRows=X,this._filterInitialized=!0,this}if(this._filteredRows=X,this._filterInitialized=!0,h==="$fts"){this._scoring=this._collection._fullTextSearch.search(r.$fts);let j=Object.keys(this._scoring);for(let V=0;V<j.length;V++)X.push(+j[V]);return this}if(this._collection._constraints.unique[h]!==void 0&&k==="$eq"){const j=this._collection._constraints.unique[h].get(v);return j!==void 0&&X.push(this._collection.get(j,!0)[1]),this}if(!K){for(let j=0;j<le.length;j++)if(H[k](le[j][h],v)&&(X.push(j),i))return this;return this}if(this._collection._rangedIndexes[h]){if(k==="$in"){let V=this._collection._rangedIndexes[h];for(let L of v){let fe=V.index.rangeRequest({op:"$eq",val:L});for(let he of fe)X.push(this._collection.get(he,!0)[1])}return this}if(k==="$between"){let V=this._collection._rangedIndexes[h].index.rangeRequest({op:k,val:v[0],high:v[1]});for(let L of V)X.push(this._collection.get(L,!0)[1]);return this}let j=this._collection._rangedIndexes[h].index.rangeRequest({op:k,val:v});if(l[k]!==!0)for(let V of j){let L=this._collection.get(V,!0)[1];l[k](le[L][h],v)&&X.push(L)}else for(let V of j)X.push(this._collection.get(V,!0)[1])}return this}where(t){let i,r=[];if(typeof t=="function")i=t;else throw new TypeError("Argument is not a stored view or a function");if(this._filterInitialized){let h=this._filteredRows.length;for(;h--;)i(this._collection._data[this._filteredRows[h]])===!0&&r.push(this._filteredRows[h]);return this._filteredRows=r,this}else{let h=this._collection._data.length;for(;h--;)i(this._collection._data[h])===!0&&r.push(h);return this._filteredRows=r,this._filterInitialized=!0,this}}count(){return this._filterInitialized?this._filteredRows.length:this._collection.count()}data(t={}){let i,r,h;({forceClones:i=!1,forceCloneMethod:r=this._collection._cloneMethod,removeMeta:h=!1}=t);let c=[],v=this._collection._data,k,J;if(h&&!i&&(i=!0,r="shallow"),this._collection._disableDeltaChangesApi||(i=!0,r="deep"),!this._filterInitialized)if(this._filteredRows.length===0)if(this._collection._cloneObjects||i){J=r;for(let H=0;H<v.length;H++)k=this._collection._defineNestedProperties(_(v[H],J)),h&&(delete k.$loki,delete k.meta),c.push(k);return c}else return v.slice();else this._filterInitialized=!0;const K=this._filteredRows;if(this._collection._cloneObjects||i){J=r;for(let H=0;H<K.length;H++)k=this._collection._defineNestedProperties(_(v[K[H]],J)),h&&(delete k.$loki,delete k.meta),c.push(k)}else for(let H=0;H<K.length;H++)c.push(v[K[H]]);return c}update(t){!this._filterInitialized&&this._filteredRows.length===0&&(this._filteredRows=this._collection._prepareFullDocIndex());const i=this._filteredRows.length,r=this._collection._data;for(let h=0;h<i;h++)if(this._collection._cloneObjects||!this._collection._disableDeltaChangesApi){const c=_(r[this._filteredRows[h]],this._collection._cloneMethod);t(c),this._collection.update(c)}else t(r[this._filteredRows[h]]),this._collection.update(r[this._filteredRows[h]]);return this}remove(){return!this._filterInitialized&&this._filteredRows.length===0&&(this._filteredRows=this._collection._prepareFullDocIndex()),this._collection.remove(this.data()),this._filteredRows=[],this}mapReduce(t,i){try{return i(this.data().map(t))}catch(r){throw r}}eqJoin(t,i,r,h,c){let v=[],k,J,K=[],H=typeof i=="function",le=typeof r=="function",X={},j=this.data(c),V=j.length;if(t instanceof ee)v=t.chain().data(c);else if(t instanceof d)v=t.data(c);else if(Array.isArray(t))v=t;else throw new TypeError("joinData needs to be an array or result set");k=v.length;for(let L=0;L<k;L++)J=le?r(v[L]):v[L][r],X[J]=v[L];h||(h=(L,fe)=>({left:L,right:fe}));for(let L=0;L<V;L++)J=H?i(j[L]):j[L][i],K.push(h(j[L],X[J]||{}));return this._collection=new ee("joinData"),this._collection.insert(K),this._filteredRows=[],this._filterInitialized=!1,this}map(t,i){const r=this.data(i).map(t);return this._collection=new ee("mappedData"),this._collection.insert(r),this._filteredRows=[],this._filterInitialized=!1,this}}class m extends w.a{constructor(t,i,r={}){super();this._rebuildPending=!1,this._resultData=[],this._resultDirty=!1,this._cachedResultSet=null,this._filterPipeline=[],this._sortFunction=null,this._sortCriteria=null,this._sortCriteriaSimple=null,this._sortByScoring=null,this._sortDirty=!1,{persistent:this._persistent=!1,sortPriority:this._sortPriority="passive",minRebuildInterval:this._minRebuildInterval=1}=r,this._collection=t,this.name=i,this._resultSet=new d(t),this._events={rebuild:[]}}_rematerialize({removeWhereFilters:t=!1}){if(this._resultData=[],this._resultDirty=!0,this._resultSet=new d(this._collection),(this._sortFunction||this._sortCriteria||this._sortCriteriaSimple||this._sortByScoring!==null)&&(this._sortDirty=!0),t){let r=this._filterPipeline.length;for(;r--;)this._filterPipeline[r].type==="where"&&(r!==this._filterPipeline.length-1&&(this._filterPipeline[r]=this._filterPipeline[this._filterPipeline.length-1]),this._filterPipeline.length--)}const i=this._filterPipeline;this._filterPipeline=[];for(let r=0;r<i.length;r++)this.applyFind(i[r].val);return this.data(),this.emit("rebuild",this),this}branchResultSet(t,i){const r=this._resultSet.copy();return t===void 0?r:r.transform(t,i)}toJSON(){return{name:this.name,_persistent:this._persistent,_sortPriority:this._sortPriority,_minRebuildInterval:this._minRebuildInterval,_resultSet:this._resultSet,_filterPipeline:this._filterPipeline,_sortCriteria:this._sortCriteria,_sortCriteriaSimple:this._sortCriteriaSimple,_sortByScoring:this._sortByScoring,_sortDirty:this._sortDirty}}static fromJSONObject(t,i){let r=new m(t,i.name);return r._resultDirty=!0,r._filterPipeline=i._filterPipeline,r._resultData=[],r._sortCriteria=i._sortCriteria,r._sortCriteriaSimple=i._sortCriteriaSimple,r._sortByScoring=i._sortByScoring,r._sortDirty=i._sortDirty,r._resultSet._filteredRows=i._resultSet._filteredRows,r._resultSet._filterInitialized=i._resultSet._filterInitialized,r._rematerialize({removeWhereFilters:!0}),r}removeFilters({queueSortPhase:t=!1}={}){this._rebuildPending=!1,this._resultSet.reset(),this._resultData=[],this._resultDirty=!0,this._cachedResultSet=null,this._filterPipeline=[],this._sortFunction=null,this._sortCriteria=null,this._sortCriteriaSimple=null,this._sortByScoring=null,this._sortDirty=!1,t===!0&&this._queueSortPhase()}applySort(t){return this._sortFunction=t,this._sortCriteria=null,this._sortCriteriaSimple=null,this._sortByScoring=null,this._queueSortPhase(),this}applySimpleSort(t,i=!1){return this._sortCriteriaSimple={field:t,options:i},this._sortFunction=null,this._sortCriteria=null,this._sortByScoring=null,this._queueSortPhase(),this}applySortCriteria(t){return this._sortCriteria=t,this._sortCriteriaSimple=null,this._sortFunction=null,this._sortByScoring=null,this._queueSortPhase(),this}applySortByScoring(t=!1){return this._sortFunction=null,this._sortCriteria=null,this._sortCriteriaSimple=null,this._sortByScoring=t,this._queueSortPhase(),this}getScoring(){return this._resultSet.getScoring()}startTransaction(){return this._cachedResultSet=this._resultSet.copy(),this}commit(){return this._cachedResultSet=null,this}rollback(){return this._resultSet=this._cachedResultSet,this._persistent&&(this._resultData=this._resultSet.data(),this.emit("rebuild",this)),this}_indexOfFilterWithId(t){if(typeof t=="string"||typeof t=="number"){for(let i=0,r=this._filterPipeline.length;i<r;i++)if(t===this._filterPipeline[i].uid)return i}return-1}_addFilter(t){this._filterPipeline.push(t),this._resultSet[t.type](t.val)}reapplyFilters(){this._resultSet.reset(),this._cachedResultSet=null,this._persistent&&(this._resultData=[],this._resultDirty=!0);const t=this._filterPipeline;this._filterPipeline=[];for(let i=0,r=t.length;i<r;i++)this._addFilter(t[i]);return this._sortFunction||this._sortCriteria||this._sortCriteriaSimple||this._sortByScoring!==null?this._queueSortPhase():this._queueRebuildEvent(),this}applyFilter(t){const i=this._indexOfFilterWithId(t.uid);return i>=0?(this._filterPipeline[i]=t,this.reapplyFilters()):(this._cachedResultSet=null,this._persistent&&(this._resultData=[],this._resultDirty=!0),this._addFilter(t),this._sortFunction||this._sortCriteria||this._sortCriteriaSimple||this._sortByScoring!==null?this._queueSortPhase():this._queueRebuildEvent(),this)}applyFind(t,i=""){return this.applyFilter({type:"find",val:t,uid:i}),this}applyWhere(t,i){return this.applyFilter({type:"where",val:t,uid:i}),this}removeFilter(t){const i=this._indexOfFilterWithId(t);if(i<0)throw new Error("Dynamic view does not contain a filter with ID: "+t);return this._filterPipeline.splice(i,1),this.reapplyFilters(),this}count(){return this._resultDirty&&(this._resultData=this._resultSet.data()),this._resultSet.count()}data(t={}){return(this._sortDirty||this._resultDirty)&&this._performSortPhase({suppressRebuildEvent:!0}),this._persistent?this._resultData:this._resultSet.data(t)}_queueRebuildEvent(){this._rebuildPending||(this._rebuildPending=!0,setTimeout(()=>{this._rebuildPending&&(this._rebuildPending=!1,this.emit("rebuild",this))},this._minRebuildInterval))}_queueSortPhase(){this._sortDirty||(this._sortDirty=!0,this._sortPriority==="active"?setTimeout(()=>{this._performSortPhase()},this._minRebuildInterval):this._queueRebuildEvent())}_performSortPhase(t={}){!this._sortDirty&&!this._resultDirty||(this._sortDirty&&(this._sortFunction?this._resultSet.sort(this._sortFunction):this._sortCriteria?this._resultSet.compoundsort(this._sortCriteria):this._sortCriteriaSimple?this._resultSet.simplesort(this._sortCriteriaSimple.field,this._sortCriteriaSimple.options):this._sortByScoring!==null&&this._resultSet.sortByScoring(this._sortByScoring),this._sortDirty=!1),this._persistent&&(this._resultData=this._resultSet.data(),this._resultDirty=!1),t.suppressRebuildEvent||this.emit("rebuild",this))}_evaluateDocument(t,i){if(!this._resultSet._filterInitialized){this._persistent&&(this._resultData=this._resultSet.data()),this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent();return}const r=this._resultSet._filteredRows,h=i?-1:r.indexOf(+t),c=r.length,v=new d(this._collection);v._filteredRows=[t],v._filterInitialized=!0;let k;for(let K=0,H=this._filterPipeline.length;K<H;K++)k=this._filterPipeline[K],v[k.type](k.val);const J=v._filteredRows.length===0?-1:0;if(!(h===-1&&J===-1)){if(h===-1&&J!==-1){r.push(t),this._persistent&&this._resultData.push(this._collection._data[t]),this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent();return}if(h!==-1&&J===-1){h<c-1?(r.splice(h,1),this._persistent&&this._resultData.splice(h,1)):(r.length=c-1,this._persistent&&(this._resultData.length=c-1)),this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent();return}h!==-1&&J!==-1&&(this._persistent&&(this._resultData[h]=this._collection._data[t]),this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent())}}_removeDocument(t){if(!this._resultSet._filterInitialized){this._persistent&&(this._resultData=this._resultSet.data()),this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent();return}const i=this._resultSet._filteredRows,r=i.indexOf(+t);let h=i.length;r!==-1&&(r<h-1?(i[r]=i[h-1],i.length=h-1,this._persistent&&(this._resultData[r]=this._resultData[h-1],this._resultData.length=h-1)):(i.length=h-1,this._persistent&&(this._resultData.length=h-1)),this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent()),h=i.length;for(let c=0;c<h;c++)i[c]>t&&i[c]--}mapReduce(t,i){try{return i(this.data().map(t))}catch(r){throw r}}}var C=p(4),e=p(1);p.d(D,"a",function(){return ee});function G(A){return A.reduce((t,i)=>t+i,0)/A.length}function W(A){const t=G(A),i=A.map(h=>{const c=h-t;return c*c}),r=G(i);return Math.sqrt(r)}function re(A,t,i,r=0){if(A===void 0)return!1;if(r+1===t.length)return i.push(A[t[r]]),!1;const h=A[t[r]];if(Array.isArray(h)){for(let c=0;c<h.length;c++)re(h[c],t,i,r+1);return!0}else return re(h,t,i,r+1)}class ee extends w.a{constructor(t,i={}){super();if(this._data=[],this._idIndex=[],this._rangedIndexes={},this._lokimap={},this._unindexedSortComparator="js",this._defaultLokiOperatorPackage="js",this._constraints={unique:{}},this._transforms={},this._dirty=!0,this._cached=null,this._nestedProperties=[],this._ttl={age:null,ttlInterval:null,daemon:null},this._maxId=0,this._dynamicViews=[],this._changes=[],this._stages={},this._commitLog=[],i&&i.disableMeta===!0){if(i.disableChangesApi===!1)throw new Error("disableMeta option cannot be passed as true when disableChangesApi is passed as false");if(i.disableDeltaChangesApi===!1)throw new Error("disableMeta option cannot be passed as true when disableDeltaChangesApi is passed as false");if(typeof i.ttl=="number"&&i.ttl>0)throw new Error("disableMeta option cannot be passed as true when ttl is enabled")}if(this.name=t,this._unindexedSortComparator=i.unindexedSortComparator||"js",this._defaultLokiOperatorPackage=i.defaultLokiOperatorPackage||"js",i.unique!==void 0&&(Array.isArray(i.unique)||(i.unique=[i.unique]),i.unique.forEach(h=>{this._constraints.unique[h]=new y(h)})),e.a.FullTextSearch!==void 0?this._fullTextSearch=i.fullTextSearch!==void 0?new e.a.FullTextSearch(i.fullTextSearch):null:this._fullTextSearch=null,this._transactional=i.transactional!==void 0?i.transactional:!1,this._cloneObjects=i.clone!==void 0?i.clone:!1,this._asyncListeners=i.asyncListeners!==void 0?i.asyncListeners:!1,this._disableMeta=i.disableMeta!==void 0?i.disableMeta:!1,this._disableChangesApi=i.disableChangesApi!==void 0?i.disableChangesApi:!0,this._disableDeltaChangesApi=i.disableDeltaChangesApi!==void 0?i.disableDeltaChangesApi:!0,this._cloneMethod=i.cloneMethod!==void 0?i.cloneMethod:"deep",this._disableChangesApi&&(this._disableDeltaChangesApi=!0),this._serializableIndexes=i.serializableIndexes!==void 0?i.serializableIndexes:!0,i.nestedProperties!=null)for(let h=0;h<i.nestedProperties.length;h++){const c=i.nestedProperties[h];typeof c=="string"?this._nestedProperties.push({name:c,path:c.split(".")}):this._nestedProperties.push(c)}this.setTTL(i.ttl||-1,i.ttlInterval),this._events={insert:[],update:[],"pre-insert":[],"pre-update":[],close:[],flushbuffer:[],error:[],delete:[],warning:[]},this._ensureId();let r=i.rangedIndexes||{};for(let h in r)this.ensureRangedIndex(h,r[h].indexTypeName,r[h].comparatorName);this.setChangesApi(this._disableChangesApi,this._disableDeltaChangesApi),this.flushChanges()}toJSON(){return{name:this.name,unindexedSortComparator:this._unindexedSortComparator,defaultLokiOperatorPackage:this._defaultLokiOperatorPackage,_dynamicViews:this._dynamicViews,uniqueNames:Object.keys(this._constraints.unique),transforms:this._transforms,rangedIndexes:this._rangedIndexes,_data:this._data,idIndex:this._idIndex,maxId:this._maxId,_dirty:this._dirty,_nestedProperties:this._nestedProperties,transactional:this._transactional,asyncListeners:this._asyncListeners,disableMeta:this._disableMeta,disableChangesApi:this._disableChangesApi,disableDeltaChangesApi:this._disableDeltaChangesApi,cloneObjects:this._cloneObjects,cloneMethod:this._cloneMethod,changes:this._changes,_fullTextSearch:this._fullTextSearch}}static fromJSONObject(t,i){let r=new ee(t.name,{disableChangesApi:t.disableChangesApi,disableDeltaChangesApi:t.disableDeltaChangesApi,unindexedSortComparator:t.unindexedSortComparator,defaultLokiOperatorPackage:t.defaultLokiOperatorPackage});r._transactional=t.transactional,r._asyncListeners=t.asyncListeners,r._disableMeta=t.disableMeta,r._disableChangesApi=t.disableChangesApi,r._cloneObjects=t.cloneObjects,r._cloneMethod=t.cloneMethod||"deep",r._changes=t.changes,r._nestedProperties=t._nestedProperties,r._rangedIndexes=t.rangedIndexes||{},r._dirty=i&&i.retainDirtyFlags===!0?t._dirty:!1;function h(c){const v=i[c.name];if(v.proto){const k=v.inflate||((J,K)=>{for(let H in J)K[H]=J[H]});return J=>{const K=new v.proto;return k(J,K),K}}return v.inflate}if(i&&i[t.name]!==void 0){let c=h(t);for(let v=0;v<t._data.length;v++)r._data[v]=r._defineNestedProperties(c(t._data[v])),r._lokimap[r._data[v].$loki]=r._data[v]}else for(let c=0;c<t._data.length;c++)r._data[c]=r._defineNestedProperties(t._data[c]),r._lokimap[r._data[c].$loki]=r._data[c];r._maxId=t.maxId===void 0?0:t.maxId,r._idIndex=t.idIndex,t.transforms!==void 0&&(r._transforms=t.transforms);for(let c in t.rangedIndexes){let v=t.rangedIndexes[c],k=C.a[v.indexTypeName],J=E.a[v.comparatorName],K=k(c,J);K.restore(v.index),r._rangedIndexes[c].index=K}if(r._ensureId(),t.uniqueNames!==void 0)for(let c=0;c<t.uniqueNames.length;c++)r.ensureUniqueIndex(t.uniqueNames[c]);if(t._dynamicViews!==void 0)for(let c=0;c<t._dynamicViews.length;c++)r._dynamicViews.push(m.fromJSONObject(r,t._dynamicViews[c]));return t._fullTextSearch&&(r._fullTextSearch=e.a.FullTextSearch.fromJSONObject(t._fullTextSearch,i.fullTextSearch)),r}addTransform(t,i){if(this._transforms[t]!==void 0)throw new Error("a transform by that name already exists");this._transforms[t]=i}getTransform(t){return this._transforms[t]}setTransform(t,i){this._transforms[t]=i}removeTransform(t){delete this._transforms[t]}setTTL(t,i){t<0?clearInterval(this._ttl.daemon):(this._ttl.age=t,this._ttl.ttlInterval=i,this._ttl.daemon=setInterval(()=>{const r=Date.now();this.chain().where(c=>{const v=c.meta.updated||c.meta.created,k=r-v;return this._ttl.age<k}).remove()},i))}_prepareFullDocIndex(){const t=new Array(this._data.length);for(let i=0;i<t.length;i++)t[i]=i;return t}ensureIndex(t,i,r){this.ensureRangedIndex(t,i,r)}ensureRangedIndex(t,i,r){if(i=i||"avl",r=r||"loki",!C.a[i])throw new Error("ensureRangedIndex: Unknown range index type");if(!E.a[r])throw new Error("ensureRangedIndex: Unknown comparator");let h=C.a[i],c=E.a[r];this._rangedIndexes[t]={index:h(t,c),indexTypeName:i,comparatorName:r};let v=this._rangedIndexes[t].index;for(let k=0;k<this._data.length;k++)v.insert(this._data[k].$loki,this._data[k][t])}ensureUniqueIndex(t){let i=new y(t);this._constraints.unique[t]=i;for(let r=0;r<this._data.length;r++)i.set(this._data[r].$loki,this._data[r][t]);return i}count(t){return t?this.chain().find(t)._filteredRows.length:this._data.length}_ensureId(){this._idIndex=[];for(let t=0;t<this._data.length;t++)this._idIndex.push(this._data[t].$loki)}addDynamicView(t,i){const r=new m(this,t,i);return this._dynamicViews.push(r),r}removeDynamicView(t){for(let i=0;i<this._dynamicViews.length;i++)this._dynamicViews[i].name===t&&this._dynamicViews.splice(i,1)}getDynamicView(t){for(let i=0;i<this._dynamicViews.length;i++)if(this._dynamicViews[i].name===t)return this._dynamicViews[i];return null}findAndUpdate(t,i){this.chain().find(t).update(i)}findAndRemove(t){this.chain().find(t).remove()}insert(t){if(!Array.isArray(t))return this.insertOne(t);let i,r=[];this.emit("pre-insert",t);for(let h=0;h<t.length;h++){if(i=this.insertOne(t[h],!0),!i)return;r.push(i)}return this.emit("insert",r),r=this._cloneObjects?_(r,this._cloneMethod):r,r.length===1?r[0]:r}insertOne(t,i=!1){let r=null,h;if(typeof t!="object"?r=new TypeError("Document needs to be an object"):t===null&&(r=new TypeError("Object cannot be null")),r!==null)throw this.emit("error",r),r;const c=this._defineNestedProperties(this._cloneObjects?_(t,this._cloneMethod):t);if(!this._disableMeta&&c.meta===void 0&&(c.meta={version:0,revision:0,created:0}),i||this.emit("pre-insert",c),!!this._add(c))return this._disableChangesApi?this._insertMeta(c):this._insertMetaWithChange(c),h=this._cloneObjects?_(c,this._cloneMethod):c,i||this.emit("insert",h),h}_defineNestedProperties(t){for(let i=0;i<this._nestedProperties.length;i++){const r=this._nestedProperties[i].name,h=this._nestedProperties[i].path;Object.defineProperty(t,r,{get(){const c=[];return re(this,h,c)?c:c[0]},set(c){h.slice(0,h.length-1).reduce((v,k)=>v&&v[k]?v[k]:null,this)[h[h.length-1]]=c},enumerable:!1,configurable:!0})}return t}clear({removeIndices:t=!1}={}){if(this._data=[],this._idIndex=[],this._cached=null,this._maxId=0,this._dynamicViews=[],this._dirty=!0,t===!0)this._rangedIndexes={},this._constraints={unique:{}};else{for(let r in this._rangedIndexes)this.ensureRangedIndex(r,this._rangedIndexes[r].indexTypeName,this._rangedIndexes[r].comparatorName);const i=Object.keys(this._constraints.unique);for(let r=0;r<i.length;r++)this._constraints.unique[i[r]].clear()}this._fullTextSearch!==null&&this._fullTextSearch.clear()}update(t){if(Array.isArray(t)){for(let i=0;i<t.length;i++)this.update(t[i]);return}if(t.$loki===void 0)throw new Error("Trying to update unsynced document. Please save the document first by using insert() or addMany()");try{this.startTransaction();const i=this.get(t.$loki,!0);if(!i)throw new Error("Trying to update a document not in collection.");let r=i[0],h=i[1],c=this._defineNestedProperties(this._cloneObjects||!this._disableDeltaChangesApi?_(t,this._cloneMethod):t);this.emit("pre-update",t),Object.keys(this._constraints.unique).forEach(k=>{this._constraints.unique[k].update(c.$loki,c[k])}),this._data[h]=c,this._lokimap[t.$loki]=c;for(let k=0;k<this._dynamicViews.length;k++)this._dynamicViews[k]._evaluateDocument(h,!1);for(let k in this._rangedIndexes)this._rangedIndexes[k].index.update(t.$loki,t[k]);this._idIndex[h]=c.$loki,this._fullTextSearch!==null&&this._fullTextSearch.updateDocument(t,h),this.commit(),this._dirty=!0,this._disableChangesApi?this._updateMeta(c):this._updateMetaWithChange(c,r);let v=c;this._cloneObjects&&(v=_(c,this._cloneMethod)),this.emit("update",v,r)}catch(i){throw this.rollback(),this.emit("error",i),i}}_add(t){if(typeof t!="object")throw new TypeError("Object being added needs to be an object");if(t.$loki!==void 0)throw new Error("Document is already in collection, please use update()");try{this.startTransaction(),this._maxId++,isNaN(this._maxId)&&(this._maxId=this._data[this._data.length-1].$loki+1);const i=t;i.$loki=this._maxId,this._disableMeta||(i.meta.version=0);const r=this._constraints.unique;for(const v in r)r[v]!==void 0&&r[v].set(i.$loki,i[v]);this._idIndex.push(i.$loki),this._lokimap[i.$loki]=i,this._data.push(i);const h=this._data.length-1,c=this._dynamicViews.length;for(let v=0;v<c;v++)this._dynamicViews[v]._evaluateDocument(h,!0);for(let v in this._rangedIndexes)this._serializableIndexes&&i[v]instanceof Date&&(i[v]=i[v].getTime()),this._rangedIndexes[v].index.insert(t.$loki,t[v]);return this._fullTextSearch!==null&&this._fullTextSearch.addDocument(i,h),this.commit(),this._dirty=!0,this._cloneObjects?_(i,this._cloneMethod):i}catch(i){throw this.rollback(),this.emit("error",i),i}}updateWhere(t,i){const r=this.where(t);try{for(let h=0;h<r.length;h++)this.update(i(r[h]))}catch(h){throw this.rollback(),h}}removeWhere(t){this.remove(this._data.filter(t))}removeDataOnly(){this.remove(this._data.slice())}remove(t){if(typeof t=="number"&&(t=this.get(t)),Array.isArray(t)){let i=0;const r=t.length;for(i;i<r;i++)this.remove(t[i]);return}if(t.$loki===void 0)throw new Error("Object is not a document stored in the collection");try{this.startTransaction();const i=this.get(t.$loki,!0),r=i[1];let h=typeof t=="number"?this.get(t):t;Object.keys(this._constraints.unique).forEach(c=>{c in h&&this._constraints.unique[c].remove(h.$loki)});for(let c=0;c<this._dynamicViews.length;c++)this._dynamicViews[c]._removeDocument(r);this._data.splice(r,1),this._idIndex.splice(r,1),delete this._lokimap[t.$loki];for(let c in this._rangedIndexes)this._rangedIndexes[c].index.remove(t.$loki);this._fullTextSearch!==null&&this._fullTextSearch.removeDocument(t,r),this.commit(),this._dirty=!0,this._disableChangesApi||this._createChange(this.name,"R",i[0]),this.emit("delete",i[0]),delete t.$loki,delete t.meta}catch(i){throw this.rollback(),this.emit("error",i),i}}getChanges(){return this._changes}setChangesApi(t,i=!0){this._disableChangesApi=t,this._disableDeltaChangesApi=t?!0:i}flushChanges(){this._changes=[]}_getObjectDelta(t,i){const r=i!==null&&typeof i=="object"?Object.keys(i):null;if(r&&r.length&&["string","boolean","number"].indexOf(typeof i)<0){const h={};for(let c=0;c<r.length;c++){const v=r[c];if(i.hasOwnProperty(v))if(!t.hasOwnProperty(v)||this._constraints.unique[v]!==void 0||v==="$loki"||v==="meta")h[v]=i[v];else{const k=this._getObjectDelta(t[v],i[v]);k!==void 0&&k!=={}&&(h[v]=k)}}return Object.keys(h).length===0?void 0:h}else return t===i?void 0:i}_getChangeDelta(t,i){return i?this._getObjectDelta(i,t):JSON.parse(JSON.stringify(t))}_createChange(t,i,r,h){this._changes.push({name:t,operation:i,obj:i==="U"&&!this._disableDeltaChangesApi?this._getChangeDelta(r,h):JSON.parse(JSON.stringify(r))})}_createInsertChange(t){this._createChange(this.name,"I",t)}_createUpdateChange(t,i){this._createChange(this.name,"U",t,i)}_insertMetaWithChange(t){this._insertMeta(t),this._createInsertChange(t)}_updateMetaWithChange(t,i){this._updateMeta(t),this._createUpdateChange(t,i)}_insertMeta(t){this._disableMeta||(t.meta||(t.meta={version:0,revision:0,created:0}),t.meta.created=new Date().getTime(),t.meta.revision=0)}_updateMeta(t){this._disableMeta||(t.meta.updated=new Date().getTime(),t.meta.revision+=1)}get(t,i=!1){if(!i){let k=this._lokimap[t];return k===void 0?null:k}const r=this._idIndex;let h=r.length-1,c=0,v=c+h>>1;if(t=typeof t=="number"?t:parseInt(t,10),isNaN(t))throw new TypeError("Passed id is not an integer");for(;r[c]<r[h];)v=c+h>>1,r[v]<t?c=v+1:h=v;return h===c&&r[c]===t?i?[this._data[c],c]:this._data[c]:null}by(t,i){let r=this._constraints.unique[t].get(i);return this._cloneObjects?_(this._lokimap[r],this._cloneMethod):this._lokimap[r]}findOne(t){t=t||{};const i=this.chain().find(t,!0).data();return Array.isArray(i)&&i.length===0?null:this._cloneObjects?_(i[0],this._cloneMethod):i[0]}chain(t,i){const r=new d(this);return t===void 0?r:r.transform(t,i)}find(t){return this.chain().find(t).data()}findOneUnindexed(t,i){let r=this._data.length,h;for(;r--;)if(this._data[r][t]===i)return h=this._data[r],h;return null}startTransaction(){if(this._transactional){let t={};for(let i in this._rangedIndexes)t[i].indexTypeName=this._rangedIndexes[i].indexTypeName,t[i].comparatorName=this._rangedIndexes[i].comparatorName,t[i].index=this._rangedIndexes[i].index.backup();this._cached={index:this._idIndex,data:_(this._data,this._cloneMethod),rangedIndexes:t};for(let i=0;i<this._dynamicViews.length;i++)this._dynamicViews[i].startTransaction()}}commit(){if(this._transactional){this._cached=null;for(let t=0;t<this._dynamicViews.length;t++)this._dynamicViews[t].commit()}}rollback(){if(this._transactional&&this._cached!==null){this._idIndex=this._cached.index,this._data=this._cached.data;for(let t=0;t<this._data.length;t++)this._data[t]=this._defineNestedProperties(this._data[t]);for(let t in this._cached.rangedIndexes){let i=this._cached.rangedIndexes[t],r=C.a[i.indexTypeName],h=E.a[i.comparatorName],c=r(t,h);c.restore(i.index),this._rangedIndexes[t].index=c}for(let t=0;t<this._dynamicViews.length;t++)this._dynamicViews[t].rollback()}}where(t){return this.chain().where(t).data()}mapReduce(t,i){return i(this._data.map(t))}eqJoin(t,i,r,h,c){return new d(this).eqJoin(t,i,r,h,c)}getStage(t){return this._stages[t]||(this._stages[t]={}),this._stages[t]}stage(t,i){const r=JSON.parse(JSON.stringify(i));return this.getStage(t)[i.$loki]=r,r}commitStage(t,i){const r=this.getStage(t),h=new Date().getTime();for(const c in r)this.update(r[c]),this._commitLog.push({timestamp:h,message:i,data:JSON.parse(JSON.stringify(r[c]))});this._stages[t]={}}extract(t){const i=[];for(let r=0;r<this._data.length;r++)i.push(this._data[r][t]);return i}min(t){return Math.min.apply(null,this.extractNumerical(t))}max(t){return Math.max.apply(null,this.extractNumerical(t))}minRecord(t){const i={index:0,value:0};if(this._data.length===0)return i.index=null,i.value=null,i;i.index=this._data[0].$loki,i.value=parseFloat(this._data[0][t]);for(let r=1;r<this._data.length;r++){const h=parseFloat(this._data[r][t]);i.value>h&&(i.value=h,i.index=this._data[r].$loki)}return i}maxRecord(t){const i={index:0,value:0};if(this._data.length===0)return i.index=null,i.value=null,i;i.index=this._data[0].$loki,i.value=parseFloat(this._data[0][t]);for(let r=1;r<this._data.length;r++){const h=parseFloat(this._data[r][t]);i.value<h&&(i.value=h,i.index=this._data[r].$loki)}return i}extractNumerical(t){return this.extract(t).map(parseFloat).filter(Number).filter(i=>!isNaN(i))}avg(t){return G(this.extractNumerical(t))}stdDev(t){return W(this.extractNumerical(t))}mode(t){const i={},r=this.extractNumerical(t);let h=r[0],c=-1/0;for(let v=0;v<r.length;v++){const k=r[v];i[k]?i[k]++:i[k]=1,i[k]>c&&(h=k,c=i[k])}return h}median(t){const i=this.extractNumerical(t);i.sort((h,c)=>h-c);const r=Math.floor(i.length/2);return i.length%2?i[r]:(i[r-1]+i[r])/2}}},function(z,D,p){"use strict";class w{constructor(s,x){this.nodes={},this.apex=null,this.name=s,this.comparator=x}backup(){let s=new w(this.name,this.comparator);return s.nodes=JSON.parse(JSON.stringify(this.nodes)),s.apex=this.apex,s}restore(s){this.name=s.name,this.comparator=s.comparator,this.nodes=JSON.parse(JSON.stringify(s.nodes)),this.apex=s.apex}insert(s,x){if(s<=0)throw new Error("avl index ids are required to be numbers greater than zero");let _=this.nodes[s]={id:s,value:x,parent:null,balance:0,height:0,left:null,right:null,siblings:[]};if(!this.apex){this.apex=s;return}this.insertNode(this.nodes[this.apex],_)}insertNode(s,x){switch(this.comparator(x.value,s.value)){case 0:s.siblings.push(x.id),x.parent=s.id;break;case 1:s.right?(this.insertNode(this.nodes[s.right],x),this.updateBalance(s)):(s.right=x.id,x.parent=s.id,this.updateBalance(s));break;case-1:s.left?(this.insertNode(this.nodes[s.left],x),this.updateBalance(s)):(s.left=x.id,x.parent=s.id,this.updateBalance(s));break;default:throw new Error("Invalid comparator result")}if(s.balance<-1){if(s.left===null)throw new Error("insertNode.balance() : left child should not be null");this.nodes[s.left].balance<=0?this.leftLeftCase(s):this.leftRightCase(s)}if(s.balance>1){if(s.right===null)throw new Error("insertNode.balance() : right child should not be null");this.nodes[s.right].balance>=0?this.rightRightCase(s):this.rightLeftCase(s)}return s.height}updateBalance(s){let x=s.left?this.nodes[s.left].height:-1,_=s.right?this.nodes[s.right].height:-1;s.height=x>_?1+x:1+_,s.balance=_-x}leftLeftCase(s){return this.rotateRight(s)}leftRightCase(s){if(!s.left)throw new Error("leftRightCase: left child not set");return s.left=this.rotateLeft(this.nodes[s.left]).id,this.rotateRight(s)}rightRightCase(s){return this.rotateLeft(s)}rightLeftCase(s){if(!s.right)throw new Error("rightLeftCase: right child not set");return s.right=this.rotateRight(this.nodes[s.right]).id,this.rotateLeft(s)}rotateLeft(s){if(!s.right)throw new Error("rotateLeft: right child was unavailable.");let x=s.parent?this.nodes[s.parent]:null,_=this.nodes[s.right];if(s.right=_.left,s.right&&(this.nodes[s.right].parent=s.id),_.left=s.id,_.parent=s.parent,s.parent=_.id,x)if(x.left===s.id)x.left=_.id;else if(x.right===s.id)x.right=_.id;else throw new Error("rotateLeft() : attempt to remap parent back to child failed... not found");else{if(this.apex!==s.id)throw new Error("rightRotate expecting parentless node to be apex");this.apex=_.id}return this.updateBalance(s),this.updateBalance(_),_}rotateRight(s){if(!s.left)throw new Error("rotateRight : left child unavailable");let x=s.parent?this.nodes[s.parent]:null,_=this.nodes[s.left];if(s.left=_.right,_.right&&(this.nodes[_.right].parent=s.id),_.right=s.id,_.parent=s.parent,s.parent=_.id,x)x.left===s.id?x.left=_.id:x.right=_.id;else{if(this.apex!==s.id)throw new Error("rightRotate expecting parentless node to be apex");this.apex=_.id}return this.updateBalance(s),this.updateBalance(_),_}getValuesAsTree(s){return this.apex===null?null:(s=s||this.nodes[this.apex],{id:s.id,val:s.value,siblings:s.siblings,balance:s.balance,height:s.height,left:s.left?this.getValuesAsTree(this.nodes[s.left]):null,right:s.right?this.getValuesAsTree(this.nodes[s.right]):null})}update(s,x){let _=this.nodes[s];this.comparator(_.value,x)!==0&&(this.remove(s),this.insert(s,x))}remove(s){if(!this.apex)throw new Error("remove() : attempting remove when tree has no apex");this.removeNode(this.nodes[this.apex],s)}removeNode(s,x){if(!this.nodes[x])throw new Error("removeNode: attempting to remove a node which is not in hashmap");let _=this.nodes[x].value;switch(this.comparator(_,s.value)){case 0:if(s.siblings.length>0)if(s.id===x){let S=s.siblings.shift(),E=this.nodes[S];E.parent=s.parent,this.updateChildLink(s.parent,x,S),s.left&&(this.nodes[s.left].parent=S),s.right&&(this.nodes[s.right].parent=S),E.left=s.left,E.right=s.right,E.siblings=s.siblings,E.height=s.height,E.balance=s.balance,this.apex===x&&(this.apex=S);for(let P of E.siblings)this.nodes[P].parent=S;delete this.nodes[x];return}else{let S=s.siblings.indexOf(x);if(S===-1)throw new Error("Unable to remove sibling from parented sibling");s.siblings.splice(S,1),delete this.nodes[x];return}else{if(!s.left&&!s.right){this.updateChildLink(s.parent,s.id,null),delete this.nodes[x],x===this.apex&&(this.apex=null);return}if(!s.left||!s.right){s.left&&(this.promoteChild(s,this.nodes[s.left]),this.apex===x&&(this.apex=s.left)),s.right&&(this.promoteChild(s,this.nodes[s.right]),this.apex===x&&(this.apex=s.right));return}this.promoteSuccessor(s);return}case 1:if(!s.right)throw new Error("removeNode: Unable to find value in tree");this.removeNode(this.nodes[s.right],x);break;case-1:if(!s.left)throw new Error("removeNode: Unable to find value in tree");this.removeNode(this.nodes[s.left],x);break}if(this.updateBalance(s),s.balance<-1){if(s.left===null)throw new Error("insertNode.balance() : left child should not be null");this.nodes[s.left].balance<=0?this.leftLeftCase(s):this.leftRightCase(s)}if(s.balance>1){if(s.right===null)throw new Error("insertNode.balance() : right child should not be null");this.nodes[s.right].balance>=0?this.rightRightCase(s):this.rightLeftCase(s)}}updateChildLink(s,x,_){if(s===null)return;let S=this.nodes[s];S.left===x?S.left=_:S.right===x&&(S.right=_)}promoteChild(s,x){let _=s.parent;if(_){let S=this.nodes[_];S.left===s.id?S.left=x.id:S.right===s.id&&(S.right=x.id)}x.parent=_,delete this.nodes[s.id]}promoteSuccessor(s){let x=s.id;if(!s.right||!s.left)throw new Error("promoteSuccessor() : node to replace does not have two children");let _=null,S,E,P;if(s.balance<0){let u=this.nodes[s.left];_=this.findGreaterLeaf(u),S=_.id,E=_.value,P=_.siblings,_.siblings=[],this.removeNode(u,S)}else{let u=this.nodes[s.right];_=this.findLesserLeaf(u),S=_.id,E=_.value,P=_.siblings,_.siblings=[],this.removeNode(u,S)}if(s.parent){let u=this.nodes[s.parent];u.left===x&&(u.left=S),u.right===x&&(u.right=S)}s.left&&(this.nodes[s.left].parent=S),s.right&&(this.nodes[s.right].parent=S),s.id=S,s.value=E,s.siblings=P,this.nodes[S]=s,delete this.nodes[x],this.apex===x&&(this.apex=S),this.updateBalance(s)}findGreaterLeaf(s){if(!s.right)return s;let x=this.findGreaterLeaf(this.nodes[s.right]);return x||s}findLesserLeaf(s){if(!s.left)return s;let x=this.findLesserLeaf(this.nodes[s.left]);return x||s}rangeRequest(s){if(!this.apex)return[];if(!s)return this.collateIds(this.nodes[this.apex]);if(s.op==="$eq"){let _=this.locate(this.nodes[this.apex],s.val);return _===null?[]:_.siblings.length?[_.id,..._.siblings]:[_.id]}return this.collateRequest(this.nodes[this.apex],s)}collateRequest(s,x){let _=[];if(x.op==="$eq")throw new Error("collateRequest does not support $eq range request");let S=this.comparator(s.value,x.val),E=0;if(x.op==="$between"){if(x.high===null||x.high===void 0)throw new Error("collateRequest: $between request missing high range value");E=this.comparator(s.value,x.high)}if(s.left)switch(x.op){case"$lt":case"$lte":_=this.collateRequest(this.nodes[s.left],x);break;case"$gt":case"$gte":S===1&&(_=this.collateRequest(this.nodes[s.left],x));break;case"$between":S===1&&(_=this.collateRequest(this.nodes[s.left],x));break;default:break}if(!x)_.push(s.id),_.push(...s.siblings);else switch(x.op){case"$lt":S===-1&&(_.push(s.id),_.push(...s.siblings));break;case"$lte":(S===-1||S===0)&&(_.push(s.id),_.push(...s.siblings));break;case"$gt":S===1&&(_.push(s.id),_.push(...s.siblings));break;case"$gte":(S===1||S===0)&&(_.push(s.id),_.push(...s.siblings));break;case"$between":S>=0&&E<=0&&(_.push(s.id),_.push(...s.siblings));break;default:break}if(s.right)if(!x)_.push(...this.collateRequest(this.nodes[s.right],x));else switch(x.op){case"$lt":case"$lte":S===-1&&_.push(...this.collateRequest(this.nodes[s.right],x));break;case"$gt":case"$gte":_.push(...this.collateRequest(this.nodes[s.right],x));break;case"$between":E===-1&&_.push(...this.collateRequest(this.nodes[s.right],x));break;default:break}return _}collateIds(s){let x=[];return s?(s.left&&(x=this.collateIds(this.nodes[s.left])),x.push(s.id),x.push(...s.siblings),s.right&&x.push(...this.collateIds(this.nodes[s.right])),x):[]}locate(s,x){for(;s!==null;)switch(this.comparator(x,s.value)){case 0:return s;case 1:if(!s.right)return null;s=this.nodes[s.right];break;case-1:if(!s.left)return null;s=this.nodes[s.left];break}return null}validateIndex(){if(!this.apex)return Object.keys(this.nodes).length===0;if(this.nodes[this.apex].parent!==null)return!1;let s=this.collateIds(this.nodes[this.apex]),x=Object.keys(this.nodes).length;if(s.length!==x)return!1;if(s.length===1)return!(this.nodes[s[0]].parent!==null||this.nodes[s[0]].left!==null||this.nodes[s[0]].right!==null);for(let _=0;_<s.length-1;_++)if(this.comparator(this.nodes[s[_]].value,this.nodes[s[_+1]].value)===1)return!1;return this.validateNode(this.nodes[this.apex])}validateNode(s){if([s.parent,s.left,s.right].indexOf(s.id)!==-1)return!1;let x=s.left?this.nodes[s.left].height:-1,_=s.right?this.nodes[s.right].height:-1,S=1+Math.max(x,_);if(s.height!==S||s.balance!==_-x)return!1;if(s.siblings.length>0){for(let E of s.siblings)if(this.nodes[E].parent!==s.id)return!1}return!(s.left&&(this.nodes[s.left].parent!==s.id||!this.validateNode(this.nodes[s.left]))||s.right&&(this.nodes[s.right].parent!==s.id||!this.validateNode(this.nodes[s.right])))}}p.d(D,"a",function(){return y});let y={avl:(I,s)=>new w(I,s)}},function(z,D,p){"use strict";p.d(D,"a",function(){return w});class w{constructor(){this._events={},this._asyncListeners=!1}on(I,s){let x;return Array.isArray(I)?(I.forEach(_=>{this.on(_,s)}),s):(x=this._events[I],x||(x=this._events[I]=[]),x.push(s),s)}emit(I,...s){I&&this._events[I]&&this._events[I].forEach(x=>{this._asyncListeners?setTimeout(()=>{x(...s)},1):x(...s)})}addListener(I,s){return this.on(I,s)}removeListener(I,s){if(Array.isArray(I)&&I.forEach(x=>{this.removeListener(x,s)}),this._events[I]){const x=this._events[I];x.splice(x.indexOf(s),1)}}}},function(z,D,p){"use strict";(function(w){p.d(D,"a",function(){return P});var y=p(5),I=p(3),s=p(1),x=p(0),_=p(4),S=p(2);function E(){if(w!==void 0&&(w.android||w.NSObject))return"NATIVESCRIPT";if(w!==void 0&&{}.toString.call(w.process)==="[object process]")return w.window,"NODEJS";if(document!==void 0)return document.URL.indexOf("http://")===-1&&document.URL.indexOf("https://")===-1?"CORDOVA":"BROWSER";if(window!==void 0&&{}.toString.call(window)==="[object Window]")return"BROWSER";throw SyntaxError("Unknown environment...")}class P extends y.a{constructor(l="loki.db",d={}){super();if(this.databaseVersion=1.5,this.engineVersion=1.5,this._persistenceMethod=null,this._persistenceAdapter=null,this._throttledSaves=!0,this._throttledSaveRunning=null,this._throttledSavePending=null,this._autosave=!1,this._autosaveInterval=5e3,this._autosaveRunning=!1,this._autosaveHandler=Promise.resolve(),this.filename=l,this._collections=[],{serializationMethod:this._serializationMethod="normal",destructureDelimiter:this._destructureDelimiter=`$<
`,env:this._env=E()}=d,this._events={init:[],loaded:[],flushChanges:[],close:[],changes:[],warning:[]},d.comparatorMap)for(let m in d.comparatorMap)x.a[m]=d.comparatorMap[m];if(d.rangedIndexFactoryMap)for(let m in d.rangedIndexFactoryMap)_.a[m]=d.rangedIndexFactoryMap[m];if(d.lokiOperatorPackageMap)for(let m in d.lokiOperatorPackageMap)S.a[m]=d.lokiOperatorPackageMap[m];this.on("init",this.clearChanges)}initializePersistence(l={}){let d=this._autosaveDisable();({autosave:this._autosave=!1,autosaveInterval:this._autosaveInterval=5e3,persistenceMethod:this._persistenceMethod,throttledSaves:this._throttledSaves=!0}=l);const m={NODEJS:["fs-storage"],BROWSER:["local-storage","indexed-storage"],CORDOVA:["local-storage","indexed-storage"],MEMORY:["memory-storage"]},C={"fs-storage":s.a.FSStorage,"local-storage":s.a.LocalStorage,"indexed-storage":s.a.IndexedStorage,"memory-storage":s.a.MemoryStorage};if(this._persistenceMethod!==void 0)if(typeof C[this._persistenceMethod]=="function")this._persistenceAdapter=new C[this._persistenceMethod];else throw Error("Unknown persistence method.");if(l.adapter!==void 0&&(this._persistenceMethod="adapter",this._persistenceAdapter=l.adapter),this._persistenceAdapter===null){let e=m[this._env];if(e){for(let G=0;G<e.length;G++)if(C[e[G]]){this._persistenceMethod=e[G],this._persistenceAdapter=new C[e[G]];break}}}return l.autoload&&(d=d.then(()=>this._loadDatabase(l.inflate,!0))),d.then(()=>{this._autosaveEnable()})}copy(l={}){const d=new P(this.filename,{env:this._env});if(d.loadJSONObject(this,{retainDirtyFlags:!0}),l.removeNonSerializable){d._persistenceAdapter=null;for(let m=0;m<d._collections.length;m++)d._collections[m]._constraints=null,d._collections[m]._ttl=null}return d}addCollection(l,d={}){for(let C=0;C<this._collections.length;C++)if(this._collections[C].name===l)return this._collections[C];const m=new I.a(l,d);return this._collections.push(m),m}loadCollection(l){if(!l.name)throw new Error("Collection must have a name property to be loaded");this._collections.push(l)}getCollection(l){for(let d=0;d<this._collections.length;d++)if(this._collections[d].name===l)return this._collections[d];return this.emit("warning","collection "+l+" not found"),null}renameCollection(l,d){const m=this.getCollection(l);return m&&(m.name=d),m}listCollections(){const l=[];for(let d=0;d<this._collections.length;d++)l.push({name:this._collections[d].name,count:this._collections[d].count()});return l}removeCollection(l){for(let d=0;d<this._collections.length;d++)if(this._collections[d].name===l){const m=new I.a(l,{}),C=this._collections[d];for(const e in C)C[e]!==void 0&&m[e]!==void 0&&(C[e]=m[e]);this._collections.splice(d,1);return}}serialize(l={}){switch(l.serializationMethod===void 0&&(l.serializationMethod=this._serializationMethod),l.serializationMethod){case"normal":return JSON.stringify(this);case"pretty":return JSON.stringify(this,null,2);case"destructured":return this.serializeDestructured();default:return JSON.stringify(this)}}toJSON(){return{_env:this._env,_serializationMethod:this._serializationMethod,_autosave:this._autosave,_autosaveInterval:this._autosaveInterval,_collections:this._collections,databaseVersion:this.databaseVersion,engineVersion:this.engineVersion,filename:this.filename,_persistenceAdapter:this._persistenceAdapter,_persistenceMethod:this._persistenceMethod,_throttledSaves:this._throttledSaves}}serializeDestructured(l={}){if(l.partitioned===void 0&&(l.partitioned=!1),l.delimited===void 0&&(l.delimited=!0),l.delimiter===void 0&&(l.delimiter=this._destructureDelimiter),l.partitioned===!0&&l.partition!==void 0&&l.partition>=0)return this.serializeCollection({delimited:l.delimited,delimiter:l.delimiter,collectionIndex:l.partition});let d=new P(this.filename);d.loadJSONObject(this);for(let C=0;C<d._collections.length;C++)d._collections[C]._data=[];if(l.partitioned===!0&&l.partition===-1)return d.serialize({serializationMethod:"normal"});const m=[];m.push(d.serialize({serializationMethod:"normal"})),d=null;for(let C=0;C<this._collections.length;C++){let e=this.serializeCollection({delimited:l.delimited,delimiter:l.delimiter,collectionIndex:C});if(l.partitioned===!1&&l.delimited===!1){if(!Array.isArray(e))throw new Error("a nondelimited, non partitioned collection serialization did not return an expected array");for(let G=0;G<e.length;G++)m.push(e[G]),e[G]=null;m.push("")}else m.push(e)}return l.partitioned?(l.delimited,m):l.delimited?(m.push(""),m.join(l.delimiter)):(m.push(""),m)}serializeCollection(l={}){if(l.delimited===void 0&&(l.delimited=!0),l.collectionIndex===void 0)throw new Error("serializeCollection called without 'collectionIndex' option");const d=this._collections[l.collectionIndex].count();let m=[];for(let C=0;C<d;C++)m.push(JSON.stringify(this._collections[l.collectionIndex]._data[C]));return l.delimited?(m.push(""),m.join(l.delimiter)):m}deserializeDestructured(l,d={}){if(d.partitioned===void 0&&(d.partitioned=!1),d.delimited===void 0&&(d.delimited=!0),d.delimiter===void 0&&(d.delimiter=this._destructureDelimiter),d.partitioned){if(d.partition!==void 0)return d.partition===-1?JSON.parse(l[0]):this.deserializeCollection(l[d.partition+1],d);const ee=JSON.parse(l[0]),A=ee._collections.length;for(let t=0;t<A;t++)ee._collections[t]._data=this.deserializeCollection(l[t+1],d);return ee}let m=[];if(d.delimited){if(m=l.split(d.delimiter),l=null,m.length===0)return null}else m=l;const C=JSON.parse(m[0]),e=C._collections.length;m[0]=null;let G=0,W=1,re=!1;for(;!re;)m[W]===""?++G>e&&(re=!0):C._collections[G]._data.push(JSON.parse(m[W])),m[W++]=null;return C}deserializeCollection(l,d={}){d.partitioned===void 0&&(d.partitioned=!1),d.delimited===void 0&&(d.delimited=!0),d.delimiter===void 0&&(d.delimiter=this._destructureDelimiter);let m=[];d.delimited?(m=l.split(d.delimiter),m.pop()):m=l;for(let C=0;C<m.length;C++)m[C]=JSON.parse(m[C]);return m}loadJSON(l,d){let m;if(l.length===0)m={};else switch(this._serializationMethod){case"normal":case"pretty":m=JSON.parse(l);break;case"destructured":m=this.deserializeDestructured(l);break;default:m=JSON.parse(l);break}this.loadJSONObject(m,d)}loadJSONObject(l,d={}){const m=l._collections?l._collections.length:0;this.filename=l.filename,this._collections=[];for(let C=0;C<m;++C)this._collections.push(I.a.fromJSONObject(l._collections[C],d))}close(){return this._autosave?this._autosaveDisable().then(()=>this._autosaveDirty()?this.saveDatabase():Promise.resolve()):Promise.resolve().then(()=>{this.emit("close")})}generateChangesNotification(l){let d=[];const m=l||this._collections.map(C=>C.name);return this._collections.forEach(C=>{m.indexOf(C.name)!==-1&&(d=d.concat(C.getChanges()))}),d}serializeChanges(l){return JSON.stringify(this.generateChangesNotification(l))}clearChanges(){this._collections.forEach(l=>{l.flushChanges&&l.flushChanges()})}throttledSaveDrain(l={}){const d=new Date().getTime();return this._throttledSaves?(l.recursiveWait===void 0&&(l.recursiveWait=!0),l.recursiveWaitLimit===void 0&&(l.recursiveWaitLimit=!1),l.recursiveWaitLimitDuration===void 0&&(l.recursiveWaitLimitDuration=2e3),l.started===void 0&&(l.started=new Date),this._throttledSaves&&this._throttledSaveRunning!==null?l.recursiveWait?Promise.resolve(Promise.all([this._throttledSaveRunning,this._throttledSavePending])).then(()=>this._throttledSaveRunning!==null||this._throttledSavePending!==null?l.recursiveWaitLimit&&d-l.started.getTime()>l.recursiveWaitLimitDuration?Promise.reject({}):this.throttledSaveDrain(l):Promise.resolve()):Promise.resolve(this._throttledSaveRunning):Promise.resolve()):Promise.resolve()}_loadDatabase(l={},d=!1){return this._persistenceAdapter===null?Promise.reject(new Error("persistenceAdapter not configured")):Promise.resolve(this._persistenceAdapter.loadDatabase(this.filename)).then(m=>{if(typeof m=="string")this.loadJSON(m,l),this.emit("load",this);else if(typeof m=="object"&&m!==null&&!(m instanceof Error))this.loadJSONObject(m,l),this.emit("load",this);else throw m}).catch(m=>{if(m instanceof Error)throw m;if(m!=null)throw new TypeError("The persistence adapter did not load a serialized DB string or object.");if(!d)throw new Error("Database not found.")})}loadDatabase(l={}){return this._throttledSaves?this.throttledSaveDrain(l).then(()=>(this._throttledSaveRunning=this._loadDatabase(l).then(()=>{this._throttledSaveRunning=null}),this._throttledSaveRunning),()=>{throw new Error("Unable to pause save throttling long enough to read database")}):this._loadDatabase(l)}_saveDatabase(){return this._persistenceAdapter===null?Promise.reject(new Error("persistenceAdapter not configured")):this._persistenceAdapter.mode==="reference"&&typeof this._persistenceAdapter.exportDatabase=="function"?Promise.resolve(this._persistenceAdapter.exportDatabase(this.filename,this.copy({removeNonSerializable:!0}))).then(()=>{this._autosaveClearFlags(),this.emit("save")}):(this._autosaveClearFlags(),Promise.resolve(this._persistenceAdapter.saveDatabase(this.filename,this.serialize())).then(()=>{this.emit("save")}))}saveDatabase(){return this._throttledSaves?(this._throttledSaveRunning!==null&&this._throttledSavePending===null&&(this._throttledSavePending=Promise.resolve(this._throttledSaveRunning).then(()=>(this._throttledSaveRunning=null,this._throttledSavePending=null,this.saveDatabase()))),this._throttledSavePending!==null?this._throttledSavePending:(this._throttledSaveRunning=this._saveDatabase().then(()=>{this._throttledSaveRunning=null}),this._throttledSaveRunning)):this._saveDatabase()}deleteDatabase(){return this._persistenceAdapter===null?Promise.reject(new Error("persistenceAdapter not configured")):Promise.resolve(this._persistenceAdapter.deleteDatabase(this.filename))}_autosaveDirty(){for(let l=0;l<this._collections.length;l++)if(this._collections[l]._dirty)return!0;return!1}_autosaveClearFlags(){for(let l=0;l<this._collections.length;l++)this._collections[l]._dirty=!1}_autosaveEnable(){if(!this._autosave||this._autosaveRunning)return;this._autosaveRunning=!0;const l=setInterval(()=>{this._autosaveRunning?this._autosaveDirty()&&(this._autosaveHandler=this._autosaveHandler.then(()=>this.saveDatabase())):clearInterval(l)},this._autosaveInterval)}_autosaveDisable(){return this._autosaveRunning=!1,this._autosaveHandler}}}).call(this,p(7))},function(z,D){var p;p=function(){return this}();try{p=p||Function("return this")()||(0,eval)("this")}catch(w){typeof window=="object"&&(p=window)}z.exports=p},function(z,D,p){"use strict";p.r(D);var w=p(6);p.d(D,"Loki",function(){return w.a});var y=p(3);p.d(D,"Collection",function(){return y.a}),w.a.Collection=y.a,D.default=w.a}])})},442:function($,ie,B){(function(D,p){$.exports=p()})(typeof self!="undefined"?self:this,function(){return function(z){var D={};function p(w){if(D[w])return D[w].exports;var y=D[w]={i:w,l:!1,exports:{}};return z[w].call(y.exports,y,y.exports,p),y.l=!0,y.exports}return p.m=z,p.c=D,p.d=function(w,y,I){p.o(w,y)||Object.defineProperty(w,y,{enumerable:!0,get:I})},p.r=function(w){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(w,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(w,"__esModule",{value:!0})},p.t=function(w,y){if(y&1&&(w=p(w)),y&8||y&4&&typeof w=="object"&&w&&w.__esModule)return w;var I=Object.create(null);if(p.r(I),Object.defineProperty(I,"default",{enumerable:!0,value:w}),y&2&&typeof w!="string")for(var s in w)p.d(I,s,function(x){return w[x]}.bind(null,s));return I},p.n=function(w){var y=w&&w.__esModule?function(){return w.default}:function(){return w};return p.d(y,"a",y),y},p.o=function(w,y){return Object.prototype.hasOwnProperty.call(w,y)},p.p="",p(p.s=1)}([function(z,D,p){"use strict";(function(w){p.d(D,"a",function(){return s});function y(){let x;return function(_){x=_}(w!==void 0&&w||this),x}function I(){const x=y(),_=Symbol.for("LOKI");return x[_]===void 0&&(x[_]={}),x[_]}const s=I()}).call(this,p(2))},function(z,D,p){"use strict";p.r(D);function w(O){return O.split(/[\s]+/)}function y(O){return O.toLowerCase()}function I(O){return O.toUpperCase()}function s(O,n){if(O.char_filter)for(let a=0;a<O.char_filter.length;a++)n=O.char_filter[a](n);const f=O.tokenizer(n);if(O.token_filter)for(let a=0;a<f.length;a++)for(let o=0;o<O.token_filter.length;o++)f[a]=O.token_filter[o](f[a],a,f);return f.filter(a=>a)}class x{constructor(){this.tokenizer=w,this.token_filter=[y]}}function _(O){const n=[];for(let f=0;f<O.length;){const a=O.charCodeAt(f++);if(a>=55296&&a<=56319){const o=O.charCodeAt(f++);n.push(65536+(a-55296<<10)|o-56320)}else n.push(a)}return n}class S{constructor(n={}){this.docCount=0,this.docStore=new Map,this.totalFieldLength=0,this.root=new Map,{store:this._store=!0,optimizeChanges:this._optimizeChanges=!0,analyzer:this.analyzer=new x}=n}insert(n,f){if(this.docStore.has(f))throw Error("Field already added.");const a=s(this.analyzer,n);if(a.length==0){this.docStore.set(f,{fieldLength:0});return}this.totalFieldLength+=a.length,this.docCount+=1,this.docStore.set(f,{fieldLength:a.length});const o=[];this._optimizeChanges&&Object.defineProperties(this.docStore.get(f),{indexRef:{enumerable:!1,configurable:!0,writable:!0,value:o}});for(const g of new Set(a)){let b=0;for(let M=0;M<a.length;M++)a[M]===g&&++b;let N=this.root;for(const M of _(g)){let R=N.get(M);R===void 0&&(R=new Map,this._optimizeChanges&&(R.pa=N),N.set(M,R)),N=R}N.dc===void 0&&(N.dc=new Map,N.df=0),N.dc.set(f,b),N.df+=1,o.push(N)}}remove(n){if(!this.docStore.has(n))return;const f=this.docStore.get(n);if(this.docStore.delete(n),f.fieldLength!==0)if(this.docCount-=1,this.totalFieldLength-=f.fieldLength,this._optimizeChanges){const a=f.indexRef;for(let o=0;o<a.length;o++){let g=a[o];if(g.df-=1,g.dc.delete(n),g.df===0){if(delete g.df,delete g.dc,g.size!==0)continue;do{const b=g.pa;delete g.pa;for(const N of b.keys())if(b.get(N)===g){b.delete(N);break}g=b}while(g.pa!==void 0&&g.size===0&&g.df===void 0)}}}else this._remove(this.root,n)}static getTermIndex(n,f,a=0){if(a>=n.length)return null;for(let o=a;o<n.length;o++){let g=f.get(n[o]);if(g===void 0)return null;f=g}return f}static extendTermIndex(n,f=[],a=[]){n.df!==void 0&&a.push({index:n,term:f.slice()}),f.push(0);for(const o of n)f[f.length-1]=o[0],S.extendTermIndex(o[1],f,a);return f.pop(),a}toJSON(){return this._store?{_store:!0,_optimizeChanges:this._optimizeChanges,docCount:this.docCount,docStore:[...this.docStore],totalFieldLength:this.totalFieldLength,root:S._serializeIndex(this.root)}:{_store:!1,_optimizeChanges:this._optimizeChanges}}static fromJSONObject(n,f){const a=new S({store:n._store,optimizeChanges:n._optimizeChanges,analyzer:f});return n._store&&(a.docCount=n.docCount,a.docStore=new Map(n.docStore),a.totalFieldLength=n.totalFieldLength,a.root=S._deserializeIndex(n.root)),a._optimizeChanges&&a._regenerate(a.root,null),a}static _serializeIndex(n){const f={};if(n.dc!==void 0&&(f.d={df:n.df,dc:[...n.dc]}),n.size===0)return f;const a=[],o=[];for(const g of n)a.push(g[0]),o.push(S._serializeIndex(g[1]));return f.k=a,f.v=o,f}static _deserializeIndex(n){const f=new Map;if(n.k!==void 0)for(let a=0;a<n.k.length;a++)f.set(n.k[a],S._deserializeIndex(n.v[a]));return n.d!==void 0&&(f.df=n.d.df,f.dc=new Map(n.d.dc)),f}_regenerate(n,f){f!==null&&(n.pa=f);for(const a of n.values())this._regenerate(a,n);if(n.dc!==void 0)for(const a of n.dc.keys()){const o=this.docStore.get(a);o.indexRef===void 0&&Object.defineProperties(o,{indexRef:{enumerable:!1,configurable:!0,writable:!0,value:[]}}),o.indexRef.push(n)}}_remove(n,f){for(const a of n)this._remove(a[1],f)&&n.delete(a[0]);return n.df!==void 0&&n.dc.has(f)&&(n.df-=1,n.dc.delete(f),n.df===0&&(delete n.df,delete n.dc)),n.size===0&&n.dc===void 0}}class E{constructor(n){this._cache={},this._invIdxs=n}setDirty(){this._cache={}}score(n,f,a,o,g,b,N=0){if(a===null||a.dc===void 0)return;const M=this._idf(n,N||a.df);for(const[R,T]of a.dc)g.has(R)||g.set(R,[]),o===!0?g.get(R).push({tf:T,idf:M,boost:f,fieldName:n,term:b}):o===!1?g.set(R,[{boost:f}]):g.set(R,[{boost:0}])}scoreConstant(n,f,a){return a.has(f)||a.set(f,[]),a.get(f).push({boost:n}),a}finalScore(n,f){const a={},o=n.bm25!==void 0?n.bm25.k1:1.2,g=n.bm25!==void 0?n.bm25.b:.75,b=n.explain!==void 0?n.explain:!1;for(const[N,M]of f){let R=0,T=[];for(let U=0;U<M.length;U++){const F=M[U];let ne=0;if(F.tf!==void 0){const se=F.tf,Q=E._calculateFieldLength(this._invIdxs[F.fieldName].docStore.get(N).fieldLength),Y=this._avgFieldLength(F.fieldName),te=se*(o+1)/(se+o*(1-g+g*(Q/Y)));ne=F.idf*te*F.boost,b&&T.push({boost:F.boost,score:ne,docID:N,fieldName:F.fieldName,index:String.fromCharCode(...F.term),idf:F.idf,tfNorm:te,tf:se,fieldLength:Q,avgFieldLength:Y})}else ne=F.boost,b&&T.push({boost:F.boost,score:ne});R+=ne}b?a[N]={score:R,explanation:T}:a[N]={score:R}}return a}static _calculateFieldLength(n){return n}_getCache(n){if(this._cache[n]===void 0){const f=this._invIdxs[n].totalFieldLength/this._invIdxs[n].docCount;this._cache[n]={idfs:{},avgFieldLength:f}}return this._cache[n]}_idf(n,f){const a=this._getCache(n);return a.idfs[f]!==void 0?a.idfs[f]:a.idfs[f]=Math.log(1+(this._invIdxs[n].docCount-f+.5)/(f+.5))}_avgFieldLength(n){return this._getCache(n).avgFieldLength}}class P{constructor(n){const f=n.getNumStates();this._points=n.getStartPoints(),this._accept=new Array(f),this._transitions=new Array(f*this._points.length);for(let a=0;a<f;a++){this._accept[a]=n.isAccept(a);for(let o=0;o<this._points.length;o++)this._transitions[a*this._points.length+o]=n.step(a,this._points[o])}this._classmap=new Array(256);for(let a=0,o=0;o<this._classmap.length;o++)a+1<this._points.length&&o===this._points[a+1]&&a++,this._classmap[o]=a}getCharClass(n){let f=0,a=this._points.length;for(;a-f>1;){const o=f+a>>>1;if(this._points[o]>n)a=o;else if(this._points[o]<n)f=o;else return o}return f}step(n,f){return f>=this._classmap.length?this._transitions[n*this._points.length+this.getCharClass(f)]:this._transitions[n*this._points.length+this._classmap[f]]}isAccept(n){return this._accept[n]}}const u=0,l=1114111;function d(O,n){return O[0]<n[0]?-1:O[0]>n[0]?1:O[1]<n[1]?-1:O[1]>n[1]?1:O[2]<n[2]?-1:O[2]>n[2]?1:0}function m(O,n){return O[1]<n[1]?-1:O[1]>n[1]?1:O[2]<n[2]?-1:O[2]>n[2]?1:O[0]<n[0]?-1:O[0]>n[0]?1:0}class C{constructor(){this._stateTransitions=[],this._stateTransitions=[],this._accept=new Set,this._nextState=0,this._currState=-1,this._transitions={}}isAccept(n){return this._accept.has(n)}createState(){return this._nextState++}setAccept(n,f){f?this._accept.add(n):this._accept.delete(n)}finishState(){this._currState!==-1&&(this._finishCurrentState(),this._currState=-1)}_finishCurrentState(){this._stateTransitions.sort(d);let n=0,f=[-1,-1,-1];for(let a=0,o=this._stateTransitions.length;a<o;a++){let g=this._stateTransitions[a];f[0]===g[0]?g[1]<=f[2]+1?g[2]>f[2]&&(f[2]=g[2]):(f[0]!==-1&&(this._stateTransitions[n][0]=f[0],this._stateTransitions[n][1]=f[1],this._stateTransitions[n][2]=f[2],n++),f[1]=g[1],f[2]=g[2]):(f[0]!==-1&&(this._stateTransitions[n][0]=f[0],this._stateTransitions[n][1]=f[1],this._stateTransitions[n][2]=f[2],n++),f[0]=g[0],f[1]=g[1],f[2]=g[2])}f[0]!==-1&&(this._stateTransitions[n][0]=f[0],this._stateTransitions[n][1]=f[1],this._stateTransitions[n][2]=f[2],n++),this._transitions[this._currState]=this._stateTransitions.slice(0,n).sort(m),this._stateTransitions=[]}getStartPoints(){const n=new Set;n.add(u);const f=Object.keys(this._transitions);for(let a=0;a<f.length;a++){let o=this._transitions[f[a]];for(let g=0;g<o.length;g++){let b=o[g];n.add(b[1]),b[2]<l&&n.add(b[2]+1)}}return Array.from(n).sort((a,o)=>a-o)}step(n,f){let a=this._transitions[n];if(a)for(let o=0;o<a.length;o++){let g=a[o];if(g[1]<=f&&f<=g[2])return g[0]}return-1}getNumStates(){return this._nextState}addTransition(n,f,a,o){this._currState!==n&&(this._currState!==-1&&this._finishCurrentState(),this._currState=n),this._stateTransitions.push([f,a,o])}}class e{constructor(n=0,f=0){this._low=n,this._high=f}shiftRight(n){return(n&=63)===0?this:n<32?new e(this._low>>>n|this._high<<32-n,this._high>>n):new e(this._high>>n-32,this._high>=0?0:-1)}shiftLeft(n){return(n&=63)===0?this:n<32?new e(this._low<<n,this._high<<n|this._low>>>32-n):new e(0,this._low<<n-32)}and(n){return new e(this._low&n._low,this._high&n._high)}toInt(){return this._low}}const G=[new e(1),new e(3),new e(7),new e(15),new e(31),new e(63),new e(127),new e(255),new e(511),new e(1023),new e(2047),new e(4095),new e(8191),new e(16383),new e(32767),new e(65535),new e(15,8191),new e(15,16383),new e(15,32767),new e(15,65535),new e(255,8191),new e(255,16383),new e(255,32767),new e(255,65535),new e(4095,8191),new e(4095,16383),new e(4095,32767),new e(4095,65535),new e(65535,8191),new e(65535,16383),new e(65535,32767),new e(65535,65535),new e(1048575,8191),new e(1048575,16383),new e(1048575,32767),new e(1048575,65535),new e(16777215,8191),new e(16777215,16383),new e(16777215,32767),new e(16777215,65535),new e(268435455,8191),new e(268435455,16383),new e(268435455,32767),new e(268435455,65535),new e(4294967295,8191),new e(4294967295,16383),new e(4294967295,32767),new e(4294967295,65535),new e(68719476735,8191),new e(68719476735,16383),new e(68719476735,32767),new e(68719476735,65535),new e(1099511627775,8191),new e(1099511627775,16383),new e(1099511627775,32767),new e(1099511627775,65535),new e(17592186044415,8191),new e(17592186044415,16383),new e(17592186044415,32767),new e(17592186044415,65535),new e(281474976710655,8191),new e(281474976710655,16383),new e(281474976710655,32767)];class W{constructor(n,f,a){this._w=n,this._n=f,this._minErrors=a}size(){return this._minErrors.length*(this._w+1)}isAccept(n){let f=Math.floor(n/(this._w+1)),a=n%(this._w+1);return this._w-a+this._minErrors[f]<=this._n}getPosition(n){return n%(this._w+1)}static unpack(n,f,a){const o=a*f,g=o>>6,b=o&63;if(b+a<=64)return n[g].shiftRight(b).and(G[a-1]).toInt();{const N=64-b;return n[g].shiftRight(b).and(G[N-1]).toInt()+n[1+g].and(G[a-N-1]).shiftLeft(N).toInt()}}}const re=[new e(2)],ee=[new e(0)],A=[new e(2627)],t=[new e(56)],i=[new e(2182348803,877873428),new e(109)],r=[new e(1436680192,21845)],h=[new e(2416705539,559024212),new e(1161073005,1531779490),new e(55860)],c=[new e(553385984,1431678474),new e(1431655765)];class v extends W{constructor(n){super(n,1,[0,1,0,-1,-1,-1])}transition(n,f,a){let o=Math.floor(n/(this._w+1)),g=n%(this._w+1);if(f===this._w){if(o<2){const b=a*2+o;g+=W.unpack(ee,b,1),o=W.unpack(re,b,2)-1}}else if(f===this._w-1){if(o<3){const b=a*3+o;g+=W.unpack(t,b,1),o=W.unpack(A,b,2)-1}}else if(f===this._w-2){if(o<6){const b=a*6+o;g+=W.unpack(r,b,2),o=W.unpack(i,b,3)-1}}else if(o<6){const b=a*6+o;g+=W.unpack(c,b,2),o=W.unpack(h,b,3)-1}return o===-1?-1:o*(this._w+1)+g}}const k=[new e(35)],J=[new e(0)],K=[new e(325618500)],H=[new e(992)],le=[new e(1375778052,1625010352),new e(654713383,1379082614),new e(338833973,592794674),new e(17236)],X=[new e(8192,1431339176),new e(1431655765,85)],j=[new e(1074107396,3875651625),new e(10813440,2685408800),new e(2705416840,2955709504),new e(822630592,176295986),new e(220770817,826549144),new e(2222426336,1384244520),new e(146941966,2721677523),new e(2841782156,506631345),new e(579396904,2353082526),new e(35310113,289686537),new e(2259748971,295985736),new e(492978372,711088276),new e(1217426605,1344578827),new e(1376534810,344070858),new e(190401092,1485354377),new e(3289490533,2484954400),new e(2909430484,2337837173),new e(441472420)],V=[new e(8192,3195650),new e(3288085308,704655603),new e(2189600800,591003698),new e(850559912,1431655765),new e(1431655765,1431655765),new e(1431655765,1431655765),new e(1431655765,1431655765)],L=[new e(2904068,58725456),new e(3640,3305111883),new e(1363153922,1300),new e(0),new e(335609856,85458955),new e(685900336,166838792),new e(2198499522,564071920),new e(136348160,2181038210),new e(1619003392,134546689),new e(39855683,813828486),new e(1347453028,1164181826),new e(536873009,139461908),new e(2231378050,1094735904),new e(160481793,1164017816),new e(1352667217,137456908),new e(84799712,558175264),new e(340820500,219423040),new e(1350704224,1008844824),new e(3407093895,30086147),new e(407994924,2148016453),new e(545259552,2097672),new e(2266497861,3490060320),new e(613903113,3406463435),new e(1648822737,145860110),new e(2183434377,38340640),new e(13811748,3272876486),new e(356860963,1009861909),new e(3256660288,830815266),new e(740327956,1158959115),new e(1351286865,141656116),new e(1359540421,2999666001),new e(481339408,3894702429),new e(2425032288,337824532),new e(3224154437,813771810),new e(212943372,2216698370),new e(550373456,1545653768),new e(2332913858,545392672),new e(337723912,1107841154),new e(1350765600,153125696),new e(325399954,3323153862),new e(1841617741,3540595740),new e(1423134004,1680136456),new e(50861250,2449943586),new e(614664496,1109422667),new e(633938146,611374880),new e(2539425922,2462657904),new e(76697096,3406332098),new e(3259769985,1165203240),new e(3663819994,3336195509),new e(1563465501,1264399831),new e(2474794210,271614300),new e(34386245,1363419217),new e(740429356,3308790030),new e(1389038960,139543060),new e(2232701250,541788240),new e(1079067660,2450874499),new e(2785961365,1298533965),new e(476956248,2497254628),new e(341103461,2187601497),new e(1359153171,680658732),new e(3408700171,3804373106),new e(542345488,1160540375),new e(1888368785,145935149),new e(3255087694,2177569856),new e(683854372,3661947790),new e(2245419236,499571301),new e(2388496718,3804978483),new e(949191224)],fe=[new e(524288,805437440),new e(2146400),new e(67108864,2169044992),new e(276973604,1076138561),new e(1610621058,3680514243),new e(807079296,1815527532),new e(897243,2954387888),new e(2441666669,460338720),new e(114847159,134255104),new e(37758096,76680228),new e(136613897,4784130),new e(672286724,1225265793),new e(306857122,880804100),new e(220463628,3272159376),new e(616713508,1073781257),new e(2449540634,77089286),new e(1898353250,1229784210),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,9362)],he=[new e(2904068,58725456),new e(3640,3305111883),new e(1363153922,1300),new e(0),new e(335609856,85196811),new e(59637984,5570560),new e(100708736,642062416),new e(136348168,2181570690),new e(1082263584,181504),new e(2156659014,1887570488),new e(2620424828,3279691970),new e(545261671,2130440),new e(33562752,2973765664),new e(5341184,2190352419),new e(547298336,137406220),new e(2235429087,1363481680),new e(340820500,370417986),new e(813715536,1613103716),new e(1124606104,621086726),new e(341196820,1107296387),new e(545587281,139461128),new e(336856450,2157513760),new e(136714249,2181140994),new e(2416314689,143787289),new e(3257709122,575218834),new e(23218476,1124599045),new e(2248302630,2151761173),new e(3316920642,935559200),new e(340819988,1107841157),new e(1350893649,21053528),new e(2550763714,1363501440),new e(206610448,3758633325),new e(1351295472,743623468),new e(3257709129,1611476114),new e(407929372,2268864960),new e(63640608,738315028),new e(1159221634,545261601),new e(136347648,1157636098),new e(545724419,141559316),new e(84419023,1946484981),new e(408981504,2471335494),new e(813845808,1277481805),new e(3321943618,25561121),new e(635093620,3265295049),new e(2445440114,745112472),new e(2300846658,2453800992),new e(883951872,2181591424),new e(2963079265,481446262),new e(2635903144,1625695344),new e(359976510,3541325271),new e(633494900,476056888),new e(1111241026,1364284500),new e(335790868,3257672139),new e(558045267,11715080),new e(85217605,54855856),new e(206604056,1427443855),new e(4060419156,141821184),new e(102297744,3797110162),new e(1704116792,1228416601),new e(566624470,1143194388),new e(3408729413,1925357634),new e(2693907828,1110194563),new e(1351298130,11715860),new e(2150936715,4039444593),new e(1162957064,2819666635),new e(1901927600,576776228),new e(2385343694,3864603731),new e(949191224,1108095105),new e(570559665,139494432),new e(3456639182,1891785760),new e(136350477,1107828866),new e(1350702113,203440648),new e(2200719491,554174592),new e(137937428,2768779394),new e(2848166960,2863311530),new e(2678717098,447381162),new e(337691400,2185765072),new e(2228833636,1904530289),new e(460404435,885148935),new e(355783501,2567517762),new e(818021680,137626888),new e(1398349970,886858038),new e(1303698529,2759444188),new e(1227133514,2450169746),new e(2173872170,1925324848),new e(814942496,119845450),new e(2450400290,225575516),new e(3372753479,2463566197),new e(618694956,2282496073),new e(3259505840,747801636),new e(2299037513,2158306440),new e(2865185684,1787173674),new e(2871505528,135998630),new e(120332803,2735288466),new e(1763036764,3614016979),new e(1998285110,1567933020),new e(2301457623,1917716851),new e(142656005,1277460939),new e(1939286210,1635048005),new e(3662525914,1252095430),new e(2252890502,1787206439),new e(813795018,212944144),new e(1142968578,571354193),new e(941690412,3406655685),new e(1363285074,340869640),new e(1258836101,1363414048),new e(339772204,3407106312),new e(1217071240,2486264328),new e(2675866051,4205477370),new e(2124930941,50862570),new e(550507601,1701086552),new e(2473165721,2517850499),new e(956767089,3647288901),new e(2521109812,81828105),new e(85213378,559286324),new e(1625708889,3596674266),new e(3336332676,2449992057),new e(3750905888,2821358087),new e(271614374,2300605125),new e(2999595186,740427564),new e(87593230,1388776818),new e(149129492,2334962391),new e(541795552,481379340),new e(2351735368,2269850802),new e(608733960,1133805922),new e(2602532471,2658691750),new e(3970345447,1359153177),new e(680658732,2386076427),new e(2207475987,1771444057),new e(1161328411,1959672182),new e(149130029,3255099982),new e(2177569856,683854372),new e(3661947790,2245419236),new e(1975966309,1770391529),new e(2582087242,2798283430)],ce=[new e(524288,805437440),new e(2146400),new e(67108864,16777216),new e(1348481048,3681400539),new e(11702,2759852034),new e(1092883008,306782344),new e(1065248,1073742080),new e(2450071634,613598240),new e(157651673,204527616),new e(3277862616,2954562566),new e(1815534349,409731075),new e(2954587142,2911241057),new e(1533925085,905970103),new e(230032140,3289526556),new e(3068358150,56077),new e(3674310171,152604166),new e(1907829602,7198427),new e(8390944,1076101705),new e(2420711618,545409280),new e(1074040832,302064768),new e(2760925472,1428467018),new e(38273045,1083326496),new e(1212191753,2454856978),new e(603981856,1226838017),new e(541721760,689080612),new e(349513,2416455890),new e(616710196,154440460),new e(40379539,68708608),new e(1629493832,2588509714),new e(894585300,204767233),new e(2483889154,616827184),new e(153412173,440402074),new e(110231814,1644468298),new e(2456888978,2454277460),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756,1227133513),new e(2454267026,613566756),new e(1227133513,2454267026),new e(613566756)];class ue extends W{constructor(n){super(n,2,[0,2,1,0,1,0,-1,0,0,-1,0,-1,-1,-1,-1,-1,-2,-1,-1,-1,-2,-1,-1,-2,-1,-1,-2,-1,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2])}transition(n,f,a){let o=Math.floor(n/(this._w+1)),g=n%(this._w+1);if(f===this._w){if(o<3){const b=a*3+o;g+=W.unpack(J,b,1),o=W.unpack(k,b,2)-1}}else if(f===this._w-1){if(o<5){const b=a*5+o;g+=W.unpack(H,b,1),o=W.unpack(K,b,3)-1}}else if(f===this._w-2){if(o<13){const b=a*13+o;g+=W.unpack(X,b,2),o=W.unpack(le,b,4)-1}}else if(f===this._w-3){if(o<28){const b=a*28+o;g+=W.unpack(V,b,2),o=W.unpack(j,b,5)-1}}else if(f===this._w-4){if(o<45){const b=a*45+o;g+=W.unpack(fe,b,3),o=W.unpack(L,b,6)-1}}else if(o<45){const b=a*45+o;g+=W.unpack(ce,b,3),o=W.unpack(he,b,6)-1}return o===-1?-1:o*(this._w+1)+g}}class de{constructor(n,f){this._word=n,this._editDistance=f,this._alphabet=[...new Set(this._word)].sort((o,g)=>o-g),this._numRanges=0,this._rangeLower=new Array(this._alphabet.length+2),this._rangeUpper=new Array(this._alphabet.length+2);let a=0;for(let o=0;o<this._alphabet.length;o++){const g=this._alphabet[o];g>a&&(this._rangeLower[this._numRanges]=a,this._rangeUpper[this._numRanges]=g-1,this._numRanges++),a=g+1}a<=l&&(this._rangeLower[this._numRanges]=a,this._rangeUpper[this._numRanges]=l,this._numRanges++),f===1?this._description=new v(n.length):this._description=new ue(n.length)}toAutomaton(){let n=new C;const f=2*this._editDistance+1,a=this._description.size();n.createState();for(let o=1;o<a;o++){let g=n.createState();n.setAccept(g,this._description.isAccept(o))}for(let o=0;o<a;o++){const g=this._description.getPosition(o);if(g<0)continue;const b=g+Math.min(this._word.length-g,f);for(let M=0;M<this._alphabet.length;M++){const R=this._alphabet[M],T=this._getVector(R,g,b),U=this._description.transition(o,g,T);U>=0&&n.addTransition(o,U,R,R)}const N=this._description.transition(o,g,0);if(N>=0)for(let M=0;M<this._numRanges;M++)n.addTransition(o,N,this._rangeLower[M],this._rangeUpper[M])}return n.finishState(),n}_getVector(n,f,a){let o=0;for(let g=f;g<a;g++)o<<=1,this._word[g]===n&&(o|=1);return o}}function oe(O,n){if(n===void 0)return 1;if(typeof n=="number")return n<0?O+n:n;let f=O;if(n.includes("<")){for(const a of n.split(" ")){const o=a.split("<"),g=parseInt(o[0]);if(O<=g)return f;f=oe(O,o[1])}return f}if(n.includes("%")){const a=parseInt(n.slice(0,-1)),o=f*a*(1/100);f=o<0?f+Math.ceil(o):Math.floor(o)}else{const a=parseInt(n);f=a<0?f+a:a}return f<1?1:f}class xe{constructor(n,f){this._invIdxs=n,this._docs=f,this._scorer=new E(this._invIdxs)}search(n){let f=this._recursive(n.query,!0);if(n.calculate_scoring===void 0||n.calculate_scoring)return this._scorer.finalScore(n,f);const a={};for(const o of f.keys())a[o]={score:1};return a}setDirty(){this._scorer.setDirty()}_recursive(n,f){let a=new Map;const o=n.boost!==void 0?n.boost:1,g=n.field!==void 0?n.field:null;let b=null,N=null;switch(this._invIdxs[g]!==void 0&&(b=this._invIdxs[g].root,N=this._invIdxs[g].analyzer),n.type){case"bool":{if(a=null,n.must!==void 0&&(a=this._getUnique(n.must,f,a)),n.filter!==void 0&&(a=this._getUnique(n.filter,null,a)),n.should!==void 0){const M=this._getAll(n.should,f);let R=!1;a===null&&(R=!0,a=new Map);const T=Math.max(1,oe(n.should.length,n.minimum_should_match));if(R&&T===1)a=M;else for(const[U,F]of M)F.length>=T&&(a.has(U)?a.get(U).push(...F):R?a.set(U,F):a.delete(U))}if(a===null&&(a=this._recursive({type:"match_all"},!1)),n.not!==void 0){let M=this._getAll(n.not,null);for(const R of M.keys())a.has(R)&&a.delete(R)}if(o!==1)for(const[M,R]of a)for(let T=0;T<R.length;T++)R[T].boost*=o;break}case"term":{const M=_(n.value);let R=S.getTermIndex(M,b);this._scorer.score(g,o,R,f,a,M);break}case"terms":{for(let M=0;M<n.value.length;M++){const R=_(n.value[M]);let T=S.getTermIndex(R,b);this._scorer.score(g,o,T,f,a,R)}break}case"fuzzy":{const[M,R]=ge(n,b);for(let T=0;T<M.length;T++)this._scorer.score(g,o*M[T].boost,M[T].index,f,a,M[T].term,R);break}case"wildcard":{const M=n.enable_scoring!==void 0?n.enable_scoring:!1,R=we(n,b);for(let T=0;T<R.length;T++)this._scorer.score(g,o,R[T].index,f&&M,a,R[T].term);break}case"match_all":{for(let M of this._docs)this._scorer.scoreConstant(o,M,a);break}case"constant_score":{let M=this._getAll(n.filter,!1);for(const R of M.keys())this._scorer.scoreConstant(o,R,a);break}case"prefix":{const M=n.enable_scoring!==void 0?n.enable_scoring:!1,R=_(n.value),T=S.getTermIndex(R,b);if(T!==null){const U=S.extendTermIndex(T);for(let F=0;F<U.length;F++)this._scorer.score(g,o,U[F].index,f&&M,a,[...R,...U[F].term])}break}case"exists":{if(b!==null)for(const M of this._invIdxs[g].docStore.keys())this._scorer.scoreConstant(o,M,a);break}case"match":{const M=s(N,n.value),R=n.operator!==void 0?n.operator:"or",T={type:"bool"},U=[];if(R==="or"?(n.minimum_should_match!==void 0&&(T.minimum_should_match=n.minimum_should_match),T.should=U):T.must=U,T.boost=o,n.fuzziness!==void 0){let F=n.prefix_length!==void 0?n.prefix_length:2,ne=n.extended!==void 0?n.extended:!1;for(let se=0;se<M.length;se++)U.push({type:"fuzzy",field:g,value:M[se],fuzziness:n.fuzziness,prefix_length:F,extended:ne})}else for(let F=0;F<M.length;F++)U.push({type:"term",field:g,value:M[F]});a=this._recursive(T,f);break}default:break}return a}_getUnique(n,f,a){if(n.length===0)return a;for(let o=0;o<n.length;o++){let g=this._recursive(n[o],f);if(a===null){a=this._recursive(n[0],f);continue}for(const b of a.keys())g.has(b)?a.get(b).push(...g.get(b)):a.delete(b)}return a}_getAll(n,f,a=new Map){for(let o=0;o<n.length;o++){let g=this._recursive(n[o],f);for(const b of g.keys())a.has(b)?a.get(b).push(...g.get(b)):a.set(b,g.get(b))}return a}}function _e(O,n){let f,a,o,g;const b=Array(O.length+1);for(f=0;f<=O.length;f++)b[f]=f;for(f=1;f<=n.length;f++){for(o=f,a=1;a<=O.length;a++)n[f-1]===O[a-1]?g=b[a-1]:(g=Math.min(b[a-1]+1,Math.min(o+1,b[a]+1)),f>1&&a>1&&n[f-2]===O[a-1]&&O[a-2]===n[f-1]&&(g=Math.min(g,b[a-1]-(O[a-1]===n[f-1]?1:0)))),b[a-1]=o,o=g;b[O.length]=o}return b[O.length]}function ge(O,n){let f=_(O.value),a=O.fuzziness!==void 0?O.fuzziness:"AUTO";a==="AUTO"&&(f.length<=2?a=0:f.length<=5?a=1:a=2);let o=O.prefix_length!==void 0?O.prefix_length:0,g=O.extended!==void 0?O.extended:!1;a===0&&(o=f.length);let b=[],N=n,M=f.slice(0,o),R=f,T=0;if(o!==0&&(N=S.getTermIndex(M,N),R=R.slice(o)),N===null)return[b,T];if(R.length===0){if(g){const Q=S.extendTermIndex(N);for(let Y=0;Y<Q.length;Y++)b.push({index:Q[Y].index,term:Q[Y].term,boost:1}),T=Math.max(T,Q[Y].index.df)}else N.dc!==void 0&&(b.push({index:N,term:f,boost:1}),T=N.df);return[b,T]}const U=[0],F=new P(new de(R,a).toAutomaton());function ne(Q,Y,te){let Z=0;if(Q=F.step(Q,0),Q!==-1&&F.isAccept(Q)&&(Z++,Q=F.step(Q,0),Q!==-1&&F.isAccept(Q)&&Z++,Y.length<te.length)){if(Z!==a)return _e(Y,te);Z-=te.length-Y.length}return a-Z}function se(Q,Y,te){if(U[U.length-1]=Y,Q=F.step(Q,Y),Q!==-1){if(F.isAccept(Q)){if(g){const Z=S.extendTermIndex(te);for(let ae=0;ae<Z.length;ae++)b.push({index:Z[ae].index,term:Z[ae].term,boost:1}),T=Math.max(T,Z[ae].index.df);return}else if(te.df!==void 0){const Z=ne(Q,U,R),ae=Math.max(0,1-Z/Math.min(M.length+U.length,f.length));b.push({index:te,term:[...M,...U],boost:ae}),T=Math.max(T,te.df)}}U.push(0);for(const Z of te)se(Q,Z[0],Z[1]);U.pop()}}for(const Q of N)se(0,Q[0],Q[1]);return[b,T]}function we(O,n){let f=_(O.value),a=[];function o(g,b=0,N=[],M=!1){if(g!==null){if(b===f.length){g.df!==void 0&&a.push({index:g,term:N.slice()});return}if(!M&&f[b]===92)o(g,b+1,N,!0);else if(!M&&f[b]===63)for(const R of g)o(R[1],b+1,[...N,R[0]]);else if(!M&&f[b]===42)if(b+1===f.length){const R=S.extendTermIndex(g);for(let T=0;T<R.length;T++)o(R[T].index,b+1,[...N,...R[T].term])}else{o(g,b+1,N,!1);const R=[{index:g,term:[]}];do{const T=R.pop();for(const U of T.index)o(U[1],b+1,[...N,...T.term,U[0]]),R.push({index:U[1],term:[...T.term,U[0]]})}while(R.length!==0)}else o(S.getTermIndex([f[b]],g),b+1,[...N,f[b]])}}return o(n),a}var pe=p(0);class q{constructor(n=[],f){this._invIdxs={};for(let a=0;a<n.length;a++){let o=n[a];this._invIdxs[o.field]=new S(o)}this._id=f,this._docs=new Set,this._idxSearcher=new xe(this._invIdxs,this._docs)}static register(){pe.a.FullTextSearch=q}addDocument(n,f=n[this._id]){let a=Object.keys(this._invIdxs);for(let o=0,g;o<a.length,g=a[o];o++){let b=n[g];if(b!=null){if(typeof b!="string")if(typeof b=="number")b=b.toString();else throw TypeError("Unsupported field type for full text search.");this._invIdxs[g].insert(b,f)}}this._docs.add(f),this._idxSearcher.setDirty()}removeDocument(n,f=n[this._id]){let a=Object.keys(this._invIdxs);for(let o=0;o<a.length;o++)this._invIdxs[a[o]].remove(f);this._docs.delete(f),this._idxSearcher.setDirty()}updateDocument(n,f=n[this._id]){this.removeDocument(n,f),this.addDocument(n,f)}clear(){for(let n of this._docs)this.removeDocument(null,n)}search(n){return this._idxSearcher.search(n)}toJSON(){let n={id:this._id,ii:{}},f=Object.keys(this._invIdxs);for(let a=0;a<f.length;a++){const o=f[a];n.ii[o]=this._invIdxs[o].toJSON()}return n}static fromJSONObject(n,f={}){let a=new q([],n.id),o=Object.keys(n.ii);for(let g=0;g<o.length;g++){const b=o[g];a._invIdxs[b]=S.fromJSONObject(n.ii[b],f[b])}return a}}p.d(D,"FullTextSearch",function(){return q}),p.d(D,"analyze",function(){return s}),p.d(D,"StandardAnalyzer",function(){return x}),p.d(D,"whitespaceTokenizer",function(){return w}),p.d(D,"lowercaseTokenFilter",function(){return y}),p.d(D,"uppercaseTokenFilter",function(){return I}),q.Analyzer={},q.Analyzer.analyze=s,q.Analyzer.StandardAnalyzer=x,q.Tokenizer={},q.Tokenizer.whitespaceTokenizer=w,q.TokenFilter={},q.TokenFilter.lowercaseTokenFilter=y,q.TokenFilter.uppercaseTokenFilter=I;var me=D.default=q},function(z,D){var p;p=function(){return this}();try{p=p||Function("return this")()||(0,eval)("this")}catch(w){typeof window=="object"&&(p=window)}z.exports=p}])})}}]);
